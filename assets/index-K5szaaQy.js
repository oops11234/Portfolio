var EI=Object.defineProperty;var nE=s=>{throw TypeError(s)};var bI=(s,e,t)=>e in s?EI(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var X=(s,e,t)=>bI(s,typeof e!="symbol"?e+"":e,t),ym=(s,e,t)=>e.has(s)||nE("Cannot "+t);var L=(s,e,t)=>(ym(s,e,"read from private field"),t?t.call(s):e.get(s)),ne=(s,e,t)=>e.has(s)?nE("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),P=(s,e,t,n)=>(ym(s,e,"write to private field"),n?n.call(s,t):e.set(s,t),t),ge=(s,e,t)=>(ym(s,e,"access private method"),t);var Wu=(s,e,t,n)=>({set _(i){P(s,e,i,t)},get _(){return L(s,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function AI(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var vm={exports:{}},Zu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sE;function SI(){if(sE)return Zu;sE=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,i,a){var l=null;if(a!==void 0&&(l=""+a),i.key!==void 0&&(l=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:s,type:n,key:l,ref:i!==void 0?i:null,props:a}}return Zu.Fragment=e,Zu.jsx=t,Zu.jsxs=t,Zu}var iE;function TI(){return iE||(iE=1,vm.exports=SI()),vm.exports}var me=TI(),xm={exports:{}},He={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rE;function wI(){if(rE)return He;rE=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),m=Symbol.iterator;function y(I){return I===null||typeof I!="object"?null:(I=m&&I[m]||I["@@iterator"],typeof I=="function"?I:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,b={};function A(I,V,ie){this.props=I,this.context=V,this.refs=b,this.updater=ie||v}A.prototype.isReactComponent={},A.prototype.setState=function(I,V){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,V,"setState")},A.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function S(){}S.prototype=A.prototype;function k(I,V,ie){this.props=I,this.context=V,this.refs=b,this.updater=ie||v}var R=k.prototype=new S;R.constructor=k,x(R,A.prototype),R.isPureReactComponent=!0;var _=Array.isArray,C={H:null,A:null,T:null,S:null},U=Object.prototype.hasOwnProperty;function O(I,V,ie,ce,ue,xe){return ie=xe.ref,{$$typeof:s,type:I,key:V,ref:ie!==void 0?ie:null,props:xe}}function B(I,V){return O(I.type,V,void 0,void 0,void 0,I.props)}function F(I){return typeof I=="object"&&I!==null&&I.$$typeof===s}function M(I){var V={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(ie){return V[ie]})}var j=/\/+/g;function ae(I,V){return typeof I=="object"&&I!==null&&I.key!=null?M(""+I.key):V.toString(36)}function ye(){}function pe(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(ye,ye):(I.status="pending",I.then(function(V){I.status==="pending"&&(I.status="fulfilled",I.value=V)},function(V){I.status==="pending"&&(I.status="rejected",I.reason=V)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function W(I,V,ie,ce,ue){var xe=typeof I;(xe==="undefined"||xe==="boolean")&&(I=null);var ve=!1;if(I===null)ve=!0;else switch(xe){case"bigint":case"string":case"number":ve=!0;break;case"object":switch(I.$$typeof){case s:case e:ve=!0;break;case g:return ve=I._init,W(ve(I._payload),V,ie,ce,ue)}}if(ve)return ue=ue(I),ve=ce===""?"."+ae(I,0):ce,_(ue)?(ie="",ve!=null&&(ie=ve.replace(j,"$&/")+"/"),W(ue,V,ie,"",function(Ne){return Ne})):ue!=null&&(F(ue)&&(ue=B(ue,ie+(ue.key==null||I&&I.key===ue.key?"":(""+ue.key).replace(j,"$&/")+"/")+ve)),V.push(ue)),1;ve=0;var $e=ce===""?".":ce+":";if(_(I))for(var ke=0;ke<I.length;ke++)ce=I[ke],xe=$e+ae(ce,ke),ve+=W(ce,V,ie,xe,ue);else if(ke=y(I),typeof ke=="function")for(I=ke.call(I),ke=0;!(ce=I.next()).done;)ce=ce.value,xe=$e+ae(ce,ke++),ve+=W(ce,V,ie,xe,ue);else if(xe==="object"){if(typeof I.then=="function")return W(pe(I),V,ie,ce,ue);throw V=String(I),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return ve}function G(I,V,ie){if(I==null)return I;var ce=[],ue=0;return W(I,ce,"","",function(xe){return V.call(ie,xe,ue++)}),ce}function te(I){if(I._status===-1){var V=I._result;V=V(),V.then(function(ie){(I._status===0||I._status===-1)&&(I._status=1,I._result=ie)},function(ie){(I._status===0||I._status===-1)&&(I._status=2,I._result=ie)}),I._status===-1&&(I._status=0,I._result=V)}if(I._status===1)return I._result.default;throw I._result}var se=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)};function Z(){}return He.Children={map:G,forEach:function(I,V,ie){G(I,function(){V.apply(this,arguments)},ie)},count:function(I){var V=0;return G(I,function(){V++}),V},toArray:function(I){return G(I,function(V){return V})||[]},only:function(I){if(!F(I))throw Error("React.Children.only expected to receive a single React element child.");return I}},He.Component=A,He.Fragment=t,He.Profiler=i,He.PureComponent=k,He.StrictMode=n,He.Suspense=h,He.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,He.act=function(){throw Error("act(...) is not supported in production builds of React.")},He.cache=function(I){return function(){return I.apply(null,arguments)}},He.cloneElement=function(I,V,ie){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var ce=x({},I.props),ue=I.key,xe=void 0;if(V!=null)for(ve in V.ref!==void 0&&(xe=void 0),V.key!==void 0&&(ue=""+V.key),V)!U.call(V,ve)||ve==="key"||ve==="__self"||ve==="__source"||ve==="ref"&&V.ref===void 0||(ce[ve]=V[ve]);var ve=arguments.length-2;if(ve===1)ce.children=ie;else if(1<ve){for(var $e=Array(ve),ke=0;ke<ve;ke++)$e[ke]=arguments[ke+2];ce.children=$e}return O(I.type,ue,void 0,void 0,xe,ce)},He.createContext=function(I){return I={$$typeof:l,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:a,_context:I},I},He.createElement=function(I,V,ie){var ce,ue={},xe=null;if(V!=null)for(ce in V.key!==void 0&&(xe=""+V.key),V)U.call(V,ce)&&ce!=="key"&&ce!=="__self"&&ce!=="__source"&&(ue[ce]=V[ce]);var ve=arguments.length-2;if(ve===1)ue.children=ie;else if(1<ve){for(var $e=Array(ve),ke=0;ke<ve;ke++)$e[ke]=arguments[ke+2];ue.children=$e}if(I&&I.defaultProps)for(ce in ve=I.defaultProps,ve)ue[ce]===void 0&&(ue[ce]=ve[ce]);return O(I,xe,void 0,void 0,null,ue)},He.createRef=function(){return{current:null}},He.forwardRef=function(I){return{$$typeof:c,render:I}},He.isValidElement=F,He.lazy=function(I){return{$$typeof:g,_payload:{_status:-1,_result:I},_init:te}},He.memo=function(I,V){return{$$typeof:f,type:I,compare:V===void 0?null:V}},He.startTransition=function(I){var V=C.T,ie={};C.T=ie;try{var ce=I(),ue=C.S;ue!==null&&ue(ie,ce),typeof ce=="object"&&ce!==null&&typeof ce.then=="function"&&ce.then(Z,se)}catch(xe){se(xe)}finally{C.T=V}},He.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},He.use=function(I){return C.H.use(I)},He.useActionState=function(I,V,ie){return C.H.useActionState(I,V,ie)},He.useCallback=function(I,V){return C.H.useCallback(I,V)},He.useContext=function(I){return C.H.useContext(I)},He.useDebugValue=function(){},He.useDeferredValue=function(I,V){return C.H.useDeferredValue(I,V)},He.useEffect=function(I,V){return C.H.useEffect(I,V)},He.useId=function(){return C.H.useId()},He.useImperativeHandle=function(I,V,ie){return C.H.useImperativeHandle(I,V,ie)},He.useInsertionEffect=function(I,V){return C.H.useInsertionEffect(I,V)},He.useLayoutEffect=function(I,V){return C.H.useLayoutEffect(I,V)},He.useMemo=function(I,V){return C.H.useMemo(I,V)},He.useOptimistic=function(I,V){return C.H.useOptimistic(I,V)},He.useReducer=function(I,V,ie){return C.H.useReducer(I,V,ie)},He.useRef=function(I){return C.H.useRef(I)},He.useState=function(I){return C.H.useState(I)},He.useSyncExternalStore=function(I,V,ie){return C.H.useSyncExternalStore(I,V,ie)},He.useTransition=function(){return C.H.useTransition()},He.version="19.0.0",He}var aE;function by(){return aE||(aE=1,xm.exports=wI()),xm.exports}var J=by();const lE=AI(J);var Em={exports:{}},Ju={},bm={exports:{}},Am={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oE;function RI(){return oE||(oE=1,function(s){function e(G,te){var se=G.length;G.push(te);e:for(;0<se;){var Z=se-1>>>1,I=G[Z];if(0<i(I,te))G[Z]=te,G[se]=I,se=Z;else break e}}function t(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var te=G[0],se=G.pop();if(se!==te){G[0]=se;e:for(var Z=0,I=G.length,V=I>>>1;Z<V;){var ie=2*(Z+1)-1,ce=G[ie],ue=ie+1,xe=G[ue];if(0>i(ce,se))ue<I&&0>i(xe,ce)?(G[Z]=xe,G[ue]=se,Z=ue):(G[Z]=ce,G[ie]=se,Z=ie);else if(ue<I&&0>i(xe,se))G[Z]=xe,G[ue]=se,Z=ue;else break e}}return te}function i(G,te){var se=G.sortIndex-te.sortIndex;return se!==0?se:G.id-te.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;s.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();s.unstable_now=function(){return l.now()-c}}var h=[],f=[],g=1,m=null,y=3,v=!1,x=!1,b=!1,A=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function R(G){for(var te=t(f);te!==null;){if(te.callback===null)n(f);else if(te.startTime<=G)n(f),te.sortIndex=te.expirationTime,e(h,te);else break;te=t(f)}}function _(G){if(b=!1,R(G),!x)if(t(h)!==null)x=!0,pe();else{var te=t(f);te!==null&&W(_,te.startTime-G)}}var C=!1,U=-1,O=5,B=-1;function F(){return!(s.unstable_now()-B<O)}function M(){if(C){var G=s.unstable_now();B=G;var te=!0;try{e:{x=!1,b&&(b=!1,S(U),U=-1),v=!0;var se=y;try{t:{for(R(G),m=t(h);m!==null&&!(m.expirationTime>G&&F());){var Z=m.callback;if(typeof Z=="function"){m.callback=null,y=m.priorityLevel;var I=Z(m.expirationTime<=G);if(G=s.unstable_now(),typeof I=="function"){m.callback=I,R(G),te=!0;break t}m===t(h)&&n(h),R(G)}else n(h);m=t(h)}if(m!==null)te=!0;else{var V=t(f);V!==null&&W(_,V.startTime-G),te=!1}}break e}finally{m=null,y=se,v=!1}te=void 0}}finally{te?j():C=!1}}}var j;if(typeof k=="function")j=function(){k(M)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,ye=ae.port2;ae.port1.onmessage=M,j=function(){ye.postMessage(null)}}else j=function(){A(M,0)};function pe(){C||(C=!0,j())}function W(G,te){U=A(function(){G(s.unstable_now())},te)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(G){G.callback=null},s.unstable_continueExecution=function(){x||v||(x=!0,pe())},s.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<G?Math.floor(1e3/G):5},s.unstable_getCurrentPriorityLevel=function(){return y},s.unstable_getFirstCallbackNode=function(){return t(h)},s.unstable_next=function(G){switch(y){case 1:case 2:case 3:var te=3;break;default:te=y}var se=y;y=te;try{return G()}finally{y=se}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(G,te){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var se=y;y=G;try{return te()}finally{y=se}},s.unstable_scheduleCallback=function(G,te,se){var Z=s.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?Z+se:Z):se=Z,G){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=se+I,G={id:g++,callback:te,priorityLevel:G,startTime:se,expirationTime:I,sortIndex:-1},se>Z?(G.sortIndex=se,e(f,G),t(h)===null&&G===t(f)&&(b?(S(U),U=-1):b=!0,W(_,se-Z))):(G.sortIndex=I,e(h,G),x||v||(x=!0,pe())),G},s.unstable_shouldYield=F,s.unstable_wrapCallback=function(G){var te=y;return function(){var se=y;y=te;try{return G.apply(this,arguments)}finally{y=se}}}}(Am)),Am}var cE;function LI(){return cE||(cE=1,bm.exports=RI()),bm.exports}var Sm={exports:{}},bn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uE;function kI(){if(uE)return bn;uE=1;var s=by();function e(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(h,f,g){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:m==null?null:""+m,children:h,containerInfo:f,implementation:g}}var l=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return bn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,bn.createPortal=function(h,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return a(h,f,null,g)},bn.flushSync=function(h){var f=l.T,g=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=f,n.p=g,n.d.f()}},bn.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(h,f))},bn.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},bn.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var g=f.as,m=c(g,f.crossOrigin),y=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?n.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:m,integrity:y,fetchPriority:v}):g==="script"&&n.d.X(h,{crossOrigin:m,integrity:y,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},bn.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=c(f.as,f.crossOrigin);n.d.M(h,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(h)},bn.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,m=c(g,f.crossOrigin);n.d.L(h,g,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},bn.preloadModule=function(h,f){if(typeof h=="string")if(f){var g=c(f.as,f.crossOrigin);n.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(h)},bn.requestFormReset=function(h){n.d.r(h)},bn.unstable_batchedUpdates=function(h,f){return h(f)},bn.useFormState=function(h,f,g){return l.H.useFormState(h,f,g)},bn.useFormStatus=function(){return l.H.useHostTransitionStatus()},bn.version="19.0.0",bn}var hE;function II(){if(hE)return Sm.exports;hE=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Sm.exports=kI(),Sm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fE;function DI(){if(fE)return Ju;fE=1;var s=LI(),e=by(),t=II();function n(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}var a=Symbol.for("react.element"),l=Symbol.for("react.transitional.element"),c=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),y=Symbol.for("react.consumer"),v=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),R=Symbol.for("react.offscreen"),_=Symbol.for("react.memo_cache_sentinel"),C=Symbol.iterator;function U(r){return r===null||typeof r!="object"?null:(r=C&&r[C]||r["@@iterator"],typeof r=="function"?r:null)}var O=Symbol.for("react.client.reference");function B(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===O?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case h:return"Fragment";case c:return"Portal";case g:return"Profiler";case f:return"StrictMode";case b:return"Suspense";case A:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case v:return(r.displayName||"Context")+".Provider";case y:return(r._context.displayName||"Context")+".Consumer";case x:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case S:return o=r.displayName||null,o!==null?o:B(r.type)||"Memo";case k:o=r._payload,r=r._init;try{return B(r(o))}catch{}}return null}var F=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M=Object.assign,j,ae;function ye(r){if(j===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);j=o&&o[1]||"",ae=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+j+r+ae}var pe=!1;function W(r,o){if(!r||pe)return"";pe=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(o){var de=function(){throw Error()};if(Object.defineProperty(de.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(de,[])}catch(re){var ee=re}Reflect.construct(r,[],de)}else{try{de.call()}catch(re){ee=re}r.call(de.prototype)}}else{try{throw Error()}catch(re){ee=re}(de=r())&&typeof de.catch=="function"&&de.catch(function(){})}}catch(re){if(re&&ee&&typeof re.stack=="string")return[re.stack,ee.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=d.DetermineComponentFrameRoot(),w=E[0],D=E[1];if(w&&D){var N=w.split(`
`),z=D.split(`
`);for(p=d=0;d<N.length&&!N[d].includes("DetermineComponentFrameRoot");)d++;for(;p<z.length&&!z[p].includes("DetermineComponentFrameRoot");)p++;if(d===N.length||p===z.length)for(d=N.length-1,p=z.length-1;1<=d&&0<=p&&N[d]!==z[p];)p--;for(;1<=d&&0<=p;d--,p--)if(N[d]!==z[p]){if(d!==1||p!==1)do if(d--,p--,0>p||N[d]!==z[p]){var le=`
`+N[d].replace(" at new "," at ");return r.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",r.displayName)),le}while(1<=d&&0<=p);break}}}finally{pe=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?ye(u):""}function G(r){switch(r.tag){case 26:case 27:case 5:return ye(r.type);case 16:return ye("Lazy");case 13:return ye("Suspense");case 19:return ye("SuspenseList");case 0:case 15:return r=W(r.type,!1),r;case 11:return r=W(r.type.render,!1),r;case 1:return r=W(r.type,!0),r;default:return""}}function te(r){try{var o="";do o+=G(r),r=r.return;while(r);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function se(r){var o=r,u=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(u=o.return),r=o.return;while(r)}return o.tag===3?u:null}function Z(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function I(r){if(se(r)!==r)throw Error(n(188))}function V(r){var o=r.alternate;if(!o){if(o=se(r),o===null)throw Error(n(188));return o!==r?null:r}for(var u=r,d=o;;){var p=u.return;if(p===null)break;var E=p.alternate;if(E===null){if(d=p.return,d!==null){u=d;continue}break}if(p.child===E.child){for(E=p.child;E;){if(E===u)return I(p),r;if(E===d)return I(p),o;E=E.sibling}throw Error(n(188))}if(u.return!==d.return)u=p,d=E;else{for(var w=!1,D=p.child;D;){if(D===u){w=!0,u=p,d=E;break}if(D===d){w=!0,d=p,u=E;break}D=D.sibling}if(!w){for(D=E.child;D;){if(D===u){w=!0,u=E,d=p;break}if(D===d){w=!0,d=E,u=p;break}D=D.sibling}if(!w)throw Error(n(189))}}if(u.alternate!==d)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?r:o}function ie(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=ie(r),o!==null)return o;r=r.sibling}return null}var ce=Array.isArray,ue=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xe={pending:!1,data:null,method:null,action:null},ve=[],$e=-1;function ke(r){return{current:r}}function Ne(r){0>$e||(r.current=ve[$e],ve[$e]=null,$e--)}function Ke(r,o){$e++,ve[$e]=r.current,r.current=o}var Wt=ke(null),vn=ke(null),yt=ke(null),Zt=ke(null);function ei(r,o){switch(Ke(yt,o),Ke(vn,r),Ke(Wt,null),r=o.nodeType,r){case 9:case 11:o=(o=o.documentElement)&&(o=o.namespaceURI)?C1(o):0;break;default:if(r=r===8?o.parentNode:o,o=r.tagName,r=r.namespaceURI)r=C1(r),o=_1(r,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}Ne(Wt),Ke(Wt,o)}function Ue(){Ne(Wt),Ne(vn),Ne(yt)}function Tt(r){r.memoizedState!==null&&Ke(Zt,r);var o=Wt.current,u=_1(o,r.type);o!==u&&(Ke(vn,r),Ke(Wt,u))}function Yt(r){vn.current===r&&(Ne(Wt),Ne(vn)),Zt.current===r&&(Ne(Zt),Yu._currentValue=xe)}var jn=Object.prototype.hasOwnProperty,cn=s.unstable_scheduleCallback,os=s.unstable_cancelCallback,_s=s.unstable_shouldYield,jl=s.unstable_requestPaint,un=s.unstable_now,Ql=s.unstable_getCurrentPriorityLevel,ti=s.unstable_ImmediatePriority,De=s.unstable_UserBlockingPriority,Be=s.unstable_NormalPriority,Me=s.unstable_LowPriority,_e=s.unstable_IdlePriority,bt=s.log,Ct=s.unstable_setDisableYieldValue,at=null,wt=null;function cf(r){if(wt&&typeof wt.onCommitFiberRoot=="function")try{wt.onCommitFiberRoot(at,r,void 0,(r.current.flags&128)===128)}catch{}}function ni(r){if(typeof bt=="function"&&Ct(r),wt&&typeof wt.setStrictMode=="function")try{wt.setStrictMode(at,r)}catch{}}var Qn=Math.clz32?Math.clz32:lL,rL=Math.log,aL=Math.LN2;function lL(r){return r>>>=0,r===0?32:31-(rL(r)/aL|0)|0}var uf=128,hf=4194304;function Oa(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function ff(r,o){var u=r.pendingLanes;if(u===0)return 0;var d=0,p=r.suspendedLanes,E=r.pingedLanes,w=r.warmLanes;r=r.finishedLanes!==0;var D=u&134217727;return D!==0?(u=D&~p,u!==0?d=Oa(u):(E&=D,E!==0?d=Oa(E):r||(w=D&~w,w!==0&&(d=Oa(w))))):(D=u&~p,D!==0?d=Oa(D):E!==0?d=Oa(E):r||(w=u&~w,w!==0&&(d=Oa(w)))),d===0?0:o!==0&&o!==d&&(o&p)===0&&(p=d&-d,w=o&-o,p>=w||p===32&&(w&4194176)!==0)?o:d}function nu(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function oL(r,o){switch(r){case 1:case 2:case 4:case 8:return o+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function S3(){var r=uf;return uf<<=1,(uf&4194176)===0&&(uf=128),r}function T3(){var r=hf;return hf<<=1,(hf&62914560)===0&&(hf=4194304),r}function f2(r){for(var o=[],u=0;31>u;u++)o.push(r);return o}function su(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function cL(r,o,u,d,p,E){var w=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var D=r.entanglements,N=r.expirationTimes,z=r.hiddenUpdates;for(u=w&~u;0<u;){var le=31-Qn(u),de=1<<le;D[le]=0,N[le]=-1;var ee=z[le];if(ee!==null)for(z[le]=null,le=0;le<ee.length;le++){var re=ee[le];re!==null&&(re.lane&=-536870913)}u&=~de}d!==0&&w3(r,d,0),E!==0&&p===0&&r.tag!==0&&(r.suspendedLanes|=E&~(w&~o))}function w3(r,o,u){r.pendingLanes|=o,r.suspendedLanes&=~o;var d=31-Qn(o);r.entangledLanes|=o,r.entanglements[d]=r.entanglements[d]|1073741824|u&4194218}function R3(r,o){var u=r.entangledLanes|=o;for(r=r.entanglements;u;){var d=31-Qn(u),p=1<<d;p&o|r[d]&o&&(r[d]|=o),u&=~p}}function L3(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function k3(){var r=ue.p;return r!==0?r:(r=window.event,r===void 0?32:X1(r.type))}function uL(r,o){var u=ue.p;try{return ue.p=r,o()}finally{ue.p=u}}var Ir=Math.random().toString(36).slice(2),xn="__reactFiber$"+Ir,Bn="__reactProps$"+Ir,ql="__reactContainer$"+Ir,d2="__reactEvents$"+Ir,hL="__reactListeners$"+Ir,fL="__reactHandles$"+Ir,I3="__reactResources$"+Ir,iu="__reactMarker$"+Ir;function g2(r){delete r[xn],delete r[Bn],delete r[d2],delete r[hL],delete r[fL]}function Ma(r){var o=r[xn];if(o)return o;for(var u=r.parentNode;u;){if(o=u[ql]||u[xn]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(r=P1(r);r!==null;){if(u=r[xn])return u;r=P1(r)}return o}r=u,u=r.parentNode}return null}function Xl(r){if(r=r[xn]||r[ql]){var o=r.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return r}return null}function ru(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(n(33))}function Wl(r){var o=r[I3];return o||(o=r[I3]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Jt(r){r[iu]=!0}var D3=new Set,C3={};function Pa(r,o){Zl(r,o),Zl(r+"Capture",o)}function Zl(r,o){for(C3[r]=o,r=0;r<o.length;r++)D3.add(o[r])}var Ci=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dL=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),_3={},O3={};function gL(r){return jn.call(O3,r)?!0:jn.call(_3,r)?!1:dL.test(r)?O3[r]=!0:(_3[r]=!0,!1)}function df(r,o,u){if(gL(o))if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var d=o.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+u)}}function gf(r,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+u)}}function _i(r,o,u,d){if(d===null)r.removeAttribute(u);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(o,u,""+d)}}function cs(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function M3(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function mL(r){var o=M3(r)?"checked":"value",u=Object.getOwnPropertyDescriptor(r.constructor.prototype,o),d=""+r[o];if(!r.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,E=u.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return p.call(this)},set:function(w){d=""+w,E.call(this,w)}}),Object.defineProperty(r,o,{enumerable:u.enumerable}),{getValue:function(){return d},setValue:function(w){d=""+w},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function mf(r){r._valueTracker||(r._valueTracker=mL(r))}function P3(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var u=o.getValue(),d="";return r&&(d=M3(r)?r.checked?"true":"false":r.value),r=d,r!==u?(o.setValue(r),!0):!1}function pf(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var pL=/[\n"\\]/g;function us(r){return r.replace(pL,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function m2(r,o,u,d,p,E,w,D){r.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?r.type=w:r.removeAttribute("type"),o!=null?w==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+cs(o)):r.value!==""+cs(o)&&(r.value=""+cs(o)):w!=="submit"&&w!=="reset"||r.removeAttribute("value"),o!=null?p2(r,w,cs(o)):u!=null?p2(r,w,cs(u)):d!=null&&r.removeAttribute("value"),p==null&&E!=null&&(r.defaultChecked=!!E),p!=null&&(r.checked=p&&typeof p!="function"&&typeof p!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?r.name=""+cs(D):r.removeAttribute("name")}function N3(r,o,u,d,p,E,w,D){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(r.type=E),o!=null||u!=null){if(!(E!=="submit"&&E!=="reset"||o!=null))return;u=u!=null?""+cs(u):"",o=o!=null?""+cs(o):u,D||o===r.value||(r.value=o),r.defaultValue=o}d=d??p,d=typeof d!="function"&&typeof d!="symbol"&&!!d,r.checked=D?r.checked:!!d,r.defaultChecked=!!d,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(r.name=w)}function p2(r,o,u){o==="number"&&pf(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function Jl(r,o,u,d){if(r=r.options,o){o={};for(var p=0;p<u.length;p++)o["$"+u[p]]=!0;for(u=0;u<r.length;u++)p=o.hasOwnProperty("$"+r[u].value),r[u].selected!==p&&(r[u].selected=p),p&&d&&(r[u].defaultSelected=!0)}else{for(u=""+cs(u),o=null,p=0;p<r.length;p++){if(r[p].value===u){r[p].selected=!0,d&&(r[p].defaultSelected=!0);return}o!==null||r[p].disabled||(o=r[p])}o!==null&&(o.selected=!0)}}function B3(r,o,u){if(o!=null&&(o=""+cs(o),o!==r.value&&(r.value=o),u==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=u!=null?""+cs(u):""}function U3(r,o,u,d){if(o==null){if(d!=null){if(u!=null)throw Error(n(92));if(ce(d)){if(1<d.length)throw Error(n(93));d=d[0]}u=d}u==null&&(u=""),o=u}u=cs(o),r.defaultValue=u,d=r.textContent,d===u&&d!==""&&d!==null&&(r.value=d)}function eo(r,o){if(o){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=o;return}}r.textContent=o}var yL=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function F3(r,o,u){var d=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?d?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":d?r.setProperty(o,u):typeof u!="number"||u===0||yL.has(o)?o==="float"?r.cssFloat=u:r[o]=(""+u).trim():r[o]=u+"px"}function G3(r,o,u){if(o!=null&&typeof o!="object")throw Error(n(62));if(r=r.style,u!=null){for(var d in u)!u.hasOwnProperty(d)||o!=null&&o.hasOwnProperty(d)||(d.indexOf("--")===0?r.setProperty(d,""):d==="float"?r.cssFloat="":r[d]="");for(var p in o)d=o[p],o.hasOwnProperty(p)&&u[p]!==d&&F3(r,p,d)}else for(var E in o)o.hasOwnProperty(E)&&F3(r,E,o[E])}function y2(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vL=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xL=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yf(r){return xL.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var v2=null;function x2(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var to=null,no=null;function $3(r){var o=Xl(r);if(o&&(r=o.stateNode)){var u=r[Bn]||null;e:switch(r=o.stateNode,o.type){case"input":if(m2(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+us(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var d=u[o];if(d!==r&&d.form===r.form){var p=d[Bn]||null;if(!p)throw Error(n(90));m2(d,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(o=0;o<u.length;o++)d=u[o],d.form===r.form&&P3(d)}break e;case"textarea":B3(r,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Jl(r,!!u.multiple,o,!1)}}}var E2=!1;function H3(r,o,u){if(E2)return r(o,u);E2=!0;try{var d=r(o);return d}finally{if(E2=!1,(to!==null||no!==null)&&(e0(),to&&(o=to,r=no,no=to=null,$3(o),r)))for(o=0;o<r.length;o++)$3(r[o])}}function au(r,o){var u=r.stateNode;if(u===null)return null;var d=u[Bn]||null;if(d===null)return null;u=d[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(n(231,o,typeof u));return u}var b2=!1;if(Ci)try{var lu={};Object.defineProperty(lu,"passive",{get:function(){b2=!0}}),window.addEventListener("test",lu,lu),window.removeEventListener("test",lu,lu)}catch{b2=!1}var Dr=null,A2=null,vf=null;function z3(){if(vf)return vf;var r,o=A2,u=o.length,d,p="value"in Dr?Dr.value:Dr.textContent,E=p.length;for(r=0;r<u&&o[r]===p[r];r++);var w=u-r;for(d=1;d<=w&&o[u-d]===p[E-d];d++);return vf=p.slice(r,1<d?1-d:void 0)}function xf(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function Ef(){return!0}function V3(){return!1}function Un(r){function o(u,d,p,E,w){this._reactName=u,this._targetInst=p,this.type=d,this.nativeEvent=E,this.target=w,this.currentTarget=null;for(var D in r)r.hasOwnProperty(D)&&(u=r[D],this[D]=u?u(E):E[D]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?Ef:V3,this.isPropagationStopped=V3,this}return M(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Ef)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Ef)},persist:function(){},isPersistent:Ef}),o}var Na={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bf=Un(Na),ou=M({},Na,{view:0,detail:0}),EL=Un(ou),S2,T2,cu,Af=M({},ou,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:R2,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==cu&&(cu&&r.type==="mousemove"?(S2=r.screenX-cu.screenX,T2=r.screenY-cu.screenY):T2=S2=0,cu=r),S2)},movementY:function(r){return"movementY"in r?r.movementY:T2}}),K3=Un(Af),bL=M({},Af,{dataTransfer:0}),AL=Un(bL),SL=M({},ou,{relatedTarget:0}),w2=Un(SL),TL=M({},Na,{animationName:0,elapsedTime:0,pseudoElement:0}),wL=Un(TL),RL=M({},Na,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),LL=Un(RL),kL=M({},Na,{data:0}),Y3=Un(kL),IL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},DL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},CL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _L(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=CL[r])?!!o[r]:!1}function R2(){return _L}var OL=M({},ou,{key:function(r){if(r.key){var o=IL[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=xf(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?DL[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:R2,charCode:function(r){return r.type==="keypress"?xf(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?xf(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),ML=Un(OL),PL=M({},Af,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),j3=Un(PL),NL=M({},ou,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:R2}),BL=Un(NL),UL=M({},Na,{propertyName:0,elapsedTime:0,pseudoElement:0}),FL=Un(UL),GL=M({},Af,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),$L=Un(GL),HL=M({},Na,{newState:0,oldState:0}),zL=Un(HL),VL=[9,13,27,32],L2=Ci&&"CompositionEvent"in window,uu=null;Ci&&"documentMode"in document&&(uu=document.documentMode);var KL=Ci&&"TextEvent"in window&&!uu,Q3=Ci&&(!L2||uu&&8<uu&&11>=uu),q3=" ",X3=!1;function W3(r,o){switch(r){case"keyup":return VL.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Z3(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var so=!1;function YL(r,o){switch(r){case"compositionend":return Z3(o);case"keypress":return o.which!==32?null:(X3=!0,q3);case"textInput":return r=o.data,r===q3&&X3?null:r;default:return null}}function jL(r,o){if(so)return r==="compositionend"||!L2&&W3(r,o)?(r=z3(),vf=A2=Dr=null,so=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Q3&&o.locale!=="ko"?null:o.data;default:return null}}var QL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function J3(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!QL[r.type]:o==="textarea"}function ev(r,o,u,d){to?no?no.push(d):no=[d]:to=d,o=r0(o,"onChange"),0<o.length&&(u=new bf("onChange","change",null,u,d),r.push({event:u,listeners:o}))}var hu=null,fu=null;function qL(r){R1(r,0)}function Sf(r){var o=ru(r);if(P3(o))return r}function tv(r,o){if(r==="change")return o}var nv=!1;if(Ci){var k2;if(Ci){var I2="oninput"in document;if(!I2){var sv=document.createElement("div");sv.setAttribute("oninput","return;"),I2=typeof sv.oninput=="function"}k2=I2}else k2=!1;nv=k2&&(!document.documentMode||9<document.documentMode)}function iv(){hu&&(hu.detachEvent("onpropertychange",rv),fu=hu=null)}function rv(r){if(r.propertyName==="value"&&Sf(fu)){var o=[];ev(o,fu,r,x2(r)),H3(qL,o)}}function XL(r,o,u){r==="focusin"?(iv(),hu=o,fu=u,hu.attachEvent("onpropertychange",rv)):r==="focusout"&&iv()}function WL(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Sf(fu)}function ZL(r,o){if(r==="click")return Sf(o)}function JL(r,o){if(r==="input"||r==="change")return Sf(o)}function ek(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var qn=typeof Object.is=="function"?Object.is:ek;function du(r,o){if(qn(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var u=Object.keys(r),d=Object.keys(o);if(u.length!==d.length)return!1;for(d=0;d<u.length;d++){var p=u[d];if(!jn.call(o,p)||!qn(r[p],o[p]))return!1}return!0}function av(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function lv(r,o){var u=av(r);r=0;for(var d;u;){if(u.nodeType===3){if(d=r+u.textContent.length,r<=o&&d>=o)return{node:u,offset:o-r};r=d}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=av(u)}}function ov(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?ov(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function cv(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=pf(r.document);o instanceof r.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)r=o.contentWindow;else break;o=pf(r.document)}return o}function D2(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}function tk(r,o){var u=cv(o);o=r.focusedElem;var d=r.selectionRange;if(u!==o&&o&&o.ownerDocument&&ov(o.ownerDocument.documentElement,o)){if(d!==null&&D2(o)){if(r=d.start,u=d.end,u===void 0&&(u=r),"selectionStart"in o)o.selectionStart=r,o.selectionEnd=Math.min(u,o.value.length);else if(u=(r=o.ownerDocument||document)&&r.defaultView||window,u.getSelection){u=u.getSelection();var p=o.textContent.length,E=Math.min(d.start,p);d=d.end===void 0?E:Math.min(d.end,p),!u.extend&&E>d&&(p=d,d=E,E=p),p=lv(o,E);var w=lv(o,d);p&&w&&(u.rangeCount!==1||u.anchorNode!==p.node||u.anchorOffset!==p.offset||u.focusNode!==w.node||u.focusOffset!==w.offset)&&(r=r.createRange(),r.setStart(p.node,p.offset),u.removeAllRanges(),E>d?(u.addRange(r),u.extend(w.node,w.offset)):(r.setEnd(w.node,w.offset),u.addRange(r)))}}for(r=[],u=o;u=u.parentNode;)u.nodeType===1&&r.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<r.length;o++)u=r[o],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var nk=Ci&&"documentMode"in document&&11>=document.documentMode,io=null,C2=null,gu=null,_2=!1;function uv(r,o,u){var d=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;_2||io==null||io!==pf(d)||(d=io,"selectionStart"in d&&D2(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),gu&&du(gu,d)||(gu=d,d=r0(C2,"onSelect"),0<d.length&&(o=new bf("onSelect","select",null,o,u),r.push({event:o,listeners:d}),o.target=io)))}function Ba(r,o){var u={};return u[r.toLowerCase()]=o.toLowerCase(),u["Webkit"+r]="webkit"+o,u["Moz"+r]="moz"+o,u}var ro={animationend:Ba("Animation","AnimationEnd"),animationiteration:Ba("Animation","AnimationIteration"),animationstart:Ba("Animation","AnimationStart"),transitionrun:Ba("Transition","TransitionRun"),transitionstart:Ba("Transition","TransitionStart"),transitioncancel:Ba("Transition","TransitionCancel"),transitionend:Ba("Transition","TransitionEnd")},O2={},hv={};Ci&&(hv=document.createElement("div").style,"AnimationEvent"in window||(delete ro.animationend.animation,delete ro.animationiteration.animation,delete ro.animationstart.animation),"TransitionEvent"in window||delete ro.transitionend.transition);function Ua(r){if(O2[r])return O2[r];if(!ro[r])return r;var o=ro[r],u;for(u in o)if(o.hasOwnProperty(u)&&u in hv)return O2[r]=o[u];return r}var fv=Ua("animationend"),dv=Ua("animationiteration"),gv=Ua("animationstart"),sk=Ua("transitionrun"),ik=Ua("transitionstart"),rk=Ua("transitioncancel"),mv=Ua("transitionend"),pv=new Map,yv="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Os(r,o){pv.set(r,o),Pa(o,[r])}var hs=[],ao=0,M2=0;function Tf(){for(var r=ao,o=M2=ao=0;o<r;){var u=hs[o];hs[o++]=null;var d=hs[o];hs[o++]=null;var p=hs[o];hs[o++]=null;var E=hs[o];if(hs[o++]=null,d!==null&&p!==null){var w=d.pending;w===null?p.next=p:(p.next=w.next,w.next=p),d.pending=p}E!==0&&vv(u,p,E)}}function wf(r,o,u,d){hs[ao++]=r,hs[ao++]=o,hs[ao++]=u,hs[ao++]=d,M2|=d,r.lanes|=d,r=r.alternate,r!==null&&(r.lanes|=d)}function P2(r,o,u,d){return wf(r,o,u,d),Rf(r)}function Cr(r,o){return wf(r,null,null,o),Rf(r)}function vv(r,o,u){r.lanes|=u;var d=r.alternate;d!==null&&(d.lanes|=u);for(var p=!1,E=r.return;E!==null;)E.childLanes|=u,d=E.alternate,d!==null&&(d.childLanes|=u),E.tag===22&&(r=E.stateNode,r===null||r._visibility&1||(p=!0)),r=E,E=E.return;p&&o!==null&&r.tag===3&&(E=r.stateNode,p=31-Qn(u),E=E.hiddenUpdates,r=E[p],r===null?E[p]=[o]:r.push(o),o.lane=u|536870912)}function Rf(r){if(50<Fu)throw Fu=0,$g=null,Error(n(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var lo={},xv=new WeakMap;function fs(r,o){if(typeof r=="object"&&r!==null){var u=xv.get(r);return u!==void 0?u:(o={value:r,source:o,stack:te(o)},xv.set(r,o),o)}return{value:r,source:o,stack:te(o)}}var oo=[],co=0,Lf=null,kf=0,ds=[],gs=0,Fa=null,Oi=1,Mi="";function Ga(r,o){oo[co++]=kf,oo[co++]=Lf,Lf=r,kf=o}function Ev(r,o,u){ds[gs++]=Oi,ds[gs++]=Mi,ds[gs++]=Fa,Fa=r;var d=Oi;r=Mi;var p=32-Qn(d)-1;d&=~(1<<p),u+=1;var E=32-Qn(o)+p;if(30<E){var w=p-p%5;E=(d&(1<<w)-1).toString(32),d>>=w,p-=w,Oi=1<<32-Qn(o)+p|u<<p|d,Mi=E+r}else Oi=1<<E|u<<p|d,Mi=r}function N2(r){r.return!==null&&(Ga(r,1),Ev(r,1,0))}function B2(r){for(;r===Lf;)Lf=oo[--co],oo[co]=null,kf=oo[--co],oo[co]=null;for(;r===Fa;)Fa=ds[--gs],ds[gs]=null,Mi=ds[--gs],ds[gs]=null,Oi=ds[--gs],ds[gs]=null}var Ln=null,hn=null,st=!1,Ms=null,si=!1,U2=Error(n(519));function $a(r){var o=Error(n(418,""));throw yu(fs(o,r)),U2}function bv(r){var o=r.stateNode,u=r.type,d=r.memoizedProps;switch(o[xn]=r,o[Bn]=d,u){case"dialog":Ze("cancel",o),Ze("close",o);break;case"iframe":case"object":case"embed":Ze("load",o);break;case"video":case"audio":for(u=0;u<$u.length;u++)Ze($u[u],o);break;case"source":Ze("error",o);break;case"img":case"image":case"link":Ze("error",o),Ze("load",o);break;case"details":Ze("toggle",o);break;case"input":Ze("invalid",o),N3(o,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),mf(o);break;case"select":Ze("invalid",o);break;case"textarea":Ze("invalid",o),U3(o,d.value,d.defaultValue,d.children),mf(o)}u=d.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||d.suppressHydrationWarning===!0||D1(o.textContent,u)?(d.popover!=null&&(Ze("beforetoggle",o),Ze("toggle",o)),d.onScroll!=null&&Ze("scroll",o),d.onScrollEnd!=null&&Ze("scrollend",o),d.onClick!=null&&(o.onclick=a0),o=!0):o=!1,o||$a(r)}function Av(r){for(Ln=r.return;Ln;)switch(Ln.tag){case 3:case 27:si=!0;return;case 5:case 13:si=!1;return;default:Ln=Ln.return}}function mu(r){if(r!==Ln)return!1;if(!st)return Av(r),st=!0,!1;var o=!1,u;if((u=r.tag!==3&&r.tag!==27)&&((u=r.tag===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||im(r.type,r.memoizedProps)),u=!u),u&&(o=!0),o&&hn&&$a(r),Av(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));e:{for(r=r.nextSibling,o=0;r;){if(r.nodeType===8)if(u=r.data,u==="/$"){if(o===0){hn=Ns(r.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;r=r.nextSibling}hn=null}}else hn=Ln?Ns(r.stateNode.nextSibling):null;return!0}function pu(){hn=Ln=null,st=!1}function yu(r){Ms===null?Ms=[r]:Ms.push(r)}var vu=Error(n(460)),Sv=Error(n(474)),F2={then:function(){}};function Tv(r){return r=r.status,r==="fulfilled"||r==="rejected"}function If(){}function wv(r,o,u){switch(u=r[u],u===void 0?r.push(o):u!==o&&(o.then(If,If),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,r===vu?Error(n(483)):r;default:if(typeof o.status=="string")o.then(If,If);else{if(r=vt,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=o,r.status="pending",r.then(function(d){if(o.status==="pending"){var p=o;p.status="fulfilled",p.value=d}},function(d){if(o.status==="pending"){var p=o;p.status="rejected",p.reason=d}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,r===vu?Error(n(483)):r}throw xu=o,vu}}var xu=null;function Rv(){if(xu===null)throw Error(n(459));var r=xu;return xu=null,r}var uo=null,Eu=0;function Df(r){var o=Eu;return Eu+=1,uo===null&&(uo=[]),wv(uo,r,o)}function bu(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function Cf(r,o){throw o.$$typeof===a?Error(n(525)):(r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function Lv(r){var o=r._init;return o(r._payload)}function kv(r){function o(K,$){if(r){var q=K.deletions;q===null?(K.deletions=[$],K.flags|=16):q.push($)}}function u(K,$){if(!r)return null;for(;$!==null;)o(K,$),$=$.sibling;return null}function d(K){for(var $=new Map;K!==null;)K.key!==null?$.set(K.key,K):$.set(K.index,K),K=K.sibling;return $}function p(K,$){return K=zr(K,$),K.index=0,K.sibling=null,K}function E(K,$,q){return K.index=q,r?(q=K.alternate,q!==null?(q=q.index,q<$?(K.flags|=33554434,$):q):(K.flags|=33554434,$)):(K.flags|=1048576,$)}function w(K){return r&&K.alternate===null&&(K.flags|=33554434),K}function D(K,$,q,he){return $===null||$.tag!==6?($=Og(q,K.mode,he),$.return=K,$):($=p($,q),$.return=K,$)}function N(K,$,q,he){var Se=q.type;return Se===h?le(K,$,q.props.children,he,q.key):$!==null&&($.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===k&&Lv(Se)===$.type)?($=p($,q.props),bu($,q),$.return=K,$):($=qf(q.type,q.key,q.props,null,K.mode,he),bu($,q),$.return=K,$)}function z(K,$,q,he){return $===null||$.tag!==4||$.stateNode.containerInfo!==q.containerInfo||$.stateNode.implementation!==q.implementation?($=Mg(q,K.mode,he),$.return=K,$):($=p($,q.children||[]),$.return=K,$)}function le(K,$,q,he,Se){return $===null||$.tag!==7?($=Wa(q,K.mode,he,Se),$.return=K,$):($=p($,q),$.return=K,$)}function de(K,$,q){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Og(""+$,K.mode,q),$.return=K,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case l:return q=qf($.type,$.key,$.props,null,K.mode,q),bu(q,$),q.return=K,q;case c:return $=Mg($,K.mode,q),$.return=K,$;case k:var he=$._init;return $=he($._payload),de(K,$,q)}if(ce($)||U($))return $=Wa($,K.mode,q,null),$.return=K,$;if(typeof $.then=="function")return de(K,Df($),q);if($.$$typeof===v)return de(K,Yf(K,$),q);Cf(K,$)}return null}function ee(K,$,q,he){var Se=$!==null?$.key:null;if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return Se!==null?null:D(K,$,""+q,he);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case l:return q.key===Se?N(K,$,q,he):null;case c:return q.key===Se?z(K,$,q,he):null;case k:return Se=q._init,q=Se(q._payload),ee(K,$,q,he)}if(ce(q)||U(q))return Se!==null?null:le(K,$,q,he,null);if(typeof q.then=="function")return ee(K,$,Df(q),he);if(q.$$typeof===v)return ee(K,$,Yf(K,q),he);Cf(K,q)}return null}function re(K,$,q,he,Se){if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return K=K.get(q)||null,D($,K,""+he,Se);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case l:return K=K.get(he.key===null?q:he.key)||null,N($,K,he,Se);case c:return K=K.get(he.key===null?q:he.key)||null,z($,K,he,Se);case k:var Qe=he._init;return he=Qe(he._payload),re(K,$,q,he,Se)}if(ce(he)||U(he))return K=K.get(q)||null,le($,K,he,Se,null);if(typeof he.then=="function")return re(K,$,q,Df(he),Se);if(he.$$typeof===v)return re(K,$,q,Yf($,he),Se);Cf($,he)}return null}function Le(K,$,q,he){for(var Se=null,Qe=null,Ie=$,Pe=$=0,nn=null;Ie!==null&&Pe<q.length;Pe++){Ie.index>Pe?(nn=Ie,Ie=null):nn=Ie.sibling;var it=ee(K,Ie,q[Pe],he);if(it===null){Ie===null&&(Ie=nn);break}r&&Ie&&it.alternate===null&&o(K,Ie),$=E(it,$,Pe),Qe===null?Se=it:Qe.sibling=it,Qe=it,Ie=nn}if(Pe===q.length)return u(K,Ie),st&&Ga(K,Pe),Se;if(Ie===null){for(;Pe<q.length;Pe++)Ie=de(K,q[Pe],he),Ie!==null&&($=E(Ie,$,Pe),Qe===null?Se=Ie:Qe.sibling=Ie,Qe=Ie);return st&&Ga(K,Pe),Se}for(Ie=d(Ie);Pe<q.length;Pe++)nn=re(Ie,K,Pe,q[Pe],he),nn!==null&&(r&&nn.alternate!==null&&Ie.delete(nn.key===null?Pe:nn.key),$=E(nn,$,Pe),Qe===null?Se=nn:Qe.sibling=nn,Qe=nn);return r&&Ie.forEach(function(Xr){return o(K,Xr)}),st&&Ga(K,Pe),Se}function Fe(K,$,q,he){if(q==null)throw Error(n(151));for(var Se=null,Qe=null,Ie=$,Pe=$=0,nn=null,it=q.next();Ie!==null&&!it.done;Pe++,it=q.next()){Ie.index>Pe?(nn=Ie,Ie=null):nn=Ie.sibling;var Xr=ee(K,Ie,it.value,he);if(Xr===null){Ie===null&&(Ie=nn);break}r&&Ie&&Xr.alternate===null&&o(K,Ie),$=E(Xr,$,Pe),Qe===null?Se=Xr:Qe.sibling=Xr,Qe=Xr,Ie=nn}if(it.done)return u(K,Ie),st&&Ga(K,Pe),Se;if(Ie===null){for(;!it.done;Pe++,it=q.next())it=de(K,it.value,he),it!==null&&($=E(it,$,Pe),Qe===null?Se=it:Qe.sibling=it,Qe=it);return st&&Ga(K,Pe),Se}for(Ie=d(Ie);!it.done;Pe++,it=q.next())it=re(Ie,K,Pe,it.value,he),it!==null&&(r&&it.alternate!==null&&Ie.delete(it.key===null?Pe:it.key),$=E(it,$,Pe),Qe===null?Se=it:Qe.sibling=it,Qe=it);return r&&Ie.forEach(function(xI){return o(K,xI)}),st&&Ga(K,Pe),Se}function Mt(K,$,q,he){if(typeof q=="object"&&q!==null&&q.type===h&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case l:e:{for(var Se=q.key;$!==null;){if($.key===Se){if(Se=q.type,Se===h){if($.tag===7){u(K,$.sibling),he=p($,q.props.children),he.return=K,K=he;break e}}else if($.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===k&&Lv(Se)===$.type){u(K,$.sibling),he=p($,q.props),bu(he,q),he.return=K,K=he;break e}u(K,$);break}else o(K,$);$=$.sibling}q.type===h?(he=Wa(q.props.children,K.mode,he,q.key),he.return=K,K=he):(he=qf(q.type,q.key,q.props,null,K.mode,he),bu(he,q),he.return=K,K=he)}return w(K);case c:e:{for(Se=q.key;$!==null;){if($.key===Se)if($.tag===4&&$.stateNode.containerInfo===q.containerInfo&&$.stateNode.implementation===q.implementation){u(K,$.sibling),he=p($,q.children||[]),he.return=K,K=he;break e}else{u(K,$);break}else o(K,$);$=$.sibling}he=Mg(q,K.mode,he),he.return=K,K=he}return w(K);case k:return Se=q._init,q=Se(q._payload),Mt(K,$,q,he)}if(ce(q))return Le(K,$,q,he);if(U(q)){if(Se=U(q),typeof Se!="function")throw Error(n(150));return q=Se.call(q),Fe(K,$,q,he)}if(typeof q.then=="function")return Mt(K,$,Df(q),he);if(q.$$typeof===v)return Mt(K,$,Yf(K,q),he);Cf(K,q)}return typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint"?(q=""+q,$!==null&&$.tag===6?(u(K,$.sibling),he=p($,q),he.return=K,K=he):(u(K,$),he=Og(q,K.mode,he),he.return=K,K=he),w(K)):u(K,$)}return function(K,$,q,he){try{Eu=0;var Se=Mt(K,$,q,he);return uo=null,Se}catch(Ie){if(Ie===vu)throw Ie;var Qe=vs(29,Ie,null,K.mode);return Qe.lanes=he,Qe.return=K,Qe}finally{}}}var Ha=kv(!0),Iv=kv(!1),ho=ke(null),_f=ke(0);function Dv(r,o){r=Ki,Ke(_f,r),Ke(ho,o),Ki=r|o.baseLanes}function G2(){Ke(_f,Ki),Ke(ho,ho.current)}function $2(){Ki=_f.current,Ne(ho),Ne(_f)}var ms=ke(null),ii=null;function _r(r){var o=r.alternate;Ke(jt,jt.current&1),Ke(ms,r),ii===null&&(o===null||ho.current!==null||o.memoizedState!==null)&&(ii=r)}function Cv(r){if(r.tag===22){if(Ke(jt,jt.current),Ke(ms,r),ii===null){var o=r.alternate;o!==null&&o.memoizedState!==null&&(ii=r)}}else Or()}function Or(){Ke(jt,jt.current),Ke(ms,ms.current)}function Pi(r){Ne(ms),ii===r&&(ii=null),Ne(jt)}var jt=ke(0);function Of(r){for(var o=r;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var ak=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(u,d){r.push(d)}};this.abort=function(){o.aborted=!0,r.forEach(function(u){return u()})}},lk=s.unstable_scheduleCallback,ok=s.unstable_NormalPriority,Qt={$$typeof:v,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function H2(){return{controller:new ak,data:new Map,refCount:0}}function Au(r){r.refCount--,r.refCount===0&&lk(ok,function(){r.controller.abort()})}var Su=null,z2=0,fo=0,go=null;function ck(r,o){if(Su===null){var u=Su=[];z2=0,fo=qg(),go={status:"pending",value:void 0,then:function(d){u.push(d)}}}return z2++,o.then(_v,_v),o}function _v(){if(--z2===0&&Su!==null){go!==null&&(go.status="fulfilled");var r=Su;Su=null,fo=0,go=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function uk(r,o){var u=[],d={status:"pending",value:null,reason:null,then:function(p){u.push(p)}};return r.then(function(){d.status="fulfilled",d.value=o;for(var p=0;p<u.length;p++)(0,u[p])(o)},function(p){for(d.status="rejected",d.reason=p,p=0;p<u.length;p++)(0,u[p])(void 0)}),d}var Ov=F.S;F.S=function(r,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&ck(r,o),Ov!==null&&Ov(r,o)};var za=ke(null);function V2(){var r=za.current;return r!==null?r:vt.pooledCache}function Mf(r,o){o===null?Ke(za,za.current):Ke(za,o.pool)}function Mv(){var r=V2();return r===null?null:{parent:Qt._currentValue,pool:r}}var Mr=0,je=null,ft=null,zt=null,Pf=!1,mo=!1,Va=!1,Nf=0,Tu=0,po=null,hk=0;function Bt(){throw Error(n(321))}function K2(r,o){if(o===null)return!1;for(var u=0;u<o.length&&u<r.length;u++)if(!qn(r[u],o[u]))return!1;return!0}function Y2(r,o,u,d,p,E){return Mr=E,je=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,F.H=r===null||r.memoizedState===null?Ka:Pr,Va=!1,E=u(d,p),Va=!1,mo&&(E=Nv(o,u,d,p)),Pv(r),E}function Pv(r){F.H=ri;var o=ft!==null&&ft.next!==null;if(Mr=0,zt=ft=je=null,Pf=!1,Tu=0,po=null,o)throw Error(n(300));r===null||en||(r=r.dependencies,r!==null&&Kf(r)&&(en=!0))}function Nv(r,o,u,d){je=r;var p=0;do{if(mo&&(po=null),Tu=0,mo=!1,25<=p)throw Error(n(301));if(p+=1,zt=ft=null,r.updateQueue!=null){var E=r.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}F.H=Ya,E=o(u,d)}while(mo);return E}function fk(){var r=F.H,o=r.useState()[0];return o=typeof o.then=="function"?wu(o):o,r=r.useState()[0],(ft!==null?ft.memoizedState:null)!==r&&(je.flags|=1024),o}function j2(){var r=Nf!==0;return Nf=0,r}function Q2(r,o,u){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~u}function q2(r){if(Pf){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Pf=!1}Mr=0,zt=ft=je=null,mo=!1,Tu=Nf=0,po=null}function Fn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?je.memoizedState=zt=r:zt=zt.next=r,zt}function Vt(){if(ft===null){var r=je.alternate;r=r!==null?r.memoizedState:null}else r=ft.next;var o=zt===null?je.memoizedState:zt.next;if(o!==null)zt=o,ft=r;else{if(r===null)throw je.alternate===null?Error(n(467)):Error(n(310));ft=r,r={memoizedState:ft.memoizedState,baseState:ft.baseState,baseQueue:ft.baseQueue,queue:ft.queue,next:null},zt===null?je.memoizedState=zt=r:zt=zt.next=r}return zt}var Bf;Bf=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function wu(r){var o=Tu;return Tu+=1,po===null&&(po=[]),r=wv(po,r,o),o=je,(zt===null?o.memoizedState:zt.next)===null&&(o=o.alternate,F.H=o===null||o.memoizedState===null?Ka:Pr),r}function Uf(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return wu(r);if(r.$$typeof===v)return En(r)}throw Error(n(438,String(r)))}function X2(r){var o=null,u=je.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var d=je.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(o={data:d.data.map(function(p){return p.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Bf(),je.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(r),d=0;d<r;d++)u[d]=_;return o.index++,u}function Ni(r,o){return typeof o=="function"?o(r):o}function Ff(r){var o=Vt();return W2(o,ft,r)}function W2(r,o,u){var d=r.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=u;var p=r.baseQueue,E=d.pending;if(E!==null){if(p!==null){var w=p.next;p.next=E.next,E.next=w}o.baseQueue=p=E,d.pending=null}if(E=r.baseState,p===null)r.memoizedState=E;else{o=p.next;var D=w=null,N=null,z=o,le=!1;do{var de=z.lane&-536870913;if(de!==z.lane?(et&de)===de:(Mr&de)===de){var ee=z.revertLane;if(ee===0)N!==null&&(N=N.next={lane:0,revertLane:0,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null}),de===fo&&(le=!0);else if((Mr&ee)===ee){z=z.next,ee===fo&&(le=!0);continue}else de={lane:0,revertLane:z.revertLane,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null},N===null?(D=N=de,w=E):N=N.next=de,je.lanes|=ee,Vr|=ee;de=z.action,Va&&u(E,de),E=z.hasEagerState?z.eagerState:u(E,de)}else ee={lane:de,revertLane:z.revertLane,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null},N===null?(D=N=ee,w=E):N=N.next=ee,je.lanes|=de,Vr|=de;z=z.next}while(z!==null&&z!==o);if(N===null?w=E:N.next=D,!qn(E,r.memoizedState)&&(en=!0,le&&(u=go,u!==null)))throw u;r.memoizedState=E,r.baseState=w,r.baseQueue=N,d.lastRenderedState=E}return p===null&&(d.lanes=0),[r.memoizedState,d.dispatch]}function Z2(r){var o=Vt(),u=o.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=r;var d=u.dispatch,p=u.pending,E=o.memoizedState;if(p!==null){u.pending=null;var w=p=p.next;do E=r(E,w.action),w=w.next;while(w!==p);qn(E,o.memoizedState)||(en=!0),o.memoizedState=E,o.baseQueue===null&&(o.baseState=E),u.lastRenderedState=E}return[E,d]}function Bv(r,o,u){var d=je,p=Vt(),E=st;if(E){if(u===void 0)throw Error(n(407));u=u()}else u=o();var w=!qn((ft||p).memoizedState,u);if(w&&(p.memoizedState=u,en=!0),p=p.queue,tg(Gv.bind(null,d,p,r),[r]),p.getSnapshot!==o||w||zt!==null&&zt.memoizedState.tag&1){if(d.flags|=2048,yo(9,Fv.bind(null,d,p,u,o),{destroy:void 0},null),vt===null)throw Error(n(349));E||(Mr&60)!==0||Uv(d,o,u)}return u}function Uv(r,o,u){r.flags|=16384,r={getSnapshot:o,value:u},o=je.updateQueue,o===null?(o=Bf(),je.updateQueue=o,o.stores=[r]):(u=o.stores,u===null?o.stores=[r]:u.push(r))}function Fv(r,o,u,d){o.value=u,o.getSnapshot=d,$v(o)&&Hv(r)}function Gv(r,o,u){return u(function(){$v(o)&&Hv(r)})}function $v(r){var o=r.getSnapshot;r=r.value;try{var u=o();return!qn(r,u)}catch{return!0}}function Hv(r){var o=Cr(r,2);o!==null&&kn(o,r,2)}function J2(r){var o=Fn();if(typeof r=="function"){var u=r;if(r=u(),Va){ni(!0);try{u()}finally{ni(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ni,lastRenderedState:r},o}function zv(r,o,u,d){return r.baseState=u,W2(r,ft,typeof d=="function"?d:Ni)}function dk(r,o,u,d,p){if(Hf(r))throw Error(n(485));if(r=o.action,r!==null){var E={payload:p,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){E.listeners.push(w)}};F.T!==null?u(!0):E.isTransition=!1,d(E),u=o.pending,u===null?(E.next=o.pending=E,Vv(o,E)):(E.next=u.next,o.pending=u.next=E)}}function Vv(r,o){var u=o.action,d=o.payload,p=r.state;if(o.isTransition){var E=F.T,w={};F.T=w;try{var D=u(p,d),N=F.S;N!==null&&N(w,D),Kv(r,o,D)}catch(z){eg(r,o,z)}finally{F.T=E}}else try{E=u(p,d),Kv(r,o,E)}catch(z){eg(r,o,z)}}function Kv(r,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(d){Yv(r,o,d)},function(d){return eg(r,o,d)}):Yv(r,o,u)}function Yv(r,o,u){o.status="fulfilled",o.value=u,jv(o),r.state=u,o=r.pending,o!==null&&(u=o.next,u===o?r.pending=null:(u=u.next,o.next=u,Vv(r,u)))}function eg(r,o,u){var d=r.pending;if(r.pending=null,d!==null){d=d.next;do o.status="rejected",o.reason=u,jv(o),o=o.next;while(o!==d)}r.action=null}function jv(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function Qv(r,o){return o}function qv(r,o){if(st){var u=vt.formState;if(u!==null){e:{var d=je;if(st){if(hn){t:{for(var p=hn,E=si;p.nodeType!==8;){if(!E){p=null;break t}if(p=Ns(p.nextSibling),p===null){p=null;break t}}E=p.data,p=E==="F!"||E==="F"?p:null}if(p){hn=Ns(p.nextSibling),d=p.data==="F!";break e}}$a(d)}d=!1}d&&(o=u[0])}}return u=Fn(),u.memoizedState=u.baseState=o,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qv,lastRenderedState:o},u.queue=d,u=dx.bind(null,je,d),d.dispatch=u,d=J2(!1),E=ag.bind(null,je,!1,d.queue),d=Fn(),p={state:o,dispatch:null,action:r,pending:null},d.queue=p,u=dk.bind(null,je,p,E,u),p.dispatch=u,d.memoizedState=r,[o,u,!1]}function Xv(r){var o=Vt();return Wv(o,ft,r)}function Wv(r,o,u){o=W2(r,o,Qv)[0],r=Ff(Ni)[0],o=typeof o=="object"&&o!==null&&typeof o.then=="function"?wu(o):o;var d=Vt(),p=d.queue,E=p.dispatch;return u!==d.memoizedState&&(je.flags|=2048,yo(9,gk.bind(null,p,u),{destroy:void 0},null)),[o,E,r]}function gk(r,o){r.action=o}function Zv(r){var o=Vt(),u=ft;if(u!==null)return Wv(o,u,r);Vt(),o=o.memoizedState,u=Vt();var d=u.queue.dispatch;return u.memoizedState=r,[o,d,!1]}function yo(r,o,u,d){return r={tag:r,create:o,inst:u,deps:d,next:null},o=je.updateQueue,o===null&&(o=Bf(),je.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=r.next=r:(d=u.next,u.next=r,r.next=d,o.lastEffect=r),r}function Jv(){return Vt().memoizedState}function Gf(r,o,u,d){var p=Fn();je.flags|=r,p.memoizedState=yo(1|o,u,{destroy:void 0},d===void 0?null:d)}function $f(r,o,u,d){var p=Vt();d=d===void 0?null:d;var E=p.memoizedState.inst;ft!==null&&d!==null&&K2(d,ft.memoizedState.deps)?p.memoizedState=yo(o,u,E,d):(je.flags|=r,p.memoizedState=yo(1|o,u,E,d))}function ex(r,o){Gf(8390656,8,r,o)}function tg(r,o){$f(2048,8,r,o)}function tx(r,o){return $f(4,2,r,o)}function nx(r,o){return $f(4,4,r,o)}function sx(r,o){if(typeof o=="function"){r=r();var u=o(r);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function ix(r,o,u){u=u!=null?u.concat([r]):null,$f(4,4,sx.bind(null,o,r),u)}function ng(){}function rx(r,o){var u=Vt();o=o===void 0?null:o;var d=u.memoizedState;return o!==null&&K2(o,d[1])?d[0]:(u.memoizedState=[r,o],r)}function ax(r,o){var u=Vt();o=o===void 0?null:o;var d=u.memoizedState;if(o!==null&&K2(o,d[1]))return d[0];if(d=r(),Va){ni(!0);try{r()}finally{ni(!1)}}return u.memoizedState=[d,o],d}function sg(r,o,u){return u===void 0||(Mr&1073741824)!==0?r.memoizedState=o:(r.memoizedState=u,r=o1(),je.lanes|=r,Vr|=r,u)}function lx(r,o,u,d){return qn(u,o)?u:ho.current!==null?(r=sg(r,u,d),qn(r,o)||(en=!0),r):(Mr&42)===0?(en=!0,r.memoizedState=u):(r=o1(),je.lanes|=r,Vr|=r,o)}function ox(r,o,u,d,p){var E=ue.p;ue.p=E!==0&&8>E?E:8;var w=F.T,D={};F.T=D,ag(r,!1,o,u);try{var N=p(),z=F.S;if(z!==null&&z(D,N),N!==null&&typeof N=="object"&&typeof N.then=="function"){var le=uk(N,d);Ru(r,o,le,Jn(r))}else Ru(r,o,d,Jn(r))}catch(de){Ru(r,o,{then:function(){},status:"rejected",reason:de},Jn())}finally{ue.p=E,F.T=w}}function mk(){}function ig(r,o,u,d){if(r.tag!==5)throw Error(n(476));var p=cx(r).queue;ox(r,p,o,xe,u===null?mk:function(){return ux(r),u(d)})}function cx(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:xe,baseState:xe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ni,lastRenderedState:xe},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ni,lastRenderedState:u},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function ux(r){var o=cx(r).next.queue;Ru(r,o,{},Jn())}function rg(){return En(Yu)}function hx(){return Vt().memoizedState}function fx(){return Vt().memoizedState}function pk(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var u=Jn();r=Ur(u);var d=Fr(o,r,u);d!==null&&(kn(d,o,u),Iu(d,o,u)),o={cache:H2()},r.payload=o;return}o=o.return}}function yk(r,o,u){var d=Jn();u={lane:d,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Hf(r)?gx(o,u):(u=P2(r,o,u,d),u!==null&&(kn(u,r,d),mx(u,o,d)))}function dx(r,o,u){var d=Jn();Ru(r,o,u,d)}function Ru(r,o,u,d){var p={lane:d,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Hf(r))gx(o,p);else{var E=r.alternate;if(r.lanes===0&&(E===null||E.lanes===0)&&(E=o.lastRenderedReducer,E!==null))try{var w=o.lastRenderedState,D=E(w,u);if(p.hasEagerState=!0,p.eagerState=D,qn(D,w))return wf(r,o,p,0),vt===null&&Tf(),!1}catch{}finally{}if(u=P2(r,o,p,d),u!==null)return kn(u,r,d),mx(u,o,d),!0}return!1}function ag(r,o,u,d){if(d={lane:2,revertLane:qg(),action:d,hasEagerState:!1,eagerState:null,next:null},Hf(r)){if(o)throw Error(n(479))}else o=P2(r,u,d,2),o!==null&&kn(o,r,2)}function Hf(r){var o=r.alternate;return r===je||o!==null&&o===je}function gx(r,o){mo=Pf=!0;var u=r.pending;u===null?o.next=o:(o.next=u.next,u.next=o),r.pending=o}function mx(r,o,u){if((u&4194176)!==0){var d=o.lanes;d&=r.pendingLanes,u|=d,o.lanes=u,R3(r,u)}}var ri={readContext:En,use:Uf,useCallback:Bt,useContext:Bt,useEffect:Bt,useImperativeHandle:Bt,useLayoutEffect:Bt,useInsertionEffect:Bt,useMemo:Bt,useReducer:Bt,useRef:Bt,useState:Bt,useDebugValue:Bt,useDeferredValue:Bt,useTransition:Bt,useSyncExternalStore:Bt,useId:Bt};ri.useCacheRefresh=Bt,ri.useMemoCache=Bt,ri.useHostTransitionStatus=Bt,ri.useFormState=Bt,ri.useActionState=Bt,ri.useOptimistic=Bt;var Ka={readContext:En,use:Uf,useCallback:function(r,o){return Fn().memoizedState=[r,o===void 0?null:o],r},useContext:En,useEffect:ex,useImperativeHandle:function(r,o,u){u=u!=null?u.concat([r]):null,Gf(4194308,4,sx.bind(null,o,r),u)},useLayoutEffect:function(r,o){return Gf(4194308,4,r,o)},useInsertionEffect:function(r,o){Gf(4,2,r,o)},useMemo:function(r,o){var u=Fn();o=o===void 0?null:o;var d=r();if(Va){ni(!0);try{r()}finally{ni(!1)}}return u.memoizedState=[d,o],d},useReducer:function(r,o,u){var d=Fn();if(u!==void 0){var p=u(o);if(Va){ni(!0);try{u(o)}finally{ni(!1)}}}else p=o;return d.memoizedState=d.baseState=p,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:p},d.queue=r,r=r.dispatch=yk.bind(null,je,r),[d.memoizedState,r]},useRef:function(r){var o=Fn();return r={current:r},o.memoizedState=r},useState:function(r){r=J2(r);var o=r.queue,u=dx.bind(null,je,o);return o.dispatch=u,[r.memoizedState,u]},useDebugValue:ng,useDeferredValue:function(r,o){var u=Fn();return sg(u,r,o)},useTransition:function(){var r=J2(!1);return r=ox.bind(null,je,r.queue,!0,!1),Fn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,u){var d=je,p=Fn();if(st){if(u===void 0)throw Error(n(407));u=u()}else{if(u=o(),vt===null)throw Error(n(349));(et&60)!==0||Uv(d,o,u)}p.memoizedState=u;var E={value:u,getSnapshot:o};return p.queue=E,ex(Gv.bind(null,d,E,r),[r]),d.flags|=2048,yo(9,Fv.bind(null,d,E,u,o),{destroy:void 0},null),u},useId:function(){var r=Fn(),o=vt.identifierPrefix;if(st){var u=Mi,d=Oi;u=(d&~(1<<32-Qn(d)-1)).toString(32)+u,o=":"+o+"R"+u,u=Nf++,0<u&&(o+="H"+u.toString(32)),o+=":"}else u=hk++,o=":"+o+"r"+u.toString(32)+":";return r.memoizedState=o},useCacheRefresh:function(){return Fn().memoizedState=pk.bind(null,je)}};Ka.useMemoCache=X2,Ka.useHostTransitionStatus=rg,Ka.useFormState=qv,Ka.useActionState=qv,Ka.useOptimistic=function(r){var o=Fn();o.memoizedState=o.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=ag.bind(null,je,!0,u),u.dispatch=o,[r,o]};var Pr={readContext:En,use:Uf,useCallback:rx,useContext:En,useEffect:tg,useImperativeHandle:ix,useInsertionEffect:tx,useLayoutEffect:nx,useMemo:ax,useReducer:Ff,useRef:Jv,useState:function(){return Ff(Ni)},useDebugValue:ng,useDeferredValue:function(r,o){var u=Vt();return lx(u,ft.memoizedState,r,o)},useTransition:function(){var r=Ff(Ni)[0],o=Vt().memoizedState;return[typeof r=="boolean"?r:wu(r),o]},useSyncExternalStore:Bv,useId:hx};Pr.useCacheRefresh=fx,Pr.useMemoCache=X2,Pr.useHostTransitionStatus=rg,Pr.useFormState=Xv,Pr.useActionState=Xv,Pr.useOptimistic=function(r,o){var u=Vt();return zv(u,ft,r,o)};var Ya={readContext:En,use:Uf,useCallback:rx,useContext:En,useEffect:tg,useImperativeHandle:ix,useInsertionEffect:tx,useLayoutEffect:nx,useMemo:ax,useReducer:Z2,useRef:Jv,useState:function(){return Z2(Ni)},useDebugValue:ng,useDeferredValue:function(r,o){var u=Vt();return ft===null?sg(u,r,o):lx(u,ft.memoizedState,r,o)},useTransition:function(){var r=Z2(Ni)[0],o=Vt().memoizedState;return[typeof r=="boolean"?r:wu(r),o]},useSyncExternalStore:Bv,useId:hx};Ya.useCacheRefresh=fx,Ya.useMemoCache=X2,Ya.useHostTransitionStatus=rg,Ya.useFormState=Zv,Ya.useActionState=Zv,Ya.useOptimistic=function(r,o){var u=Vt();return ft!==null?zv(u,ft,r,o):(u.baseState=r,[r,u.queue.dispatch])};function lg(r,o,u,d){o=r.memoizedState,u=u(d,o),u=u==null?o:M({},o,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var og={isMounted:function(r){return(r=r._reactInternals)?se(r)===r:!1},enqueueSetState:function(r,o,u){r=r._reactInternals;var d=Jn(),p=Ur(d);p.payload=o,u!=null&&(p.callback=u),o=Fr(r,p,d),o!==null&&(kn(o,r,d),Iu(o,r,d))},enqueueReplaceState:function(r,o,u){r=r._reactInternals;var d=Jn(),p=Ur(d);p.tag=1,p.payload=o,u!=null&&(p.callback=u),o=Fr(r,p,d),o!==null&&(kn(o,r,d),Iu(o,r,d))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var u=Jn(),d=Ur(u);d.tag=2,o!=null&&(d.callback=o),o=Fr(r,d,u),o!==null&&(kn(o,r,u),Iu(o,r,u))}};function px(r,o,u,d,p,E,w){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,E,w):o.prototype&&o.prototype.isPureReactComponent?!du(u,d)||!du(p,E):!0}function yx(r,o,u,d){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,d),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,d),o.state!==r&&og.enqueueReplaceState(o,o.state,null)}function ja(r,o){var u=o;if("ref"in o){u={};for(var d in o)d!=="ref"&&(u[d]=o[d])}if(r=r.defaultProps){u===o&&(u=M({},u));for(var p in r)u[p]===void 0&&(u[p]=r[p])}return u}var zf=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function vx(r){zf(r)}function xx(r){console.error(r)}function Ex(r){zf(r)}function Vf(r,o){try{var u=r.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(d){setTimeout(function(){throw d})}}function bx(r,o,u){try{var d=r.onCaughtError;d(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function cg(r,o,u){return u=Ur(u),u.tag=3,u.payload={element:null},u.callback=function(){Vf(r,o)},u}function Ax(r){return r=Ur(r),r.tag=3,r}function Sx(r,o,u,d){var p=u.type.getDerivedStateFromError;if(typeof p=="function"){var E=d.value;r.payload=function(){return p(E)},r.callback=function(){bx(o,u,d)}}var w=u.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(r.callback=function(){bx(o,u,d),typeof p!="function"&&(Kr===null?Kr=new Set([this]):Kr.add(this));var D=d.stack;this.componentDidCatch(d.value,{componentStack:D!==null?D:""})})}function vk(r,o,u,d,p){if(u.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(o=u.alternate,o!==null&&ku(o,u,p,!0),u=ms.current,u!==null){switch(u.tag){case 13:return ii===null?Vg():u.alternate===null&&Ot===0&&(Ot=3),u.flags&=-257,u.flags|=65536,u.lanes=p,d===F2?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([d]):o.add(d),Yg(r,d,p)),!1;case 22:return u.flags|=65536,d===F2?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([d])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([d]):u.add(d)),Yg(r,d,p)),!1}throw Error(n(435,u.tag))}return Yg(r,d,p),Vg(),!1}if(st)return o=ms.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=p,d!==U2&&(r=Error(n(422),{cause:d}),yu(fs(r,u)))):(d!==U2&&(o=Error(n(423),{cause:d}),yu(fs(o,u))),r=r.current.alternate,r.flags|=65536,p&=-p,r.lanes|=p,d=fs(d,u),p=cg(r.stateNode,d,p),Tg(r,p),Ot!==4&&(Ot=2)),!1;var E=Error(n(520),{cause:d});if(E=fs(E,u),Bu===null?Bu=[E]:Bu.push(E),Ot!==4&&(Ot=2),o===null)return!0;d=fs(d,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,r=p&-p,u.lanes|=r,r=cg(u.stateNode,d,r),Tg(u,r),!1;case 1:if(o=u.type,E=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Kr===null||!Kr.has(E))))return u.flags|=65536,p&=-p,u.lanes|=p,p=Ax(p),Sx(p,r,u,d),Tg(u,p),!1}u=u.return}while(u!==null);return!1}var Tx=Error(n(461)),en=!1;function fn(r,o,u,d){o.child=r===null?Iv(o,null,u,d):Ha(o,r.child,u,d)}function wx(r,o,u,d,p){u=u.render;var E=o.ref;if("ref"in d){var w={};for(var D in d)D!=="ref"&&(w[D]=d[D])}else w=d;return qa(o),d=Y2(r,o,u,w,E,p),D=j2(),r!==null&&!en?(Q2(r,o,p),Bi(r,o,p)):(st&&D&&N2(o),o.flags|=1,fn(r,o,d,p),o.child)}function Rx(r,o,u,d,p){if(r===null){var E=u.type;return typeof E=="function"&&!_g(E)&&E.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=E,Lx(r,o,E,d,p)):(r=qf(u.type,null,d,o,o.mode,p),r.ref=o.ref,r.return=o,o.child=r)}if(E=r.child,!vg(r,p)){var w=E.memoizedProps;if(u=u.compare,u=u!==null?u:du,u(w,d)&&r.ref===o.ref)return Bi(r,o,p)}return o.flags|=1,r=zr(E,d),r.ref=o.ref,r.return=o,o.child=r}function Lx(r,o,u,d,p){if(r!==null){var E=r.memoizedProps;if(du(E,d)&&r.ref===o.ref)if(en=!1,o.pendingProps=d=E,vg(r,p))(r.flags&131072)!==0&&(en=!0);else return o.lanes=r.lanes,Bi(r,o,p)}return ug(r,o,u,d,p)}function kx(r,o,u){var d=o.pendingProps,p=d.children,E=(o.stateNode._pendingVisibility&2)!==0,w=r!==null?r.memoizedState:null;if(Lu(r,o),d.mode==="hidden"||E){if((o.flags&128)!==0){if(d=w!==null?w.baseLanes|u:u,r!==null){for(p=o.child=r.child,E=0;p!==null;)E=E|p.lanes|p.childLanes,p=p.sibling;o.childLanes=E&~d}else o.childLanes=0,o.child=null;return Ix(r,o,d,u)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&Mf(o,w!==null?w.cachePool:null),w!==null?Dv(o,w):G2(),Cv(o);else return o.lanes=o.childLanes=536870912,Ix(r,o,w!==null?w.baseLanes|u:u,u)}else w!==null?(Mf(o,w.cachePool),Dv(o,w),Or(),o.memoizedState=null):(r!==null&&Mf(o,null),G2(),Or());return fn(r,o,p,u),o.child}function Ix(r,o,u,d){var p=V2();return p=p===null?null:{parent:Qt._currentValue,pool:p},o.memoizedState={baseLanes:u,cachePool:p},r!==null&&Mf(o,null),G2(),Cv(o),r!==null&&ku(r,o,d,!0),null}function Lu(r,o){var u=o.ref;if(u===null)r!==null&&r.ref!==null&&(o.flags|=2097664);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(r===null||r.ref!==u)&&(o.flags|=2097664)}}function ug(r,o,u,d,p){return qa(o),u=Y2(r,o,u,d,void 0,p),d=j2(),r!==null&&!en?(Q2(r,o,p),Bi(r,o,p)):(st&&d&&N2(o),o.flags|=1,fn(r,o,u,p),o.child)}function Dx(r,o,u,d,p,E){return qa(o),o.updateQueue=null,u=Nv(o,d,u,p),Pv(r),d=j2(),r!==null&&!en?(Q2(r,o,E),Bi(r,o,E)):(st&&d&&N2(o),o.flags|=1,fn(r,o,u,E),o.child)}function Cx(r,o,u,d,p){if(qa(o),o.stateNode===null){var E=lo,w=u.contextType;typeof w=="object"&&w!==null&&(E=En(w)),E=new u(d,E),o.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=og,o.stateNode=E,E._reactInternals=o,E=o.stateNode,E.props=d,E.state=o.memoizedState,E.refs={},Ag(o),w=u.contextType,E.context=typeof w=="object"&&w!==null?En(w):lo,E.state=o.memoizedState,w=u.getDerivedStateFromProps,typeof w=="function"&&(lg(o,u,w,d),E.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(w=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),w!==E.state&&og.enqueueReplaceState(E,E.state,null),Cu(o,d,E,p),Du(),E.state=o.memoizedState),typeof E.componentDidMount=="function"&&(o.flags|=4194308),d=!0}else if(r===null){E=o.stateNode;var D=o.memoizedProps,N=ja(u,D);E.props=N;var z=E.context,le=u.contextType;w=lo,typeof le=="object"&&le!==null&&(w=En(le));var de=u.getDerivedStateFromProps;le=typeof de=="function"||typeof E.getSnapshotBeforeUpdate=="function",D=o.pendingProps!==D,le||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(D||z!==w)&&yx(o,E,d,w),Br=!1;var ee=o.memoizedState;E.state=ee,Cu(o,d,E,p),Du(),z=o.memoizedState,D||ee!==z||Br?(typeof de=="function"&&(lg(o,u,de,d),z=o.memoizedState),(N=Br||px(o,u,N,d,ee,z,w))?(le||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(o.flags|=4194308)):(typeof E.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=d,o.memoizedState=z),E.props=d,E.state=z,E.context=w,d=N):(typeof E.componentDidMount=="function"&&(o.flags|=4194308),d=!1)}else{E=o.stateNode,Sg(r,o),w=o.memoizedProps,le=ja(u,w),E.props=le,de=o.pendingProps,ee=E.context,z=u.contextType,N=lo,typeof z=="object"&&z!==null&&(N=En(z)),D=u.getDerivedStateFromProps,(z=typeof D=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(w!==de||ee!==N)&&yx(o,E,d,N),Br=!1,ee=o.memoizedState,E.state=ee,Cu(o,d,E,p),Du();var re=o.memoizedState;w!==de||ee!==re||Br||r!==null&&r.dependencies!==null&&Kf(r.dependencies)?(typeof D=="function"&&(lg(o,u,D,d),re=o.memoizedState),(le=Br||px(o,u,le,d,ee,re,N)||r!==null&&r.dependencies!==null&&Kf(r.dependencies))?(z||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(d,re,N),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(d,re,N)),typeof E.componentDidUpdate=="function"&&(o.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof E.componentDidUpdate!="function"||w===r.memoizedProps&&ee===r.memoizedState||(o.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||w===r.memoizedProps&&ee===r.memoizedState||(o.flags|=1024),o.memoizedProps=d,o.memoizedState=re),E.props=d,E.state=re,E.context=N,d=le):(typeof E.componentDidUpdate!="function"||w===r.memoizedProps&&ee===r.memoizedState||(o.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||w===r.memoizedProps&&ee===r.memoizedState||(o.flags|=1024),d=!1)}return E=d,Lu(r,o),d=(o.flags&128)!==0,E||d?(E=o.stateNode,u=d&&typeof u.getDerivedStateFromError!="function"?null:E.render(),o.flags|=1,r!==null&&d?(o.child=Ha(o,r.child,null,p),o.child=Ha(o,null,u,p)):fn(r,o,u,p),o.memoizedState=E.state,r=o.child):r=Bi(r,o,p),r}function _x(r,o,u,d){return pu(),o.flags|=256,fn(r,o,u,d),o.child}var hg={dehydrated:null,treeContext:null,retryLane:0};function fg(r){return{baseLanes:r,cachePool:Mv()}}function dg(r,o,u){return r=r!==null?r.childLanes&~u:0,o&&(r|=xs),r}function Ox(r,o,u){var d=o.pendingProps,p=!1,E=(o.flags&128)!==0,w;if((w=E)||(w=r!==null&&r.memoizedState===null?!1:(jt.current&2)!==0),w&&(p=!0,o.flags&=-129),w=(o.flags&32)!==0,o.flags&=-33,r===null){if(st){if(p?_r(o):Or(),st){var D=hn,N;if(N=D){e:{for(N=D,D=si;N.nodeType!==8;){if(!D){D=null;break e}if(N=Ns(N.nextSibling),N===null){D=null;break e}}D=N}D!==null?(o.memoizedState={dehydrated:D,treeContext:Fa!==null?{id:Oi,overflow:Mi}:null,retryLane:536870912},N=vs(18,null,null,0),N.stateNode=D,N.return=o,o.child=N,Ln=o,hn=null,N=!0):N=!1}N||$a(o)}if(D=o.memoizedState,D!==null&&(D=D.dehydrated,D!==null))return D.data==="$!"?o.lanes=16:o.lanes=536870912,null;Pi(o)}return D=d.children,d=d.fallback,p?(Or(),p=o.mode,D=mg({mode:"hidden",children:D},p),d=Wa(d,p,u,null),D.return=o,d.return=o,D.sibling=d,o.child=D,p=o.child,p.memoizedState=fg(u),p.childLanes=dg(r,w,u),o.memoizedState=hg,d):(_r(o),gg(o,D))}if(N=r.memoizedState,N!==null&&(D=N.dehydrated,D!==null)){if(E)o.flags&256?(_r(o),o.flags&=-257,o=pg(r,o,u)):o.memoizedState!==null?(Or(),o.child=r.child,o.flags|=128,o=null):(Or(),p=d.fallback,D=o.mode,d=mg({mode:"visible",children:d.children},D),p=Wa(p,D,u,null),p.flags|=2,d.return=o,p.return=o,d.sibling=p,o.child=d,Ha(o,r.child,null,u),d=o.child,d.memoizedState=fg(u),d.childLanes=dg(r,w,u),o.memoizedState=hg,o=p);else if(_r(o),D.data==="$!"){if(w=D.nextSibling&&D.nextSibling.dataset,w)var z=w.dgst;w=z,d=Error(n(419)),d.stack="",d.digest=w,yu({value:d,source:null,stack:null}),o=pg(r,o,u)}else if(en||ku(r,o,u,!1),w=(u&r.childLanes)!==0,en||w){if(w=vt,w!==null){if(d=u&-u,(d&42)!==0)d=1;else switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=64;break;case 268435456:d=134217728;break;default:d=0}if(d=(d&(w.suspendedLanes|u))!==0?0:d,d!==0&&d!==N.retryLane)throw N.retryLane=d,Cr(r,d),kn(w,r,d),Tx}D.data==="$?"||Vg(),o=pg(r,o,u)}else D.data==="$?"?(o.flags|=128,o.child=r.child,o=Ok.bind(null,r),D._reactRetry=o,o=null):(r=N.treeContext,hn=Ns(D.nextSibling),Ln=o,st=!0,Ms=null,si=!1,r!==null&&(ds[gs++]=Oi,ds[gs++]=Mi,ds[gs++]=Fa,Oi=r.id,Mi=r.overflow,Fa=o),o=gg(o,d.children),o.flags|=4096);return o}return p?(Or(),p=d.fallback,D=o.mode,N=r.child,z=N.sibling,d=zr(N,{mode:"hidden",children:d.children}),d.subtreeFlags=N.subtreeFlags&31457280,z!==null?p=zr(z,p):(p=Wa(p,D,u,null),p.flags|=2),p.return=o,d.return=o,d.sibling=p,o.child=d,d=p,p=o.child,D=r.child.memoizedState,D===null?D=fg(u):(N=D.cachePool,N!==null?(z=Qt._currentValue,N=N.parent!==z?{parent:z,pool:z}:N):N=Mv(),D={baseLanes:D.baseLanes|u,cachePool:N}),p.memoizedState=D,p.childLanes=dg(r,w,u),o.memoizedState=hg,d):(_r(o),u=r.child,r=u.sibling,u=zr(u,{mode:"visible",children:d.children}),u.return=o,u.sibling=null,r!==null&&(w=o.deletions,w===null?(o.deletions=[r],o.flags|=16):w.push(r)),o.child=u,o.memoizedState=null,u)}function gg(r,o){return o=mg({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function mg(r,o){return r1(r,o,0,null)}function pg(r,o,u){return Ha(o,r.child,null,u),r=gg(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function Mx(r,o,u){r.lanes|=o;var d=r.alternate;d!==null&&(d.lanes|=o),Eg(r.return,o,u)}function yg(r,o,u,d,p){var E=r.memoizedState;E===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:d,tail:u,tailMode:p}:(E.isBackwards=o,E.rendering=null,E.renderingStartTime=0,E.last=d,E.tail=u,E.tailMode=p)}function Px(r,o,u){var d=o.pendingProps,p=d.revealOrder,E=d.tail;if(fn(r,o,d.children,u),d=jt.current,(d&2)!==0)d=d&1|2,o.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Mx(r,u,o);else if(r.tag===19)Mx(r,u,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}d&=1}switch(Ke(jt,d),p){case"forwards":for(u=o.child,p=null;u!==null;)r=u.alternate,r!==null&&Of(r)===null&&(p=u),u=u.sibling;u=p,u===null?(p=o.child,o.child=null):(p=u.sibling,u.sibling=null),yg(o,!1,p,u,E);break;case"backwards":for(u=null,p=o.child,o.child=null;p!==null;){if(r=p.alternate,r!==null&&Of(r)===null){o.child=p;break}r=p.sibling,p.sibling=u,u=p,p=r}yg(o,!0,u,null,E);break;case"together":yg(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Bi(r,o,u){if(r!==null&&(o.dependencies=r.dependencies),Vr|=o.lanes,(u&o.childLanes)===0)if(r!==null){if(ku(r,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,u=zr(r,r.pendingProps),o.child=u,u.return=o;r.sibling!==null;)r=r.sibling,u=u.sibling=zr(r,r.pendingProps),u.return=o;u.sibling=null}return o.child}function vg(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&Kf(r)))}function xk(r,o,u){switch(o.tag){case 3:ei(o,o.stateNode.containerInfo),Nr(o,Qt,r.memoizedState.cache),pu();break;case 27:case 5:Tt(o);break;case 4:ei(o,o.stateNode.containerInfo);break;case 10:Nr(o,o.type,o.memoizedProps.value);break;case 13:var d=o.memoizedState;if(d!==null)return d.dehydrated!==null?(_r(o),o.flags|=128,null):(u&o.child.childLanes)!==0?Ox(r,o,u):(_r(o),r=Bi(r,o,u),r!==null?r.sibling:null);_r(o);break;case 19:var p=(r.flags&128)!==0;if(d=(u&o.childLanes)!==0,d||(ku(r,o,u,!1),d=(u&o.childLanes)!==0),p){if(d)return Px(r,o,u);o.flags|=128}if(p=o.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Ke(jt,jt.current),d)break;return null;case 22:case 23:return o.lanes=0,kx(r,o,u);case 24:Nr(o,Qt,r.memoizedState.cache)}return Bi(r,o,u)}function Nx(r,o,u){if(r!==null)if(r.memoizedProps!==o.pendingProps)en=!0;else{if(!vg(r,u)&&(o.flags&128)===0)return en=!1,xk(r,o,u);en=(r.flags&131072)!==0}else en=!1,st&&(o.flags&1048576)!==0&&Ev(o,kf,o.index);switch(o.lanes=0,o.tag){case 16:e:{r=o.pendingProps;var d=o.elementType,p=d._init;if(d=p(d._payload),o.type=d,typeof d=="function")_g(d)?(r=ja(d,r),o.tag=1,o=Cx(null,o,d,r,u)):(o.tag=0,o=ug(null,o,d,r,u));else{if(d!=null){if(p=d.$$typeof,p===x){o.tag=11,o=wx(null,o,d,r,u);break e}else if(p===S){o.tag=14,o=Rx(null,o,d,r,u);break e}}throw o=B(d)||d,Error(n(306,o,""))}}return o;case 0:return ug(r,o,o.type,o.pendingProps,u);case 1:return d=o.type,p=ja(d,o.pendingProps),Cx(r,o,d,p,u);case 3:e:{if(ei(o,o.stateNode.containerInfo),r===null)throw Error(n(387));var E=o.pendingProps;p=o.memoizedState,d=p.element,Sg(r,o),Cu(o,E,null,u);var w=o.memoizedState;if(E=w.cache,Nr(o,Qt,E),E!==p.cache&&bg(o,[Qt],u,!0),Du(),E=w.element,p.isDehydrated)if(p={element:E,isDehydrated:!1,cache:w.cache},o.updateQueue.baseState=p,o.memoizedState=p,o.flags&256){o=_x(r,o,E,u);break e}else if(E!==d){d=fs(Error(n(424)),o),yu(d),o=_x(r,o,E,u);break e}else for(hn=Ns(o.stateNode.containerInfo.firstChild),Ln=o,st=!0,Ms=null,si=!0,u=Iv(o,null,E,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(pu(),E===d){o=Bi(r,o,u);break e}fn(r,o,E,u)}o=o.child}return o;case 26:return Lu(r,o),r===null?(u=F1(o.type,null,o.pendingProps,null))?o.memoizedState=u:st||(u=o.type,r=o.pendingProps,d=l0(yt.current).createElement(u),d[xn]=o,d[Bn]=r,dn(d,u,r),Jt(d),o.stateNode=d):o.memoizedState=F1(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Tt(o),r===null&&st&&(d=o.stateNode=N1(o.type,o.pendingProps,yt.current),Ln=o,si=!0,hn=Ns(d.firstChild)),d=o.pendingProps.children,r!==null||st?fn(r,o,d,u):o.child=Ha(o,null,d,u),Lu(r,o),o.child;case 5:return r===null&&st&&((p=d=hn)&&(d=qk(d,o.type,o.pendingProps,si),d!==null?(o.stateNode=d,Ln=o,hn=Ns(d.firstChild),si=!1,p=!0):p=!1),p||$a(o)),Tt(o),p=o.type,E=o.pendingProps,w=r!==null?r.memoizedProps:null,d=E.children,im(p,E)?d=null:w!==null&&im(p,w)&&(o.flags|=32),o.memoizedState!==null&&(p=Y2(r,o,fk,null,null,u),Yu._currentValue=p),Lu(r,o),fn(r,o,d,u),o.child;case 6:return r===null&&st&&((r=u=hn)&&(u=Xk(u,o.pendingProps,si),u!==null?(o.stateNode=u,Ln=o,hn=null,r=!0):r=!1),r||$a(o)),null;case 13:return Ox(r,o,u);case 4:return ei(o,o.stateNode.containerInfo),d=o.pendingProps,r===null?o.child=Ha(o,null,d,u):fn(r,o,d,u),o.child;case 11:return wx(r,o,o.type,o.pendingProps,u);case 7:return fn(r,o,o.pendingProps,u),o.child;case 8:return fn(r,o,o.pendingProps.children,u),o.child;case 12:return fn(r,o,o.pendingProps.children,u),o.child;case 10:return d=o.pendingProps,Nr(o,o.type,d.value),fn(r,o,d.children,u),o.child;case 9:return p=o.type._context,d=o.pendingProps.children,qa(o),p=En(p),d=d(p),o.flags|=1,fn(r,o,d,u),o.child;case 14:return Rx(r,o,o.type,o.pendingProps,u);case 15:return Lx(r,o,o.type,o.pendingProps,u);case 19:return Px(r,o,u);case 22:return kx(r,o,u);case 24:return qa(o),d=En(Qt),r===null?(p=V2(),p===null&&(p=vt,E=H2(),p.pooledCache=E,E.refCount++,E!==null&&(p.pooledCacheLanes|=u),p=E),o.memoizedState={parent:d,cache:p},Ag(o),Nr(o,Qt,p)):((r.lanes&u)!==0&&(Sg(r,o),Cu(o,null,null,u),Du()),p=r.memoizedState,E=o.memoizedState,p.parent!==d?(p={parent:d,cache:d},o.memoizedState=p,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=p),Nr(o,Qt,d)):(d=E.cache,Nr(o,Qt,d),d!==p.cache&&bg(o,[Qt],u,!0))),fn(r,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}var xg=ke(null),Qa=null,Ui=null;function Nr(r,o,u){Ke(xg,o._currentValue),o._currentValue=u}function Fi(r){r._currentValue=xg.current,Ne(xg)}function Eg(r,o,u){for(;r!==null;){var d=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,d!==null&&(d.childLanes|=o)):d!==null&&(d.childLanes&o)!==o&&(d.childLanes|=o),r===u)break;r=r.return}}function bg(r,o,u,d){var p=r.child;for(p!==null&&(p.return=r);p!==null;){var E=p.dependencies;if(E!==null){var w=p.child;E=E.firstContext;e:for(;E!==null;){var D=E;E=p;for(var N=0;N<o.length;N++)if(D.context===o[N]){E.lanes|=u,D=E.alternate,D!==null&&(D.lanes|=u),Eg(E.return,u,r),d||(w=null);break e}E=D.next}}else if(p.tag===18){if(w=p.return,w===null)throw Error(n(341));w.lanes|=u,E=w.alternate,E!==null&&(E.lanes|=u),Eg(w,u,r),w=null}else w=p.child;if(w!==null)w.return=p;else for(w=p;w!==null;){if(w===r){w=null;break}if(p=w.sibling,p!==null){p.return=w.return,w=p;break}w=w.return}p=w}}function ku(r,o,u,d){r=null;for(var p=o,E=!1;p!==null;){if(!E){if((p.flags&524288)!==0)E=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var w=p.alternate;if(w===null)throw Error(n(387));if(w=w.memoizedProps,w!==null){var D=p.type;qn(p.pendingProps.value,w.value)||(r!==null?r.push(D):r=[D])}}else if(p===Zt.current){if(w=p.alternate,w===null)throw Error(n(387));w.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(r!==null?r.push(Yu):r=[Yu])}p=p.return}r!==null&&bg(o,r,u,d),o.flags|=262144}function Kf(r){for(r=r.firstContext;r!==null;){if(!qn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function qa(r){Qa=r,Ui=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function En(r){return Bx(Qa,r)}function Yf(r,o){return Qa===null&&qa(r),Bx(r,o)}function Bx(r,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},Ui===null){if(r===null)throw Error(n(308));Ui=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else Ui=Ui.next=o;return u}var Br=!1;function Ag(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Sg(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Ur(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Fr(r,o,u){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(Lt&2)!==0){var p=d.pending;return p===null?o.next=o:(o.next=p.next,p.next=o),d.pending=o,o=Rf(r),vv(r,null,u),o}return wf(r,d,o,u),Rf(r)}function Iu(r,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194176)!==0)){var d=o.lanes;d&=r.pendingLanes,u|=d,o.lanes=u,R3(r,u)}}function Tg(r,o){var u=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,u===d)){var p=null,E=null;if(u=u.firstBaseUpdate,u!==null){do{var w={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};E===null?p=E=w:E=E.next=w,u=u.next}while(u!==null);E===null?p=E=o:E=E.next=o}else p=E=o;u={baseState:d.baseState,firstBaseUpdate:p,lastBaseUpdate:E,shared:d.shared,callbacks:d.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=o:r.next=o,u.lastBaseUpdate=o}var wg=!1;function Du(){if(wg){var r=go;if(r!==null)throw r}}function Cu(r,o,u,d){wg=!1;var p=r.updateQueue;Br=!1;var E=p.firstBaseUpdate,w=p.lastBaseUpdate,D=p.shared.pending;if(D!==null){p.shared.pending=null;var N=D,z=N.next;N.next=null,w===null?E=z:w.next=z,w=N;var le=r.alternate;le!==null&&(le=le.updateQueue,D=le.lastBaseUpdate,D!==w&&(D===null?le.firstBaseUpdate=z:D.next=z,le.lastBaseUpdate=N))}if(E!==null){var de=p.baseState;w=0,le=z=N=null,D=E;do{var ee=D.lane&-536870913,re=ee!==D.lane;if(re?(et&ee)===ee:(d&ee)===ee){ee!==0&&ee===fo&&(wg=!0),le!==null&&(le=le.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Le=r,Fe=D;ee=o;var Mt=u;switch(Fe.tag){case 1:if(Le=Fe.payload,typeof Le=="function"){de=Le.call(Mt,de,ee);break e}de=Le;break e;case 3:Le.flags=Le.flags&-65537|128;case 0:if(Le=Fe.payload,ee=typeof Le=="function"?Le.call(Mt,de,ee):Le,ee==null)break e;de=M({},de,ee);break e;case 2:Br=!0}}ee=D.callback,ee!==null&&(r.flags|=64,re&&(r.flags|=8192),re=p.callbacks,re===null?p.callbacks=[ee]:re.push(ee))}else re={lane:ee,tag:D.tag,payload:D.payload,callback:D.callback,next:null},le===null?(z=le=re,N=de):le=le.next=re,w|=ee;if(D=D.next,D===null){if(D=p.shared.pending,D===null)break;re=D,D=re.next,re.next=null,p.lastBaseUpdate=re,p.shared.pending=null}}while(!0);le===null&&(N=de),p.baseState=N,p.firstBaseUpdate=z,p.lastBaseUpdate=le,E===null&&(p.shared.lanes=0),Vr|=w,r.lanes=w,r.memoizedState=de}}function Ux(r,o){if(typeof r!="function")throw Error(n(191,r));r.call(o)}function Fx(r,o){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)Ux(u[r],o)}function _u(r,o){try{var u=o.updateQueue,d=u!==null?u.lastEffect:null;if(d!==null){var p=d.next;u=p;do{if((u.tag&r)===r){d=void 0;var E=u.create,w=u.inst;d=E(),w.destroy=d}u=u.next}while(u!==p)}}catch(D){pt(o,o.return,D)}}function Gr(r,o,u){try{var d=o.updateQueue,p=d!==null?d.lastEffect:null;if(p!==null){var E=p.next;d=E;do{if((d.tag&r)===r){var w=d.inst,D=w.destroy;if(D!==void 0){w.destroy=void 0,p=o;var N=u;try{D()}catch(z){pt(p,N,z)}}}d=d.next}while(d!==E)}}catch(z){pt(o,o.return,z)}}function Gx(r){var o=r.updateQueue;if(o!==null){var u=r.stateNode;try{Fx(o,u)}catch(d){pt(r,r.return,d)}}}function $x(r,o,u){u.props=ja(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(d){pt(r,o,d)}}function Xa(r,o){try{var u=r.ref;if(u!==null){var d=r.stateNode;switch(r.tag){case 26:case 27:case 5:var p=d;break;default:p=d}typeof u=="function"?r.refCleanup=u(p):u.current=p}}catch(E){pt(r,o,E)}}function Xn(r,o){var u=r.ref,d=r.refCleanup;if(u!==null)if(typeof d=="function")try{d()}catch(p){pt(r,o,p)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(p){pt(r,o,p)}else u.current=null}function Hx(r){var o=r.type,u=r.memoizedProps,d=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&d.focus();break e;case"img":u.src?d.src=u.src:u.srcSet&&(d.srcset=u.srcSet)}}catch(p){pt(r,r.return,p)}}function zx(r,o,u){try{var d=r.stateNode;Vk(d,r.type,u,o),d[Bn]=o}catch(p){pt(r,r.return,p)}}function Vx(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27||r.tag===4}function Rg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Vx(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==27&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Lg(r,o,u){var d=r.tag;if(d===5||d===6)r=r.stateNode,o?u.nodeType===8?u.parentNode.insertBefore(r,o):u.insertBefore(r,o):(u.nodeType===8?(o=u.parentNode,o.insertBefore(r,u)):(o=u,o.appendChild(r)),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=a0));else if(d!==4&&d!==27&&(r=r.child,r!==null))for(Lg(r,o,u),r=r.sibling;r!==null;)Lg(r,o,u),r=r.sibling}function jf(r,o,u){var d=r.tag;if(d===5||d===6)r=r.stateNode,o?u.insertBefore(r,o):u.appendChild(r);else if(d!==4&&d!==27&&(r=r.child,r!==null))for(jf(r,o,u),r=r.sibling;r!==null;)jf(r,o,u),r=r.sibling}var Gi=!1,_t=!1,kg=!1,Kx=typeof WeakSet=="function"?WeakSet:Set,tn=null,Yx=!1;function Ek(r,o){if(r=r.containerInfo,nm=d0,r=cv(r),D2(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var d=u.getSelection&&u.getSelection();if(d&&d.rangeCount!==0){u=d.anchorNode;var p=d.anchorOffset,E=d.focusNode;d=d.focusOffset;try{u.nodeType,E.nodeType}catch{u=null;break e}var w=0,D=-1,N=-1,z=0,le=0,de=r,ee=null;t:for(;;){for(var re;de!==u||p!==0&&de.nodeType!==3||(D=w+p),de!==E||d!==0&&de.nodeType!==3||(N=w+d),de.nodeType===3&&(w+=de.nodeValue.length),(re=de.firstChild)!==null;)ee=de,de=re;for(;;){if(de===r)break t;if(ee===u&&++z===p&&(D=w),ee===E&&++le===d&&(N=w),(re=de.nextSibling)!==null)break;de=ee,ee=de.parentNode}de=re}u=D===-1||N===-1?null:{start:D,end:N}}else u=null}u=u||{start:0,end:0}}else u=null;for(sm={focusedElem:r,selectionRange:u},d0=!1,tn=o;tn!==null;)if(o=tn,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,tn=r;else for(;tn!==null;){switch(o=tn,E=o.alternate,r=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&E!==null){r=void 0,u=o,p=E.memoizedProps,E=E.memoizedState,d=u.stateNode;try{var Le=ja(u.type,p,u.elementType===u.type);r=d.getSnapshotBeforeUpdate(Le,E),d.__reactInternalSnapshotBeforeUpdate=r}catch(Fe){pt(u,u.return,Fe)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,u=r.nodeType,u===9)lm(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":lm(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=o.sibling,r!==null){r.return=o.return,tn=r;break}tn=o.return}return Le=Yx,Yx=!1,Le}function jx(r,o,u){var d=u.flags;switch(u.tag){case 0:case 11:case 15:Hi(r,u),d&4&&_u(5,u);break;case 1:if(Hi(r,u),d&4)if(r=u.stateNode,o===null)try{r.componentDidMount()}catch(D){pt(u,u.return,D)}else{var p=ja(u.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(p,o,r.__reactInternalSnapshotBeforeUpdate)}catch(D){pt(u,u.return,D)}}d&64&&Gx(u),d&512&&Xa(u,u.return);break;case 3:if(Hi(r,u),d&64&&(d=u.updateQueue,d!==null)){if(r=null,u.child!==null)switch(u.child.tag){case 27:case 5:r=u.child.stateNode;break;case 1:r=u.child.stateNode}try{Fx(d,r)}catch(D){pt(u,u.return,D)}}break;case 26:Hi(r,u),d&512&&Xa(u,u.return);break;case 27:case 5:Hi(r,u),o===null&&d&4&&Hx(u),d&512&&Xa(u,u.return);break;case 12:Hi(r,u);break;case 13:Hi(r,u),d&4&&Xx(r,u);break;case 22:if(p=u.memoizedState!==null||Gi,!p){o=o!==null&&o.memoizedState!==null||_t;var E=Gi,w=_t;Gi=p,(_t=o)&&!w?$r(r,u,(u.subtreeFlags&8772)!==0):Hi(r,u),Gi=E,_t=w}d&512&&(u.memoizedProps.mode==="manual"?Xa(u,u.return):Xn(u,u.return));break;default:Hi(r,u)}}function Qx(r){var o=r.alternate;o!==null&&(r.alternate=null,Qx(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&g2(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Kt=null,Wn=!1;function $i(r,o,u){for(u=u.child;u!==null;)qx(r,o,u),u=u.sibling}function qx(r,o,u){if(wt&&typeof wt.onCommitFiberUnmount=="function")try{wt.onCommitFiberUnmount(at,u)}catch{}switch(u.tag){case 26:_t||Xn(u,o),$i(r,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:_t||Xn(u,o);var d=Kt,p=Wn;for(Kt=u.stateNode,$i(r,o,u),u=u.stateNode,o=u.attributes;o.length;)u.removeAttributeNode(o[0]);g2(u),Kt=d,Wn=p;break;case 5:_t||Xn(u,o);case 6:p=Kt;var E=Wn;if(Kt=null,$i(r,o,u),Kt=p,Wn=E,Kt!==null)if(Wn)try{r=Kt,d=u.stateNode,r.nodeType===8?r.parentNode.removeChild(d):r.removeChild(d)}catch(w){pt(u,o,w)}else try{Kt.removeChild(u.stateNode)}catch(w){pt(u,o,w)}break;case 18:Kt!==null&&(Wn?(o=Kt,u=u.stateNode,o.nodeType===8?am(o.parentNode,u):o.nodeType===1&&am(o,u),Xu(o)):am(Kt,u.stateNode));break;case 4:d=Kt,p=Wn,Kt=u.stateNode.containerInfo,Wn=!0,$i(r,o,u),Kt=d,Wn=p;break;case 0:case 11:case 14:case 15:_t||Gr(2,u,o),_t||Gr(4,u,o),$i(r,o,u);break;case 1:_t||(Xn(u,o),d=u.stateNode,typeof d.componentWillUnmount=="function"&&$x(u,o,d)),$i(r,o,u);break;case 21:$i(r,o,u);break;case 22:_t||Xn(u,o),_t=(d=_t)||u.memoizedState!==null,$i(r,o,u),_t=d;break;default:$i(r,o,u)}}function Xx(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Xu(r)}catch(u){pt(o,o.return,u)}}function bk(r){switch(r.tag){case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new Kx),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new Kx),o;default:throw Error(n(435,r.tag))}}function Ig(r,o){var u=bk(r);o.forEach(function(d){var p=Mk.bind(null,r,d);u.has(d)||(u.add(d),d.then(p,p))})}function ps(r,o){var u=o.deletions;if(u!==null)for(var d=0;d<u.length;d++){var p=u[d],E=r,w=o,D=w;e:for(;D!==null;){switch(D.tag){case 27:case 5:Kt=D.stateNode,Wn=!1;break e;case 3:Kt=D.stateNode.containerInfo,Wn=!0;break e;case 4:Kt=D.stateNode.containerInfo,Wn=!0;break e}D=D.return}if(Kt===null)throw Error(n(160));qx(E,w,p),Kt=null,Wn=!1,E=p.alternate,E!==null&&(E.return=null),p.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)Wx(o,r),o=o.sibling}var Ps=null;function Wx(r,o){var u=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:ps(o,r),ys(r),d&4&&(Gr(3,r,r.return),_u(3,r),Gr(5,r,r.return));break;case 1:ps(o,r),ys(r),d&512&&(_t||u===null||Xn(u,u.return)),d&64&&Gi&&(r=r.updateQueue,r!==null&&(d=r.callbacks,d!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?d:u.concat(d))));break;case 26:var p=Ps;if(ps(o,r),ys(r),d&512&&(_t||u===null||Xn(u,u.return)),d&4){var E=u!==null?u.memoizedState:null;if(d=r.memoizedState,u===null)if(d===null)if(r.stateNode===null){e:{d=r.type,u=r.memoizedProps,p=p.ownerDocument||p;t:switch(d){case"title":E=p.getElementsByTagName("title")[0],(!E||E[iu]||E[xn]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=p.createElement(d),p.head.insertBefore(E,p.querySelector("head > title"))),dn(E,d,u),E[xn]=r,Jt(E),d=E;break e;case"link":var w=H1("link","href",p).get(d+(u.href||""));if(w){for(var D=0;D<w.length;D++)if(E=w[D],E.getAttribute("href")===(u.href==null?null:u.href)&&E.getAttribute("rel")===(u.rel==null?null:u.rel)&&E.getAttribute("title")===(u.title==null?null:u.title)&&E.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){w.splice(D,1);break t}}E=p.createElement(d),dn(E,d,u),p.head.appendChild(E);break;case"meta":if(w=H1("meta","content",p).get(d+(u.content||""))){for(D=0;D<w.length;D++)if(E=w[D],E.getAttribute("content")===(u.content==null?null:""+u.content)&&E.getAttribute("name")===(u.name==null?null:u.name)&&E.getAttribute("property")===(u.property==null?null:u.property)&&E.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&E.getAttribute("charset")===(u.charSet==null?null:u.charSet)){w.splice(D,1);break t}}E=p.createElement(d),dn(E,d,u),p.head.appendChild(E);break;default:throw Error(n(468,d))}E[xn]=r,Jt(E),d=E}r.stateNode=d}else z1(p,r.type,r.stateNode);else r.stateNode=$1(p,d,r.memoizedProps);else E!==d?(E===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):E.count--,d===null?z1(p,r.type,r.stateNode):$1(p,d,r.memoizedProps)):d===null&&r.stateNode!==null&&zx(r,r.memoizedProps,u.memoizedProps)}break;case 27:if(d&4&&r.alternate===null){p=r.stateNode,E=r.memoizedProps;try{for(var N=p.firstChild;N;){var z=N.nextSibling,le=N.nodeName;N[iu]||le==="HEAD"||le==="BODY"||le==="SCRIPT"||le==="STYLE"||le==="LINK"&&N.rel.toLowerCase()==="stylesheet"||p.removeChild(N),N=z}for(var de=r.type,ee=p.attributes;ee.length;)p.removeAttributeNode(ee[0]);dn(p,de,E),p[xn]=r,p[Bn]=E}catch(Le){pt(r,r.return,Le)}}case 5:if(ps(o,r),ys(r),d&512&&(_t||u===null||Xn(u,u.return)),r.flags&32){p=r.stateNode;try{eo(p,"")}catch(Le){pt(r,r.return,Le)}}d&4&&r.stateNode!=null&&(p=r.memoizedProps,zx(r,p,u!==null?u.memoizedProps:p)),d&1024&&(kg=!0);break;case 6:if(ps(o,r),ys(r),d&4){if(r.stateNode===null)throw Error(n(162));d=r.memoizedProps,u=r.stateNode;try{u.nodeValue=d}catch(Le){pt(r,r.return,Le)}}break;case 3:if(u0=null,p=Ps,Ps=o0(o.containerInfo),ps(o,r),Ps=p,ys(r),d&4&&u!==null&&u.memoizedState.isDehydrated)try{Xu(o.containerInfo)}catch(Le){pt(r,r.return,Le)}kg&&(kg=!1,Zx(r));break;case 4:d=Ps,Ps=o0(r.stateNode.containerInfo),ps(o,r),ys(r),Ps=d;break;case 12:ps(o,r),ys(r);break;case 13:ps(o,r),ys(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Ug=un()),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Ig(r,d)));break;case 22:if(d&512&&(_t||u===null||Xn(u,u.return)),N=r.memoizedState!==null,z=u!==null&&u.memoizedState!==null,le=Gi,de=_t,Gi=le||N,_t=de||z,ps(o,r),_t=de,Gi=le,ys(r),o=r.stateNode,o._current=r,o._visibility&=-3,o._visibility|=o._pendingVisibility&2,d&8192&&(o._visibility=N?o._visibility&-2:o._visibility|1,N&&(o=Gi||_t,u===null||z||o||vo(r)),r.memoizedProps===null||r.memoizedProps.mode!=="manual"))e:for(u=null,o=r;;){if(o.tag===5||o.tag===26||o.tag===27){if(u===null){z=u=o;try{if(p=z.stateNode,N)E=p.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{w=z.stateNode,D=z.memoizedProps.style;var re=D!=null&&D.hasOwnProperty("display")?D.display:null;w.style.display=re==null||typeof re=="boolean"?"":(""+re).trim()}}catch(Le){pt(z,z.return,Le)}}}else if(o.tag===6){if(u===null){z=o;try{z.stateNode.nodeValue=N?"":z.memoizedProps}catch(Le){pt(z,z.return,Le)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}d&4&&(d=r.updateQueue,d!==null&&(u=d.retryQueue,u!==null&&(d.retryQueue=null,Ig(r,u))));break;case 19:ps(o,r),ys(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Ig(r,d)));break;case 21:break;default:ps(o,r),ys(r)}}function ys(r){var o=r.flags;if(o&2){try{if(r.tag!==27){e:{for(var u=r.return;u!==null;){if(Vx(u)){var d=u;break e}u=u.return}throw Error(n(160))}switch(d.tag){case 27:var p=d.stateNode,E=Rg(r);jf(r,E,p);break;case 5:var w=d.stateNode;d.flags&32&&(eo(w,""),d.flags&=-33);var D=Rg(r);jf(r,D,w);break;case 3:case 4:var N=d.stateNode.containerInfo,z=Rg(r);Lg(r,z,N);break;default:throw Error(n(161))}}}catch(le){pt(r,r.return,le)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function Zx(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;Zx(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function Hi(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)jx(r,o.alternate,o),o=o.sibling}function vo(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:Gr(4,o,o.return),vo(o);break;case 1:Xn(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&$x(o,o.return,u),vo(o);break;case 26:case 27:case 5:Xn(o,o.return),vo(o);break;case 22:Xn(o,o.return),o.memoizedState===null&&vo(o);break;default:vo(o)}r=r.sibling}}function $r(r,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var d=o.alternate,p=r,E=o,w=E.flags;switch(E.tag){case 0:case 11:case 15:$r(p,E,u),_u(4,E);break;case 1:if($r(p,E,u),d=E,p=d.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(z){pt(d,d.return,z)}if(d=E,p=d.updateQueue,p!==null){var D=d.stateNode;try{var N=p.shared.hiddenCallbacks;if(N!==null)for(p.shared.hiddenCallbacks=null,p=0;p<N.length;p++)Ux(N[p],D)}catch(z){pt(d,d.return,z)}}u&&w&64&&Gx(E),Xa(E,E.return);break;case 26:case 27:case 5:$r(p,E,u),u&&d===null&&w&4&&Hx(E),Xa(E,E.return);break;case 12:$r(p,E,u);break;case 13:$r(p,E,u),u&&w&4&&Xx(p,E);break;case 22:E.memoizedState===null&&$r(p,E,u),Xa(E,E.return);break;default:$r(p,E,u)}o=o.sibling}}function Dg(r,o){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&Au(u))}function Cg(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Au(r))}function Hr(r,o,u,d){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Jx(r,o,u,d),o=o.sibling}function Jx(r,o,u,d){var p=o.flags;switch(o.tag){case 0:case 11:case 15:Hr(r,o,u,d),p&2048&&_u(9,o);break;case 3:Hr(r,o,u,d),p&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Au(r)));break;case 12:if(p&2048){Hr(r,o,u,d),r=o.stateNode;try{var E=o.memoizedProps,w=E.id,D=E.onPostCommit;typeof D=="function"&&D(w,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(N){pt(o,o.return,N)}}else Hr(r,o,u,d);break;case 23:break;case 22:E=o.stateNode,o.memoizedState!==null?E._visibility&4?Hr(r,o,u,d):Ou(r,o):E._visibility&4?Hr(r,o,u,d):(E._visibility|=4,xo(r,o,u,d,(o.subtreeFlags&10256)!==0)),p&2048&&Dg(o.alternate,o);break;case 24:Hr(r,o,u,d),p&2048&&Cg(o.alternate,o);break;default:Hr(r,o,u,d)}}function xo(r,o,u,d,p){for(p=p&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var E=r,w=o,D=u,N=d,z=w.flags;switch(w.tag){case 0:case 11:case 15:xo(E,w,D,N,p),_u(8,w);break;case 23:break;case 22:var le=w.stateNode;w.memoizedState!==null?le._visibility&4?xo(E,w,D,N,p):Ou(E,w):(le._visibility|=4,xo(E,w,D,N,p)),p&&z&2048&&Dg(w.alternate,w);break;case 24:xo(E,w,D,N,p),p&&z&2048&&Cg(w.alternate,w);break;default:xo(E,w,D,N,p)}o=o.sibling}}function Ou(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=r,d=o,p=d.flags;switch(d.tag){case 22:Ou(u,d),p&2048&&Dg(d.alternate,d);break;case 24:Ou(u,d),p&2048&&Cg(d.alternate,d);break;default:Ou(u,d)}o=o.sibling}}var Mu=8192;function Eo(r){if(r.subtreeFlags&Mu)for(r=r.child;r!==null;)e1(r),r=r.sibling}function e1(r){switch(r.tag){case 26:Eo(r),r.flags&Mu&&r.memoizedState!==null&&cI(Ps,r.memoizedState,r.memoizedProps);break;case 5:Eo(r);break;case 3:case 4:var o=Ps;Ps=o0(r.stateNode.containerInfo),Eo(r),Ps=o;break;case 22:r.memoizedState===null&&(o=r.alternate,o!==null&&o.memoizedState!==null?(o=Mu,Mu=16777216,Eo(r),Mu=o):Eo(r));break;default:Eo(r)}}function t1(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function Pu(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var d=o[u];tn=d,s1(d,r)}t1(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)n1(r),r=r.sibling}function n1(r){switch(r.tag){case 0:case 11:case 15:Pu(r),r.flags&2048&&Gr(9,r,r.return);break;case 3:Pu(r);break;case 12:Pu(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&4&&(r.return===null||r.return.tag!==13)?(o._visibility&=-5,Qf(r)):Pu(r);break;default:Pu(r)}}function Qf(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var d=o[u];tn=d,s1(d,r)}t1(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:Gr(8,o,o.return),Qf(o);break;case 22:u=o.stateNode,u._visibility&4&&(u._visibility&=-5,Qf(o));break;default:Qf(o)}r=r.sibling}}function s1(r,o){for(;tn!==null;){var u=tn;switch(u.tag){case 0:case 11:case 15:Gr(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var d=u.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Au(u.memoizedState.cache)}if(d=u.child,d!==null)d.return=u,tn=d;else e:for(u=r;tn!==null;){d=tn;var p=d.sibling,E=d.return;if(Qx(d),d===u){tn=null;break e}if(p!==null){p.return=E,tn=p;break e}tn=E}}}function Ak(r,o,u,d){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vs(r,o,u,d){return new Ak(r,o,u,d)}function _g(r){return r=r.prototype,!(!r||!r.isReactComponent)}function zr(r,o){var u=r.alternate;return u===null?(u=vs(r.tag,o,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=o,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&31457280,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,o=r.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function i1(r,o){r.flags&=31457282;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,o=u.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function qf(r,o,u,d,p,E){var w=0;if(d=r,typeof r=="function")_g(r)&&(w=1);else if(typeof r=="string")w=lI(r,u,Wt.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case h:return Wa(u.children,p,E,o);case f:w=8,p|=24;break;case g:return r=vs(12,u,o,p|2),r.elementType=g,r.lanes=E,r;case b:return r=vs(13,u,o,p),r.elementType=b,r.lanes=E,r;case A:return r=vs(19,u,o,p),r.elementType=A,r.lanes=E,r;case R:return r1(u,p,E,o);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case m:case v:w=10;break e;case y:w=9;break e;case x:w=11;break e;case S:w=14;break e;case k:w=16,d=null;break e}w=29,u=Error(n(130,r===null?"null":typeof r,"")),d=null}return o=vs(w,u,o,p),o.elementType=r,o.type=d,o.lanes=E,o}function Wa(r,o,u,d){return r=vs(7,r,d,o),r.lanes=u,r}function r1(r,o,u,d){r=vs(22,r,d,o),r.elementType=R,r.lanes=u;var p={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var E=p._current;if(E===null)throw Error(n(456));if((p._pendingVisibility&2)===0){var w=Cr(E,2);w!==null&&(p._pendingVisibility|=2,kn(w,E,2))}},attach:function(){var E=p._current;if(E===null)throw Error(n(456));if((p._pendingVisibility&2)!==0){var w=Cr(E,2);w!==null&&(p._pendingVisibility&=-3,kn(w,E,2))}}};return r.stateNode=p,r}function Og(r,o,u){return r=vs(6,r,null,o),r.lanes=u,r}function Mg(r,o,u){return o=vs(4,r.children!==null?r.children:[],r.key,o),o.lanes=u,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}function zi(r){r.flags|=4}function a1(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!V1(o)){if(o=ms.current,o!==null&&((et&4194176)===et?ii!==null:(et&62914560)!==et&&(et&536870912)===0||o!==ii))throw xu=F2,Sv;r.flags|=8192}}function Xf(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?T3():536870912,r.lanes|=o,Ao|=o)}function Nu(r,o){if(!st)switch(r.tailMode){case"hidden":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var d=null;u!==null;)u.alternate!==null&&(d=u),u=u.sibling;d===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function Rt(r){var o=r.alternate!==null&&r.alternate.child===r.child,u=0,d=0;if(o)for(var p=r.child;p!==null;)u|=p.lanes|p.childLanes,d|=p.subtreeFlags&31457280,d|=p.flags&31457280,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)u|=p.lanes|p.childLanes,d|=p.subtreeFlags,d|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=d,r.childLanes=u,o}function Sk(r,o,u){var d=o.pendingProps;switch(B2(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rt(o),null;case 1:return Rt(o),null;case 3:return u=o.stateNode,d=null,r!==null&&(d=r.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),Fi(Qt),Ue(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&(mu(o)?zi(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Ms!==null&&(Hg(Ms),Ms=null))),Rt(o),null;case 26:return u=o.memoizedState,r===null?(zi(o),u!==null?(Rt(o),a1(o,u)):(Rt(o),o.flags&=-16777217)):u?u!==r.memoizedState?(zi(o),Rt(o),a1(o,u)):(Rt(o),o.flags&=-16777217):(r.memoizedProps!==d&&zi(o),Rt(o),o.flags&=-16777217),null;case 27:Yt(o),u=yt.current;var p=o.type;if(r!==null&&o.stateNode!=null)r.memoizedProps!==d&&zi(o);else{if(!d){if(o.stateNode===null)throw Error(n(166));return Rt(o),null}r=Wt.current,mu(o)?bv(o):(r=N1(p,d,u),o.stateNode=r,zi(o))}return Rt(o),null;case 5:if(Yt(o),u=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==d&&zi(o);else{if(!d){if(o.stateNode===null)throw Error(n(166));return Rt(o),null}if(r=Wt.current,mu(o))bv(o);else{switch(p=l0(yt.current),r){case 1:r=p.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:r=p.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":r=p.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":r=p.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":r=p.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof d.is=="string"?p.createElement("select",{is:d.is}):p.createElement("select"),d.multiple?r.multiple=!0:d.size&&(r.size=d.size);break;default:r=typeof d.is=="string"?p.createElement(u,{is:d.is}):p.createElement(u)}}r[xn]=o,r[Bn]=d;e:for(p=o.child;p!==null;){if(p.tag===5||p.tag===6)r.appendChild(p.stateNode);else if(p.tag!==4&&p.tag!==27&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===o)break e;for(;p.sibling===null;){if(p.return===null||p.return===o)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}o.stateNode=r;e:switch(dn(r,u,d),u){case"button":case"input":case"select":case"textarea":r=!!d.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&zi(o)}}return Rt(o),o.flags&=-16777217,null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==d&&zi(o);else{if(typeof d!="string"&&o.stateNode===null)throw Error(n(166));if(r=yt.current,mu(o)){if(r=o.stateNode,u=o.memoizedProps,d=null,p=Ln,p!==null)switch(p.tag){case 27:case 5:d=p.memoizedProps}r[xn]=o,r=!!(r.nodeValue===u||d!==null&&d.suppressHydrationWarning===!0||D1(r.nodeValue,u)),r||$a(o)}else r=l0(r).createTextNode(d),r[xn]=o,o.stateNode=r}return Rt(o),null;case 13:if(d=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(p=mu(o),d!==null&&d.dehydrated!==null){if(r===null){if(!p)throw Error(n(318));if(p=o.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(n(317));p[xn]=o}else pu(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Rt(o),p=!1}else Ms!==null&&(Hg(Ms),Ms=null),p=!0;if(!p)return o.flags&256?(Pi(o),o):(Pi(o),null)}if(Pi(o),(o.flags&128)!==0)return o.lanes=u,o;if(u=d!==null,r=r!==null&&r.memoizedState!==null,u){d=o.child,p=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(p=d.alternate.memoizedState.cachePool.pool);var E=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(E=d.memoizedState.cachePool.pool),E!==p&&(d.flags|=2048)}return u!==r&&u&&(o.child.flags|=8192),Xf(o,o.updateQueue),Rt(o),null;case 4:return Ue(),r===null&&Jg(o.stateNode.containerInfo),Rt(o),null;case 10:return Fi(o.type),Rt(o),null;case 19:if(Ne(jt),p=o.memoizedState,p===null)return Rt(o),null;if(d=(o.flags&128)!==0,E=p.rendering,E===null)if(d)Nu(p,!1);else{if(Ot!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(E=Of(r),E!==null){for(o.flags|=128,Nu(p,!1),r=E.updateQueue,o.updateQueue=r,Xf(o,r),o.subtreeFlags=0,r=u,u=o.child;u!==null;)i1(u,r),u=u.sibling;return Ke(jt,jt.current&1|2),o.child}r=r.sibling}p.tail!==null&&un()>Wf&&(o.flags|=128,d=!0,Nu(p,!1),o.lanes=4194304)}else{if(!d)if(r=Of(E),r!==null){if(o.flags|=128,d=!0,r=r.updateQueue,o.updateQueue=r,Xf(o,r),Nu(p,!0),p.tail===null&&p.tailMode==="hidden"&&!E.alternate&&!st)return Rt(o),null}else 2*un()-p.renderingStartTime>Wf&&u!==536870912&&(o.flags|=128,d=!0,Nu(p,!1),o.lanes=4194304);p.isBackwards?(E.sibling=o.child,o.child=E):(r=p.last,r!==null?r.sibling=E:o.child=E,p.last=E)}return p.tail!==null?(o=p.tail,p.rendering=o,p.tail=o.sibling,p.renderingStartTime=un(),o.sibling=null,r=jt.current,Ke(jt,d?r&1|2:r&1),o):(Rt(o),null);case 22:case 23:return Pi(o),$2(),d=o.memoizedState!==null,r!==null?r.memoizedState!==null!==d&&(o.flags|=8192):d&&(o.flags|=8192),d?(u&536870912)!==0&&(o.flags&128)===0&&(Rt(o),o.subtreeFlags&6&&(o.flags|=8192)):Rt(o),u=o.updateQueue,u!==null&&Xf(o,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),d=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(d=o.memoizedState.cachePool.pool),d!==u&&(o.flags|=2048),r!==null&&Ne(za),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),Fi(Qt),Rt(o),null;case 25:return null}throw Error(n(156,o.tag))}function Tk(r,o){switch(B2(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return Fi(Qt),Ue(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return Yt(o),null;case 13:if(Pi(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));pu()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return Ne(jt),null;case 4:return Ue(),null;case 10:return Fi(o.type),null;case 22:case 23:return Pi(o),$2(),r!==null&&Ne(za),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return Fi(Qt),null;case 25:return null;default:return null}}function l1(r,o){switch(B2(o),o.tag){case 3:Fi(Qt),Ue();break;case 26:case 27:case 5:Yt(o);break;case 4:Ue();break;case 13:Pi(o);break;case 19:Ne(jt);break;case 10:Fi(o.type);break;case 22:case 23:Pi(o),$2(),r!==null&&Ne(za);break;case 24:Fi(Qt)}}var wk={getCacheForType:function(r){var o=En(Qt),u=o.data.get(r);return u===void 0&&(u=r(),o.data.set(r,u)),u}},Rk=typeof WeakMap=="function"?WeakMap:Map,Lt=0,vt=null,We=null,et=0,xt=0,Zn=null,Vi=!1,bo=!1,Pg=!1,Ki=0,Ot=0,Vr=0,Za=0,Ng=0,xs=0,Ao=0,Bu=null,ai=null,Bg=!1,Ug=0,Wf=1/0,Zf=null,Kr=null,Jf=!1,Ja=null,Uu=0,Fg=0,Gg=null,Fu=0,$g=null;function Jn(){if((Lt&2)!==0&&et!==0)return et&-et;if(F.T!==null){var r=fo;return r!==0?r:qg()}return k3()}function o1(){xs===0&&(xs=(et&536870912)===0||st?S3():536870912);var r=ms.current;return r!==null&&(r.flags|=32),xs}function kn(r,o,u){(r===vt&&xt===2||r.cancelPendingCommit!==null)&&(So(r,0),Yi(r,et,xs,!1)),su(r,u),((Lt&2)===0||r!==vt)&&(r===vt&&((Lt&2)===0&&(Za|=u),Ot===4&&Yi(r,et,xs,!1)),li(r))}function c1(r,o,u){if((Lt&6)!==0)throw Error(n(327));var d=!u&&(o&60)===0&&(o&r.expiredLanes)===0||nu(r,o),p=d?Ik(r,o):Kg(r,o,!0),E=d;do{if(p===0){bo&&!d&&Yi(r,o,0,!1);break}else if(p===6)Yi(r,o,0,!Vi);else{if(u=r.current.alternate,E&&!Lk(u)){p=Kg(r,o,!1),E=!1;continue}if(p===2){if(E=o,r.errorRecoveryDisabledLanes&E)var w=0;else w=r.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){o=w;e:{var D=r;p=Bu;var N=D.current.memoizedState.isDehydrated;if(N&&(So(D,w).flags|=256),w=Kg(D,w,!1),w!==2){if(Pg&&!N){D.errorRecoveryDisabledLanes|=E,Za|=E,p=4;break e}E=ai,ai=p,E!==null&&Hg(E)}p=w}if(E=!1,p!==2)continue}}if(p===1){So(r,0),Yi(r,o,0,!0);break}e:{switch(d=r,p){case 0:case 1:throw Error(n(345));case 4:if((o&4194176)===o){Yi(d,o,xs,!Vi);break e}break;case 2:ai=null;break;case 3:case 5:break;default:throw Error(n(329))}if(d.finishedWork=u,d.finishedLanes=o,(o&62914560)===o&&(E=Ug+300-un(),10<E)){if(Yi(d,o,xs,!Vi),ff(d,0)!==0)break e;d.timeoutHandle=O1(u1.bind(null,d,u,ai,Zf,Bg,o,xs,Za,Ao,Vi,2,-0,0),E);break e}u1(d,u,ai,Zf,Bg,o,xs,Za,Ao,Vi,0,-0,0)}}break}while(!0);li(r)}function Hg(r){ai===null?ai=r:ai.push.apply(ai,r)}function u1(r,o,u,d,p,E,w,D,N,z,le,de,ee){var re=o.subtreeFlags;if((re&8192||(re&16785408)===16785408)&&(Ku={stylesheets:null,count:0,unsuspend:oI},e1(o),o=uI(),o!==null)){r.cancelPendingCommit=o(y1.bind(null,r,u,d,p,w,D,N,1,de,ee)),Yi(r,E,w,!z);return}y1(r,u,d,p,w,D,N,le,de,ee)}function Lk(r){for(var o=r;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var d=0;d<u.length;d++){var p=u[d],E=p.getSnapshot;p=p.value;try{if(!qn(E(),p))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Yi(r,o,u,d){o&=~Ng,o&=~Za,r.suspendedLanes|=o,r.pingedLanes&=~o,d&&(r.warmLanes|=o),d=r.expirationTimes;for(var p=o;0<p;){var E=31-Qn(p),w=1<<E;d[E]=-1,p&=~w}u!==0&&w3(r,u,o)}function e0(){return(Lt&6)===0?(Gu(0),!1):!0}function zg(){if(We!==null){if(xt===0)var r=We.return;else r=We,Ui=Qa=null,q2(r),uo=null,Eu=0,r=We;for(;r!==null;)l1(r.alternate,r),r=r.return;We=null}}function So(r,o){r.finishedWork=null,r.finishedLanes=0;var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,Yk(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),zg(),vt=r,We=u=zr(r.current,null),et=o,xt=0,Zn=null,Vi=!1,bo=nu(r,o),Pg=!1,Ao=xs=Ng=Za=Vr=Ot=0,ai=Bu=null,Bg=!1,(o&8)!==0&&(o|=o&32);var d=r.entangledLanes;if(d!==0)for(r=r.entanglements,d&=o;0<d;){var p=31-Qn(d),E=1<<p;o|=r[p],d&=~E}return Ki=o,Tf(),u}function h1(r,o){je=null,F.H=ri,o===vu?(o=Rv(),xt=3):o===Sv?(o=Rv(),xt=4):xt=o===Tx?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Zn=o,We===null&&(Ot=1,Vf(r,fs(o,r.current)))}function f1(){var r=F.H;return F.H=ri,r===null?ri:r}function d1(){var r=F.A;return F.A=wk,r}function Vg(){Ot=4,Vi||(et&4194176)!==et&&ms.current!==null||(bo=!0),(Vr&134217727)===0&&(Za&134217727)===0||vt===null||Yi(vt,et,xs,!1)}function Kg(r,o,u){var d=Lt;Lt|=2;var p=f1(),E=d1();(vt!==r||et!==o)&&(Zf=null,So(r,o)),o=!1;var w=Ot;e:do try{if(xt!==0&&We!==null){var D=We,N=Zn;switch(xt){case 8:zg(),w=6;break e;case 3:case 2:case 6:ms.current===null&&(o=!0);var z=xt;if(xt=0,Zn=null,To(r,D,N,z),u&&bo){w=0;break e}break;default:z=xt,xt=0,Zn=null,To(r,D,N,z)}}kk(),w=Ot;break}catch(le){h1(r,le)}while(!0);return o&&r.shellSuspendCounter++,Ui=Qa=null,Lt=d,F.H=p,F.A=E,We===null&&(vt=null,et=0,Tf()),w}function kk(){for(;We!==null;)g1(We)}function Ik(r,o){var u=Lt;Lt|=2;var d=f1(),p=d1();vt!==r||et!==o?(Zf=null,Wf=un()+500,So(r,o)):bo=nu(r,o);e:do try{if(xt!==0&&We!==null){o=We;var E=Zn;t:switch(xt){case 1:xt=0,Zn=null,To(r,o,E,1);break;case 2:if(Tv(E)){xt=0,Zn=null,m1(o);break}o=function(){xt===2&&vt===r&&(xt=7),li(r)},E.then(o,o);break e;case 3:xt=7;break e;case 4:xt=5;break e;case 7:Tv(E)?(xt=0,Zn=null,m1(o)):(xt=0,Zn=null,To(r,o,E,7));break;case 5:var w=null;switch(We.tag){case 26:w=We.memoizedState;case 5:case 27:var D=We;if(!w||V1(w)){xt=0,Zn=null;var N=D.sibling;if(N!==null)We=N;else{var z=D.return;z!==null?(We=z,t0(z)):We=null}break t}}xt=0,Zn=null,To(r,o,E,5);break;case 6:xt=0,Zn=null,To(r,o,E,6);break;case 8:zg(),Ot=6;break e;default:throw Error(n(462))}}Dk();break}catch(le){h1(r,le)}while(!0);return Ui=Qa=null,F.H=d,F.A=p,Lt=u,We!==null?0:(vt=null,et=0,Tf(),Ot)}function Dk(){for(;We!==null&&!_s();)g1(We)}function g1(r){var o=Nx(r.alternate,r,Ki);r.memoizedProps=r.pendingProps,o===null?t0(r):We=o}function m1(r){var o=r,u=o.alternate;switch(o.tag){case 15:case 0:o=Dx(u,o,o.pendingProps,o.type,void 0,et);break;case 11:o=Dx(u,o,o.pendingProps,o.type.render,o.ref,et);break;case 5:q2(o);default:l1(u,o),o=We=i1(o,Ki),o=Nx(u,o,Ki)}r.memoizedProps=r.pendingProps,o===null?t0(r):We=o}function To(r,o,u,d){Ui=Qa=null,q2(o),uo=null,Eu=0;var p=o.return;try{if(vk(r,p,o,u,et)){Ot=1,Vf(r,fs(u,r.current)),We=null;return}}catch(E){if(p!==null)throw We=p,E;Ot=1,Vf(r,fs(u,r.current)),We=null;return}o.flags&32768?(st||d===1?r=!0:bo||(et&536870912)!==0?r=!1:(Vi=r=!0,(d===2||d===3||d===6)&&(d=ms.current,d!==null&&d.tag===13&&(d.flags|=16384))),p1(o,r)):t0(o)}function t0(r){var o=r;do{if((o.flags&32768)!==0){p1(o,Vi);return}r=o.return;var u=Sk(o.alternate,o,Ki);if(u!==null){We=u;return}if(o=o.sibling,o!==null){We=o;return}We=o=r}while(o!==null);Ot===0&&(Ot=5)}function p1(r,o){do{var u=Tk(r.alternate,r);if(u!==null){u.flags&=32767,We=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(r=r.sibling,r!==null)){We=r;return}We=r=u}while(r!==null);Ot=6,We=null}function y1(r,o,u,d,p,E,w,D,N,z){var le=F.T,de=ue.p;try{ue.p=2,F.T=null,Ck(r,o,u,d,de,p,E,w,D,N,z)}finally{F.T=le,ue.p=de}}function Ck(r,o,u,d,p,E,w,D){do wo();while(Ja!==null);if((Lt&6)!==0)throw Error(n(327));var N=r.finishedWork;if(d=r.finishedLanes,N===null)return null;if(r.finishedWork=null,r.finishedLanes=0,N===r.current)throw Error(n(177));r.callbackNode=null,r.callbackPriority=0,r.cancelPendingCommit=null;var z=N.lanes|N.childLanes;if(z|=M2,cL(r,d,z,E,w,D),r===vt&&(We=vt=null,et=0),(N.subtreeFlags&10256)===0&&(N.flags&10256)===0||Jf||(Jf=!0,Fg=z,Gg=u,Pk(Be,function(){return wo(),null})),u=(N.flags&15990)!==0,(N.subtreeFlags&15990)!==0||u?(u=F.T,F.T=null,E=ue.p,ue.p=2,w=Lt,Lt|=4,Ek(r,N),Wx(N,r),tk(sm,r.containerInfo),d0=!!nm,sm=nm=null,r.current=N,jx(r,N.alternate,N),jl(),Lt=w,ue.p=E,F.T=u):r.current=N,Jf?(Jf=!1,Ja=r,Uu=d):v1(r,z),z=r.pendingLanes,z===0&&(Kr=null),cf(N.stateNode),li(r),o!==null)for(p=r.onRecoverableError,N=0;N<o.length;N++)z=o[N],p(z.value,{componentStack:z.stack});return(Uu&3)!==0&&wo(),z=r.pendingLanes,(d&4194218)!==0&&(z&42)!==0?r===$g?Fu++:(Fu=0,$g=r):Fu=0,Gu(0),null}function v1(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,Au(o)))}function wo(){if(Ja!==null){var r=Ja,o=Fg;Fg=0;var u=L3(Uu),d=F.T,p=ue.p;try{if(ue.p=32>u?32:u,F.T=null,Ja===null)var E=!1;else{u=Gg,Gg=null;var w=Ja,D=Uu;if(Ja=null,Uu=0,(Lt&6)!==0)throw Error(n(331));var N=Lt;if(Lt|=4,n1(w.current),Jx(w,w.current,D,u),Lt=N,Gu(0,!1),wt&&typeof wt.onPostCommitFiberRoot=="function")try{wt.onPostCommitFiberRoot(at,w)}catch{}E=!0}return E}finally{ue.p=p,F.T=d,v1(r,o)}}return!1}function x1(r,o,u){o=fs(u,o),o=cg(r.stateNode,o,2),r=Fr(r,o,2),r!==null&&(su(r,2),li(r))}function pt(r,o,u){if(r.tag===3)x1(r,r,u);else for(;o!==null;){if(o.tag===3){x1(o,r,u);break}else if(o.tag===1){var d=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Kr===null||!Kr.has(d))){r=fs(u,r),u=Ax(2),d=Fr(o,u,2),d!==null&&(Sx(u,d,o,r),su(d,2),li(d));break}}o=o.return}}function Yg(r,o,u){var d=r.pingCache;if(d===null){d=r.pingCache=new Rk;var p=new Set;d.set(o,p)}else p=d.get(o),p===void 0&&(p=new Set,d.set(o,p));p.has(u)||(Pg=!0,p.add(u),r=_k.bind(null,r,o,u),o.then(r,r))}function _k(r,o,u){var d=r.pingCache;d!==null&&d.delete(o),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,vt===r&&(et&u)===u&&(Ot===4||Ot===3&&(et&62914560)===et&&300>un()-Ug?(Lt&2)===0&&So(r,0):Ng|=u,Ao===et&&(Ao=0)),li(r)}function E1(r,o){o===0&&(o=T3()),r=Cr(r,o),r!==null&&(su(r,o),li(r))}function Ok(r){var o=r.memoizedState,u=0;o!==null&&(u=o.retryLane),E1(r,u)}function Mk(r,o){var u=0;switch(r.tag){case 13:var d=r.stateNode,p=r.memoizedState;p!==null&&(u=p.retryLane);break;case 19:d=r.stateNode;break;case 22:d=r.stateNode._retryCache;break;default:throw Error(n(314))}d!==null&&d.delete(o),E1(r,u)}function Pk(r,o){return cn(r,o)}var n0=null,Ro=null,jg=!1,s0=!1,Qg=!1,el=0;function li(r){r!==Ro&&r.next===null&&(Ro===null?n0=Ro=r:Ro=Ro.next=r),s0=!0,jg||(jg=!0,Bk(Nk))}function Gu(r,o){if(!Qg&&s0){Qg=!0;do for(var u=!1,d=n0;d!==null;){if(r!==0){var p=d.pendingLanes;if(p===0)var E=0;else{var w=d.suspendedLanes,D=d.pingedLanes;E=(1<<31-Qn(42|r)+1)-1,E&=p&~(w&~D),E=E&201326677?E&201326677|1:E?E|2:0}E!==0&&(u=!0,S1(d,E))}else E=et,E=ff(d,d===vt?E:0),(E&3)===0||nu(d,E)||(u=!0,S1(d,E));d=d.next}while(u);Qg=!1}}function Nk(){s0=jg=!1;var r=0;el!==0&&(Kk()&&(r=el),el=0);for(var o=un(),u=null,d=n0;d!==null;){var p=d.next,E=b1(d,o);E===0?(d.next=null,u===null?n0=p:u.next=p,p===null&&(Ro=u)):(u=d,(r!==0||(E&3)!==0)&&(s0=!0)),d=p}Gu(r)}function b1(r,o){for(var u=r.suspendedLanes,d=r.pingedLanes,p=r.expirationTimes,E=r.pendingLanes&-62914561;0<E;){var w=31-Qn(E),D=1<<w,N=p[w];N===-1?((D&u)===0||(D&d)!==0)&&(p[w]=oL(D,o)):N<=o&&(r.expiredLanes|=D),E&=~D}if(o=vt,u=et,u=ff(r,r===o?u:0),d=r.callbackNode,u===0||r===o&&xt===2||r.cancelPendingCommit!==null)return d!==null&&d!==null&&os(d),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||nu(r,u)){if(o=u&-u,o===r.callbackPriority)return o;switch(d!==null&&os(d),L3(u)){case 2:case 8:u=De;break;case 32:u=Be;break;case 268435456:u=_e;break;default:u=Be}return d=A1.bind(null,r),u=cn(u,d),r.callbackPriority=o,r.callbackNode=u,o}return d!==null&&d!==null&&os(d),r.callbackPriority=2,r.callbackNode=null,2}function A1(r,o){var u=r.callbackNode;if(wo()&&r.callbackNode!==u)return null;var d=et;return d=ff(r,r===vt?d:0),d===0?null:(c1(r,d,o),b1(r,un()),r.callbackNode!=null&&r.callbackNode===u?A1.bind(null,r):null)}function S1(r,o){if(wo())return null;c1(r,o,!0)}function Bk(r){jk(function(){(Lt&6)!==0?cn(ti,r):r()})}function qg(){return el===0&&(el=S3()),el}function T1(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:yf(""+r)}function w1(r,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,r.id&&u.setAttribute("form",r.id),o.parentNode.insertBefore(u,o),r=new FormData(r),u.parentNode.removeChild(u),r}function Uk(r,o,u,d,p){if(o==="submit"&&u&&u.stateNode===p){var E=T1((p[Bn]||null).action),w=d.submitter;w&&(o=(o=w[Bn]||null)?T1(o.formAction):w.getAttribute("formAction"),o!==null&&(E=o,w=null));var D=new bf("action","action",null,d,p);r.push({event:D,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(el!==0){var N=w?w1(p,w):new FormData(p);ig(u,{pending:!0,data:N,method:p.method,action:E},null,N)}}else typeof E=="function"&&(D.preventDefault(),N=w?w1(p,w):new FormData(p),ig(u,{pending:!0,data:N,method:p.method,action:E},E,N))},currentTarget:p}]})}}for(var Xg=0;Xg<yv.length;Xg++){var Wg=yv[Xg],Fk=Wg.toLowerCase(),Gk=Wg[0].toUpperCase()+Wg.slice(1);Os(Fk,"on"+Gk)}Os(fv,"onAnimationEnd"),Os(dv,"onAnimationIteration"),Os(gv,"onAnimationStart"),Os("dblclick","onDoubleClick"),Os("focusin","onFocus"),Os("focusout","onBlur"),Os(sk,"onTransitionRun"),Os(ik,"onTransitionStart"),Os(rk,"onTransitionCancel"),Os(mv,"onTransitionEnd"),Zl("onMouseEnter",["mouseout","mouseover"]),Zl("onMouseLeave",["mouseout","mouseover"]),Zl("onPointerEnter",["pointerout","pointerover"]),Zl("onPointerLeave",["pointerout","pointerover"]),Pa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Pa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Pa("onBeforeInput",["compositionend","keypress","textInput","paste"]),Pa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Pa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Pa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $u="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$k=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($u));function R1(r,o){o=(o&4)!==0;for(var u=0;u<r.length;u++){var d=r[u],p=d.event;d=d.listeners;e:{var E=void 0;if(o)for(var w=d.length-1;0<=w;w--){var D=d[w],N=D.instance,z=D.currentTarget;if(D=D.listener,N!==E&&p.isPropagationStopped())break e;E=D,p.currentTarget=z;try{E(p)}catch(le){zf(le)}p.currentTarget=null,E=N}else for(w=0;w<d.length;w++){if(D=d[w],N=D.instance,z=D.currentTarget,D=D.listener,N!==E&&p.isPropagationStopped())break e;E=D,p.currentTarget=z;try{E(p)}catch(le){zf(le)}p.currentTarget=null,E=N}}}}function Ze(r,o){var u=o[d2];u===void 0&&(u=o[d2]=new Set);var d=r+"__bubble";u.has(d)||(L1(o,r,2,!1),u.add(d))}function Zg(r,o,u){var d=0;o&&(d|=4),L1(u,r,d,o)}var i0="_reactListening"+Math.random().toString(36).slice(2);function Jg(r){if(!r[i0]){r[i0]=!0,D3.forEach(function(u){u!=="selectionchange"&&($k.has(u)||Zg(u,!1,r),Zg(u,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[i0]||(o[i0]=!0,Zg("selectionchange",!1,o))}}function L1(r,o,u,d){switch(X1(o)){case 2:var p=dI;break;case 8:p=gI;break;default:p=fm}u=p.bind(null,o,u,r),p=void 0,!b2||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(p=!0),d?p!==void 0?r.addEventListener(o,u,{capture:!0,passive:p}):r.addEventListener(o,u,!0):p!==void 0?r.addEventListener(o,u,{passive:p}):r.addEventListener(o,u,!1)}function em(r,o,u,d,p){var E=d;if((o&1)===0&&(o&2)===0&&d!==null)e:for(;;){if(d===null)return;var w=d.tag;if(w===3||w===4){var D=d.stateNode.containerInfo;if(D===p||D.nodeType===8&&D.parentNode===p)break;if(w===4)for(w=d.return;w!==null;){var N=w.tag;if((N===3||N===4)&&(N=w.stateNode.containerInfo,N===p||N.nodeType===8&&N.parentNode===p))return;w=w.return}for(;D!==null;){if(w=Ma(D),w===null)return;if(N=w.tag,N===5||N===6||N===26||N===27){d=E=w;continue e}D=D.parentNode}}d=d.return}H3(function(){var z=E,le=x2(u),de=[];e:{var ee=pv.get(r);if(ee!==void 0){var re=bf,Le=r;switch(r){case"keypress":if(xf(u)===0)break e;case"keydown":case"keyup":re=ML;break;case"focusin":Le="focus",re=w2;break;case"focusout":Le="blur",re=w2;break;case"beforeblur":case"afterblur":re=w2;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":re=K3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":re=AL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":re=BL;break;case fv:case dv:case gv:re=wL;break;case mv:re=FL;break;case"scroll":case"scrollend":re=EL;break;case"wheel":re=$L;break;case"copy":case"cut":case"paste":re=LL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":re=j3;break;case"toggle":case"beforetoggle":re=zL}var Fe=(o&4)!==0,Mt=!Fe&&(r==="scroll"||r==="scrollend"),K=Fe?ee!==null?ee+"Capture":null:ee;Fe=[];for(var $=z,q;$!==null;){var he=$;if(q=he.stateNode,he=he.tag,he!==5&&he!==26&&he!==27||q===null||K===null||(he=au($,K),he!=null&&Fe.push(Hu($,he,q))),Mt)break;$=$.return}0<Fe.length&&(ee=new re(ee,Le,null,u,le),de.push({event:ee,listeners:Fe}))}}if((o&7)===0){e:{if(ee=r==="mouseover"||r==="pointerover",re=r==="mouseout"||r==="pointerout",ee&&u!==v2&&(Le=u.relatedTarget||u.fromElement)&&(Ma(Le)||Le[ql]))break e;if((re||ee)&&(ee=le.window===le?le:(ee=le.ownerDocument)?ee.defaultView||ee.parentWindow:window,re?(Le=u.relatedTarget||u.toElement,re=z,Le=Le?Ma(Le):null,Le!==null&&(Mt=se(Le),Fe=Le.tag,Le!==Mt||Fe!==5&&Fe!==27&&Fe!==6)&&(Le=null)):(re=null,Le=z),re!==Le)){if(Fe=K3,he="onMouseLeave",K="onMouseEnter",$="mouse",(r==="pointerout"||r==="pointerover")&&(Fe=j3,he="onPointerLeave",K="onPointerEnter",$="pointer"),Mt=re==null?ee:ru(re),q=Le==null?ee:ru(Le),ee=new Fe(he,$+"leave",re,u,le),ee.target=Mt,ee.relatedTarget=q,he=null,Ma(le)===z&&(Fe=new Fe(K,$+"enter",Le,u,le),Fe.target=q,Fe.relatedTarget=Mt,he=Fe),Mt=he,re&&Le)t:{for(Fe=re,K=Le,$=0,q=Fe;q;q=Lo(q))$++;for(q=0,he=K;he;he=Lo(he))q++;for(;0<$-q;)Fe=Lo(Fe),$--;for(;0<q-$;)K=Lo(K),q--;for(;$--;){if(Fe===K||K!==null&&Fe===K.alternate)break t;Fe=Lo(Fe),K=Lo(K)}Fe=null}else Fe=null;re!==null&&k1(de,ee,re,Fe,!1),Le!==null&&Mt!==null&&k1(de,Mt,Le,Fe,!0)}}e:{if(ee=z?ru(z):window,re=ee.nodeName&&ee.nodeName.toLowerCase(),re==="select"||re==="input"&&ee.type==="file")var Se=tv;else if(J3(ee))if(nv)Se=JL;else{Se=WL;var Qe=XL}else re=ee.nodeName,!re||re.toLowerCase()!=="input"||ee.type!=="checkbox"&&ee.type!=="radio"?z&&y2(z.elementType)&&(Se=tv):Se=ZL;if(Se&&(Se=Se(r,z))){ev(de,Se,u,le);break e}Qe&&Qe(r,ee,z),r==="focusout"&&z&&ee.type==="number"&&z.memoizedProps.value!=null&&p2(ee,"number",ee.value)}switch(Qe=z?ru(z):window,r){case"focusin":(J3(Qe)||Qe.contentEditable==="true")&&(io=Qe,C2=z,gu=null);break;case"focusout":gu=C2=io=null;break;case"mousedown":_2=!0;break;case"contextmenu":case"mouseup":case"dragend":_2=!1,uv(de,u,le);break;case"selectionchange":if(nk)break;case"keydown":case"keyup":uv(de,u,le)}var Ie;if(L2)e:{switch(r){case"compositionstart":var Pe="onCompositionStart";break e;case"compositionend":Pe="onCompositionEnd";break e;case"compositionupdate":Pe="onCompositionUpdate";break e}Pe=void 0}else so?W3(r,u)&&(Pe="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(Pe="onCompositionStart");Pe&&(Q3&&u.locale!=="ko"&&(so||Pe!=="onCompositionStart"?Pe==="onCompositionEnd"&&so&&(Ie=z3()):(Dr=le,A2="value"in Dr?Dr.value:Dr.textContent,so=!0)),Qe=r0(z,Pe),0<Qe.length&&(Pe=new Y3(Pe,r,null,u,le),de.push({event:Pe,listeners:Qe}),Ie?Pe.data=Ie:(Ie=Z3(u),Ie!==null&&(Pe.data=Ie)))),(Ie=KL?YL(r,u):jL(r,u))&&(Pe=r0(z,"onBeforeInput"),0<Pe.length&&(Qe=new Y3("onBeforeInput","beforeinput",null,u,le),de.push({event:Qe,listeners:Pe}),Qe.data=Ie)),Uk(de,r,z,u,le)}R1(de,o)})}function Hu(r,o,u){return{instance:r,listener:o,currentTarget:u}}function r0(r,o){for(var u=o+"Capture",d=[];r!==null;){var p=r,E=p.stateNode;p=p.tag,p!==5&&p!==26&&p!==27||E===null||(p=au(r,u),p!=null&&d.unshift(Hu(r,p,E)),p=au(r,o),p!=null&&d.push(Hu(r,p,E))),r=r.return}return d}function Lo(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function k1(r,o,u,d,p){for(var E=o._reactName,w=[];u!==null&&u!==d;){var D=u,N=D.alternate,z=D.stateNode;if(D=D.tag,N!==null&&N===d)break;D!==5&&D!==26&&D!==27||z===null||(N=z,p?(z=au(u,E),z!=null&&w.unshift(Hu(u,z,N))):p||(z=au(u,E),z!=null&&w.push(Hu(u,z,N)))),u=u.return}w.length!==0&&r.push({event:o,listeners:w})}var Hk=/\r\n?/g,zk=/\u0000|\uFFFD/g;function I1(r){return(typeof r=="string"?r:""+r).replace(Hk,`
`).replace(zk,"")}function D1(r,o){return o=I1(o),I1(r)===o}function a0(){}function dt(r,o,u,d,p,E){switch(u){case"children":typeof d=="string"?o==="body"||o==="textarea"&&d===""||eo(r,d):(typeof d=="number"||typeof d=="bigint")&&o!=="body"&&eo(r,""+d);break;case"className":gf(r,"class",d);break;case"tabIndex":gf(r,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":gf(r,u,d);break;case"style":G3(r,d,E);break;case"data":if(o!=="object"){gf(r,"data",d);break}case"src":case"href":if(d===""&&(o!=="a"||u!=="href")){r.removeAttribute(u);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(u);break}d=yf(""+d),r.setAttribute(u,d);break;case"action":case"formAction":if(typeof d=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(u==="formAction"?(o!=="input"&&dt(r,o,"name",p.name,p,null),dt(r,o,"formEncType",p.formEncType,p,null),dt(r,o,"formMethod",p.formMethod,p,null),dt(r,o,"formTarget",p.formTarget,p,null)):(dt(r,o,"encType",p.encType,p,null),dt(r,o,"method",p.method,p,null),dt(r,o,"target",p.target,p,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(u);break}d=yf(""+d),r.setAttribute(u,d);break;case"onClick":d!=null&&(r.onclick=a0);break;case"onScroll":d!=null&&Ze("scroll",r);break;case"onScrollEnd":d!=null&&Ze("scrollend",r);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(u=d.__html,u!=null){if(p.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"multiple":r.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":r.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){r.removeAttribute("xlink:href");break}u=yf(""+d),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(u,""+d):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":d===!0?r.setAttribute(u,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(u,d):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?r.setAttribute(u,d):r.removeAttribute(u);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?r.removeAttribute(u):r.setAttribute(u,d);break;case"popover":Ze("beforetoggle",r),Ze("toggle",r),df(r,"popover",d);break;case"xlinkActuate":_i(r,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":_i(r,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":_i(r,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":_i(r,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":_i(r,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":_i(r,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":_i(r,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":_i(r,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":_i(r,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":df(r,"is",d);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=vL.get(u)||u,df(r,u,d))}}function tm(r,o,u,d,p,E){switch(u){case"style":G3(r,d,E);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(u=d.__html,u!=null){if(p.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"children":typeof d=="string"?eo(r,d):(typeof d=="number"||typeof d=="bigint")&&eo(r,""+d);break;case"onScroll":d!=null&&Ze("scroll",r);break;case"onScrollEnd":d!=null&&Ze("scrollend",r);break;case"onClick":d!=null&&(r.onclick=a0);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!C3.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(p=u.endsWith("Capture"),o=u.slice(2,p?u.length-7:void 0),E=r[Bn]||null,E=E!=null?E[u]:null,typeof E=="function"&&r.removeEventListener(o,E,p),typeof d=="function")){typeof E!="function"&&E!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(o,d,p);break e}u in r?r[u]=d:d===!0?r.setAttribute(u,""):df(r,u,d)}}}function dn(r,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ze("error",r),Ze("load",r);var d=!1,p=!1,E;for(E in u)if(u.hasOwnProperty(E)){var w=u[E];if(w!=null)switch(E){case"src":d=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:dt(r,o,E,w,u,null)}}p&&dt(r,o,"srcSet",u.srcSet,u,null),d&&dt(r,o,"src",u.src,u,null);return;case"input":Ze("invalid",r);var D=E=w=p=null,N=null,z=null;for(d in u)if(u.hasOwnProperty(d)){var le=u[d];if(le!=null)switch(d){case"name":p=le;break;case"type":w=le;break;case"checked":N=le;break;case"defaultChecked":z=le;break;case"value":E=le;break;case"defaultValue":D=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(n(137,o));break;default:dt(r,o,d,le,u,null)}}N3(r,E,D,N,z,w,p,!1),mf(r);return;case"select":Ze("invalid",r),d=w=E=null;for(p in u)if(u.hasOwnProperty(p)&&(D=u[p],D!=null))switch(p){case"value":E=D;break;case"defaultValue":w=D;break;case"multiple":d=D;default:dt(r,o,p,D,u,null)}o=E,u=w,r.multiple=!!d,o!=null?Jl(r,!!d,o,!1):u!=null&&Jl(r,!!d,u,!0);return;case"textarea":Ze("invalid",r),E=p=d=null;for(w in u)if(u.hasOwnProperty(w)&&(D=u[w],D!=null))switch(w){case"value":d=D;break;case"defaultValue":p=D;break;case"children":E=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(n(91));break;default:dt(r,o,w,D,u,null)}U3(r,d,p,E),mf(r);return;case"option":for(N in u)if(u.hasOwnProperty(N)&&(d=u[N],d!=null))switch(N){case"selected":r.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:dt(r,o,N,d,u,null)}return;case"dialog":Ze("cancel",r),Ze("close",r);break;case"iframe":case"object":Ze("load",r);break;case"video":case"audio":for(d=0;d<$u.length;d++)Ze($u[d],r);break;case"image":Ze("error",r),Ze("load",r);break;case"details":Ze("toggle",r);break;case"embed":case"source":case"link":Ze("error",r),Ze("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(z in u)if(u.hasOwnProperty(z)&&(d=u[z],d!=null))switch(z){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:dt(r,o,z,d,u,null)}return;default:if(y2(o)){for(le in u)u.hasOwnProperty(le)&&(d=u[le],d!==void 0&&tm(r,o,le,d,u,void 0));return}}for(D in u)u.hasOwnProperty(D)&&(d=u[D],d!=null&&dt(r,o,D,d,u,null))}function Vk(r,o,u,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,E=null,w=null,D=null,N=null,z=null,le=null;for(re in u){var de=u[re];if(u.hasOwnProperty(re)&&de!=null)switch(re){case"checked":break;case"value":break;case"defaultValue":N=de;default:d.hasOwnProperty(re)||dt(r,o,re,null,d,de)}}for(var ee in d){var re=d[ee];if(de=u[ee],d.hasOwnProperty(ee)&&(re!=null||de!=null))switch(ee){case"type":E=re;break;case"name":p=re;break;case"checked":z=re;break;case"defaultChecked":le=re;break;case"value":w=re;break;case"defaultValue":D=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(n(137,o));break;default:re!==de&&dt(r,o,ee,re,d,de)}}m2(r,w,D,N,z,le,E,p);return;case"select":re=w=D=ee=null;for(E in u)if(N=u[E],u.hasOwnProperty(E)&&N!=null)switch(E){case"value":break;case"multiple":re=N;default:d.hasOwnProperty(E)||dt(r,o,E,null,d,N)}for(p in d)if(E=d[p],N=u[p],d.hasOwnProperty(p)&&(E!=null||N!=null))switch(p){case"value":ee=E;break;case"defaultValue":D=E;break;case"multiple":w=E;default:E!==N&&dt(r,o,p,E,d,N)}o=D,u=w,d=re,ee!=null?Jl(r,!!u,ee,!1):!!d!=!!u&&(o!=null?Jl(r,!!u,o,!0):Jl(r,!!u,u?[]:"",!1));return;case"textarea":re=ee=null;for(D in u)if(p=u[D],u.hasOwnProperty(D)&&p!=null&&!d.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:dt(r,o,D,null,d,p)}for(w in d)if(p=d[w],E=u[w],d.hasOwnProperty(w)&&(p!=null||E!=null))switch(w){case"value":ee=p;break;case"defaultValue":re=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(n(91));break;default:p!==E&&dt(r,o,w,p,d,E)}B3(r,ee,re);return;case"option":for(var Le in u)if(ee=u[Le],u.hasOwnProperty(Le)&&ee!=null&&!d.hasOwnProperty(Le))switch(Le){case"selected":r.selected=!1;break;default:dt(r,o,Le,null,d,ee)}for(N in d)if(ee=d[N],re=u[N],d.hasOwnProperty(N)&&ee!==re&&(ee!=null||re!=null))switch(N){case"selected":r.selected=ee&&typeof ee!="function"&&typeof ee!="symbol";break;default:dt(r,o,N,ee,d,re)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Fe in u)ee=u[Fe],u.hasOwnProperty(Fe)&&ee!=null&&!d.hasOwnProperty(Fe)&&dt(r,o,Fe,null,d,ee);for(z in d)if(ee=d[z],re=u[z],d.hasOwnProperty(z)&&ee!==re&&(ee!=null||re!=null))switch(z){case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(n(137,o));break;default:dt(r,o,z,ee,d,re)}return;default:if(y2(o)){for(var Mt in u)ee=u[Mt],u.hasOwnProperty(Mt)&&ee!==void 0&&!d.hasOwnProperty(Mt)&&tm(r,o,Mt,void 0,d,ee);for(le in d)ee=d[le],re=u[le],!d.hasOwnProperty(le)||ee===re||ee===void 0&&re===void 0||tm(r,o,le,ee,d,re);return}}for(var K in u)ee=u[K],u.hasOwnProperty(K)&&ee!=null&&!d.hasOwnProperty(K)&&dt(r,o,K,null,d,ee);for(de in d)ee=d[de],re=u[de],!d.hasOwnProperty(de)||ee===re||ee==null&&re==null||dt(r,o,de,ee,d,re)}var nm=null,sm=null;function l0(r){return r.nodeType===9?r:r.ownerDocument}function C1(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function _1(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function im(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var rm=null;function Kk(){var r=window.event;return r&&r.type==="popstate"?r===rm?!1:(rm=r,!0):(rm=null,!1)}var O1=typeof setTimeout=="function"?setTimeout:void 0,Yk=typeof clearTimeout=="function"?clearTimeout:void 0,M1=typeof Promise=="function"?Promise:void 0,jk=typeof queueMicrotask=="function"?queueMicrotask:typeof M1<"u"?function(r){return M1.resolve(null).then(r).catch(Qk)}:O1;function Qk(r){setTimeout(function(){throw r})}function am(r,o){var u=o,d=0;do{var p=u.nextSibling;if(r.removeChild(u),p&&p.nodeType===8)if(u=p.data,u==="/$"){if(d===0){r.removeChild(p),Xu(o);return}d--}else u!=="$"&&u!=="$?"&&u!=="$!"||d++;u=p}while(u);Xu(o)}function lm(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":lm(u),g2(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function qk(r,o,u,d){for(;r.nodeType===1;){var p=u;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!d&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(d){if(!r[iu])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(E=r.getAttribute("rel"),E==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(E!==p.rel||r.getAttribute("href")!==(p.href==null?null:p.href)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||r.getAttribute("title")!==(p.title==null?null:p.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(E=r.getAttribute("src"),(E!==(p.src==null?null:p.src)||r.getAttribute("type")!==(p.type==null?null:p.type)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&E&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var E=p.name==null?null:""+p.name;if(p.type==="hidden"&&r.getAttribute("name")===E)return r}else return r;if(r=Ns(r.nextSibling),r===null)break}return null}function Xk(r,o,u){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=Ns(r.nextSibling),r===null))return null;return r}function Ns(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return r}function P1(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return r;o--}else u==="/$"&&o++}r=r.previousSibling}return null}function N1(r,o,u){switch(o=l0(u),r){case"html":if(r=o.documentElement,!r)throw Error(n(452));return r;case"head":if(r=o.head,!r)throw Error(n(453));return r;case"body":if(r=o.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}var Es=new Map,B1=new Set;function o0(r){return typeof r.getRootNode=="function"?r.getRootNode():r.ownerDocument}var ji=ue.d;ue.d={f:Wk,r:Zk,D:Jk,C:eI,L:tI,m:nI,X:iI,S:sI,M:rI};function Wk(){var r=ji.f(),o=e0();return r||o}function Zk(r){var o=Xl(r);o!==null&&o.tag===5&&o.type==="form"?ux(o):ji.r(r)}var ko=typeof document>"u"?null:document;function U1(r,o,u){var d=ko;if(d&&typeof o=="string"&&o){var p=us(o);p='link[rel="'+r+'"][href="'+p+'"]',typeof u=="string"&&(p+='[crossorigin="'+u+'"]'),B1.has(p)||(B1.add(p),r={rel:r,crossOrigin:u,href:o},d.querySelector(p)===null&&(o=d.createElement("link"),dn(o,"link",r),Jt(o),d.head.appendChild(o)))}}function Jk(r){ji.D(r),U1("dns-prefetch",r,null)}function eI(r,o){ji.C(r,o),U1("preconnect",r,o)}function tI(r,o,u){ji.L(r,o,u);var d=ko;if(d&&r&&o){var p='link[rel="preload"][as="'+us(o)+'"]';o==="image"&&u&&u.imageSrcSet?(p+='[imagesrcset="'+us(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(p+='[imagesizes="'+us(u.imageSizes)+'"]')):p+='[href="'+us(r)+'"]';var E=p;switch(o){case"style":E=Io(r);break;case"script":E=Do(r)}Es.has(E)||(r=M({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:r,as:o},u),Es.set(E,r),d.querySelector(p)!==null||o==="style"&&d.querySelector(zu(E))||o==="script"&&d.querySelector(Vu(E))||(o=d.createElement("link"),dn(o,"link",r),Jt(o),d.head.appendChild(o)))}}function nI(r,o){ji.m(r,o);var u=ko;if(u&&r){var d=o&&typeof o.as=="string"?o.as:"script",p='link[rel="modulepreload"][as="'+us(d)+'"][href="'+us(r)+'"]',E=p;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=Do(r)}if(!Es.has(E)&&(r=M({rel:"modulepreload",href:r},o),Es.set(E,r),u.querySelector(p)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Vu(E)))return}d=u.createElement("link"),dn(d,"link",r),Jt(d),u.head.appendChild(d)}}}function sI(r,o,u){ji.S(r,o,u);var d=ko;if(d&&r){var p=Wl(d).hoistableStyles,E=Io(r);o=o||"default";var w=p.get(E);if(!w){var D={loading:0,preload:null};if(w=d.querySelector(zu(E)))D.loading=5;else{r=M({rel:"stylesheet",href:r,"data-precedence":o},u),(u=Es.get(E))&&om(r,u);var N=w=d.createElement("link");Jt(N),dn(N,"link",r),N._p=new Promise(function(z,le){N.onload=z,N.onerror=le}),N.addEventListener("load",function(){D.loading|=1}),N.addEventListener("error",function(){D.loading|=2}),D.loading|=4,c0(w,o,d)}w={type:"stylesheet",instance:w,count:1,state:D},p.set(E,w)}}}function iI(r,o){ji.X(r,o);var u=ko;if(u&&r){var d=Wl(u).hoistableScripts,p=Do(r),E=d.get(p);E||(E=u.querySelector(Vu(p)),E||(r=M({src:r,async:!0},o),(o=Es.get(p))&&cm(r,o),E=u.createElement("script"),Jt(E),dn(E,"link",r),u.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},d.set(p,E))}}function rI(r,o){ji.M(r,o);var u=ko;if(u&&r){var d=Wl(u).hoistableScripts,p=Do(r),E=d.get(p);E||(E=u.querySelector(Vu(p)),E||(r=M({src:r,async:!0,type:"module"},o),(o=Es.get(p))&&cm(r,o),E=u.createElement("script"),Jt(E),dn(E,"link",r),u.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},d.set(p,E))}}function F1(r,o,u,d){var p=(p=yt.current)?o0(p):null;if(!p)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Io(u.href),u=Wl(p).hoistableStyles,d=u.get(o),d||(d={type:"style",instance:null,count:0,state:null},u.set(o,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=Io(u.href);var E=Wl(p).hoistableStyles,w=E.get(r);if(w||(p=p.ownerDocument||p,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(r,w),(E=p.querySelector(zu(r)))&&!E._p&&(w.instance=E,w.state.loading=5),Es.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Es.set(r,u),E||aI(p,r,u,w.state))),o&&d===null)throw Error(n(528,""));return w}if(o&&d!==null)throw Error(n(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Do(u),u=Wl(p).hoistableScripts,d=u.get(o),d||(d={type:"script",instance:null,count:0,state:null},u.set(o,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function Io(r){return'href="'+us(r)+'"'}function zu(r){return'link[rel="stylesheet"]['+r+"]"}function G1(r){return M({},r,{"data-precedence":r.precedence,precedence:null})}function aI(r,o,u,d){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?d.loading=1:(o=r.createElement("link"),d.preload=o,o.addEventListener("load",function(){return d.loading|=1}),o.addEventListener("error",function(){return d.loading|=2}),dn(o,"link",u),Jt(o),r.head.appendChild(o))}function Do(r){return'[src="'+us(r)+'"]'}function Vu(r){return"script[async]"+r}function $1(r,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var d=r.querySelector('style[data-href~="'+us(u.href)+'"]');if(d)return o.instance=d,Jt(d),d;var p=M({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return d=(r.ownerDocument||r).createElement("style"),Jt(d),dn(d,"style",p),c0(d,u.precedence,r),o.instance=d;case"stylesheet":p=Io(u.href);var E=r.querySelector(zu(p));if(E)return o.state.loading|=4,o.instance=E,Jt(E),E;d=G1(u),(p=Es.get(p))&&om(d,p),E=(r.ownerDocument||r).createElement("link"),Jt(E);var w=E;return w._p=new Promise(function(D,N){w.onload=D,w.onerror=N}),dn(E,"link",d),o.state.loading|=4,c0(E,u.precedence,r),o.instance=E;case"script":return E=Do(u.src),(p=r.querySelector(Vu(E)))?(o.instance=p,Jt(p),p):(d=u,(p=Es.get(E))&&(d=M({},u),cm(d,p)),r=r.ownerDocument||r,p=r.createElement("script"),Jt(p),dn(p,"link",d),r.head.appendChild(p),o.instance=p);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(d=o.instance,o.state.loading|=4,c0(d,u.precedence,r));return o.instance}function c0(r,o,u){for(var d=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=d.length?d[d.length-1]:null,E=p,w=0;w<d.length;w++){var D=d[w];if(D.dataset.precedence===o)E=D;else if(E!==p)break}E?E.parentNode.insertBefore(r,E.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(r,o.firstChild))}function om(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function cm(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var u0=null;function H1(r,o,u){if(u0===null){var d=new Map,p=u0=new Map;p.set(u,d)}else p=u0,d=p.get(u),d||(d=new Map,p.set(u,d));if(d.has(r))return d;for(d.set(r,null),u=u.getElementsByTagName(r),p=0;p<u.length;p++){var E=u[p];if(!(E[iu]||E[xn]||r==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var w=E.getAttribute(o)||"";w=r+w;var D=d.get(w);D?D.push(E):d.set(w,[E])}}return d}function z1(r,o,u){r=r.ownerDocument||r,r.head.insertBefore(u,o==="title"?r.querySelector("head > title"):null)}function lI(r,o,u){if(u===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return r=o.disabled,typeof o.precedence=="string"&&r==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function V1(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var Ku=null;function oI(){}function cI(r,o,u){if(Ku===null)throw Error(n(475));var d=Ku;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var p=Io(u.href),E=r.querySelector(zu(p));if(E){r=E._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(d.count++,d=h0.bind(d),r.then(d,d)),o.state.loading|=4,o.instance=E,Jt(E);return}E=r.ownerDocument||r,u=G1(u),(p=Es.get(p))&&om(u,p),E=E.createElement("link"),Jt(E);var w=E;w._p=new Promise(function(D,N){w.onload=D,w.onerror=N}),dn(E,"link",u),o.instance=E}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(d.count++,o=h0.bind(d),r.addEventListener("load",o),r.addEventListener("error",o))}}function uI(){if(Ku===null)throw Error(n(475));var r=Ku;return r.stylesheets&&r.count===0&&um(r,r.stylesheets),0<r.count?function(o){var u=setTimeout(function(){if(r.stylesheets&&um(r,r.stylesheets),r.unsuspend){var d=r.unsuspend;r.unsuspend=null,d()}},6e4);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(u)}}:null}function h0(){if(this.count--,this.count===0){if(this.stylesheets)um(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var f0=null;function um(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,f0=new Map,o.forEach(hI,r),f0=null,h0.call(r))}function hI(r,o){if(!(o.state.loading&4)){var u=f0.get(r);if(u)var d=u.get(null);else{u=new Map,f0.set(r,u);for(var p=r.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<p.length;E++){var w=p[E];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(u.set(w.dataset.precedence,w),d=w)}d&&u.set(null,d)}p=o.instance,w=p.getAttribute("data-precedence"),E=u.get(w)||d,E===d&&u.set(null,p),u.set(w,p),this.count++,d=h0.bind(this),p.addEventListener("load",d),p.addEventListener("error",d),E?E.parentNode.insertBefore(p,E.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(p,r.firstChild)),o.state.loading|=4}}var Yu={$$typeof:v,Provider:null,Consumer:null,_currentValue:xe,_currentValue2:xe,_threadCount:0};function fI(r,o,u,d,p,E,w,D){this.tag=1,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=f2(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=f2(0),this.hiddenUpdates=f2(null),this.identifierPrefix=d,this.onUncaughtError=p,this.onCaughtError=E,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function K1(r,o,u,d,p,E,w,D,N,z,le,de){return r=new fI(r,o,u,w,D,N,z,de),o=1,E===!0&&(o|=24),E=vs(3,null,null,o),r.current=E,E.stateNode=r,o=H2(),o.refCount++,r.pooledCache=o,o.refCount++,E.memoizedState={element:d,isDehydrated:u,cache:o},Ag(E),r}function Y1(r){return r?(r=lo,r):lo}function j1(r,o,u,d,p,E){p=Y1(p),d.context===null?d.context=p:d.pendingContext=p,d=Ur(o),d.payload={element:u},E=E===void 0?null:E,E!==null&&(d.callback=E),u=Fr(r,d,o),u!==null&&(kn(u,r,o),Iu(u,r,o))}function Q1(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<o?u:o}}function hm(r,o){Q1(r,o),(r=r.alternate)&&Q1(r,o)}function q1(r){if(r.tag===13){var o=Cr(r,67108864);o!==null&&kn(o,r,67108864),hm(r,67108864)}}var d0=!0;function dI(r,o,u,d){var p=F.T;F.T=null;var E=ue.p;try{ue.p=2,fm(r,o,u,d)}finally{ue.p=E,F.T=p}}function gI(r,o,u,d){var p=F.T;F.T=null;var E=ue.p;try{ue.p=8,fm(r,o,u,d)}finally{ue.p=E,F.T=p}}function fm(r,o,u,d){if(d0){var p=dm(d);if(p===null)em(r,o,d,g0,u),W1(r,d);else if(pI(p,r,o,u,d))d.stopPropagation();else if(W1(r,d),o&4&&-1<mI.indexOf(r)){for(;p!==null;){var E=Xl(p);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var w=Oa(E.pendingLanes);if(w!==0){var D=E;for(D.pendingLanes|=2,D.entangledLanes|=2;w;){var N=1<<31-Qn(w);D.entanglements[1]|=N,w&=~N}li(E),(Lt&6)===0&&(Wf=un()+500,Gu(0))}}break;case 13:D=Cr(E,2),D!==null&&kn(D,E,2),e0(),hm(E,2)}if(E=dm(d),E===null&&em(r,o,d,g0,u),E===p)break;p=E}p!==null&&d.stopPropagation()}else em(r,o,d,null,u)}}function dm(r){return r=x2(r),gm(r)}var g0=null;function gm(r){if(g0=null,r=Ma(r),r!==null){var o=se(r);if(o===null)r=null;else{var u=o.tag;if(u===13){if(r=Z(o),r!==null)return r;r=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return g0=r,null}function X1(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ql()){case ti:return 2;case De:return 8;case Be:case Me:return 32;case _e:return 268435456;default:return 32}default:return 32}}var mm=!1,Yr=null,jr=null,Qr=null,ju=new Map,Qu=new Map,qr=[],mI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function W1(r,o){switch(r){case"focusin":case"focusout":Yr=null;break;case"dragenter":case"dragleave":jr=null;break;case"mouseover":case"mouseout":Qr=null;break;case"pointerover":case"pointerout":ju.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qu.delete(o.pointerId)}}function qu(r,o,u,d,p,E){return r===null||r.nativeEvent!==E?(r={blockedOn:o,domEventName:u,eventSystemFlags:d,nativeEvent:E,targetContainers:[p]},o!==null&&(o=Xl(o),o!==null&&q1(o)),r):(r.eventSystemFlags|=d,o=r.targetContainers,p!==null&&o.indexOf(p)===-1&&o.push(p),r)}function pI(r,o,u,d,p){switch(o){case"focusin":return Yr=qu(Yr,r,o,u,d,p),!0;case"dragenter":return jr=qu(jr,r,o,u,d,p),!0;case"mouseover":return Qr=qu(Qr,r,o,u,d,p),!0;case"pointerover":var E=p.pointerId;return ju.set(E,qu(ju.get(E)||null,r,o,u,d,p)),!0;case"gotpointercapture":return E=p.pointerId,Qu.set(E,qu(Qu.get(E)||null,r,o,u,d,p)),!0}return!1}function Z1(r){var o=Ma(r.target);if(o!==null){var u=se(o);if(u!==null){if(o=u.tag,o===13){if(o=Z(u),o!==null){r.blockedOn=o,uL(r.priority,function(){if(u.tag===13){var d=Jn(),p=Cr(u,d);p!==null&&kn(p,u,d),hm(u,d)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function m0(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var u=dm(r.nativeEvent);if(u===null){u=r.nativeEvent;var d=new u.constructor(u.type,u);v2=d,u.target.dispatchEvent(d),v2=null}else return o=Xl(u),o!==null&&q1(o),r.blockedOn=u,!1;o.shift()}return!0}function J1(r,o,u){m0(r)&&u.delete(o)}function yI(){mm=!1,Yr!==null&&m0(Yr)&&(Yr=null),jr!==null&&m0(jr)&&(jr=null),Qr!==null&&m0(Qr)&&(Qr=null),ju.forEach(J1),Qu.forEach(J1)}function p0(r,o){r.blockedOn===o&&(r.blockedOn=null,mm||(mm=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,yI)))}var y0=null;function eE(r){y0!==r&&(y0=r,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){y0===r&&(y0=null);for(var o=0;o<r.length;o+=3){var u=r[o],d=r[o+1],p=r[o+2];if(typeof d!="function"){if(gm(d||u)===null)continue;break}var E=Xl(u);E!==null&&(r.splice(o,3),o-=3,ig(E,{pending:!0,data:p,method:u.method,action:d},d,p))}}))}function Xu(r){function o(N){return p0(N,r)}Yr!==null&&p0(Yr,r),jr!==null&&p0(jr,r),Qr!==null&&p0(Qr,r),ju.forEach(o),Qu.forEach(o);for(var u=0;u<qr.length;u++){var d=qr[u];d.blockedOn===r&&(d.blockedOn=null)}for(;0<qr.length&&(u=qr[0],u.blockedOn===null);)Z1(u),u.blockedOn===null&&qr.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(d=0;d<u.length;d+=3){var p=u[d],E=u[d+1],w=p[Bn]||null;if(typeof E=="function")w||eE(u);else if(w){var D=null;if(E&&E.hasAttribute("formAction")){if(p=E,w=E[Bn]||null)D=w.formAction;else if(gm(p)!==null)continue}else D=w.action;typeof D=="function"?u[d+1]=D:(u.splice(d,3),d-=3),eE(u)}}}function pm(r){this._internalRoot=r}v0.prototype.render=pm.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));var u=o.current,d=Jn();j1(u,d,r,o,null,null)},v0.prototype.unmount=pm.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;r.tag===0&&wo(),j1(r.current,2,null,r,null,null),e0(),o[ql]=null}};function v0(r){this._internalRoot=r}v0.prototype.unstable_scheduleHydration=function(r){if(r){var o=k3();r={blockedOn:null,target:r,priority:o};for(var u=0;u<qr.length&&o!==0&&o<qr[u].priority;u++);qr.splice(u,0,r),u===0&&Z1(r)}};var tE=e.version;if(tE!=="19.0.0")throw Error(n(527,tE,"19.0.0"));ue.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=V(o),r=r!==null?ie(r):null,r=r===null?null:r.stateNode,r};var vI={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:F,findFiberByHostInstance:Ma,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var x0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!x0.isDisabled&&x0.supportsFiber)try{at=x0.inject(vI),wt=x0}catch{}}return Ju.createRoot=function(r,o){if(!i(r))throw Error(n(299));var u=!1,d="",p=vx,E=xx,w=Ex,D=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(d=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(w=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(D=o.unstable_transitionCallbacks)),o=K1(r,1,!1,null,null,u,d,p,E,w,D,null),r[ql]=o.current,Jg(r.nodeType===8?r.parentNode:r),new pm(o)},Ju.hydrateRoot=function(r,o,u){if(!i(r))throw Error(n(299));var d=!1,p="",E=vx,w=xx,D=Ex,N=null,z=null;return u!=null&&(u.unstable_strictMode===!0&&(d=!0),u.identifierPrefix!==void 0&&(p=u.identifierPrefix),u.onUncaughtError!==void 0&&(E=u.onUncaughtError),u.onCaughtError!==void 0&&(w=u.onCaughtError),u.onRecoverableError!==void 0&&(D=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(N=u.unstable_transitionCallbacks),u.formState!==void 0&&(z=u.formState)),o=K1(r,1,!0,o,u??null,d,p,E,w,D,N,z),o.context=Y1(null),u=o.current,d=Jn(),p=Ur(d),p.callback=null,Fr(u,p,d),o.current.lanes=d,su(o,d),li(o),r[ql]=o.current,Jg(r),new v0(o)},Ju.version="19.0.0",Ju}var dE;function CI(){if(dE)return Em.exports;dE=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Em.exports=DI(),Em.exports}var _I=CI(),eh={},gE;function OI(){if(gE)return eh;gE=1,Object.defineProperty(eh,"__esModule",{value:!0}),eh.parse=l,eh.serialize=f;const s=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,i=Object.prototype.toString,a=(()=>{const y=function(){};return y.prototype=Object.create(null),y})();function l(y,v){const x=new a,b=y.length;if(b<2)return x;const A=(v==null?void 0:v.decode)||g;let S=0;do{const k=y.indexOf("=",S);if(k===-1)break;const R=y.indexOf(";",S),_=R===-1?b:R;if(k>_){S=y.lastIndexOf(";",k-1)+1;continue}const C=c(y,S,k),U=h(y,k,C),O=y.slice(C,U);if(x[O]===void 0){let B=c(y,k+1,_),F=h(y,_,B);const M=A(y.slice(B,F));x[O]=M}S=_+1}while(S<b);return x}function c(y,v,x){do{const b=y.charCodeAt(v);if(b!==32&&b!==9)return v}while(++v<x);return x}function h(y,v,x){for(;v>x;){const b=y.charCodeAt(--v);if(b!==32&&b!==9)return v+1}return x}function f(y,v,x){const b=(x==null?void 0:x.encode)||encodeURIComponent;if(!s.test(y))throw new TypeError(`argument name is invalid: ${y}`);const A=b(v);if(!e.test(A))throw new TypeError(`argument val is invalid: ${v}`);let S=y+"="+A;if(!x)return S;if(x.maxAge!==void 0){if(!Number.isInteger(x.maxAge))throw new TypeError(`option maxAge is invalid: ${x.maxAge}`);S+="; Max-Age="+x.maxAge}if(x.domain){if(!t.test(x.domain))throw new TypeError(`option domain is invalid: ${x.domain}`);S+="; Domain="+x.domain}if(x.path){if(!n.test(x.path))throw new TypeError(`option path is invalid: ${x.path}`);S+="; Path="+x.path}if(x.expires){if(!m(x.expires)||!Number.isFinite(x.expires.valueOf()))throw new TypeError(`option expires is invalid: ${x.expires}`);S+="; Expires="+x.expires.toUTCString()}if(x.httpOnly&&(S+="; HttpOnly"),x.secure&&(S+="; Secure"),x.partitioned&&(S+="; Partitioned"),x.priority)switch(typeof x.priority=="string"?x.priority.toLowerCase():void 0){case"low":S+="; Priority=Low";break;case"medium":S+="; Priority=Medium";break;case"high":S+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${x.priority}`)}if(x.sameSite)switch(typeof x.sameSite=="string"?x.sameSite.toLowerCase():x.sameSite){case!0:case"strict":S+="; SameSite=Strict";break;case"lax":S+="; SameSite=Lax";break;case"none":S+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${x.sameSite}`)}return S}function g(y){if(y.indexOf("%")===-1)return y;try{return decodeURIComponent(y)}catch{return y}}function m(y){return i.call(y)==="[object Date]"}return eh}OI();/**
 * react-router v7.4.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var mE="popstate";function MI(s={}){function e(i,a){let{pathname:l="/",search:c="",hash:h=""}=Kl(i.location.hash.substring(1));return!l.startsWith("/")&&!l.startsWith(".")&&(l="/"+l),yp("",{pathname:l,search:c,hash:h},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(i,a){let l=i.document.querySelector("base"),c="";if(l&&l.getAttribute("href")){let h=i.location.href,f=h.indexOf("#");c=f===-1?h:h.slice(0,f)}return c+"#"+(typeof a=="string"?a:Eh(a))}function n(i,a){qs(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return NI(e,t,n,s)}function Dt(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function qs(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function PI(){return Math.random().toString(36).substring(2,10)}function pE(s,e){return{usr:s.state,key:s.key,idx:e}}function yp(s,e,t=null,n){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?Kl(e):e,state:t,key:e&&e.key||n||PI()}}function Eh({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function Kl(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let n=s.indexOf("?");n>=0&&(e.search=s.substring(n),s=s.substring(0,n)),s&&(e.pathname=s)}return e}function NI(s,e,t,n={}){let{window:i=document.defaultView,v5Compat:a=!1}=n,l=i.history,c="POP",h=null,f=g();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function g(){return(l.state||{idx:null}).idx}function m(){c="POP";let A=g(),S=A==null?null:A-f;f=A,h&&h({action:c,location:b.location,delta:S})}function y(A,S){c="PUSH";let k=yp(b.location,A,S);t&&t(k,A),f=g()+1;let R=pE(k,f),_=b.createHref(k);try{l.pushState(R,"",_)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;i.location.assign(_)}a&&h&&h({action:c,location:b.location,delta:1})}function v(A,S){c="REPLACE";let k=yp(b.location,A,S);t&&t(k,A),f=g();let R=pE(k,f),_=b.createHref(k);l.replaceState(R,"",_),a&&h&&h({action:c,location:b.location,delta:0})}function x(A){let S=i.location.origin!=="null"?i.location.origin:i.location.href,k=typeof A=="string"?A:Eh(A);return k=k.replace(/ $/,"%20"),Dt(S,`No window.location.(origin|href) available to create URL for href: ${k}`),new URL(k,S)}let b={get action(){return c},get location(){return s(i,l)},listen(A){if(h)throw new Error("A history only accepts one active listener");return i.addEventListener(mE,m),h=A,()=>{i.removeEventListener(mE,m),h=null}},createHref(A){return e(i,A)},createURL:x,encodeLocation(A){let S=x(A);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:y,replace:v,go(A){return l.go(A)}};return b}function oS(s,e,t="/"){return BI(s,e,t,!1)}function BI(s,e,t,n){let i=typeof e=="string"?Kl(e):e,a=Tr(i.pathname||"/",t);if(a==null)return null;let l=cS(s);UI(l);let c=null;for(let h=0;c==null&&h<l.length;++h){let f=qI(a);c=jI(l[h],f,n)}return c}function cS(s,e=[],t=[],n=""){let i=(a,l,c)=>{let h={relativePath:c===void 0?a.path||"":c,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};h.relativePath.startsWith("/")&&(Dt(h.relativePath.startsWith(n),`Absolute route path "${h.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(n.length));let f=Er([n,h.relativePath]),g=t.concat(h);a.children&&a.children.length>0&&(Dt(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),cS(a.children,e,g,f)),!(a.path==null&&!a.index)&&e.push({path:f,score:KI(f,a.index),routesMeta:g})};return s.forEach((a,l)=>{var c;if(a.path===""||!((c=a.path)!=null&&c.includes("?")))i(a,l);else for(let h of uS(a.path))i(a,l,h)}),e}function uS(s){let e=s.split("/");if(e.length===0)return[];let[t,...n]=e,i=t.endsWith("?"),a=t.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let l=uS(n.join("/")),c=[];return c.push(...l.map(h=>h===""?a:[a,h].join("/"))),i&&c.push(...l),c.map(h=>s.startsWith("/")&&h===""?"/":h)}function UI(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:YI(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var FI=/^:[\w-]+$/,GI=3,$I=2,HI=1,zI=10,VI=-2,yE=s=>s==="*";function KI(s,e){let t=s.split("/"),n=t.length;return t.some(yE)&&(n+=VI),e&&(n+=$I),t.filter(i=>!yE(i)).reduce((i,a)=>i+(FI.test(a)?GI:a===""?HI:zI),n)}function YI(s,e){return s.length===e.length&&s.slice(0,-1).every((n,i)=>n===e[i])?s[s.length-1]-e[e.length-1]:0}function jI(s,e,t=!1){let{routesMeta:n}=s,i={},a="/",l=[];for(let c=0;c<n.length;++c){let h=n[c],f=c===n.length-1,g=a==="/"?e:e.slice(a.length)||"/",m=dd({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},g),y=h.route;if(!m&&f&&t&&!n[n.length-1].route.index&&(m=dd({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},g)),!m)return null;Object.assign(i,m.params),l.push({params:i,pathname:Er([a,m.pathname]),pathnameBase:JI(Er([a,m.pathnameBase])),route:y}),m.pathnameBase!=="/"&&(a=Er([a,m.pathnameBase]))}return l}function dd(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,n]=QI(s.path,s.caseSensitive,s.end),i=e.match(t);if(!i)return null;let a=i[0],l=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:n.reduce((f,{paramName:g,isOptional:m},y)=>{if(g==="*"){let x=c[y]||"";l=a.slice(0,a.length-x.length).replace(/(.)\/+$/,"$1")}const v=c[y];return m&&!v?f[g]=void 0:f[g]=(v||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:l,pattern:s}}function QI(s,e=!1,t=!0){qs(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let n=[],i="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,h)=>(n.push({paramName:c,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(n.push({paramName:"*"}),i+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":s!==""&&s!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function qI(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return qs(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function Tr(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=s.charAt(t);return n&&n!=="/"?null:s.slice(t)||"/"}function XI(s,e="/"){let{pathname:t,search:n="",hash:i=""}=typeof s=="string"?Kl(s):s;return{pathname:t?t.startsWith("/")?t:WI(t,e):e,search:eD(n),hash:tD(i)}}function WI(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function Tm(s,e,t,n){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ZI(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function hS(s){let e=ZI(s);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function fS(s,e,t,n=!1){let i;typeof s=="string"?i=Kl(s):(i={...s},Dt(!i.pathname||!i.pathname.includes("?"),Tm("?","pathname","search",i)),Dt(!i.pathname||!i.pathname.includes("#"),Tm("#","pathname","hash",i)),Dt(!i.search||!i.search.includes("#"),Tm("#","search","hash",i)));let a=s===""||i.pathname==="",l=a?"/":i.pathname,c;if(l==null)c=t;else{let m=e.length-1;if(!n&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),m-=1;i.pathname=y.join("/")}c=m>=0?e[m]:"/"}let h=XI(i,c),f=l&&l!=="/"&&l.endsWith("/"),g=(a||l===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(f||g)&&(h.pathname+="/"),h}var Er=s=>s.join("/").replace(/\/\/+/g,"/"),JI=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),eD=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,tD=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function nD(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}var dS=["POST","PUT","PATCH","DELETE"];new Set(dS);var sD=["GET",...dS];new Set(sD);var eu=J.createContext(null);eu.displayName="DataRouter";var Yd=J.createContext(null);Yd.displayName="DataRouterState";var gS=J.createContext({isTransitioning:!1});gS.displayName="ViewTransition";var iD=J.createContext(new Map);iD.displayName="Fetchers";var rD=J.createContext(null);rD.displayName="Await";var Di=J.createContext(null);Di.displayName="Navigation";var Wh=J.createContext(null);Wh.displayName="Location";var Rr=J.createContext({outlet:null,matches:[],isDataRoute:!1});Rr.displayName="Route";var Ay=J.createContext(null);Ay.displayName="RouteError";function aD(s,{relative:e}={}){Dt(Zh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=J.useContext(Di),{hash:i,pathname:a,search:l}=Jh(s,{relative:e}),c=a;return t!=="/"&&(c=a==="/"?t:Er([t,a])),n.createHref({pathname:c,search:l,hash:i})}function Zh(){return J.useContext(Wh)!=null}function Ca(){return Dt(Zh(),"useLocation() may be used only in the context of a <Router> component."),J.useContext(Wh).location}var mS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function pS(s){J.useContext(Di).static||J.useLayoutEffect(s)}function yS(){let{isDataRoute:s}=J.useContext(Rr);return s?xD():lD()}function lD(){Dt(Zh(),"useNavigate() may be used only in the context of a <Router> component.");let s=J.useContext(eu),{basename:e,navigator:t}=J.useContext(Di),{matches:n}=J.useContext(Rr),{pathname:i}=Ca(),a=JSON.stringify(hS(n)),l=J.useRef(!1);return pS(()=>{l.current=!0}),J.useCallback((h,f={})=>{if(qs(l.current,mS),!l.current)return;if(typeof h=="number"){t.go(h);return}let g=fS(h,JSON.parse(a),i,f.relative==="path");s==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:Er([e,g.pathname])),(f.replace?t.replace:t.push)(g,f.state,f)},[e,t,a,i,s])}J.createContext(null);function Jh(s,{relative:e}={}){let{matches:t}=J.useContext(Rr),{pathname:n}=Ca(),i=JSON.stringify(hS(t));return J.useMemo(()=>fS(s,JSON.parse(i),n,e==="path"),[s,i,n,e])}function oD(s,e){return vS(s,e)}function vS(s,e,t,n){var k;Dt(Zh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i,static:a}=J.useContext(Di),{matches:l}=J.useContext(Rr),c=l[l.length-1],h=c?c.params:{},f=c?c.pathname:"/",g=c?c.pathnameBase:"/",m=c&&c.route;{let R=m&&m.path||"";xS(f,!m||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let y=Ca(),v;if(e){let R=typeof e=="string"?Kl(e):e;Dt(g==="/"||((k=R.pathname)==null?void 0:k.startsWith(g)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${g}" but pathname "${R.pathname}" was given in the \`location\` prop.`),v=R}else v=y;let x=v.pathname||"/",b=x;if(g!=="/"){let R=g.replace(/^\//,"").split("/");b="/"+x.replace(/^\//,"").split("/").slice(R.length).join("/")}let A=!a&&t&&t.matches&&t.matches.length>0?t.matches:oS(s,{pathname:b});qs(m||A!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),qs(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let S=dD(A&&A.map(R=>Object.assign({},R,{params:Object.assign({},h,R.params),pathname:Er([g,i.encodeLocation?i.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?g:Er([g,i.encodeLocation?i.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),l,t,n);return e&&S?J.createElement(Wh.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},S):S}function cD(){let s=vD(),e=nD(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",s),l=J.createElement(J.Fragment,null,J.createElement("p",null,"💿 Hey developer 👋"),J.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",J.createElement("code",{style:a},"ErrorBoundary")," or"," ",J.createElement("code",{style:a},"errorElement")," prop on your route.")),J.createElement(J.Fragment,null,J.createElement("h2",null,"Unexpected Application Error!"),J.createElement("h3",{style:{fontStyle:"italic"}},e),t?J.createElement("pre",{style:i},t):null,l)}var uD=J.createElement(cD,null),hD=class extends J.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){console.error("React Router caught the following error during render",s,e)}render(){return this.state.error!==void 0?J.createElement(Rr.Provider,{value:this.props.routeContext},J.createElement(Ay.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function fD({routeContext:s,match:e,children:t}){let n=J.useContext(eu);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),J.createElement(Rr.Provider,{value:s},t)}function dD(s,e=[],t=null,n=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let i=s,a=t==null?void 0:t.errors;if(a!=null){let h=i.findIndex(f=>f.route.id&&(a==null?void 0:a[f.route.id])!==void 0);Dt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,h+1))}let l=!1,c=-1;if(t)for(let h=0;h<i.length;h++){let f=i[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=h),f.route.id){let{loaderData:g,errors:m}=t,y=f.route.loader&&!g.hasOwnProperty(f.route.id)&&(!m||m[f.route.id]===void 0);if(f.route.lazy||y){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((h,f,g)=>{let m,y=!1,v=null,x=null;t&&(m=a&&f.route.id?a[f.route.id]:void 0,v=f.route.errorElement||uD,l&&(c<0&&g===0?(xS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,x=null):c===g&&(y=!0,x=f.route.hydrateFallbackElement||null)));let b=e.concat(i.slice(0,g+1)),A=()=>{let S;return m?S=v:y?S=x:f.route.Component?S=J.createElement(f.route.Component,null):f.route.element?S=f.route.element:S=h,J.createElement(fD,{match:f,routeContext:{outlet:h,matches:b,isDataRoute:t!=null},children:S})};return t&&(f.route.ErrorBoundary||f.route.errorElement||g===0)?J.createElement(hD,{location:t.location,revalidation:t.revalidation,component:v,error:m,children:A(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):A()},null)}function Sy(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function gD(s){let e=J.useContext(eu);return Dt(e,Sy(s)),e}function mD(s){let e=J.useContext(Yd);return Dt(e,Sy(s)),e}function pD(s){let e=J.useContext(Rr);return Dt(e,Sy(s)),e}function Ty(s){let e=pD(s),t=e.matches[e.matches.length-1];return Dt(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function yD(){return Ty("useRouteId")}function vD(){var n;let s=J.useContext(Ay),e=mD("useRouteError"),t=Ty("useRouteError");return s!==void 0?s:(n=e.errors)==null?void 0:n[t]}function xD(){let{router:s}=gD("useNavigate"),e=Ty("useNavigate"),t=J.useRef(!1);return pS(()=>{t.current=!0}),J.useCallback(async(i,a={})=>{qs(t.current,mS),t.current&&(typeof i=="number"?s.navigate(i):await s.navigate(i,{fromRouteId:e,...a}))},[s,e])}var vE={};function xS(s,e,t){!e&&!vE[s]&&(vE[s]=!0,qs(!1,t))}J.memo(ED);function ED({routes:s,future:e,state:t}){return vS(s,void 0,t,e)}function j0(s){Dt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function bD({basename:s="/",children:e=null,location:t,navigationType:n="POP",navigator:i,static:a=!1}){Dt(!Zh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=s.replace(/^\/*/,"/"),c=J.useMemo(()=>({basename:l,navigator:i,static:a,future:{}}),[l,i,a]);typeof t=="string"&&(t=Kl(t));let{pathname:h="/",search:f="",hash:g="",state:m=null,key:y="default"}=t,v=J.useMemo(()=>{let x=Tr(h,l);return x==null?null:{location:{pathname:x,search:f,hash:g,state:m,key:y},navigationType:n}},[l,h,f,g,m,y,n]);return qs(v!=null,`<Router basename="${l}"> is not able to match the URL "${h}${f}${g}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:J.createElement(Di.Provider,{value:c},J.createElement(Wh.Provider,{children:e,value:v}))}function AD({children:s,location:e}){return oD(vp(s),e)}function vp(s,e=[]){let t=[];return J.Children.forEach(s,(n,i)=>{if(!J.isValidElement(n))return;let a=[...e,i];if(n.type===J.Fragment){t.push.apply(t,vp(n.props.children,a));return}Dt(n.type===j0,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Dt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=vp(n.props.children,a)),t.push(l)}),t}var Q0="get",q0="application/x-www-form-urlencoded";function jd(s){return s!=null&&typeof s.tagName=="string"}function SD(s){return jd(s)&&s.tagName.toLowerCase()==="button"}function TD(s){return jd(s)&&s.tagName.toLowerCase()==="form"}function wD(s){return jd(s)&&s.tagName.toLowerCase()==="input"}function RD(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function LD(s,e){return s.button===0&&(!e||e==="_self")&&!RD(s)}var E0=null;function kD(){if(E0===null)try{new FormData(document.createElement("form"),0),E0=!1}catch{E0=!0}return E0}var ID=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function wm(s){return s!=null&&!ID.has(s)?(qs(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${q0}"`),null):s}function DD(s,e){let t,n,i,a,l;if(TD(s)){let c=s.getAttribute("action");n=c?Tr(c,e):null,t=s.getAttribute("method")||Q0,i=wm(s.getAttribute("enctype"))||q0,a=new FormData(s)}else if(SD(s)||wD(s)&&(s.type==="submit"||s.type==="image")){let c=s.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=s.getAttribute("formaction")||c.getAttribute("action");if(n=h?Tr(h,e):null,t=s.getAttribute("formmethod")||c.getAttribute("method")||Q0,i=wm(s.getAttribute("formenctype"))||wm(c.getAttribute("enctype"))||q0,a=new FormData(c,s),!kD()){let{name:f,type:g,value:m}=s;if(g==="image"){let y=f?`${f}.`:"";a.append(`${y}x`,"0"),a.append(`${y}y`,"0")}else f&&a.append(f,m)}}else{if(jd(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Q0,n=null,i=q0,l=s}return a&&i==="text/plain"&&(l=a,a=void 0),{action:n,method:t.toLowerCase(),encType:i,formData:a,body:l}}function wy(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}async function CD(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function _D(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function OD(s,e,t){let n=await Promise.all(s.map(async i=>{let a=e.routes[i.route.id];if(a){let l=await CD(a,t);return l.links?l.links():[]}return[]}));return BD(n.flat(1).filter(_D).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function xE(s,e,t,n,i,a){let l=(h,f)=>t[f]?h.route.id!==t[f].route.id:!0,c=(h,f)=>{var g;return t[f].pathname!==h.pathname||((g=t[f].route.path)==null?void 0:g.endsWith("*"))&&t[f].params["*"]!==h.params["*"]};return a==="assets"?e.filter((h,f)=>l(h,f)||c(h,f)):a==="data"?e.filter((h,f)=>{var m;let g=n.routes[h.route.id];if(!g||!g.hasLoader)return!1;if(l(h,f)||c(h,f))return!0;if(h.route.shouldRevalidate){let y=h.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((m=t[0])==null?void 0:m.params)||{},nextUrl:new URL(s,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function MD(s,e,{includeHydrateFallback:t}={}){return PD(s.map(n=>{let i=e.routes[n.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function PD(s){return[...new Set(s)]}function ND(s){let e={},t=Object.keys(s).sort();for(let n of t)e[n]=s[n];return e}function BD(s,e){let t=new Set;return new Set(e),s.reduce((n,i)=>{let a=JSON.stringify(ND(i));return t.has(a)||(t.add(a),n.push({key:a,link:i})),n},[])}function UD(s,e){let t=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t.pathname==="/"?t.pathname="_root.data":e&&Tr(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function ES(){let s=J.useContext(eu);return wy(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function FD(){let s=J.useContext(Yd);return wy(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var Ry=J.createContext(void 0);Ry.displayName="FrameworkContext";function bS(){let s=J.useContext(Ry);return wy(s,"You must render this element inside a <HydratedRouter> element"),s}function GD(s,e){let t=J.useContext(Ry),[n,i]=J.useState(!1),[a,l]=J.useState(!1),{onFocus:c,onBlur:h,onMouseEnter:f,onMouseLeave:g,onTouchStart:m}=e,y=J.useRef(null);J.useEffect(()=>{if(s==="render"&&l(!0),s==="viewport"){let b=S=>{S.forEach(k=>{l(k.isIntersecting)})},A=new IntersectionObserver(b,{threshold:.5});return y.current&&A.observe(y.current),()=>{A.disconnect()}}},[s]),J.useEffect(()=>{if(n){let b=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(b)}}},[n]);let v=()=>{i(!0)},x=()=>{i(!1),l(!1)};return t?s!=="intent"?[a,y,{}]:[a,y,{onFocus:th(c,v),onBlur:th(h,x),onMouseEnter:th(f,v),onMouseLeave:th(g,x),onTouchStart:th(m,v)}]:[!1,y,{}]}function th(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function $D({page:s,...e}){let{router:t}=ES(),n=J.useMemo(()=>oS(t.routes,s,t.basename),[t.routes,s,t.basename]);return n?J.createElement(zD,{page:s,matches:n,...e}):null}function HD(s){let{manifest:e,routeModules:t}=bS(),[n,i]=J.useState([]);return J.useEffect(()=>{let a=!1;return OD(s,e,t).then(l=>{a||i(l)}),()=>{a=!0}},[s,e,t]),n}function zD({page:s,matches:e,...t}){let n=Ca(),{manifest:i,routeModules:a}=bS(),{basename:l}=ES(),{loaderData:c,matches:h}=FD(),f=J.useMemo(()=>xE(s,e,h,i,n,"data"),[s,e,h,i,n]),g=J.useMemo(()=>xE(s,e,h,i,n,"assets"),[s,e,h,i,n]),m=J.useMemo(()=>{if(s===n.pathname+n.search+n.hash)return[];let x=new Set,b=!1;if(e.forEach(S=>{var R;let k=i.routes[S.route.id];!k||!k.hasLoader||(!f.some(_=>_.route.id===S.route.id)&&S.route.id in c&&((R=a[S.route.id])!=null&&R.shouldRevalidate)||k.hasClientLoader?b=!0:x.add(S.route.id))}),x.size===0)return[];let A=UD(s,l);return b&&x.size>0&&A.searchParams.set("_routes",e.filter(S=>x.has(S.route.id)).map(S=>S.route.id).join(",")),[A.pathname+A.search]},[l,c,n,i,f,e,s,a]),y=J.useMemo(()=>MD(g,i),[g,i]),v=HD(g);return J.createElement(J.Fragment,null,m.map(x=>J.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...t})),y.map(x=>J.createElement("link",{key:x,rel:"modulepreload",href:x,...t})),v.map(({key:x,link:b})=>J.createElement("link",{key:x,...b})))}function VD(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var AS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{AS&&(window.__reactRouterVersion="7.4.0")}catch{}function KD({basename:s,children:e,window:t}){let n=J.useRef();n.current==null&&(n.current=MI({window:t,v5Compat:!0}));let i=n.current,[a,l]=J.useState({action:i.action,location:i.location}),c=J.useCallback(h=>{J.startTransition(()=>l(h))},[l]);return J.useLayoutEffect(()=>i.listen(c),[i,c]),J.createElement(bD,{basename:s,children:e,location:a.location,navigationType:a.action,navigator:i})}var SS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ho=J.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:i,reloadDocument:a,replace:l,state:c,target:h,to:f,preventScrollReset:g,viewTransition:m,...y},v){let{basename:x}=J.useContext(Di),b=typeof f=="string"&&SS.test(f),A,S=!1;if(typeof f=="string"&&b&&(A=f,AS))try{let F=new URL(window.location.href),M=f.startsWith("//")?new URL(F.protocol+f):new URL(f),j=Tr(M.pathname,x);M.origin===F.origin&&j!=null?f=j+M.search+M.hash:S=!0}catch{qs(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let k=aD(f,{relative:i}),[R,_,C]=GD(n,y),U=qD(f,{replace:l,state:c,target:h,preventScrollReset:g,relative:i,viewTransition:m});function O(F){e&&e(F),F.defaultPrevented||U(F)}let B=J.createElement("a",{...y,...C,href:A||k,onClick:S||a?e:O,ref:VD(v,_),target:h,"data-discover":!b&&t==="render"?"true":void 0});return R&&!b?J.createElement(J.Fragment,null,B,J.createElement($D,{page:k})):B});Ho.displayName="Link";var YD=J.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:i=!1,style:a,to:l,viewTransition:c,children:h,...f},g){let m=Jh(l,{relative:f.relative}),y=Ca(),v=J.useContext(Yd),{navigator:x,basename:b}=J.useContext(Di),A=v!=null&&eC(m)&&c===!0,S=x.encodeLocation?x.encodeLocation(m).pathname:m.pathname,k=y.pathname,R=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(k=k.toLowerCase(),R=R?R.toLowerCase():null,S=S.toLowerCase()),R&&b&&(R=Tr(R,b)||R);const _=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let C=k===S||!i&&k.startsWith(S)&&k.charAt(_)==="/",U=R!=null&&(R===S||!i&&R.startsWith(S)&&R.charAt(S.length)==="/"),O={isActive:C,isPending:U,isTransitioning:A},B=C?e:void 0,F;typeof n=="function"?F=n(O):F=[n,C?"active":null,U?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let M=typeof a=="function"?a(O):a;return J.createElement(Ho,{...f,"aria-current":B,className:F,ref:g,style:M,to:l,viewTransition:c},typeof h=="function"?h(O):h)});YD.displayName="NavLink";var jD=J.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:i,state:a,method:l=Q0,action:c,onSubmit:h,relative:f,preventScrollReset:g,viewTransition:m,...y},v)=>{let x=ZD(),b=JD(c,{relative:f}),A=l.toLowerCase()==="get"?"get":"post",S=typeof c=="string"&&SS.test(c),k=R=>{if(h&&h(R),R.defaultPrevented)return;R.preventDefault();let _=R.nativeEvent.submitter,C=(_==null?void 0:_.getAttribute("formmethod"))||l;x(_||R.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:i,state:a,relative:f,preventScrollReset:g,viewTransition:m})};return J.createElement("form",{ref:v,method:A,action:b,onSubmit:n?h:k,...y,"data-discover":!S&&s==="render"?"true":void 0})});jD.displayName="Form";function QD(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function TS(s){let e=J.useContext(eu);return Dt(e,QD(s)),e}function qD(s,{target:e,replace:t,state:n,preventScrollReset:i,relative:a,viewTransition:l}={}){let c=yS(),h=Ca(),f=Jh(s,{relative:a});return J.useCallback(g=>{if(LD(g,e)){g.preventDefault();let m=t!==void 0?t:Eh(h)===Eh(f);c(s,{replace:m,state:n,preventScrollReset:i,relative:a,viewTransition:l})}},[h,c,f,t,n,e,s,i,a,l])}var XD=0,WD=()=>`__${String(++XD)}__`;function ZD(){let{router:s}=TS("useSubmit"),{basename:e}=J.useContext(Di),t=yD();return J.useCallback(async(n,i={})=>{let{action:a,method:l,encType:c,formData:h,body:f}=DD(n,e);if(i.navigate===!1){let g=i.fetcherKey||WD();await s.fetch(g,t,i.action||a,{preventScrollReset:i.preventScrollReset,formData:h,body:f,formMethod:i.method||l,formEncType:i.encType||c,flushSync:i.flushSync})}else await s.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:h,body:f,formMethod:i.method||l,formEncType:i.encType||c,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[s,e,t])}function JD(s,{relative:e}={}){let{basename:t}=J.useContext(Di),n=J.useContext(Rr);Dt(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),a={...Jh(s||".",{relative:e})},l=Ca();if(s==null){a.search=l.search;let c=new URLSearchParams(a.search),h=c.getAll("index");if(h.some(g=>g==="")){c.delete("index"),h.filter(m=>m).forEach(m=>c.append("index",m));let g=c.toString();a.search=g?`?${g}`:""}}return(!s||s===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:Er([t,a.pathname])),Eh(a)}function eC(s,e={}){let t=J.useContext(gS);Dt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=TS("useViewTransitionState"),i=Jh(s,{relative:e.relative});if(!t.isTransitioning)return!1;let a=Tr(t.currentLocation.pathname,n)||t.currentLocation.pathname,l=Tr(t.nextLocation.pathname,n)||t.nextLocation.pathname;return dd(i.pathname,l)!=null||dd(i.pathname,a)!=null}new TextEncoder;function tC(){const e=Ca().pathname==="/";return me.jsxs("nav",{className:`bg-black p-4 flex justify-between items-center fixed h-[90px] top-0 left-0 w-full text-white z-40 ${e?"shadow-lg shadow-cyan-500/30":""}`,children:[me.jsx(Ho,{to:"/",className:`text-4xl font-bold text-neon\r
      `,children:"Cyber Park"}),me.jsxs("div",{className:"flex items-center space-x-6",children:[me.jsx(Ho,{to:"/",className:"px-4 py-2 text-cyan-300 text-neon-soft hover:text-white hover:underline transition",children:"Home"}),me.jsx(Ho,{to:"/liveStream",className:"px-4 py-2 text-cyan-300 text-neon-soft hover:text-white hover:underline transition",children:"LiveStream"}),me.jsx(Ho,{to:"/blackjackTable",className:"px-4 py-2 text-cyan-300 text-neon-soft hover:text-white hover:underline transition",children:"BlackjackTable"})]})]})}const Ee=Number.isFinite||function(s){return typeof s=="number"&&isFinite(s)},nC=Number.isSafeInteger||function(s){return typeof s=="number"&&Math.abs(s)<=sC},sC=Number.MAX_SAFE_INTEGER||9007199254740991;let Re=function(s){return s.NETWORK_ERROR="networkError",s.MEDIA_ERROR="mediaError",s.KEY_SYSTEM_ERROR="keySystemError",s.MUX_ERROR="muxError",s.OTHER_ERROR="otherError",s}({}),Q=function(s){return s.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",s.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",s.KEY_SYSTEM_NO_SESSION="keySystemNoSession",s.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",s.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",s.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",s.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",s.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",s.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",s.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",s.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",s.MANIFEST_LOAD_ERROR="manifestLoadError",s.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",s.MANIFEST_PARSING_ERROR="manifestParsingError",s.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",s.LEVEL_EMPTY_ERROR="levelEmptyError",s.LEVEL_LOAD_ERROR="levelLoadError",s.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",s.LEVEL_PARSING_ERROR="levelParsingError",s.LEVEL_SWITCH_ERROR="levelSwitchError",s.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",s.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",s.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",s.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",s.FRAG_LOAD_ERROR="fragLoadError",s.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",s.FRAG_DECRYPT_ERROR="fragDecryptError",s.FRAG_PARSING_ERROR="fragParsingError",s.FRAG_GAP="fragGap",s.REMUX_ALLOC_ERROR="remuxAllocError",s.KEY_LOAD_ERROR="keyLoadError",s.KEY_LOAD_TIMEOUT="keyLoadTimeOut",s.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",s.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",s.BUFFER_APPEND_ERROR="bufferAppendError",s.BUFFER_APPENDING_ERROR="bufferAppendingError",s.BUFFER_STALLED_ERROR="bufferStalledError",s.BUFFER_FULL_ERROR="bufferFullError",s.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",s.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",s.ASSET_LIST_LOAD_ERROR="assetListLoadError",s.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",s.ASSET_LIST_PARSING_ERROR="assetListParsingError",s.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",s.INTERNAL_EXCEPTION="internalException",s.INTERNAL_ABORTED="aborted",s.ATTACH_MEDIA_ERROR="attachMediaError",s.UNKNOWN="unknown",s}({}),T=function(s){return s.MEDIA_ATTACHING="hlsMediaAttaching",s.MEDIA_ATTACHED="hlsMediaAttached",s.MEDIA_DETACHING="hlsMediaDetaching",s.MEDIA_DETACHED="hlsMediaDetached",s.MEDIA_ENDED="hlsMediaEnded",s.STALL_RESOLVED="hlsStallResolved",s.BUFFER_RESET="hlsBufferReset",s.BUFFER_CODECS="hlsBufferCodecs",s.BUFFER_CREATED="hlsBufferCreated",s.BUFFER_APPENDING="hlsBufferAppending",s.BUFFER_APPENDED="hlsBufferAppended",s.BUFFER_EOS="hlsBufferEos",s.BUFFERED_TO_END="hlsBufferedToEnd",s.BUFFER_FLUSHING="hlsBufferFlushing",s.BUFFER_FLUSHED="hlsBufferFlushed",s.MANIFEST_LOADING="hlsManifestLoading",s.MANIFEST_LOADED="hlsManifestLoaded",s.MANIFEST_PARSED="hlsManifestParsed",s.LEVEL_SWITCHING="hlsLevelSwitching",s.LEVEL_SWITCHED="hlsLevelSwitched",s.LEVEL_LOADING="hlsLevelLoading",s.LEVEL_LOADED="hlsLevelLoaded",s.LEVEL_UPDATED="hlsLevelUpdated",s.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",s.LEVELS_UPDATED="hlsLevelsUpdated",s.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",s.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",s.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",s.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",s.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",s.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",s.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",s.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",s.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",s.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",s.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",s.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",s.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",s.CUES_PARSED="hlsCuesParsed",s.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",s.INIT_PTS_FOUND="hlsInitPtsFound",s.FRAG_LOADING="hlsFragLoading",s.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",s.FRAG_LOADED="hlsFragLoaded",s.FRAG_DECRYPTED="hlsFragDecrypted",s.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",s.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",s.FRAG_PARSING_METADATA="hlsFragParsingMetadata",s.FRAG_PARSED="hlsFragParsed",s.FRAG_BUFFERED="hlsFragBuffered",s.FRAG_CHANGED="hlsFragChanged",s.FPS_DROP="hlsFpsDrop",s.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",s.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",s.ERROR="hlsError",s.DESTROYING="hlsDestroying",s.KEY_LOADING="hlsKeyLoading",s.KEY_LOADED="hlsKeyLoaded",s.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",s.BACK_BUFFER_REACHED="hlsBackBufferReached",s.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",s.ASSET_LIST_LOADING="hlsAssetListLoading",s.ASSET_LIST_LOADED="hlsAssetListLoaded",s.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",s.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",s.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",s.INTERSTITIAL_STARTED="hlsInterstitialStarted",s.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",s.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",s.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",s.INTERSTITIAL_ENDED="hlsInterstitialEnded",s.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",s.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",s.EVENT_CUE_ENTER="hlsEventCueEnter",s}({});var qe={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Te={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Co{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class iC{constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Co(e),this.fast_=new Co(t),this.defaultTTFB_=i,this.ttfb_=new Co(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:a}=this;n.halfLife!==e&&(this.slow_=new Co(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new Co(t,i.getEstimate(),i.getTotalWeight())),a.halfLife!==e&&(this.ttfb_=new Co(e,a.getEstimate(),a.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,i=e/1e3,a=n/i;this.fast_.sample(i,a),this.slow_.sample(i,a)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function rC(s,e,t){return(e=lC(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function ht(){return ht=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},ht.apply(null,arguments)}function EE(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),t.push.apply(t,n)}return t}function lt(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?EE(Object(t),!0).forEach(function(n){rC(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):EE(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function aC(s,e){if(typeof s!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function lC(s){var e=aC(s,"string");return typeof e=="symbol"?e:e+""}class Lr{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const n=`[${e}]:`;this.trace=ia,this.debug=t.debug.bind(null,n),this.log=t.log.bind(null,n),this.warn=t.warn.bind(null,n),this.info=t.info.bind(null,n),this.error=t.error.bind(null,n)}}const ia=function(){},oC={trace:ia,debug:ia,log:ia,warn:ia,info:ia,error:ia};function xp(){return ht({},oC)}function cC(s,e){const t=self.console[s];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${s}] >`):ia}function bE(s,e,t){return e[s]?e[s].bind(e):cC(s,t)}const Ep=xp();function uC(s,e,t){const n=xp();if(typeof console=="object"&&s===!0||typeof s=="object"){const i=["debug","log","info","warn","error"];i.forEach(a=>{n[a]=bE(a,s,t)});try{n.log(`Debug logs enabled for "${e}" in hls.js version 1.6.2`)}catch{return xp()}i.forEach(a=>{Ep[a]=bE(a,s)})}else ht(Ep,n);return n}const Je=Ep;function Ra(s=!0){return typeof self>"u"?void 0:(s||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function hC(s){return typeof self<"u"&&s===self.ManagedMediaSource}function wS(s,e){const t=Object.keys(s),n=Object.keys(e),i=t.length,a=n.length;return!i||!a||i===a&&!t.some(l=>n.indexOf(l)===-1)}function ls(s,e=!1){if(typeof TextDecoder<"u"){const f=new TextDecoder("utf-8").decode(s);if(e){const g=f.indexOf("\0");return g!==-1?f.substring(0,g):f}return f.replace(/\0/g,"")}const t=s.length;let n,i,a,l="",c=0;for(;c<t;){if(n=s[c++],n===0&&e)return l;if(n===0||n===3)continue;switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(n);break;case 12:case 13:i=s[c++],l+=String.fromCharCode((n&31)<<6|i&63);break;case 14:i=s[c++],a=s[c++],l+=String.fromCharCode((n&15)<<12|(i&63)<<6|(a&63)<<0);break}}return l}const hi={hexDump:function(s){let e="";for(let t=0;t<s.length;t++){let n=s[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}};function fC(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Rm={exports:{}},AE;function dC(){return AE||(AE=1,function(s,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,l=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,c={buildAbsoluteURL:function(h,f,g){if(g=g||{},h=h.trim(),f=f.trim(),!f){if(!g.alwaysNormalize)return h;var m=c.parseURL(h);if(!m)throw new Error("Error trying to parse base URL.");return m.path=c.normalizePath(m.path),c.buildURLFromParts(m)}var y=c.parseURL(f);if(!y)throw new Error("Error trying to parse relative URL.");if(y.scheme)return g.alwaysNormalize?(y.path=c.normalizePath(y.path),c.buildURLFromParts(y)):f;var v=c.parseURL(h);if(!v)throw new Error("Error trying to parse base URL.");if(!v.netLoc&&v.path&&v.path[0]!=="/"){var x=i.exec(v.path);v.netLoc=x[1],v.path=x[2]}v.netLoc&&!v.path&&(v.path="/");var b={scheme:v.scheme,netLoc:y.netLoc,path:null,params:y.params,query:y.query,fragment:y.fragment};if(!y.netLoc&&(b.netLoc=v.netLoc,y.path[0]!=="/"))if(!y.path)b.path=v.path,y.params||(b.params=v.params,y.query||(b.query=v.query));else{var A=v.path,S=A.substring(0,A.lastIndexOf("/")+1)+y.path;b.path=c.normalizePath(S)}return b.path===null&&(b.path=g.alwaysNormalize?c.normalizePath(y.path):y.path),c.buildURLFromParts(b)},parseURL:function(h){var f=n.exec(h);return f?{scheme:f[1]||"",netLoc:f[2]||"",path:f[3]||"",params:f[4]||"",query:f[5]||"",fragment:f[6]||""}:null},normalizePath:function(h){for(h=h.split("").reverse().join("").replace(a,"");h.length!==(h=h.replace(l,"")).length;);return h.split("").reverse().join("")},buildURLFromParts:function(h){return h.scheme+h.netLoc+h.path+h.params+h.query+h.fragment}};s.exports=c})()}(Rm)),Rm.exports}var Ly=dC();class ky{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ut={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class RS{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,mC(this,"stats")}setByteRange(e,t){const n=e.split("@",2);let i;n.length===1?i=(t==null?void 0:t.byteRangeEndOffset)||0:i=parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[ut.AUDIO]:null,[ut.VIDEO]:null,[ut.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new ky),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Ly.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[ut.AUDIO]=null,e[ut.VIDEO]=null,e[ut.AUDIOVIDEO]=null}}function ln(s){return s.sn!=="initSegment"}let Lm=class extends RS{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange){const e=this.byteRange[0],t=this.byteRange[1];if(Ee(e)&&Ee(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(n.length===1)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=Ee(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),n=t.length;if(n>1||n===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!Ee(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return ln(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,i,a,l=!1){const{elementaryStreams:c}=this,h=c[e];if(!h){c[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:a,partial:l};return}h.startPTS=Math.min(h.startPTS,t),h.endPTS=Math.max(h.endPTS,n),h.startDTS=Math.min(h.startDTS,i),h.endDTS=Math.max(h.endDTS,a)}};class gC extends RS{constructor(e,t,n,i,a){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const l=e.enumeratedString("BYTERANGE");l&&this.setByteRange(l,a),a&&(this.fragOffset=a.fragOffset+a.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function LS(s,e){const t=Object.getPrototypeOf(s);if(t){const n=Object.getOwnPropertyDescriptor(t,e);return n||LS(t,e)}}function mC(s,e){const t=LS(s,e);t&&(t.enumerable=!0,Object.defineProperty(s,e,t))}const gd=Math.pow(2,32)-1,pC=[].push,kS={video:1,audio:2,id3:3,text:4};function qt(s){return String.fromCharCode.apply(null,s)}function IS(s,e){const t=s[e]<<8|s[e+1];return t<0?65536+t:t}function Ce(s,e){const t=DS(s,e);return t<0?4294967296+t:t}function SE(s,e){let t=Ce(s,e);return t*=Math.pow(2,32),t+=Ce(s,e+4),t}function DS(s,e){return s[e]<<24|s[e+1]<<16|s[e+2]<<8|s[e+3]}function km(s,e,t){s[e]=t>>24,s[e+1]=t>>16&255,s[e+2]=t>>8&255,s[e+3]=t&255}function yC(s){const e=s.byteLength;for(let t=0;t<e;){const n=Ce(s,t);if(n>8&&s[t+4]===109&&s[t+5]===111&&s[t+6]===111&&s[t+7]===102)return!0;t=n>1?t+n:e}return!1}function Ge(s,e){const t=[];if(!e.length)return t;const n=s.byteLength;for(let i=0;i<n;){const a=Ce(s,i),l=qt(s.subarray(i+4,i+8)),c=a>1?i+a:n;if(l===e[0])if(e.length===1)t.push(s.subarray(i+8,c));else{const h=Ge(s.subarray(i+8,c),e.slice(1));h.length&&pC.apply(t,h)}i=c}return t}function vC(s){const e=[],t=s[0];let n=8;const i=Ce(s,n);n+=4;let a=0,l=0;t===0?(a=Ce(s,n),l=Ce(s,n+4),n+=8):(a=SE(s,n),l=SE(s,n+8),n+=16),n+=2;let c=s.length+l;const h=IS(s,n);n+=2;for(let f=0;f<h;f++){let g=n;const m=Ce(s,g);g+=4;const y=m&2147483647;if((m&2147483648)>>>31===1)return Je.warn("SIDX has hierarchical references (not supported)"),null;const x=Ce(s,g);g+=4,e.push({referenceSize:y,subsegmentDuration:x,info:{duration:x/i,start:c,end:c+y-1}}),c+=y,g+=4,n=g}return{earliestPresentationTime:a,timescale:i,version:t,referencesCount:h,references:e}}function CS(s){const e=[],t=Ge(s,["moov","trak"]);for(let i=0;i<t.length;i++){const a=t[i],l=Ge(a,["tkhd"])[0];if(l){let c=l[0];const h=Ce(l,c===0?12:20),f=Ge(a,["mdia","mdhd"])[0];if(f){c=f[0];const g=Ce(f,c===0?12:20),m=Ge(a,["mdia","hdlr"])[0];if(m){const y=qt(m.subarray(8,12)),v={soun:ut.AUDIO,vide:ut.VIDEO}[y],x=Ge(a,["mdia","minf","stbl","stsd"])[0],b=xC(x);v?(e[h]={timescale:g,type:v,stsd:b},e[v]=lt({timescale:g,id:h},b)):e[h]={timescale:g,type:y,stsd:b}}}}}return Ge(s,["moov","mvex","trex"]).forEach(i=>{const a=Ce(i,4),l=e[a];l&&(l.default={duration:Ce(i,12),flags:Ce(i,20)})}),e}function xC(s){const e=s.subarray(8),t=e.subarray(86),n=qt(e.subarray(4,8));let i=n,a;const l=n==="enca"||n==="encv";if(l){const f=Ge(e,[n])[0].subarray(n==="enca"?28:78);Ge(f,["sinf"]).forEach(m=>{const y=Ge(m,["schm"])[0];if(y){const v=qt(y.subarray(4,8));if(v==="cbcs"||v==="cenc"){const x=Ge(m,["frma"])[0];x&&(i=qt(x))}}})}const c=i;switch(i){case"avc1":case"avc2":case"avc3":case"avc4":{const h=Ge(t,["avcC"])[0];h&&h.length>3&&(i+="."+A0(h[1])+A0(h[2])+A0(h[3]),a=b0(c==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const h=Ge(e,[n])[0],f=Ge(h.subarray(28),["esds"])[0];if(f&&f.length>7){let g=4;if(f[g++]!==3)break;g=Im(f,g),g+=2;const m=f[g++];if(m&128&&(g+=2),m&64&&(g+=f[g++]),f[g++]!==4)break;g=Im(f,g);const y=f[g++];if(y===64)i+="."+A0(y);else break;if(g+=12,f[g++]!==5)break;g=Im(f,g);const v=f[g++];let x=(v&248)>>3;x===31&&(x+=1+((v&7)<<3)+((f[g]&224)>>5)),i+="."+x}break}case"hvc1":case"hev1":{const h=Ge(t,["hvcC"])[0];if(h&&h.length>12){const f=h[1],g=["","A","B","C"][f>>6],m=f&31,y=Ce(h,2),v=(f&32)>>5?"H":"L",x=h[12],b=h.subarray(6,12);i+="."+g+m,i+="."+y.toString(16).toUpperCase(),i+="."+v+x;let A="";for(let S=b.length;S--;){const k=b[S];(k||A)&&(A="."+k.toString(16).toUpperCase()+A)}i+=A}a=b0(c=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{i=b0(i,t)||i;break}case"vp09":{const h=Ge(t,["vpcC"])[0];if(h&&h.length>6){const f=h[4],g=h[5],m=h[6]>>4&15;i+="."+ui(f)+"."+ui(g)+"."+ui(m)}break}case"av01":{const h=Ge(t,["av1C"])[0];if(h&&h.length>2){const f=h[1]>>>5,g=h[1]&31,m=h[2]>>>7?"H":"M",y=(h[2]&64)>>6,v=(h[2]&32)>>5,x=f===2&&y?v?12:10:y?10:8,b=(h[2]&16)>>4,A=(h[2]&8)>>3,S=(h[2]&4)>>2,k=h[2]&3;i+="."+f+"."+ui(g)+m+"."+ui(x)+"."+b+"."+A+S+k+"."+ui(1)+"."+ui(1)+"."+ui(1)+"."+0,a=b0("dav1",t)}break}}return{codec:i,encrypted:l,supplemental:a}}function b0(s,e){const t=Ge(e,["dvvC"]),n=t.length?t[0]:Ge(e,["dvcC"])[0];if(n){const i=n[2]>>1&127,a=n[2]<<5&32|n[3]>>3&31;return s+"."+ui(i)+"."+ui(a)}}function Im(s,e){const t=e+5;for(;s[e++]&128&&e<t;);return e}function A0(s){return("0"+s.toString(16).toUpperCase()).slice(-2)}function ui(s){return(s<10?"0":"")+s}function EC(s,e){if(!s||!e)return s;const t=e.keyId;return t&&e.isCommonEncryption&&Ge(s,["moov","trak"]).forEach(i=>{const l=Ge(i,["mdia","minf","stbl","stsd"])[0].subarray(8);let c=Ge(l,["enca"]);const h=c.length>0;h||(c=Ge(l,["encv"])),c.forEach(f=>{const g=h?f.subarray(28):f.subarray(78);Ge(g,["sinf"]).forEach(y=>{const v=_S(y);if(v){const x=v.subarray(8,24);x.some(b=>b!==0)||(Je.log(`[eme] Patching keyId in 'enc${h?"a":"v"}>sinf>>tenc' box: ${hi.hexDump(x)} -> ${hi.hexDump(t)}`),v.set(t,8))}})})}),s}function _S(s){const e=Ge(s,["schm"])[0];if(e){const t=qt(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return Ge(s,["schi","tenc"])[0]}return null}function bC(s,e){return Ge(e,["moof","traf"]).reduce((t,n)=>{const i=Ge(n,["tfdt"])[0],a=i[0],l=Ge(n,["tfhd"]).reduce((c,h)=>{const f=Ce(h,4),g=s[f];if(g){let m=Ce(i,4);if(a===1){if(m===gd)return Je.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),c;m*=gd+1,m+=Ce(i,8)}const y=g.timescale||9e4,v=m/y;if(Ee(v)&&(c===null||v<c))return v}return c},null);return l!==null&&Ee(l)&&(t===null||l<t)?l:t},null)}function AC(s,e){let t=0,n=0,i=0;const a=Ge(s,["moof","traf"]);for(let l=0;l<a.length;l++){const c=a[l],h=Ge(c,["tfhd"])[0],f=Ce(h,4),g=e[f];if(!g)continue;const m=g.default,y=Ce(h,0)|(m==null?void 0:m.flags);let v=m==null?void 0:m.duration;y&8&&(y&2?v=Ce(h,12):v=Ce(h,8));const x=g.timescale||9e4,b=Ge(c,["trun"]);for(let A=0;A<b.length;A++){if(t=SC(b[A]),!t&&v){const S=Ce(b[A],4);t=v*S}g.type===ut.VIDEO?n+=t/x:g.type===ut.AUDIO&&(i+=t/x)}}if(n===0&&i===0){let l=1/0,c=0,h=0;const f=Ge(s,["sidx"]);for(let g=0;g<f.length;g++){const m=vC(f[g]);if(m!=null&&m.references){l=Math.min(l,m.earliestPresentationTime/m.timescale);const y=m.references.reduce((v,x)=>v+x.info.duration||0,0);c=Math.max(c,y+m.earliestPresentationTime/m.timescale),h=c-l}}if(h&&Ee(h))return h}return n||i}function SC(s){const e=Ce(s,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let n=0;const i=Ce(s,4);for(let a=0;a<i;a++){if(e&256){const l=Ce(s,t);n+=l,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return n}function TC(s,e,t){Ge(e,["moof","traf"]).forEach(n=>{Ge(n,["tfhd"]).forEach(i=>{const a=Ce(i,4),l=s[a];if(!l)return;const c=l.timescale||9e4;Ge(n,["tfdt"]).forEach(h=>{const f=h[0],g=t*c;if(g){let m=Ce(h,4);if(f===0)m-=g,m=Math.max(m,0),km(h,4,m);else{m*=Math.pow(2,32),m+=Ce(h,8),m-=g,m=Math.max(m,0);const y=Math.floor(m/(gd+1)),v=Math.floor(m%(gd+1));km(h,4,y),km(h,8,v)}}})})})}function wC(s){const e={valid:null,remainder:null},t=Ge(s,["moof"]);if(t.length<2)return e.remainder=s,e;const n=t[t.length-1];return e.valid=s.slice(0,n.byteOffset-8),e.remainder=s.slice(n.byteOffset-8),e}function Cs(s,e){const t=new Uint8Array(s.length+e.length);return t.set(s),t.set(e,s.length),t}function TE(s,e){const t=[],n=e.samples,i=e.timescale,a=e.id;let l=!1;return Ge(n,["moof"]).map(h=>{const f=h.byteOffset-8;Ge(h,["traf"]).map(m=>{const y=Ge(m,["tfdt"]).map(v=>{const x=v[0];let b=Ce(v,4);return x===1&&(b*=Math.pow(2,32),b+=Ce(v,8)),b/i})[0];return y!==void 0&&(s=y),Ge(m,["tfhd"]).map(v=>{const x=Ce(v,4),b=Ce(v,0)&16777215,A=(b&1)!==0,S=(b&2)!==0,k=(b&8)!==0;let R=0;const _=(b&16)!==0;let C=0;const U=(b&32)!==0;let O=8;x===a&&(A&&(O+=8),S&&(O+=4),k&&(R=Ce(v,O),O+=4),_&&(C=Ce(v,O),O+=4),U&&(O+=4),e.type==="video"&&(l=Qd(e.codec)),Ge(m,["trun"]).map(B=>{const F=B[0],M=Ce(B,0)&16777215,j=(M&1)!==0;let ae=0;const ye=(M&4)!==0,pe=(M&256)!==0;let W=0;const G=(M&512)!==0;let te=0;const se=(M&1024)!==0,Z=(M&2048)!==0;let I=0;const V=Ce(B,4);let ie=8;j&&(ae=Ce(B,ie),ie+=4),ye&&(ie+=4);let ce=ae+f;for(let ue=0;ue<V;ue++){if(pe?(W=Ce(B,ie),ie+=4):W=R,G?(te=Ce(B,ie),ie+=4):te=C,se&&(ie+=4),Z&&(F===0?I=Ce(B,ie):I=DS(B,ie),ie+=4),e.type===ut.VIDEO){let xe=0;for(;xe<te;){const ve=Ce(n,ce);if(ce+=4,RC(l,n[ce])){const $e=n.subarray(ce,ce+ve);Iy($e,l?2:1,s+I/i,t)}ce+=ve,xe+=ve+4}}s+=W/i}}))})})}),t}function Qd(s){if(!s)return!1;const e=s.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function RC(s,e){if(s){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Iy(s,e,t,n){const i=OS(s);let a=0;a+=e;let l=0,c=0,h=0;for(;a<i.length;){l=0;do{if(a>=i.length)break;h=i[a++],l+=h}while(h===255);c=0;do{if(a>=i.length)break;h=i[a++],c+=h}while(h===255);const f=i.length-a;let g=a;if(c<f)a+=c;else if(c>f){Je.error(`Malformed SEI payload. ${c} is too small, only ${f} bytes left to parse.`);break}if(l===4){if(i[g++]===181){const y=IS(i,g);if(g+=2,y===49){const v=Ce(i,g);if(g+=4,v===1195456820){const x=i[g++];if(x===3){const b=i[g++],A=31&b,S=64&b,k=S?2+A*3:0,R=new Uint8Array(k);if(S){R[0]=b;for(let _=1;_<k;_++)R[_]=i[g++]}n.push({type:x,payloadType:l,pts:t,bytes:R})}}}}}else if(l===5&&c>16){const m=[];for(let x=0;x<16;x++){const b=i[g++].toString(16);m.push(b.length==1?"0"+b:b),(x===3||x===5||x===7||x===9)&&m.push("-")}const y=c-16,v=new Uint8Array(y);for(let x=0;x<y;x++)v[x]=i[g++];n.push({payloadType:l,pts:t,uuid:m.join(""),userData:ls(v),userDataBytes:v})}}}function OS(s){const e=s.byteLength,t=[];let n=1;for(;n<e-2;)s[n]===0&&s[n+1]===0&&s[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return s;const i=e-t.length,a=new Uint8Array(i);let l=0;for(n=0;n<i;l++,n++)l===t[0]&&(l++,t.shift()),a[n]=s[l];return a}function LC(s){const e=s[0];let t="",n="",i=0,a=0,l=0,c=0,h=0,f=0;if(e===0){for(;qt(s.subarray(f,f+1))!=="\0";)t+=qt(s.subarray(f,f+1)),f+=1;for(t+=qt(s.subarray(f,f+1)),f+=1;qt(s.subarray(f,f+1))!=="\0";)n+=qt(s.subarray(f,f+1)),f+=1;n+=qt(s.subarray(f,f+1)),f+=1,i=Ce(s,12),a=Ce(s,16),c=Ce(s,20),h=Ce(s,24),f=28}else if(e===1){f+=4,i=Ce(s,f),f+=4;const m=Ce(s,f);f+=4;const y=Ce(s,f);for(f+=4,l=2**32*m+y,nC(l)||(l=Number.MAX_SAFE_INTEGER,Je.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),c=Ce(s,f),f+=4,h=Ce(s,f),f+=4;qt(s.subarray(f,f+1))!=="\0";)t+=qt(s.subarray(f,f+1)),f+=1;for(t+=qt(s.subarray(f,f+1)),f+=1;qt(s.subarray(f,f+1))!=="\0";)n+=qt(s.subarray(f,f+1)),f+=1;n+=qt(s.subarray(f,f+1)),f+=1}const g=s.subarray(f,s.byteLength);return{schemeIdUri:t,value:n,timeScale:i,presentationTime:l,presentationTimeDelta:a,eventDuration:c,id:h,payload:g}}function kC(s,...e){const t=e.length;let n=8,i=t;for(;i--;)n+=e[i].byteLength;const a=new Uint8Array(n);for(a[0]=n>>24&255,a[1]=n>>16&255,a[2]=n>>8&255,a[3]=n&255,a.set(s,4),i=0,n=8;i<t;i++)a.set(e[i],n),n+=e[i].byteLength;return a}function IC(s,e,t){if(s.byteLength!==16)throw new RangeError("Invalid system id");let n,i;n=0,i=new Uint8Array;let a;n>0?(a=new Uint8Array(4),e.length>0&&new DataView(a.buffer).setUint32(0,e.length,!1)):a=new Uint8Array;const l=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(l.buffer).setUint32(0,t.byteLength,!1),kC([112,115,115,104],new Uint8Array([n,0,0,0]),s,a,i,l,t||new Uint8Array)}function DC(s){const e=[];if(s instanceof ArrayBuffer){const t=s.byteLength;let n=0;for(;n+32<t;){const i=new DataView(s,n),a=CC(i);e.push(a),n+=a.size}}return e}function CC(s){const e=s.getUint32(0),t=s.byteOffset,n=s.byteLength;if(n<e)return{offset:t,size:n};if(s.getUint32(4)!==1886614376)return{offset:t,size:e};const a=s.getUint32(8)>>>24;if(a!==0&&a!==1)return{offset:t,size:e};const l=s.buffer,c=hi.hexDump(new Uint8Array(l,t+12,16)),h=s.getUint32(28);let f=null,g=null;if(a===0){if(e-32<h||h<22)return{offset:t,size:e};g=new Uint8Array(l,t+32,h)}else if(a===1){if(!h||n<t+32+h*16+16)return{offset:t,size:e};f=[];for(let m=0;m<h;m++)f.push(new Uint8Array(l,t+32+m*16,16))}return{version:a,systemId:c,kids:f,data:g,offset:t,size:e}}const MS=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),zc={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function PS(s,e){const t=zc[e];return!!t&&!!t[s.slice(0,4)]}function bp(s,e,t=!0){return!s.split(",").some(n=>!NS(n,e,t))}function NS(s,e,t=!0){var n;const i=Ra(t);return(n=i==null?void 0:i.isTypeSupported(bh(s,e)))!=null?n:!1}function bh(s,e){return`${e}/mp4;codecs=${s}`}function wE(s){if(s){const e=s.substring(0,4);return zc.video[e]}return 2}function md(s){const e=MS();return s.split(",").reduce((t,n)=>{const a=e&&Qd(n)?9:zc.video[n];return a?(a*2+t)/(t?3:2):(zc.audio[n]+t)/(t?2:1)},0)}const Dm={};function _C(s,e=!0){if(Dm[s])return Dm[s];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[s];for(let i=0;i<t.length;i++){var n;if(NS(t[i],"audio",e))return Dm[s]=t[i],t[i];if(t[i]==="mp3"&&(n=Ra(e))!=null&&n.isTypeSupported("audio/mpeg"))return""}return s}const OC=/flac|opus|mp4a\.40\.34/i;function pd(s,e=!0){return s.replace(OC,t=>_C(t.toLowerCase(),e))}function MC(s,e){const t=[];if(s){const n=s.split(",");for(let i=0;i<n.length;i++)PS(n[i],"video")||t.push(n[i])}return e&&t.push(e),t.join(",")}function X0(s,e){if(s&&(s.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(s)!==-1))return s;if(e){const t=e.split(",");if(t.length>1){if(s){for(let n=t.length;n--;)if(t[n].substring(0,4)===s.substring(0,4))return t[n]}return t[0]}}return e||s}function PC(s){const e=s.split(",");for(let t=0;t<e.length;t++){const n=e[t].split(".");if(n.length>2){let i=n.shift()+".";i+=parseInt(n.shift()).toString(16),i+=("000"+parseInt(n.shift()).toString(16)).slice(-4),e[t]=i}}return e.join(",")}function NC(s){if(s.startsWith("av01.")){const e=s.split("."),t=["0","111","01","01","01","0"];for(let n=e.length;n>4&&n<10;n++)e[n]=t[n-4];return e.join(".")}return s}function RE(s){const e=Ra(s)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function BS(s){return s.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const US={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function FS(s,e){return{supported:!1,configurations:e,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:s}}const LE={};function BC(s,e,t,n,i,a){const l=s.audioCodec?s.audioGroups:null,c=a==null?void 0:a.audioCodec,h=a==null?void 0:a.channels,f=h?parseInt(h):c?1/0:2;let g=null;if(l!=null&&l.length)try{l.length===1&&l[0]?g=e.groups[l[0]].channels:g=l.reduce((m,y)=>{if(y){const v=e.groups[y];if(!v)throw new Error(`Audio track group ${y} not found`);Object.keys(v.channels).forEach(x=>{m[x]=(m[x]||0)+v.channels[x]})}return m},{2:0})}catch{return!0}return s.videoCodec!==void 0&&(s.width>1920&&s.height>1088||s.height>1920&&s.width>1088||s.frameRate>Math.max(n,30)||s.videoRange!=="SDR"&&s.videoRange!==t||s.bitrate>Math.max(i,8e6))||!!g&&Ee(f)&&Object.keys(g).some(m=>parseInt(m)>f)}function GS(s,e,t){const n=s.videoCodec,i=s.audioCodec;if(!n&&!i||!t)return Promise.resolve(US);const a=[];if(n){const l={width:s.width,height:s.height,bitrate:Math.ceil(Math.max(s.bitrate*.9,s.averageBitrate)),framerate:s.frameRate||30},c=s.videoRange;c!=="SDR"&&(l.transferFunction=c.toLowerCase());const h=n.split(","),f=navigator.userAgent;if(h.some(g=>Qd(g))&&MS())return Promise.resolve(FS(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: (${f})`),a));a.push.apply(a,h.map(g=>({type:"media-source",video:lt(lt({},l),{},{contentType:bh(NC(g),"video")})})))}return i&&s.audioGroups&&s.audioGroups.forEach(l=>{var c;l&&((c=e.groups[l])==null||c.tracks.forEach(h=>{if(h.groupId===l){const f=h.channels||"",g=parseFloat(f);Ee(g)&&g>2&&a.push.apply(a,i.split(",").map(m=>({type:"media-source",audio:{contentType:bh(m,"audio"),channels:""+g}})))}}))}),Promise.all(a.map(l=>{const c=UC(l);return LE[c]||(LE[c]=t.decodingInfo(l))})).then(l=>({supported:!l.some(c=>!c.supported),configurations:a,decodingInfoResults:l})).catch(l=>({supported:!1,configurations:a,decodingInfoResults:[],error:l}))}function UC(s){const{audio:e,video:t}=s,n=t||e;if(n){const i=BS(n.contentType);if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${i}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${i}`}return""}const Ap=["NONE","TYPE-0","TYPE-1",null];function FC(s){return Ap.indexOf(s)>-1}const yd=["SDR","PQ","HLG"];function GC(s){return!!s&&yd.indexOf(s)>-1}var W0={No:"",Yes:"YES",v2:"v2"};function kE(s){const{canSkipUntil:e,canSkipDateRanges:t,age:n}=s,i=n<e/2;return e&&i?t?W0.v2:W0.Yes:W0.No}class IE{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Ah{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(n=>!!n).map(n=>n.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const n=(t=e.supplemental)==null?void 0:t.videoCodec;n&&n!==e.videoCodec&&(this.codecSet+=`,${n.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return DE(this._audioGroups,e)}hasSubtitleGroup(e){return DE(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function DE(s,e){return!e||!s?!1:s.indexOf(e)!==-1}function $C(){if(typeof matchMedia=="function"){const s=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(s.media!==e.media)return s.matches===!0}return!1}function HC(s,e){let t=!1,n=[];if(s&&(t=s!=="SDR",n=[s]),e){n=e.allowedVideoRanges||yd.slice(0);const i=n.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:i&&$C(),t||(n=["SDR"])}return{preferHDR:t,allowedVideoRanges:n}}const zC=s=>{const e=new WeakSet;return(t,n)=>{if(s&&(n=s(t,n)),typeof n=="object"&&n!==null){if(e.has(n))return;e.add(n)}return n}},St=(s,e)=>JSON.stringify(s,zC(e));function VC(s,e,t,n,i){const a=Object.keys(s),l=n==null?void 0:n.channels,c=n==null?void 0:n.audioCodec,h=i==null?void 0:i.videoCodec,f=l&&parseInt(l)===2;let g=!1,m=!1,y=1/0,v=1/0,x=1/0,b=1/0,A=0,S=[];const{preferHDR:k,allowedVideoRanges:R}=HC(e,i);for(let B=a.length;B--;){const F=s[a[B]];g||(g=F.channels[2]>0),y=Math.min(y,F.minHeight),v=Math.min(v,F.minFramerate),x=Math.min(x,F.minBitrate),R.filter(j=>F.videoRanges[j]>0).length>0&&(m=!0)}y=Ee(y)?y:0,v=Ee(v)?v:0;const _=Math.max(1080,y),C=Math.max(30,v);x=Ee(x)?x:t,t=Math.max(x,t),m||(e=void 0);const U=a.length>1;return{codecSet:a.reduce((B,F)=>{const M=s[F];if(F===B)return B;if(S=m?R.filter(j=>M.videoRanges[j]>0):[],U){if(M.minBitrate>t)return oi(F,`min bitrate of ${M.minBitrate} > current estimate of ${t}`),B;if(!M.hasDefaultAudio)return oi(F,"no renditions with default or auto-select sound found"),B;if(c&&F.indexOf(c.substring(0,4))%5!==0)return oi(F,`audio codec preference "${c}" not found`),B;if(l&&!f){if(!M.channels[l])return oi(F,`no renditions with ${l} channel sound found (channels options: ${Object.keys(M.channels)})`),B}else if((!c||f)&&g&&M.channels[2]===0)return oi(F,"no renditions with stereo sound found"),B;if(M.minHeight>_)return oi(F,`min resolution of ${M.minHeight} > maximum of ${_}`),B;if(M.minFramerate>C)return oi(F,`min framerate of ${M.minFramerate} > maximum of ${C}`),B;if(!S.some(j=>M.videoRanges[j]>0))return oi(F,`no variants with VIDEO-RANGE of ${St(S)} found`),B;if(h&&F.indexOf(h.substring(0,4))%5!==0)return oi(F,`video codec preference "${h}" not found`),B;if(M.maxScore<A)return oi(F,`max score of ${M.maxScore} < selected max of ${A}`),B}return B&&(md(F)>=md(B)||M.fragmentError>s[B].fragmentError)?B:(b=M.minIndex,A=M.maxScore,F)},void 0),videoRanges:S,preferHDR:k,minFramerate:v,minBitrate:x,minIndex:b}}function oi(s,e){Je.log(`[abr] start candidates with "${s}" ignored because ${e}`)}function $S(s){return s.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const i=t.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function KC(s,e,t,n){return s.slice(t,n+1).reduce((i,a,l)=>{if(!a.codecSet)return i;const c=a.audioGroups;let h=i[a.codecSet];h||(i[a.codecSet]=h={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:l,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!c,fragmentError:0}),h.minBitrate=Math.min(h.minBitrate,a.bitrate);const f=Math.min(a.height,a.width);return h.minHeight=Math.min(h.minHeight,f),h.minFramerate=Math.min(h.minFramerate,a.frameRate),h.minIndex=Math.min(h.minIndex,l),h.maxScore=Math.max(h.maxScore,a.score),h.fragmentError+=a.fragmentError,h.videoRanges[a.videoRange]=(h.videoRanges[a.videoRange]||0)+1,c&&c.forEach(g=>{if(!g)return;const m=e.groups[g];m&&(h.hasDefaultAudio=h.hasDefaultAudio||e.hasDefaultAudio?m.hasDefault:m.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(m.channels).forEach(y=>{h.channels[y]=(h.channels[y]||0)+m.channels[y]}))}),i},{})}function CE(s){if(!s)return s;const{lang:e,assocLang:t,characteristics:n,channels:i,audioCodec:a}=s;return{lang:e,assocLang:t,characteristics:n,channels:i,audioCodec:a}}function Ti(s,e,t){if("attrs"in s){const n=e.indexOf(s);if(n!==-1)return n}for(let n=0;n<e.length;n++){const i=e[n];if(Ml(s,i,t))return n}return-1}function Ml(s,e,t){const{groupId:n,name:i,lang:a,assocLang:l,default:c}=s,h=s.forced;return(n===void 0||e.groupId===n)&&(i===void 0||e.name===i)&&(a===void 0||YC(a,e.lang))&&(a===void 0||e.assocLang===l)&&(c===void 0||e.default===c)&&(h===void 0||e.forced===h)&&(!("characteristics"in s)||jC(s.characteristics||"",e.characteristics))&&(t===void 0||t(s,e))}function YC(s,e="--"){return s.length===e.length?s===e:s.startsWith(e)||e.startsWith(s)}function jC(s,e=""){const t=s.split(","),n=e.split(",");return t.length===n.length&&!t.some(i=>n.indexOf(i)===-1)}function sl(s,e){const{audioCodec:t,channels:n}=s;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function QC(s,e,t,n,i){const a=e[n],c=e.reduce((y,v,x)=>{const b=v.uri;return(y[b]||(y[b]=[])).push(x),y},{})[a.uri];c.length>1&&(n=Math.max.apply(Math,c));const h=a.videoRange,f=a.frameRate,g=a.codecSet.substring(0,4),m=_E(e,n,y=>{if(y.videoRange!==h||y.frameRate!==f||y.codecSet.substring(0,4)!==g)return!1;const v=y.audioGroups,x=t.filter(b=>!v||v.indexOf(b.groupId)!==-1);return Ti(s,x,i)>-1});return m>-1?m:_E(e,n,y=>{const v=y.audioGroups,x=t.filter(b=>!v||v.indexOf(b.groupId)!==-1);return Ti(s,x,i)>-1})}function _E(s,e,t){for(let n=e;n>-1;n--)if(t(s[n]))return n;for(let n=e+1;n<s.length;n++)if(t(s[n]))return n;return-1}function vd(s,e){var t;return!!s&&s!==((t=e.loadLevelObj)==null?void 0:t.uri)}class qC extends Lr{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var n;const{fragCurrent:i,partCurrent:a,hls:l}=this,{autoLevelEnabled:c,media:h}=l;if(!i||!h)return;const f=performance.now(),g=a?a.stats:i.stats,m=a?a.duration:i.duration,y=f-g.loading.start,v=l.minAutoLevel,x=i.level,b=this._nextAutoLevel;if(g.aborted||g.loaded&&g.loaded===g.total||x<=v){this.clearTimer(),this._nextAutoLevel=-1;return}if(!c)return;const A=b>-1&&b!==x,S=!!t||A;if(!S&&(h.paused||!h.playbackRate||!h.readyState))return;const k=l.mainForwardBufferInfo;if(!S&&k===null)return;const R=this.bwEstimator.getEstimateTTFB(),_=Math.abs(h.playbackRate);if(y<=Math.max(R,1e3*(m/(_*2))))return;const C=k?k.len/_:0,U=g.loading.first?g.loading.first-g.loading.start:-1,O=g.loaded&&U>-1,B=this.getBwEstimate(),F=l.levels,M=F[x],j=Math.max(g.loaded,Math.round(m*(i.bitrate||M.averageBitrate)/8));let ae=O?y-U:y;ae<1&&O&&(ae=Math.min(y,g.loaded*8/B));const ye=O?g.loaded*1e3/ae:0,pe=R/1e3,W=ye?(j-g.loaded)/ye:j*8/B+pe;if(W<=C)return;const G=ye?ye*8:B,te=((n=(t==null?void 0:t.details)||this.hls.latestLevelDetails)==null?void 0:n.live)===!0,se=this.hls.config.abrBandWidthUpFactor;let Z=Number.POSITIVE_INFINITY,I;for(I=x-1;I>v;I--){const ue=F[I].maxBitrate,xe=!F[I].details||te;if(Z=this.getTimeToLoadFrag(pe,G,m*ue,xe),Z<Math.min(C,m+pe))break}if(Z>=W||Z>m*10)return;O?this.bwEstimator.sample(y-Math.min(R,U),g.loaded):this.bwEstimator.sampleTTFB(y);const V=F[I].maxBitrate;this.getBwEstimate()*se>V&&this.resetEstimator(V);const ie=this.findBestLevel(V,v,I,0,C,1,1);ie>-1&&(I=ie),this.warn(`Fragment ${i.sn}${a?" part "+a.index:""} of level ${x} is loading too slowly;
      Fragment duration: ${i.duration.toFixed(3)}
      Time to underbuffer: ${C.toFixed(3)} s
      Estimated load time for current fragment: ${W.toFixed(3)} s
      Estimated load time for down switch fragment: ${Z.toFixed(3)} s
      TTFB estimate: ${U|0} ms
      Current BW estimate: ${Ee(B)?B|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${I} @ ${V|0} bps`),l.nextLoadLevel=l.nextAutoLevel=I,this.clearTimer();const ce=()=>{if(this.clearTimer(),this.fragCurrent===i&&this.hls.loadLevel===I&&I>0){const ue=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${I>0?"and switching down":""}
      Fragment duration: ${i.duration.toFixed(3)} s
      Time to underbuffer: ${ue.toFixed(3)} s`),i.abortRequests(),this.fragCurrent=this.partCurrent=null,I>v){let xe=this.findBestLevel(this.hls.levels[v].bitrate,v,I,0,ue,1,1);xe===-1&&(xe=v),this.hls.nextLoadLevel=this.hls.nextAutoLevel=xe,this.resetEstimator(this.hls.levels[xe].bitrate)}}};A||W>Z*2?ce():this.timer=self.setInterval(ce,Z*1e3),l.trigger(T.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,part:a,stats:g})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new iC(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.FRAG_LOADING,this.onFragLoading,this),e.on(T.FRAG_LOADED,this.onFragLoaded,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this),e.on(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(T.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.FRAG_LOADING,this.onFragLoading,this),e.off(T.FRAG_LOADED,this.onFragLoaded,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this),e.off(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(T.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(T.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var i;this.fragCurrent=n,this.partCurrent=(i=t.part)!=null?i:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Q.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:i,partCurrent:a}=this;if(n&&i&&n.sn===i.sn&&n.level===i.level){const l=performance.now(),c=a?a.stats:n.stats,h=l-c.loading.start,f=c.loading.first?c.loading.first-c.loading.start:-1;if(c.loaded&&f>-1){const m=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(h-Math.min(m,f),c.loaded)}else this.bwEstimator.sampleTTFB(h)}break}}}getTimeToLoadFrag(e,t,n,i){const a=e+n/t,l=i?e+this.lastLevelLoadSec:0;return a+l}onLevelLoaded(e,t){const n=this.hls.config,{loading:i}=t.stats,a=i.end-i.first;Ee(a)&&(this.lastLevelLoadSec=a/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:n}){const i=n?n.stats:t.stats;if(t.type===Te.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const a=n?n.duration:t.duration,l=this.hls.levels[t.level],c=(l.loaded?l.loaded.bytes:0)+i.loaded,h=(l.loaded?l.loaded.duration:0)+a;l.loaded={bytes:c,duration:h},l.realBitrate=Math.round(8*c/h)}if(t.bitrateTest){const a={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered(T.FRAG_BUFFERED,a),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:i}=t,a=i!=null&&i.stats.loaded?i.stats:n.stats;if(a.aborted||this.ignoreFragment(n))return;const l=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(l,a.loaded),a.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=l/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Te.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,a=this.findBestLevel(n,t,e,0,i,1,1);if(a>-1)return a;const l=this.hls.firstLevel,c=Math.min(Math.max(l,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${l} clamped to ${c}`),c}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),i=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!i||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const a=n&&i?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const l=this.hls.levels;if(l.length>Math.max(e,a)&&l[e].loadError<=l[a].loadError)return e}return this._nextAutoLevel=a,this.nextAutoLevelKey=this.getAutoLevelKey(),a}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this;if(n.levels.length<=1)return n.loadLevel;const{maxAutoLevel:i,config:a,minAutoLevel:l}=n,c=t?t.duration:e?e.duration:0,h=this.getBwEstimate(),f=this.getStarvationDelay();let g=a.abrBandWidthFactor,m=a.abrBandWidthUpFactor;if(f){const A=this.findBestLevel(h,l,i,f,0,g,m);if(A>=0)return this.rebufferNotice=-1,A}let y=c?Math.min(c,a.maxStarvationDelay):a.maxStarvationDelay;if(!f){const A=this.bitrateTestDelay;A&&(y=(c?Math.min(c,a.maxLoadingDelay):a.maxLoadingDelay)-A,this.info(`bitrate test took ${Math.round(1e3*A)}ms, set first fragment max fetchDuration to ${Math.round(1e3*y)} ms`),g=m=1)}const v=this.findBestLevel(h,l,i,f,y,g,m);if(this.rebufferNotice!==v&&(this.rebufferNotice=v,this.info(`${f?"rebuffering expected":"buffer is empty"}, optimal quality level ${v}`)),v>-1)return v;const x=n.levels[l],b=n.loadLevelObj;return b&&(x==null?void 0:x.bitrate)<b.bitrate?l:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,i,a,l,c){var h;const f=i+a,g=this.lastLoadedFragLevel,m=g===-1?this.hls.firstLevel:g,{fragCurrent:y,partCurrent:v}=this,{levels:x,allAudioTracks:b,loadLevel:A,config:S}=this.hls;if(x.length===1)return 0;const k=x[m],R=!!((h=this.hls.latestLevelDetails)!=null&&h.live),_=A===-1||g===-1;let C,U="SDR",O=(k==null?void 0:k.frameRate)||0;const{audioPreference:B,videoPreference:F}=S,M=this.audioTracksByGroup||(this.audioTracksByGroup=$S(b));let j=-1;if(_){if(this.firstSelection!==-1)return this.firstSelection;const G=this.codecTiers||(this.codecTiers=KC(x,M,t,n)),te=VC(G,U,e,B,F),{codecSet:se,videoRanges:Z,minFramerate:I,minBitrate:V,minIndex:ie,preferHDR:ce}=te;j=ie,C=se,U=ce?Z[Z.length-1]:Z[0],O=I,e=Math.max(e,V),this.log(`picked start tier ${St(te)}`)}else C=k==null?void 0:k.codecSet,U=k==null?void 0:k.videoRange;const ae=v?v.duration:y?y.duration:0,ye=this.bwEstimator.getEstimateTTFB()/1e3,pe=[];for(let G=n;G>=t;G--){var W;const te=x[G],se=G>m;if(!te)continue;if(S.useMediaCapabilities&&!te.supportedResult&&!te.supportedPromise){const xe=navigator.mediaCapabilities;typeof(xe==null?void 0:xe.decodingInfo)=="function"&&(BC(te,M,U,O,e,B)||Qd(te.videoCodec))?(te.supportedPromise=GS(te,M,xe),te.supportedPromise.then(ve=>{if(!this.hls)return;te.supportedResult=ve;const $e=this.hls.levels,ke=$e.indexOf(te);ve.error?this.warn(`MediaCapabilities decodingInfo error: "${ve.error}" for level ${ke} ${St(ve)}`):ve.supported||(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${ke} ${St(ve)}`),ke>-1&&$e.length>1&&(this.log(`Removing unsupported level ${ke}`),this.hls.removeLevel(ke),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))})):te.supportedResult=US}if((C&&te.codecSet!==C||U&&te.videoRange!==U||se&&O>te.frameRate||!se&&O>0&&O<te.frameRate||te.supportedResult&&!((W=te.supportedResult.decodingInfoResults)!=null&&W[0].smooth))&&(!_||G!==j)){pe.push(G);continue}const Z=te.details,I=(v?Z==null?void 0:Z.partTarget:Z==null?void 0:Z.averagetargetduration)||ae;let V;se?V=c*e:V=l*e;const ie=ae&&i>=ae*2&&a===0?te.averageBitrate:te.maxBitrate,ce=this.getTimeToLoadFrag(ye,V,ie*I,Z===void 0);if(V>=ie&&(G===g||te.loadError===0&&te.fragmentError===0)&&(ce<=ye||!Ee(ce)||R&&!this.bitrateTestDelay||ce<f)){const xe=this.forcedAutoLevel;return G!==A&&(xe===-1||xe!==A)&&(pe.length&&this.trace(`Skipped level(s) ${pe.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${x[pe[0]].codecs}" ${x[pe[0]].videoRange}; not compatible with "${C}" ${U}`),this.info(`switch candidate:${m}->${G} adjustedbw(${Math.round(V)})-bitrate=${Math.round(V-ie)} ttfb:${ye.toFixed(1)} avgDuration:${I.toFixed(1)} maxFetchDuration:${f.toFixed(1)} fetchDuration:${ce.toFixed(1)} firstSelection:${_} codecSet:${te.codecSet} videoRange:${te.videoRange} hls.loadLevel:${A}`)),_&&(this.firstSelection=G),G}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls;return Math.min(Math.max(e,n),t)}}const Dy={search:function(s,e){let t=0,n=s.length-1,i=null,a=null;for(;t<=n;){i=(t+n)/2|0,a=s[i];const l=e(a);if(l>0)t=i+1;else if(l<0)n=i-1;else return a}return null}};function XC(s,e,t){if(e===null||!Array.isArray(s)||!s.length||!Ee(e))return null;const n=s[0].programDateTime;if(e<(n||0))return null;const i=s[s.length-1].endProgramDateTime;if(e>=(i||0))return null;t=t||0;for(let a=0;a<s.length;++a){const l=s[a];if(ZC(e,t,l))return l}return null}function Bl(s,e,t=0,n=0,i=.005){let a=null;if(s){a=e[1+s.sn-e[0].sn]||null;const c=s.endDTS-t;c>0&&c<15e-7&&(t+=15e-7),a&&s.level!==a.level&&a.end<=s.end&&(a=e[2+s.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(a=e[0]);if(a&&((!s||s.level===a.level)&&OE(t,n,a)===0||WC(a,s,Math.min(i,n))))return a;const l=Dy.search(e,OE.bind(null,t,n));return l&&(l!==s||!a)?l:a}function WC(s,e,t){if(e&&e.start===0&&e.level<s.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((i,a)=>(a[0]==="INF"&&(i+=parseFloat(a[1])),i),t);return s.start<=n}return!1}function OE(s=0,e=0,t){if(t.start<=s&&t.start+t.duration>s)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=s?1:t.start-n>s&&t.start?-1:0}function ZC(s,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>s}function HS(s,e){return Dy.search(s,t=>t.cc<e?1:t.cc>e?-1:0)}function JC(s,e,t){if(s&&s.startCC<=e&&s.endCC>=e){const n=t.start,i=t.end;let a=s.fragments;if(!t.relurl){const{fragmentHint:l}=s;l&&(a=a.concat(l))}return Dy.search(a,l=>l.cc<e||l.end<=n?1:l.cc>e||l.start>=i?-1:0)}return null}function xd(s){switch(s.details){case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_TIMEOUT:case Q.LEVEL_LOAD_TIMEOUT:case Q.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function ME(s,e){const t=xd(e);return s.default[`${t?"timeout":"error"}Retry`]}function Cy(s,e){const t=s.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*s.retryDelayMs,s.maxRetryDelayMs)}function PE(s){return lt(lt({},s),{errorRetry:null,timeoutRetry:null})}function Ed(s,e,t,n){if(!s)return!1;const i=n==null?void 0:n.code,a=e<s.maxNumRetry&&(e_(i)||!!t);return s.shouldRetry?s.shouldRetry(s,e,t,n,a):a}function e_(s){return s===0&&navigator.onLine===!1||!!s&&(s<400||s>499)}var wn={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},Gs={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2};class t_ extends Lr{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(T.ERROR,this.onError,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(T.ERROR,this.onError,this),e.off(T.ERROR,this.onErrorOut,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Te.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n;if(t.fatal)return;const i=this.hls,a=t.context;switch(t.details){case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case Q.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction=Sh();return}case Q.FRAG_GAP:case Q.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=wn.SendAlternateToPenaltyBox;return}case Q.LEVEL_EMPTY_ERROR:case Q.LEVEL_PARSING_ERROR:{var l,c;const f=t.parent===Te.MAIN?t.level:i.loadLevel;t.details===Q.LEVEL_EMPTY_ERROR&&((l=t.context)!=null&&(c=l.levelDetails)!=null&&c.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,f):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,f))}return;case Q.LEVEL_LOAD_ERROR:case Q.LEVEL_LOAD_TIMEOUT:typeof(a==null?void 0:a.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.level));return;case Q.AUDIO_TRACK_LOAD_ERROR:case Q.AUDIO_TRACK_LOAD_TIMEOUT:case Q.SUBTITLE_LOAD_ERROR:case Q.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){const f=i.loadLevelObj;if(f&&(a.type===qe.AUDIO_TRACK&&f.hasAudioGroup(a.groupId)||a.type===qe.SUBTITLE_TRACK&&f.hasSubtitleGroup(a.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=wn.SendAlternateToPenaltyBox,t.errorAction.flags=Gs.MoveAllAlternatesMatchingHost;return}}return;case Q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const f=i.loadLevelObj,g=f==null?void 0:f.attrs["HDCP-LEVEL"];g?t.errorAction={action:wn.SendAlternateToPenaltyBox,flags:Gs.MoveAllAlternatesMatchingHDCP,hdcpLevel:g}:this.keySystemError(t)}return;case Q.BUFFER_ADD_CODEC_ERROR:case Q.REMUX_ALLOC_ERROR:case Q.BUFFER_APPEND_ERROR:if(!t.errorAction){var h;t.errorAction=this.getLevelSwitchAction(t,(h=t.level)!=null?h:i.loadLevel)}return;case Q.INTERNAL_EXCEPTION:case Q.BUFFER_APPENDING_ERROR:case Q.BUFFER_FULL_ERROR:case Q.LEVEL_SWITCH_ERROR:case Q.BUFFER_STALLED_ERROR:case Q.BUFFER_SEEK_OVER_HOLE:case Q.BUFFER_NUDGE_ON_STALL:t.errorAction=Sh();return}t.type===Re.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,i=ME(n.config.playlistLoadPolicy,e),a=this.playlistError++;if(Ed(i,a,xd(e),e.response))return{action:wn.RetryRequest,flags:Gs.None,retryConfig:i,retryCount:a};const c=this.getLevelSwitchAction(e,t);return i&&(c.retryConfig=i,c.retryCount=a),c}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:a,keyLoadPolicy:l}=t.config,c=ME(e.details.startsWith("key")?l:a,e),h=t.levels.reduce((g,m)=>g+m.fragmentError,0);if(i&&(e.details!==Q.FRAG_GAP&&i.fragmentError++,Ed(c,h,xd(e),e.response)))return{action:wn.RetryRequest,flags:Gs.None,retryConfig:c,retryCount:h};const f=this.getLevelSwitchAction(e,n);return c&&(f.retryConfig=c,f.retryCount=h),f}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const i=this.hls.levels[t];if(i){var a,l;const f=e.details;i.loadError++,f===Q.BUFFER_APPEND_ERROR&&i.fragmentError++;let g=-1;const{levels:m,loadLevel:y,minAutoLevel:v,maxAutoLevel:x}=n;n.autoLevelEnabled||(n.loadLevel=-1);const b=(a=e.frag)==null?void 0:a.type,S=(b===Te.AUDIO&&f===Q.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(f===Q.BUFFER_ADD_CODEC_ERROR||f===Q.BUFFER_APPEND_ERROR))&&m.some(({audioCodec:U})=>i.audioCodec!==U),R=e.sourceBufferName==="video"&&(f===Q.BUFFER_ADD_CODEC_ERROR||f===Q.BUFFER_APPEND_ERROR)&&m.some(({codecSet:U,audioCodec:O})=>i.codecSet!==U&&i.audioCodec===O),{type:_,groupId:C}=(l=e.context)!=null?l:{};for(let U=m.length;U--;){const O=(U+y)%m.length;if(O!==y&&O>=v&&O<=x&&m[O].loadError===0){var c,h;const B=m[O];if(f===Q.FRAG_GAP&&b===Te.MAIN&&e.frag){const F=m[O].details;if(F){const M=Bl(e.frag,F.fragments,e.frag.start);if(M!=null&&M.gap)continue}}else{if(_===qe.AUDIO_TRACK&&B.hasAudioGroup(C)||_===qe.SUBTITLE_TRACK&&B.hasSubtitleGroup(C))continue;if(b===Te.AUDIO&&(c=i.audioGroups)!=null&&c.some(F=>B.hasAudioGroup(F))||b===Te.SUBTITLE&&(h=i.subtitleGroups)!=null&&h.some(F=>B.hasSubtitleGroup(F))||S&&i.audioCodec===B.audioCodec||!S&&i.audioCodec!==B.audioCodec||R&&i.codecSet===B.codecSet)continue}g=O;break}}if(g>-1&&n.loadLevel!==g)return e.levelRetry=!0,this.playlistError=0,{action:wn.SendAlternateToPenaltyBox,flags:Gs.None,nextAutoLevel:g}}return{action:wn.SendAlternateToPenaltyBox,flags:Gs.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case wn.DoNothing:break;case wn.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==Q.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i,hdcpLevel:a,nextAutoLevel:l}=n;switch(i){case Gs.None:this.switchLevel(e,l);break;case Gs.MoveAllAlternatesMatchingHDCP:a&&(t.maxHdcpLevel=Ap[Ap.indexOf(a)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,l)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===Q.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const n=BS(e.mimeType),i=this.hls.levels;for(let a=i.length;a--;)i[a][`${e.sourceBufferName}Codec`]===n&&this.hls.removeLevel(a)}}}function Sh(s){const e={action:wn.DoNothing,flags:Gs.None};return s&&(e.resolved=!0),e}var Xt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class n_{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.BUFFER_APPENDED,this.onBufferAppended,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this),e.on(T.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.BUFFER_APPENDED,this.onBufferAppended,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this),e.off(T.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let i=n.length;i--;){const a=n[i];if(!a)break;const l=a.end;if(a.start<=e&&l!==null&&e<=l)return a}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,n){const{fragments:i}=this,a=Object.keys(i);for(let l=a.length;l--;){const c=i[a[l]];if((c==null?void 0:c.body.type)===t&&(!n||c.buffered)){const h=c.body;if(h.start<=e&&e<=h.end)return h}}return null}detectEvictedFragments(e,t,n,i,a){this.timeRanges&&(this.timeRanges[e]=t);const l=(i==null?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(c=>{const h=this.fragments[c];if(!h||l>=h.body.sn)return;if(!h.buffered&&(!h.loaded||a)){h.body.type===n&&this.removeFragment(h.body);return}const f=h.range[e];if(f){if(f.time.length===0){this.removeFragment(h.body);return}f.time.some(g=>{const m=!this.isTimeBuffered(g.startPTS,g.endPTS,t);return m&&this.removeFragment(h.body),m})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const n=e.frag,i=_o(n),a=this.fragments[i];if(!a||a.buffered&&n.gap)return;const l=!n.relurl;Object.keys(t).forEach(c=>{const h=n.elementaryStreams[c];if(!h)return;const f=t[c],g=l||h.partial===!0;a.range[c]=this.getBufferedTimes(n,e.part,g,f)}),a.loaded=null,Object.keys(a.range).length?(a.buffered=!0,(a.body.endList=n.endList||a.body.endList)&&(this.endListFragments[a.body.type]=a),S0(a)||this.removeParts(n.sn-1,n.type)):this.removeFragment(a.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=NE(n,i=>i.fragment.sn>=e))}fragBuffered(e,t){const n=_o(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){const a={time:[],partial:n},l=e.start,c=e.end,h=e.minEndPTS||c,f=e.maxStartPTS||l;for(let g=0;g<i.length;g++){const m=i.start(g)-this.bufferPadding,y=i.end(g)+this.bufferPadding;if(f>=m&&h<=y){a.time.push({startPTS:Math.max(l,i.start(g)),endPTS:Math.min(c,i.end(g))});break}else if(l<y&&c>m){const v=Math.max(l,i.start(g)),x=Math.min(c,i.end(g));x>v&&(a.partial=!0,a.time.push({startPTS:v,endPTS:x}))}else if(c<=m)break}return a}getPartialFragment(e){let t=null,n,i,a,l=0;const{bufferPadding:c,fragments:h}=this;return Object.keys(h).forEach(f=>{const g=h[f];g&&S0(g)&&(i=g.body.start-c,a=g.body.end+c,e>=i&&e<=a&&(n=Math.min(e-i,a-e),l<=n&&(t=g.body,l=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||S0(t))}getState(e){const t=_o(e),n=this.fragments[t];return n?n.buffered?S0(n)?Xt.PARTIAL:Xt.OK:Xt.APPENDING:Xt.NOT_LOADED}isTimeBuffered(e,t,n){let i,a;for(let l=0;l<n.length;l++){if(i=n.start(l)-this.bufferPadding,a=n.end(l)+this.bufferPadding,e>=i&&t<=a)return!0;if(t<=i)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const n=t.frag,i=t.part?null:t,a=_o(n);this.fragments[a]={body:n,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:a,type:l}=t;if(n.sn==="initSegment")return;const c=n.type;if(i){let f=this.activePartLists[c];f||(this.activePartLists[c]=f=[]),f.push(i)}this.timeRanges=a;const h=a[l];this.detectEvictedFragments(l,h,c,i)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=_o(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,n=Object.keys(t);if(!e)return n.length>0;for(let i=n.length;i--;){const a=t[n[i]];if((a==null?void 0:a.body.type)===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,i,a){i&&!this.hasGaps||Object.keys(this.fragments).forEach(l=>{const c=this.fragments[l];if(!c)return;const h=c.body;h.type!==n||i&&!h.gap||h.start<t&&h.end>e&&(c.buffered||a)&&this.removeFragment(h)})}removeFragment(e){const t=_o(e);e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const i=e.sn;this.activePartLists[e.type]=NE(n,a=>a.fragment.sn!==i)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e,t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const n=(e=this.hls)==null||(t=e.latestLevelDetails)==null?void 0:t.partList;n&&n.forEach(i=>i.clearElementaryStreamInfo())}}function S0(s){var e,t,n;return s.buffered&&(s.body.gap||((e=s.range.video)==null?void 0:e.partial)||((t=s.range.audio)==null?void 0:t.partial)||((n=s.range.audiovideo)==null?void 0:n.partial))}function _o(s){return`${s.type}_${s.level}_${s.sn}`}function NE(s,e){return s.filter(t=>{const n=e(t);return n||t.clearElementaryStreamInfo(),n})}var La={cbc:0,ctr:1};class s_{constructor(e,t,n){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=n}decrypt(e,t){switch(this.aesMode){case La.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case La.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function i_(s){const e=s.byteLength,t=e&&new DataView(s.buffer).getUint8(e-1);return t?s.slice(0,e-t):s}class r_{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=t.getUint32(i*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],a=n[1],l=n[2],c=n[3],h=this.invSubMix,f=h[0],g=h[1],m=h[2],y=h[3],v=new Uint32Array(256);let x=0,b=0,A=0;for(A=0;A<256;A++)A<128?v[A]=A<<1:v[A]=A<<1^283;for(A=0;A<256;A++){let S=b^b<<1^b<<2^b<<3^b<<4;S=S>>>8^S&255^99,e[x]=S,t[S]=x;const k=v[x],R=v[k],_=v[R];let C=v[S]*257^S*16843008;i[x]=C<<24|C>>>8,a[x]=C<<16|C>>>16,l[x]=C<<8|C>>>24,c[x]=C,C=_*16843009^R*65537^k*257^x*16843008,f[S]=C<<24|C>>>8,g[S]=C<<16|C>>>16,m[S]=C<<8|C>>>24,y[S]=C,x?(x=k^v[v[v[_^k]]],b^=v[v[b]]):x=b=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;for(;i<t.length&&n;)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const a=this.keySize=t.length;if(a!==4&&a!==6&&a!==8)throw new Error("Invalid aes key size="+a);const l=this.ksRows=(a+6+1)*4;let c,h;const f=this.keySchedule=new Uint32Array(l),g=this.invKeySchedule=new Uint32Array(l),m=this.sBox,y=this.rcon,v=this.invSubMix,x=v[0],b=v[1],A=v[2],S=v[3];let k,R;for(c=0;c<l;c++){if(c<a){k=f[c]=t[c];continue}R=k,c%a===0?(R=R<<8|R>>>24,R=m[R>>>24]<<24|m[R>>>16&255]<<16|m[R>>>8&255]<<8|m[R&255],R^=y[c/a|0]<<24):a>6&&c%a===4&&(R=m[R>>>24]<<24|m[R>>>16&255]<<16|m[R>>>8&255]<<8|m[R&255]),f[c]=k=(f[c-a]^R)>>>0}for(h=0;h<l;h++)c=l-h,h&3?R=f[c]:R=f[c-4],h<4||c<=4?g[h]=R:g[h]=x[m[R>>>24]]^b[m[R>>>16&255]]^A[m[R>>>8&255]]^S[m[R&255]],g[h]=g[h]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,a=this.invKeySchedule,l=this.invSBox,c=this.invSubMix,h=c[0],f=c[1],g=c[2],m=c[3],y=this.uint8ArrayToUint32Array_(n);let v=y[0],x=y[1],b=y[2],A=y[3];const S=new Int32Array(e),k=new Int32Array(S.length);let R,_,C,U,O,B,F,M,j,ae,ye,pe,W,G;const te=this.networkToHostOrderSwap;for(;t<S.length;){for(j=te(S[t]),ae=te(S[t+1]),ye=te(S[t+2]),pe=te(S[t+3]),O=j^a[0],B=pe^a[1],F=ye^a[2],M=ae^a[3],W=4,G=1;G<i;G++)R=h[O>>>24]^f[B>>16&255]^g[F>>8&255]^m[M&255]^a[W],_=h[B>>>24]^f[F>>16&255]^g[M>>8&255]^m[O&255]^a[W+1],C=h[F>>>24]^f[M>>16&255]^g[O>>8&255]^m[B&255]^a[W+2],U=h[M>>>24]^f[O>>16&255]^g[B>>8&255]^m[F&255]^a[W+3],O=R,B=_,F=C,M=U,W=W+4;R=l[O>>>24]<<24^l[B>>16&255]<<16^l[F>>8&255]<<8^l[M&255]^a[W],_=l[B>>>24]<<24^l[F>>16&255]<<16^l[M>>8&255]<<8^l[O&255]^a[W+1],C=l[F>>>24]<<24^l[M>>16&255]<<16^l[O>>8&255]<<8^l[B&255]^a[W+2],U=l[M>>>24]<<24^l[O>>16&255]<<16^l[B>>8&255]<<8^l[F&255]^a[W+3],k[t]=te(R^v),k[t+1]=te(U^x),k[t+2]=te(C^b),k[t+3]=te(_^A),v=j,x=ae,b=ye,A=pe,t=t+4}return k.buffer}}class a_{constructor(e,t,n){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=n}expandKey(){const e=l_(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function l_(s){switch(s){case La.cbc:return"AES-CBC";case La.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${s}`)}}const o_=16;class _y{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?i_(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n,i){return this.useSoftware?new Promise((a,l)=>{const c=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(c,t,n,i);const h=this.flush();h?a(h.buffer):l(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n,i)}softwareDecrypt(e,t,n,i){const{currentIV:a,currentResult:l,remainderData:c}=this;if(i!==La.cbc||t.byteLength!==16)return Je.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),c&&(e=Cs(c,e),this.remainderData=null);const h=this.getValidChunk(e);if(!h.length)return null;a&&(n=a);let f=this.softwareDecrypter;f||(f=this.softwareDecrypter=new r_),f.expandKey(t);const g=l;return this.currentResult=f.decrypt(h.buffer,0,n),this.currentIV=h.slice(-16).buffer,g||null}webCryptoDecrypt(e,t,n,i){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n,i));this.key=t,this.fastAesKey=new a_(this.subtle,t,i)}return this.fastAesKey.expandKey().then(a=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new s_(this.subtle,new Uint8Array(n),i).decrypt(e.buffer,a)):Promise.reject(new Error("web crypto not initialized"))).catch(a=>(Je.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${a.name}: ${a.message}`),this.onWebCryptoError(e,t,n,i)))}onWebCryptoError(e,t,n,i){const a=this.enableSoftwareAES;if(a){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n,i);const l=this.flush();if(l)return l.buffer}throw new Error("WebCrypto"+(a?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%o_;return n!==e.length&&(t=e.slice(0,n),this.remainderData=e.slice(n)),t}logOnce(e){this.logEnabled&&(Je.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const BE=Math.pow(2,17);class c_{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new Zi({type:Re.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const i=this.config,a=i.fLoader,l=i.loader;return new Promise((c,h)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(x=>x[0]==="GAP")){h(FE(e));return}else e.gap=!1;const f=this.loader=a?new a(i):new l(i),g=UE(e);e.loader=f;const m=PE(i.fragLoadPolicy.default),y={loadPolicy:m,timeout:m.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:BE};e.stats=f.stats;const v={onSuccess:(x,b,A,S)=>{this.resetLoader(e,f);let k=x.data;A.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(k.slice(0,16)),k=k.slice(16)),c({frag:e,part:null,payload:k,networkDetails:S})},onError:(x,b,A,S)=>{this.resetLoader(e,f),h(new Zi({type:Re.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:lt({url:n,data:void 0},x),error:new Error(`HTTP Error ${x.code} ${x.text}`),networkDetails:A,stats:S}))},onAbort:(x,b,A)=>{this.resetLoader(e,f),h(new Zi({type:Re.NETWORK_ERROR,details:Q.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:A,stats:x}))},onTimeout:(x,b,A)=>{this.resetLoader(e,f),h(new Zi({type:Re.NETWORK_ERROR,details:Q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${y.timeout}ms`),networkDetails:A,stats:x}))}};t&&(v.onProgress=(x,b,A,S)=>t({frag:e,part:null,payload:A,networkDetails:S})),f.load(g,y,v)})}loadPart(e,t,n){this.abort();const i=this.config,a=i.fLoader,l=i.loader;return new Promise((c,h)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){h(FE(e,t));return}const f=this.loader=a?new a(i):new l(i),g=UE(e,t);e.loader=f;const m=PE(i.fragLoadPolicy.default),y={loadPolicy:m,timeout:m.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:BE};t.stats=f.stats,f.load(g,y,{onSuccess:(v,x,b,A)=>{this.resetLoader(e,f),this.updateStatsFromPart(e,t);const S={frag:e,part:t,payload:v.data,networkDetails:A};n(S),c(S)},onError:(v,x,b,A)=>{this.resetLoader(e,f),h(new Zi({type:Re.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:lt({url:g.url,data:void 0},v),error:new Error(`HTTP Error ${v.code} ${v.text}`),networkDetails:b,stats:A}))},onAbort:(v,x,b)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,f),h(new Zi({type:Re.NETWORK_ERROR,details:Q.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:b,stats:v}))},onTimeout:(v,x,b)=>{this.resetLoader(e,f),h(new Zi({type:Re.NETWORK_ERROR,details:Q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${y.timeout}ms`),networkDetails:b,stats:v}))}})})}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,a=i.total;if(n.loaded+=i.loaded,a){const h=Math.round(e.duration/t.duration),f=Math.min(Math.round(n.loaded/a),h),m=(h-f)*Math.round(n.loaded/f);n.total=n.loaded+m}else n.total=Math.max(n.loaded,n.total);const l=n.loading,c=i.loading;l.start?l.first+=c.first-c.start:(l.start=c.start,l.first=c.first),l.end=c.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function UE(s,e=null){const t=e||s,n={frag:s,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},i=t.byteRangeStartOffset,a=t.byteRangeEndOffset;if(Ee(i)&&Ee(a)){var l;let c=i,h=a;if(s.sn==="initSegment"&&u_((l=s.decryptdata)==null?void 0:l.method)){const f=a-i;f%16&&(h=a+(16-f%16)),i!==0&&(n.resetIV=!0,c=i-16)}n.rangeStart=c,n.rangeEnd=h}return n}function FE(s,e){const t=new Error(`GAP ${s.gap?"tag":"attribute"} found`),n={type:Re.MEDIA_ERROR,details:Q.FRAG_GAP,fatal:!1,frag:s,error:t,networkDetails:null};return e&&(n.part=e),(e||s).stats.aborted=!0,new Zi(n)}function u_(s){return s==="AES-128"||s==="AES-256"}class Zi extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class zS extends Lr{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Oy{constructor(e,t,n,i=0,a=-1,l=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=T0(),this.buffering={audio:T0(),video:T0(),audiovideo:T0()},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=a,this.partial=l}}function T0(){return{start:0,executeStart:0,executeEnd:0,end:0}}const GE={length:0,start:()=>0,end:()=>0};class ze{static isBuffered(e,t){if(e){const n=ze.getBuffered(e);for(let i=n.length;i--;)if(t>=n.start(i)&&t<=n.end(i))return!0}return!1}static bufferedRanges(e){if(e){const t=ze.getBuffered(e);return ze.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}static bufferInfo(e,t,n){if(e){const i=ze.bufferedRanges(e);if(i.length)return ze.bufferedInfo(i,t,n)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.length>1&&e.sort((g,m)=>g.start-m.start||m.end-g.end);let i=-1,a=[];if(n)for(let g=0;g<e.length;g++){t>=e[g].start&&t<=e[g].end&&(i=g);const m=a.length;if(m){const y=a[m-1].end;e[g].start-y<n?e[g].end>y&&(a[m-1].end=e[g].end):a.push(e[g])}else a.push(e[g])}else a=e;let l=0,c,h=t,f=t;for(let g=0;g<a.length;g++){const m=a[g].start,y=a[g].end;if(i===-1&&t>=m&&t<=y&&(i=g),t+n>=m&&t<y)h=m,f=y,l=f-t;else if(t+n<m){c=m;break}}return{len:l,start:h||0,end:f||0,nextStart:c,buffered:e,bufferedIndex:i}}static getBuffered(e){try{return e.buffered||GE}catch(t){return Je.log("failed to get media.buffered",t),GE}}}const VS=/\{\$([a-zA-Z0-9-_]+)\}/g;function $E(s){return VS.test(s)}function Sp(s,e){if(s.variableList!==null||s.hasVariableRefs){const t=s.variableList;return e.replace(VS,n=>{const i=n.substring(2,n.length-1),a=t==null?void 0:t[i];return a===void 0?(s.playlistParsingError||(s.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),n):a})}return e}function HE(s,e,t){let n=s.variableList;n||(s.variableList=n={});let i,a;if("QUERYPARAM"in e){i=e.QUERYPARAM;try{const l=new self.URL(t).searchParams;if(l.has(i))a=l.get(i);else throw new Error(`"${i}" does not match any query parameter in URI: "${t}"`)}catch(l){s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${l.message}`))}}else i=e.NAME,a=e.VALUE;i in n?s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):n[i]=a||""}function h_(s,e,t){const n=e.IMPORT;if(t&&n in t){let i=s.variableList;i||(s.variableList=i={}),i[n]=t[n]}else s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}const f_=/^(\d+)x(\d+)$/,zE=/(.+?)=(".*?"|.*?)(?:,|$)/g;class kt{constructor(e,t){typeof e=="string"&&(e=kt.parseAttrList(e,t)),ht(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let i=0;i<t.length/2;i++)n[i]=parseInt(t.slice(i*2,i*2+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const n=this[e];return(n?n.split(/[ ,]+/):[]).reduce((i,a)=>(i[a.toLowerCase()]=!0,i),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=f_.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let n;const i={},a='"';for(zE.lastIndex=0;(n=zE.exec(e))!==null;){const l=n[1].trim();let c=n[2];const h=c.indexOf(a)===0&&c.lastIndexOf(a)===c.length-1;let f=!1;if(h)c=c.slice(1,-1);else switch(l){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":f=!0}if(t&&(h||f))c=Sp(t,c);else if(!f&&!h)switch(l){case"CLOSED-CAPTIONS":if(c==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Je.warn(`${e}: attribute ${l} is missing quotes`)}i[l]=c}return i}}const d_="com.apple.hls.interstitial";function g_(s){return s!=="ID"&&s!=="CLASS"&&s!=="CUE"&&s!=="START-DATE"&&s!=="DURATION"&&s!=="END-DATE"&&s!=="END-ON-NEXT"}function m_(s){return s==="SCTE35-OUT"||s==="SCTE35-IN"||s==="SCTE35-CMD"}class KS{constructor(e,t,n=0){var i;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(t==null?void 0:t.tagAnchor)||null,this.tagOrder=(i=t==null?void 0:t.tagOrder)!=null?i:n,t){const a=t.attr;for(const l in a)if(Object.prototype.hasOwnProperty.call(e,l)&&e[l]!==a[l]){Je.warn(`DATERANGE tag attribute: "${l}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=l;break}e=ht(new kt({}),a,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const a=(t==null?void 0:t.endDate)||new Date(this.attr["END-DATE"]);Ee(a.getTime())&&(this._endDate=a)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(Je.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Ee(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===d_}get isValid(){return!!this.id&&!this._badValueForSameId&&Ee(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const p_=10;class y_{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}get hasProgramDateTime(){return this.fragments.length?Ee(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||p_}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let n=e.length;n--;)if(e[n].index>t)return e[n].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Xo(s){return s==="AES-128"||s==="AES-256"||s==="AES-256-CTR"}function My(s){switch(s){case"AES-128":case"AES-256":return La.cbc;case"AES-256-CTR":return La.ctr;default:throw new Error(`invalid full segment method ${s}`)}}function Py(s){return Uint8Array.from(atob(s),e=>e.charCodeAt(0))}function Tp(s){return Uint8Array.from(unescape(encodeURIComponent(s)),e=>e.charCodeAt(0))}function v_(s){const e=Tp(s).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function x_(s){const e=function(n,i,a){const l=n[i];n[i]=n[a],n[a]=l};e(s,0,3),e(s,1,2),e(s,4,5),e(s,6,7)}function E_(s){const e=s.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),i=n[n.length-1].split(",");if(i.length===2){const a=i[0]==="base64",l=i[1];a?(n.splice(-1,1),t=Py(l)):t=v_(l)}}return t}const bd=typeof self<"u"?self:void 0;var ot={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Vn={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Cm(s){switch(s){case Vn.FAIRPLAY:return ot.FAIRPLAY;case Vn.PLAYREADY:return ot.PLAYREADY;case Vn.WIDEVINE:return ot.WIDEVINE;case Vn.CLEARKEY:return ot.CLEARKEY}}var w0={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function _m(s){if(s===w0.WIDEVINE)return ot.WIDEVINE;if(s===w0.PLAYREADY)return ot.PLAYREADY;if(s===w0.CENC||s===w0.CLEARKEY)return ot.CLEARKEY}function Om(s){switch(s){case ot.FAIRPLAY:return Vn.FAIRPLAY;case ot.PLAYREADY:return Vn.PLAYREADY;case ot.WIDEVINE:return Vn.WIDEVINE;case ot.CLEARKEY:return Vn.CLEARKEY}}function R0(s){const{drmSystems:e,widevineLicenseUrl:t}=s,n=e?[ot.FAIRPLAY,ot.WIDEVINE,ot.PLAYREADY,ot.CLEARKEY].filter(i=>!!e[i]):[];return!n[ot.WIDEVINE]&&t&&n.push(ot.WIDEVINE),n}const YS=function(s){return bd!=null&&(s=bd.navigator)!=null&&s.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function b_(s,e,t,n){let i;switch(s){case ot.FAIRPLAY:i=["cenc","sinf"];break;case ot.WIDEVINE:case ot.PLAYREADY:i=["cenc"];break;case ot.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${s}`)}return A_(i,e,t,n)}function A_(s,e,t,n){return[{initDataTypes:s,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(a=>({contentType:`audio/mp4; codecs=${a}`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(a=>({contentType:`video/mp4; codecs=${a}`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function S_(s){var e;return s.sessionType==="persistent-license"||!!((e=s.sessionTypes)!=null&&e.some(t=>t==="persistent-license"))}function jS(s){const e=new Uint16Array(s.buffer,s.byteOffset,s.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),n=t.substring(t.indexOf("<"),t.length),l=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(l){const c=l.childNodes[0]?l.childNodes[0].nodeValue:l.getAttribute("VALUE");if(c){const h=Py(c).subarray(0,16);return x_(h),h}}return null}let L0={};class Th{static clearKeyUriToKeyIdMap(){L0={}}constructor(e,t,n,i=[1],a=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=a,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!Xo(e)}isSupported(){if(this.method){if(Xo(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Vn.FAIRPLAY:case Vn.WIDEVINE:case Vn.PLAYREADY:case Vn.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(Xo(this.method)&&this.uri&&!this.iv){typeof e!="number"&&(Je.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=T_(e);return new Th(this.method,this.uri,"identity",this.keyFormatVersions,n)}const t=E_(this.uri);if(t)switch(this.keyFormat){case Vn.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Vn.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=IC(n,null,t),this.keyId=jS(t);break}default:{let n=t.subarray(0,16);if(n.length!==16){const i=new Uint8Array(16);i.set(n,16-n.length),n=i}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=L0[this.uri];if(!n){const i=Object.keys(L0).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,i),L0[this.uri]=n}this.keyId=n}return this}}function T_(s){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=s>>8*(15-t)&255;return e}const VE=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,KE=/#EXT-X-MEDIA:(.*)/g,w_=/^#EXT(?:INF|-X-TARGETDURATION):/m,Mm=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),R_=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class wi{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static resolve(e,t){return Ly.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return w_.test(e)}static parseMasterPlaylist(e,t){const n=$E(e),i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},a=[];VE.lastIndex=0;let l;for(;(l=VE.exec(e))!=null;)if(l[1]){var c;const f=new kt(l[1],i),g=Sp(i,l[2]),m={attrs:f,bitrate:f.decimalInteger("BANDWIDTH")||f.decimalInteger("AVERAGE-BANDWIDTH"),name:f.NAME,url:wi.resolve(g,t)},y=f.decimalResolution("RESOLUTION");y&&(m.width=y.width,m.height=y.height),QE(f.CODECS,m);const v=f["SUPPLEMENTAL-CODECS"];v&&(m.supplemental={},QE(v,m.supplemental)),(c=m.unknownCodecs)!=null&&c.length||a.push(m),i.levels.push(m)}else if(l[3]){const f=l[3],g=l[4];switch(f){case"SESSION-DATA":{const m=new kt(g,i),y=m["DATA-ID"];y&&(i.sessionData===null&&(i.sessionData={}),i.sessionData[y]=m);break}case"SESSION-KEY":{const m=YE(g,t,i);m.encrypted&&m.isSupported()?(i.sessionKeys===null&&(i.sessionKeys=[]),i.sessionKeys.push(m)):Je.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${g}"`);break}case"DEFINE":{{const m=new kt(g,i);HE(i,m,t)}break}case"CONTENT-STEERING":{const m=new kt(g,i);i.contentSteering={uri:wi.resolve(m["SERVER-URI"],t),pathwayId:m["PATHWAY-ID"]||"."};break}case"START":{i.startTimeOffset=jE(g);break}}}const h=a.length>0&&a.length<i.levels.length;return i.levels=h?a:i.levels,i.levels.length===0&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,t,n){let i;const a={},l=n.levels,c={AUDIO:l.map(f=>({id:f.attrs.AUDIO,audioCodec:f.audioCodec})),SUBTITLES:l.map(f=>({id:f.attrs.SUBTITLES,textCodec:f.textCodec})),"CLOSED-CAPTIONS":[]};let h=0;for(KE.lastIndex=0;(i=KE.exec(e))!==null;){const f=new kt(i[1],n),g=f.TYPE;if(g){const m=c[g],y=a[g]||[];a[g]=y;const v=f.LANGUAGE,x=f["ASSOC-LANGUAGE"],b=f.CHANNELS,A=f.CHARACTERISTICS,S=f["INSTREAM-ID"],k={attrs:f,bitrate:0,id:h++,groupId:f["GROUP-ID"]||"",name:f.NAME||v||"",type:g,default:f.bool("DEFAULT"),autoselect:f.bool("AUTOSELECT"),forced:f.bool("FORCED"),lang:v,url:f.URI?wi.resolve(f.URI,t):""};if(x&&(k.assocLang=x),b&&(k.channels=b),A&&(k.characteristics=A),S&&(k.instreamId=S),m!=null&&m.length){const R=wi.findGroup(m,k.groupId)||m[0];qE(k,R,"audioCodec"),qE(k,R,"textCodec")}y.push(k)}}return a}static parseLevelPlaylist(e,t,n,i,a,l){var c;const h={url:t},f=new y_(t),g=f.fragments,m=[];let y=null,v=0,x=0,b=0,A=0,S=0,k=null,R=new Lm(i,h),_,C,U,O=-1,B=!1,F=null,M;if(Mm.lastIndex=0,f.m3u8=e,f.hasVariableRefs=$E(e),((c=Mm.exec(e))==null?void 0:c[0])!=="#EXTM3U")return f.playlistParsingError=new Error("Missing format identifier #EXTM3U"),f;for(;(_=Mm.exec(e))!==null;){B&&(B=!1,R=new Lm(i,h),R.playlistOffset=b,R.start=b,R.sn=v,R.cc=A,S&&(R.bitrate=S),R.level=n,y&&(R.initSegment=y,y.rawProgramDateTime&&(R.rawProgramDateTime=y.rawProgramDateTime,y.rawProgramDateTime=null),F&&(R.setByteRange(F),F=null)));const pe=_[1];if(pe){R.duration=parseFloat(pe);const W=(" "+_[2]).slice(1);R.title=W||null,R.tagList.push(W?["INF",pe,W]:["INF",pe])}else if(_[3]){if(Ee(R.duration)){R.playlistOffset=b,R.start=b,U&&WE(R,U,f),R.sn=v,R.level=n,R.cc=A,g.push(R);const W=(" "+_[3]).slice(1);R.relurl=Sp(f,W),wp(R,k,m),k=R,b+=R.duration,v++,x=0,B=!0}}else{if(_=_[0].match(R_),!_){Je.warn("No matches on slow regex match for level playlist!");continue}for(C=1;C<_.length&&_[C]===void 0;C++);const W=(" "+_[C]).slice(1),G=(" "+_[C+1]).slice(1),te=_[C+2]?(" "+_[C+2]).slice(1):null;switch(W){case"BYTERANGE":k?R.setByteRange(G,k):R.setByteRange(G);break;case"PROGRAM-DATE-TIME":R.rawProgramDateTime=G,R.tagList.push(["PROGRAM-DATE-TIME",G]),O===-1&&(O=g.length);break;case"PLAYLIST-TYPE":f.type&&Qi(f,W,_),f.type=G.toUpperCase();break;case"MEDIA-SEQUENCE":f.startSN!==0?Qi(f,W,_):g.length>0&&ZE(f,W,_),v=f.startSN=parseInt(G);break;case"SKIP":{f.skippedSegments&&Qi(f,W,_);const se=new kt(G,f),Z=se.decimalInteger("SKIPPED-SEGMENTS");if(Ee(Z)){f.skippedSegments+=Z;for(let V=Z;V--;)g.push(null);v+=Z}const I=se.enumeratedString("RECENTLY-REMOVED-DATERANGES");I&&(f.recentlyRemovedDateranges=(f.recentlyRemovedDateranges||[]).concat(I.split("	")));break}case"TARGETDURATION":f.targetduration!==0&&Qi(f,W,_),f.targetduration=Math.max(parseInt(G),1);break;case"VERSION":f.version!==null&&Qi(f,W,_),f.version=parseInt(G);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":f.live||Qi(f,W,_),f.live=!1;break;case"#":(G||te)&&R.tagList.push(te?[G,te]:[G]);break;case"DISCONTINUITY":A++,R.tagList.push(["DIS"]);break;case"GAP":R.gap=!0,R.tagList.push([W]);break;case"BITRATE":R.tagList.push([W,G]),S=parseInt(G)*1e3,Ee(S)?R.bitrate=S:S=0;break;case"DATERANGE":{const se=new kt(G,f),Z=new KS(se,f.dateRanges[se.ID],f.dateRangeTagCount);f.dateRangeTagCount++,Z.isValid||f.skippedSegments?f.dateRanges[Z.id]=Z:Je.warn(`Ignoring invalid DATERANGE tag: "${G}"`),R.tagList.push(["EXT-X-DATERANGE",G]);break}case"DEFINE":{{const se=new kt(G,f);"IMPORT"in se?h_(f,se,l):HE(f,se,t)}break}case"DISCONTINUITY-SEQUENCE":f.startCC!==0?Qi(f,W,_):g.length>0&&ZE(f,W,_),f.startCC=A=parseInt(G);break;case"KEY":{const se=YE(G,t,f);if(se.isSupported()){if(se.method==="NONE"){U=void 0;break}U||(U={}),U[se.keyFormat]&&(U=ht({},U)),U[se.keyFormat]=se}else Je.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${G}"`);break}case"START":f.startTimeOffset=jE(G);break;case"MAP":{const se=new kt(G,f);if(R.duration){const Z=new Lm(i,h);XE(Z,se,n,U),y=Z,R.initSegment=y,y.rawProgramDateTime&&!R.rawProgramDateTime&&(R.rawProgramDateTime=y.rawProgramDateTime)}else{const Z=R.byteRangeEndOffset;if(Z){const I=R.byteRangeStartOffset;F=`${Z-I}@${I}`}else F=null;XE(R,se,n,U),y=R,B=!0}y.cc=A;break}case"SERVER-CONTROL":{M&&Qi(f,W,_),M=new kt(G),f.canBlockReload=M.bool("CAN-BLOCK-RELOAD"),f.canSkipUntil=M.optionalFloat("CAN-SKIP-UNTIL",0),f.canSkipDateRanges=f.canSkipUntil>0&&M.bool("CAN-SKIP-DATERANGES"),f.partHoldBack=M.optionalFloat("PART-HOLD-BACK",0),f.holdBack=M.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{f.partTarget&&Qi(f,W,_);const se=new kt(G);f.partTarget=se.decimalFloatingPoint("PART-TARGET");break}case"PART":{let se=f.partList;se||(se=f.partList=[]);const Z=x>0?se[se.length-1]:void 0,I=x++,V=new kt(G,f),ie=new gC(V,R,h,I,Z);se.push(ie),R.duration+=ie.duration;break}case"PRELOAD-HINT":{const se=new kt(G,f);f.preloadHint=se;break}case"RENDITION-REPORT":{const se=new kt(G,f);f.renditionReports=f.renditionReports||[],f.renditionReports.push(se);break}default:Je.warn(`line parsed but not handled: ${_}`);break}}}k&&!k.relurl?(g.pop(),b-=k.duration,f.partList&&(f.fragmentHint=k)):f.partList&&(wp(R,k,m),R.cc=A,f.fragmentHint=R,U&&WE(R,U,f)),f.targetduration||(f.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const j=g.length,ae=g[0],ye=g[j-1];if(b+=f.skippedSegments*f.targetduration,b>0&&j&&ye){f.averagetargetduration=b/j;const pe=ye.sn;f.endSN=pe!=="initSegment"?pe:0,f.live||(ye.endList=!0),ae&&f.startCC===void 0&&(f.startCC=ae.cc),O>0&&(k_(g,O),ae&&m.unshift(ae))}else f.endSN=0,f.startCC=0;return f.fragmentHint&&(b+=f.fragmentHint.duration),f.totalduration=b,m.length&&f.dateRangeTagCount&&ae&&QS(m,f),f.endCC=A,f}}function QS(s,e){const t=s.length,n=s[t-1],i=e.live?1/0:e.totalduration,a=Object.keys(e.dateRanges);for(let l=a.length;l--;){const c=e.dateRanges[a[l]],h=c.startDate.getTime();c.tagAnchor=n.ref;for(let f=t;f--;){const g=L_(e,h,s,f,i);if(g!==-1){c.tagAnchor=e.fragments[g].ref;break}}}}function L_(s,e,t,n,i){const a=t[n];if(a){const c=a.programDateTime;if(e>=c||n===0){var l;const h=(((l=t[n+1])==null?void 0:l.start)||i)-a.start;if(e<=c+h*1e3){const f=t[n].sn-s.startSN,g=s.fragments;if(g.length>t.length){const y=(t[n+1]||g[g.length-1]).sn-s.startSN;for(let v=y;v>f;v--){const x=g[v].programDateTime;if(e>=x&&e<x+g[v].duration*1e3)return v}}return f}}}return-1}function YE(s,e,t){var n,i;const a=new kt(s,t),l=(n=a.METHOD)!=null?n:"",c=a.URI,h=a.hexadecimalInteger("IV"),f=a.KEYFORMATVERSIONS,g=(i=a.KEYFORMAT)!=null?i:"identity";c&&a.IV&&!h&&Je.error(`Invalid IV: ${a.IV}`);const m=c?wi.resolve(c,e):"",y=(f||"1").split("/").map(Number).filter(Number.isFinite);return new Th(l,m,g,y,h)}function jE(s){const t=new kt(s).decimalFloatingPoint("TIME-OFFSET");return Ee(t)?t:null}function QE(s,e){let t=(s||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const i=t.filter(a=>PS(a,n));i.length&&(e[`${n}Codec`]=i.map(a=>a.split("/")[0]).join(","),t=t.filter(a=>i.indexOf(a)===-1))}),e.unknownCodecs=t}function qE(s,e,t){const n=e[t];n&&(s[t]=n)}function k_(s,e){let t=s[e];for(let n=e;n--;){const i=s[n];if(!i)return;i.programDateTime=t.programDateTime-i.duration*1e3,t=i}}function wp(s,e,t){s.rawProgramDateTime?t.push(s):e!=null&&e.programDateTime&&(s.programDateTime=e.endProgramDateTime)}function XE(s,e,t,n){s.relurl=e.URI,e.BYTERANGE&&s.setByteRange(e.BYTERANGE),s.level=t,s.sn="initSegment",n&&(s.levelkeys=n),s.initSegment=null}function WE(s,e,t){s.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(i=>e[i].isCommonEncryption)&&n.push(s)}function Qi(s,e,t){s.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function ZE(s,e,t){s.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function Pm(s,e){const t=e.startPTS;if(Ee(t)){let n=0,i;e.sn>s.sn?(n=t-s.start,i=s):(n=s.start-t,i=e),i.duration!==n&&i.setDuration(n)}else e.sn>s.sn?s.cc===e.cc&&s.minEndPTS?e.setStart(s.start+(s.minEndPTS-s.start)):e.setStart(s.start+s.duration):e.setStart(Math.max(s.start-e.duration,0))}function qS(s,e,t,n,i,a){n-t<=0&&(Je.warn("Fragment should have a positive duration",e),n=t+e.duration,a=i+e.duration);let c=t,h=n;const f=e.startPTS,g=e.endPTS;if(Ee(f)){const A=Math.abs(f-t);Ee(e.deltaPTS)?e.deltaPTS=Math.max(A,e.deltaPTS):e.deltaPTS=A,c=Math.max(t,f),t=Math.min(t,f),i=Math.min(i,e.startDTS),h=Math.min(n,g),n=Math.max(n,g),a=Math.max(a,e.endDTS)}const m=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(n-e.start),e.startPTS=t,e.maxStartPTS=c,e.startDTS=i,e.endPTS=n,e.minEndPTS=h,e.endDTS=a;const y=e.sn;if(!s||y<s.startSN||y>s.endSN)return 0;let v;const x=y-s.startSN,b=s.fragments;for(b[x]=e,v=x;v>0;v--)Pm(b[v],b[v-1]);for(v=x;v<b.length-1;v++)Pm(b[v],b[v+1]);return s.fragmentHint&&Pm(b[b.length-1],s.fragmentHint),s.PTSKnown=s.alignedSliding=!0,m}function I_(s,e){if(s===e)return;let t=null;const n=s.fragments;for(let h=n.length-1;h>=0;h--){const f=n[h].initSegment;if(f){t=f;break}}s.fragmentHint&&delete s.fragmentHint.endPTS;let i;__(s,e,(h,f,g,m)=>{if(!e.startCC&&f.cc!==h.cc){var y,v;const x=h.cc-f.cc;for(let b=g;b<m.length;b++)m[b].cc+=x;e.startCC=(y=(v=ZS(s,e.startSN-1))==null?void 0:v.cc)!=null?y:m[0].cc,e.endCC=m[m.length-1].cc}Ee(h.startPTS)&&Ee(h.endPTS)&&(f.setStart(f.startPTS=h.startPTS),f.startDTS=h.startDTS,f.maxStartPTS=h.maxStartPTS,f.endPTS=h.endPTS,f.endDTS=h.endDTS,f.minEndPTS=h.minEndPTS,f.setDuration(h.endPTS-h.startPTS),f.duration&&(i=f),e.PTSKnown=e.alignedSliding=!0),h.hasStreams&&(f.elementaryStreams=h.elementaryStreams),f.loader=h.loader,h.hasStats&&(f.stats=h.stats),h.initSegment&&(f.initSegment=h.initSegment,t=h.initSegment)});const a=e.fragments,l=e.fragmentHint?a.concat(e.fragmentHint):a;if(t&&l.forEach(h=>{var f;h&&(!h.initSegment||h.initSegment.relurl===((f=t)==null?void 0:f.relurl))&&(h.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=a.some(h=>!h),e.deltaUpdateFailed){Je.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let h=e.skippedSegments;h--;)a.shift();e.startSN=a[0].sn}else{e.endCC=a[a.length-1].cc,e.canSkipDateRanges&&(e.dateRanges=D_(s.dateRanges,e));const h=s.fragments.filter(f=>f.rawProgramDateTime);if(s.hasProgramDateTime&&!e.hasProgramDateTime)for(let f=1;f<l.length;f++)l[f].programDateTime===null&&wp(l[f],l[f-1],h);QS(h,e)}C_(s.partList,e.partList,(h,f)=>{f.elementaryStreams=h.elementaryStreams,f.stats=h.stats}),i?qS(e,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):XS(s,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=s.driftStartTime,e.driftStart=s.driftStart;const c=e.advancedDateTime;if(e.advanced&&c){const h=e.edge;e.driftStart||(e.driftStartTime=c,e.driftStart=h),e.driftEndTime=c,e.driftEnd=h}else e.driftEndTime=s.driftEndTime,e.driftEnd=s.driftEnd,e.advancedDateTime=s.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=s.requestScheduled)}function D_(s,e){const{dateRanges:t,recentlyRemovedDateranges:n}=e,i=ht({},s);n&&n.forEach(c=>{delete i[c]});const l=Object.keys(i).length;return l&&Object.keys(t).forEach(c=>{const h=i[c],f=new KS(t[c].attr,h);f.isValid?(i[c]=f,h||(f.tagOrder+=l)):Je.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${St(t[c].attr)}"`)}),i}function C_(s,e,t){if(s&&e){let n=0;for(let i=0,a=s.length;i<=a;i++){const l=s[i],c=e[i+n];l&&c&&l.index===c.index&&l.fragment.sn===c.fragment.sn?t(l,c):n--}}}function __(s,e,t){const n=e.skippedSegments,i=Math.max(s.startSN,e.startSN)-e.startSN,a=(s.fragmentHint?1:0)+(n?e.endSN:Math.min(s.endSN,e.endSN))-e.startSN,l=e.startSN-s.startSN,c=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,h=s.fragmentHint?s.fragments.concat(s.fragmentHint):s.fragments;for(let f=i;f<=a;f++){const g=h[l+f];let m=c[f];if(n&&!m&&g&&(m=e.fragments[f]=g),g&&m){if(t(g,m,f,c),g.url&&g.url!==m.url){e.playlistParsingError=JE(`media sequence mismatch ${m.sn}:`,s,e,g,m);return}else if(g.cc!==m.cc){e.playlistParsingError=JE(`discontinuity sequence mismatch (${g.cc}!=${m.cc})`,s,e,g,m);return}}}}function JE(s,e,t,n,i){return new Error(`${s} ${i.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function XS(s,e,t=!0){const n=e.startSN+e.skippedSegments-s.startSN,i=s.fragments,a=n>=0;let l=0;if(a&&n<i.length)l=i[n].start;else if(a&&e.startSN===s.endSN+1)l=s.fragmentEnd;else if(a&&t)l=s.fragmentStart+n*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)l=s.fragmentStart;else return;Rp(e,l)}function Rp(s,e){if(e){const t=s.fragments;for(let n=s.skippedSegments;n<t.length;n++)t[n].addStart(e);s.fragmentHint&&s.fragmentHint.addStart(e)}}function WS(s,e=1/0){let t=1e3*s.targetduration;if(s.updated){const n=s.fragments;if(n.length&&t*4>e){const a=n[n.length-1].duration*1e3;a<t&&(t=a)}}else t/=2;return Math.round(t)}function ZS(s,e,t){if(!s)return null;let n=s.fragments[e-s.startSN];return n||(n=s.fragmentHint,n&&n.sn===e)?n:e<s.startSN&&t&&t.sn===e?t:null}function eb(s,e,t){return s?JS(s.partList,e,t):null}function JS(s,e,t){if(s)for(let n=s.length;n--;){const i=s[n];if(i.index===t&&i.fragment.sn===e)return i}return null}function eT(s){s.forEach((e,t)=>{var n;(n=e.details)==null||n.fragments.forEach(i=>{i.level=t,i.initSegment&&(i.initSegment.level=t)})})}function mh(s,e){for(let n=0,i=s.length;n<i;n++){var t;if(((t=s[n])==null?void 0:t.cc)===e)return s[n]}return null}function O_(s,e){return!!(s&&e.startCC<s.endCC&&e.endCC>s.startCC)}function tb(s,e){if(s){const t=s.start+e;s.start=s.startPTS=t,s.endPTS=t+s.duration}}function tT(s,e){const t=e.fragments;for(let n=0,i=t.length;n<i;n++)tb(t[n],s);e.fragmentHint&&tb(e.fragmentHint,s),e.alignedSliding=!0}function M_(s,e){s&&(nT(e,s),!e.alignedSliding&&s&&Ad(e,s),!e.alignedSliding&&s&&!e.skippedSegments&&XS(s,e,!1))}function nT(s,e){if(!O_(e,s))return;const t=Math.min(e.endCC,s.endCC),n=mh(e.fragments,t),i=mh(s.fragments,t);if(!n||!i)return;Je.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const a=n.start-i.start;tT(a,s)}function Ad(s,e){if(!s.hasProgramDateTime||!e.hasProgramDateTime)return;const t=s.fragments,n=e.fragments;if(!t.length||!n.length)return;let i,a;const l=Math.min(e.endCC,s.endCC);e.startCC<l&&s.startCC<l&&(i=mh(n,l),a=mh(t,l)),(!i||!a)&&(i=n[Math.floor(n.length/2)],a=mh(t,i.cc)||t[Math.floor(t.length/2)]);const c=i.programDateTime,h=a.programDateTime;if(!c||!h)return;const f=(h-c)/1e3-(a.start-i.start);tT(f,s)}const P_={toString:function(s){let e="";const t=s.length;for(let n=0;n<t;n++)e+=`[${s.start(n).toFixed(3)}-${s.end(n).toFixed(3)}]`;return e}},oe={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Ny extends zS{constructor(e,t,n,i,a){super(i,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=oe.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:l,fragCurrent:c,media:h,mediaBuffer:f,state:g}=this,m=h?h.currentTime:0,y=ze.bufferInfo(f||h,m,l.maxBufferHole);if(this.log(`media seeking to ${Ee(m)?m.toFixed(3):m}, state: ${g}`),this.state===oe.ENDED)this.resetLoadingState();else if(c){const v=l.maxFragLookUpTolerance,x=c.start-v,b=c.start+c.duration+v;if(!y.len||b<y.start||x>y.end){const A=m>b;(m<x||A)&&(A&&c.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),c.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(h){this.fragmentTracker.removeFragmentsInRange(m,1/0,this.playlistType,!0);const v=this.lastCurrentTime;if(m>v&&(this.lastCurrentTime=m),!this.loadingParts){const x=Math.max(y.end,m),b=this.shouldLoadParts(this.getLevelDetails(),x);b&&(this.log(`LL-Part loading ON after seeking to ${m.toFixed(2)} with buffer @${x.toFixed(2)}`),this.loadingParts=b)}}!this.hls.hasEnoughToStart&&!y.len&&(this.log(`setting startPosition to ${m} because of seek before start`),this.nextLoadPosition=this.startPosition=m),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=a,this.hls=e,this.fragmentLoader=new c_(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new _y(e.config)}registerListeners(){const{hls:e}=this;e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(T.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===oe.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=oe.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const n=e.end||0,i=this.config.timelineOffset||0;if(n<=i)return!1;const a=e.nextStart;if(a&&a>i&&a<t.edge||this.media.currentTime<e.start)return!1;const c=t.partList;if(c!=null&&c.length){const f=c[c.length-1];return ze.isBuffered(this.media,f.start+f.duration/2)}const h=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(h)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;n.removeEventListener("seeking",this.onMediaSeeking),n.removeEventListener("ended",this.onMediaEnded),n.addEventListener("seeking",this.onMediaSeeking),n.addEventListener("ended",this.onMediaEnded);const i=this.config;this.levels&&i.autoStartLoad&&this.state===oe.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(e,t){const n=!!t.transferMedia,i=this.media;if(i!==null){if(i.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),i.removeEventListener("seeking",this.onMediaSeeking),i.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!n&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,n){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=oe.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this.startFragRequested=!0,this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const i=a=>{const l=a.frag;if(this.fragContextChanged(l)){this.warn(`${l.type} sn: ${l.sn}${a.part?" part: "+a.part.index:""} of ${this.fragInfo(l,!1,a.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(l);return}l.stats.chunkCount++,this._handleFragmentLoadProgress(a)};this._doFragLoad(e,t,n,i).then(a=>{if(!a)return;const l=this.state,c=a.frag;if(this.fragContextChanged(c)){(l===oe.FRAG_LOADING||!this.fragCurrent&&l===oe.PARSING)&&(this.fragmentTracker.removeFragment(c),this.state=oe.IDLE);return}"payload"in a&&(this.log(`Loaded ${c.type} sn: ${c.sn} of ${this.playlistLabel()} ${c.level}`),this.hls.trigger(T.FRAG_LOADED,a)),this._handleFragmentLoadComplete(a)}).catch(a=>{this.state===oe.STOPPED||this.state===oe.ERROR||(this.warn(`Frag error: ${(a==null?void 0:a.message)||a}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===Xt.APPENDING){const a=e.type,l=this.getFwdBufferInfo(this.mediaBuffer,a),c=Math.max(e.duration,l?l.len:this.config.maxBufferLength),h=this.backtrackFragment;((h?e.sn-h.sn:0)===1||this.reduceMaxBufferLength(c,e.duration))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Xt.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(t==null?void 0:t.live)&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:n};this.hls.trigger(T.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{const i=n==null?void 0:n.frag;if(!i||this.fragContextChanged(i)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:i}=this,{frag:a,payload:l}=n,c=a.decryptdata;if(l&&l.byteLength>0&&c!=null&&c.key&&c.iv&&Xo(c.method)){const h=self.performance.now();return this.decrypter.decrypt(new Uint8Array(l),c.key.buffer,c.iv.buffer,My(c.method)).catch(f=>{throw i.trigger(T.ERROR,{type:Re.MEDIA_ERROR,details:Q.FRAG_DECRYPT_ERROR,fatal:!1,error:f,reason:f.message,frag:a}),f}).then(f=>{const g=self.performance.now();return i.trigger(T.FRAG_DECRYPTED,{frag:a,payload:f,stats:{tstart:h,tdecrypt:g}}),n.payload=f,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===oe.STOPPED||this.state===oe.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state!==oe.STOPPED&&(this.state=oe.IDLE),e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const n=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${n?P_.toString(ze.getBuffered(n)):"(detached)"})`),ln(e)){var i;if(e.type!==Te.SUBTITLE){const l=e.elementaryStreams;if(!Object.keys(l).some(c=>!!l[c])){this.state=oe.IDLE;return}}const a=(i=this.levels)==null?void 0:i[e.level];a!=null&&a.fragmentError&&(this.log(`Resetting level fragment error count of ${a.fragmentError} on frag buffered`),a.fragmentError=0)}this.state=oe.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:a}=e,l=!a||a.length===0||a.some(h=>!h),c=new Oy(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!l);t.flush(c)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,i){var a;this.fragCurrent=e;const l=t==null?void 0:t.details;if(!this.levels||!l)throw new Error(`frag load aborted, missing level${l?"":" detail"}s`);let c=null;e.encrypted&&!((a=e.decryptdata)!=null&&a.key)?(this.log(`Loading key for ${e.sn} of [${l.startSN}-${l.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=oe.KEY_LOADING,this.fragCurrent=e,c=this.keyLoader.load(e).then(m=>{if(!this.fragContextChanged(m.frag))return this.hls.trigger(T.KEY_LOADED,m),this.state===oe.KEY_LOADING&&(this.state=oe.IDLE),m}),this.hls.trigger(T.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(c=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&l.encryptedFragments.length&&this.keyLoader.loadClear(e,l.encryptedFragments);const h=this.fragPrevious;if(ln(e)&&(!h||e.sn!==h.sn)){const m=this.shouldLoadParts(t.details,e.end);m!==this.loadingParts&&(this.log(`LL-Part loading ${m?"ON":"OFF"} loading sn ${h==null?void 0:h.sn}->${e.sn}`),this.loadingParts=m)}if(n=Math.max(e.start,n||0),this.loadingParts&&ln(e)){const m=l.partList;if(m&&i){n>e.end&&l.fragmentHint&&(e=l.fragmentHint);const y=this.getNextPart(m,e,n);if(y>-1){const v=m[y];e=this.fragCurrent=v.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${v.index} (${y}/${m.length-1}) of ${this.fragInfo(e,!1,v)}) cc: ${e.cc} [${l.startSN}-${l.endSN}], target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=v.start+v.duration,this.state=oe.FRAG_LOADING;let x;return c?x=c.then(b=>!b||this.fragContextChanged(b.frag)?null:this.doFragPartsLoad(e,v,t,i)).catch(b=>this.handleFragLoadError(b)):x=this.doFragPartsLoad(e,v,t,i).catch(b=>this.handleFragLoadError(b)),this.hls.trigger(T.FRAG_LOADING,{frag:e,part:v,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):x}else if(!e.url||this.loadedEndOfParts(m,n))return Promise.resolve(null)}}if(ln(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${n.toFixed(2)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${l?"["+l.startSN+"-"+l.endSN+"]":""}, target: ${parseFloat(n.toFixed(3))}`),Ee(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=oe.FRAG_LOADING;const f=this.config.progressive;let g;return f&&c?g=c.then(m=>!m||this.fragContextChanged(m==null?void 0:m.frag)?null:this.fragmentLoader.load(e,i)).catch(m=>this.handleFragLoadError(m)):g=Promise.all([this.fragmentLoader.load(e,f?i:void 0),c]).then(([m])=>(!f&&m&&i&&i(m),m)).catch(m=>this.handleFragLoadError(m)),this.hls.trigger(T.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):g}doFragPartsLoad(e,t,n,i){return new Promise((a,l)=>{var c;const h=[],f=(c=n.details)==null?void 0:c.partList,g=m=>{this.fragmentLoader.loadPart(e,m,i).then(y=>{h[m.index]=y;const v=y.part;this.hls.trigger(T.FRAG_LOADED,y);const x=eb(n.details,e.sn,m.index+1)||JS(f,e.sn,m.index+1);if(x)g(x);else return a({frag:e,part:v,partsLoaded:h})}).catch(l)};g(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===Q.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(T.ERROR,t)}else this.hls.trigger(T.ERROR,{type:Re.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==oe.PARSING){!this.fragCurrent&&this.state!==oe.STOPPED&&this.state!==oe.ERROR&&(this.state=oe.IDLE);return}const{frag:n,part:i,level:a}=t,l=self.performance.now();n.stats.parsing.end=l,i&&(i.stats.parsing.end=l);const c=this.getLevelDetails(),f=c&&n.sn>c.endSN||this.shouldLoadParts(c,n.end);f!==this.loadingParts&&(this.log(`LL-Part loading ${f?"ON":"OFF"} after parsing segment ending @${n.end.toFixed(2)}`),this.loadingParts=f),this.updateLevelTiming(n,i,a,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e!=null&&e.partList){var n;const a=e.partList[0],l=a.end+(((n=e.fragmentHint)==null?void 0:n.duration)||0);if(t>=l){var i;if((this.hls.hasEnoughToStart?((i=this.media)==null?void 0:i.currentTime)||this.lastCurrentTime:this.getLoadPosition())>a.start-a.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:a,part:l}=e;if(!(t!=null&&t[i]))return this.warn(`Levels object was unset while buffering fragment ${a} of ${this.playlistLabel()} ${i}. The current chunk will not be buffered.`),null;const c=t[i],h=c.details,f=l>-1?eb(h,a,l):null,g=f?f.fragment:ZS(h,a,n);return g?(n&&n!==g&&(g.stats=n.stats),{frag:g,part:f,level:c}):null}bufferFragmentData(e,t,n,i,a){var l;if(!e||this.state!==oe.PARSING)return;const{data1:c,data2:h}=e;let f=c;if(c&&h&&(f=Cs(c,h)),!((l=f)!=null&&l.length))return;const g={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:f};if(this.hls.trigger(T.BUFFER_APPENDING,g),e.dropped&&e.independent&&!n){if(a)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!ze.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,i=ze.bufferInfo(t,n,0),a=e.duration,l=Math.min(this.config.maxFragLookUpTolerance*2,a*.25),c=Math.max(Math.min(e.start-l,i.end-l),n+l);e.start-c>l&&this.flushMainBuffer(c,e.start)}getFwdBufferInfo(e,t){var n;const i=this.getLoadPosition();if(!Ee(i))return null;const l=this.lastCurrentTime>i||(n=this.media)!=null&&n.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,i,t,l)}getFwdBufferInfoAtPos(e,t,n,i){const a=ze.bufferInfo(e,t,i);if(a.len===0&&a.nextStart!==void 0){const l=this.fragmentTracker.getBufferedFrag(t,n);if(l&&(a.nextStart<=l.end||l.gap)){const c=Math.max(Math.min(a.nextStart,l.end)-t,i);return ze.bufferInfo(e,t,c)}}return a}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,i=Math.max(Math.min(e-t,n.maxBufferLength),t),a=Math.max(e-t*3,n.maxMaxBufferLength/2,i);return a>=i?(n.maxMaxBufferLength=a,this.warn(`Reduce max buffer length to ${a}s`),!0):!1}getAppendedFrag(e,t=Te.MAIN){var n;const i=(n=this.fragmentTracker)==null?void 0:n.getAppendedFrag(e,t);return i&&"fragment"in i?i.fragment:i}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:a}=this,l=n[0].start,c=a.lowLatencyMode&&!!t.partList;let h=null;if(t.live){const m=a.initialLiveManifestSize;if(i<m)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${m})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<l){var f;c&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),h=this.getInitialLiveFragment(t,n);const y=this.hls.startPosition,v=this.hls.liveSyncPosition,x=h?(y!==-1&&y>=l?y:v)||h.start:e;this.log(`Setting startPosition to ${x} to match start frag at live edge. mainStart: ${y} liveSyncPosition: ${v} frag.start: ${(f=h)==null?void 0:f.start}`),this.startPosition=this.nextLoadPosition=x}}else e<=l&&(h=n[0]);if(!h){const m=this.loadingParts?t.partEnd:t.fragmentEnd;h=this.getFragmentAtPosition(e,m,t)}let g=this.filterReplacedPrimary(h,t);if(!g&&h){const m=h.sn-t.startSN;g=this.filterReplacedPrimary(n[m+1]||null,t)}return this.mapToInitFragWhenRequired(g)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===Xt.OK||n===Xt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,a){let l=null;if(e.gap&&(l=this.getNextFragment(this.nextLoadPosition,t),l&&!l.gap&&n.nextStart)){const c=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i,0);if(c!==null&&n.len+c.len>=a){const h=l.sn;return this.loopSn!==h&&(this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${h}`),this.loopSn=h),null}}return this.loopSn=void 0,l}get primaryPrefetch(){if(nb(this.hls.config)){var e,t;if((e=this.hls.interstitialsManager)==null||(t=e.playingItem)==null?void 0:t.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(nb(this.hls.config)&&e.type!==Te.SUBTITLE){const n=this.hls.interstitialsManager,i=n==null?void 0:n.bufferingItem;if(i){const l=i.event;if(l){if(l.appendInPlace||Math.abs(e.start-i.start)>1||i.start===0)return null}else if(e.end<=i.start&&(t==null?void 0:t.live)===!1||e.start>i.end&&i.nextEvent&&(i.nextEvent.appendInPlace||e.start-i.end>1))return null}const a=n==null?void 0:n.playerQueue;if(a)for(let l=a.length;l--;){const c=a[l].interstitial;if(c.appendInPlace&&e.start>=c.startTime&&e.end<=c.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let i=-1,a=!1,l=!0;for(let c=0,h=e.length;c<h;c++){const f=e[c];if(l=l&&!f.independent,i>-1&&n<f.start)break;const g=f.loaded;g?i=-1:(a||f.independent||l)&&f.fragment===t&&(i=c),a=g}return i}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=XC(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const a=n.sn+1;if(a>=e.startSN&&a<=e.endSN){const l=t[a-e.startSN];n.cc===l.cc&&(i=l,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=HS(t,n.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const a=this.hls.liveSyncPosition;a!==null&&(i=this.getFragmentAtPosition(a,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:a}=this,{fragments:l,endSN:c}=n;const{fragmentHint:h}=n,{maxFragLookUpTolerance:f}=i,g=n.partList,m=!!(this.loadingParts&&g!=null&&g.length&&h);m&&h&&!this.bitrateTest&&g[g.length-1].fragment.sn===h.sn&&(l=l.concat(h),c=h.sn);let y;if(e<t){var v;const b=e<this.lastCurrentTime||e>t-f||(v=this.media)!=null&&v.paused||!this.startFragRequested?0:f;y=Bl(a,l,e,b)}else y=l[l.length-1];if(y){const x=y.sn-n.startSN,b=this.fragmentTracker.getState(y);if((b===Xt.OK||b===Xt.PARTIAL&&y.gap)&&(a=y),a&&y.sn===a.sn&&(!m||g[0].fragment.sn>y.sn||!n.live&&!m)&&a&&y.level===a.level){const S=l[x+1];y.sn<c&&this.fragmentTracker.getState(S)!==Xt.OK?y=S:y=null}}return y}alignPlaylists(e,t,n){const i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const a=e.fragmentStart,l=!t,c=e.alignedSliding&&Ee(a);if(l||!c&&!a){M_(n,e);const h=e.fragmentStart;return this.log(`Live playlist sliding: ${h.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${i}`),h}return a}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;n<t&&(n=-1);const i=this.timelineOffset;if(n===-1){const a=this.startTimeOffset!==null,l=a?this.startTimeOffset:e.startTimeOffset;l!==null&&Ee(l)?(n=t+l,l<0&&(n+=e.edge),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Setting startPosition to ${n} for start time offset ${l} found in ${a?"multivariant":"media"} playlist`),this.startPosition=n):e.live?(n=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${n}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=n=0),this.lastCurrentTime=n+i}this.nextLoadPosition=n+i}getLoadPosition(){var e;const{media:t}=this;let n=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?n=t.currentTime:this.nextLoadPosition>=0&&(n=this.nextLoadPosition),n}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&ln(e)&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==oe.FRAG_LOADING_WAITING_RETRY)&&(this.state=oe.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const x=this.getCurrentContext(t.chunkMeta);x&&(t.frag=x.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var i;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}const a=t.details===Q.FRAG_GAP;a&&this.fragmentTracker.fragBuffered(n,!0);const l=t.errorAction,{action:c,flags:h,retryCount:f=0,retryConfig:g}=l||{},m=!!l&&!!g,y=m&&c===wn.RetryRequest,v=m&&!l.resolved&&h===Gs.MoveAllAlternatesMatchingHost;if(!y&&v&&ln(n)&&!n.endList)this.resetFragmentErrors(e),this.treatAsGap(n),l.resolved=!0;else if((y||v)&&f<g.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);const x=Cy(g,f);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${f+1}/${g.maxNumRetry} in ${x}ms`),l.resolved=!0,this.retryDate=self.performance.now()+x,this.state=oe.FRAG_LOADING_WAITING_RETRY}else if(g&&l)if(this.resetFragmentErrors(e),f<g.maxNumRetry)!a&&c!==wn.RemoveAlternatePermanently&&(l.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${f})`);return}else c===wn.SendAlternateToPenaltyBox?this.state=oe.WAITING_LEVEL:this.state=oe.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===oe.PARSING||this.state===oe.PARSED){const t=e.frag,n=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),a=i&&i.len>.5;a&&this.reduceMaxBufferLength(i.len,(t==null?void 0:t.duration)||10);const l=!a;return l&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),l}return!1}resetFragmentErrors(e){e===Te.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==oe.STOPPED&&(this.state=oe.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const i=ze.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===oe.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==oe.STOPPED&&(this.state=oe.IDLE)}resetStartWhenNotLoaded(e){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of ${this.playlistLabel()} ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){const a=n.details;if(!a){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((h,f)=>{const g=e.elementaryStreams[f];if(g){const m=g.endPTS-g.startPTS;if(m<=0)return this.warn(`Could not parse fragment ${e.sn} ${f} duration reliably (${m})`),h||!1;const y=i?0:qS(a,e,g.startPTS,g.endPTS,g.startDTS,g.endDTS);return this.hls.trigger(T.LEVEL_PTS_UPDATED,{details:a,level:n,drift:y,type:f,frag:e,start:g.startPTS,end:g.endPTS}),!0}return h},!1)){var c;if(n.fragmentError===0&&this.treatAsGap(e,n),((c=this.transmuxer)==null?void 0:c.error)===null){const h=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(h.message),this.hls.trigger(T.ERROR,{type:Re.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,error:h,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=oe.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(T.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===Te.MAIN?"level":"track"}fragInfo(e,t=!0,n){var i,a;return`${this.playlistLabel()} ${e.level} (${n?"part":"frag"}:[${((i=t&&!n?e.startPTS:(n||e).start)!=null?i:NaN).toFixed(3)}-${((a=t&&!n?e.endPTS:(n||e).end)!=null?a:NaN).toFixed(3)}]${n&&e.type==="main"?"INDEPENDENT="+(n.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function nb(s){return!!s.interstitialsController&&s.enableInterstitialPlayback!==!1}class sT{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=N_(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function N_(s,e){const t=new Uint8Array(e);let n=0;for(let i=0;i<s.length;i++){const a=s[i];t.set(a,n),n+=a.length}return t}var Nm={exports:{}},sb;function B_(){return sb||(sb=1,function(s){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(h,f,g){this.fn=h,this.context=f,this.once=g||!1}function a(h,f,g,m,y){if(typeof g!="function")throw new TypeError("The listener must be a function");var v=new i(g,m||h,y),x=t?t+f:f;return h._events[x]?h._events[x].fn?h._events[x]=[h._events[x],v]:h._events[x].push(v):(h._events[x]=v,h._eventsCount++),h}function l(h,f){--h._eventsCount===0?h._events=new n:delete h._events[f]}function c(){this._events=new n,this._eventsCount=0}c.prototype.eventNames=function(){var f=[],g,m;if(this._eventsCount===0)return f;for(m in g=this._events)e.call(g,m)&&f.push(t?m.slice(1):m);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(g)):f},c.prototype.listeners=function(f){var g=t?t+f:f,m=this._events[g];if(!m)return[];if(m.fn)return[m.fn];for(var y=0,v=m.length,x=new Array(v);y<v;y++)x[y]=m[y].fn;return x},c.prototype.listenerCount=function(f){var g=t?t+f:f,m=this._events[g];return m?m.fn?1:m.length:0},c.prototype.emit=function(f,g,m,y,v,x){var b=t?t+f:f;if(!this._events[b])return!1;var A=this._events[b],S=arguments.length,k,R;if(A.fn){switch(A.once&&this.removeListener(f,A.fn,void 0,!0),S){case 1:return A.fn.call(A.context),!0;case 2:return A.fn.call(A.context,g),!0;case 3:return A.fn.call(A.context,g,m),!0;case 4:return A.fn.call(A.context,g,m,y),!0;case 5:return A.fn.call(A.context,g,m,y,v),!0;case 6:return A.fn.call(A.context,g,m,y,v,x),!0}for(R=1,k=new Array(S-1);R<S;R++)k[R-1]=arguments[R];A.fn.apply(A.context,k)}else{var _=A.length,C;for(R=0;R<_;R++)switch(A[R].once&&this.removeListener(f,A[R].fn,void 0,!0),S){case 1:A[R].fn.call(A[R].context);break;case 2:A[R].fn.call(A[R].context,g);break;case 3:A[R].fn.call(A[R].context,g,m);break;case 4:A[R].fn.call(A[R].context,g,m,y);break;default:if(!k)for(C=1,k=new Array(S-1);C<S;C++)k[C-1]=arguments[C];A[R].fn.apply(A[R].context,k)}}return!0},c.prototype.on=function(f,g,m){return a(this,f,g,m,!1)},c.prototype.once=function(f,g,m){return a(this,f,g,m,!0)},c.prototype.removeListener=function(f,g,m,y){var v=t?t+f:f;if(!this._events[v])return this;if(!g)return l(this,v),this;var x=this._events[v];if(x.fn)x.fn===g&&(!y||x.once)&&(!m||x.context===m)&&l(this,v);else{for(var b=0,A=[],S=x.length;b<S;b++)(x[b].fn!==g||y&&!x[b].once||m&&x[b].context!==m)&&A.push(x[b]);A.length?this._events[v]=A.length===1?A[0]:A:l(this,v)}return this},c.prototype.removeAllListeners=function(f){var g;return f?(g=t?t+f:f,this._events[g]&&l(this,g)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,s.exports=c}(Nm)),Nm.exports}var U_=B_(),By=fC(U_);const wh="1.6.2",Vc={};function F_(){return typeof __HLS_WORKER_BUNDLE__=="function"}function G_(){const s=Vc[wh];if(s)return s.clientCount++,s;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),i={worker:new self.Worker(t),objectURL:t,clientCount:1};return Vc[wh]=i,i}function $_(s){const e=Vc[s];if(e)return e.clientCount++,e;const t=new self.URL(s,self.location.href).href,i={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Vc[s]=i,i}function H_(s){const e=Vc[s||wh];if(e&&e.clientCount--===1){const{worker:n,objectURL:i}=e;delete Vc[s||wh],i&&self.URL.revokeObjectURL(i),n.terminate()}}function iT(s,e){return e+10<=s.length&&s[e]===51&&s[e+1]===68&&s[e+2]===73&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128}function Uy(s,e){return e+10<=s.length&&s[e]===73&&s[e+1]===68&&s[e+2]===51&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128}function qd(s,e){let t=0;return t=(s[e]&127)<<21,t|=(s[e+1]&127)<<14,t|=(s[e+2]&127)<<7,t|=s[e+3]&127,t}function Rh(s,e){const t=e;let n=0;for(;Uy(s,e);){n+=10;const i=qd(s,e+6);n+=i,iT(s,e+10)&&(n+=10),e+=n}if(n>0)return s.subarray(t,t+n)}function z_(s,e,t,n){const i=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],a=e[t+2],l=a>>2&15;if(l>12){const v=new Error(`invalid ADTS sampling index:${l}`);s.emit(T.ERROR,T.ERROR,{type:Re.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!0,error:v,reason:v.message});return}const c=(a>>6&3)+1,h=e[t+3]>>6&3|(a&1)<<2,f="mp4a.40."+c,g=i[l];let m=l;(c===5||c===29)&&(m-=3);const y=[c<<3|(m&14)>>1,(m&1)<<7|h<<3];return Je.log(`manifest codec:${n}, parsed codec:${f}, channels:${h}, rate:${g} (ADTS object type:${c} sampling index:${l})`),{config:y,samplerate:g,channelCount:h,codec:f,parsedCodec:f,manifestCodec:n}}function rT(s,e){return s[e]===255&&(s[e+1]&246)===240}function aT(s,e){return s[e+1]&1?7:9}function Fy(s,e){return(s[e+3]&3)<<11|s[e+4]<<3|(s[e+5]&224)>>>5}function V_(s,e){return e+5<s.length}function Sd(s,e){return e+1<s.length&&rT(s,e)}function K_(s,e){return V_(s,e)&&rT(s,e)&&Fy(s,e)<=s.length-e}function Y_(s,e){if(Sd(s,e)){const t=aT(s,e);if(e+t>=s.length)return!1;const n=Fy(s,e);if(n<=t)return!1;const i=e+n;return i===s.length||Sd(s,i)}return!1}function lT(s,e,t,n,i){if(!s.samplerate){const a=z_(e,t,n,i);if(!a)return;ht(s,a)}}function oT(s){return 1024*9e4/s}function j_(s,e){const t=aT(s,e);if(e+t<=s.length){const n=Fy(s,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function cT(s,e,t,n,i){const a=oT(s.samplerate),l=n+i*a,c=j_(e,t);let h;if(c){const{frameLength:m,headerLength:y}=c,v=y+m,x=Math.max(0,t+v-e.length);x?(h=new Uint8Array(v-y),h.set(e.subarray(t+y,e.length),0)):h=e.subarray(t+y,t+v);const b={unit:h,pts:l};return x||s.samples.push(b),{sample:b,length:v,missing:x}}const f=e.length-t;return h=new Uint8Array(f),h.set(e.subarray(t,e.length),0),{sample:{unit:h,pts:l},length:f,missing:-1}}function Q_(s,e){return Uy(s,e)&&qd(s,e+6)+10<=s.length-e}function q_(s){if(s.size<2)return;const e=ls(s.data,!0),t=new Uint8Array(s.data.subarray(e.length+1));return{key:s.type,info:e,data:t.buffer}}function X_(s){if(s.size<2)return;if(s.type==="TXXX"){let t=1;const n=ls(s.data.subarray(t),!0);t+=n.length+1;const i=ls(s.data.subarray(t));return{key:s.type,info:n,data:i}}const e=ls(s.data.subarray(1));return{key:s.type,info:"",data:e}}function W_(s){if(s.type==="WXXX"){if(s.size<2)return;let t=1;const n=ls(s.data.subarray(t),!0);t+=n.length+1;const i=ls(s.data.subarray(t));return{key:s.type,info:n,data:i}}const e=ls(s.data);return{key:s.type,info:"",data:e}}function Z_(s){return btoa(String.fromCharCode(...s))}function uT(s,e){if(s<0)return-uT(-s,e);const t=Math.pow(10,e);if(Math.abs(s*t%1-.5)<Number.EPSILON){const i=Math.floor(s*t);return(i%2===0?i:i+1)/t}else return Math.round(s*t)/t}function J_(s,e){const t=new URL(s),n=new URL(e);if(t.origin!==n.origin)return s;const i=t.pathname.split("/").slice(1),a=n.pathname.split("/").slice(1,-1);for(;i[0]===a[0];)i.shift(),a.shift();for(;a.length;)a.shift(),i.unshift("..");return i.join("/")}function eO(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{const a=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(i=="x"?a:a&3|8).toString(16)})}}}function tO(s){return s instanceof ArrayBuffer?s:s.byteOffset==0&&s.byteLength==s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer}function Bm(s,e=0,t=1/0){return nO(s,e,t,Uint8Array)}function nO(s,e,t,n){const i=sO(s);let a=1;"BYTES_PER_ELEMENT"in n&&(a=n.BYTES_PER_ELEMENT);const l=iO(s)?s.byteOffset:0,c=(l+s.byteLength)/a,h=(l+e)/a,f=Math.floor(Math.max(0,Math.min(h,c))),g=Math.floor(Math.min(f+Math.max(t,0),c));return new n(i,f,g-f)}function sO(s){return s instanceof ArrayBuffer?s:s.buffer}function iO(s){return s&&s.buffer instanceof ArrayBuffer&&s.byteLength!==void 0&&s.byteOffset!==void 0}function rO(s){const e={key:s.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(s.size<2)return;if(s.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const n=s.data.subarray(1).indexOf(0);if(n===-1)return;const i=ls(Bm(s.data,1,n)),a=s.data[2+n],l=s.data.subarray(3+n).indexOf(0);if(l===-1)return;const c=ls(Bm(s.data,3+n,l));let h;return i==="-->"?h=ls(Bm(s.data,4+n+l)):h=tO(s.data.subarray(4+n+l)),e.mimeType=i,e.pictureType=a,e.description=c,e.data=h,e}function aO(s){return s.type==="PRIV"?q_(s):s.type[0]==="W"?W_(s):s.type==="APIC"?rO(s):X_(s)}function lO(s){const e=String.fromCharCode(s[0],s[1],s[2],s[3]),t=qd(s,4),n=10;return{type:e,size:t,data:s.subarray(n,n+t)}}const k0=10,oO=10;function hT(s){let e=0;const t=[];for(;Uy(s,e);){const n=qd(s,e+6);s[e+5]>>6&1&&(e+=k0),e+=k0;const i=e+n;for(;e+oO<i;){const a=lO(s.subarray(e)),l=aO(a);l&&t.push(l),e+=a.size+k0}iT(s,e)&&(e+=k0)}return t}function fT(s){return s&&s.key==="PRIV"&&s.info==="com.apple.streaming.transportStreamTimestamp"}function cO(s){if(s.data.byteLength===8){const e=new Uint8Array(s.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}}function Gy(s){const e=hT(s);for(let t=0;t<e.length;t++){const n=e[t];if(fT(n))return cO(n)}}let as=function(s){return s.audioId3="org.id3",s.dateRange="com.apple.quicktime.HLS",s.emsg="https://aomedia.org/emsg/ID3",s.misbklv="urn:misb:KLV:bin:1910.1",s}({});function Ei(s="",e=9e4){return{type:s,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class $y{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=Cs(this.cachedData,e),this.cachedData=null);let n=Rh(e,0),i=n?n.length:0,a;const l=this._audioTrack,c=this._id3Track,h=n?Gy(n):void 0,f=e.length;for((this.basePTS===null||this.frameIndex===0&&Ee(h))&&(this.basePTS=uO(h,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:as.audioId3,duration:Number.POSITIVE_INFINITY});i<f;){if(this.canParse(e,i)){const g=this.appendFrame(l,e,i);g?(this.frameIndex++,this.lastPTS=g.sample.pts,i+=g.length,a=i):i=f}else Q_(e,i)?(n=Rh(e,i),c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:as.audioId3,duration:Number.POSITIVE_INFINITY}),i+=n.length,a=i):i++;if(i===f&&a!==f){const g=e.slice(a);this.cachedData?this.cachedData=Cs(this.cachedData,g):this.cachedData=g}}return{audioTrack:l,videoTrack:Ei(),id3Track:c,textTrack:Ei()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Ei(),id3Track:this._id3Track,textTrack:Ei()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const uO=(s,e,t)=>{if(Ee(s))return s*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};let I0=null;const hO=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],fO=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],dO=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],gO=[0,1,1,4];function dT(s,e,t,n,i){if(t+24>e.length)return;const a=gT(e,t);if(a&&t+a.frameLength<=e.length){const l=a.samplesPerFrame*9e4/a.sampleRate,c=n+i*l,h={unit:e.subarray(t,t+a.frameLength),pts:c,dts:c};return s.config=[],s.channelCount=a.channelCount,s.samplerate=a.sampleRate,s.samples.push(h),{sample:h,length:a.frameLength,missing:0}}}function gT(s,e){const t=s[e+1]>>3&3,n=s[e+1]>>1&3,i=s[e+2]>>4&15,a=s[e+2]>>2&3;if(t!==1&&i!==0&&i!==15&&a!==3){const l=s[e+2]>>1&1,c=s[e+3]>>6,h=t===3?3-n:n===3?3:4,f=hO[h*14+i-1]*1e3,m=fO[(t===3?0:t===2?1:2)*3+a],y=c===3?1:2,v=dO[t][n],x=gO[n],b=v*8*x,A=Math.floor(v*f/m+l)*x;if(I0===null){const R=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);I0=R?parseInt(R[1]):0}return!!I0&&I0<=87&&n===2&&f>=224e3&&c===0&&(s[e+3]=s[e+3]|128),{sampleRate:m,channelCount:y,frameLength:A,samplesPerFrame:b}}}function Hy(s,e){return s[e]===255&&(s[e+1]&224)===224&&(s[e+1]&6)!==0}function mT(s,e){return e+1<s.length&&Hy(s,e)}function mO(s,e){return Hy(s,e)&&4<=s.length-e}function pT(s,e){if(e+1<s.length&&Hy(s,e)){const n=gT(s,e);let i=4;n!=null&&n.frameLength&&(i=n.frameLength);const a=e+i;return a===s.length||mT(s,a)}return!1}class pO extends $y{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const n=Rh(e,0);let i=(n==null?void 0:n.length)||0;if(pT(e,i))return!1;for(let a=e.length;i<a;i++)if(Y_(e,i))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return K_(e,t)}appendFrame(e,t,n){lT(e,this.observer,t,n,e.manifestCodec);const i=cT(e,t,n,this.basePTS,this.frameIndex);if(i&&i.missing===0)return i}}const yT=(s,e)=>{let t=0,n=5;e+=n;const i=new Uint32Array(1),a=new Uint32Array(1),l=new Uint8Array(1);for(;n>0;){l[0]=s[e];const c=Math.min(n,8),h=8-c;a[0]=4278190080>>>24+h<<h,i[0]=(l[0]&a[0])>>h,t=t?t<<c|i[0]:i[0],e+=1,n-=c}return t};class yO extends $y{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const i=vT(e,t,n,this.basePTS,this.frameIndex);if(i!==-1)return{sample:e.samples[e.samples.length-1],length:i,missing:0}}static probe(e){if(!e)return!1;const t=Rh(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&Gy(t)!==void 0&&yT(e,n)<16}}function vT(s,e,t,n,i){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const a=e[t+4]>>6;if(a>=3)return-1;const c=[48e3,44100,32e3][a],h=e[t+4]&63,g=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][h*3+a]*2;if(t+g>e.length)return-1;const m=e[t+6]>>5;let y=0;m===2?y+=2:(m&1&&m!==1&&(y+=2),m&4&&(y+=2));const v=(e[t+6]<<8|e[t+7])>>12-y&1,b=[2,1,2,3,3,4,4,5][m]+v,A=e[t+5]>>3,S=e[t+5]&7,k=new Uint8Array([a<<6|A<<1|S>>2,(S&3)<<6|m<<3|v<<2|h>>4,h<<4&224]),R=1536/c*9e4,_=n+i*R,C=e.subarray(t,t+g);return s.config=k,s.channelCount=b,s.samplerate=c,s.samples.push({unit:C,pts:_}),g}class vO extends $y{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Rh(e,0);let n=(t==null?void 0:t.length)||0;if(t&&e[n]===11&&e[n+1]===119&&Gy(t)!==void 0&&yT(e,n)<=16)return!1;for(let i=e.length;n<i;n++)if(pT(e,n))return Je.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return mO(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return dT(e,t,n,this.basePTS,this.frameIndex)}}const xO=/\/emsg[-/]ID3/i;class EO{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const a=this.videoTrack=Ei("video",1),l=this.audioTrack=Ei("audio",1),c=this.txtTrack=Ei("text",1);if(this.id3Track=Ei("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const h=CS(e);if(h.video){const{id:f,timescale:g,codec:m,supplemental:y}=h.video;a.id=f,a.timescale=c.timescale=g,a.codec=m,a.supplemental=y}if(h.audio){const{id:f,timescale:g,codec:m}=h.audio;l.id=f,l.timescale=g,l.codec=m}c.id=kS.text,a.sampleDuration=0,a.duration=l.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return yC(e)}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Cs(this.remainderData,e));const c=wC(n);this.remainderData=c.remainder,i.samples=c.valid||new Uint8Array}else i.samples=n;const l=this.extractID3Track(i,t);return a.samples=TE(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:l,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=TE(e,t),{videoTrack:t,audioTrack:Ei(),id3Track:i,textTrack:Ei()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=Ge(e.samples,["emsg"]);i&&i.forEach(a=>{const l=LC(a);if(xO.test(l.schemeIdUri)){const c=ib(l,t);let h=l.eventDuration===4294967295?Number.POSITIVE_INFINITY:l.eventDuration/l.timeScale;h<=.001&&(h=Number.POSITIVE_INFINITY);const f=l.payload;n.samples.push({data:f,len:f.byteLength,dts:c,pts:c,type:as.emsg,duration:h})}else if(this.config.enableEmsgKLVMetadata&&l.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const c=ib(l,t);n.samples.push({data:l.payload,len:l.payload.byteLength,dts:c,pts:c,type:as.misbklv,duration:Number.POSITIVE_INFINITY})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function ib(s,e){return Ee(s.presentationTime)?s.presentationTime/s.timeScale:e+s.presentationTimeDelta/s.timeScale}class bO{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new _y(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,La.cbc)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const a=i.subarray(16,i.length-i.length%16),l=a.buffer.slice(a.byteOffset,a.byteOffset+a.length);this.decryptBuffer(l).then(c=>{const h=new Uint8Array(c);i.set(h,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let i=0;for(let a=32;a<e.length-16;a+=160,i+=16)n.set(e.subarray(a,a+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let a=32;a<e.length-16;a+=160,i+=16)e.set(n.subarray(i,i+16),a);return e}decryptAvcSample(e,t,n,i,a){const l=OS(a.data),c=this.getAvcEncryptedData(l);this.decryptBuffer(c.buffer).then(h=>{a.data=this.getAvcDecryptedUnit(l,h),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)})}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){i();return}const a=e[t].units;for(;!(n>=a.length);n++){const l=a[n];if(!(l.data.length<=48||l.type!==1&&l.type!==5)&&(this.decryptAvcSample(e,t,n,i,l),!this.decrypter.isSync()))return}}}}class xT{constructor(){this.VideoSample=null}createVideoSample(e,t,n){return{key:e,frame:!1,pts:t,dts:n,units:[],length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,i;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const a=n.units;i=a[a.length-1]}return i}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,i=n.length;if(i){const a=n[i-1];e.pts=a.pts,e.dts=a.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,n){const i=t.byteLength;let a=e.naluState||0;const l=a,c=[];let h=0,f,g,m,y=-1,v=0;for(a===-1&&(y=0,v=this.getNALuType(t,0),a=0,h=1);h<i;){if(f=t[h++],!a){a=f?0:1;continue}if(a===1){a=f?0:2;continue}if(!f)a=3;else if(f===1){if(g=h-a-1,y>=0){const x={data:t.subarray(y,g),type:v};c.push(x)}else{const x=this.getLastNalUnit(e.samples);x&&(l&&h<=4-l&&x.state&&(x.data=x.data.subarray(0,x.data.byteLength-l)),g>0&&(x.data=Cs(x.data,t.subarray(0,g)),x.state=0))}h<i?(m=this.getNALuType(t,h),y=h,v=m,a=0):a=-1}else a=0}if(y>=0&&a>=0){const x={data:t.subarray(y,i),type:v,state:a};c.push(x)}if(c.length===0){const x=this.getLastNalUnit(e.samples);x&&(x.data=Cs(x.data,t))}return e.naluState=a,c}}class ph{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),a=Math.min(4,t);if(a===0)throw new Error("no bytes available");i.set(e.subarray(n,n+a)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=a*8,this.bytesAvailable-=a}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&Je.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class rb extends xT{parsePES(e,t,n,i){const a=this.parseNALu(e,n.data,i);let l=this.VideoSample,c,h=!1;n.data=null,l&&a.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),a.forEach(f=>{var g,m;switch(f.type){case 1:{let b=!1;c=!0;const A=f.data;if(h&&A.length>4){const S=this.readSliceType(A);(S===2||S===4||S===7||S===9)&&(b=!0)}if(b){var y;(y=l)!=null&&y.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null)}l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.frame=!0,l.key=b;break}case 5:c=!0,(g=l)!=null&&g.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0,l.frame=!0;break;case 6:{c=!0,Iy(f.data,1,n.pts,t.samples);break}case 7:{var v,x;c=!0,h=!0;const b=f.data,A=this.readSPS(b);if(!e.sps||e.width!==A.width||e.height!==A.height||((v=e.pixelRatio)==null?void 0:v[0])!==A.pixelRatio[0]||((x=e.pixelRatio)==null?void 0:x[1])!==A.pixelRatio[1]){e.width=A.width,e.height=A.height,e.pixelRatio=A.pixelRatio,e.sps=[b];const S=b.subarray(1,4);let k="avc1.";for(let R=0;R<3;R++){let _=S[R].toString(16);_.length<2&&(_="0"+_),k+=_}e.codec=k}break}case 8:c=!0,e.pps=[f.data];break;case 9:c=!0,e.audFound=!0,(m=l)!=null&&m.frame&&(this.pushAccessUnit(l,e),l=null),l||(l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;case 12:c=!0;break;default:c=!1;break}l&&c&&l.units.push(f)}),i&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new ph(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let n=8,i=8,a;for(let l=0;l<e;l++)i!==0&&(a=t.readEG(),i=(n+a+256)%256),n=i===0?n:i}readSPS(e){const t=new ph(e);let n=0,i=0,a=0,l=0,c,h,f;const g=t.readUByte.bind(t),m=t.readBits.bind(t),y=t.readUEG.bind(t),v=t.readBoolean.bind(t),x=t.skipBits.bind(t),b=t.skipEG.bind(t),A=t.skipUEG.bind(t),S=this.skipScalingList.bind(this);g();const k=g();if(m(5),x(3),g(),A(),k===100||k===110||k===122||k===244||k===44||k===83||k===86||k===118||k===128){const B=y();if(B===3&&x(1),A(),A(),x(1),v())for(h=B!==3?8:12,f=0;f<h;f++)v()&&(f<6?S(16,t):S(64,t))}A();const R=y();if(R===0)y();else if(R===1)for(x(1),b(),b(),c=y(),f=0;f<c;f++)b();A(),x(1);const _=y(),C=y(),U=m(1);U===0&&x(1),x(1),v()&&(n=y(),i=y(),a=y(),l=y());let O=[1,1];if(v()&&v())switch(g()){case 1:O=[1,1];break;case 2:O=[12,11];break;case 3:O=[10,11];break;case 4:O=[16,11];break;case 5:O=[40,33];break;case 6:O=[24,11];break;case 7:O=[20,11];break;case 8:O=[32,11];break;case 9:O=[80,33];break;case 10:O=[18,11];break;case 11:O=[15,11];break;case 12:O=[64,33];break;case 13:O=[160,99];break;case 14:O=[4,3];break;case 15:O=[3,2];break;case 16:O=[2,1];break;case 255:{O=[g()<<8|g(),g()<<8|g()];break}}return{width:Math.ceil((_+1)*16-n*2-i*2),height:(2-U)*(C+1)*16-(U?2:4)*(a+l),pixelRatio:O}}}class ab extends xT{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,n,i){const a=this.parseNALu(e,n.data,i);let l=this.VideoSample,c,h=!1;n.data=null,l&&a.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),a.forEach(f=>{var g,m;switch(f.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:l||(l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),l.frame=!0,c=!0;break;case 16:case 17:case 18:case 21:if(c=!0,h){var y;(y=l)!=null&&y.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null)}l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0,l.frame=!0;break;case 19:case 20:c=!0,(g=l)!=null&&g.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0,l.frame=!0;break;case 39:c=!0,Iy(f.data,2,n.pts,t.samples);break;case 32:c=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=ht(e.params,this.readVPS(f.data)),this.initVPS=f.data),e.vps=[f.data];break;case 33:if(c=!0,h=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],f.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const v=this.readSPS(f.data);e.width=v.width,e.height=v.height,e.pixelRatio=v.pixelRatio,e.codec=v.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const x in v.params)e.params[x]=v.params[x]}this.pushParameterSet(e.sps,f.data,e.vps),l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0;break;case 34:if(c=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const v=this.readPPS(f.data);for(const x in v)e.params[x]=v[x]}this.pushParameterSet(e.pps,f.data,e.vps)}break;case 35:c=!0,e.audFound=!0,(m=l)!=null&&m.frame&&(this.pushAccessUnit(l,e),l=null),l||(l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;default:c=!1;break}l&&c&&l.units.push(f)}),i&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null)}pushParameterSet(e,t,n){(n&&n[0]===this.initVPS||!n&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let n=0;for(let i=0;i<e.byteLength;i++)i>=2&&e[i]===3&&e[i-1]===0&&e[i-2]===0||(t[n]=e[i],n++);return new Uint8Array(t.buffer,0,n)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new ph(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const n=t.readBits(3),i=t.readBoolean();return{numTemporalLayers:n+1,temporalIdNested:i}}readSPS(e){const t=new ph(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const n=t.readBits(3);t.readBoolean();const i=t.readBits(2),a=t.readBoolean(),l=t.readBits(5),c=t.readUByte(),h=t.readUByte(),f=t.readUByte(),g=t.readUByte(),m=t.readUByte(),y=t.readUByte(),v=t.readUByte(),x=t.readUByte(),b=t.readUByte(),A=t.readUByte(),S=t.readUByte(),k=[],R=[];for(let Ue=0;Ue<n;Ue++)k.push(t.readBoolean()),R.push(t.readBoolean());if(n>0)for(let Ue=n;Ue<8;Ue++)t.readBits(2);for(let Ue=0;Ue<n;Ue++)k[Ue]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),R[Ue]&&t.readUByte();t.readUEG();const _=t.readUEG();_==3&&t.skipBits(1);const C=t.readUEG(),U=t.readUEG(),O=t.readBoolean();let B=0,F=0,M=0,j=0;O&&(B+=t.readUEG(),F+=t.readUEG(),M+=t.readUEG(),j+=t.readUEG());const ae=t.readUEG(),ye=t.readUEG(),pe=t.readUEG(),W=t.readBoolean();for(let Ue=W?0:n;Ue<=n;Ue++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let Tt=0;Tt<4;Tt++)for(let Yt=0;Yt<(Tt===3?2:6);Yt++)if(!t.readBoolean())t.readUEG();else{const cn=Math.min(64,1<<4+(Tt<<1));Tt>1&&t.readEG();for(let os=0;os<cn;os++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const se=t.readUEG();let Z=0;for(let Ue=0;Ue<se;Ue++){let Tt=!1;if(Ue!==0&&(Tt=t.readBoolean()),Tt){Ue===se&&t.readUEG(),t.readBoolean(),t.readUEG();let Yt=0;for(let jn=0;jn<=Z;jn++){const cn=t.readBoolean();let os=!1;cn||(os=t.readBoolean()),(cn||os)&&Yt++}Z=Yt}else{const Yt=t.readUEG(),jn=t.readUEG();Z=Yt+jn;for(let cn=0;cn<Yt;cn++)t.readUEG(),t.readBoolean();for(let cn=0;cn<jn;cn++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const Ue=t.readUEG();for(let Tt=0;Tt<Ue;Tt++){for(let Yt=0;Yt<pe+4;Yt++)t.readBits(1);t.readBits(1)}}let V=0,ie=1,ce=1,ue=!0,xe=1,ve=0;t.readBoolean(),t.readBoolean();let $e=!1;if(t.readBoolean()){if(t.readBoolean()){const _s=t.readUByte(),jl=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],un=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];_s>0&&_s<16?(ie=jl[_s-1],ce=un[_s-1]):_s===255&&(ie=t.readBits(16),ce=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),$e=t.readBoolean(),$e&&(B+=t.readUEG(),F+=t.readUEG(),M+=t.readUEG(),j+=t.readUEG()),t.readBoolean()&&(xe=t.readBits(32),ve=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const un=t.readBoolean(),Ql=t.readBoolean();let ti=!1;(un||Ql)&&(ti=t.readBoolean(),ti&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),ti&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let De=0;De<=n;De++){ue=t.readBoolean();const Be=ue||t.readBoolean();let Me=!1;Be?t.readEG():Me=t.readBoolean();const _e=Me?1:t.readUEG()+1;if(un)for(let bt=0;bt<_e;bt++)t.readUEG(),t.readUEG(),ti&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(Ql)for(let bt=0;bt<_e;bt++)t.readUEG(),t.readUEG(),ti&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),V=t.readUEG())}let Ne=C,Ke=U;if(O||$e){let Ue=1,Tt=1;_===1?Ue=Tt=2:_==2&&(Ue=2),Ne=C-Ue*F-Ue*B,Ke=U-Tt*j-Tt*M}const Wt=i?["A","B","C"][i]:"",vn=c<<24|h<<16|f<<8|g;let yt=0;for(let Ue=0;Ue<32;Ue++)yt=(yt|(vn>>Ue&1)<<31-Ue)>>>0;let Zt=yt.toString(16);return l===1&&Zt==="2"&&(Zt="6"),{codecString:`hvc1.${Wt}${l}.${Zt}.${a?"H":"L"}${S}.B0`,params:{general_tier_flag:a,general_profile_idc:l,general_profile_space:i,general_profile_compatibility_flags:[c,h,f,g],general_constraint_indicator_flags:[m,y,v,x,b,A],general_level_idc:S,bit_depth:ae+8,bit_depth_luma_minus8:ae,bit_depth_chroma_minus8:ye,min_spatial_segmentation_idc:V,chroma_format_idc:_,frame_rate:{fixed:ue,fps:ve/xe}},width:Ne,height:Ke,pixelRatio:[ie,ce]}}readPPS(e){const t=new ph(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const i=t.readBoolean(),a=t.readBoolean();let l=1;return a&&i?l=0:a?l=3:i&&(l=2),{parallelismType:l}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const sn=188;class ra{constructor(e,t,n,i){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=i,this.videoParser=null}static probe(e,t){const n=ra.syncOffset(e);return n>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),n!==-1}static syncOffset(e){const t=e.length;let n=Math.min(sn*5,t-sn)+1,i=0;for(;i<n;){let a=!1,l=-1,c=0;for(let h=i;h<t;h+=sn)if(e[h]===71&&(t-h===sn||e[h+sn]===71)){if(c++,l===-1&&(l=h,l!==0&&(n=Math.min(l+sn*99,e.length-sn)+1)),a||(a=Lp(e,h)===0),a&&c>1&&(l===0&&c>2||h+sn>n))return l}else{if(c)return-1;break}i++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:kS[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=ra.createTrack("video"),this._videoTrack.duration=i,this._audioTrack=ra.createTrack("audio",i),this._id3Track=ra.createTrack("id3"),this._txtTrack=ra.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,i=!1){n||(this.sampleAes=null);let a;const l=this._videoTrack,c=this._audioTrack,h=this._id3Track,f=this._txtTrack;let g=l.pid,m=l.pesData,y=c.pid,v=h.pid,x=c.pesData,b=h.pesData,A=null,S=this.pmtParsed,k=this._pmtId,R=e.length;if(this.remainderData&&(e=Cs(this.remainderData,e),R=e.length,this.remainderData=null),R<sn&&!i)return this.remainderData=e,{audioTrack:c,videoTrack:l,id3Track:h,textTrack:f};const _=Math.max(0,ra.syncOffset(e));R-=(R-_)%sn,R<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,R,e.buffer.byteLength-R));let C=0;for(let O=_;O<R;O+=sn)if(e[O]===71){const B=!!(e[O+1]&64),F=Lp(e,O),M=(e[O+3]&48)>>4;let j;if(M>1){if(j=O+5+e[O+4],j===O+sn)continue}else j=O+4;switch(F){case g:if(B){if(m&&(a=Oo(m,this.logger))){if(this.videoParser===null)switch(l.segmentCodec){case"avc":this.videoParser=new rb;break;case"hevc":this.videoParser=new ab;break}this.videoParser!==null&&this.videoParser.parsePES(l,f,a,!1)}m={data:[],size:0}}m&&(m.data.push(e.subarray(j,O+sn)),m.size+=O+sn-j);break;case y:if(B){if(x&&(a=Oo(x,this.logger)))switch(c.segmentCodec){case"aac":this.parseAACPES(c,a);break;case"mp3":this.parseMPEGPES(c,a);break;case"ac3":this.parseAC3PES(c,a);break}x={data:[],size:0}}x&&(x.data.push(e.subarray(j,O+sn)),x.size+=O+sn-j);break;case v:B&&(b&&(a=Oo(b,this.logger))&&this.parseID3PES(h,a),b={data:[],size:0}),b&&(b.data.push(e.subarray(j,O+sn)),b.size+=O+sn-j);break;case 0:B&&(j+=e[j]+1),k=this._pmtId=AO(e,j);break;case k:{B&&(j+=e[j]+1);const ae=SO(e,j,this.typeSupported,n,this.observer,this.logger);g=ae.videoPid,g>0&&(l.pid=g,l.segmentCodec=ae.segmentVideoCodec),y=ae.audioPid,y>0&&(c.pid=y,c.segmentCodec=ae.segmentAudioCodec),v=ae.id3Pid,v>0&&(h.pid=v),A!==null&&!S&&(this.logger.warn(`MPEG-TS PMT found at ${O} after unknown PID '${A}'. Backtracking to sync byte @${_} to parse all TS packets.`),A=null,O=_-188),S=this.pmtParsed=!0;break}case 17:case 8191:break;default:A=F;break}}else C++;C>0&&kp(this.observer,new Error(`Found ${C} TS packet/s that do not start with 0x47`),void 0,this.logger),l.pesData=m,c.pesData=x,h.pesData=b;const U={audioTrack:c,videoTrack:l,id3Track:h,textTrack:f};return i&&this.extractRemainingSamples(U),U}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:a}=e,l=n.pesData,c=t.pesData,h=i.pesData;let f;if(l&&(f=Oo(l,this.logger))){if(this.videoParser===null)switch(n.segmentCodec){case"avc":this.videoParser=new rb;break;case"hevc":this.videoParser=new ab;break}this.videoParser!==null&&(this.videoParser.parsePES(n,a,f,!0),n.pesData=null)}else n.pesData=l;if(c&&(f=Oo(c,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,f);break;case"mp3":this.parseMPEGPES(t,f);break;case"ac3":this.parseAC3PES(t,f);break}t.pesData=null}else c!=null&&c.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=c;h&&(f=Oo(h,this.logger))?(this.parseID3PES(i,f),i.pesData=null):i.pesData=h}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),a=this.sampleAes=new bO(this.observer,this.config,t);return this.decrypt(i,a)}decrypt(e,t){return new Promise(n=>{const{audioTrack:i,videoTrack:a}=e;i.samples&&i.segmentCodec==="aac"?t.decryptAacSamples(i.samples,0,()=>{a.samples?t.decryptAvcSamples(a.samples,0,0,()=>{n(e)}):n(e)}):a.samples&&t.decryptAvcSamples(a.samples,0,0,()=>{n(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let a=t.data;if(i){this.aacOverFlow=null;const m=i.missing,y=i.sample.unit.byteLength;if(m===-1)a=Cs(i.sample.unit,a);else{const v=y-m;i.sample.unit.set(a.subarray(0,m),v),e.samples.push(i.sample),n=i.missing}}let l,c;for(l=n,c=a.length;l<c-1&&!Sd(a,l);l++);if(l!==n){let m;const y=l<c-1;if(y?m=`AAC PES did not start with ADTS header,offset:${l}`:m="No ADTS header found in AAC PES",kp(this.observer,new Error(m),y,this.logger),!y)return}lT(e,this.observer,a,l,this.audioCodec);let h;if(t.pts!==void 0)h=t.pts;else if(i){const m=oT(e.samplerate);h=i.sample.pts+m}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let f=0,g;for(;l<c;)if(g=cT(e,a,l,h,f),l+=g.length,g.missing){this.aacOverFlow=g;break}else for(f++;l<c-1&&!Sd(a,l);l++);}parseMPEGPES(e,t){const n=t.data,i=n.length;let a=0,l=0;const c=t.pts;if(c===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;l<i;)if(mT(n,l)){const h=dT(e,n,l,c,a);if(h)l+=h.length,a++;else break}else l++}parseAC3PES(e,t){{const n=t.data,i=t.pts;if(i===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const a=n.length;let l=0,c=0,h;for(;c<a&&(h=vT(e,n,c,i,l++))>0;)c+=h}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=ht({},t,{type:this._videoTrack?as.emsg:as.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function Lp(s,e){return((s[e+1]&31)<<8)+s[e+2]}function AO(s,e){return(s[e+10]&31)<<8|s[e+11]}function SO(s,e,t,n,i,a){const l={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},c=(s[e+1]&15)<<8|s[e+2],h=e+3+c-4,f=(s[e+10]&15)<<8|s[e+11];for(e+=12+f;e<h;){const g=Lp(s,e),m=(s[e+3]&15)<<8|s[e+4];switch(s[e]){case 207:if(!n){Um("ADTS AAC",a);break}case 15:l.audioPid===-1&&(l.audioPid=g);break;case 21:l.id3Pid===-1&&(l.id3Pid=g);break;case 219:if(!n){Um("H.264",a);break}case 27:l.videoPid===-1&&(l.videoPid=g);break;case 3:case 4:!t.mpeg&&!t.mp3?a.log("MPEG audio found, not supported in this browser"):l.audioPid===-1&&(l.audioPid=g,l.segmentAudioCodec="mp3");break;case 193:if(!n){Um("AC-3",a);break}case 129:t.ac3?l.audioPid===-1&&(l.audioPid=g,l.segmentAudioCodec="ac3"):a.log("AC-3 audio found, not supported in this browser");break;case 6:if(l.audioPid===-1&&m>0){let y=e+5,v=m;for(;v>2;){switch(s[y]){case 106:t.ac3!==!0?a.log("AC-3 audio found, not supported in this browser for now"):(l.audioPid=g,l.segmentAudioCodec="ac3");break}const b=s[y+1]+2;y+=b,v-=b}}break;case 194:case 135:return kp(i,new Error("Unsupported EC-3 in M2TS found"),void 0,a),l;case 36:l.videoPid===-1&&(l.videoPid=g,l.segmentVideoCodec="hevc",a.log("HEVC in M2TS found"));break}e+=m+5}return l}function kp(s,e,t,n){n.warn(`parsing error: ${e.message}`),s.emit(T.ERROR,T.ERROR,{type:Re.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function Um(s,e){e.log(`${s} with AES-128-CBC encryption found in unencrypted stream`)}function Oo(s,e){let t=0,n,i,a,l,c;const h=s.data;if(!s||s.size===0)return null;for(;h[0].length<19&&h.length>1;)h[0]=Cs(h[0],h[1]),h.splice(1,1);if(n=h[0],(n[0]<<16)+(n[1]<<8)+n[2]===1){if(i=(n[4]<<8)+n[5],i&&i>s.size-6)return null;const g=n[7];g&192&&(l=(n[9]&14)*536870912+(n[10]&255)*4194304+(n[11]&254)*16384+(n[12]&255)*128+(n[13]&254)/2,g&64?(c=(n[14]&14)*536870912+(n[15]&255)*4194304+(n[16]&254)*16384+(n[17]&255)*128+(n[18]&254)/2,l-c>60*9e4&&(e.warn(`${Math.round((l-c)/9e4)}s delta between PTS and DTS, align them`),l=c)):c=l),a=n[8];let m=a+9;if(s.size<=m)return null;s.size-=m;const y=new Uint8Array(s.size);for(let v=0,x=h.length;v<x;v++){n=h[v];let b=n.byteLength;if(m)if(m>b){m-=b;continue}else n=n.subarray(m),b-=m,m=0;y.set(n,t),t+=b}return i&&(i-=a+3),{data:y,pts:l,dts:c,len:i}}return null}class TO{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Wr=Math.pow(2,32)-1;class Y{static init(){Y.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in Y.types)Y.types.hasOwnProperty(e)&&(Y.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Y.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);Y.STTS=Y.STSC=Y.STCO=a,Y.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Y.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Y.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Y.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const l=new Uint8Array([105,115,111,109]),c=new Uint8Array([97,118,99,49]),h=new Uint8Array([0,0,0,1]);Y.FTYP=Y.box(Y.types.ftyp,l,h,l,c),Y.DINF=Y.box(Y.types.dinf,Y.box(Y.types.dref,i))}static box(e,...t){let n=8,i=t.length;const a=i;for(;i--;)n+=t[i].byteLength;const l=new Uint8Array(n);for(l[0]=n>>24&255,l[1]=n>>16&255,l[2]=n>>8&255,l[3]=n&255,l.set(e,4),i=0,n=8;i<a;i++)l.set(t[i],n),n+=t[i].byteLength;return l}static hdlr(e){return Y.box(Y.types.hdlr,Y.HDLR_TYPES[e])}static mdat(e){return Y.box(Y.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(Wr+1)),i=Math.floor(t%(Wr+1));return Y.box(Y.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,85,196,0,0]))}static mdia(e){return Y.box(Y.types.mdia,Y.mdhd(e.timescale||0,e.duration||0),Y.hdlr(e.type),Y.minf(e))}static mfhd(e){return Y.box(Y.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?Y.box(Y.types.minf,Y.box(Y.types.smhd,Y.SMHD),Y.DINF,Y.stbl(e)):Y.box(Y.types.minf,Y.box(Y.types.vmhd,Y.VMHD),Y.DINF,Y.stbl(e))}static moof(e,t,n){return Y.box(Y.types.moof,Y.mfhd(e),Y.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=Y.trak(e[t]);return Y.box.apply(null,[Y.types.moov,Y.mvhd(e[0].timescale||0,e[0].duration||0)].concat(n).concat(Y.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=Y.trex(e[t]);return Y.box.apply(null,[Y.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(Wr+1)),i=Math.floor(t%(Wr+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Y.box(Y.types.mvhd,a)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,a;for(i=0;i<t.length;i++)a=t[i].flags,n[i+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy;return Y.box(Y.types.sdtp,n)}static stbl(e){return Y.box(Y.types.stbl,Y.stsd(e),Y.box(Y.types.stts,Y.STTS),Y.box(Y.types.stsc,Y.STSC),Y.box(Y.types.stsz,Y.STSZ),Y.box(Y.types.stco,Y.STCO))}static avc1(e){let t=[],n=[],i,a,l;for(i=0;i<e.sps.length;i++)a=e.sps[i],l=a.byteLength,t.push(l>>>8&255),t.push(l&255),t=t.concat(Array.prototype.slice.call(a));for(i=0;i<e.pps.length;i++)a=e.pps[i],l=a.byteLength,n.push(l>>>8&255),n.push(l&255),n=n.concat(Array.prototype.slice.call(a));const c=Y.box(Y.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),h=e.width,f=e.height,g=e.pixelRatio[0],m=e.pixelRatio[1];return Y.box(Y.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,h&255,f>>8&255,f&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c,Y.box(Y.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Y.box(Y.types.pasp,new Uint8Array([g>>24,g>>16&255,g>>8&255,g&255,m>>24,m>>16&255,m>>8&255,m&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return Y.box(Y.types.mp4a,Y.audioStsd(e),Y.box(Y.types.esds,Y.esds(e)))}static mp3(e){return Y.box(Y.types[".mp3"],Y.audioStsd(e))}static ac3(e){return Y.box(Y.types["ac-3"],Y.audioStsd(e),Y.box(Y.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return Y.box(Y.types.stsd,Y.STSD,Y.mp4a(e));if(t==="ac3"&&e.config)return Y.box(Y.types.stsd,Y.STSD,Y.ac3(e));if(t==="mp3"&&e.codec==="mp3")return Y.box(Y.types.stsd,Y.STSD,Y.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return Y.box(Y.types.stsd,Y.STSD,Y.avc1(e));if(t==="hevc"&&e.vps)return Y.box(Y.types.stsd,Y.STSD,Y.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,n=(e.duration||0)*(e.timescale||0),i=e.width||0,a=e.height||0,l=Math.floor(n/(Wr+1)),c=Math.floor(n%(Wr+1));return Y.box(Y.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,l>>24,l>>16&255,l>>8&255,l&255,c>>24,c>>16&255,c>>8&255,c&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,i&255,0,0,a>>8&255,a&255,0,0]))}static traf(e,t){const n=Y.sdtp(e),i=e.id,a=Math.floor(t/(Wr+1)),l=Math.floor(t%(Wr+1));return Y.box(Y.types.traf,Y.box(Y.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255])),Y.box(Y.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,l>>24,l>>16&255,l>>8&255,l&255])),Y.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,Y.box(Y.types.trak,Y.tkhd(e),Y.mdia(e))}static trex(e){const t=e.id;return Y.box(Y.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,a=12+16*i,l=new Uint8Array(a);let c,h,f,g,m,y;for(t+=8+a,l.set([e.type==="video"?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,i&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),c=0;c<i;c++)h=n[c],f=h.duration,g=h.size,m=h.flags,y=h.cts,l.set([f>>>24&255,f>>>16&255,f>>>8&255,f&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255,m.isLeading<<2|m.dependsOn,m.isDependedOn<<6|m.hasRedundancy<<4|m.paddingValue<<1|m.isNonSync,m.degradPrio&61440,m.degradPrio&15,y>>>24&255,y>>>16&255,y>>>8&255,y&255],12+16*c);return Y.box(Y.types.trun,l)}static initSegment(e){Y.types||Y.init();const t=Y.moov(e);return Cs(Y.FTYP,t)}static hvc1(e){const t=e.params,n=[e.vps,e.sps,e.pps],i=4,a=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),i-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),n.length]);let l=a.length;for(let x=0;x<n.length;x+=1){l+=3;for(let b=0;b<n[x].length;b+=1)l+=2+n[x][b].length}const c=new Uint8Array(l);c.set(a,0),l=a.length;const h=n.length-1;for(let x=0;x<n.length;x+=1){c.set(new Uint8Array([32+x|(x===h?128:0),0,n[x].length]),l),l+=3;for(let b=0;b<n[x].length;b+=1)c.set(new Uint8Array([n[x][b].length>>8,n[x][b].length&255]),l),l+=2,c.set(n[x][b],l),l+=n[x][b].length}const f=Y.box(Y.types.hvcC,c),g=e.width,m=e.height,y=e.pixelRatio[0],v=e.pixelRatio[1];return Y.box(Y.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,g>>8&255,g&255,m>>8&255,m&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),f,Y.box(Y.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Y.box(Y.types.pasp,new Uint8Array([y>>24,y>>16&255,y>>8&255,y&255,v>>24,v>>16&255,v>>8&255,v&255])))}}Y.types=void 0;Y.HDLR_TYPES=void 0;Y.STTS=void 0;Y.STSC=void 0;Y.STCO=void 0;Y.STSZ=void 0;Y.VMHD=void 0;Y.SMHD=void 0;Y.STSD=void 0;Y.FTYP=void 0;Y.DINF=void 0;const ET=9e4;function zy(s,e,t=1,n=!1){const i=s*e*t;return n?Math.round(i):i}function wO(s,e,t=1,n=!1){return zy(s,e,1/t,n)}function nh(s,e=!1){return zy(s,1e3,1/ET,e)}function RO(s,e=1){return zy(s,ET,1/e)}const LO=10*1e3,kO=1024,IO=1152,DO=1536;let Mo=null,Fm=null;function lb(s,e,t,n){return{duration:e,size:t,cts:n,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:s?2:1,isNonSync:s?0:1}}}class Z0{constructor(e,t,n,i){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=i,this.ISGenerated=!1,Mo===null){const l=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Mo=l?parseInt(l[1]):0}if(Fm===null){const a=navigator.userAgent.match(/Safari\/(\d+)/i);Fm=a?parseInt(a[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,i=e.reduce((a,l)=>{let c=l.pts,h=c-a;return h<-4294967296&&(t=!0,c=Is(c,n),h=c-a),h>0?a:c},n);return t&&this.logger.debug("PTS rollover detected"),i}remux(e,t,n,i,a,l,c,h){let f,g,m,y,v,x,b=a,A=a;const S=e.pid>-1,k=t.pid>-1,R=t.samples.length,_=e.samples.length>0,C=c&&R>0||R>1;if((!S||_)&&(!k||C)||this.ISGenerated||c){if(this.ISGenerated){var O,B,F,M;const pe=this.videoTrackConfig;(pe&&(t.width!==pe.width||t.height!==pe.height||((O=t.pixelRatio)==null?void 0:O[0])!==((B=pe.pixelRatio)==null?void 0:B[0])||((F=t.pixelRatio)==null?void 0:F[1])!==((M=pe.pixelRatio)==null?void 0:M[1]))||!pe&&C||this.nextAudioPts===null&&_)&&this.resetInitSegment()}this.ISGenerated||(m=this.generateIS(e,t,a,l));const j=this.isVideoContiguous;let ae=-1,ye;if(C&&(ae=CO(t.samples),!j&&this.config.forceKeyFrameOnDiscontinuity))if(x=!0,ae>0){this.logger.warn(`[mp4-remuxer]: Dropped ${ae} out of ${R} video samples due to a missing keyframe`);const pe=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(ae),t.dropped+=ae,A+=(t.samples[0].pts-pe)/t.inputTimeScale,ye=A}else ae===-1&&(this.logger.warn(`[mp4-remuxer]: No keyframe found out of ${R} video samples`),x=!1);if(this.ISGenerated){if(_&&C){const pe=this.getVideoStartPts(t.samples),G=(Is(e.samples[0].pts,pe)-pe)/t.inputTimeScale;b+=Math.max(0,G),A+=Math.max(0,-G)}if(_){if(e.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),m=this.generateIS(e,t,a,l)),g=this.remuxAudio(e,b,this.isAudioContiguous,l,k||C||h===Te.AUDIO?A:void 0),C){const pe=g?g.endPTS-g.startPTS:0;t.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),m=this.generateIS(e,t,a,l)),f=this.remuxVideo(t,A,j,pe)}}else C&&(f=this.remuxVideo(t,A,j,0));f&&(f.firstKeyFrame=ae,f.independent=ae!==-1,f.firstKeyFramePTS=ye)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(v=bT(n,a,this._initPTS,this._initDTS)),i.samples.length&&(y=AT(i,a,this._initPTS))),{audio:g,video:f,initSegment:m,independent:x,text:y,id3:v}}generateIS(e,t,n,i){const a=e.samples,l=t.samples,c=this.typeSupported,h={},f=this._initPTS;let g=!f||i,m="audio/mp4",y,v,x;if(g&&(y=v=1/0),e.config&&a.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":c.mpeg?(m="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}h.audio={id:"audio",container:m,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&c.mpeg?new Uint8Array(0):Y.initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(x=e.inputTimeScale,!f||x!==f.timescale?y=v=a[0].pts-Math.round(x*n):g=!1)}if(t.sps&&t.pps&&l.length){if(t.timescale=t.inputTimeScale,h.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Y.initSegment([t]),metadata:{width:t.width,height:t.height}},g)if(x=t.inputTimeScale,!f||x!==f.timescale){const b=this.getVideoStartPts(l),A=Math.round(x*n);v=Math.min(v,Is(l[0].dts,b)-A),y=Math.min(y,b-A)}else g=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(h).length)return this.ISGenerated=!0,g?(this._initPTS={baseTime:y,timescale:x},this._initDTS={baseTime:v,timescale:x}):y=x=void 0,{tracks:h,initPTS:y,timescale:x}}remuxVideo(e,t,n,i){const a=e.inputTimeScale,l=e.samples,c=[],h=l.length,f=this._initPTS;let g=this.nextAvcDts,m=8,y=this.videoSampleDuration,v,x,b=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,S=!1;if(!n||g===null){const Z=t*a,I=l[0].pts-Is(l[0].dts,l[0].pts);Mo&&g!==null&&Math.abs(Z-I-g)<15e3?n=!0:g=Z-I}const k=f.baseTime*a/f.timescale;for(let Z=0;Z<h;Z++){const I=l[Z];I.pts=Is(I.pts-k,g),I.dts=Is(I.dts-k,g),I.dts<l[Z>0?Z-1:Z].dts&&(S=!0)}S&&l.sort(function(Z,I){const V=Z.dts-I.dts,ie=Z.pts-I.pts;return V||ie}),v=l[0].dts,x=l[l.length-1].dts;const R=x-v,_=R?Math.round(R/(h-1)):y||e.inputTimeScale/30;if(n){const Z=v-g,I=Z>_,V=Z<-1;if((I||V)&&(I?this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${nh(Z,!0)} ms (${Z}dts) hole between fragments detected at ${t.toFixed(3)}`):this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${nh(-Z,!0)} ms (${Z}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!V||g>=l[0].pts||Mo)){v=g;const ie=l[0].pts-Z;if(I)l[0].dts=v,l[0].pts=ie;else{let ce=!0;for(let ue=0;ue<l.length&&!(l[ue].dts>ie&&ce);ue++){const xe=l[ue].pts;if(l[ue].dts-=Z,l[ue].pts-=Z,ue<l.length-1){const ve=l[ue+1].pts,$e=l[ue].pts,ke=ve<=$e,Ne=ve<=xe;ce=ke==Ne}}}this.logger.log(`Video: Initial PTS/DTS adjusted: ${nh(ie,!0)}/${nh(v,!0)}, delta: ${nh(Z,!0)} ms`)}}v=Math.max(0,v);let C=0,U=0,O=v;for(let Z=0;Z<h;Z++){const I=l[Z],V=I.units,ie=V.length;let ce=0;for(let ue=0;ue<ie;ue++)ce+=V[ue].data.length;U+=ce,C+=ie,I.length=ce,I.dts<O?(I.dts=O,O+=_/4|0||1):O=I.dts,b=Math.min(I.pts,b),A=Math.max(I.pts,A)}x=l[h-1].dts;const B=U+4*C+8;let F;try{F=new Uint8Array(B)}catch(Z){this.observer.emit(T.ERROR,T.ERROR,{type:Re.MUX_ERROR,details:Q.REMUX_ALLOC_ERROR,fatal:!1,error:Z,bytes:B,reason:`fail allocating video mdat ${B}`});return}const M=new DataView(F.buffer);M.setUint32(0,B),F.set(Y.types.mdat,4);let j=!1,ae=Number.POSITIVE_INFINITY,ye=Number.POSITIVE_INFINITY,pe=Number.NEGATIVE_INFINITY,W=Number.NEGATIVE_INFINITY;for(let Z=0;Z<h;Z++){const I=l[Z],V=I.units;let ie=0;for(let xe=0,ve=V.length;xe<ve;xe++){const $e=V[xe],ke=$e.data,Ne=$e.data.byteLength;M.setUint32(m,Ne),m+=4,F.set(ke,m),m+=Ne,ie+=4+Ne}let ce;if(Z<h-1)y=l[Z+1].dts-I.dts,ce=l[Z+1].pts-I.pts;else{const xe=this.config,ve=Z>0?I.dts-l[Z-1].dts:_;if(ce=Z>0?I.pts-l[Z-1].pts:_,xe.stretchShortVideoTrack&&this.nextAudioPts!==null){const $e=Math.floor(xe.maxBufferHole*a),ke=(i?b+i*a:this.nextAudioPts)-I.pts;ke>$e?(y=ke-ve,y<0?y=ve:j=!0,this.logger.log(`[mp4-remuxer]: It is approximately ${ke/90} ms to the next segment; using duration ${y/90} ms for the last video frame.`)):y=ve}else y=ve}const ue=Math.round(I.pts-I.dts);ae=Math.min(ae,y),pe=Math.max(pe,y),ye=Math.min(ye,ce),W=Math.max(W,ce),c.push(lb(I.key,y,ie,ue))}if(c.length){if(Mo){if(Mo<70){const Z=c[0].flags;Z.dependsOn=2,Z.isNonSync=0}}else if(Fm&&W-ye<pe-ae&&_/pe<.025&&c[0].cts===0){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let Z=v;for(let I=0,V=c.length;I<V;I++){const ie=Z+c[I].duration,ce=Z+c[I].cts;if(I<V-1){const ue=ie+c[I+1].cts;c[I].duration=ue-ce}else c[I].duration=I?c[I-1].duration:_;c[I].cts=0,Z=ie}}}y=j||!y?_:y,this.nextAvcDts=g=x+y,this.videoSampleDuration=y,this.isVideoContiguous=!0;const se={data1:Y.moof(e.sequenceNumber++,v,ht(e,{samples:c})),data2:F,startPTS:b/a,endPTS:(A+y)/a,startDTS:v/a,endDTS:g/a,type:"video",hasAudio:!1,hasVideo:!0,nb:c.length,dropped:e.dropped};return e.samples=[],e.dropped=0,se}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return IO;case"ac3":return DO;default:return kO}}remuxAudio(e,t,n,i,a){const l=e.inputTimeScale,c=e.samplerate?e.samplerate:l,h=l/c,f=this.getSamplesPerFrame(e),g=f*h,m=this._initPTS,y=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,v=[],x=a!==void 0;let b=e.samples,A=y?0:8,S=this.nextAudioPts||-1;const k=t*l,R=m.baseTime*l/m.timescale;if(this.isAudioContiguous=n=n||b.length&&S>0&&(i&&Math.abs(k-S)<9e3||Math.abs(Is(b[0].pts-R,k)-S)<20*g),b.forEach(function(G){G.pts=Is(G.pts-R,k)}),!n||S<0){if(b=b.filter(G=>G.pts>=0),!b.length)return;a===0?S=0:i&&!x?S=Math.max(0,k):S=b[0].pts}if(e.segmentCodec==="aac"){const G=this.config.maxAudioFramesDrift;for(let te=0,se=S;te<b.length;te++){const Z=b[te],I=Z.pts,V=I-se,ie=Math.abs(1e3*V/l);if(V<=-G*g&&x)te===0&&(this.logger.warn(`Audio frame @ ${(I/l).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*V/l)} ms.`),this.nextAudioPts=S=se=I);else if(V>=G*g&&ie<LO&&x){let ce=Math.round(V/g);se=I-ce*g,se<0&&(ce--,se+=g),te===0&&(this.nextAudioPts=S=se),this.logger.warn(`[mp4-remuxer]: Injecting ${ce} audio frame @ ${(se/l).toFixed(3)}s due to ${Math.round(1e3*V/l)} ms gap.`);for(let ue=0;ue<ce;ue++){const xe=Math.max(se,0);let ve=TO.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);ve||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),ve=Z.unit.subarray()),b.splice(te,0,{unit:ve,pts:xe}),se+=g,te++}}Z.pts=se,se+=g}}let _=null,C=null,U,O=0,B=b.length;for(;B--;)O+=b[B].unit.byteLength;for(let G=0,te=b.length;G<te;G++){const se=b[G],Z=se.unit;let I=se.pts;if(C!==null){const ie=v[G-1];ie.duration=Math.round((I-C)/h)}else if(n&&e.segmentCodec==="aac"&&(I=S),_=I,O>0){O+=A;try{U=new Uint8Array(O)}catch(ie){this.observer.emit(T.ERROR,T.ERROR,{type:Re.MUX_ERROR,details:Q.REMUX_ALLOC_ERROR,fatal:!1,error:ie,bytes:O,reason:`fail allocating audio mdat ${O}`});return}y||(new DataView(U.buffer).setUint32(0,O),U.set(Y.types.mdat,4))}else return;U.set(Z,A);const V=Z.byteLength;A+=V,v.push(lb(!0,f,V,0)),C=I}const F=v.length;if(!F)return;const M=v[v.length-1];this.nextAudioPts=S=C+h*M.duration;const j=y?new Uint8Array(0):Y.moof(e.sequenceNumber++,_/h,ht({},e,{samples:v}));e.samples=[];const ae=_/l,ye=S/l,W={data1:j,data2:U,startPTS:ae,endPTS:ye,startDTS:ae,endDTS:ye,type:"audio",hasAudio:!0,hasVideo:!1,nb:F};return this.isAudioContiguous=!0,W}}function Is(s,e){let t;if(e===null)return s;for(e<s?t=-8589934592:t=8589934592;Math.abs(s-e)>4294967296;)s+=t;return s}function CO(s){for(let e=0;e<s.length;e++)if(s[e].key)return e;return-1}function bT(s,e,t,n){const i=s.samples.length;if(!i)return;const a=s.inputTimeScale;for(let c=0;c<i;c++){const h=s.samples[c];h.pts=Is(h.pts-t.baseTime*a/t.timescale,e*a)/a,h.dts=Is(h.dts-n.baseTime*a/n.timescale,e*a)/a}const l=s.samples;return s.samples=[],{samples:l}}function AT(s,e,t){const n=s.samples.length;if(!n)return;const i=s.inputTimeScale;for(let l=0;l<n;l++){const c=s.samples[l];c.pts=Is(c.pts-t.baseTime*i/t.timescale,e*i)/i}s.samples.sort((l,c)=>l.pts-c.pts);const a=s.samples;return s.samples=[],{samples:a}}class _O{constructor(e,t,n,i){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.logger=i}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(EC(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const i=this.initData=CS(e);i.audio&&(t=ob(i.audio,ut.AUDIO)),i.video&&(n=ob(i.video,ut.VIDEO));const a={};i.audio&&i.video?a.audiovideo={container:"video/mp4",codec:t+","+n,supplemental:i.video.supplemental,initSegment:e,id:"main"}:i.audio?a.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?a.video={container:"video/mp4",codec:n,supplemental:i.video.supplemental,initSegment:e,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=a}remux(e,t,n,i,a,l){var c,h;let{initPTS:f,lastEndTime:g}=this;const m={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};Ee(g)||(g=this.lastEndTime=a||0);const y=t.samples;if(!(y!=null&&y.length))return m;const v={initPTS:void 0,timescale:1};let x=this.initData;if((c=x)!=null&&c.length||(this.generateInitSegment(y),x=this.initData),!((h=x)!=null&&h.length))return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),m;this.emitInitSegment&&(v.tracks=this.initTracks,this.emitInitSegment=!1);const b=AC(y,x),A=bC(x,y),S=A===null?a:A;(l||!f)&&(OO(f,S,a,b)||v.timescale!==f.timescale)&&(v.initPTS=S-a,f&&f.timescale===1&&this.logger.warn(`Adjusting initPTS @${a} from ${f.baseTime/f.timescale} to ${v.initPTS}`),this.initPTS=f={baseTime:v.initPTS,timescale:1});const k=e?S-f.baseTime/f.timescale:g,R=k+b;TC(x,y,f.baseTime/f.timescale),b>0?this.lastEndTime=R:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const _=!!x.audio,C=!!x.video;let U="";_&&(U+="audio"),C&&(U+="video");const O={data1:y,startPTS:k,startDTS:k,endPTS:R,endDTS:R,type:U,hasAudio:_,hasVideo:C,nb:1,dropped:0};return m.audio=O.type==="audio"?O:void 0,m.video=O.type!=="audio"?O:void 0,m.initSegment=v,m.id3=bT(n,a,f,f),i.samples.length&&(m.text=AT(i,a,f)),m}}function OO(s,e,t,n){if(s===null)return!0;const i=Math.max(n,1),a=e-s.baseTime/s.timescale;return Math.abs(a-t)>i}function ob(s,e){const t=s==null?void 0:s.codec;return t&&t.length>4?t:e===ut.AUDIO?t==="ec-3"||t==="ac-3"||t==="alac"?t:t==="fLaC"||t==="Opus"?pd(t,!1):(Je.warn(`Unhandled audio codec "${t}" in mp4 MAP`),t||"mp4a"):(Je.warn(`Unhandled video codec "${t}" in mp4 MAP`),t||"avc1")}let Ji;try{Ji=self.performance.now.bind(self.performance)}catch{Ji=Date.now}const J0=[{demux:EO,remux:_O},{demux:ra,remux:Z0},{demux:pO,remux:Z0},{demux:vO,remux:Z0}];J0.splice(2,0,{demux:yO,remux:Z0});class cb{constructor(e,t,n,i,a,l){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.id=a,this.logger=l}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const a=n.transmuxing;a.executeStart=Ji();let l=new Uint8Array(e);const{currentTransmuxState:c,transmuxConfig:h}=this;i&&(this.currentTransmuxState=i);const{contiguous:f,discontinuity:g,trackSwitch:m,accurateTimeOffset:y,timeOffset:v,initSegmentChange:x}=i||c,{audioCodec:b,videoCodec:A,defaultInitPts:S,duration:k,initSegmentData:R}=h,_=MO(l,t);if(_&&Xo(_.method)){const B=this.getDecrypter(),F=My(_.method);if(B.isSync()){let M=B.softwareDecrypt(l,_.key.buffer,_.iv.buffer,F);if(n.part>-1){const ae=B.flush();M=ae&&ae.buffer}if(!M)return a.executeEnd=Ji(),Gm(n);l=new Uint8Array(M)}else return this.asyncResult=!0,this.decryptionPromise=B.webCryptoDecrypt(l,_.key.buffer,_.iv.buffer,F).then(M=>{const j=this.push(M,null,n);return this.decryptionPromise=null,j}),this.decryptionPromise}const C=this.needsProbing(g,m);if(C){const B=this.configureTransmuxer(l);if(B)return this.logger.warn(`[transmuxer] ${B.message}`),this.observer.emit(T.ERROR,T.ERROR,{type:Re.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,error:B,reason:B.message}),a.executeEnd=Ji(),Gm(n)}(g||m||x||C)&&this.resetInitSegment(R,b,A,k,t),(g||x||C)&&this.resetInitialTimestamp(S),f||this.resetContiguity();const U=this.transmux(l,_,v,y,n);this.asyncResult=Lh(U);const O=this.currentTransmuxState;return O.contiguous=!0,O.discontinuity=!1,O.trackSwitch=!1,a.executeEnd=Ji(),U}flush(e){const t=e.transmuxing;t.executeStart=Ji();const{decrypter:n,currentTransmuxState:i,decryptionPromise:a}=this;if(a)return this.asyncResult=!0,a.then(()=>this.flush(e));const l=[],{timeOffset:c}=i;if(n){const m=n.flush();m&&l.push(this.push(m.buffer,null,e))}const{demuxer:h,remuxer:f}=this;if(!h||!f){t.executeEnd=Ji();const m=[Gm(e)];return this.asyncResult?Promise.resolve(m):m}const g=h.flush(c);return Lh(g)?(this.asyncResult=!0,g.then(m=>(this.flushRemux(l,m,e),l))):(this.flushRemux(l,g,e),this.asyncResult?Promise.resolve(l):l)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:a,id3Track:l,textTrack:c}=t,{accurateTimeOffset:h,timeOffset:f}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${n.sn}${n.part>-1?" part: "+n.part:""} of ${this.id===Te.MAIN?"level":"track"} ${n.level}`);const g=this.remuxer.remux(i,a,l,c,f,h,!0,this.id);e.push({remuxResult:g,chunkMeta:n}),n.transmuxing.executeEnd=Ji()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,a){const{demuxer:l,remuxer:c}=this;!l||!c||(l.resetInitSegment(e,t,n,i),c.resetInitSegment(e,t,n,a))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,a){let l;return t&&t.method==="SAMPLE-AES"?l=this.transmuxSampleAes(e,t,n,i,a):l=this.transmuxUnencrypted(e,n,i,a),l}transmuxUnencrypted(e,t,n,i){const{audioTrack:a,videoTrack:l,id3Track:c,textTrack:h}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(a,l,c,h,t,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,n,i,a){return this.demuxer.demuxSampleAes(e,t,n).then(l=>({remuxResult:this.remuxer.remux(l.audioTrack,l.videoTrack,l.id3Track,l.textTrack,n,i,!1,this.id),chunkMeta:a}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i}=this;let a;for(let m=0,y=J0.length;m<y;m++){var l;if((l=J0[m].demux)!=null&&l.probe(e,this.logger)){a=J0[m];break}}if(!a)return new Error("Failed to find demuxer by probing fragment data");const c=this.demuxer,h=this.remuxer,f=a.remux,g=a.demux;(!h||!(h instanceof f))&&(this.remuxer=new f(n,t,i,this.logger)),(!c||!(c instanceof g))&&(this.demuxer=new g(n,t,i,this.logger),this.probe=g.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new _y(this.config)),e}}function MO(s,e){let t=null;return s.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Gm=s=>({remuxResult:{},chunkMeta:s});function Lh(s){return"then"in s&&s.then instanceof Function}class PO{constructor(e,t,n,i,a){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=a||null}}class NO{constructor(e,t,n,i,a,l){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=a,this.initSegmentChange=l}}let ub=0;class ST{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=ub++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=h=>{const f=h.data,g=this.hls;if(!(!g||!(f!=null&&f.event)||f.instanceNo!==this.instanceNo))switch(f.event){case"init":{var m;const y=(m=this.workerContext)==null?void 0:m.objectURL;y&&self.URL.revokeObjectURL(y);break}case"transmuxComplete":{this.handleTransmuxComplete(f.data);break}case"flush":{this.onFlush(f.data);break}case"workerLog":{g.logger[f.data.logType]&&g.logger[f.data.logType](f.data.message);break}default:{f.data=f.data||{},f.data.frag=this.frag,f.data.part=this.part,f.data.id=this.id,g.trigger(f.event,f.data);break}}},this.onWorkerError=h=>{if(!this.hls)return;const f=new Error(`${h.message}  (${h.filename}:${h.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(T.ERROR,{type:Re.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:f})};const a=e.config;this.hls=e,this.id=t,this.useWorker=!!a.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const l=(h,f)=>{f=f||{},f.frag=this.frag||void 0,h===T.ERROR&&(f=f,f.parent=this.id,f.part=this.part,this.error=f.error),this.hls.trigger(h,f)};this.observer=new By,this.observer.on(T.FRAG_DECRYPTED,l),this.observer.on(T.ERROR,l);const c=RE(a.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const h=this.hls.logger;if(a.workerPath||F_()){try{a.workerPath?(h.log(`loading Web Worker ${a.workerPath} for "${t}"`),this.workerContext=$_(a.workerPath)):(h.log(`injecting Web Worker for "${t}"`),this.workerContext=G_());const{worker:g}=this.workerContext;g.addEventListener("message",this.onWorkerMessage),g.addEventListener("error",this.onWorkerError),g.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:c,id:t,config:St(a)})}catch(g){h.warn(`Error setting up "${t}" Web Worker, fallback to inline`,g),this.terminateWorker(),this.error=null,this.transmuxer=new cb(this.observer,c,a,"",t,e.logger)}return}}this.transmuxer=new cb(this.observer,c,a,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=ub++;const t=this.hls.config,n=RE(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:n,id:this.id,config:St(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),H_(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,n,i,a,l,c,h,f,g){var m,y;f.transmuxing.start=self.performance.now();const{instanceNo:v,transmuxer:x}=this,b=l?l.start:a.start,A=a.decryptdata,S=this.frag,k=!(S&&a.cc===S.cc),R=!(S&&f.level===S.level),_=S?f.sn-S.sn:-1,C=this.part?f.part-this.part.index:-1,U=_===0&&f.id>1&&f.id===(S==null?void 0:S.stats.chunkCount),O=!R&&(_===1||_===0&&(C===1||U&&C<=0)),B=self.performance.now();(R||_||a.stats.parsing.start===0)&&(a.stats.parsing.start=B),l&&(C||!O)&&(l.stats.parsing.start=B);const F=!(S&&((m=a.initSegment)==null?void 0:m.url)===((y=S.initSegment)==null?void 0:y.url)),M=new NO(k,O,h,R,b,F);if(!O||k||F){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${a.type} sn: ${f.sn}${f.part>-1?" part: "+f.part:""} ${this.id===Te.MAIN?"level":"track"}: ${f.level} id: ${f.id}
        discontinuity: ${k}
        trackSwitch: ${R}
        contiguous: ${O}
        accurateTimeOffset: ${h}
        timeOffset: ${b}
        initSegmentChange: ${F}`);const j=new PO(n,i,t,c,g);this.configureTransmuxer(j)}if(this.frag=a,this.part=l,this.workerContext)this.workerContext.worker.postMessage({instanceNo:v,cmd:"demux",data:e,decryptdata:A,chunkMeta:f,state:M},e instanceof ArrayBuffer?[e]:[]);else if(x){const j=x.push(e,A,f,M);Lh(j)?j.then(ae=>{this.handleTransmuxComplete(ae)}).catch(ae=>{this.transmuxerError(ae,f,"transmuxer-interface push error")}):this.handleTransmuxComplete(j)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(n){const i=n.flush(e);Lh(i)?i.then(a=>{this.handleFlushResult(a,e)}).catch(a=>{this.transmuxerError(a,e,"transmuxer-interface flush error")}):this.handleFlushResult(i,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(T.ERROR,{type:Re.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):n&&n.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const hb=100;class BO extends Ny{constructor(e,t,n){super(e,t,n,"audio-stream-controller",Te.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(T.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(T.BUFFER_RESET,this.onBufferReset,this),e.on(T.BUFFER_CREATED,this.onBufferCreated,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(T.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(T.FRAG_LOADING,this.onFragLoading,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(T.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(T.BUFFER_RESET,this.onBufferReset,this),e.off(T.BUFFER_CREATED,this.onBufferCreated,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(T.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(T.FRAG_LOADING,this.onFragLoading,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:a}){if(n===Te.MAIN){const l=t.cc,c=this.fragCurrent;if(this.initPTS[l]={baseTime:i,timescale:a},this.log(`InitPTS for cc: ${l} found from main: ${i}/${a}`),this.mainAnchor=t,this.state===oe.WAITING_INIT_PTS){const h=this.waitingData;(!h&&!this.loadingParts||h&&h.frag.cc!==l)&&(this.nextLoadPosition=this.findSyncFrag(t).start),this.tick()}else!this.hls.hasEnoughToStart&&c&&c.cc!==l?(this.startFragRequested=!1,this.nextLoadPosition=this.findSyncFrag(t).start,c.abortRequests(),this.resetLoadingState()):this.state===oe.IDLE&&this.tick()}}findSyncFrag(e){const t=this.getLevelDetails(),n=e.cc;return JC(t,n,e)||t&&HS(t.fragments,n)||e}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=oe.STOPPED;return}const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(hb),n>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n,this.state=oe.IDLE):this.state=oe.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case oe.IDLE:this.doTickIdle();break;case oe.WAITING_TRACK:{const{levels:t,trackId:n}=this,i=t==null?void 0:t[n],a=i==null?void 0:i.details;if(a&&!this.waitForLive(i)){if(this.waitForCdnTuneIn(a))break;this.state=oe.WAITING_INIT_PTS}break}case oe.FRAG_LOADING_WAITING_RETRY:{var e;const t=performance.now(),n=this.retryDate;if(!n||t>=n||(e=this.media)!=null&&e.seeking){const{levels:i,trackId:a}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((i==null?void 0:i[a])||null),this.state=oe.IDLE}break}case oe.WAITING_INIT_PTS:{const t=this.waitingData;if(t){const{frag:n,part:i,cache:a,complete:l}=t,c=this.mainAnchor;if(this.initPTS[n.cc]!==void 0){this.waitingData=null,this.state=oe.FRAG_LOADING;const h=a.flush().buffer,f={frag:n,part:i,payload:h,networkDetails:null};this._handleFragmentLoadProgress(f),l&&super._handleFragmentLoadComplete(f)}else c&&c.cc!==t.frag.cc&&(this.log(`Waiting fragment cc (${n.cc}) cancelled because video is at cc ${c.cc}`),this.nextLoadPosition=this.findSyncFrag(c).start,this.clearWaitingFragment())}else this.state=oe.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.state!==oe.STOPPED&&(this.state=oe.IDLE))}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:n,media:i,trackId:a}=this,l=t.config;if(!this.buffering||!i&&!this.primaryPrefetch&&(this.startFragRequested||!l.startFragPrefetch)||!(n!=null&&n[a]))return;const c=n[a],h=c.details;if(!h||this.waitForLive(c)||this.waitForCdnTuneIn(h)){this.state=oe.WAITING_TRACK,this.startFragRequested=!1;return}const f=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&f&&(this.bufferFlushed=!1,this.afterBufferFlushed(f,ut.AUDIO,Te.AUDIO));const g=this.getFwdBufferInfo(f,Te.AUDIO);if(g===null)return;if(!this.switchingTrack&&this._streamEnded(g,h)){t.trigger(T.BUFFER_EOS,{type:"audio"}),this.state=oe.ENDED;return}const m=g.len,y=t.maxBufferLength,v=h.fragments,x=v[0].start,b=this.getLoadPosition(),A=this.flushing?b:g.end;if(this.switchingTrack&&i){const R=b;h.PTSKnown&&R<x&&(g.end>x||g.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=x+.05)}if(m>=y&&!this.switchingTrack&&A<v[v.length-1].start)return;let S=this.getNextFragment(A,h);if(S&&this.isLoopLoading(S,A)&&(S=this.getNextFragmentLoopLoading(S,h,g,Te.MAIN,y)),!S){this.bufferFlushed=!0;return}let k=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&k&&ln(S)&&!S.endList&&(!h.live||!this.loadingParts&&A<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(k)===Xt.OK&&(this.mainFragLoading=k=null),k&&ln(k))){if(S.start>k.end){const _=this.fragmentTracker.getFragAtPos(A,Te.MAIN);_&&_.end>k.end&&(k=_,this.mainFragLoading={frag:_,targetBufferTime:null})}if(S.start>k.end)return}this.loadFragment(S,c,A)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new Ah(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==oe.STOPPED&&(this.setInterval(hb),this.state=oe.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const n=this.cachedTrackLoadedData;n&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(T.AUDIO_TRACK_LOADED,n))}onAudioTrackLoaded(e,t){var n;const{levels:i}=this,{details:a,id:l,groupId:c,track:h}=t;if(!i){this.warn(`Audio tracks reset while loading track ${l} "${h.name}" of "${c}"`);return}const f=this.mainDetails;if(!f||a.endCC>f.endCC||f.expired){this.cachedTrackLoadedData=t,this.state!==oe.STOPPED&&(this.state=oe.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${l} "${h.name}" of "${c}" loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`);const g=i[l];let m=0;if(a.live||(n=g.details)!=null&&n.live){if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;if(g.details){var y;m=this.alignPlaylists(a,g.details,(y=this.levelLastLoaded)==null?void 0:y.details)}a.alignedSliding||(nT(a,f),a.alignedSliding||Ad(a,f),m=a.fragmentStart)}g.details=a,this.levelLastLoaded=g,this.startFragRequested||this.setStartPosition(f,m),this.hls.trigger(T.AUDIO_TRACK_UPDATED,{details:a,id:l,groupId:t.groupId}),this.state===oe.WAITING_TRACK&&!this.waitForCdnTuneIn(a)&&(this.state=oe.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:i,payload:a}=e,{config:l,trackId:c,levels:h}=this;if(!h){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const f=h[c];if(!f){this.warn("Audio track is undefined on fragment load progress");return}const g=f.details;if(!g){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const m=l.defaultAudioCodec||f.audioCodec||"mp4a.40.2";let y=this.transmuxer;y||(y=this.transmuxer=new ST(this.hls,Te.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const v=this.initPTS[n.cc],x=(t=n.initSegment)==null?void 0:t.data;if(v!==void 0){const A=i?i.index:-1,S=A!==-1,k=new Oy(n.level,n.sn,n.stats.chunkCount,a.byteLength,A,S);y.push(a,x,m,"",n,i,g.totalduration,!1,k,v)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${g.startSN} ,${g.endSN}],track ${c}`);const{cache:b}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new sT,complete:!1};b.push(new Uint8Array(a)),this.state!==oe.STOPPED&&(this.state=oe.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===Te.MAIN&&ln(t.frag)&&(this.mainFragLoading=t,this.state===oe.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type!==Te.AUDIO){!this.audioOnly&&n.type===Te.MAIN&&!n.elementaryStreams.video&&!n.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(ln(n)){this.fragPrevious=n;const a=this.switchingTrack;a&&(this.bufferedTrack=a,this.switchingTrack=null,this.hls.trigger(T.AUDIO_TRACK_SWITCHED,lt({},a)))}this.fragBufferedComplete(n,i),this.media&&this.tick()}onError(e,t){var n;if(t.fatal){this.state=oe.ERROR;return}switch(t.details){case Q.FRAG_GAP:case Q.FRAG_PARSING_ERROR:case Q.FRAG_DECRYPT_ERROR:case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Te.AUDIO,t);break;case Q.AUDIO_TRACK_LOAD_ERROR:case Q.AUDIO_TRACK_LOAD_TIMEOUT:case Q.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===oe.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===qe.AUDIO_TRACK&&(this.state=oe.IDLE);break;case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.resetLoadingState();break;case Q.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Q.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==ut.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==ut.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===oe.ENDED&&(this.state=oe.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,Te.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:a,chunkMeta:l}=e,c=this.getCurrentContext(l);if(!c){this.resetWhenMissingContext(l);return}const{frag:h,part:f,level:g}=c,{details:m}=g,{audio:y,text:v,id3:x,initSegment:b}=a;if(this.fragContextChanged(h)||!m){this.fragmentTracker.removeFragment(h);return}if(this.state=oe.PARSING,this.switchingTrack&&y&&this.completeAudioSwitch(this.switchingTrack),b!=null&&b.tracks){const A=h.initSegment||h;this._bufferInitSegment(g,b.tracks,A,l),i.trigger(T.FRAG_PARSING_INIT_SEGMENT,{frag:A,id:n,tracks:b.tracks})}if(y){const{startPTS:A,endPTS:S,startDTS:k,endDTS:R}=y;f&&(f.elementaryStreams[ut.AUDIO]={startPTS:A,endPTS:S,startDTS:k,endDTS:R}),h.setElementaryStreamInfo(ut.AUDIO,A,S,k,R),this.bufferFragmentData(y,h,f,l)}if(x!=null&&(t=x.samples)!=null&&t.length){const A=ht({id:n,frag:h,details:m},x);i.trigger(T.FRAG_PARSING_METADATA,A)}if(v){const A=ht({id:n,frag:h,details:m},v);i.trigger(T.FRAG_PARSING_USERDATA,A)}}_bufferInitSegment(e,t,n,i){if(this.state!==oe.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const a=t.audio;a.id=Te.AUDIO;const l=e.audioCodec;this.log(`Init audio buffer, container:${a.container}, codecs[level/parsed]=[${l}/${a.codec}]`),l&&l.split(",").length===1&&(a.levelCodec=l),this.hls.trigger(T.BUFFER_CODECS,t);const c=a.initSegment;if(c!=null&&c.byteLength){const h={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:c};this.hls.trigger(T.BUFFER_APPENDING,h)}this.tickImmediate()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);if(this.switchingTrack||i===Xt.NOT_LOADED||i===Xt.PARTIAL){var a;if(!ln(e))this._loadInitSegment(e,t);else if((a=t.details)!=null&&a.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=oe.WAITING_INIT_PTS;const l=this.mainDetails;l&&l.fragmentStart!==t.details.fragmentStart&&Ad(t.details,l)}else super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:i,characteristics:a,audioCodec:l,channels:c}=this.bufferedTrack;Ml({name:t,lang:n,assocLang:i,characteristics:a,audioCodec:l,channels:c},e,sl)||(vd(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(T.AUDIO_TRACK_SWITCHED,lt({},e))}}class Vy extends Lr{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const i=t==null?void 0:t.renditionReports;if(i){let a=-1;for(let l=0;l<i.length;l++){const c=i[l];let h;try{h=new self.URL(c.URI,t.url).href}catch(f){this.warn(`Could not construct new URL for Rendition Report: ${f}`),h=c.URI||""}if(h===e){a=l;break}else h===e.substring(0,h.length)&&(a=l)}if(a!==-1){const l=i[a],c=parseInt(l["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let h=parseInt(l["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const g=Math.min(t.age-t.partTarget,t.targetduration);h>=0&&g>t.partTarget&&(h+=1)}const f=n&&kE(n);return new IE(c,h>=0?h:void 0,f)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(n){this.warn(`Could not construct new URL with HLS Delivery Directives: ${n}`)}return e}playlistLoaded(e,t,n){const{details:i,stats:a}=t,l=self.performance.now(),c=a.loading.first?Math.max(0,l-a.loading.first):0;i.advancedDateTime=Date.now()-c;const h=this.hls.config.timelineOffset;if(h!==i.appliedTimelineOffset){const g=Math.max(h||0,0);i.appliedTimelineOffset=g,i.fragments.forEach(m=>{m.start=m.playlistOffset+g})}if(i.live||n!=null&&n.live){const g="levelInfo"in t?t.levelInfo:t.track;if(i.reloaded(n),n&&i.fragments.length>0){I_(n,i);const k=i.playlistParsingError;if(k){this.warn(k);const R=this.hls;if(!R.config.ignorePlaylistParsingErrors){var f;const{networkDetails:_}=t;R.trigger(T.ERROR,{type:Re.NETWORK_ERROR,details:Q.LEVEL_PARSING_ERROR,fatal:!1,url:i.url,error:k,reason:k.message,level:t.level||void 0,parent:(f=i.fragments[0])==null?void 0:f.type,networkDetails:_,stats:a});return}i.playlistParsingError=null}}i.requestScheduled===-1&&(i.requestScheduled=a.loading.start);const m=this.hls.mainForwardBufferInfo,y=m?m.end-m.len:0,v=(i.edge-y)*1e3,x=WS(i,v);if(i.requestScheduled+x<l?i.requestScheduled=l:i.requestScheduled+=x,this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),!this.canLoad||!i.live)return;let b,A,S;if(i.canBlockReload&&i.endSN&&i.advanced){const k=this.hls.config.lowLatencyMode,R=i.lastPartSn,_=i.endSN,C=i.lastPartIndex,U=C!==-1,O=R===_;U?O?(A=_+1,S=k?0:C):(A=R,S=k?C+1:i.maxPartIndex):A=_+1;const B=i.age,F=B+i.ageHeader;let M=Math.min(F-i.partTarget,i.targetduration*1.5);if(M>0){if(F>i.targetduration*3)this.log(`Playlist last advanced ${B.toFixed(2)}s ago. Omitting segment and part directives.`),A=void 0,S=void 0;else if(n!=null&&n.tuneInGoal&&F-i.partTarget>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${M} with playlist age: ${i.age}`),M=0;else{const j=Math.floor(M/i.targetduration);if(A+=j,S!==void 0){const ae=Math.round(M%i.targetduration/i.partTarget);S+=ae}this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${B.toFixed(2)}s goal: ${M} skip sn ${j} to part ${S}`)}i.tuneInGoal=M}if(b=this.getDeliveryDirectives(i,t.deliveryDirectives,A,S),k||!O){i.requestScheduled=l,this.loadingPlaylist(g,b);return}}else(i.canBlockReload||i.canSkipUntil)&&(b=this.getDeliveryDirectives(i,t.deliveryDirectives,A,S));b&&A!==void 0&&i.canBlockReload&&(i.requestScheduled=a.loading.first+Math.max(x-c*2,x/2)),this.scheduleLoading(g,b,i)}else this.clearTimer()}scheduleLoading(e,t,n){const i=n||e.details;if(!i){this.loadingPlaylist(e,t);return}const a=self.performance.now(),l=i.requestScheduled;if(a>=l){this.loadingPlaylist(e,t);return}const c=l-a;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(c)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),c)}getDeliveryDirectives(e,t,n,i){let a=kE(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,a=W0.No),new IE(n,i,a)}checkRetry(e){const t=e.details,n=xd(e),i=e.errorAction,{action:a,retryCount:l=0,retryConfig:c}=i||{},h=!!i&&!!c&&(a===wn.RetryRequest||!i.resolved&&a===wn.SendAlternateToPenaltyBox);if(h){var f;if(l>=c.maxNumRetry)return!1;if(n&&(f=e.context)!=null&&f.deliveryDirectives)this.warn(`Retrying playlist loading ${l+1}/${c.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const g=Cy(c,l);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),g),this.warn(`Retrying playlist loading ${l+1}/${c.maxNumRetry} after "${t}" in ${g}ms`)}e.levelRetry=!0,i.resolved=!0}return h}}function TT(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!kh(s[t].attrs,e[t].attrs))return!1;return!0}function kh(s,e,t){const n=s["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(i=>s[i]!==e[i])}function Ip(s,e){return e.label.toLowerCase()===s.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(s.lang||"").toLowerCase())}class UO extends Vy{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.LEVEL_LOADING,this.onLevelLoading,this),e.on(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(T.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.LEVEL_LOADING,this.onLevelLoading,this),e.off(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(T.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(T.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:a}=t,l=this.tracksInGroup[n];if(!l||l.groupId!==i){this.warn(`Audio track with id:${n} and group:${i} not found in active group ${l==null?void 0:l.groupId}`);return}const c=l.details;l.details=t.details,this.log(`Audio track ${n} "${l.name}" lang:${l.lang} group:${i} loaded [${a.startSN}-${a.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,i=this.groupIds;let a=this.currentTrack;if(!n||(i==null?void 0:i.length)!==(n==null?void 0:n.length)||n!=null&&n.some(c=>(i==null?void 0:i.indexOf(c))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const c=this.tracks.filter(y=>!n||n.indexOf(y.groupId)!==-1);if(c.length)this.selectDefaultTrack&&!c.some(y=>y.default)&&(this.selectDefaultTrack=!1),c.forEach((y,v)=>{y.id=v});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=c;const h=this.hls.config.audioPreference;if(!a&&h){const y=Ti(h,c,sl);if(y>-1)a=c[y];else{const v=Ti(h,this.tracks);a=this.tracks[v]}}let f=this.findTrackId(a);f===-1&&a&&(f=this.findTrackId(null));const g={audioTracks:c};this.log(`Updating audio tracks, ${c.length} track(s) found in group(s): ${n==null?void 0:n.join(",")}`),this.hls.trigger(T.AUDIO_TRACKS_UPDATED,g);const m=this.trackId;if(f!==-1&&m===-1)this.setAudioTrack(f);else if(c.length&&m===-1){var l;const y=new Error(`No audio track selected for current audio group-ID(s): ${(l=this.groupIds)==null?void 0:l.join(",")} track count: ${c.length}`);this.warn(y.message),this.hls.trigger(T.ERROR,{type:Re.MEDIA_ERROR,details:Q.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:y})}}}onError(e,t){t.fatal||!t.context||t.context.type===qe.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&Ml(e,i,sl))return i;const a=Ti(e,this.tracksInGroup,sl);if(a>-1){const l=this.tracksInGroup[a];return this.setAudioTrack(a),l}else if(i){let l=t.loadLevel;l===-1&&(l=t.firstAutoLevel);const c=QC(e,t.levels,n,l,sl);if(c===-1)return null;t.nextLoadLevel=c}if(e.channels||e.audioCodec){const l=Ti(e,n);if(l>-1)return n[l]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e],a=i.details&&!i.details.live;if(e===this.trackId&&i===n&&a||(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger(T.AUDIO_TRACK_SWITCHING,lt({},i)),a))return;const l=this.switchParams(i.url,n==null?void 0:n.details,i.details);this.loadPlaylist(l)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(!(this.selectDefaultTrack&&!i.default)&&(!e||Ml(e,i,sl)))return n}if(e){const{name:n,lang:i,assocLang:a,characteristics:l,audioCodec:c,channels:h}=e;for(let f=0;f<t.length;f++){const g=t[f];if(Ml({name:n,lang:i,assocLang:a,characteristics:l,audioCodec:c,channels:h},g,sl))return f}for(let f=0;f<t.length;f++){const g=t[f];if(kh(e.attrs,g.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return f}for(let f=0;f<t.length;f++){const g=t[f];if(kh(e.attrs,g.attrs,["LANGUAGE"]))return f}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&vd(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,i=e.groupId,a=this.getUrlWithDirectives(e.url,t),l=e.details,c=l==null?void 0:l.age;this.log(`Loading audio-track ${n} "${e.name}" lang:${e.lang} group:${i}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${c&&l.live?" age "+c.toFixed(1)+(l.type&&" "+l.type||""):""} ${a}`),this.hls.trigger(T.AUDIO_TRACK_LOADING,{url:a,id:n,groupId:i,deliveryDirectives:t||null,track:e})}}class FO{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,n){if(this.queues===null||this.tracks===null)return;const i=this.queues[t];i.push(e),i.length===1&&!n&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const n={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(n,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const n={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(n)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const n=(t=e[0])==null?void 0:t.label;(n==="async-blocker"||n==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const i=t[0];try{i.execute()}catch(a){var n;if(i.onError(a),this.queues===null||this.tracks===null)return;const l=(n=this.tracks[e])==null?void 0:n.buffer;l!=null&&l.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,n;return(t=this.queues)!=null&&t[e]||(n=this.tracks)!=null&&n[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const n=(t=this.tracks)==null?void 0:t[e],i=n==null?void 0:n.buffer;return i?`SourceBuffer${i.updating?" updating":""}${n.ended?" ended":""}${n.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(n=>n.label).join(", "))||""}}const fb=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,wT="HlsJsTrackRemovedError";class GO extends Error{constructor(e){super(e),this.name=wT}}class $O extends Lr{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=n=>{var i;this.hls&&((i=this.mediaSource)==null?void 0:i.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=n=>{const{media:i,mediaSource:a}=this;n&&this.log("Media source opened"),!(!i||!a)&&(a.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(T.MEDIA_ATTACHED,{media:i,mediaSource:a}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:i}=this;n!==i&&this.error(`Media element src was set while attaching MediaSource (${i} > ${n})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=hC(Ra(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.BUFFER_RESET,this.onBufferReset,this),e.on(T.BUFFER_APPENDING,this.onBufferAppending,this),e.on(T.BUFFER_CODECS,this.onBufferCodecs,this),e.on(T.BUFFER_EOS,this.onBufferEos,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(T.FRAG_PARSED,this.onFragParsed,this),e.on(T.FRAG_CHANGED,this.onFragChanged,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.BUFFER_RESET,this.onBufferReset,this),e.off(T.BUFFER_APPENDING,this.onBufferAppending,this),e.off(T.BUFFER_CODECS,this.onBufferCodecs,this),e.off(T.BUFFER_EOS,this.onBufferEos,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(T.FRAG_PARSED,this.onFragParsed,this),e.off(T.FRAG_CHANGED,this.onFragChanged,this),e.off(T.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const n={};if(this.operationQueue){const a=this.isUpdating();a||this.operationQueue.removeBlockers();const l=this.isQueued();(a||l)&&this.warn(`Transfering MediaSource with${l?" operations in queue":""}${a?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const i=this.transferData;return!this.sourceBufferCount&&i&&i.mediaSource===t?ht(n,i.tracks):this.sourceBuffers.forEach(a=>{const[l]=a;l&&(n[l]=ht({},this.tracks[l]),this.removeBuffer(l)),a[0]=a[1]=null}),{media:e,mediaSource:t,tracks:n}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var n;let i=2;(t.audio&&!t.video||!t.altAudio)&&(i=1),this.bufferCodecEventsTotal=i,this.log(`${i} bufferCodec event(s) expected.`),(n=this.transferData)!=null&&n.mediaSource&&this.sourceBufferCount&&i&&this.bufferCreated()}onMediaAttaching(e,t){const n=this.media=t.media,i=Ra(this.appendSource);if(this.transferData=this.overrides=void 0,n&&i){const a=!!t.mediaSource;(a||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const l=this.mediaSource=t.mediaSource||new i;if(this.assignMediaSource(l),a)this._objectUrl=n.src,this.attachTransferred();else{const c=this._objectUrl=self.URL.createObjectURL(l);if(this.appendSource)try{n.removeAttribute("src");const h=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||h&&l instanceof h,db(n),HO(n,c),n.load()}catch{n.src=c}else n.src=c}n.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,n;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(n=e.constructor)==null?void 0:n.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const n=this.tracks,i=t.tracks,a=i?Object.keys(i):null,l=a?a.length:0,c=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(i&&a&&l){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${St(n,(h,f)=>h==="initSegment"?void 0:f)};
transfer tracks: ${St(i,(h,f)=>h==="initSegment"?void 0:f)}}`),!wS(i,n)){t.mediaSource=null,t.tracks=void 0;const h=e.currentTime,f=this.details,g=Math.max(h,(f==null?void 0:f.fragments[0].start)||0);if(g-h>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${h} -> ${g}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(i)}"->"${Object.keys(n)}") start time: ${g} currentTime: ${h}`),this.onMediaDetaching(T.MEDIA_DETACHING,{}),this.onMediaAttaching(T.MEDIA_ATTACHING,t),e.currentTime=g;return}this.transferData=void 0,a.forEach(h=>{const f=h,g=i[f];if(g){const m=g.buffer;if(m){const y=this.fragmentTracker,v=g.id;if(y.hasFragments(v)||y.hasParts(v)){const A=ze.getBuffered(m);y.detectEvictedFragments(f,A,v,null,!0)}const x=$m(f),b=[f,m];this.sourceBuffers[x]=b,m.updating&&this.operationQueue&&this.operationQueue.prependBlocker(f),this.trackSourceBuffer(f,g)}}}),c(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),c()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const n=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:i,mediaSource:a,_objectUrl:l}=this;if(a){if(this.log(`media source ${n?"transferring":"detaching"}`),n)this.sourceBuffers.forEach(([c])=>{c&&this.removeBuffer(c)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const c=a.readyState==="open";try{const h=a.sourceBuffers;for(let f=h.length;f--;)c&&h[f].abort(),a.removeSourceBuffer(h[f]);c&&a.endOfStream()}catch(h){this.warn(`onMediaDetaching: ${h.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}a.removeEventListener("sourceopen",this._onMediaSourceOpen),a.removeEventListener("sourceended",this._onMediaSourceEnded),a.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(a.removeEventListener("startstreaming",this._onStartStreaming),a.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}i&&(i.removeEventListener("emptied",this._onMediaEmptied),n||(l&&self.URL.revokeObjectURL(l),this.mediaSrc===l?(i.removeAttribute("src"),this.appendSource&&db(i),i.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(T.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const n=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),n)try{var i;(i=this.mediaSource)!=null&&i.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}catch(a){this.warn(`onBufferReset ${e}`,a)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[$m(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new FO(this.tracks)}onBufferCodecs(e,t){const n=this.tracks,i=Object.keys(t);this.log(`BUFFER_CODECS: "${i}" (current SB count ${this.sourceBufferCount})`);const a="audiovideo"in t&&(n.audio||n.video)||n.audiovideo&&("audio"in t||"video"in t),l=!a&&this.sourceBufferCount&&this.media&&i.some(c=>!n[c]);if(a||l){this.warn(`Unsupported transition between "${Object.keys(n)}" and "${i}" SourceBuffers`);return}i.forEach(c=>{var h,f,g;const m=t[c],{id:y,codec:v,levelCodec:x,container:b,metadata:A,supplemental:S}=m;let k=n[c];const R=(h=this.transferData)==null||(f=h.tracks)==null?void 0:f[c],_=R!=null&&R.buffer?R:k,C=(_==null?void 0:_.pendingCodec)||(_==null?void 0:_.codec),U=_==null?void 0:_.levelCodec;k||(k=n[c]={buffer:void 0,listeners:[],codec:v,supplemental:S,container:b,levelCodec:x,metadata:A,id:y});const O=X0(C,U),B=O==null?void 0:O.replace(fb,"$1");let F=X0(v,x);const M=(g=F)==null?void 0:g.replace(fb,"$1");F&&O&&B!==M&&(c.slice(0,5)==="audio"&&(F=pd(F,this.appendSource)),this.log(`switching codec ${C} to ${F}`),F!==(k.pendingCodec||k.codec)&&(k.pendingCodec=F),k.container=b,this.appendChangeType(c,b,F))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&this.mediaSourceOpenOrEnded&&this.checkPendingTracks()}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const n=this.tracks[t];return e[t]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},e},{})}appendChangeType(e,t,n){const i=`${t};codecs=${n}`,a={label:`change-type=${i}`,execute:()=>{const l=this.tracks[e];if(l){const c=l.buffer;c!=null&&c.changeType&&(this.log(`changing ${e} sourceBuffer type to ${i}`),c.changeType(i),l.codec=n,l.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:l=>{this.warn(`Failed to change ${e} SourceBuffer type`,l)}};this.append(a,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const n=e.start,i=n+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(n,Te.MAIN))==null?void 0:t.gap)===!0)return;const l={label:"block-audio",execute:()=>{var c;const h=this.tracks.video;(this.lastVideoAppendEnd>i||h!=null&&h.buffer&&ze.isBuffered(h.buffer,i)||((c=this.fragmentTracker.getAppendedFrag(i,Te.MAIN))==null?void 0:c.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:c=>{this.warn("Error executing block-audio operation",c)}};this.blockedAudioAppend={op:l,frag:e},this.append(l,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:n}=this,{data:i,type:a,parent:l,frag:c,part:h,chunkMeta:f}=t,g=f.buffering[a],m=c.sn,y=self.performance.now();g.start=y;const v=c.stats.buffering,x=h?h.stats.buffering:null;v.start===0&&(v.start=y),x&&x.start===0&&(x.start=y);const b=n.audio;let A=!1;a==="audio"&&(b==null?void 0:b.container)==="audio/mpeg"&&(A=!this.lastMpegAudioChunk||f.id===1||this.lastMpegAudioChunk.sn!==f.sn,this.lastMpegAudioChunk=f);const S=this.tracks.video,k=S==null?void 0:S.buffer;if(k&&m!=="initSegment"){const C=h||c,U=this.blockedAudioAppend;if(a==="audio"&&l!=="main"&&!this.blockedAudioAppend){const B=C.start+C.duration*.05,F=k.buffered,M=this.currentOp("video");!F.length&&!M?this.blockAudio(C):!M&&!ze.isBuffered(k,B)&&this.lastVideoAppendEnd<B&&this.blockAudio(C)}else if(a==="video"){const O=C.end;if(U){const B=U.frag.start;(O>B||O<this.lastVideoAppendEnd||ze.isBuffered(k,B))&&this.unblockAudio()}this.lastVideoAppendEnd=O}}const R=(h||c).start,_={label:`append-${a}`,execute:()=>{if(g.executeStart=self.performance.now(),A){const C=this.tracks[a];if(C){const U=C.buffer;if(U){const O=R-U.timestampOffset;Math.abs(O)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${R} (delta: ${O}) sn: ${m})`),U.timestampOffset=R)}}}this.appendExecutor(i,a)},onStart:()=>{},onComplete:()=>{const C=self.performance.now();g.executeEnd=g.end=C,v.first===0&&(v.first=C),x&&x.first===0&&(x.first=C);const U={};this.sourceBuffers.forEach(([O,B])=>{O&&(U[O]=ze.getBuffered(B))}),this.appendErrors[a]=0,a==="audio"||a==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(T.BUFFER_APPENDED,{type:a,frag:c,part:h,chunkMeta:f,parent:c.type,timeRanges:U})},onError:C=>{var U;const O={type:Re.MEDIA_ERROR,parent:c.type,details:Q.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:c,part:h,chunkMeta:f,error:C,err:C,fatal:!1},B=(U=this.media)==null?void 0:U.error;if(C.code===DOMException.QUOTA_EXCEEDED_ERR)O.details=Q.BUFFER_FULL_ERROR;else if(C.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!B)O.errorAction=Sh(!0);else if(C.name===wT&&this.sourceBufferCount===0)O.errorAction=Sh(!0);else{const F=++this.appendErrors[a];this.warn(`Failed ${F}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer (${B||"no media error"})`),(F>=this.hls.config.appendErrorMaxRetry||B)&&(O.fatal=!0)}this.hls.trigger(T.ERROR,O)}};this.append(_,a,this.isPending(this.tracks[a]))}getFlushOp(e,t,n){return this.log(`queuing "${e}" remove ${t}-${n}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,n)},onStart:()=>{},onComplete:()=>{this.hls.trigger(T.BUFFER_FLUSHED,{type:e})},onError:i=>{this.warn(`Failed to remove ${t}-${n} from "${e}" SourceBuffer`,i)}}}onBufferFlushing(e,t){const{type:n,startOffset:i,endOffset:a}=t;n?this.append(this.getFlushOp(n,i,a),n):this.sourceBuffers.forEach(([l])=>{l&&this.append(this.getFlushOp(l,i,a),l)})}onFragParsed(e,t){const{frag:n,part:i}=t,a=[],l=i?i.elementaryStreams:n.elementaryStreams;l[ut.AUDIOVIDEO]?a.push("audiovideo"):(l[ut.AUDIO]&&a.push("audio"),l[ut.VIDEO]&&a.push("video"));const c=()=>{const h=self.performance.now();n.stats.buffering.end=h,i&&(i.stats.buffering.end=h);const f=i?i.stats:n.stats;this.hls.trigger(T.FRAG_BUFFERED,{frag:n,part:i,stats:f,id:n.type})};a.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(c,a).catch(h=>{this.warn(`Fragment buffered callback ${h}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t,n;return e&&(!((t=this.tracks[e])!=null&&t.ended)||((n=this.tracks[e])==null?void 0:n.ending))})}onBufferEos(e,t){var n;this.sourceBuffers.forEach(([l])=>{if(l){const c=this.tracks[l];(!t.type||t.type===l)&&(c.ending=!0,c.ended||(c.ended=!0,this.log(`${l} buffer reached EOS`)))}});const i=((n=this.overrides)==null?void 0:n.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([l])=>{var c;return l&&!((c=this.tracks[l])!=null&&c.ended)})&&(i?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:l}=this;if(!l||l.readyState!=="open"){l&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${l.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),l.endOfStream(),this.hls.trigger(T.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(T.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){const e=this.getDurationAndRange();e&&this.blockUntilOpen(()=>this.updateMediaSource(e))}onError(e,t){if(t.details===Q.BUFFER_APPEND_ERROR&&t.frag){var n;const i=(n=t.errorAction)==null?void 0:n.nextAutoLevel;Ee(i)&&i!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.sourceBufferCount)return;const i=e.config,a=n.currentTime,l=t.levelTargetDuration,c=t.live&&i.liveBackBufferLength!==null?i.liveBackBufferLength:i.backBufferLength;if(Ee(c)&&c>=0){const h=Math.max(c,l),f=Math.floor(a/l)*l-h;this.flushBackBuffer(a,l,f)}if(Ee(i.frontBufferFlushThreshold)&&i.frontBufferFlushThreshold>0){const h=Math.max(i.maxBufferLength,i.frontBufferFlushThreshold),f=Math.max(h,l),g=Math.floor(a/l)*l+f;this.flushFrontBuffer(a,l,g)}}flushBackBuffer(e,t,n){this.sourceBuffers.forEach(([i,a])=>{if(a){const c=ze.getBuffered(a);if(c.length>0&&n>c.start(0)){var l;this.hls.trigger(T.BACK_BUFFER_REACHED,{bufferEnd:n});const h=this.tracks[i];if((l=this.details)!=null&&l.live)this.hls.trigger(T.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(h!=null&&h.ended){this.log(`Cannot flush ${i} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(T.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:i})}}})}flushFrontBuffer(e,t,n){this.sourceBuffers.forEach(([i,a])=>{if(a){const l=ze.getBuffered(a),c=l.length;if(c<2)return;const h=l.start(c-1),f=l.end(c-1);if(n>h||e>=h&&e<=f)return;this.hls.trigger(T.BUFFER_FLUSHING,{startOffset:h,endOffset:1/0,type:i})}})}getDurationAndRange(){var e;const{details:t,mediaSource:n}=this;if(!t||!this.media||(n==null?void 0:n.readyState)!=="open")return null;const i=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&t.live&&n.setLiveSeekableRange){const f=Math.max(0,t.fragmentStart),g=Math.max(f,i);return{duration:1/0,start:f,end:g}}return{duration:1/0}}const a=(e=this.overrides)==null?void 0:e.duration;if(a)return Ee(a)?{duration:a}:null;const l=this.media.duration,c=Ee(n.duration)?n.duration:0;return i>c&&i>l||!Ee(l)?{duration:i}:null}updateMediaSource({duration:e,start:t,end:n}){const i=this.mediaSource;!this.media||!i||i.readyState!=="open"||(i.duration!==e&&(Ee(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),i.duration=e),t!==void 0&&n!==void 0&&(this.log(`MediaSource duration is set to ${i.duration}. Setting seekable range to ${t}-${n}.`),i.setLiveSeekableRange(t,n)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:n}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${St(n)}`),this.tracksReady){var i;const a=(i=this.transferData)==null?void 0:i.tracks;a&&Object.keys(a).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,n])=>{if(t){const i=this.tracks[t];e[t]={buffer:n,container:i.container,codec:i.codec,supplemental:i.supplemental,levelCodec:i.levelCodec,id:i.id,metadata:i.metadata}}}),this.hls.trigger(T.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(T.ERROR,{type:Re.MEDIA_ERROR,details:Q.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:n}=this;if(!n)throw new Error("createSourceBuffers called when mediaSource was null");for(const a in e){const l=a,c=e[l];if(this.isPending(c)){const h=this.getTrackCodec(c,l),f=`${c.container};codecs=${h}`;c.codec=h,this.log(`creating sourceBuffer(${f})${this.currentOp(l)?" Queued":""} ${St(c)}`);try{const g=n.addSourceBuffer(f),m=$m(l),y=[l,g];t[m]=y,c.buffer=g}catch(g){var i;this.error(`error while trying to add sourceBuffer: ${g.message}`),this.shiftAndExecuteNext(l),(i=this.operationQueue)==null||i.removeBlockers(),delete this.tracks[l],this.hls.trigger(T.ERROR,{type:Re.MEDIA_ERROR,details:Q.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:g,sourceBufferName:l,mimeType:f,parent:c.id});return}this.trackSourceBuffer(l,c)}}this.bufferCreated()}getTrackCodec(e,t){const n=e.supplemental;let i=e.codec;n&&(t==="video"||t==="audiovideo")&&bp(n,"video")&&(i=MC(i,n));const a=X0(i,e.levelCodec);return a?t.slice(0,5)==="audio"?pd(a,this.appendSource):a:""}trackSourceBuffer(e,t){const n=t.buffer;if(!n)return;const i=this.getTrackCodec(t,e);this.tracks[e]={buffer:n,codec:i,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(a,l)=>{const c=l.removedRanges;c!=null&&c.length&&this.hls.trigger(T.BUFFER_FLUSHED,{type:a})})}get mediaSrc(){var e,t;const n=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return n==null?void 0:n.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const n=this.currentOp(e);n&&(n.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var n;const i=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${i}`,t),this.hls.trigger(T.ERROR,{type:Re.MEDIA_ERROR,details:Q.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const a=this.currentOp(e);a&&a.onError(i)}removeExecutor(e,t,n){const{media:i,mediaSource:a}=this,l=this.tracks[e],c=l==null?void 0:l.buffer;if(!i||!a||!c){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const h=Ee(i.duration)?i.duration:1/0,f=Ee(a.duration)?a.duration:1/0,g=Math.max(0,t),m=Math.min(n,h,f);m>g&&(!l.ending||l.ended)?(l.ended=!1,this.log(`Removing [${g},${m}] from the ${e} SourceBuffer`),c.remove(g,m)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.tracks[t],i=n==null?void 0:n.buffer;if(!i)throw new GO(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);n.ending=!1,n.ended=!1,i.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:n}=this,i=t.map(l=>this.appendBlocker(l));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(i).then(l=>{n===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var n;const i=(n=this.tracks[t])==null?void 0:n.buffer;!i||i.updating||this.shiftAndExecuteNext(t)})}append(e,t,n){this.operationQueue&&this.operationQueue.append(e,t,n)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,n){const i=this.tracks[e];if(!i)return;const a=i.buffer;if(!a)return;const l=n.bind(this,e);i.listeners.push({event:t,listener:l}),a.addEventListener(t,l)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const n=t.buffer;n&&(t.listeners.forEach(i=>{n.removeEventListener(i.event,i.listener)}),t.listeners.length=0)}}function db(s){const e=s.querySelectorAll("source");[].slice.call(e).forEach(t=>{s.removeChild(t)})}function HO(s,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,s.appendChild(t)}function $m(s){return s==="audio"?1:0}class Ky{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(T.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(T.BUFFER_CODECS,this.onBufferCodecs,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(T.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(T.BUFFER_CODECS,this.onBufferCodecs,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&Ee(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((i,a)=>this.isLevelAllowed(i)&&a<=e);return this.clientRect=null,Ky.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const i=(c,h)=>h?c.width!==h.width||c.height!==h.height:!0;let a=e.length-1;const l=Math.max(t,n);for(let c=0;c<e.length;c+=1){const h=e[c];if((h.width>=l||h.height>=l)&&i(h,e[c+1])){a=c;break}}return a}}const zO={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},Gn=zO,VO={HLS:"h"},KO=VO,YO="CMCD-Object",jO="CMCD-Request",QO="CMCD-Session",qO="CMCD-Status",ch={OBJECT:YO,REQUEST:jO,SESSION:QO,STATUS:qO},XO={[ch.OBJECT]:["br","d","ot","tb"],[ch.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[ch.SESSION]:["cid","pr","sf","sid","st","v"],[ch.STATUS]:["bs","rtp"]};class Kc{constructor(e,t){Array.isArray(e)&&(e=e.map(n=>n instanceof Kc?n:new Kc(n))),this.value=e,this.params=t}}const WO="Dict";function ZO(s){return Array.isArray(s)?JSON.stringify(s):s instanceof Map?"Map{}":s instanceof Set?"Set{}":typeof s=="object"?JSON.stringify(s):String(s)}function JO(s,e,t,n){return new Error(`failed to ${s} "${ZO(e)}" as ${t}`,{cause:n})}function Ii(s,e,t){return JO("serialize",s,e,t)}class RT{constructor(e){this.description=e}}const gb="Bare Item",eM="Boolean";function tM(s){if(typeof s!="boolean")throw Ii(s,eM);return s?"?1":"?0"}const nM="Byte Sequence";function sM(s){if(ArrayBuffer.isView(s)===!1)throw Ii(s,nM);return`:${Z_(s)}:`}const iM="Integer";function rM(s){return s<-999999999999999||999999999999999<s}function LT(s){if(rM(s))throw Ii(s,iM);return s.toString()}function aM(s){return`@${LT(s.getTime()/1e3)}`}const lM="Decimal";function oM(s){const e=uT(s,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Ii(s,lM);const t=e.toString();return t.includes(".")?t:`${t}.0`}const cM="String",uM=/[\x00-\x1f\x7f]+/;function hM(s){if(uM.test(s))throw Ii(s,cM);return`"${s.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function fM(s){return s.description||s.toString().slice(7,-1)}const dM="Token";function mb(s){const e=fM(s);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Ii(e,dM);return e}function Dp(s){switch(typeof s){case"number":if(!Ee(s))throw Ii(s,gb);return Number.isInteger(s)?LT(s):oM(s);case"string":return hM(s);case"symbol":return mb(s);case"boolean":return tM(s);case"object":if(s instanceof Date)return aM(s);if(s instanceof Uint8Array)return sM(s);if(s instanceof RT)return mb(s);default:throw Ii(s,gb)}}const gM="Key";function Cp(s){if(/^[a-z*][a-z0-9\-_.*]*$/.test(s)===!1)throw Ii(s,gM);return s}function Yy(s){return s==null?"":Object.entries(s).map(([e,t])=>t===!0?`;${Cp(e)}`:`;${Cp(e)}=${Dp(t)}`).join("")}function kT(s){return s instanceof Kc?`${Dp(s.value)}${Yy(s.params)}`:Dp(s)}function mM(s){return`(${s.value.map(kT).join(" ")})${Yy(s.params)}`}function pM(s,e={whitespace:!0}){if(typeof s!="object")throw Ii(s,WO);const t=s instanceof Map?s.entries():Object.entries(s),n=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([i,a])=>{a instanceof Kc||(a=new Kc(a));let l=Cp(i);return a.value===!0?l+=Yy(a.params):(l+="=",Array.isArray(a.value)?l+=mM(a):l+=kT(a)),l}).join(`,${n}`)}function yM(s,e){return pM(s,e)}function vM(s){return s==="ot"||s==="sf"||s==="st"}function xM(s){return typeof s=="number"?Ee(s):s!=null&&s!==""&&s!==!1}const ed=s=>Math.round(s),EM=(s,e)=>(e!=null&&e.baseUrl&&(s=J_(s,e.baseUrl)),encodeURIComponent(s)),D0=s=>ed(s/100)*100,bM={br:ed,d:ed,bl:D0,dl:D0,mtp:D0,nor:EM,rtp:D0,tb:ed};function AM(s,e){const t={};if(s==null||typeof s!="object")return t;const n=Object.keys(s).sort(),i=ht({},bM,e==null?void 0:e.formatters),a=e==null?void 0:e.filter;return n.forEach(l=>{if(a!=null&&a(l))return;let c=s[l];const h=i[l];h&&(c=h(c,e)),!(l==="v"&&c===1)&&(l=="pr"&&c===1||xM(c)&&(vM(l)&&typeof c=="string"&&(c=new RT(c)),t[l]=c))}),t}function IT(s,e={}){return s?yM(AM(s,e),ht({whitespace:!1},e)):""}function SM(s,e={}){const t={};if(!s)return t;const n=Object.entries(s),i=Object.entries(XO).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),a=n.reduce((l,c)=>{var h,f;const[g,m]=c,y=((h=i.find(v=>v[1].includes(g)))===null||h===void 0?void 0:h[0])||ch.REQUEST;return(f=l[y])!==null&&f!==void 0||(l[y]={}),l[y][g]=m,l},{});return Object.entries(a).reduce((l,[c,h])=>(l[c]=IT(h,e),l),t)}function TM(s,e,t){return ht(s,SM(e,t))}const wM="CMCD";function RM(s,e={}){if(!s)return"";const t=IT(s,e);return`${wM}=${encodeURIComponent(t)}`}const pb=/CMCD=[^&#]+/;function LM(s,e,t){const n=RM(e,t);if(!n)return s;if(pb.test(s))return s.replace(pb,n);const i=s.includes("?")?"&":"?";return`${s}${i}${n}`}class kM{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=i=>{try{this.apply(i,{ot:Gn.MANIFEST,su:!this.initialized})}catch(a){this.hls.logger.warn("Could not generate manifest CMCD data.",a)}},this.applyFragmentData=i=>{try{const{frag:a,part:l}=i,c=this.hls.levels[a.level],h=this.getObjectType(a),f={d:(l||a).duration*1e3,ot:h};(h===Gn.VIDEO||h===Gn.AUDIO||h==Gn.MUXED)&&(f.br=c.bitrate/1e3,f.tb=this.getTopBandwidth(h)/1e3,f.bl=this.getBufferLength(h));const g=l?this.getNextPart(l):this.getNextFrag(a);g!=null&&g.url&&g.url!==a.url&&(f.nor=g.url),this.apply(i,f)}catch(a){this.hls.logger.warn("Could not generate segment CMCD data.",a)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.sessionId,this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHED,this.onMediaDetached,this),e.on(T.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHED,this.onMediaDetached,this),e.off(T.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(i=t.tracks.video)==null?void 0:i.buffer}createData(){var e;return{v:1,sf:KO.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){ht(t,this.createData());const n=t.ot===Gn.INIT||t.ot===Gn.VIDEO||t.ot===Gn.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:i}=this;i&&(t=Object.keys(t).reduce((l,c)=>(i.includes(c)&&(l[c]=t[c]),l),{}));const a={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),TM(e.headers,t,a)):e.url=LM(e.url,t,a)}getNextFrag(e){var t;const n=(t=this.hls.levels[e.level])==null?void 0:t.details;if(n){const i=e.sn-n.startSN;return n.fragments[i+1]}}getNextPart(e){var t,n;const{index:i,fragment:a}=e,l=(t=this.hls.levels[a.level])==null||(n=t.details)==null?void 0:n.partList;if(l){const{sn:c}=a;for(let h=l.length-1;h>=0;h--){const f=l[h];if(f.index===i&&f.fragment.sn===c)return l[h+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return Gn.TIMED_TEXT;if(e.sn==="initSegment")return Gn.INIT;if(t==="audio")return Gn.AUDIO;if(t==="main")return this.hls.audioTracks.length?Gn.VIDEO:Gn.MUXED}getTopBandwidth(e){let t=0,n;const i=this.hls;if(e===Gn.AUDIO)n=i.audioTracks;else{const a=i.maxAutoLevel,l=a>-1?a+1:i.levels.length;n=i.levels.slice(0,l)}for(const a of n)a.bitrate>t&&(t=a.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.media,n=e===Gn.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:ze.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new n(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,l,c){t(a),this.loader.load(a,l,c)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new n(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,l,c){t(a),this.loader.load(a,l,c)}}}}const IM=3e5;class DM extends Lr{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((n==null?void 0:n.action)===wn.SendAlternateToPenaltyBox&&n.flags===Gs.MoveAllAlternatesMatchingHost){const i=this.levels;let a=this._pathwayPriority,l=this.pathwayId;if(t.context){const{groupId:c,pathwayId:h,type:f}=t.context;c&&i?l=this.getPathwayForGroupId(c,f,l):h&&(l=h)}l in this.penalizedPathways||(this.penalizedPathways[l]=performance.now()),!a&&i&&(a=this.pathways()),a&&a.length>1&&(this.updatePathwayPriority(a),n.resolved=this.pathwayId!==l),n.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${l} levels: ${i&&i.length} priorities: ${St(a)} penalized: ${St(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(a=>{i-n[a]>IM&&delete n[a]});for(let a=0;a<e.length;a++){const l=e[a];if(l in n)continue;if(l===this.pathwayId)return;const c=this.hls.nextLoadLevel,h=this.hls.levels[c];if(t=this.getLevelsForPathway(l),t.length>0){this.log(`Setting Pathway to "${l}"`),this.pathwayId=l,eT(t),this.hls.trigger(T.LEVELS_UPDATED,{levels:t});const f=this.hls.levels[c];h&&f&&this.levels&&(f.attrs["STABLE-VARIANT-ID"]!==h.attrs["STABLE-VARIANT-ID"]&&f.bitrate!==h.bitrate&&this.log(`Unstable Pathways change from bitrate ${h.bitrate} to ${f.bitrate}`),this.hls.nextLoadLevel=c);break}}}getPathwayForGroupId(e,t,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let a=0;a<i.length;a++)if(t===qe.AUDIO_TRACK&&i[a].hasAudioGroup(e)||t===qe.SUBTITLE_TRACK&&i[a].hasSubtitleGroup(e))return i[a].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach(a=>{const{ID:l,"BASE-ID":c,"URI-REPLACEMENT":h}=a;if(t.some(g=>g.pathwayId===l))return;const f=this.getLevelsForPathway(c).map(g=>{const m=new kt(g.attrs);m["PATHWAY-ID"]=l;const y=m.AUDIO&&`${m.AUDIO}_clone_${l}`,v=m.SUBTITLES&&`${m.SUBTITLES}_clone_${l}`;y&&(n[m.AUDIO]=y,m.AUDIO=y),v&&(i[m.SUBTITLES]=v,m.SUBTITLES=v);const x=DT(g.uri,m["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",h),b=new Ah({attrs:m,audioCodec:g.audioCodec,bitrate:g.bitrate,height:g.height,name:g.name,url:x,videoCodec:g.videoCodec,width:g.width});if(g.audioGroups)for(let A=1;A<g.audioGroups.length;A++)b.addGroupId("audio",`${g.audioGroups[A]}_clone_${l}`);if(g.subtitleGroups)for(let A=1;A<g.subtitleGroups.length;A++)b.addGroupId("text",`${g.subtitleGroups[A]}_clone_${l}`);return b});t.push(...f),yb(this.audioTracks,n,h,l),yb(this.subtitleTracks,i,h,l)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let i;try{i=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(i.protocol!=="data:"){const g=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+g)}const a={responseType:"json",url:i.href},l=t.steeringManifestLoadPolicy.default,c=l.errorRetry||l.timeoutRetry||{},h={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},f={onSuccess:(g,m,y,v)=>{this.log(`Loaded steering manifest: "${i}"`);const x=g.data;if((x==null?void 0:x.VERSION)!==1){this.log(`Steering VERSION ${x.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=x.TTL;const{"RELOAD-URI":b,"PATHWAY-CLONES":A,"PATHWAY-PRIORITY":S}=x;if(b)try{this.uri=new self.URL(b,i).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${b}`);return}this.scheduleRefresh(this.uri||y.url),A&&this.clonePathways(A);const k={steeringManifest:x,url:i.toString()};this.hls.trigger(T.STEERING_MANIFEST_LOADED,k),S&&this.updatePathwayPriority(S)},onError:(g,m,y,v)=>{if(this.log(`Error loading steering manifest: ${g.code} ${g.text} (${m.url})`),this.stopLoad(),g.code===410){this.enabled=!1,this.log(`Steering manifest ${m.url} no longer available`);return}let x=this.timeToLoad*1e3;if(g.code===429){const b=this.loader;if(typeof(b==null?void 0:b.getResponseHeader)=="function"){const A=b.getResponseHeader("Retry-After");A&&(x=parseFloat(A)*1e3)}this.log(`Steering manifest ${m.url} rate limited`);return}this.scheduleRefresh(this.uri||m.url,x)},onTimeout:(g,m,y)=>{this.log(`Timeout loading steering manifest (${m.url})`),this.scheduleRefresh(this.uri||m.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(a,h,f)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const i=(n=this.hls)==null?void 0:n.media;if(i&&!i.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function yb(s,e,t,n){s&&Object.keys(e).forEach(i=>{const a=s.filter(l=>l.groupId===i).map(l=>{const c=ht({},l);return c.details=void 0,c.attrs=new kt(c.attrs),c.url=c.attrs.URI=DT(l.url,l.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),c.groupId=c.attrs["GROUP-ID"]=e[i],c.attrs["PATHWAY-ID"]=n,c});s.push(...a)})}function DT(s,e,t,n){const{HOST:i,PARAMS:a,[t]:l}=n;let c;e&&(c=l==null?void 0:l[e],c&&(s=c));const h=new self.URL(s);return i&&!c&&(h.host=i),a&&Object.keys(a).sort().forEach(f=>{f&&h.searchParams.set(f,a[f])}),h.href}class Wo extends Lr{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Wo.CDMCleanupPromise?[Wo.CDMCleanupPromise]:[],this.onMediaEncrypted=t=>{const{initDataType:n,initData:i}=t,a=`"${t.type}" event: init data type: "${n}"`;if(this.debug(a),i!==null){if(!this.keyFormatPromise){let l=Object.keys(this.keySystemAccessPromises);l.length||(l=R0(this.config));const c=l.map(Om).filter(h=>!!h);this.keyFormatPromise=this.getKeyFormatPromise(c)}this.keyFormatPromise.then(l=>{const c=Cm(l);let h,f;if(n==="sinf"){if(c!==ot.FAIRPLAY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${n}" for selected key-system ${c}`);return}const x=qt(new Uint8Array(i));try{const b=Py(JSON.parse(x).sinf),A=_S(b);if(!A)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");h=new Uint8Array(A.subarray(8,24)),f=ot.FAIRPLAY}catch(b){this.warn(`${a} Failed to parse sinf: ${b}`);return}}else{if(c!==ot.WIDEVINE&&c!==ot.PLAYREADY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${n}" for selected key-system ${c}`);return}const x=DC(i),b=x.filter(S=>!!S.systemId&&_m(S.systemId)===c);b.length>1&&this.warn(`${a} Using first of ${b.length} pssh found for selected key-system ${c}`);const A=b[0];if(!A){x.length===0||x.some(S=>!S.systemId)?this.warn(`${a} contains incomplete or invalid pssh data`):this.log(`ignoring ${a} for ${x.map(S=>_m(S.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(f=_m(A.systemId),A.version===0&&A.data)if(f===ot.WIDEVINE){const S=A.data.length-22;h=new Uint8Array(A.data.subarray(S,S+16))}else f===ot.PLAYREADY&&(h=jS(A.data))}if(!f||!h)return;const g=hi.hexDump(h),{keyIdToKeySessionPromise:m,mediaKeySessions:y}=this;let v=m[g];for(let x=0;x<y.length;x++){const b=y[x],A=b.decryptdata;if(!A.keyId)continue;const S=hi.hexDump(A.keyId);if(g===S||A.uri.replace(/-/g,"").indexOf(g)!==-1){if(v=m[S],A.pssh)break;delete m[S],A.pssh=new Uint8Array(i),A.keyId=h,v=m[g]=v.then(()=>this.generateRequestWithPreferredKeySession(b,n,i,"encrypted-event-key-match")),v.catch(k=>this.handleError(k));break}}if(!v){if(f!==c){this.log(`Ignoring "${t.type}" event with ${f} init data for selected key-system ${c}`);return}v=m[g]=this.getKeySystemSelectionPromise([f]).then(({keySystem:x,mediaKeys:b})=>{var A;this.throwIfDestroyed();const S=new Th("ISO-23001-7",g,(A=Om(x))!=null?A:"");return S.pssh=new Uint8Array(i),S.keyId=h,this.attemptSetMediaKeys(x,b).then(()=>{this.throwIfDestroyed();const k=this.createMediaKeySessionContext({decryptdata:S,keySystem:x,mediaKeys:b});return this.generateRequestWithPreferredKeySession(k,n,i,"encrypted-event-no-match")})}),v.catch(x=>this.handleError(x))}})}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){const e=this.media;this.unregisterListeners(),this.onMediaDetached(),this._clear(e);const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(T.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(T.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(T.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(T.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(T.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(T.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t[e];if(i)return i.licenseUrl;if(e===ot.WIDEVINE&&n)return n}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(l,c,h)=>!!l&&h.indexOf(l)===c,i=t.map(l=>l.audioCodec).filter(n),a=t.map(l=>l.videoCodec).filter(n);return i.length+a.length===0&&a.push("avc1.42e01e"),new Promise((l,c)=>{const h=f=>{const g=f.shift();this.getMediaKeysPromise(g,i,a).then(m=>l({keySystem:g,mediaKeys:m})).catch(m=>{f.length?h(f):m instanceof bs?c(m):c(new bs({type:Re.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_ACCESS,error:m,fatal:!0},m.message))})};h(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let i=`Configured requestMediaKeySystemAccess is not a function ${n}`;return YS===null&&self.location.protocol==="http:"&&(i=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(i))}return n(e,t)}getMediaKeysPromise(e,t,n){const i=b_(e,t,n,this.config.drmSystemOptions),a=this.keySystemAccessPromises[e];let l=a==null?void 0:a.keySystemAccess;if(!l){this.log(`Requesting encrypted media "${e}" key-system access with config: ${St(i)}`),l=this.requestMediaKeySystemAccess(e,i);const c=this.keySystemAccessPromises[e]={keySystemAccess:l};return l.catch(h=>{this.log(`Failed to obtain access to key-system "${e}": ${h}`)}),l.then(h=>{this.log(`Access for key-system "${h.keySystem}" obtained`);const f=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),c.mediaKeys=h.createMediaKeys().then(g=>(this.log(`Media-keys created for "${e}"`),f.then(m=>m?this.setMediaKeysServerCertificate(g,e,m):g))),c.mediaKeys.catch(g=>{this.error(`Failed to create media-keys for "${e}"}: ${g}`)}),c.mediaKeys})}return l.then(()=>a.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${hi.hexDump(e.keyId||[])}`);const i=n.createSession(),a={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),a="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,a,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return hi.hexDump(e.keyId)}updateKeySession(e,t){var n;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${hi.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),i.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{const i=R0(this.config),a=e.map(Cm).filter(l=>!!l&&i.indexOf(l)!==-1);return this.getKeySystemSelectionPromise(a).then(({keySystem:l})=>{const c=Om(l);c?t(c):n(new Error(`Unable to find format for key-system "${l}"`))}).catch(n)})}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),i=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let a=this.keyIdToKeySessionPromise[n];return a||(a=this.getKeySystemForKeyPromise(t).then(({keySystem:c,mediaKeys:h})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(c,h).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:c,mediaKeys:h,decryptdata:t}))))),(this.keyIdToKeySessionPromise[n]=a.then(c=>{const h="cenc",f=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(c,h,f,"playlist-key")})).catch(c=>this.handleError(c))),a}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof bs?this.hls.trigger(T.ERROR,e.data):this.hls.trigger(T.ERROR,{type:Re.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const i=Cm(e.keyFormat),a=i?[i]:R0(this.config);return this.attemptKeySystemAccess(a)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=R0(this.config)),e.length===0)throw new bs({type:Re.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${St({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(a=>n.indexOf(a)===-1)})}generateRequestWithPreferredKeySession(e,t,n,i){var a,l;const c=(a=this.config.drmSystems)==null||(l=a[e.keySystem])==null?void 0:l.generateRequest;if(c)try{const x=c.call(this.hls,t,n,e);if(!x)throw new Error("Invalid response from configured generateRequest filter");t=x.initDataType,n=x.initData?x.initData:null,e.decryptdata.pssh=n?new Uint8Array(n):null}catch(x){var h;if(this.warn(x.message),(h=this.hls)!=null&&h.config.debug)throw x}if(n===null)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const f=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${f} (init data type: ${t} length: ${n?n.byteLength:null})`);const g=new By,m=e._onmessage=x=>{const b=e.mediaKeysSession;if(!b){g.emit("error",new Error("invalid state"));return}const{messageType:A,message:S}=x;this.log(`"${A}" message event for session "${b.sessionId}" message size: ${S.byteLength}`),A==="license-request"||A==="license-renewal"?this.renewLicense(e,S).catch(k=>{g.eventNames().length?g.emit("error",k):this.handleError(k)}):A==="license-release"?e.keySystem===ot.FAIRPLAY&&(this.updateKeySession(e,Tp("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${A}"`)},y=e._onkeystatuseschange=x=>{if(!e.mediaKeysSession){g.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const A=e.keyStatus;g.emit("keyStatus",A),A==="expired"&&(this.warn(`${e.keySystem} expired for key ${f}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",m),e.mediaKeysSession.addEventListener("keystatuseschange",y);const v=new Promise((x,b)=>{g.on("error",b),g.on("keyStatus",A=>{A.startsWith("usable")?x():A==="output-restricted"?b(new bs({type:Re.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):A==="internal-error"?b(new bs({type:Re.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${A}"`)):A==="expired"?b(new Error("key expired while generating request")):this.warn(`unhandled key status change "${A}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var x;this.log(`Request generated for key-session "${(x=e.mediaKeysSession)==null?void 0:x.sessionId}" keyId: ${f}`)}).catch(x=>{throw new bs({type:Re.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_SESSION,error:x,fatal:!1},`Error generating key-session request: ${x}`)}).then(()=>v).catch(x=>{throw g.removeAllListeners(),this.removeSession(e),x}).then(()=>(g.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{if(typeof n=="string"&&typeof t=="object"){const i=n;n=t,t=i}this.log(`key status change "${t}" for keyStatuses keyId: ${hi.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${hi.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,i=new n(t),a=this.getServerCertificateUrl(e);return a?(this.log(`Fetching server certificate for "${e}"`),new Promise((l,c)=>{const h={responseType:"arraybuffer",url:a},f=t.certLoadPolicy.default,g={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},m={onSuccess:(y,v,x,b)=>{l(y.data)},onError:(y,v,x,b)=>{c(new bs({type:Re.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:x,response:lt({url:h.url,data:void 0},y)},`"${e}" certificate request failed (${a}). Status: ${y.code} (${y.text})`))},onTimeout:(y,v,x)=>{c(new bs({type:Re.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:x,response:{url:h.url,data:void 0}},`"${e}" certificate request timed out (${a})`))},onAbort:(y,v,x)=>{c(new Error("aborted"))}};i.load(h,g,m)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((i,a)=>{e.setServerCertificate(n).then(l=>{this.log(`setServerCertificate ${l?"success":"not supported by CDM"} (${n==null?void 0:n.byteLength}) on "${t}"`),i(e)}).catch(l=>{a(new bs({type:Re.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:l,fatal:!0},l.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(i=>{throw new bs({type:Re.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:i,fatal:!0},i.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const i=new DOMParser().parseFromString(n,"application/xml"),a=i.querySelectorAll("HttpHeader");if(a.length>0){let g;for(let m=0,y=a.length;m<y;m++){var l,c;g=a[m];const v=(l=g.querySelector("name"))==null?void 0:l.textContent,x=(c=g.querySelector("value"))==null?void 0:c.textContent;v&&x&&e.setRequestHeader(v,x)}}const h=i.querySelector("Challenge"),f=h==null?void 0:h.textContent;if(!f)throw new Error("Cannot find <Challenge> in key message");return Tp(atob(f))}setupLicenseXHR(e,t,n,i){const a=this.config.licenseXhrSetup;return a?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return a.call(this.hls,e,t,n,i)}).catch(l=>{if(!n.decryptdata)throw l;return e.open("POST",t,!0),a.call(this.hls,e,t,n,i)}).then(l=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:l||i})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((i,a)=>{const l=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${l}`);const c=new XMLHttpRequest;c.responseType="arraybuffer",c.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return a(new Error("invalid state"));if(c.readyState===4)if(c.status===200){this._requestLicenseFailureCount=0;let h=c.response;this.log(`License received ${h instanceof ArrayBuffer?h.byteLength:h}`);const f=this.config.licenseResponseCallback;if(f)try{h=f.call(this.hls,c,l,e)}catch(g){this.error(g)}i(h)}else{const h=n.errorRetry,f=h?h.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>f||c.status>=400&&c.status<500)a(new bs({type:Re.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:c,response:{url:l,data:void 0,code:c.status,text:c.statusText}},`License Request XHR failed (${l}). Status: ${c.status} (${c.statusText})`));else{const g=f-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${g} attempts left`),this.requestLicense(e,t).then(i,a)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=c,this.setupLicenseXHR(c,l,e,t).then(({xhr:h,licenseChallenge:f})=>{e.keySystem==ot.PLAYREADY&&(f=this.unpackPlayReadyKeyMessage(h,f)),h.send(f)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.removeEventListener("encrypted",this.onMediaEncrypted),n.removeEventListener("waitingforkey",this.onWaitingForKey),n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null)}_clear(e){var t;const n=this.mediaKeySessions;this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Th.clearKeyUriToKeyIdMap();const i=n.length;Wo.CDMCleanupPromise=Promise.all(n.map(a=>this.removeSession(a)).concat(e==null||(t=e.setMediaKeys(null))==null?void 0:t.catch(a=>{var l;this.log(`Could not clear media keys: ${a}`),(l=this.hls)==null||l.trigger(T.ERROR,{type:Re.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${a}`)})}))).then(()=>{i&&(this.log("finished closing key sessions and clearing media keys"),n.length=0)}).catch(a=>{var l;this.log(`Could not close sessions and clear media keys: ${a}`),(l=this.hls)==null||l.trigger(T.ERROR,{type:Re.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${a}`)})})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((i,a)=>(i.indexOf(a.keyFormat)===-1&&i.push(a.keyFormat),i),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);i>-1&&this.mediaKeySessions.splice(i,1);const{drmSystemOptions:a}=this.config;return(S_(a)?new Promise((c,h)=>{self.setTimeout(()=>h(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(c)}):Promise.resolve()).catch(c=>{var h;this.log(`Could not remove session: ${c}`),(h=this.hls)==null||h.trigger(T.ERROR,{type:Re.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${c}`)})}).then(()=>t.close()).catch(c=>{var h;this.log(`Could not close session: ${c}`),(h=this.hls)==null||h.trigger(T.ERROR,{type:Re.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${c}`)})})}}}Wo.CDMCleanupPromise=void 0;class bs extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}class CM{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(T.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(T.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const i=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=i,i&&typeof i.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const a=i-this.lastTime,l=n-this.lastDroppedFrames,c=t-this.lastDecodedFrames,h=1e3*l/a,f=this.hls;if(f.trigger(T.FPS_DROP,{currentDropped:l,currentDecoded:c,totalDroppedFrames:n}),h>0&&l>f.config.fpsDroppedMonitoringThreshold*c){let g=f.currentLevel;f.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+g),g>0&&(f.autoLevelCapping===-1||f.autoLevelCapping>=g)&&(g=g-1,f.trigger(T.FPS_DROP_LEVEL_CAPPING,{level:g,droppedLevel:f.currentLevel}),f.autoLevelCapping=g,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function CT(s,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=s,e.dispatchEvent(t)}function _T(s,e){const t=s.mode;if(t==="disabled"&&(s.mode="hidden"),s.cues&&!s.cues.getCueById(e.id))try{if(s.addCue(e),!s.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){Je.debug(`[texttrack-utils]: ${n}`);try{const i=new self.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,s.addCue(i)}catch(i){Je.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${i}`)}}t==="disabled"&&(s.mode=t)}function zo(s,e){const t=s.mode;if(t==="disabled"&&(s.mode="hidden"),s.cues)for(let n=s.cues.length;n--;)e&&s.cues[n].removeEventListener("enter",e),s.removeCue(s.cues[n]);t==="disabled"&&(s.mode=t)}function _p(s,e,t,n){const i=s.mode;if(i==="disabled"&&(s.mode="hidden"),s.cues&&s.cues.length>0){const a=OM(s.cues,e,t);for(let l=0;l<a.length;l++)(!n||n(a[l]))&&s.removeCue(a[l])}i==="disabled"&&(s.mode=i)}function _M(s,e){if(e<=s[0].startTime)return 0;const t=s.length-1;if(e>s[t].endTime)return-1;let n=0,i=t,a;for(;n<=i;)if(a=Math.floor((i+n)/2),e<s[a].startTime)i=a-1;else if(e>s[a].startTime&&n<t)n=a+1;else return a;return s[n].startTime-e<e-s[i].startTime?n:i}function OM(s,e,t){const n=[],i=_M(s,e);if(i>-1)for(let a=i,l=s.length;a<l;a++){const c=s[a];if(c.startTime>=e&&c.endTime<=t)n.push(c);else if(c.startTime>t)return n}return n}function td(s){const e=[];for(let t=0;t<s.length;t++){const n=s[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(s[t])}return e}class MM extends Vy{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=td(this.media.textTracks);for(let a=0;a<n.length;a++)if(n[a].mode==="hidden")t=n[a];else if(n[a].mode==="showing"){t=n[a];break}const i=this.findTrackForTextTrack(t);this.subtitleTrack!==i&&this.setSubtitleTrack(i)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.LEVEL_LOADING,this.onLevelLoading,this),e.on(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(T.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.LEVEL_LOADING,this.onLevelLoading,this),e.off(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(T.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(T.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const n=this.media;if(!n)return;const i=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||n.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,i)return;td(n.textTracks).forEach(l=>{zo(l)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:i,details:a}=t,l=this.tracksInGroup[n];if(!l||l.groupId!==i){this.warn(`Subtitle track with id:${n} and group:${i} not found in active group ${l==null?void 0:l.groupId}`);return}const c=l.details;l.details=t.details,this.log(`Subtitle track ${n} "${l.name}" lang:${l.lang} group:${i} loaded [${a.startSN}-${a.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,i=this.groupIds;let a=this.currentTrack;if(!n||(i==null?void 0:i.length)!==(n==null?void 0:n.length)||n!=null&&n.some(l=>(i==null?void 0:i.indexOf(l))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const l=this.tracks.filter(g=>!n||n.indexOf(g.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(g=>g.default)&&(this.selectDefaultTrack=!1),l.forEach((g,m)=>{g.id=m});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=l;const c=this.hls.config.subtitlePreference;if(!a&&c){this.selectDefaultTrack=!1;const g=Ti(c,l);if(g>-1)a=l[g];else{const m=Ti(c,this.tracks);a=this.tracks[m]}}let h=this.findTrackId(a);h===-1&&a&&(h=this.findTrackId(null));const f={subtitleTracks:l};this.log(`Updating subtitle tracks, ${l.length} track(s) found in "${n==null?void 0:n.join(",")}" group-id`),this.hls.trigger(T.SUBTITLE_TRACKS_UPDATED,f),h!==-1&&this.trackId===-1&&this.setSubtitleTrack(h)}}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<t.length;i++){const a=t[i];if(!(n&&!a.default||!n&&!e)&&(!e||Ml(a,e)))return i}if(e){for(let i=0;i<t.length;i++){const a=t[i];if(kh(e.attrs,a.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<t.length;i++){const a=t[i];if(kh(e.attrs,a.attrs,["LANGUAGE"]))return i}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(Ip(i,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===qe.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&Ml(e,n))return n;const i=Ti(e,this.tracksInGroup);if(i>-1){const a=this.tracksInGroup[i];return this.setSubtitleTrack(i),a}else{if(n)return null;{const a=Ti(e,t);if(a>-1)return t[a]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,i=e.groupId,a=this.getUrlWithDirectives(e.url,t),l=e.details,c=l==null?void 0:l.age;this.log(`Loading subtitle ${n} "${e.name}" lang:${e.lang} group:${i}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${c&&l.live?" age "+c.toFixed(1)+(l.type&&" "+l.type||""):""} ${a}`),this.hls.trigger(T.SUBTITLE_TRACK_LOADING,{url:a,id:n,groupId:i,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=td(e.textTracks),n=this.currentTrack;let i;if(n&&(i=t.filter(a=>Ip(n,a))[0],i||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(a=>{a.mode!=="disabled"&&a!==i&&(a.mode="disabled")}),i){const a=this.subtitleDisplay?"showing":"hidden";i.mode!==a&&(i.mode=a)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!Ee(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),!i){this.hls.trigger(T.SUBTITLE_TRACK_SWITCH,{id:e});return}const a=!!i.details&&!i.details.live;if(e===this.trackId&&i===n&&a)return;this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:""));const{id:l,groupId:c="",name:h,type:f,url:g}=i;this.hls.trigger(T.SUBTITLE_TRACK_SWITCH,{id:l,groupId:c,name:h,type:f,url:g});const m=this.switchParams(i.url,n==null?void 0:n.details,i.details);this.loadPlaylist(m)}}function yh(s){let e=5381,t=s.length;for(;t;)e=e*33^s.charCodeAt(--t);return(e>>>0).toString()}const Zo=.025;let Td=function(s){return s[s.Point=0]="Point",s[s.Range=1]="Range",s}({});function PM(s,e,t){return`${s.identifier}-${t+1}-${yh(e)}`}class NM{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){if(e>=this.assetList.length)return!0;const t=this.playoutLimit;return e<=0||isNaN(t)?!1:this.assetList[e].startOffset>t}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Hm(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,n=Hm(t,e);return t-n<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=Ee(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Hm(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Zo))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?Td.Range:Td.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return BM(this)}}function Hm(s,e){return s-e.start<e.duration/2&&!(Math.abs(s-(e.start+e.duration))<Zo)?e.start:e.start+e.duration}function OT(s,e,t){const n=new self.URL(s,t);return n.protocol!=="data:"&&n.searchParams.set("_HLS_primary_id",e),n}function BM(s){return`["${s.identifier}" ${s.cue.pre?"<pre>":s.cue.post?"<post>":""}${s.timelineStart.toFixed(2)}-${s.resumeTime.toFixed(2)}]`}function Op(s){const e=s.timelineStart,t=s.duration||0;return`["${s.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class UM{constructor(e,t,n,i){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{const f=this.interstitial.playoutLimit,g=this.currentTime;this.startOffset+g>=f&&this.hls.trigger(T.PLAYOUT_LIMIT_REACHED,{})};const a=this.hls=new e(t);this.interstitial=n,this.assetItem=i;let l=i.uri;try{l=OT(l,a.sessionId).href}catch{}a.loadSource(l);const c=()=>{this.hasDetails=!0};a.once(T.LEVEL_LOADED,c),a.once(T.AUDIO_TRACK_LOADED,c),a.once(T.SUBTITLE_TRACK_LOADED,c),a.on(T.MEDIA_ATTACHING,(h,{media:f})=>{this.removeMediaListeners(),this.mediaAttached=f,this.interstitial.playoutLimit&&f.addEventListener("timeupdate",this.checkPlayout)})}bufferedInPlaceToEnd(e){var t;if(!this.interstitial.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e||!this._bufferedEosTime)return!1;const n=this.timelineOffset,i=ze.bufferInfo(e,n,0);return this.getAssetTime(i.end)>=this._bufferedEosTime-.02}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=ze.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;return e||0}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const n=e-t;if(Math.abs(n)>1/9e4){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,n=this.duration;return Math.min(Math.max(0,e-t),n)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){this.hls.attachMedia(e)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}on(e,t,n){this.hls.on(e,t)}once(e,t,n){this.hls.once(e,t)}off(e,t,n){this.hls.off(e,t)}toString(){var e,t;return`HlsAssetPlayer: ${Op(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${(t=this.interstitial)!=null&&t.appendInPlace?"append-in-place":""}`}}const vb=.033;class FM extends Lr{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((n,i)=>e<=i.startOffset&&t>i.startOffset?(delete i.error,n+1):n,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let n=-1;e.nextEvent?n=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(n=this.findEventIndex(e.previousEvent.identifier)+1);const i=this.items;if(i)for(i[n]||(t===void 0&&(t=e.start),n=this.findItemIndexAtTime(t));n>=0&&(a=i[n])!=null&&a.event;){var a;n--}return n}findItemIndexAtTime(e,t){const n=this.items;if(n)for(let i=0;i<n.length;i++){let a=n[i];if(t&&t!=="primary"&&(a=a[t]),e===a.start||e>a.start&&e<a.end)return i}return-1}findJumpRestrictedIndex(e,t){const n=this.items;if(n)for(let i=e;i<=t&&n[i];i++){const a=n[i].event;if(a!=null&&a.restrictions.jump&&!a.appendInPlace)return i}return-1}findEventIndex(e){const t=this.items;if(t)for(let i=t.length;i--;){var n;if(((n=t[i].event)==null?void 0:n.identifier)===e)return i}return-1}findAssetIndex(e,t){const n=e.assetList,i=n.length;if(i>1)for(let a=0;a<i;a++){const l=n[a];if(!l.error){const c=l.timelineStart;if(t===c||t>c&&t<c+(l.duration||0))return a}}return 0}get assetIdAtEnd(){var e,t;const n=(e=this.items)==null||(t=e[this.length-1])==null?void 0:t.event;if(n){const i=n.assetList,a=i[i.length-1];if(a)return a.identifier}return null}parseInterstitialDateRanges(e,t){const n=e.main.details,{dateRanges:i}=n,a=this.events,l=this.parseDateRanges(i,{url:n.url},t),c=Object.keys(i),h=a?a.filter(f=>!c.includes(f.identifier)):[];l.length&&l.sort((f,g)=>{const m=f.cue.pre,y=f.cue.post,v=g.cue.pre,x=g.cue.post;if(m&&!v)return-1;if(v&&!m||y&&!x)return 1;if(x&&!y)return-1;if(!m&&!v&&!y&&!x){const b=f.startTime,A=g.startTime;if(b!==A)return b-A}return f.dateRange.tagOrder-g.dateRange.tagOrder}),this.events=l,h.forEach(f=>{this.removeEvent(f)}),this.updateSchedule(e,h)}updateSchedule(e,t=[]){const n=this.events||[];if(n.length||t.length||this.length<2){const i=this.items,a=this.parseSchedule(n,e);(t.length||(i==null?void 0:i.length)!==a.length||a.some((c,h)=>Math.abs(c.playout.start-i[h].playout.start)>.005||Math.abs(c.playout.end-i[h].playout.end)>.005))&&(this.items=a,this.onScheduleUpdate(t,i))}}parseDateRanges(e,t,n){const i=[],a=Object.keys(e);for(let l=0;l<a.length;l++){const c=a[l],h=e[c];if(h.isInterstitial){let f=this.eventMap[c];f?f.setDateRange(h):(f=new NM(h,t),this.eventMap[c]=f,n===!1&&(f.appendInPlace=n)),i.push(f)}}return i}parseSchedule(e,t){const n=[],i=t.main.details,a=i.live?1/0:i.edge;let l=0;if(e=e.filter(h=>!h.error&&!(h.cue.once&&h.hasPlayed)),e.length){this.resolveOffsets(e,t);let h=0,f=0;if(e.forEach((g,m)=>{const y=g.cue.pre,v=g.cue.post,x=e[m-1]||null,b=g.appendInPlace,A=v?a:g.startOffset,S=g.duration,k=g.timelineOccupancy===Td.Range?S:0,R=g.resumptionOffset,_=(x==null?void 0:x.startTime)===A,C=A+g.cumulativeDuration;let U=b?C+S:A+R;if(y||!v&&A<=0){const B=f;f+=k,g.timelineStart=C;const F=l;l+=S,n.push({event:g,start:C,end:U,playout:{start:F,end:l},integrated:{start:B,end:f}})}else if(A<=a){if(!_){const M=A-h;if(M>vb){const j=h,ae=f;f+=M;const ye=l;l+=M;const pe={previousEvent:e[m-1]||null,nextEvent:g,start:j,end:j+M,playout:{start:ye,end:l},integrated:{start:ae,end:f}};n.push(pe)}else M>0&&x&&(x.cumulativeDuration+=M,n[n.length-1].end=A)}v&&(U=C),g.timelineStart=C;const B=f;f+=k;const F=l;l+=S,n.push({event:g,start:C,end:U,playout:{start:F,end:l},integrated:{start:B,end:f}})}else return;const O=g.resumeTime;v||O>a?h=a:h=O}),h<a){var c;const g=h,m=f,y=a-h;f+=y;const v=l;l+=y,n.push({previousEvent:((c=n[n.length-1])==null?void 0:c.event)||null,nextEvent:null,start:h,end:g+y,playout:{start:v,end:l},integrated:{start:m,end:f}})}this.setDurations(a,l,f)}else n.push({previousEvent:null,nextEvent:null,start:0,end:a,playout:{start:0,end:a},integrated:{start:0,end:a}}),this.setDurations(a,a,a);return n}setDurations(e,t,n){this.durations={primary:e,playout:t,integrated:n}}resolveOffsets(e,t){const n=t.main.details,i=n.live?1/0:n.edge;let a=0,l=-1;e.forEach((c,h)=>{const f=c.cue.pre,g=c.cue.post,m=f?0:g?i:c.startTime;this.updateAssetDurations(c),l===m?c.cumulativeDuration=a:(a=0,l=m),!g&&c.snapOptions.in&&(c.resumeAnchor=Bl(null,n.fragments,c.startOffset+c.resumptionOffset,0,0)||void 0),c.appendInPlace&&!c.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(c,t)||(c.appendInPlace=!1)),!c.appendInPlace&&h+1<e.length&&e[h+1].startTime-e[h].resumeTime<vb&&(e[h+1].appendInPlace=!1,e[h+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${c}`));const v=Ee(c.resumeOffset)?c.resumeOffset:c.duration;a+=v})}primaryCanResumeInPlaceAt(e,t){const n=e.resumeTime,i=e.startTime+e.resumptionOffset;return Math.abs(n-i)>Zo?(this.log(`"${e.identifier}" resumption ${n} not aligned with estimated timeline end ${i}`),!1):t?!Object.keys(t).some(l=>{const c=t[l].details,h=c.edge;if(n>=h)return this.log(`"${e.identifier}" resumption ${n} past ${l} playlist end ${h}`),!1;const f=Bl(null,c.fragments,n);if(!f)return this.log(`"${e.identifier}" resumption ${n} does not align with any fragments in ${l} playlist (${c.fragStart}-${c.fragmentEnd})`),!0;const g=l==="audio"?.175:0;return Math.abs(f.start-n)<Zo+g||Math.abs(f.end-n)<Zo+g?!1:(this.log(`"${e.identifier}" resumption ${n} not aligned with ${l} fragment bounds (${f.start}-${f.end} sn: ${f.sn} cc: ${f.cc})`),!0)}):(this.log(`"${e.identifier}" resumption ${n} can not be aligned with media (none selected)`),!1)}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let n=0,i=!1,a=!1;e.assetList.forEach((l,c)=>{const h=t+n;l.startOffset=n,l.timelineStart=h,i||(i=l.duration===null),a||(a=!!l.error);const f=l.error?0:l.duration||0;n+=f}),i&&!a?e.duration=Math.max(n,e.duration):e.duration=n}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function Zr(s){return`[${s.event?'"'+s.event.identifier+'"':"primary"}: ${s.start.toFixed(2)}-${s.end.toFixed(2)}]`}class GM{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const n=e.assetListUrl;let i;try{i=OT(n,this.hls.sessionId,e.baseUrl)}catch(y){const v=this.assignAssetListError(e,Q.ASSET_LIST_LOAD_ERROR,y,n);this.hls.trigger(T.ERROR,v);return}t&&i.protocol!=="data:"&&i.searchParams.set("_HLS_start_offset",""+t);const a=this.hls.config,l=a.loader,c=new l(a),h={responseType:"json",url:i.href},f=a.interstitialAssetListLoadPolicy.default,g={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},m={onSuccess:(y,v,x,b)=>{const A=y.data,S=A==null?void 0:A.ASSETS;if(!Array.isArray(S)){const k=this.assignAssetListError(e,Q.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),x.url,v,b);this.hls.trigger(T.ERROR,k);return}e.assetListResponse=A,this.hls.trigger(T.ASSET_LIST_LOADED,{event:e,assetListResponse:A,networkDetails:b})},onError:(y,v,x,b)=>{const A=this.assignAssetListError(e,Q.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${y.code} ${y.text} (${v.url})`),v.url,b,x);this.hls.trigger(T.ERROR,A)},onTimeout:(y,v,x)=>{const b=this.assignAssetListError(e,Q.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${v.url})`),v.url,y,x);this.hls.trigger(T.ERROR,b)}};return c.load(h,g,m),this.hls.trigger(T.ASSET_LIST_LOADING,{event:e}),c}assignAssetListError(e,t,n,i,a,l){return e.error=n,{type:Re.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:i,error:n,networkDetails:l,stats:a}}}function vr(s,e,t){Ri(s,e,t),s.addEventListener(e,t)}function Ri(s,e,t){s.removeEventListener(e,t)}function xb(s){s==null||s.play().catch(()=>{})}class $M extends Lr{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled)return;const i=n-this.timelinePos;if(Math.abs(i)<1/7056e5)return;const l=i<=-.01;this.timelinePos=n,this.bufferedPos=n;const c=this.playingItem;if(!c){this.checkBuffer();return}if(l&&this.schedule.resetErrorsInRange(n,n-i)&&this.updateSchedule(),this.checkBuffer(),l&&n<c.start||n>=c.end){var h;const y=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(c)&&(h=this.media)!=null&&h.paused&&(this.shouldPlay=!1),!l){const v=this.findItemIndex(c);if(y>v){const x=this.schedule.findJumpRestrictedIndex(v+1,y);if(x>v){this.setSchedulePosition(x);return}}}this.setSchedulePosition(y);return}const f=this.playingAsset;if(!f){if(this.playingLastItem&&this.isInterstitial(c)){const y=c.event.assetList[0];y&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(n,y))}return}const g=f.timelineStart,m=f.duration||0;(l&&n<g||n>=g+m)&&this.setScheduleToAssetAtTime(n,f)},this.onTimeupdate=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled)return;if(n>this.timelinePos)this.timelinePos=n,n>this.bufferedPos&&this.checkBuffer();else return;const i=this.playingItem;if(!i||this.playingLastItem)return;if(n>=i.end){this.timelinePos=i.end;const c=this.findItemIndex(i);this.setSchedulePosition(c+1)}const a=this.playingAsset;if(!a)return;const l=a.timelineStart+(a.duration||0);n>=l&&this.setScheduleToAssetAtTime(n,a)},this.onScheduleUpdate=(n,i)=>{const a=this.schedule,l=this.playingItem,c=a.events||[],h=a.items||[],f=a.durations,g=n.map(v=>v.identifier),m=!!(c.length||g.length);if(m&&this.log(`INTERSTITIALS_UPDATED (${c.length}): ${c}
Schedule: ${h.map(v=>Zr(v))}`),g.length&&this.log(`Removed events ${g}`),this.playerQueue.forEach(v=>{if(v.interstitial.appendInPlace){const x=v.assetItem.timelineStart,b=v.timelineOffset-x;if(b)try{v.timelineOffset=x}catch(A){Math.abs(b)>Zo&&this.warn(`${A} ("${v.assetId}" ${v.timelineOffset}->${x})`)}}}),l){const v=this.updateItem(l,this.timelinePos);this.itemsMatch(l,v)&&(this.playingItem=v,this.waitingItem=this.endedItem=null)}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const y=this.bufferingItem;if(y){const v=this.updateItem(y,this.bufferedPos);this.itemsMatch(y,v)?this.bufferingItem=v:y.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(y.event,null))}if(n.forEach(v=>{v.assetList.forEach(x=>{this.clearAssetPlayer(x.identifier,null)})}),m||i){if(this.hls.trigger(T.INTERSTITIALS_UPDATED,{events:c.slice(0),schedule:h.slice(0),durations:f,removedIds:g}),this.isInterstitial(l)&&g.includes(l.event.identifier)){this.warn(`Interstitial "${l.event.identifier}" removed while playing`),this.primaryFallback(l.event);return}this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new GM(e),this.schedule=new FM(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(T.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(T.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(T.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(T.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(T.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(T.BUFFER_APPENDED,this.onBufferAppended,this),e.on(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(T.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(T.MEDIA_ENDED,this.onMediaEnded,this),e.on(T.ERROR,this.onError,this),e.on(T.DESTROYING,this.onDestroying,this)}unregisterListeners(){const e=this.hls;e&&(e.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(T.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(T.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(T.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(T.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(T.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(T.BUFFER_CODECS,this.onBufferCodecs,this),e.off(T.BUFFER_APPENDED,this.onBufferAppended,this),e.off(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(T.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(T.MEDIA_ENDED,this.onMediaEnded,this),e.off(T.ERROR,this.onError,this),e.off(T.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){Ri(e,"play",this.onPlay),Ri(e,"pause",this.onPause),Ri(e,"seeking",this.onSeeking),Ri(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const n=this.media=t.media;vr(n,"seeking",this.onSeeking),vr(n,"timeupdate",this.onTimeupdate),vr(n,"play",this.onPlay),vr(n,"pause",this.onPause)}onMediaAttached(e,t){const n=this.effectivePlayingItem,i=this.detachedData;if(this.detachedData=null,n===null)this.checkStart();else if(!i){this.clearScheduleState();const a=this.findItemIndex(n);this.setSchedulePosition(a)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const n=!!t.transferMedia,i=this.media;if(this.media=null,!n&&(i&&this.removeMediaListeners(i),this.detachedData)){const a=this.getBufferingPlayer();a&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,a.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const e=this,t=()=>e.bufferingItem||e.waitingItem,n=m=>m&&e.getAssetPlayer(m.identifier),i=(m,y,v,x,b)=>{if(m){let A=m[y].start;const S=m.event;if(S){if(y==="playout"||S.timelineOccupancy!==Td.Point){const k=n(v);(k==null?void 0:k.interstitial)===S&&(A+=k.assetItem.startOffset+k[b])}}else{const k=x==="bufferedPos"?l():e[x];A+=k-m.start}return A}return 0},a=(m,y)=>{if(m!==0&&y!=="primary"&&e.schedule.length){var v;const x=e.schedule.findItemIndexAtTime(m),b=(v=e.schedule.items)==null?void 0:v[x];if(b){const A=b[y].start-b.start;return m+A}}return m},l=()=>{const m=e.bufferedPos;return m===Number.MAX_VALUE?c("primary"):Math.max(m,0)},c=m=>{var y;return(y=e.primaryDetails)!=null&&y.live?e.primaryDetails.edge:e.schedule.durations[m]},h=(m,y)=>{var v,x;const b=e.effectivePlayingItem;if(b!=null&&(v=b.event)!=null&&v.restrictions.skip)return;e.log(`seek to ${m} "${y}"`);const A=e.effectivePlayingItem,S=e.schedule.findItemIndexAtTime(m,y),k=(x=e.schedule.items)==null?void 0:x[S],R=e.getBufferingPlayer(),_=R==null?void 0:R.interstitial,C=_==null?void 0:_.appendInPlace,U=A&&e.itemsMatch(A,k);if(A&&(C||U)){const B=n(e.playingAsset),F=(B==null?void 0:B.media)||e.primaryMedia;if(F){const M=y==="primary"?F.currentTime:i(A,y,e.playingAsset,"timelinePos","currentTime"),j=m-M,ae=(C?M:F.currentTime)+j;if(ae>=0&&(!B||C||ae<=B.duration)){F.currentTime=ae;return}}}if(k){let B=m;if(y!=="primary"){const M=k[y].start,j=m-M;B=k.start+j}const F=!e.isInterstitial(k);if((!e.isInterstitial(A)||A.event.appendInPlace)&&(F||k.event.appendInPlace)){const M=e.media||(C?R==null?void 0:R.media:null);M&&(M.currentTime=B)}else if(A){const M=e.findItemIndex(A);if(S>M){const ae=e.schedule.findJumpRestrictedIndex(M+1,S);if(ae>M){e.setSchedulePosition(ae);return}}let j=0;if(F)e.timelinePos=B,e.checkBuffer();else{var O;const ae=k==null||(O=k.event)==null?void 0:O.assetList;if(ae){const ye=m-(k[y]||k).start;for(let pe=ae.length;pe--;){const W=ae[pe];if(W.duration&&ye>=W.startOffset&&ye<W.startOffset+W.duration){j=pe;break}}}}e.setSchedulePosition(S,j)}}},f=()=>{const m=e.effectivePlayingItem;if(e.isInterstitial(m))return m;const y=t();return e.isInterstitial(y)?y:null},g={get currentTime(){const m=f(),y=e.effectivePlayingItem;return y&&y===m?i(y,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-y.playout.start:0},set currentTime(m){const y=f(),v=e.effectivePlayingItem;v&&v===y&&h(m+v.playout.start,"playout")},get duration(){const m=f();return m?m.playout.end-m.playout.start:0},get assetPlayers(){var m;const y=(m=f())==null?void 0:m.event.assetList;return y?y.map(v=>e.getAssetPlayer(v.identifier)):[]},get playingIndex(){var m;const y=(m=f())==null?void 0:m.event;return y&&e.effectivePlayingAsset?y.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return f()}};this.manager={get events(){var m,y;return((m=e.schedule)==null||(y=m.events)==null?void 0:y.slice(0))||[]},get schedule(){var m,y;return((m=e.schedule)==null||(y=m.items)==null?void 0:y.slice(0))||[]},get interstitialPlayer(){return f()?g:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const m=t();return e.findItemIndex(m)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const m=e.effectivePlayingItem;return e.findItemIndex(m)},primary:{get bufferedEnd(){return l()},get currentTime(){const m=e.timelinePos;return m>0?m:0},set currentTime(m){h(m,"primary")},get duration(){return c("primary")},get seekableStart(){var m;return((m=e.primaryDetails)==null?void 0:m.fragmentStart)||0}},integrated:{get bufferedEnd(){return i(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return i(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(m){h(m,"integrated")},get duration(){return c("integrated")},get seekableStart(){var m;return a(((m=e.primaryDetails)==null?void 0:m.fragmentStart)||0,"integrated")}},skip:()=>{const m=e.effectivePlayingItem,y=m==null?void 0:m.event;if(y&&!y.restrictions.skip){const v=e.findItemIndex(m);if(y.appendInPlace){const x=m.playout.start+m.event.duration;h(x+.001,"playout")}else e.advanceAfterAssetEnded(y,v,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,n=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!n?!1:this.findItemIndex(t)===n.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t,n;if(this.mediaSelection===null)return;const i=this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&!i.event.appendInPlace)return;let a=this.media;!a&&(e=this.bufferingItem)!=null&&(t=e.event)!=null&&t.appendInPlace&&(a=this.primaryMedia);const l=(n=a)==null?void 0:n.currentTime;if(!(l===void 0||!Ee(l)))return l}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const n=this.getAssetPlayer(e);n&&this.transferMediaFromPlayer(n,t)}transferMediaFromPlayer(e,t){const n=e.interstitial.appendInPlace,i=e.media;if(n&&i===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&i){this.detachedData={media:i};return}const a=e.transferMedia();this.log(`transfer MediaSource from ${e} ${St(a)}`),this.detachedData=a}else t&&i&&(this.shouldPlay||(this.shouldPlay=!i.paused))}transferMediaTo(e,t){var n,i;if(e.media===t)return;let a=null;const l=this.hls,c=e!==l,h=c&&e.interstitial.appendInPlace,f=(n=this.detachedData)==null?void 0:n.mediaSource;let g;if(l.media)h&&(a=l.transferMedia(),this.detachedData=a),g="Primary";else if(f){const v=this.getBufferingPlayer();v?(a=v.transferMedia(),g=`${v}`):g="detached MediaSource"}else g="detached media";if(!a){if(f)a=this.detachedData,this.log(`using detachedData: MediaSource ${St(a)}`);else if(!this.detachedData||l.media===t){const v=this.playerQueue;v.length>1&&v.forEach(x=>{if(c&&x.interstitial.appendInPlace!==h){const b=x.interstitial;this.clearInterstitial(x.interstitial,null),b.appendInPlace=!1,b.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${b}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const m=a&&"mediaSource"in a&&((i=a.mediaSource)==null?void 0:i.readyState)!=="closed",y=m&&a?a:t;if(this.log(`${m?"transfering MediaSource":"attaching media"} to ${c?e:"Primary"} from ${g}`),y===a){const v=c&&e.assetId===this.schedule.assetIdAtEnd;y.overrides={duration:this.schedule.duration,endOfStream:!c||v,cueRemoval:!c}}e.attachMedia(y)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const n=this.timelinePos,i=this.effectivePlayingItem;if(n===-1){const a=this.hls.startPosition;if(this.timelinePos=a,t.length&&t[0].cue.pre){const l=e.findEventIndex(t[0].identifier);this.setSchedulePosition(l)}else if(a>=0||!this.primaryLive){const l=this.timelinePos=a>0?a:0,c=e.findItemIndexAtTime(l);this.setSchedulePosition(c)}}else if(i&&!this.playingItem){const a=e.findItemIndex(i);this.setSchedulePosition(a)}}advanceAfterAssetEnded(e,t,n){const i=n+1;if(!e.isAssetPastPlayoutLimit(i)&&!e.assetList[i].error)this.setSchedulePosition(t,i);else{const a=this.schedule.items;if(a){const l=t+1,c=a.length;if(l>=c){this.setSchedulePosition(-1);return}const h=e.resumeTime;this.timelinePos<h&&(this.timelinePos=h,this.checkBuffer()),this.setSchedulePosition(l)}}}setScheduleToAssetAtTime(e,t){const n=this.schedule,i=t.parentIdentifier,a=n.getEvent(i);if(a){const l=n.findEventIndex(i),c=n.findAssetIndex(a,e);this.setSchedulePosition(l,c)}}setSchedulePosition(e,t){const n=this.schedule.items;if(!n||this.playbackDisabled)return;this.log(`setSchedulePosition ${e}, ${t}`);const i=e>=0?n[e]:null,a=this.playingItem,l=this.playingLastItem;if(this.isInterstitial(a)){var c;const f=a.event,g=this.playingAsset,m=g==null?void 0:g.identifier,y=m?this.getAssetPlayer(m):null;if(y&&m&&(!this.eventItemsMatch(a,i)||t!==void 0&&m!==((c=f.assetList)==null?void 0:c[t].identifier))){var h;const v=f.findAssetIndex(g);this.log(`INTERSTITIAL_ASSET_ENDED ${v+1}/${f.assetList.length} ${Op(g)}`),this.endedAsset=g,this.playingAsset=null,this.hls.trigger(T.INTERSTITIAL_ASSET_ENDED,{asset:g,assetListIndex:v,event:f,schedule:n.slice(0),scheduleIndex:e,player:y}),this.retreiveMediaSource(m,i),y.media&&!((h=this.detachedData)!=null&&h.mediaSource)&&y.detachMedia()}if(!this.eventItemsMatch(a,i)&&(this.endedItem=a,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${f} ${Zr(a)}`),f.hasPlayed=!0,this.hls.trigger(T.INTERSTITIAL_ENDED,{event:f,schedule:n.slice(0),scheduleIndex:e}),f.cue.once)){this.updateSchedule();const v=this.schedule.items;if(i&&v){const x=this.schedule.findItemIndex(i);this.advanceSchedule(x,v,t,a,l)}return}}this.advanceSchedule(e,n,t,a,l)}advanceSchedule(e,t,n,i,a){const l=e>=0?t[e]:null,c=this.primaryMedia,h=this.playerQueue;if(h.length&&h.forEach(f=>{const g=f.interstitial,m=this.schedule.findEventIndex(g.identifier);(m<e||m>e+1)&&this.clearInterstitial(g,l)}),this.isInterstitial(l)){this.timelinePos=Math.min(Math.max(this.timelinePos,l.start),l.end);const f=l.event;n===void 0&&(n=this.schedule.findAssetIndex(f,this.timelinePos));const g=this.waitingItem;this.assetsBuffered(l,c)||this.setBufferingItem(l);let m=this.preloadAssets(f,n);if(this.eventItemsMatch(l,g||i)||(this.waitingItem=l,this.log(`INTERSTITIAL_STARTED ${Zr(l)} ${f.appendInPlace?"append in place":""}`),this.hls.trigger(T.INTERSTITIAL_STARTED,{event:f,schedule:t.slice(0),scheduleIndex:e})),!f.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${f}`);return}if(f.assetListLoader&&(f.assetListLoader.destroy(),f.assetListLoader=void 0),!c){this.log(`Waiting for attachMedia to start Interstitial ${f}`);return}this.waitingItem=this.endedItem=null,this.playingItem=l;const y=f.assetList[n];if(!y){const v=t[e+1],x=this.media;v&&x&&!this.isInterstitial(v)&&x.currentTime<v.start&&(x.currentTime=this.timelinePos=v.start),this.advanceAfterAssetEnded(f,e,n||0);return}if(m||(m=this.getAssetPlayer(y.identifier)),m===null||m.destroyed){const v=f.assetList.length;this.warn(`asset ${n+1}/${v} player destroyed ${f}`),m=this.createAssetPlayer(f,y,n)}if(!this.eventItemsMatch(l,this.bufferingItem)&&f.appendInPlace&&this.isAssetBuffered(y))return;this.startAssetPlayer(m,n,t,e,c),this.shouldPlay&&xb(m.media)}else l!==null?(this.resumePrimary(l,e,i),this.shouldPlay&&xb(this.hls.media)):a&&this.isInterstitial(i)&&(this.endedItem=null,this.playingItem=i,i.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e,t;return(e=this.mediaSelection)==null||(t=e.main)==null?void 0:t.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,n){var i;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${Zr(e)}`),!((i=this.detachedData)!=null&&i.mediaSource)){let l=this.timelinePos;(l<e.start||l>=e.end)&&(l=this.getPrimaryResumption(e,t),this.timelinePos=l),this.attachPrimary(l,e)}if(!n)return;const a=this.schedule.items;a&&(this.log(`resumed ${Zr(e)}`),this.hls.trigger(T.INTERSTITIALS_PRIMARY_RESUMED,{schedule:a.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const n=e.start;if(this.primaryLive){const i=this.primaryDetails;if(t===0)return this.hls.startPosition;if(i&&(n<i.fragmentStart||n>i.edge))return this.hls.liveSyncPosition||-1}return n}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:ze.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,n){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const i=this.primaryMedia;if(!i)return;const a=this.hls;a.media?this.checkBuffer():(this.transferMediaTo(a,i),n&&this.startLoadingPrimaryAt(e,n)),n||(this.timelinePos=e,this.startLoadingPrimaryAt(e,n))}startLoadingPrimaryAt(e,t){var n;const i=this.hls;!i.loadingEnabled||!i.media||Math.abs((((n=i.mainForwardBufferInfo)==null?void 0:n.start)||i.media.currentTime)-e)>.5?i.startLoad(e,t):i.bufferingEnabled||i.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(T.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(T.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1)return;const n=this.hls.levels[t.level],i=lt(lt({},this.mediaSelection||this.altSelection),{},{main:n});this.mediaSelection=i,this.schedule.parseInterstitialDateRanges(i,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const n=this.hls.audioTracks[t.id],i=this.mediaSelection;if(!i){this.altSelection=lt(lt({},this.altSelection),{},{audio:n});return}const a=lt(lt({},i),{},{audio:n});this.mediaSelection=a}onSubtitleTrackUpdated(e,t){const n=this.hls.subtitleTracks[t.id],i=this.mediaSelection;if(!i){this.altSelection=lt(lt({},this.altSelection),{},{subtitles:n});return}const a=lt(lt({},i),{},{subtitles:n});this.mediaSelection=a}onAudioTrackSwitching(e,t){const n=CE(t);this.playerQueue.forEach(i=>i.hls.setAudioOption(t)||i.hls.setAudioOption(n))}onSubtitleTrackSwitch(e,t){const n=CE(t);this.playerQueue.forEach(i=>i.hls.setSubtitleOption(t)||t.id!==-1&&i.hls.setSubtitleOption(n))}onBufferCodecs(e,t){const n=t.tracks;n&&(this.requiredTracks=n)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const n=this.playingItem;if(n&&!this.itemsMatch(n,this.bufferingItem)&&!this.isInterstitial(n)){const i=this.timelinePos;this.bufferedPos=i,this.checkBuffer()}}onBufferedToEnd(e){const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let i=0;i<t.length;i++){const a=t[i];if(a.cue.post){var n;const l=this.schedule.findEventIndex(a.identifier),c=(n=this.schedule.items)==null?void 0:n[l];this.isInterstitial(c)&&this.eventItemsMatch(c,this.bufferingItem)&&this.bufferedToItem(c,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const n=this.findItemIndex(t);this.setSchedulePosition(n+1)}else this.shouldPlay=!1}updateItem(e,t){const n=this.schedule.items;if(e&&n){const i=this.findItemIndex(e,t);return n[i]||null}return null}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var n;return!!t&&(e===t||e.event.identifier===((n=t.event)==null?void 0:n.identifier))}findItemIndex(e,t){return e?this.schedule.findItemIndex(e,t):-1}updateSchedule(){const e=this.mediaSelection;e&&this.schedule.updateSchedule(e,[])}checkBuffer(e){const t=this.schedule.items;if(!t)return;const n=ze.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=n.len<1),this.updateBufferedPos(n.end,t,e)}updateBufferedPos(e,t,n){const i=this.schedule,a=this.bufferingItem;if(this.bufferedPos>e)return;if(t.length===1&&this.itemsMatch(t[0],a)){this.bufferedPos=e;return}const l=this.playingItem,c=this.findItemIndex(l);let h=i.findItemIndexAtTime(e);if(this.bufferedPos<e){var f,g;const m=this.findItemIndex(a),y=Math.min(m+1,t.length-1),v=t[y];if((h===-1&&a&&e>=a.end||(f=v.event)!=null&&f.appendInPlace&&e+.01>=v.start)&&(h=y),y-c>1&&(a==null||(g=a.event)==null?void 0:g.appendInPlace)===!1)return;if(this.bufferedPos=e,h>m&&h>c)this.bufferedToItem(v);else{const x=this.primaryDetails;this.primaryLive&&x&&e>x.edge-x.targetduration&&v.start<x.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(v)&&this.preloadAssets(v.event,0)}}else n&&l&&!this.itemsMatch(l,a)&&(h===c?this.bufferedToItem(l):h===c+1&&this.bufferedToItem(t[h]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(i=>{const a=this.getAssetPlayer(i.identifier);return!(a!=null&&a.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,n=this.schedule;if(this.itemsMatch(e,t))this.bufferingItem!==e&&(this.bufferingItem=e);else{const{items:i,events:a}=n;if(!i||!a)return t;const l=this.isInterstitial(e),c=this.getBufferingPlayer();if(this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos)),!this.playbackDisabled){const h=c?c.remaining:t?t.end-this.timelinePos:0;this.log(`buffered to boundary ${Zr(e)}`+(t?` (${h.toFixed(2)} remaining)`:"")),l?e.event.assetList.forEach(f=>{const g=this.getAssetPlayer(f.identifier);g&&g.resumeBuffering()}):(this.hls.resumeBuffering(),this.playerQueue.forEach(f=>f.pauseBuffering()))}this.hls.trigger(T.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:a.slice(0),schedule:i.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}return t}bufferedToItem(e,t=0){const n=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(n!==null){this.bufferingAsset=null;const i=this.detachedData;i?i.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),n=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(n)}bufferedToEvent(e,t){const n=e.event,i=n.assetList.length===0&&!n.assetListLoader,a=n.cue.once;if(i||!a){const l=this.preloadAssets(n,t);if(l!=null&&l.interstitial.appendInPlace){const c=n.assetList[t],h=this.primaryMedia;c&&h&&this.bufferAssetPlayer(l,h)}}}preloadAssets(e,t){const n=e.assetUrl,i=e.assetList.length,a=i===0&&!e.assetListLoader,l=e.cue.once;if(a){const h=e.timelineStart;if(e.appendInPlace){var c;const y=this.playingItem;!this.isInterstitial(y)&&(y==null||(c=y.nextEvent)==null?void 0:c.identifier)===e.identifier&&this.flushFrontBuffer(h+.25)}let f,g=0;if(!this.playingItem&&this.primaryLive&&(g=this.hls.startPosition,g===-1&&(g=this.hls.liveSyncPosition||0)),g&&!(e.cue.pre||e.cue.post)){const y=g-h;y>0&&(f=Math.round(y*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${n?1:i} ${e}${f?` live-start: ${g} start-offset: ${f}`:""}`),n)return this.createAsset(e,0,0,h,e.duration,n);const m=this.assetListLoader.loadAssetList(e,f);m&&(e.assetListLoader=m)}else if(!l&&i){for(let h=t;h<i;h++){const f=e.assetList[h],g=this.getAssetPlayerQueueIndex(f.identifier);(g===-1||this.playerQueue[g].destroyed)&&!f.error&&this.createAssetPlayer(e,f,h)}return this.getAssetPlayer(e.assetList[t].identifier)}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(i=>{this.hls.trigger(T.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:i})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let n=0;n<t.length;n++)if(e===t[n].assetId)return n;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let n=0;n<e.length;n++)if(e[n].media===t)return e[n]}return null}createAsset(e,t,n,i,a,l){const c={parentIdentifier:e.identifier,identifier:PM(e,l,t),duration:a,startOffset:n,timelineStart:i,uri:l};return this.createAssetPlayer(e,c,t)}createAssetPlayer(e,t,n){this.log(`create HLSAssetPlayer for ${Op(t)}`);const i=this.hls,a=i.userConfig;let l=a.videoPreference;const c=i.loadLevelObj||i.levels[i.currentLevel];(l||c)&&(l=ht({},l),c.videoCodec&&(l.videoCodec=c.videoCodec),c.videoRange&&(l.allowedVideoRanges=[c.videoRange]));const h=i.audioTracks[i.audioTrack],f=i.subtitleTracks[i.subtitleTrack];let g=0;if(this.primaryLive||e.appendInPlace){const R=this.timelinePos-t.timelineStart;if(R>1){const _=t.duration;_&&R<_&&(g=R)}}const m=t.identifier,y=lt(lt({},a),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:i.sessionId,assetPlayerId:m,abrEwmaDefaultEstimate:i.bandwidthEstimate,interstitialsController:void 0,startPosition:g,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:l,audioPreference:h||a.audioPreference,subtitlePreference:f||a.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(y.timelineOffset=t.timelineStart));const v=y.cmcd;v!=null&&v.sessionId&&v.contentId&&(y.cmcd=ht({},v,{contentId:yh(t.uri)})),this.getAssetPlayer(m)&&this.warn(`Duplicate date range identifier ${e} and asset ${m}`);const x=new UM(this.HlsPlayerClass,y,e,t);this.playerQueue.push(x),e.assetList[n]=t;const b=R=>{if(R.live){const U=new Error(`Interstitials MUST be VOD assets ${e}`),O={fatal:!0,type:Re.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:U};this.handleAssetItemError(O,e,this.schedule.findEventIndex(e.identifier),n,U.message);return}const _=R.edge-R.fragmentStart,C=t.duration;(C===null||_>C)&&(this.log(`Interstitial asset "${m}" duration change ${C} > ${_}`),t.duration=_,this.updateSchedule())};x.on(T.LEVEL_UPDATED,(R,{details:_})=>b(_)),x.on(T.LEVEL_PTS_UPDATED,(R,{details:_})=>b(_));const A=(R,_)=>{const C=this.getAssetPlayer(m);if(C&&_.tracks){C.off(T.BUFFER_CODECS,A),C.tracks=_.tracks;const U=this.primaryMedia;this.bufferingAsset===C.assetItem&&U&&!C.media&&this.bufferAssetPlayer(C,U)}};x.on(T.BUFFER_CODECS,A);const S=()=>{var R;const _=this.getAssetPlayer(m);if(this.log(`buffered to end of asset ${_}`),!_)return;const C=this.schedule.findEventIndex(e.identifier),U=e.findAssetIndex(t),O=U+1,B=(R=this.schedule.items)==null?void 0:R[C];if(this.isInterstitial(B))if(U!==-1&&!e.isAssetPastPlayoutLimit(O)&&!e.assetList[O].error)this.bufferedToItem(B,O);else{var F;const M=(F=this.schedule.items)==null?void 0:F[C+1];M&&this.bufferedToItem(M)}};x.on(T.BUFFERED_TO_END,S);const k=R=>()=>{if(!this.getAssetPlayer(m))return;this.shouldPlay=!0;const C=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,C,R)};return x.once(T.MEDIA_ENDED,k(n)),x.once(T.PLAYOUT_LIMIT_REACHED,k(1/0)),x.on(T.ERROR,(R,_)=>{const C=this.getAssetPlayer(m);if(_.details===Q.BUFFER_STALLED_ERROR){if(C!=null&&C.media){const U=C.currentTime,O=C.duration-U;U&&e.appendInPlace&&O/C.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${m} ${e} at ${C.media.currentTime}`),S()):(this.warn(`Stalled at ${U} of ${U+O} in asset ${m} ${e}`),this.onTimeupdate(),this.checkBuffer(!0))}return}this.handleAssetItemError(_,e,this.schedule.findEventIndex(e.identifier),n,`Asset player error ${_.error} ${e}`)}),x.on(T.DESTROYING,()=>{if(!this.getAssetPlayer(m))return;const _=new Error(`Asset player destroyed unexpectedly ${m}`),C={fatal:!0,type:Re.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:_};this.handleAssetItemError(C,e,this.schedule.findEventIndex(e.identifier),n,_.message)}),this.hls.trigger(T.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:n,event:e,player:x}),x}clearInterstitial(e,t){e.assetList.forEach(n=>{this.clearAssetPlayer(n.identifier,t)}),e.reset()}clearAssetPlayer(e,t){const n=this.getAssetPlayerQueueIndex(e);if(n!==-1){this.log(`clearAssetPlayer "${e}" toSegment: ${t&&Zr(t)}`);const i=this.playerQueue[n];this.transferMediaFromPlayer(i,t),this.playerQueue.splice(n,1),i.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,n,i,a){const{interstitial:l,assetItem:c,assetId:h}=e,f=l.assetList.length,g=this.playingAsset;this.endedAsset=null,this.playingAsset=c,(!g||g.identifier!==h)&&(g&&(this.clearAssetPlayer(g.identifier,n[i]),delete g.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${f} ${e}`),this.hls.trigger(T.INTERSTITIAL_ASSET_STARTED,{asset:c,assetListIndex:t,event:l,schedule:n.slice(0),scheduleIndex:i,player:e})),this.bufferAssetPlayer(e,a)}bufferAssetPlayer(e,t){var n,i;const{interstitial:a,assetItem:l,assetId:c}=e,h=this.schedule.findEventIndex(a.identifier),f=(n=this.schedule.items)==null?void 0:n[h];if(!f)return;this.setBufferingItem(f),this.bufferingAsset=l;const g=this.getBufferingPlayer();if(g===e)return;const m=a.appendInPlace;if(m&&(g==null?void 0:g.interstitial.appendInPlace)===!1)return;const y=(g==null?void 0:g.tracks)||((i=this.detachedData)==null?void 0:i.tracks)||this.requiredTracks;if(m&&l!==this.playingAsset){if(!e.tracks)return;if(y&&!wS(y,e.tracks)){const v=new Error(`Asset "${c}" SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(y)}')`),x={fatal:!0,type:Re.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:v},b=a.findAssetIndex(l);this.handleAssetItemError(x,a,h,b,v.message);return}}this.transferMediaTo(e,t)}handleAssetItemError(e,t,n,i,a){if(e.details===Q.BUFFER_STALLED_ERROR)return;const l=t.assetList[i]||null;let c=null;if(l){const m=this.getAssetPlayerQueueIndex(l.identifier);c=this.playerQueue[m]||null}const h=this.schedule.items,f=ht({},e,{fatal:!1,errorAction:Sh(!0),asset:l,assetListIndex:i,event:t,schedule:h,scheduleIndex:n,player:c});if(this.warn(`Asset item error: ${e.error}`),this.hls.trigger(T.INTERSTITIAL_ASSET_ERROR,f),!e.fatal)return;const g=new Error(a);l&&(this.playingAsset!==l&&this.clearAssetPlayer(l.identifier,null),l.error=g),t.assetList.some(m=>!m.error)?t.appendInPlace&&(t.error=g):t.error=g,this.primaryFallback(t)}primaryFallback(e){const t=e.timelineStart,n=this.effectivePlayingItem;if(this.updateSchedule(),n){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${n?Zr(n):"<none>"} error: ${e.error}`),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t));let i=this.timelinePos;i===-1&&(i=this.hls.startPosition);const a=this.updateItem(n,i);if(this.itemsMatch(n,a))this.clearInterstitial(e,null);else{const l=this.schedule.findItemIndexAtTime(i);this.setSchedulePosition(l)}}else this.checkStart()}onAssetListLoaded(e,t){var n;const i=t.event,a=i.identifier,l=t.assetListResponse.ASSETS;if(!this.schedule.hasEvent(a))return;const c=i.timelineStart,h=i.duration;let f=0;l.forEach((x,b)=>{const A=parseFloat(x.DURATION);this.createAsset(i,b,f,c+f,A,x.URI),f+=A}),i.duration=f,this.log(`Loaded asset-list with duration: ${f} (was: ${h}) ${i}`);const g=this.waitingItem,m=(g==null?void 0:g.event.identifier)===a;this.updateSchedule();const y=(n=this.bufferingItem)==null?void 0:n.event;if(m){var v;const x=this.schedule.findEventIndex(a),b=(v=this.schedule.items)==null?void 0:v[x];if(b){if(!this.playingItem&&this.timelinePos>b.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==x){i.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${i}`),this.primaryFallback(i);return}this.setBufferingItem(b)}this.setSchedulePosition(x)}else if((y==null?void 0:y.identifier)===a&&y.appendInPlace){const x=i.assetList[0],b=this.getAssetPlayer(x.identifier),A=this.primaryMedia;x&&b&&A&&this.bufferAssetPlayer(b,A)}}onError(e,t){switch(t.details){case Q.ASSET_LIST_PARSING_ERROR:case Q.ASSET_LIST_LOAD_ERROR:case Q.ASSET_LIST_LOAD_TIMEOUT:{const n=t.interstitial;n&&this.primaryFallback(n);break}case Q.BUFFER_STALLED_ERROR:{this.onTimeupdate(),this.checkBuffer(!0);break}}}}const Eb=500;class HM extends Ny{constructor(e,t,n){super(e,t,n,"subtitle-stream-controller",Te.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(T.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(T.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(T.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(T.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(T.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(T.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=oe.IDLE,this.setInterval(Eb),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if(ln(n)&&(this.fragPrevious=n),this.state=oe.IDLE,!i)return;const a=this.tracksBuffered[this.currentTrackId];if(!a)return;let l;const c=n.start;for(let f=0;f<a.length;f++)if(c>=a[f].start&&c<=a[f].end){l=a[f];break}const h=n.start+n.duration;l?l.end=h:(l={start:c,end:h},a.push(l)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(n===0&&i!==Number.POSITIVE_INFINITY){const a=i-1;if(a<=0)return;t.endOffsetSubtitles=Math.max(0,a),this.tracksBuffered.forEach(l=>{for(let c=0;c<l.length;){if(l[c].end<=a){l.shift();continue}else if(l[c].start<a)l[c].start=a;else break;c++}}),this.fragmentTracker.removeFragmentsInRange(n,a,Te.SUBTITLE)}}onError(e,t){const n=t.frag;(n==null?void 0:n.type)===Te.SUBTITLE&&(t.details===Q.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==oe.STOPPED&&(this.state=oe.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&TT(this.levels,t)){this.levels=t.map(n=>new Ah(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const i=new Ah(n);return this.tracksBuffered[i.id]=[],i}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Te.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const i=this.levels[this.currentTrackId];i!=null&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.state!==oe.STOPPED&&this.setInterval(Eb)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:i,levels:a}=this,{details:l,id:c}=t;if(!a){this.warn(`Subtitle tracks were reset while loading level ${c}`);return}const h=a[c];if(c>=a.length||!h)return;this.log(`Subtitle track ${c} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""},duration:${l.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let f=0;if(l.live||(n=h.details)!=null&&n.live){const m=this.mainDetails;if(l.deltaUpdateFailed||!m)return;const y=m.fragments[0];if(!h.details)l.hasProgramDateTime&&m.hasProgramDateTime?(Ad(l,m),f=l.fragmentStart):y&&(f=y.start,Rp(l,f));else{var g;f=this.alignPlaylists(l,h.details,(g=this.levelLastLoaded)==null?void 0:g.details),f===0&&y&&(f=y.start,Rp(l,f))}}h.details=l,this.levelLastLoaded=h,c===i&&(this.hls.trigger(T.SUBTITLE_TRACK_UPDATED,{details:l,id:c,groupId:t.groupId}),this.tick(),l.live&&!this.fragCurrent&&this.media&&this.state===oe.IDLE&&(Bl(null,l.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),h.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,a=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&i!=null&&i.key&&i.iv&&Xo(i.method)){const l=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer,My(i.method)).catch(c=>{throw a.trigger(T.ERROR,{type:Re.MEDIA_ERROR,details:Q.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:t}),c}).then(c=>{const h=performance.now();a.trigger(T.FRAG_DECRYPTED,{frag:t,payload:c,stats:{tstart:l,tdecrypt:h}})}).catch(c=>{this.warn(`${c.name}: ${c.message}`),this.state=oe.IDLE})}}doTick(){if(!this.media){this.state=oe.IDLE;return}if(this.state===oe.IDLE){const{currentTrackId:e,levels:t}=this,n=t==null?void 0:t[e];if(!n||!t.length||!n.details||this.waitForLive(n))return;const{config:i}=this,a=this.getLoadPosition(),l=ze.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a,i.maxBufferHole),{end:c,len:h}=l,f=n.details,g=this.hls.maxBufferLength+f.levelTargetDuration;if(h>g)return;const m=f.fragments,y=m.length,v=f.edge;let x=null;const b=this.fragPrevious;if(c<v){const k=i.maxFragLookUpTolerance,R=c>v-k?0:k;x=Bl(b,m,Math.max(m[0].start,c),R),!x&&b&&b.start<m[0].start&&(x=m[0])}else x=m[y-1];if(x=this.filterReplacedPrimary(x,n.details),!x)return;const A=x.sn-f.startSN,S=m[A-1];if(S&&S.cc===x.cc&&this.fragmentTracker.getState(S)===Xt.NOT_LOADED&&(x=S),this.fragmentTracker.getState(x)===Xt.NOT_LOADED){const k=this.mapToInitFragWhenRequired(x);k&&this.loadFragment(k,n,c)}}}loadFragment(e,t,n){ln(e)?super.loadFragment(e,t,n):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new zM(this.tracksBuffered[this.currentTrackId]||[])}}class zM{constructor(e){this.buffered=void 0;const t=(n,i,a)=>{if(i=i>>>0,i>a-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${a})`);return e[i][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}const VM={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},MT=s=>String.fromCharCode(VM[s]||s),Bs=15,qi=100,KM={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},YM={17:2,18:4,21:6,22:8,23:10,19:13,20:15},jM={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},QM={25:2,26:4,29:6,30:8,31:10,27:13,28:15},qM=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class XM{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;Je.log(`${this.time} [${e}] ${n}`)}}}const tl=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class PT{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class WM{constructor(){this.uchar=" ",this.penState=new PT}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class ZM{constructor(e){this.chars=[],this.pos=0,this.currPenState=new PT,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<qi;t++)this.chars.push(new WM);this.logger=e}equals(e){for(let t=0;t<qi;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<qi;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<qi;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>qi&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=qi)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=MT(e);if(this.pos>=qi){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<qi;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<qi;n++){const i=this.chars[n].uchar;i!==" "&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class zm{constructor(e){this.rows=[],this.currRow=Bs-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Bs;t++)this.rows.push(new ZM(e));this.logger=e}reset(){for(let e=0;e<Bs;e++)this.rows[e].clear();this.currRow=Bs-1}equals(e){let t=!0;for(let n=0;n<Bs;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<Bs;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Bs;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+St(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let c=0;c<Bs;c++)this.rows[c].clear();const a=this.currRow+1-this.nrRollUpRows,l=this.lastOutputScreen;if(l){const c=l.rows[a].cueStartTime,h=this.logger.time;if(c!==null&&h!==null&&c<h)for(let f=0;f<this.nrRollUpRows;f++)this.rows[t-this.nrRollUpRows+f+1].copy(l.rows[a+f])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const a=e.indent,l=Math.max(a-1,0);n.setCursor(e.indent),e.color=n.chars[l].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+St(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let a=0;a<Bs;a++){const l=this.rows[a].getTextString();l&&(i=a+1,e?t.push("Row "+i+": '"+l+"'"):t.push(l.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class bb{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new zm(n),this.nonDisplayedMemory=new zm(n),this.lastOutputScreen=new zm(n),this.currRollUpRow=this.displayedMemory.rows[Bs-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Bs-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+St(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Ab{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=eP(),this.logger=void 0;const i=this.logger=new XM;this.channels=[null,new bb(e,t,i),new bb(e+1,n,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const i=t[n]&127,a=t[n+1]&127;let l=!1,c=null;if(i===0&&a===0)continue;this.logger.log(3,()=>"["+tl([t[n],t[n+1]])+"] -> ("+tl([i,a])+")");const h=this.cmdHistory;if(i>=16&&i<=31){if(JM(i,a,h)){C0(null,null,h),this.logger.log(3,()=>"Repeated command ("+tl([i,a])+") is dropped");continue}C0(i,a,this.cmdHistory),l=this.parseCmd(i,a),l||(l=this.parseMidrow(i,a)),l||(l=this.parsePAC(i,a)),l||(l=this.parseBackgroundAttributes(i,a))}else C0(null,null,h);if(!l&&(c=this.parseChars(i,a),c)){const g=this.currentChannel;g&&g>0?this.channels[g].insertChars(c):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!l&&!c&&this.logger.log(2,()=>"Couldn't parse cleaned data "+tl([i,a])+" orig: "+tl([t[n],t[n+1]]))}}parseCmd(e,t){const n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=33&&t<=35;if(!(n||i))return!1;const a=e===20||e===21||e===23?1:2,l=this.channels[a];return e===20||e===21||e===28||e===29?t===32?l.ccRCL():t===33?l.ccBS():t===34?l.ccAOF():t===35?l.ccAON():t===36?l.ccDER():t===37?l.ccRU(2):t===38?l.ccRU(3):t===39?l.ccRU(4):t===40?l.ccFON():t===41?l.ccRDC():t===42?l.ccTR():t===43?l.ccRTD():t===44?l.ccEDM():t===45?l.ccCR():t===46?l.ccENM():t===47&&l.ccEOC():l.ccTO(t-32),this.currentChannel=a,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return i?(i.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+tl([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const i=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,a=(e===16||e===24)&&t>=64&&t<=95;if(!(i||a))return!1;const l=e<=23?1:2;t>=64&&t<=95?n=l===1?KM[e]:jM[e]:n=l===1?YM[e]:QM[e];const c=this.channels[l];return c?(c.setPAC(this.interpretPAC(n,t)),this.currentChannel=l,!0):!1}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,i.underline=(n&1)===1,n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=Math.floor((n-16)/2)*4,i}parseChars(e,t){let n,i=null,a=null;if(e>=25?(n=2,a=e-8):(n=1,a=e),a>=17&&a<=19){let l;a===17?l=t+80:a===18?l=t+112:l=t+144,this.logger.log(2,()=>"Special char '"+MT(l)+"' in channel "+n),i=[l]}else e>=32&&e<=127&&(i=t===0?[e]:[e,t]);return i&&this.logger.log(3,()=>"Char codes =  "+tl(i).join(",")),i}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=45&&t<=47;if(!(n||i))return!1;let a;const l={};e===16||e===24?(a=Math.floor((t-32)/2),l.background=qM[a],t%2===1&&(l.background=l.background+"_semi")):t===45?l.background="transparent":(l.foreground="black",t===47&&(l.underline=!0));const c=e<=23?1:2;return this.channels[c].setBkgData(l),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}C0(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function C0(s,e,t){t.a=s,t.b=e}function JM(s,e,t){return t.a===s&&t.b===e}function eP(){return{a:null,b:null}}var jy=function(){if(bd!=null&&bd.VTTCue)return self.VTTCue;const s=["","lr","rl"],e=["start","middle","end","left","right"];function t(c,h){if(typeof h!="string"||!Array.isArray(c))return!1;const f=h.toLowerCase();return~c.indexOf(f)?f:!1}function n(c){return t(s,c)}function i(c){return t(e,c)}function a(c,...h){let f=1;for(;f<arguments.length;f++){const g=arguments[f];for(const m in g)c[m]=g[m]}return c}function l(c,h,f){const g=this,m={enumerable:!0};g.hasBeenReset=!1;let y="",v=!1,x=c,b=h,A=f,S=null,k="",R=!0,_="auto",C="start",U=50,O="middle",B=50,F="middle";Object.defineProperty(g,"id",a({},m,{get:function(){return y},set:function(M){y=""+M}})),Object.defineProperty(g,"pauseOnExit",a({},m,{get:function(){return v},set:function(M){v=!!M}})),Object.defineProperty(g,"startTime",a({},m,{get:function(){return x},set:function(M){if(typeof M!="number")throw new TypeError("Start time must be set to a number.");x=M,this.hasBeenReset=!0}})),Object.defineProperty(g,"endTime",a({},m,{get:function(){return b},set:function(M){if(typeof M!="number")throw new TypeError("End time must be set to a number.");b=M,this.hasBeenReset=!0}})),Object.defineProperty(g,"text",a({},m,{get:function(){return A},set:function(M){A=""+M,this.hasBeenReset=!0}})),Object.defineProperty(g,"region",a({},m,{get:function(){return S},set:function(M){S=M,this.hasBeenReset=!0}})),Object.defineProperty(g,"vertical",a({},m,{get:function(){return k},set:function(M){const j=n(M);if(j===!1)throw new SyntaxError("An invalid or illegal string was specified.");k=j,this.hasBeenReset=!0}})),Object.defineProperty(g,"snapToLines",a({},m,{get:function(){return R},set:function(M){R=!!M,this.hasBeenReset=!0}})),Object.defineProperty(g,"line",a({},m,{get:function(){return _},set:function(M){if(typeof M!="number"&&M!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");_=M,this.hasBeenReset=!0}})),Object.defineProperty(g,"lineAlign",a({},m,{get:function(){return C},set:function(M){const j=i(M);if(!j)throw new SyntaxError("An invalid or illegal string was specified.");C=j,this.hasBeenReset=!0}})),Object.defineProperty(g,"position",a({},m,{get:function(){return U},set:function(M){if(M<0||M>100)throw new Error("Position must be between 0 and 100.");U=M,this.hasBeenReset=!0}})),Object.defineProperty(g,"positionAlign",a({},m,{get:function(){return O},set:function(M){const j=i(M);if(!j)throw new SyntaxError("An invalid or illegal string was specified.");O=j,this.hasBeenReset=!0}})),Object.defineProperty(g,"size",a({},m,{get:function(){return B},set:function(M){if(M<0||M>100)throw new Error("Size must be between 0 and 100.");B=M,this.hasBeenReset=!0}})),Object.defineProperty(g,"align",a({},m,{get:function(){return F},set:function(M){const j=i(M);if(!j)throw new SyntaxError("An invalid or illegal string was specified.");F=j,this.hasBeenReset=!0}})),g.displayState=void 0}return l.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},l}();class tP{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function NT(s){function e(n,i,a,l){return(n|0)*3600+(i|0)*60+(a|0)+parseFloat(l||0)}const t=s.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class nP{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function BT(s,e,t,n){const i=n?s.split(n):[s];for(const a in i){if(typeof i[a]!="string")continue;const l=i[a].split(t);if(l.length!==2)continue;const c=l[0],h=l[1];e(c,h)}}const Mp=new jy(0,0,""),_0=Mp.align==="middle"?"middle":"center";function sP(s,e,t){const n=s;function i(){const c=NT(s);if(c===null)throw new Error("Malformed timestamp: "+n);return s=s.replace(/^[^\sa-zA-Z-]+/,""),c}function a(c,h){const f=new nP;BT(c,function(y,v){let x;switch(y){case"region":for(let b=t.length-1;b>=0;b--)if(t[b].id===v){f.set(y,t[b].region);break}break;case"vertical":f.alt(y,v,["rl","lr"]);break;case"line":x=v.split(","),f.integer(y,x[0]),f.percent(y,x[0])&&f.set("snapToLines",!1),f.alt(y,x[0],["auto"]),x.length===2&&f.alt("lineAlign",x[1],["start",_0,"end"]);break;case"position":x=v.split(","),f.percent(y,x[0]),x.length===2&&f.alt("positionAlign",x[1],["start",_0,"end","line-left","line-right","auto"]);break;case"size":f.percent(y,v);break;case"align":f.alt(y,v,["start",_0,"end","left","right"]);break}},/:/,/\s/),h.region=f.get("region",null),h.vertical=f.get("vertical","");let g=f.get("line","auto");g==="auto"&&Mp.line===-1&&(g=-1),h.line=g,h.lineAlign=f.get("lineAlign","start"),h.snapToLines=f.get("snapToLines",!0),h.size=f.get("size",100),h.align=f.get("align",_0);let m=f.get("position","auto");m==="auto"&&Mp.position===50&&(m=h.align==="start"||h.align==="left"?0:h.align==="end"||h.align==="right"?100:50),h.position=m}function l(){s=s.replace(/^\s+/,"")}if(l(),e.startTime=i(),l(),s.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);s=s.slice(3),l(),e.endTime=i(),l(),a(s,e)}function UT(s){return s.replace(/<br(?: \/)?>/gi,`
`)}class iP{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new tP,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let a=t.buffer,l=0;for(a=UT(a);l<a.length&&a[l]!=="\r"&&a[l]!==`
`;)++l;const c=a.slice(0,l);return a[l]==="\r"&&++l,a[l]===`
`&&++l,t.buffer=a.slice(l),c}function i(a){BT(a,function(l,c){},/:/)}try{let a="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;a=n();const c=a.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(c!=null&&c[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let l=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(l?l=!1:a=n(),t.state){case"HEADER":/:/.test(a)?i(a):a||(t.state="ID");continue;case"NOTE":a||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){t.state="NOTE";break}if(!a)continue;if(t.cue=new jy(0,0,""),t.state="CUE",a.indexOf("-->")===-1){t.cue.id=a;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{sP(a,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const c=a.indexOf("-->")!==-1;if(!a||c&&(l=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=a}continue;case"BADCUE":a||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const rP=/\r\n|\n\r|\n|\r/g,Vm=function(e,t,n=0){return e.slice(n,n+t.length)===t},aP=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),a=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!Ee(t)||!Ee(n)||!Ee(i)||!Ee(a))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*i,t+=60*60*1e3*a,t};function Qy(s,e,t){return yh(s.toString())+yh(e.toString())+yh(t)}const lP=function(e,t,n){let i=e[t],a=e[i.prevCC];if(!a||!a.new&&i.new){e.ccOffset=e.presentationOffset=i.start,i.new=!1;return}for(;(l=a)!=null&&l.new;){var l;e.ccOffset+=i.start-a.start,i.new=!1,i=a,a=e[i.prevCC]}e.presentationOffset=n};function oP(s,e,t,n,i,a,l){const c=new iP,h=ls(new Uint8Array(s)).trim().replace(rP,`
`).split(`
`),f=[],g=e?RO(e.baseTime,e.timescale):0;let m="00:00.000",y=0,v=0,x,b=!0;c.oncue=function(A){const S=t[n];let k=t.ccOffset;const R=(y-g)/9e4;if(S!=null&&S.new&&(v!==void 0?k=t.ccOffset=S.start:lP(t,n,R)),R){if(!e){x=new Error("Missing initPTS for VTT MPEGTS");return}k=R-t.presentationOffset}const _=A.endTime-A.startTime,C=Is((A.startTime+k-v)*9e4,i*9e4)/9e4;A.startTime=Math.max(C,0),A.endTime=Math.max(C+_,0);const U=A.text.trim();A.text=decodeURIComponent(encodeURIComponent(U)),A.id||(A.id=Qy(A.startTime,A.endTime,U)),A.endTime>0&&f.push(A)},c.onparsingerror=function(A){x=A},c.onflush=function(){if(x){l(x);return}a(f)},h.forEach(A=>{if(b)if(Vm(A,"X-TIMESTAMP-MAP=")){b=!1,A.slice(16).split(",").forEach(S=>{Vm(S,"LOCAL:")?m=S.slice(6):Vm(S,"MPEGTS:")&&(y=parseInt(S.slice(7)))});try{v=aP(m)/1e3}catch(S){x=S}return}else A===""&&(b=!1);c.parse(A+`
`)}),c.flush()}const Km="stpp.ttml.im1t",FT=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,GT=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,cP={left:"start",center:"center",right:"end",start:"start",end:"end"};function Sb(s,e,t,n){const i=Ge(new Uint8Array(s),["mdat"]);if(i.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const a=i.map(c=>ls(c)),l=wO(e.baseTime,1,e.timescale);try{a.forEach(c=>t(uP(c,l)))}catch(c){n(c)}}function uP(s,e){const i=new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const a={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},l=Object.keys(a).reduce((m,y)=>(m[y]=i.getAttribute(`ttp:${y}`)||a[y],m),{}),c=i.getAttribute("xml:space")!=="preserve",h=Tb(Ym(i,"styling","style")),f=Tb(Ym(i,"layout","region")),g=Ym(i,"body","[begin]");return[].map.call(g,m=>{const y=$T(m,c);if(!y||!m.hasAttribute("begin"))return null;const v=Qm(m.getAttribute("begin"),l),x=Qm(m.getAttribute("dur"),l);let b=Qm(m.getAttribute("end"),l);if(v===null)throw wb(m);if(b===null){if(x===null)throw wb(m);b=v+x}const A=new jy(v-e,b-e,y);A.id=Qy(A.startTime,A.endTime,A.text);const S=f[m.getAttribute("region")],k=h[m.getAttribute("style")],R=hP(S,k,h),{textAlign:_}=R;if(_){const C=cP[_];C&&(A.lineAlign=C),A.align=_}return ht(A,R),A}).filter(m=>m!==null)}function Ym(s,e,t){const n=s.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function Tb(s){return s.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function $T(s,e){return[].slice.call(s.childNodes).reduce((t,n,i)=>{var a;return n.nodeName==="br"&&i?t+`
`:(a=n.childNodes)!=null&&a.length?$T(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function hP(s,e,t){const n="http://www.w3.org/ns/ttml#styling";let i=null;const a=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],l=s!=null&&s.hasAttribute("style")?s.getAttribute("style"):null;return l&&t.hasOwnProperty(l)&&(i=t[l]),a.reduce((c,h)=>{const f=jm(e,n,h)||jm(s,n,h)||jm(i,n,h);return f&&(c[h]=f),c},{})}function jm(s,e,t){return s&&s.hasAttributeNS(e,t)?s.getAttributeNS(e,t):null}function wb(s){return new Error(`Could not parse ttml timestamp ${s}`)}function Qm(s,e){if(!s)return null;let t=NT(s);return t===null&&(FT.test(s)?t=fP(s,e):GT.test(s)&&(t=dP(s,e))),t}function fP(s,e){const t=FT.exec(s),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function dP(s,e){const t=GT.exec(s),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class O0{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class gP{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Lb(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(T.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(T.FRAG_LOADING,this.onFragLoading,this),e.on(T.FRAG_LOADED,this.onFragLoaded,this),e.on(T.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(T.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(T.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(T.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(T.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(T.FRAG_LOADING,this.onFragLoading,this),e.off(T.FRAG_LOADED,this.onFragLoaded,this),e.off(T.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(T.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(T.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(T.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new O0(this,"textTrack1"),t=new O0(this,"textTrack2"),n=new O0(this,"textTrack3"),i=new O0(this,"textTrack4");this.cea608Parser1=new Ab(1,e,t),this.cea608Parser2=new Ab(3,n,i)}addCues(e,t,n,i,a){let l=!1;for(let c=a.length;c--;){const h=a[c],f=mP(h[0],h[1],t,n);if(f>=0&&(h[0]=Math.min(h[0],t),h[1]=Math.max(h[1],n),l=!0,f/(n-t)>.5))return}if(l||a.push([t,n]),this.config.renderTextTracksNatively){const c=this.captionsTracks[e];this.Cues.newCue(c,t,n,i)}else{const c=this.Cues.newCue(null,t,n,i);this.hls.trigger(T.CUES_PARSED,{type:"captions",cues:c,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:a}){const{unparsedVttFrags:l}=this;n===Te.MAIN&&(this.initPTS[t.cc]={baseTime:i,timescale:a}),l.length&&(this.unparsedVttFrags=[],l.forEach(c=>{this.onFragLoaded(T.FRAG_LOADED,c)}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const a=n.textTracks[i];if(Rb(a,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return a}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:a,languageCode:l}=t[e],c=this.getExistingTrack(a,l);if(c)n[e]=c,zo(n[e]),CT(n[e],i);else{const h=this.createTextTrack("captions",a,l);h&&(h[e]=!0,n[e]=h)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,i={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(T.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,n){const i=this.media;if(i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const n=!!t.transferMedia;if(this.media=null,n)return;const{captionsTracks:i}=this;Object.keys(i).forEach(a=>{zo(i[a]),delete i[a]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Lb(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)zo(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some(a=>a.textCodec===Km);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(TT(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const l=this.media,c=l?td(l.textTracks):null;if(this.tracks.forEach((h,f)=>{let g;if(c){let m=null;for(let y=0;y<c.length;y++)if(c[y]&&Rb(c[y],h)){m=c[y],c[y]=null;break}m&&(g=m)}if(g)zo(g);else{const m=HT(h);g=this.createTextTrack(m,h.name,h.lang),g&&(g.mode="disabled")}g&&this.textTracks.push(g)}),c!=null&&c.length){const h=c.filter(f=>f!==null).map(f=>f.label);h.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${h.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const l=this.tracks.map(c=>({label:c.name,kind:c.type.toLowerCase(),default:c.default,subtitleTrack:c}));this.hls.trigger(T.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:l})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const i=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!i)return;const a=`textTrack${i[1]}`,l=this.captionsProperties[a];l&&(l.label=n.name,n.lang&&(l.languageCode=n.lang),l.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Te.MAIN){var n,i;const{cea608Parser1:a,cea608Parser2:l,lastSn:c}=this,{cc:h,sn:f}=t.frag,g=(n=(i=t.part)==null?void 0:i.index)!=null?n:-1;a&&l&&(f!==c+1||f===c&&g!==this.lastPartIndex+1||h!==this.lastCc)&&(a.reset(),l.reset()),this.lastCc=h,this.lastSn=f,this.lastPartIndex=g}}onFragLoaded(e,t){const{frag:n,payload:i}=t;if(n.type===Te.SUBTITLE)if(i.byteLength){const a=n.decryptdata,l="stats"in t;if(a==null||!a.encrypted||l){const c=this.tracks[n.level],h=this.vttCCs;h[n.cc]||(h[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),c&&c.textCodec===Km?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;Sb(t,this.initPTS[e.cc],i=>{this._appendCues(i,e.level),n.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},i=>{n.logger.log(`Failed to parse IMSC1: ${i}`),n.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:i})})}_parseVTTs(e){var t;const{frag:n,payload:i}=e,{initPTS:a,unparsedVttFrags:l}=this,c=a.length-1;if(!a[n.cc]&&c===-1){l.push(e);return}const h=this.hls,f=(t=n.initSegment)!=null&&t.data?Cs(n.initSegment.data,new Uint8Array(i)).buffer:i;oP(f,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,g=>{this._appendCues(g,n.level),h.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},g=>{const m=g.message==="Missing initPTS for VTT MPEGTS";m?l.push(e):this._fallbackToIMSC1(n,i),h.logger.log(`Failed to parse VTT cue: ${g}`),!(m&&c>n.cc)&&h.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:g})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||Sb(t,this.initPTS[e.cc],()=>{n.textCodec=Km,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[t];if(!i||i.mode==="disabled")return;e.forEach(a=>_T(i,a))}else{const i=this.tracks[t];if(!i)return;const a=i.default?"default":"subtitles"+t;n.trigger(T.CUES_PARSED,{type:"subtitles",cues:e,track:a})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===Te.SUBTITLE&&this.onFragLoaded(T.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:n,samples:i}=t;if(!(n.type===Te.MAIN&&this.closedCaptionsForLevel(n)==="NONE"))for(let a=0;a<i.length;a++){const l=i[a].bytes;if(l){this.cea608Parser1||this.initCea608Parsers();const c=this.extractCea608Data(l);this.cea608Parser1.addData(i[a].pts,c[0]),this.cea608Parser2.addData(i[a].pts,c[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:a}){const{media:l}=this;if(!(!l||l.currentTime<n)){if(!a||a==="video"){const{captionsTracks:c}=this;Object.keys(c).forEach(h=>_p(c[h],t,n))}if(this.config.renderTextTracksNatively&&t===0&&i!==void 0){const{textTracks:c}=this;Object.keys(c).forEach(h=>_p(c[h],t,i))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let i=2;for(let a=0;a<n;a++){const l=e[i++],c=127&e[i++],h=127&e[i++];if(c===0&&h===0)continue;if((4&l)!==0){const g=3&l;(g===0||g===1)&&(t[g].push(c),t[g].push(h))}}return t}}function HT(s){return s.characteristics&&/transcribes-spoken-dialog/gi.test(s.characteristics)&&/describes-music-and-sound/gi.test(s.characteristics)?"captions":"subtitles"}function Rb(s,e){return!!s&&s.kind===HT(e)&&Ip(e,s)}function mP(s,e,t,n){return Math.min(e,n)-Math.max(s,t)}function Lb(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const pP=/\s/,yP={newCue(s,e,t,n){const i=[];let a,l,c,h,f;const g=self.VTTCue||self.TextTrackCue;for(let y=0;y<n.rows.length;y++)if(a=n.rows[y],c=!0,h=0,f="",!a.isEmpty()){var m;for(let b=0;b<a.chars.length;b++)pP.test(a.chars[b].uchar)&&c?h++:(f+=a.chars[b].uchar,c=!1);a.cueStartTime=e,e===t&&(t+=1e-4),h>=16?h--:h++;const v=UT(f.trim()),x=Qy(e,t,v);s!=null&&(m=s.cues)!=null&&m.getCueById(x)||(l=new g(e,t,v),l.id=x,l.line=y+1,l.align="left",l.position=10+Math.min(80,Math.floor(h*8/32)*10),i.push(l))}return s&&i.length&&(i.sort((y,v)=>y.line==="auto"||v.line==="auto"?0:y.line>8&&v.line>8?v.line-y.line:y.line-v.line),i.forEach(y=>_T(s,y))),i}};function vP(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const xP=/(\d+)-(\d+)\/(\d+)/;class kb{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||SP,this.controller=new self.AbortController,this.stats=new ky}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const a=EP(e,this.controller.signal),l=e.responseType==="arraybuffer",c=l?"byteLength":"length",{maxTimeToFirstByteMs:h,maxLoadTimeMs:f}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,a),self.clearTimeout(this.requestTimeout),t.timeout=h&&Ee(h)?h:f,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,e,this.response))},t.timeout),(Lh(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(m=>{var y;this.response=this.loader=m;const v=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=f,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,e,this.response))},f-(v-i.loading.start)),!m.ok){const{status:b,statusText:A}=m;throw new TP(A||"fetch, bad network response",b,m)}i.loading.first=v,i.total=AP(m.headers)||i.total;const x=(y=this.callbacks)==null?void 0:y.onProgress;return x&&Ee(t.highWaterMark)?this.loadProgressively(m,i,e,t.highWaterMark,x):l?m.arrayBuffer():e.responseType==="json"?m.json():m.text()}).then(m=>{var y,v;const x=this.response;if(!x)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const b=m[c];b&&(i.loaded=i.total=b);const A={url:x.url,data:m,code:x.status},S=(y=this.callbacks)==null?void 0:y.onProgress;S&&!Ee(t.highWaterMark)&&S(i,e,m,x),(v=this.callbacks)==null||v.onSuccess(A,i,e,x)}).catch(m=>{var y;if(self.clearTimeout(this.requestTimeout),i.aborted)return;const v=m&&m.code||0,x=m?m.message:null;(y=this.callbacks)==null||y.onError({code:v,text:x},e,m?m.details:null,i)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,a){const l=new sT,c=e.body.getReader(),h=()=>c.read().then(f=>{if(f.done)return l.dataLength&&a(t,n,l.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const g=f.value,m=g.length;return t.loaded+=m,m<i||l.dataLength?(l.push(g),l.dataLength>=i&&a(t,n,l.flush().buffer,e)):a(t,n,g.buffer,e),h()}).catch(()=>Promise.reject());return h()}}function EP(s,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(ht({},s.headers))};return s.rangeEnd&&t.headers.set("Range","bytes="+s.rangeStart+"-"+String(s.rangeEnd-1)),t}function bP(s){const e=xP.exec(s);if(e)return parseInt(e[2])-parseInt(e[1])+1}function AP(s){const e=s.get("Content-Range");if(e){const n=bP(e);if(Ee(n))return n}const t=s.get("Content-Length");if(t)return parseInt(t)}function SP(s,e){return new self.Request(s.url,e)}class TP extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const wP=/^age:\s*[\d.]+\s*$/im;class zT{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new ky,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const a=this.xhrSetup;a?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return a(n,t.url)}).catch(l=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),a(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(l=>{var c;(c=this.callbacks)==null||c.onError({code:n.status,text:l.message},t,n,i)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const i=t.headers,{maxTimeToFirstByteMs:a,maxLoadTimeMs:l}=n.loadPolicy;if(i)for(const c in i)e.setRequestHeader(c,i[c]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=a&&Ee(a)?a:l,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,a=this.config;if(!n.aborted&&i>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),i===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const f=t.status,g=t.responseType==="text"?t.responseText:null;if(f>=200&&f<300){const x=g??t.response;if(x!=null){var l,c;n.loading.end=Math.max(self.performance.now(),n.loading.first);const b=t.responseType==="arraybuffer"?x.byteLength:x.length;n.loaded=n.total=b,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first);const A=(l=this.callbacks)==null?void 0:l.onProgress;A&&A(n,e,x,t);const S={url:t.responseURL,data:x,code:f};(c=this.callbacks)==null||c.onSuccess(S,n,e,t);return}}const m=a.loadPolicy.errorRetry,y=n.retry,v={url:e.url,data:void 0,code:f};if(Ed(m,y,!1,v))this.retry(m);else{var h;Je.error(`${f} while loading ${e.url}`),(h=this.callbacks)==null||h.onError({code:f,text:t.statusText},e,t,n)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(Ed(e,t,!0))this.retry(e);else{var n;Je.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const i=this.callbacks;i&&(this.abortInternal(),i.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Cy(e,n.retry),n.retry++,Je.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&wP.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const RP={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},LP=lt(lt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:zT,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:qC,bufferController:$O,capLevelController:Ky,errorController:t_,fpsController:CM,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:YS,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,certLoadPolicy:{default:RP},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},kP()),{},{subtitleStreamController:HM,subtitleTrackController:MM,timelineController:gP,audioStreamController:BO,audioTrackController:UO,emeController:Wo,cmcdController:kM,contentSteeringController:DM,interstitialsController:$M});function kP(){return{cueHandler:yP,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function IP(s,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=Pp(s),i=["manifest","level","frag"],a=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return i.forEach(l=>{const c=`${l==="level"?"playlist":l}LoadPolicy`,h=e[c]===void 0,f=[];a.forEach(g=>{const m=`${l}Loading${g}`,y=e[m];if(y!==void 0&&h){f.push(m);const v=n[c].default;switch(e[c]={default:v},g){case"TimeOut":v.maxLoadTimeMs=y,v.maxTimeToFirstByteMs=y;break;case"MaxRetry":v.errorRetry.maxNumRetry=y,v.timeoutRetry.maxNumRetry=y;break;case"RetryDelay":v.errorRetry.retryDelayMs=y,v.timeoutRetry.retryDelayMs=y;break;case"MaxRetryTimeout":v.errorRetry.maxRetryDelayMs=y,v.timeoutRetry.maxRetryDelayMs=y;break}}}),f.length&&t.warn(`hls.js config: "${f.join('", "')}" setting(s) are deprecated, use "${c}": ${St(e[c])}`)}),lt(lt({},n),e)}function Pp(s){return s&&typeof s=="object"?Array.isArray(s)?s.map(Pp):Object.keys(s).reduce((e,t)=>(e[t]=Pp(s[t]),e),{}):s}function DP(s,e){const t=s.loader;t!==kb&&t!==zT?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),s.progressive=!1):vP()&&(s.loader=kb,s.progressive=!0,s.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const nd=2,CP=.1,_P=.05,OP=100;class MP extends zS{constructor(e,t){super("gap-controller",e.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var n;(n=this.media)!=null&&n.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var n;this.ended=((n=this.media)==null?void 0:n.currentTime)||1,this.hls.trigger(T.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(OP),this.mediaSource=t.mediaSource;const n=this.media=t.media;vr(n,"playing",this.onMediaPlaying),vr(n,"waiting",this.onMediaWaiting),vr(n,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:n}=this;n&&(Ri(n,"playing",this.onMediaPlaying),Ri(n,"waiting",this.onMediaWaiting),Ri(n,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var n,i;const a=(n=this.hls)==null?void 0:n.config;if(!a)return;const{media:l,stalled:c}=this;if(!l)return;const{seeking:h}=l,f=this.seeking&&!h,g=!this.seeking&&h,m=l.paused&&!h||l.ended||l.playbackRate===0;if(this.seeking=h,e!==t){t&&(this.ended=0),this.moved=!0,h||(this.nudgeRetry=0,a.nudgeOnVideoHole&&!m&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(g||f){f&&this.stallResolved(e);return}if(m){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&l.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(T.MEDIA_ENDED,{stalled:!1}));return}if(!ze.getBuffered(l).length){this.nudgeRetry=0;return}const y=ze.bufferInfo(l,e,0),v=y.nextStart||0,x=this.fragmentTracker;if(h&&x&&this.hls){const U=Ib(this.hls.inFlightFragments,e),O=y.len>nd,B=!v||U||v-e>nd&&!x.getPartialFragment(e);if(O||B)return;this.moved=!1}const b=(i=this.hls)==null?void 0:i.latestLevelDetails;if(!this.moved&&this.stalled!==null&&x){if(!(y.len>0)&&!v)return;const O=Math.max(v,y.start||0)-e,F=!!(b!=null&&b.live)?b.targetduration*2:nd,M=x.getPartialFragment(e);if(O>0&&(O<=F||M)){l.paused||this._trySkipBufferHole(M);return}}const A=a.detectStallWithCurrentTimeMs,S=self.performance.now(),k=this.waiting;if(c===null){k>0&&S-k<A?this.stalled=k:this.stalled=S;return}const R=S-c;if(!h&&(R>=A||k)&&this.hls){var _;if(((_=this.mediaSource)==null?void 0:_.readyState)==="ended"&&!(b!=null&&b.live)&&Math.abs(e-((b==null?void 0:b.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(T.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(y),!this.media||!this.hls)return}const C=ze.bufferInfo(l,e,a.maxBufferHole);this._tryFixBufferStall(C,R)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const n=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(n)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(T.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var n;const i=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(n=this.buffered.audio)!=null&&n.length&&i&&i.length>1&&e>i.end(0)){const a=ze.bufferedInfo(ze.timeRangesToArray(this.buffered.audio),e,0);if(a.len>1&&t>=a.start){const l=ze.timeRangesToArray(i),c=ze.bufferedInfo(l,t,0).bufferedIndex;if(c>-1&&c<l.length-1){const h=ze.bufferedInfo(l,e,0).bufferedIndex,f=l[c].end,g=l[c+1].start;if((h===-1||h>c)&&g-f<1&&e-f<2){const m=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${f} -> ${g} buffered index: ${h}`);this.warn(m.message),this.media.currentTime+=1e-6;const y=this.fragmentTracker.getPartialFragment(e)||void 0,v=ze.bufferInfo(this.media,e,0);this.hls.trigger(T.ERROR,{type:Re.MEDIA_ERROR,details:Q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:m,reason:m.message,frag:y,buffer:v.len,bufferInfo:v})}}}}}_tryFixBufferStall(e,t){var n,i;const{fragmentTracker:a,media:l}=this,c=(n=this.hls)==null?void 0:n.config;if(!l||!a||!c)return;const h=l.currentTime,f=(i=this.hls)==null?void 0:i.latestLevelDetails,g=a.getPartialFragment(h);if((g||f!=null&&f.live&&h<f.fragmentStart)&&(this._trySkipBufferHole(g)||!this.media))return;const m=e.buffered;(m&&m.length>1&&e.len>c.maxBufferHole||e.nextStart&&e.nextStart-h<c.maxBufferHole)&&(t>c.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}_reportStall(e){const{hls:t,media:n,stallReported:i,stalled:a}=this;if(!i&&a!==null&&n&&t){this.stallReported=!0;const l=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${St(e)})`);this.warn(l.message),t.trigger(T.ERROR,{type:Re.MEDIA_ERROR,details:Q.BUFFER_STALLED_ERROR,fatal:!1,error:l,buffer:e.len,bufferInfo:e,stalled:{start:a}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:n,media:i}=this,a=(t=this.hls)==null?void 0:t.config;if(!i||!n||!a)return 0;const l=i.currentTime,c=ze.bufferInfo(i,l,0),h=l<c.start?c.start:c.nextStart;if(h&&this.hls){const g=c.len<=a.maxBufferHole,m=c.len>0&&c.len<1&&i.readyState<3,y=h-l;if(y>0&&(g||m)){if(y>a.maxBufferHole){let x=!1;if(l===0){const b=n.getAppendedFrag(0,Te.MAIN);b&&h<b.end&&(x=!0)}if(!x){const b=e||n.getAppendedFrag(l,Te.MAIN);if(b){var f;if(!((f=this.hls.loadLevelObj)!=null&&f.details)||Ib(this.hls.inFlightFragments,h))return 0;let S=!1,k=b.end;for(;k<h;){const R=n.getPartialFragment(k);if(R)k+=R.duration;else{S=!0;break}}if(S)return 0}}}const v=Math.max(h+_P,l+CP);if(this.warn(`skipping hole, adjusting currentTime from ${l} to ${v}`),this.moved=!0,i.currentTime=v,!(e!=null&&e.gap)){const x=new Error(`fragment loaded with buffer holes, seeking from ${l} to ${v}`);this.hls.trigger(T.ERROR,{type:Re.MEDIA_ERROR,details:Q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:x,reason:x.message,frag:e||void 0,buffer:c.len,bufferInfo:c})}return v}}return 0}_tryNudgeBuffer(e){const{hls:t,media:n,nudgeRetry:i}=this,a=t==null?void 0:t.config;if(!n||!a)return 0;const l=n.currentTime;if(this.nudgeRetry++,i<a.nudgeMaxRetry){const c=l+(i+1)*a.nudgeOffset,h=new Error(`Nudging 'currentTime' from ${l} to ${c}`);this.warn(h.message),n.currentTime=c,t.trigger(T.ERROR,{type:Re.MEDIA_ERROR,details:Q.BUFFER_NUDGE_ON_STALL,error:h,fatal:!1,buffer:e.len,bufferInfo:e})}else{const c=new Error(`Playhead still not moving while enough data buffered @${l} after ${a.nudgeMaxRetry} nudges`);this.error(c.message),t.trigger(T.ERROR,{type:Re.MEDIA_ERROR,details:Q.BUFFER_STALLED_ERROR,error:c,fatal:!0,buffer:e.len,bufferInfo:e})}}}function Ib(s,e){const t=Db(s.main);if(t&&t.start<=e)return t;const n=Db(s.audio);return n&&n.start<=e?n:null}function Db(s){if(!s)return null;switch(s.state){case oe.IDLE:case oe.STOPPED:case oe.ENDED:case oe.ERROR:return null}return s.frag}const PP=.25;function Np(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function Cb(s,e,t,n,i){let a=new s(e,t,"");try{a.value=n,i&&(a.type=i)}catch{a=new s(e,t,St(i?lt({type:i},n):n))}return a}const M0=(()=>{const s=Np();try{s&&new s(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function NP(s){return Uint8Array.from(s.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class BP{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(T.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(T.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(T.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(e,t){var n;this.media=t.media,((n=t.overrides)==null?void 0:n.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){const e=this.hls.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&zo(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return CT(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;const{samples:a}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=Np();if(l)for(let c=0;c<a.length;c++){const h=a[c].type;if(h===as.emsg&&!n||!i)continue;const f=hT(a[c].data);if(f){const g=a[c].pts;let m=g+a[c].duration;m>M0&&(m=M0),m-g<=0&&(m=g+PP);for(let v=0;v<f.length;v++){const x=f[v];if(!fT(x)){this.updateId3CueEnds(g,h);const b=Cb(l,g,m,x,h);b&&this.id3Track.addCue(b)}}}}}updateId3CueEnds(e,t){var n;const i=(n=this.id3Track)==null?void 0:n.cues;if(i)for(let a=i.length;a--;){const l=i[a];l.type===t&&l.startTime<e&&l.endTime===M0&&(l.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){const{id3Track:a,hls:l}=this;if(!l)return;const{config:{enableEmsgMetadataCues:c,enableID3MetadataCues:h}}=l;if(a&&(c||h)){let f;i==="audio"?f=g=>g.type===as.audioId3&&h:i==="video"?f=g=>g.type===as.emsg&&c:f=g=>g.type===as.audioId3&&h||g.type===as.emsg&&c,_p(a,t,n,f)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.media||!e.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{id3Track:n}=this,{dateRanges:i}=e,a=Object.keys(i);let l=this.dateRangeCuesAppended;if(n&&t){var c;if((c=n.cues)!=null&&c.length){const g=Object.keys(l).filter(m=>!a.includes(m));for(let m=g.length;m--;){const y=g[m],v=l[y].cues;delete l[y],Object.keys(v).forEach(x=>{try{const b=v[x];b.removeEventListener("enter",this.onEventCueEnter),n.removeCue(b)}catch{}})}}else l=this.dateRangeCuesAppended={}}const h=e.fragments[e.fragments.length-1];if(a.length===0||!Ee(h==null?void 0:h.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const f=Np();for(let g=0;g<a.length;g++){const m=a[g],y=i[m],v=y.startTime,x=l[m],b=(x==null?void 0:x.cues)||{};let A=(x==null?void 0:x.durationKnown)||!1,S=M0;const{duration:k,endDate:R}=y;if(R&&k!==null)S=v+k,A=!0;else if(y.endOnNext&&!A){const C=a.reduce((U,O)=>{if(O!==y.id){const B=i[O];if(B.class===y.class&&B.startDate>y.startDate&&(!U||y.startDate<U.startDate))return B}return U},null);C&&(S=C.startTime,A=!0)}const _=Object.keys(y.attr);for(let C=0;C<_.length;C++){const U=_[C];if(!g_(U))continue;const O=b[U];if(O)A&&!x.durationKnown?O.endTime=S:Math.abs(O.startTime-v)>.01&&(O.startTime=v,O.endTime=S);else if(f){let B=y.attr[U];m_(U)&&(B=NP(B));const M=Cb(f,v,S,{key:U,data:B},as.dateRange);M&&(M.id=m,this.id3Track.addCue(M),b[U]=M,this.hls.config.interstitialsController&&(U==="X-ASSET-LIST"||U==="X-ASSET-URL")&&M.addEventListener("enter",this.onEventCueEnter))}}l[m]={cues:b,dateRange:y,durationKnown:A}}}}class UP{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,n=this.levelDetails;if(!t||!n)return;this.currentTime=t.currentTime;const i=this.computeLatency();if(i===null)return;this._latency=i;const{lowLatencyMode:a,maxLiveSyncPlaybackRate:l}=this.config;if(!a||l===1||!n.live)return;const c=this.targetLatency;if(c===null)return;const h=i-c,f=Math.min(this.maxLatency,c+n.targetduration);if(h<f&&h>.05&&this.forwardBufferLength>1){const m=Math.min(2,Math.max(1,l)),y=Math.round(2/(1+Math.exp(-.75*h-this.edgeStalled))*20)/20,v=Math.min(m,Math.max(1,y));this.changeMediaPlaybackRate(t,v)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:a,liveSyncDurationCount:l,lowLatencyMode:c}=this.config,h=this.hls.userConfig;let f=c&&n||t;(this._targetLatencyUpdated||h.liveSyncDuration||h.liveSyncDurationCount||f===0)&&(f=a!==void 0?a:l*i);const g=i;return f+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,g)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const n=this.levelDetails;if(n===null)return null;const i=n.edge,a=e-t-this.edgeStalled,l=i-n.totalduration,c=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(l,a),c)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(T.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(T.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var n;t.details===Q.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(n=this.levelDetails)!=null&&n.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var n,i;e.playbackRate!==t&&((n=this.hls)==null||n.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(i=this.targetLatency)==null?void 0:i.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class FP extends Vy{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this),e.on(T.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this),e.off(T.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,i=[],a={},l={};let c=!1,h=!1,f=!1;t.levels.forEach(g=>{var m;const y=g.attrs;let{audioCodec:v,videoCodec:x}=g;v&&(g.audioCodec=v=pd(v,n)||void 0),((m=x)==null?void 0:m.indexOf("avc1"))===0&&(x=g.videoCodec=PC(x));const{width:b,height:A,unknownCodecs:S}=g;let k=S?S.length:0;if(S)for(let j=k;j--;){const ae=S[j];this.isAudioSupported(ae)?(g.audioCodec=v=v?`${v},${ae}`:ae,k--,zc.audio[v.substring(0,4)]=2):this.isVideoSupported(ae)&&(g.videoCodec=x=x?`${x},${ae}`:ae,k--,zc.video[x.substring(0,4)]=2)}if(c||(c=!!(b&&A)),h||(h=!!x),f||(f=!!v),k||v&&!this.isAudioSupported(v)||x&&!this.isVideoSupported(x)){this.log(`Some or all CODECS not supported "${y.CODECS}"`);return}const{CODECS:R,"FRAME-RATE":_,"HDCP-LEVEL":C,"PATHWAY-ID":U,RESOLUTION:O,"VIDEO-RANGE":B}=y,M=`${`${U||"."}-`}${g.bitrate}-${O}-${_}-${R}-${B}-${C}`;if(a[M])if(a[M].uri!==g.url&&!g.attrs["PATHWAY-ID"]){const j=l[M]+=1;g.attrs["PATHWAY-ID"]=new Array(j+1).join(".");const ae=this.createLevel(g);a[M]=ae,i.push(ae)}else a[M].addGroupId("audio",y.AUDIO),a[M].addGroupId("text",y.SUBTITLES);else{const j=this.createLevel(g);a[M]=j,l[M]=1,i.push(j)}}),this.filterAndSortMediaOptions(i,t,c,h,f)}createLevel(e){const t=new Ah(e),n=e.supplemental;if(n!=null&&n.videoCodec&&!this.isVideoSupported(n.videoCodec)){const i=new Error(`SUPPLEMENTAL-CODECS not supported "${n.videoCodec}"`);this.log(i.message),t.supportedResult=FS(i,[])}return t}isAudioSupported(e){return bp(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return bp(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,n,i,a){let l=[],c=[],h=e;if((n||i)&&a&&(h=h.filter(({videoCodec:A,videoRange:S,width:k,height:R})=>(!!A||!!(k&&R))&&GC(S))),h.length===0){Promise.resolve().then(()=>{if(this.hls){let A="no level with compatible codecs found in manifest",S=A;t.levels.length&&(S=`one or more CODECS in variant not supported: ${St(t.levels.map(R=>R.attrs.CODECS).filter((R,_,C)=>C.indexOf(R)===_))}`,this.warn(S),A+=` (${S})`);const k=new Error(A);this.hls.trigger(T.ERROR,{type:Re.MEDIA_ERROR,details:Q.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:k,reason:S})}});return}t.audioTracks&&(l=t.audioTracks.filter(A=>!A.audioCodec||this.isAudioSupported(A.audioCodec)),_b(l)),t.subtitles&&(c=t.subtitles,_b(c));const f=h.slice(0);h.sort((A,S)=>{if(A.attrs["HDCP-LEVEL"]!==S.attrs["HDCP-LEVEL"])return(A.attrs["HDCP-LEVEL"]||"")>(S.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&A.height!==S.height)return A.height-S.height;if(A.frameRate!==S.frameRate)return A.frameRate-S.frameRate;if(A.videoRange!==S.videoRange)return yd.indexOf(A.videoRange)-yd.indexOf(S.videoRange);if(A.videoCodec!==S.videoCodec){const k=wE(A.videoCodec),R=wE(S.videoCodec);if(k!==R)return R-k}if(A.uri===S.uri&&A.codecSet!==S.codecSet){const k=md(A.codecSet),R=md(S.codecSet);if(k!==R)return R-k}return A.averageBitrate!==S.averageBitrate?A.averageBitrate-S.averageBitrate:0});let g=f[0];if(this.steering&&(h=this.steering.filterParsedLevels(h),h.length!==f.length)){for(let A=0;A<f.length;A++)if(f[A].pathwayId===h[0].pathwayId){g=f[A];break}}this._levels=h;for(let A=0;A<h.length;A++)if(h[A]===g){var m;this._firstLevel=A;const S=g.bitrate,k=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${h.length} level(s) found, first bitrate: ${S}`),((m=this.hls.userConfig)==null?void 0:m.abrEwmaDefaultEstimate)===void 0){const R=Math.min(S,this.hls.config.abrEwmaDefaultEstimateMax);R>k&&k===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=R)}break}const y=a&&!i,v=this.hls.config,x=!!(v.audioStreamController&&v.audioTrackController),b={levels:h,audioTracks:l,subtitleTracks:c,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:i,altAudio:x&&!y&&l.some(A=>!!A.url)};this.hls.trigger(T.MANIFEST_PARSED,b)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const g=new Error("invalid level idx"),m=e<0;if(this.hls.trigger(T.ERROR,{type:Re.OTHER_ERROR,details:Q.LEVEL_SWITCH_ERROR,level:e,fatal:m,error:g,reason:g.message}),m)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,a=i?i.attrs["PATHWAY-ID"]:void 0,l=t[e],c=l.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=l,n===e&&i&&a===c)return;this.log(`Switching to level ${e} (${l.height?l.height+"p ":""}${l.videoRange?l.videoRange+" ":""}${l.codecSet?l.codecSet+" ":""}@${l.bitrate})${c?" with Pathway "+c:""} from level ${n}${a?" with Pathway "+a:""}`);const h={level:e,attrs:l.attrs,details:l.details,bitrate:l.bitrate,averageBitrate:l.averageBitrate,maxBitrate:l.maxBitrate,realBitrate:l.realBitrate,width:l.width,height:l.height,codecSet:l.codecSet,audioCodec:l.audioCodec,videoCodec:l.videoCodec,audioGroups:l.audioGroups,subtitleGroups:l.subtitleGroups,loaded:l.loaded,loadError:l.loadError,fragmentError:l.fragmentError,name:l.name,id:l.id,uri:l.uri,url:l.url,urlId:0,audioGroupIds:l.audioGroupIds,textGroupIds:l.textGroupIds};this.hls.trigger(T.LEVEL_SWITCHING,h);const f=l.details;if(!f||f.live){const g=this.switchParams(l.uri,i==null?void 0:i.details,f);this.loadPlaylist(g)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),n=e.filter(i=>t.indexOf(i)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=n}}onError(e,t){t.fatal||!t.context||t.context.type===qe.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===Te.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(a=>!!n[a]))return;const i=this._levels[t.level];i!=null&&i.loadError&&(this.log(`Resetting level error count of ${i.loadError} on frag buffered`),i.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:a}=t,l=t.levelInfo;if(!l){var c;this.warn(`Invalid level index ${i}`),(c=t.deliveryDirectives)!=null&&c.skip&&(a.deltaUpdateFailed=!0);return}if(l===this.currentLevel||t.withoutMultiVariant){l.fragmentError===0&&(l.loadError=0);let h=l.details;h===t.details&&h.advanced&&(h=void 0),this.playlistLoaded(i,t,h)}else(n=t.deliveryDirectives)!=null&&n.skip&&(a.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=this.getUrlWithDirectives(e.uri,t),i=this.currentLevelIndex,a=e.attrs["PATHWAY-ID"],l=e.details,c=l==null?void 0:l.age;this.log(`Loading level index ${i}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${a?" Pathway "+a:""}${c&&l.live?" age "+c.toFixed(1)+(l.type&&" "+l.type||""):""} ${n}`),this.hls.trigger(T.LEVEL_LOADING,{url:n,level:i,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const n=this._levels.filter((a,l)=>l!==e?!0:(this.steering&&this.steering.removeLevel(a),a===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,a.details&&a.details.fragments.forEach(c=>c.level=-1)),!1));eT(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const i=n.length-1;this._firstLevel=Math.min(this._firstLevel,i),this._startLevel&&(this._startLevel=Math.min(this._startLevel,i)),this.hls.trigger(T.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(T.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function _b(s){const e={};s.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}function VT(){return self.SourceBuffer||self.WebKitSourceBuffer}function KT(){if(!Ra())return!1;const e=VT();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function GP(){if(!KT())return!1;const s=Ra();return typeof(s==null?void 0:s.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>s.isTypeSupported(bh(e,"video")))||["mp4a.40.2","fLaC"].some(e=>s.isTypeSupported(bh(e,"audio"))))}function $P(){var s;const e=VT();return typeof(e==null||(s=e.prototype)==null?void 0:s.changeType)=="function"}const HP=100;class zP extends Ny{constructor(e,t,n){super(e,t,n,"stream-controller",Te.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const i=this.media,a=i?i.currentTime:null;if(a===null||!Ee(a)||(this.log(`Media seeked to ${a.toFixed(3)}`),!this.getBufferedFrag(a)))return;const l=this.getFwdBufferInfoAtPos(i,a,Te.MAIN,0);if(l===null||l.len===0){this.warn(`Main forward buffer length at ${a} on "seeked" event ${l?l.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.LEVEL_LOADING,this.onLevelLoading,this),e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(T.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(T.BUFFER_CREATED,this.onBufferCreated,this),e.on(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(T.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(T.BUFFER_CREATED,this.onBufferCreated,this),e.off(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:n,hls:i}=this;if(this.stopLoad(),this.setInterval(HP),this.level=-1,!this.startFragRequested){let a=i.startLevel;a===-1&&(i.config.testBandwidth&&this.levels.length>1?(a=0,this.bitrateTest=!0):a=i.firstAutoLevel),i.nextLoadLevel=a,this.level=i.loadLevel,this._hasEnoughToStart=!!t}n>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n),this.state=oe.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=oe.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case oe.WAITING_LEVEL:{const{levels:t,level:n}=this,i=t==null?void 0:t[n],a=i==null?void 0:i.details;if(a&&(!a.live||this.levelLastLoaded===i&&!this.waitForLive(i))){if(this.waitForCdnTuneIn(a))break;this.state=oe.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=oe.IDLE;break}break}case oe.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||(e=this.media)!=null&&e.seeking){const{levels:i,level:a}=this,l=i==null?void 0:i[a];this.resetStartWhenNotLoaded(l||null),this.state=oe.IDLE}}break}this.state===oe.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this;if(t===null||!i&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const a=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(n!=null&&n[a]))return;const l=n[a],c=this.getMainFwdBufferInfo();if(c===null)return;const h=this.getLevelDetails();if(h&&this._streamEnded(c,h)){const b={};this.altAudio===2&&(b.type="video"),this.hls.trigger(T.BUFFER_EOS,b),this.state=oe.ENDED;return}if(!this.buffering)return;e.loadLevel!==a&&e.manualLevel===-1&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=e.nextLoadLevel=a;const f=l.details;if(!f||this.state===oe.WAITING_LEVEL||this.waitForLive(l)){this.level=a,this.state=oe.WAITING_LEVEL,this.startFragRequested=!1;return}const g=c.len,m=this.getMaxBufferLength(l.maxBitrate);if(g>=m)return;this.backtrackFragment&&this.backtrackFragment.start>c.end&&(this.backtrackFragment=null);const y=this.backtrackFragment?this.backtrackFragment.start:c.end;let v=this.getNextFragment(y,f);if(this.couldBacktrack&&!this.fragPrevious&&v&&ln(v)&&this.fragmentTracker.getState(v)!==Xt.OK){var x;const A=((x=this.backtrackFragment)!=null?x:v).sn-f.startSN,S=f.fragments[A-1];S&&v.cc===S.cc&&(v=S,this.fragmentTracker.removeFragment(S))}else this.backtrackFragment&&c.len&&(this.backtrackFragment=null);if(v&&this.isLoopLoading(v,y)){if(!v.gap){const A=this.audioOnly&&!this.altAudio?ut.AUDIO:ut.VIDEO,S=(A===ut.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;S&&this.afterBufferFlushed(S,A,Te.MAIN)}v=this.getNextFragmentLoopLoading(v,f,c,Te.MAIN,m)}v&&(v.initSegment&&!v.initSegment.data&&!this.bitrateTest&&(v=v.initSegment),this.loadFragment(v,l,y))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);i===Xt.NOT_LOADED||i===Xt.PARTIAL?ln(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,n):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Te.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const a=this.getLevelDetails();if(a!=null&&a.live){const c=this.getMainFwdBufferInfo();if(!c||c.len<a.targetduration*2)return}if(!t.paused&&e){const c=this.hls.nextLoadLevel,h=e[c],f=this.fragLastKbps;f&&this.fragCurrent?n=this.fragCurrent.duration*h.maxBitrate/(1e3*f)+1:n=0}else n=0;const l=this.getBufferedFrag(t.currentTime+n);if(l){const c=this.followingBufferedFrag(l);if(c){this.abortCurrentFrag();const h=c.maxStartPTS?c.maxStartPTS:c.start,f=c.duration,g=Math.max(l.end,h+Math.min(Math.max(f-this.config.maxFragLookUpTolerance,f*(this.couldBacktrack?.5:.125)),f*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(g,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case oe.KEY_LOADING:case oe.FRAG_LOADING:case oe.FRAG_LOADING_WAITING_RETRY:case oe.PARSING:case oe.PARSED:this.state=oe.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;vr(n,"playing",this.onMediaPlaying),vr(n,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:n}=this;n&&(Ri(n,"playing",this.onMediaPlaying),Ri(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(T.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let n=!1,i=!1;t.levels.forEach(a=>{const l=a.audioCodec;l&&(n=n||l.indexOf("mp4a.40.2")!==-1,i=i||l.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=n&&i&&!$P(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==oe.IDLE)return;const i=t.levelInfo;(!i.details||i.details.live&&(this.levelLastLoaded!==i||i.details.expired)||this.waitForCdnTuneIn(i.details))&&(this.state=oe.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:i,startFragRequested:a}=this,l=t.level,c=t.details,h=c.totalduration;if(!i){this.warn(`Levels were reset while loading level ${l}`);return}this.log(`Level ${l} loaded [${c.startSN},${c.endSN}]${c.lastPartSn?`[part-${c.lastPartSn}-${c.lastPartIndex}]`:""}, cc [${c.startCC}, ${c.endCC}] duration:${h}`);const f=t.levelInfo,g=this.fragCurrent;g&&(this.state===oe.FRAG_LOADING||this.state===oe.FRAG_LOADING_WAITING_RETRY)&&g.level!==t.level&&g.loader&&this.abortCurrentFrag();let m=0;if(c.live||(n=f.details)!=null&&n.live){var y;if(this.checkLiveUpdate(c),c.deltaUpdateFailed)return;m=this.alignPlaylists(c,f.details,(y=this.levelLastLoaded)==null?void 0:y.details)}if(f.details=c,this.levelLastLoaded=f,a||this.setStartPosition(c,m),this.hls.trigger(T.LEVEL_UPDATED,{details:c,level:l}),this.state===oe.WAITING_LEVEL){if(this.waitForCdnTuneIn(c))return;this.state=oe.IDLE}a&&c.live&&this.synchronizeToLiveEdge(c),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,a=this.getLoadPosition(),l=e.fragmentStart,c=e.edge,h=a>=l-t.maxFragLookUpTolerance&&a<=c;if(i!==null&&n.duration>i&&(a<i||!h)){const f=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!h&&n.readyState<4||a<c-f)&&(this._hasEnoughToStart||(this.nextLoadPosition=i),n.readyState&&(this.warn(`Playback: ${a.toFixed(3)} is located too far from the end of live sliding playlist: ${c}, reset currentTime to : ${i.toFixed(3)}`),n.currentTime=i))}}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:i,payload:a}=e,{levels:l}=this;if(!l){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const c=l[n.level];if(!c){this.warn(`Level ${n.level} not found on progress`);return}const h=c.details;if(!h){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const f=c.videoCodec,g=h.PTSKnown||!h.live,m=(t=n.initSegment)==null?void 0:t.data,y=this._getAudioCodec(c),v=this.transmuxer=this.transmuxer||new ST(this.hls,Te.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),x=i?i.index:-1,b=x!==-1,A=new Oy(n.level,n.sn,n.stats.chunkCount,a.byteLength,x,b),S=this.initPTS[n.cc];v.push(a,m,y,f,n,i,h.totalduration,g,A,S)}onAudioTrackSwitching(e,t){const n=this.hls,i=this.altAudio===2;if(vd(t.url,n))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const l=this.fragCurrent;l&&(this.log("Switching to main audio track, cancel main fragment load"),l.abortRequests(),this.fragmentTracker.removeFragment(l)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(i){this.fragmentTracker.removeAllFragments(),n.once(T.BUFFER_FLUSHED,()=>{var l;(l=this.hls)==null||l.trigger(T.AUDIO_TRACK_SWITCHED,t)}),n.trigger(T.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}n.trigger(T.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=vd(t.url,this.hls);if(n){const i=this.videoBuffer;i&&this.mediaBuffer!==i&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=n?2:0,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,a,l=!1;for(const c in n){const h=n[c];if(h.id==="main"){if(a=c,i=h,c==="video"){const f=n[c];f&&(this.videoBuffer=f.buffer)}}else l=!0}l&&i?(this.log(`Alternate track found, use ${a}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t,a=n.type===Te.MAIN;if(a){if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===oe.PARSED&&(this.state=oe.IDLE);return}const c=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*c.total/(c.buffering.end-c.loading.first)),ln(n)&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}const l=this.media;l&&(!this._hasEnoughToStart&&ze.getBuffered(l).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),a&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var n;if(t.fatal){this.state=oe.ERROR;return}switch(t.details){case Q.FRAG_GAP:case Q.FRAG_PARSING_ERROR:case Q.FRAG_DECRYPT_ERROR:case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Te.MAIN,t);break;case Q.LEVEL_LOAD_ERROR:case Q.LEVEL_LOAD_TIMEOUT:case Q.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===oe.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===qe.LEVEL&&(this.state=oe.IDLE);break;case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.resetLoadingState();break;case Q.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case Q.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=oe.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==ut.AUDIO||!this.altAudio){const n=(t===ut.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;n&&(this.afterBufferFlushed(n,t,Te.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const i=this.timelineOffset;i&&n&&(n+=i);const a=this.getLevelDetails(),l=ze.getBuffered(e),c=l.length?l.start(0):0,h=c-n,f=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);h>0&&(h<f||this.loadingParts&&h<2*((a==null?void 0:a.partTarget)||0))&&(this.log(`adjusting start position by ${h} to match buffer start`),n+=h,this.startPosition=n),t<n&&(this.log(`seek to target start position ${n} from current time ${t} buffer start ${c}`),e.currentTime=n)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:i}=this,a=n==null?void 0:n.frag;if(!a||this.fragContextChanged(a))return;t.fragmentError=0,this.state=oe.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const l=a.stats;l.parsing.start=l.parsing.end=l.buffering.start=l.buffering.end=self.performance.now(),i.trigger(T.FRAG_LOADED,n),a.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n=this.playlistType,{hls:i}=this,{remuxResult:a,chunkMeta:l}=e,c=this.getCurrentContext(l);if(!c){this.resetWhenMissingContext(l);return}const{frag:h,part:f,level:g}=c,{video:m,text:y,id3:v,initSegment:x}=a,{details:b}=g,A=this.altAudio?void 0:a.audio;if(this.fragContextChanged(h)){this.fragmentTracker.removeFragment(h);return}if(this.state=oe.PARSING,x){if(x!=null&&x.tracks){const R=h.initSegment||h;this._bufferInitSegment(g,x.tracks,R,l),i.trigger(T.FRAG_PARSING_INIT_SEGMENT,{frag:R,id:n,tracks:x.tracks})}const S=x.initPTS,k=x.timescale;Ee(S)&&(this.initPTS[h.cc]={baseTime:S,timescale:k},i.trigger(T.INIT_PTS_FOUND,{frag:h,id:n,initPTS:S,timescale:k}))}if(m&&b){A&&m.type==="audiovideo"&&this.logMuxedErr(h);const S=b.fragments[h.sn-1-b.startSN],k=h.sn===b.startSN,R=!S||h.cc>S.cc;if(a.independent!==!1){const{startPTS:_,endPTS:C,startDTS:U,endDTS:O}=m;if(f)f.elementaryStreams[m.type]={startPTS:_,endPTS:C,startDTS:U,endDTS:O};else if(m.firstKeyFrame&&m.independent&&l.id===1&&!R&&(this.couldBacktrack=!0),m.dropped&&m.independent){const B=this.getMainFwdBufferInfo(),F=(B?B.end:this.getLoadPosition())+this.config.maxBufferHole,M=m.firstKeyFramePTS?m.firstKeyFramePTS:_;if(!k&&F<M-this.config.maxBufferHole&&!R){this.backtrack(h);return}else R&&(h.gap=!0);h.setElementaryStreamInfo(m.type,h.start,C,h.start,O,!0)}else k&&_-(b.appliedTimelineOffset||0)>nd&&(h.gap=!0);h.setElementaryStreamInfo(m.type,_,C,U,O),this.backtrackFragment&&(this.backtrackFragment=h),this.bufferFragmentData(m,h,f,l,k||R)}else if(k||R)h.gap=!0;else{this.backtrack(h);return}}if(A){const{startPTS:S,endPTS:k,startDTS:R,endDTS:_}=A;f&&(f.elementaryStreams[ut.AUDIO]={startPTS:S,endPTS:k,startDTS:R,endDTS:_}),h.setElementaryStreamInfo(ut.AUDIO,S,k,R,_),this.bufferFragmentData(A,h,f,l)}if(b&&v!=null&&(t=v.samples)!=null&&t.length){const S={id:n,frag:h,details:b,samples:v.samples};i.trigger(T.FRAG_PARSING_METADATA,S)}if(b&&y){const S={id:n,frag:h,details:b,samples:y.samples};i.trigger(T.FRAG_PARSING_USERDATA,S)}}logMuxedErr(e){this.warn(`${ln(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,n,i){if(this.state!==oe.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(n));const{audio:a,video:l,audiovideo:c}=t;if(a){let f=X0(a.codec,e.audioCodec);f==="mp4a"&&(f="mp4a.40.5");const g=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){f&&(f.indexOf("mp4a.40.5")!==-1?f="mp4a.40.2":f="mp4a.40.5");const m=a.metadata;m&&"channelCount"in m&&(m.channelCount||1)!==1&&g.indexOf("firefox")===-1&&(f="mp4a.40.5")}f&&f.indexOf("mp4a.40.5")!==-1&&g.indexOf("android")!==-1&&a.container!=="audio/mpeg"&&(f="mp4a.40.2",this.log(`Android: force audio codec to ${f}`)),e.audioCodec&&e.audioCodec!==f&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${f}"`),a.levelCodec=f,a.id=Te.MAIN,this.log(`Init audio buffer, container:${a.container}, codecs[selected/level/parsed]=[${f||""}/${e.audioCodec||""}/${a.codec}]`),delete t.audiovideo}if(l){l.levelCodec=e.videoCodec,l.id=Te.MAIN;const f=l.codec;if((f==null?void 0:f.length)===4)switch(f){case"hvc1":case"hev1":l.codec="hvc1.1.6.L120.90";break;case"av01":l.codec="av01.0.04M.08";break;case"avc1":l.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${l.container}, codecs[level/parsed]=[${e.videoCodec||""}/${f}]${l.codec!==f?" parsed-corrected="+l.codec:""}${l.supplemental?" supplemental="+l.supplemental:""}`),delete t.audiovideo}c&&(this.log(`Init audiovideo buffer, container:${c.container}, codecs[level/parsed]=[${e.codecs}/${c.codec}]`),delete t.video,delete t.audio);const h=Object.keys(t);if(h.length){if(this.hls.trigger(T.BUFFER_CODECS,t),!this.hls)return;h.forEach(f=>{const m=t[f].initSegment;m!=null&&m.byteLength&&this.hls.trigger(T.BUFFER_APPENDING,{type:f,data:m,frag:n,part:null,chunkMeta:i,parent:n.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,Te.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,n=e==null?void 0:e[t];return n?this.getMaxBufferLength(n.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=oe.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(ze.isBuffered(e,n)?t=this.getAppendedFrag(n):ze.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const i=this.fragPlaying,a=t.level;(!i||t.sn!==i.sn||i.level!==a)&&(this.fragPlaying=t,this.hls.trigger(T.FRAG_CHANGED,{frag:t}),(!i||i.level!==a)&&this.hls.trigger(T.LEVEL_SWITCHED,{level:a}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return Ee(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(Ee(t)){const n=this.getLevelDetails(),i=this.currentFrag||(n?Bl(null,n.fragments,t):null);if(i){const a=i.programDateTime;if(a!==null){const l=a+(t-i.start)*1e3;return new Date(l)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class VP{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[n].loader;if(i){var t;if(e&&e!==((t=i.context)==null?void 0:t.frag.type))return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=Q.KEY_LOAD_ERROR,n,i,a){return new Zi({type:Re.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:a,error:n,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:i}=e;for(let a=0;a<t.length;a++){const l=t[a];if(i<=l.cc&&(n==="initSegment"||l.sn==="initSegment"||n<l.sn)){this.emeController.selectKeySystemFormat(l).then(c=>{l.setKeyFormat(c)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const a=e.decryptdata;if(!a){const f=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,f))}const l=a.uri;if(!l)return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${l}"`)));let c=this.keyUriToKeyInfo[l];if((n=c)!=null&&n.decryptdata.key)return a.key=c.decryptdata.key,Promise.resolve({frag:e,keyInfo:c});if((i=c)!=null&&i.keyLoadPromise){var h;switch((h=c.mediaKeySessionContext)==null?void 0:h.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return c.keyLoadPromise.then(f=>(a.key=f.keyInfo.decryptdata.key,{frag:e,keyInfo:c}))}}switch(c=this.keyUriToKeyInfo[l]={decryptdata:a,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},a.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return a.keyFormat==="identity"?this.loadKeyHTTP(c,e):this.loadKeyEME(c,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(c,e);default:return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${a.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const i=this.emeController.loadKey(n);if(i)return(e.keyLoadPromise=i.then(a=>(e.mediaKeySessionContext=a,n))).catch(a=>{throw e.keyLoadPromise=null,a})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=n.loader,a=new i(n);return t.keyLoader=e.loader=a,e.keyLoadPromise=new Promise((l,c)=>{const h={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},f=n.keyLoadPolicy.default,g={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},m={onSuccess:(y,v,x,b)=>{const{frag:A,keyInfo:S,url:k}=x;if(!A.decryptdata||S!==this.keyUriToKeyInfo[k])return c(this.createKeyLoadError(A,Q.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),b));S.decryptdata.key=A.decryptdata.key=new Uint8Array(y.data),A.keyLoader=null,S.loader=null,l({frag:A,keyInfo:S})},onError:(y,v,x,b)=>{this.resetLoader(v),c(this.createKeyLoadError(t,Q.KEY_LOAD_ERROR,new Error(`HTTP Error ${y.code} loading key ${y.text}`),x,lt({url:h.url,data:void 0},y)))},onTimeout:(y,v,x)=>{this.resetLoader(v),c(this.createKeyLoadError(t,Q.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),x))},onAbort:(y,v,x)=>{this.resetLoader(v),c(this.createKeyLoadError(t,Q.INTERNAL_ABORTED,new Error("key loading aborted"),x))}};a.load(h,g,m)})}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,a=n.loader;t.keyLoader===a&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],a&&a.destroy()}}function Ob(s){const{type:e}=s;switch(e){case qe.AUDIO_TRACK:return Te.AUDIO;case qe.SUBTITLE_TRACK:return Te.SUBTITLE;default:return Te.MAIN}}function qm(s,e){let t=s.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class KP{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.LEVEL_LOADING,this.onLevelLoading,this),e.on(T.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(T.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(T.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.LEVEL_LOADING,this.onLevelLoading,this),e.off(T.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(T.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(T.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,a=n||i,l=new a(t);return this.loaders[e.type]=l,l}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:qe.MANIFEST,url:n,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:n,level:i,pathwayId:a,url:l,deliveryDirectives:c,levelInfo:h}=t;this.load({id:n,level:i,pathwayId:a,responseType:"text",type:qe.LEVEL,url:l,deliveryDirectives:c,levelOrTrack:h})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:a,deliveryDirectives:l,track:c}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:qe.AUDIO_TRACK,url:a,deliveryDirectives:l,levelOrTrack:c})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:a,deliveryDirectives:l,track:c}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:qe.SUBTITLE_TRACK,url:a,deliveryDirectives:l,levelOrTrack:c})}onLevelsUpdated(e,t){const n=this.loaders[qe.LEVEL];if(n){const i=n.context;i&&!t.levels.some(a=>a===i.levelOrTrack)&&(n.abort(),delete this.loaders[qe.LEVEL])}}load(e){var t;const n=this.hls.config;let i=this.getInternalLoader(e);if(i){const f=this.hls.logger,g=i.context;if(g&&g.levelOrTrack===e.levelOrTrack&&(g.url===e.url||g.deliveryDirectives&&!e.deliveryDirectives)){g.url===e.url?f.log(`[playlist-loader]: ignore ${e.url} ongoing request`):f.log(`[playlist-loader]: ignore ${e.url} in favor of ${g.url}`);return}f.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),i.abort()}let a;if(e.type===qe.MANIFEST?a=n.manifestLoadPolicy.default:a=ht({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),i=this.createInternalLoader(e),Ee((t=e.deliveryDirectives)==null?void 0:t.part)){let f;if(e.type===qe.LEVEL&&e.level!==null?f=this.hls.levels[e.level].details:e.type===qe.AUDIO_TRACK&&e.id!==null?f=this.hls.audioTracks[e.id].details:e.type===qe.SUBTITLE_TRACK&&e.id!==null&&(f=this.hls.subtitleTracks[e.id].details),f){const g=f.partTarget,m=f.targetduration;if(g&&m){const y=Math.max(g*3,m*.8)*1e3;a=ht({},a,{maxTimeToFirstByteMs:Math.min(y,a.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(y,a.maxTimeToFirstByteMs)})}}}const l=a.errorRetry||a.timeoutRetry||{},c={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},h={onSuccess:(f,g,m,y)=>{const v=this.getInternalLoader(m);this.resetInternalLoader(m.type);const x=f.data;if(x.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(f,m,new Error("no EXTM3U delimiter"),y||null,g);return}g.parsing.start=performance.now(),wi.isMediaPlaylist(x)||m.type!==qe.MANIFEST?this.handleTrackOrLevelPlaylist(f,g,m,y||null,v):this.handleMasterPlaylist(f,g,m,y)},onError:(f,g,m,y)=>{this.handleNetworkError(g,m,!1,f,y)},onTimeout:(f,g,m)=>{this.handleNetworkError(g,m,!0,void 0,f)}};i.load(e,c,h)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:n}=this.hls;(e||n)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,n,i){const a=this.hls,l=e.data,c=qm(e,n),h=wi.parseMasterPlaylist(l,c);if(h.playlistParsingError){this.handleManifestParsingError(e,n,h.playlistParsingError,i,t);return}const{contentSteering:f,levels:g,sessionData:m,sessionKeys:y,startTimeOffset:v,variableList:x}=h;this.variableList=x;const{AUDIO:b=[],SUBTITLES:A,"CLOSED-CAPTIONS":S}=wi.parseMasterPlaylistMedia(l,c,h);b.length&&!b.some(R=>!R.url)&&g[0].audioCodec&&!g[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),b.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new kt({}),bitrate:0,url:""})),a.trigger(T.MANIFEST_LOADED,{levels:g,audioTracks:b,subtitles:A,captions:S,contentSteering:f,url:c,stats:t,networkDetails:i,sessionData:m,sessionKeys:y,startTimeOffset:v,variableList:x})}handleTrackOrLevelPlaylist(e,t,n,i,a){const l=this.hls,{id:c,level:h,type:f}=n,g=qm(e,n),m=Ee(h)?h:Ee(c)?c:0,y=Ob(n),v=wi.parseLevelPlaylist(e.data,g,m,y,0,this.variableList);if(f===qe.MANIFEST){const x={attrs:new kt({}),bitrate:0,details:v,name:"",url:g};v.requestScheduled=t.loading.start+WS(v,0),l.trigger(T.MANIFEST_LOADED,{levels:[x],audioTracks:[],url:g,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=v,this.handlePlaylistLoaded(v,e,t,n,i,a)}handleManifestParsingError(e,t,n,i,a){this.hls.trigger(T.ERROR,{type:Re.NETWORK_ERROR,details:Q.MANIFEST_PARSING_ERROR,fatal:t.type===qe.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:a})}handleNetworkError(e,t,n=!1,i,a){let l=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===qe.LEVEL?l+=`: ${e.level} id: ${e.id}`:(e.type===qe.AUDIO_TRACK||e.type===qe.SUBTITLE_TRACK)&&(l+=` id: ${e.id} group-id: "${e.groupId}"`);const c=new Error(l);this.hls.logger.warn(`[playlist-loader]: ${l}`);let h=Q.UNKNOWN,f=!1;const g=this.getInternalLoader(e);switch(e.type){case qe.MANIFEST:h=n?Q.MANIFEST_LOAD_TIMEOUT:Q.MANIFEST_LOAD_ERROR,f=!0;break;case qe.LEVEL:h=n?Q.LEVEL_LOAD_TIMEOUT:Q.LEVEL_LOAD_ERROR,f=!1;break;case qe.AUDIO_TRACK:h=n?Q.AUDIO_TRACK_LOAD_TIMEOUT:Q.AUDIO_TRACK_LOAD_ERROR,f=!1;break;case qe.SUBTITLE_TRACK:h=n?Q.SUBTITLE_TRACK_LOAD_TIMEOUT:Q.SUBTITLE_LOAD_ERROR,f=!1;break}g&&this.resetInternalLoader(e.type);const m={type:Re.NETWORK_ERROR,details:h,fatal:f,url:e.url,loader:g,context:e,error:c,networkDetails:t,stats:a};if(i){const y=(t==null?void 0:t.url)||e.url;m.response=lt({url:y,data:void 0},i)}this.hls.trigger(T.ERROR,m)}handlePlaylistLoaded(e,t,n,i,a,l){const c=this.hls,{type:h,level:f,id:g,groupId:m,deliveryDirectives:y}=i,v=qm(t,i),x=Ob(i),b=typeof i.level=="number"&&x===Te.MAIN?f:void 0;if(!e.fragments.length){const S=e.playlistParsingError=new Error("No Segments found in Playlist");c.trigger(T.ERROR,{type:Re.NETWORK_ERROR,details:Q.LEVEL_EMPTY_ERROR,fatal:!1,url:v,error:S,reason:S.message,response:t,context:i,level:b,parent:x,networkDetails:a,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const A=e.playlistParsingError;if(A){if(this.hls.logger.warn(A),!c.config.ignorePlaylistParsingErrors){c.trigger(T.ERROR,{type:Re.NETWORK_ERROR,details:Q.LEVEL_PARSING_ERROR,fatal:!1,url:v,error:A,reason:A.message,response:t,context:i,level:b,parent:x,networkDetails:a,stats:n});return}e.playlistParsingError=null}switch(e.live&&l&&(l.getCacheAge&&(e.ageHeader=l.getCacheAge()||0),(!l.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),h){case qe.MANIFEST:case qe.LEVEL:c.trigger(T.LEVEL_LOADED,{details:e,levelInfo:i.levelOrTrack||c.levels[0],level:b||0,id:g||0,stats:n,networkDetails:a,deliveryDirectives:y,withoutMultiVariant:h===qe.MANIFEST});break;case qe.AUDIO_TRACK:c.trigger(T.AUDIO_TRACK_LOADED,{details:e,track:i.levelOrTrack,id:g||0,groupId:m||"",stats:n,networkDetails:a,deliveryDirectives:y});break;case qe.SUBTITLE_TRACK:c.trigger(T.SUBTITLE_TRACK_LOADED,{details:e,track:i.levelOrTrack,id:g||0,groupId:m||"",stats:n,networkDetails:a,deliveryDirectives:y});break}}}class pr{static get version(){return wh}static isMSESupported(){return KT()}static isSupported(){return GP()}static getMediaSource(){return Ra()}static get Events(){return T}static get MetadataSchema(){return as}static get ErrorTypes(){return Re}static get ErrorDetails(){return Q}static get DefaultConfig(){return pr.defaultConfig?pr.defaultConfig:LP}static set DefaultConfig(e){pr.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new By,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=uC(e.debug||!1,"Hls instance",e.assetPlayerId),n=this.config=IP(pr.DefaultConfig,e,t);this.userConfig=e,n.progressive&&DP(n,t);const{abrController:i,bufferController:a,capLevelController:l,errorController:c,fpsController:h}=n,f=new c(this),g=this.abrController=new i(this),m=new n_(this),y=n.interstitialsController,v=y?this.interstitialsController=new y(this,pr):null,x=this.bufferController=new a(this,m),b=this.capLevelController=new l(this),A=new h(this),S=new KP(this),k=n.contentSteeringController,R=k?new k(this):null,_=this.levelController=new FP(this,R),C=new BP(this),U=new VP(this.config),O=this.streamController=new zP(this,m,U),B=this.gapController=new MP(this,m);b.setStreamController(O),A.setStreamController(O);const F=[S,_,O];v&&F.splice(1,0,v),R&&F.splice(1,0,R),this.networkControllers=F;const M=[g,x,B,b,A,C,m];this.audioTrackController=this.createController(n.audioTrackController,F);const j=n.audioStreamController;j&&F.push(this.audioStreamController=new j(this,m,U)),this.subtitleTrackController=this.createController(n.subtitleTrackController,F);const ae=n.subtitleStreamController;ae&&F.push(this.subtititleStreamController=new ae(this,m,U)),this.createController(n.timelineController,M),U.emeController=this.emeController=this.createController(n.emeController,M),this.cmcdController=this.createController(n.cmcdController,M),this.latencyController=this.createController(UP,M),this.coreComponents=M,F.push(f);const ye=f.onErrorOut;typeof ye=="function"&&this.on(T.ERROR,ye,f),this.on(T.MANIFEST_LOADED,S.onManifestLoaded,S)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const i=e===T.ERROR;this.trigger(T.ERROR,{type:Re.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,fatal:i,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(T.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const a=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(T.ERROR,{type:Re.OTHER_ERROR,details:Q.ATTACH_MEDIA_ERROR,fatal:!0,error:a});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,n=t?e.media:e,i=t?e:{media:n};this._media=n,this.trigger(T.MEDIA_ATTACHING,i)}detachMedia(){this.logger.log("detachMedia"),this.trigger(T.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(T.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,n=this._url,i=this._url=Ly.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(T.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let n=0;n<this.networkControllers.length&&(this.networkControllers[n].startLoad(e,t),!(!this.started||!this.networkControllers));n++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[Te.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[Te.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[Te.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=eO()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){FC(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(t===-1&&e!=null&&e.length?i=e.length-1:i=t,n)for(let a=i;a--;){const l=e[a].attrs["HDCP-LEVEL"];if(l&&l<=n)return a}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const n=$S(t);return GS(e,n,navigator.mediaCapabilities)}}pr.defaultConfig=void 0;const YP=()=>{const s=J.useRef(null);return J.useEffect(()=>{const e=s.current,t="https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8";if(e)if(e.canPlayType("application/vnd.apple.mpegurl"))e.src=t;else if(pr.isSupported()){const n=new pr;n.loadSource(t),n.attachMedia(e)}else console.error("This browser does not support HLS.")},[]),me.jsxs("div",{className:"min-h-screen bg-black flex flex-col mt-[60px] items-center justify-center px-4 py-10 text-white",children:[me.jsx("h1",{className:"text-4xl font-bold mb-6 text-neon",children:"Live Stream Demo"}),me.jsxs("div",{className:"relative w-full max-w-3xl aspect-video bg-gray-900 rounded-3xl shadow-[0_8px_30px_rgba(0,255,255,0.3)] overflow-hidden border-[12px] border-gray-700",children:[me.jsx("div",{className:"absolute top-4 right-4 w-[20px] h-[20px] bg-gray-800 rounded-full border-2 border-gray-600 shadow-inner"}),me.jsx("div",{className:"absolute bottom-4 right-4 w-[20px] h-[20px] bg-gray-800 rounded-full border-2 border-gray-600 shadow-inner"}),me.jsx("div",{className:"absolute inset-4 rounded-2xl bg-black overflow-hidden neon-scan-bg",children:me.jsx("video",{ref:s,controls:!0,autoPlay:!0,muted:!0,className:"w-full h-full object-cover rounded-2xl"})})]})]})},jP="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpattern%20id='backbg'%20viewBox='0,0,2,2'%20x='6.5'%20y='6'%20width='16'%20height='16'%20patternUnits='userSpaceOnUse'%3e%3cpath%20d='M%200%200%20h%201%20l%20-1%201%20z%20m%200%202%20l%202%20-2%20v%201%20l%20-1%201%20z'%20style='fill:%20%2300f'%3e%3c/path%3e%3c/pattern%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3crect%20x='7'%20y='7'%20width='43'%20height='74'%20fill='url(%23backbg)'%3e%3c/rect%3e%3crect%20x='7'%20y='7'%20width='43'%20height='74'%20style='fill:%20none;%20stroke:%20%2300f;%20stroke-width:%202px'%3e%3c/rect%3e%3c/svg%3e",QP="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%2010%20h%20-2%20v%20-5%20h%20-4%20v%205%20h%20-2%20v%20-10%20z%20m%200%202%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(20.5,%2034)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",qP="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='10'%20height='12'%3e%3crect%20width='2'%20height='12'%3e%3c/rect%3e%3cpath%20d='M%206%200%20h%202%20l%202%202%20v%208%20l%20-2%202%20h%20-2%20l%20-2%20-2%20v%20-8%20z%20m%200%202%20v%208%20h%202%20v%20-8%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",XP="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%2010%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20h%202%20v%203%20h%204%20v%20-8%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%204%200%20h%201%20v%202%20l%202%20-2%20l%201%202%20v%203%20l%20-1%202%20l%20-2%20-2%20v%207%20h%20-1%20v%20-8%20h%20-2%20v%20-1%20h%202%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",WP="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%206%20l%20-1%201%20l%201%201%20v%202%20h%20-2%20v%20-2%20h%20-4%20l%20-2%20-2%20v%20-6%20z%20m%200%202%20v%206%20h%204%20v%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%200%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%2010%20h%20-8%20z'%3e%3c/path%3e%3crect%20x='1'%20y='11'%20width='8'%20height='1'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",ZP="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%202%20v%205%20l%204%20-5%20h%202%20l%20-4%205%20l%204%207%20h%20-2%20l%20-3%20-5%20h%20-1%20v%205%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%202%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%207%20h%20-8%20z'%3e%3c/path%3e%3cpath%20id='crown-dot'%20d='M%201%200%20l%201%201%20l%20-1%201%20l%20-1%20-1%20z'%3e%3c/path%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(4,%200)'%3e%3c/use%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(8,%200)'%3e%3c/use%3e%3crect%20x='1'%20y='10'%20width='8'%20height='2'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",JP="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20v%202%20h%206%20v%202%20h%20-8%20v%20-4%20l%202%20-2%20h%204%20v%20-4%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",eN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%208%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-2%20v%20-2%20h%202%20v%20-3%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",tN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%205%200%20h%202%20v%206%20h%201%20v%202%20h%20-1%20v%204%20h%20-2%20v%20-4%20h%20-5%20v%20-2%20z%20m%200%203%20l%20-3%203%20h%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",nN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%202%20h%20-6%20v%202%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-4%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",sN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%202%20h%20-2%20v%20-2%20h%20-4%20v%203%20h%204%20l%202%202%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-8%20z%20m%200%207%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",iN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%204%20l%20-3%203%20v%205%20h%20-2%20v%20-6%20l%203%20-3%20v%20-1%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",rN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%203%20l%20-1%201%20l%201%201%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20l%201%20-1%20l%20-1%20-1%20v%20-3%20z%20m%200%202%20v%202%20l%201%201%20h%202%20l%201%20-1%20v%20-2%20z%20m%200%206%20v%202%20h%204%20v%20-2%20l%20-1%20-1%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",aN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%206%2012%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-4%20l%20-2%20-2%20v%20-3%20l%202%20-2%20h%204%20l%202%202%20v%208%20z%20m%200%20-7%20v%20-3%20h%20-4%20v%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2039.5)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",lN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%2010%20h%20-2%20v%20-5%20h%20-4%20v%205%20h%20-2%20v%20-10%20z%20m%200%202%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(20.5,%2034)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",oN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='10'%20height='12'%3e%3crect%20width='2'%20height='12'%3e%3c/rect%3e%3cpath%20d='M%206%200%20h%202%20l%202%202%20v%208%20l%20-2%202%20h%20-2%20l%20-2%20-2%20v%20-8%20z%20m%200%202%20v%208%20h%202%20v%20-8%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",cN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%2010%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20h%202%20v%203%20h%204%20v%20-8%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%204%200%20h%201%20v%202%20l%202%20-2%20l%201%202%20v%203%20l%20-1%202%20l%20-2%20-2%20v%207%20h%20-1%20v%20-8%20h%20-2%20v%20-1%20h%202%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",uN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%206%20l%20-1%201%20l%201%201%20v%202%20h%20-2%20v%20-2%20h%20-4%20l%20-2%20-2%20v%20-6%20z%20m%200%202%20v%206%20h%204%20v%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%200%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%2010%20h%20-8%20z'%3e%3c/path%3e%3crect%20x='1'%20y='11'%20width='8'%20height='1'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",hN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%202%20v%205%20l%204%20-5%20h%202%20l%20-4%205%20l%204%207%20h%20-2%20l%20-3%20-5%20h%20-1%20v%205%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%202%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%207%20h%20-8%20z'%3e%3c/path%3e%3cpath%20id='crown-dot'%20d='M%201%200%20l%201%201%20l%20-1%201%20l%20-1%20-1%20z'%3e%3c/path%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(4,%200)'%3e%3c/use%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(8,%200)'%3e%3c/use%3e%3crect%20x='1'%20y='10'%20width='8'%20height='2'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",fN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20v%202%20h%206%20v%202%20h%20-8%20v%20-4%20l%202%20-2%20h%204%20v%20-4%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",dN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%208%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-2%20v%20-2%20h%202%20v%20-3%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",gN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%205%200%20h%202%20v%206%20h%201%20v%202%20h%20-1%20v%204%20h%20-2%20v%20-4%20h%20-5%20v%20-2%20z%20m%200%203%20l%20-3%203%20h%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",mN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%202%20h%20-6%20v%202%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-4%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",pN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%202%20h%20-2%20v%20-2%20h%20-4%20v%203%20h%204%20l%202%202%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-8%20z%20m%200%207%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",yN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%204%20l%20-3%203%20v%205%20h%20-2%20v%20-6%20l%203%20-3%20v%20-1%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",vN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%203%20l%20-1%201%20l%201%201%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20l%201%20-1%20l%20-1%20-1%20v%20-3%20z%20m%200%202%20v%202%20l%201%201%20h%202%20l%201%20-1%20v%20-2%20z%20m%200%206%20v%202%20h%204%20v%20-2%20l%20-1%20-1%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",xN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%206%2012%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-4%20l%20-2%20-2%20v%20-3%20l%202%20-2%20h%204%20l%202%202%20v%208%20z%20m%200%20-7%20v%20-3%20h%20-4%20v%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2039.5)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",EN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%2010%20h%20-2%20v%20-5%20h%20-4%20v%205%20h%20-2%20v%20-10%20z%20m%200%202%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(20.5,%2034)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",bN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='10'%20height='12'%3e%3crect%20width='2'%20height='12'%3e%3c/rect%3e%3cpath%20d='M%206%200%20h%202%20l%202%202%20v%208%20l%20-2%202%20h%20-2%20l%20-2%20-2%20v%20-8%20z%20m%200%202%20v%208%20h%202%20v%20-8%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",AN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%2010%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20h%202%20v%203%20h%204%20v%20-8%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%204%200%20h%201%20v%202%20l%202%20-2%20l%201%202%20v%203%20l%20-1%202%20l%20-2%20-2%20v%207%20h%20-1%20v%20-8%20h%20-2%20v%20-1%20h%202%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",SN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%206%20l%20-1%201%20l%201%201%20v%202%20h%20-2%20v%20-2%20h%20-4%20l%20-2%20-2%20v%20-6%20z%20m%200%202%20v%206%20h%204%20v%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%200%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%2010%20h%20-8%20z'%3e%3c/path%3e%3crect%20x='1'%20y='11'%20width='8'%20height='1'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",TN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%202%20v%205%20l%204%20-5%20h%202%20l%20-4%205%20l%204%207%20h%20-2%20l%20-3%20-5%20h%20-1%20v%205%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%202%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%207%20h%20-8%20z'%3e%3c/path%3e%3cpath%20id='crown-dot'%20d='M%201%200%20l%201%201%20l%20-1%201%20l%20-1%20-1%20z'%3e%3c/path%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(4,%200)'%3e%3c/use%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(8,%200)'%3e%3c/use%3e%3crect%20x='1'%20y='10'%20width='8'%20height='2'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",wN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20v%202%20h%206%20v%202%20h%20-8%20v%20-4%20l%202%20-2%20h%204%20v%20-4%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",RN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%208%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-2%20v%20-2%20h%202%20v%20-3%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",LN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%205%200%20h%202%20v%206%20h%201%20v%202%20h%20-1%20v%204%20h%20-2%20v%20-4%20h%20-5%20v%20-2%20z%20m%200%203%20l%20-3%203%20h%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",kN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%202%20h%20-6%20v%202%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-4%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",IN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%202%20h%20-2%20v%20-2%20h%20-4%20v%203%20h%204%20l%202%202%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-8%20z%20m%200%207%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",DN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%204%20l%20-3%203%20v%205%20h%20-2%20v%20-6%20l%203%20-3%20v%20-1%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",CN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%203%20l%20-1%201%20l%201%201%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20l%201%20-1%20l%20-1%20-1%20v%20-3%20z%20m%200%202%20v%202%20l%201%201%20h%202%20l%201%20-1%20v%20-2%20z%20m%200%206%20v%202%20h%204%20v%20-2%20l%20-1%20-1%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",_N="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%206%2012%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-4%20l%20-2%20-2%20v%20-3%20l%202%20-2%20h%204%20l%202%202%20v%208%20z%20m%200%20-7%20v%20-3%20h%20-4%20v%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2039.5)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",ON="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%2010%20h%20-2%20v%20-5%20h%20-4%20v%205%20h%20-2%20v%20-10%20z%20m%200%202%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(20.5,%2034)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",MN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='10'%20height='12'%3e%3crect%20width='2'%20height='12'%3e%3c/rect%3e%3cpath%20d='M%206%200%20h%202%20l%202%202%20v%208%20l%20-2%202%20h%20-2%20l%20-2%20-2%20v%20-8%20z%20m%200%202%20v%208%20h%202%20v%20-8%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",PN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%2010%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20h%202%20v%203%20h%204%20v%20-8%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%204%200%20h%201%20v%202%20l%202%20-2%20l%201%202%20v%203%20l%20-1%202%20l%20-2%20-2%20v%207%20h%20-1%20v%20-8%20h%20-2%20v%20-1%20h%202%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",NN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%206%20l%20-1%201%20l%201%201%20v%202%20h%20-2%20v%20-2%20h%20-4%20l%20-2%20-2%20v%20-6%20z%20m%200%202%20v%206%20h%204%20v%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%200%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%2010%20h%20-8%20z'%3e%3c/path%3e%3crect%20x='1'%20y='11'%20width='8'%20height='1'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",BN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%202%20v%205%20l%204%20-5%20h%202%20l%20-4%205%20l%204%207%20h%20-2%20l%20-3%20-5%20h%20-1%20v%205%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%202%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%207%20h%20-8%20z'%3e%3c/path%3e%3cpath%20id='crown-dot'%20d='M%201%200%20l%201%201%20l%20-1%201%20l%20-1%20-1%20z'%3e%3c/path%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(4,%200)'%3e%3c/use%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(8,%200)'%3e%3c/use%3e%3crect%20x='1'%20y='10'%20width='8'%20height='2'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",UN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20v%202%20h%206%20v%202%20h%20-8%20v%20-4%20l%202%20-2%20h%204%20v%20-4%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",FN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%208%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-2%20v%20-2%20h%202%20v%20-3%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",GN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%205%200%20h%202%20v%206%20h%201%20v%202%20h%20-1%20v%204%20h%20-2%20v%20-4%20h%20-5%20v%20-2%20z%20m%200%203%20l%20-3%203%20h%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",$N="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%202%20h%20-6%20v%202%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-4%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",HN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%202%20h%20-2%20v%20-2%20h%20-4%20v%203%20h%204%20l%202%202%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-8%20z%20m%200%207%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",zN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%204%20l%20-3%203%20v%205%20h%20-2%20v%20-6%20l%203%20-3%20v%20-1%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",VN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%203%20l%20-1%201%20l%201%201%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20l%201%20-1%20l%20-1%20-1%20v%20-3%20z%20m%200%202%20v%202%20l%201%201%20h%202%20l%201%20-1%20v%20-2%20z%20m%200%206%20v%202%20h%204%20v%20-2%20l%20-1%20-1%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",KN="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%206%2012%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-4%20l%20-2%20-2%20v%20-3%20l%202%20-2%20h%204%20l%202%202%20v%208%20z%20m%200%20-7%20v%20-3%20h%20-4%20v%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2039.5)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",YN=Object.assign({"../assets/cards/BACK.svg":jP,"../assets/cards/C_1.svg":QP,"../assets/cards/C_10.svg":qP,"../assets/cards/C_11.svg":XP,"../assets/cards/C_12.svg":WP,"../assets/cards/C_13.svg":ZP,"../assets/cards/C_2.svg":JP,"../assets/cards/C_3.svg":eN,"../assets/cards/C_4.svg":tN,"../assets/cards/C_5.svg":nN,"../assets/cards/C_6.svg":sN,"../assets/cards/C_7.svg":iN,"../assets/cards/C_8.svg":rN,"../assets/cards/C_9.svg":aN,"../assets/cards/D_1.svg":lN,"../assets/cards/D_10.svg":oN,"../assets/cards/D_11.svg":cN,"../assets/cards/D_12.svg":uN,"../assets/cards/D_13.svg":hN,"../assets/cards/D_2.svg":fN,"../assets/cards/D_3.svg":dN,"../assets/cards/D_4.svg":gN,"../assets/cards/D_5.svg":mN,"../assets/cards/D_6.svg":pN,"../assets/cards/D_7.svg":yN,"../assets/cards/D_8.svg":vN,"../assets/cards/D_9.svg":xN,"../assets/cards/H_1.svg":EN,"../assets/cards/H_10.svg":bN,"../assets/cards/H_11.svg":AN,"../assets/cards/H_12.svg":SN,"../assets/cards/H_13.svg":TN,"../assets/cards/H_2.svg":wN,"../assets/cards/H_3.svg":RN,"../assets/cards/H_4.svg":LN,"../assets/cards/H_5.svg":kN,"../assets/cards/H_6.svg":IN,"../assets/cards/H_7.svg":DN,"../assets/cards/H_8.svg":CN,"../assets/cards/H_9.svg":_N,"../assets/cards/S_1.svg":ON,"../assets/cards/S_10.svg":MN,"../assets/cards/S_11.svg":PN,"../assets/cards/S_12.svg":NN,"../assets/cards/S_13.svg":BN,"../assets/cards/S_2.svg":UN,"../assets/cards/S_3.svg":FN,"../assets/cards/S_4.svg":GN,"../assets/cards/S_5.svg":$N,"../assets/cards/S_6.svg":HN,"../assets/cards/S_7.svg":zN,"../assets/cards/S_8.svg":VN,"../assets/cards/S_9.svg":KN}),P0=s=>YN[`../assets/cards/${s}.svg`];function jN(){const s=Array.from({length:52},(e,t)=>t);for(let e=s.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[s[e],s[t]]=[s[t],s[e]]}return s}function N0(s){if(typeof s=="number")return s;if(typeof s=="string")if(s.includes("/")){const e=s.split("/").map(t=>parseInt(t.trim()));return Math.max(...e)}else return s.includes("Bust"),parseInt(s);return 0}const QN="6.13.5";function qN(s,e,t){const n=e.split("|").map(a=>a.trim());for(let a=0;a<n.length;a++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof s===e)return}const i=new Error(`invalid value for type ${e}`);throw i.code="INVALID_ARGUMENT",i.argument=`value.${t}`,i.value=s,i}async function Cn(s){const e=Object.keys(s);return(await Promise.all(e.map(n=>Promise.resolve(s[n])))).reduce((n,i,a)=>(n[e[a]]=i,n),{})}function Oe(s,e,t){for(let n in e){let i=e[n];const a=t?t[n]:null;a&&qN(i,a,n),Object.defineProperty(s,n,{enumerable:!0,value:i,writable:!1})}}function Vo(s){if(s==null)return"null";if(Array.isArray(s))return"[ "+s.map(Vo).join(", ")+" ]";if(s instanceof Uint8Array){const e="0123456789abcdef";let t="0x";for(let n=0;n<s.length;n++)t+=e[s[n]>>4],t+=e[s[n]&15];return t}if(typeof s=="object"&&typeof s.toJSON=="function")return Vo(s.toJSON());switch(typeof s){case"boolean":case"symbol":return s.toString();case"bigint":return BigInt(s).toString();case"number":return s.toString();case"string":return JSON.stringify(s);case"object":{const e=Object.keys(s);return e.sort(),"{ "+e.map(t=>`${Vo(t)}: ${Vo(s[t])}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function pn(s,e){return s&&s.code===e}function qy(s){return pn(s,"CALL_EXCEPTION")}function Pt(s,e,t){let n=s;{const a=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${Vo(t)}`);for(const l in t){if(l==="shortMessage")continue;const c=t[l];a.push(l+"="+Vo(c))}}a.push(`code=${e}`),a.push(`version=${QN}`),a.length&&(s+=" ("+a.join(", ")+")")}let i;switch(e){case"INVALID_ARGUMENT":i=new TypeError(s);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":i=new RangeError(s);break;default:i=new Error(s)}return Oe(i,{code:e}),t&&Object.assign(i,t),i.shortMessage==null&&Oe(i,{shortMessage:n}),i}function fe(s,e,t,n){if(!s)throw Pt(e,t,n)}function H(s,e,t,n){fe(s,e,"INVALID_ARGUMENT",{argument:t,value:n})}function YT(s,e,t){t==null&&(t=""),t&&(t=": "+t),fe(s>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:s,expectedCount:e}),fe(s<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:s,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((s,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"é".normalize("NFD")!=="é")throw new Error("broken");s.push(e)}catch{}return s},[]);function ef(s,e,t){if(t==null&&(t=""),s!==e){let n=t,i="new";t&&(n+=".",i+=" "+t),fe(!1,`private constructor; use ${n}from* methods`,"UNSUPPORTED_OPERATION",{operation:i})}}function jT(s,e,t){if(s instanceof Uint8Array)return t?new Uint8Array(s):s;if(typeof s=="string"&&s.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const n=new Uint8Array((s.length-2)/2);let i=2;for(let a=0;a<n.length;a++)n[a]=parseInt(s.substring(i,i+2),16),i+=2;return n}H(!1,"invalid BytesLike value",e||"value",s)}function nt(s,e){return jT(s,e,!1)}function _n(s,e){return jT(s,e,!0)}function Et(s,e){return!(typeof s!="string"||!s.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&s.length!==2+2*e||e===!0&&s.length%2!==0)}function Xy(s){return Et(s,!0)||s instanceof Uint8Array}const Mb="0123456789abcdef";function Ae(s){const e=nt(s);let t="0x";for(let n=0;n<e.length;n++){const i=e[n];t+=Mb[(i&240)>>4]+Mb[i&15]}return t}function Ht(s){return"0x"+s.map(e=>Ae(e).substring(2)).join("")}function Jo(s){return Et(s,!0)?(s.length-2)/2:nt(s).length}function Nt(s,e,t){const n=nt(s);return t!=null&&t>n.length&&fe(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:t}),Ae(n.slice(e??0,t??n.length))}function QT(s,e,t){const n=nt(s);fe(e>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:e,offset:e+1});const i=new Uint8Array(e);return i.fill(0),t?i.set(n,e-n.length):i.set(n,0),Ae(i)}function Ul(s,e){return QT(s,e,!0)}function XN(s,e){return QT(s,e,!1)}const Xd=BigInt(0),js=BigInt(1),Bp=9007199254740991;function wd(s,e){const t=Wd(s,"value"),n=BigInt(Ve(e,"width"));if(fe(t>>n===Xd,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:s}),t>>n-js){const i=(js<<n)-js;return-((~t&i)+js)}return t}function qT(s,e){let t=we(s,"value");const n=BigInt(Ve(e,"width")),i=js<<n-js;if(t<Xd){t=-t,fe(t<=i,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:s});const a=(js<<n)-js;return(~t&a)+js}else fe(t<i,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:s});return t}function ul(s,e){const t=Wd(s,"value"),n=BigInt(Ve(e,"bits"));return t&(js<<n)-js}function we(s,e){switch(typeof s){case"bigint":return s;case"number":return H(Number.isInteger(s),"underflow",e||"value",s),H(s>=-9007199254740991&&s<=Bp,"overflow",e||"value",s),BigInt(s);case"string":try{if(s==="")throw new Error("empty string");return s[0]==="-"&&s[1]!=="-"?-BigInt(s.substring(1)):BigInt(s)}catch(t){H(!1,`invalid BigNumberish string: ${t.message}`,e||"value",s)}}H(!1,"invalid BigNumberish value",e||"value",s)}function Wd(s,e){const t=we(s,e);return fe(t>=Xd,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:s}),t}const Pb="0123456789abcdef";function Zd(s){if(s instanceof Uint8Array){let e="0x0";for(const t of s)e+=Pb[t>>4],e+=Pb[t&15];return BigInt(e)}return we(s)}function Ve(s,e){switch(typeof s){case"bigint":return H(s>=-9007199254740991&&s<=Bp,"overflow",e||"value",s),Number(s);case"number":return H(Number.isInteger(s),"underflow",e||"value",s),H(s>=-9007199254740991&&s<=Bp,"overflow",e||"value",s),s;case"string":try{if(s==="")throw new Error("empty string");return Ve(BigInt(s),e)}catch(t){H(!1,`invalid numeric string: ${t.message}`,e||"value",s)}}H(!1,"invalid numeric value",e||"value",s)}function WN(s){return Ve(Zd(s))}function ka(s,e){let n=Wd(s,"value").toString(16);if(e==null)n.length%2&&(n="0"+n);else{const i=Ve(e,"width");for(fe(i*2>=n.length,`value exceeds width (${i} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:s});n.length<i*2;)n="0"+n}return"0x"+n}function On(s){const e=Wd(s,"value");if(e===Xd)return new Uint8Array([]);let t=e.toString(16);t.length%2&&(t="0"+t);const n=new Uint8Array(t.length/2);for(let i=0;i<n.length;i++){const a=i*2;n[i]=parseInt(t.substring(a,a+2),16)}return n}function Ko(s){let e=Ae(Xy(s)?s:On(s)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const Nb="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const Bb=BigInt(58);function ZN(s){const e=nt(s);let t=Zd(e),n="";for(;t;)n=Nb[Number(t%Bb)]+n,t/=Bb;for(let i=0;i<e.length&&!e[i];i++)n=Nb[0]+n;return n}function JN(s){s=atob(s);const e=new Uint8Array(s.length);for(let t=0;t<s.length;t++)e[t]=s.charCodeAt(t);return nt(e)}function e8(s){const e=nt(s);let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}var ic;class XT{constructor(e,t,n){X(this,"filter");X(this,"emitter");ne(this,ic);P(this,ic,t),Oe(this,{emitter:e,filter:n})}async removeListener(){L(this,ic)!=null&&await this.emitter.off(this.filter,L(this,ic))}}ic=new WeakMap;function t8(s,e,t,n,i){H(!1,`invalid codepoint at offset ${e}; ${s}`,"bytes",t)}function WT(s,e,t,n,i){if(s==="BAD_PREFIX"||s==="UNEXPECTED_CONTINUE"){let a=0;for(let l=e+1;l<t.length&&t[l]>>6===2;l++)a++;return a}return s==="OVERRUN"?t.length-e-1:0}function n8(s,e,t,n,i){return s==="OVERLONG"?(H(typeof i=="number","invalid bad code point for replacement","badCodepoint",i),n.push(i),0):(n.push(65533),WT(s,e,t))}const s8=Object.freeze({error:t8,ignore:WT,replace:n8});function i8(s,e){e==null&&(e=s8.error);const t=nt(s,"bytes"),n=[];let i=0;for(;i<t.length;){const a=t[i++];if(a>>7===0){n.push(a);continue}let l=null,c=null;if((a&224)===192)l=1,c=127;else if((a&240)===224)l=2,c=2047;else if((a&248)===240)l=3,c=65535;else{(a&192)===128?i+=e("UNEXPECTED_CONTINUE",i-1,t,n):i+=e("BAD_PREFIX",i-1,t,n);continue}if(i-1+l>=t.length){i+=e("OVERRUN",i-1,t,n);continue}let h=a&(1<<8-l-1)-1;for(let f=0;f<l;f++){let g=t[i];if((g&192)!=128){i+=e("MISSING_CONTINUE",i,t,n),h=null;break}h=h<<6|g&63,i++}if(h!==null){if(h>1114111){i+=e("OUT_OF_RANGE",i-1-l,t,n,h);continue}if(h>=55296&&h<=57343){i+=e("UTF16_SURROGATE",i-1-l,t,n,h);continue}if(h<=c){i+=e("OVERLONG",i-1-l,t,n,h);continue}n.push(h)}}return n}function br(s,e){H(typeof s=="string","invalid string value","str",s);let t=[];for(let n=0;n<s.length;n++){const i=s.charCodeAt(n);if(i<128)t.push(i);else if(i<2048)t.push(i>>6|192),t.push(i&63|128);else if((i&64512)==55296){n++;const a=s.charCodeAt(n);H(n<s.length&&(a&64512)===56320,"invalid surrogate pair","str",s);const l=65536+((i&1023)<<10)+(a&1023);t.push(l>>18|240),t.push(l>>12&63|128),t.push(l>>6&63|128),t.push(l&63|128)}else t.push(i>>12|224),t.push(i>>6&63|128),t.push(i&63|128)}return new Uint8Array(t)}function r8(s){return s.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function Rd(s,e){return r8(i8(s,e))}function ZT(s){async function e(t,n){fe(n==null||!n.cancelled,"request cancelled before sending","CANCELLED");const i=t.url.split(":")[0].toLowerCase();fe(i==="http"||i==="https",`unsupported protocol ${i}`,"UNSUPPORTED_OPERATION",{info:{protocol:i},operation:"request"}),fe(i==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let a=null;const l=new AbortController,c=setTimeout(()=>{a=Pt("request timeout","TIMEOUT"),l.abort()},t.timeout);n&&n.addListener(()=>{a=Pt("request cancelled","CANCELLED"),l.abort()});const h={method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:l.signal};let f;try{f=await fetch(t.url,h)}catch(v){throw clearTimeout(c),a||v}clearTimeout(c);const g={};f.headers.forEach((v,x)=>{g[x.toLowerCase()]=v});const m=await f.arrayBuffer(),y=m==null?null:new Uint8Array(m);return{statusCode:f.status,statusMessage:f.statusText,headers:g,body:y}}return e}const a8=12,l8=250;let Ub=ZT();const o8=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),c8=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let Xm=!1;async function JT(s,e){try{const t=s.match(o8);if(!t)throw new Error("invalid data");return new Ta(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?JN(t[3]):h8(t[3]))}catch{return new Ta(599,"BAD REQUEST (invalid data: URI)",{},null,new Ia(s))}}function ew(s){async function e(t,n){try{const i=t.match(c8);if(!i)throw new Error("invalid link");return new Ia(`${s}${i[2]}`)}catch{return new Ta(599,"BAD REQUEST (invalid IPFS URI)",{},null,new Ia(t))}}return e}const B0={data:JT,ipfs:ew("https://gateway.ipfs.io/ipfs/")},tw=new WeakMap;var gl,la;class u8{constructor(e){ne(this,gl);ne(this,la);P(this,gl,[]),P(this,la,!1),tw.set(e,()=>{if(!L(this,la)){P(this,la,!0);for(const t of L(this,gl))setTimeout(()=>{t()},0);P(this,gl,[])}})}addListener(e){fe(!L(this,la),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),L(this,gl).push(e)}get cancelled(){return L(this,la)}checkSignal(){fe(!this.cancelled,"cancelled","CANCELLED",{})}}gl=new WeakMap,la=new WeakMap;function U0(s){if(s==null)throw new Error("missing signal; should not happen");return s.checkSignal(),s}var rc,ac,Hs,ir,lc,oc,rn,ns,rr,ml,pl,yl,fi,zs,oa,vl,uh;const Fd=class Fd{constructor(e){ne(this,vl);ne(this,rc);ne(this,ac);ne(this,Hs);ne(this,ir);ne(this,lc);ne(this,oc);ne(this,rn);ne(this,ns);ne(this,rr);ne(this,ml);ne(this,pl);ne(this,yl);ne(this,fi);ne(this,zs);ne(this,oa);P(this,oc,String(e)),P(this,rc,!1),P(this,ac,!0),P(this,Hs,{}),P(this,ir,""),P(this,lc,3e5),P(this,zs,{slotInterval:l8,maxAttempts:a8}),P(this,oa,null)}get url(){return L(this,oc)}set url(e){P(this,oc,String(e))}get body(){return L(this,rn)==null?null:new Uint8Array(L(this,rn))}set body(e){if(e==null)P(this,rn,void 0),P(this,ns,void 0);else if(typeof e=="string")P(this,rn,br(e)),P(this,ns,"text/plain");else if(e instanceof Uint8Array)P(this,rn,e),P(this,ns,"application/octet-stream");else if(typeof e=="object")P(this,rn,br(JSON.stringify(e))),P(this,ns,"application/json");else throw new Error("invalid body")}hasBody(){return L(this,rn)!=null}get method(){return L(this,ir)?L(this,ir):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),P(this,ir,String(e).toUpperCase())}get headers(){const e=Object.assign({},L(this,Hs));return L(this,rr)&&(e.authorization=`Basic ${e8(br(L(this,rr)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&L(this,ns)&&(e["content-type"]=L(this,ns)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){L(this,Hs)[String(e).toLowerCase()]=String(t)}clearHeaders(){P(this,Hs,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const i=t[n++];return{value:[i,e[i]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return L(this,rr)||null}setCredentials(e,t){H(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),P(this,rr,`${e}:${t}`)}get allowGzip(){return L(this,ac)}set allowGzip(e){P(this,ac,!!e)}get allowInsecureAuthentication(){return!!L(this,rc)}set allowInsecureAuthentication(e){P(this,rc,!!e)}get timeout(){return L(this,lc)}set timeout(e){H(e>=0,"timeout must be non-zero","timeout",e),P(this,lc,e)}get preflightFunc(){return L(this,ml)||null}set preflightFunc(e){P(this,ml,e)}get processFunc(){return L(this,pl)||null}set processFunc(e){P(this,pl,e)}get retryFunc(){return L(this,yl)||null}set retryFunc(e){P(this,yl,e)}get getUrlFunc(){return L(this,oa)||Ub}set getUrlFunc(e){P(this,oa,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${L(this,rn)?Ae(L(this,rn)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(L(this,zs).slotInterval=e.slotInterval),e.maxAttempts!=null&&(L(this,zs).maxAttempts=e.maxAttempts)}send(){return fe(L(this,fi)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),P(this,fi,new u8(this)),ge(this,vl,uh).call(this,0,Fb()+this.timeout,0,this,new Ta(0,"",{},null,this))}cancel(){fe(L(this,fi)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=tw.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),n=e.split(":")[0].toLowerCase();fe(this.method==="GET"&&(t!=="https"||n!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const i=new Fd(e);return i.method="GET",i.allowGzip=this.allowGzip,i.timeout=this.timeout,P(i,Hs,Object.assign({},L(this,Hs))),L(this,rn)&&P(i,rn,new Uint8Array(L(this,rn))),P(i,ns,L(this,ns)),i}clone(){const e=new Fd(this.url);return P(e,ir,L(this,ir)),L(this,rn)&&P(e,rn,L(this,rn)),P(e,ns,L(this,ns)),P(e,Hs,Object.assign({},L(this,Hs))),P(e,rr,L(this,rr)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),P(e,ml,L(this,ml)),P(e,pl,L(this,pl)),P(e,yl,L(this,yl)),P(e,zs,Object.assign({},L(this,zs))),P(e,oa,L(this,oa)),e}static lockConfig(){Xm=!0}static getGateway(e){return B0[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(Xm)throw new Error("gateways locked");B0[e]=t}static registerGetUrl(e){if(Xm)throw new Error("gateways locked");Ub=e}static createGetUrlFunc(e){return ZT()}static createDataGateway(){return JT}static createIpfsGatewayFunc(e){return ew(e)}};rc=new WeakMap,ac=new WeakMap,Hs=new WeakMap,ir=new WeakMap,lc=new WeakMap,oc=new WeakMap,rn=new WeakMap,ns=new WeakMap,rr=new WeakMap,ml=new WeakMap,pl=new WeakMap,yl=new WeakMap,fi=new WeakMap,zs=new WeakMap,oa=new WeakMap,vl=new WeakSet,uh=async function(e,t,n,i,a){var g,m,y;if(e>=L(this,zs).maxAttempts)return a.makeServerError("exceeded maximum retry limit");fe(Fb()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:i}),n>0&&await f8(n);let l=this.clone();const c=(l.url.split(":")[0]||"").toLowerCase();if(c in B0){const v=await B0[c](l.url,U0(L(i,fi)));if(v instanceof Ta){let x=v;if(this.processFunc){U0(L(i,fi));try{x=await this.processFunc(l,x)}catch(b){(b.throttle==null||typeof b.stall!="number")&&x.makeServerError("error in post-processing function",b).assertOk()}}return x}l=v}this.preflightFunc&&(l=await this.preflightFunc(l));const h=await this.getUrlFunc(l,U0(L(i,fi)));let f=new Ta(h.statusCode,h.statusMessage,h.headers,h.body,i);if(f.statusCode===301||f.statusCode===302){try{const v=f.headers.location||"";return ge(g=l.redirect(v),vl,uh).call(g,e+1,t,0,i,f)}catch{}return f}else if(f.statusCode===429&&(this.retryFunc==null||await this.retryFunc(l,f,e))){const v=f.headers["retry-after"];let x=L(this,zs).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof v=="string"&&v.match(/^[1-9][0-9]*$/)&&(x=parseInt(v)),ge(m=l.clone(),vl,uh).call(m,e+1,t,x,i,f)}if(this.processFunc){U0(L(i,fi));try{f=await this.processFunc(l,f)}catch(v){(v.throttle==null||typeof v.stall!="number")&&f.makeServerError("error in post-processing function",v).assertOk();let x=L(this,zs).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return v.stall>=0&&(x=v.stall),ge(y=l.clone(),vl,uh).call(y,e+1,t,x,i,f)}}return f};let Ia=Fd;var Fh,Gh,$h,ss,cc,xl;const E3=class E3{constructor(e,t,n,i,a){ne(this,Fh);ne(this,Gh);ne(this,$h);ne(this,ss);ne(this,cc);ne(this,xl);P(this,Fh,e),P(this,Gh,t),P(this,$h,Object.keys(n).reduce((l,c)=>(l[c.toLowerCase()]=String(n[c]),l),{})),P(this,ss,i==null?null:new Uint8Array(i)),P(this,cc,a||null),P(this,xl,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${L(this,ss)?Ae(L(this,ss)):"null"}>`}get statusCode(){return L(this,Fh)}get statusMessage(){return L(this,Gh)}get headers(){return Object.assign({},L(this,$h))}get body(){return L(this,ss)==null?null:new Uint8Array(L(this,ss))}get bodyText(){try{return L(this,ss)==null?"":Rd(L(this,ss))}catch{fe(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{fe(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const i=t[n++];return{value:[i,e[i]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let n;e?n=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,n=`CLIENT ESCALATED SERVER ERROR (${e})`);const i=new E3(599,n,this.headers,this.body,L(this,cc)||void 0);return P(i,xl,{message:e,error:t}),i}throwThrottleError(e,t){t==null?t=-1:H(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const n=new Error(e||"throttling requests");throw Oe(n,{stall:t,throttle:!0}),n}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return L(this,ss)!=null}get request(){return L(this,cc)}ok(){return L(this,xl).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=L(this,xl);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let i=null;try{L(this,ss)&&(i=Rd(L(this,ss)))}catch{}fe(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:n,responseBody:i,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};Fh=new WeakMap,Gh=new WeakMap,$h=new WeakMap,ss=new WeakMap,cc=new WeakMap,xl=new WeakMap;let Ta=E3;function Fb(){return new Date().getTime()}function h8(s){return br(s.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function f8(s){return new Promise(e=>setTimeout(e,s))}const d8=BigInt(-1),Us=BigInt(0),Yo=BigInt(1),g8=BigInt(5),Po={};let ec="0000";for(;ec.length<80;)ec+=ec;function nl(s){let e=ec;for(;e.length<s;)e+=e;return BigInt("1"+e.substring(0,s))}function sh(s,e,t){const n=BigInt(e.width);if(e.signed){const i=Yo<<n-Yo;fe(t==null||s>=-i&&s<i,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:s}),s>Us?s=wd(ul(s,n),n):s=-wd(ul(-s,n),n)}else{const i=Yo<<n;fe(t==null||s>=0&&s<i,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:s}),s=(s%i+i)%i&i-Yo}return s}function Wm(s){typeof s=="number"&&(s=`fixed128x${s}`);let e=!0,t=128,n=18;if(typeof s=="string"){if(s!=="fixed")if(s==="ufixed")e=!1;else{const a=s.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);H(a,"invalid fixed format","format",s),e=a[1]!=="u",t=parseInt(a[2]),n=parseInt(a[3])}}else if(s){const a=s,l=(c,h,f)=>a[c]==null?f:(H(typeof a[c]===h,"invalid fixed format ("+c+" not "+h+")","format."+c,a[c]),a[c]);e=l("signed","boolean",e),t=l("width","number",t),n=l("decimals","number",n)}H(t%8===0,"invalid FixedNumber width (not byte aligned)","format.width",t),H(n<=80,"invalid FixedNumber decimals (too large)","format.decimals",n);const i=(e?"":"u")+"fixed"+String(t)+"x"+String(n);return{signed:e,width:t,decimals:n,name:i}}function m8(s,e){let t="";s<Us&&(t="-",s*=d8);let n=s.toString();if(e===0)return t+n;for(;n.length<=e;)n=ec+n;const i=n.length-e;for(n=n.substring(0,i)+"."+n.substring(i);n[0]==="0"&&n[1]!==".";)n=n.substring(1);for(;n[n.length-1]==="0"&&n[n.length-2]!==".";)n=n.substring(0,n.length-1);return t+n}var Vs,gt,In,ct,il,Wi,Up,Fp,Gp,$p;const aa=class aa{constructor(e,t,n){ne(this,ct);X(this,"format");ne(this,Vs);ne(this,gt);ne(this,In);X(this,"_value");ef(e,Po,"FixedNumber"),P(this,gt,t),P(this,Vs,n);const i=m8(t,n.decimals);Oe(this,{format:n.name,_value:i}),P(this,In,nl(n.decimals))}get signed(){return L(this,Vs).signed}get width(){return L(this,Vs).width}get decimals(){return L(this,Vs).decimals}get value(){return L(this,gt)}addUnsafe(e){return ge(this,ct,Up).call(this,e)}add(e){return ge(this,ct,Up).call(this,e,"add")}subUnsafe(e){return ge(this,ct,Fp).call(this,e)}sub(e){return ge(this,ct,Fp).call(this,e,"sub")}mulUnsafe(e){return ge(this,ct,Gp).call(this,e)}mul(e){return ge(this,ct,Gp).call(this,e,"mul")}mulSignal(e){ge(this,ct,il).call(this,e);const t=L(this,gt)*L(e,gt);return fe(t%L(this,In)===Us,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),ge(this,ct,Wi).call(this,t/L(this,In),"mulSignal")}divUnsafe(e){return ge(this,ct,$p).call(this,e)}div(e){return ge(this,ct,$p).call(this,e,"div")}divSignal(e){fe(L(e,gt)!==Us,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),ge(this,ct,il).call(this,e);const t=L(this,gt)*L(this,In);return fe(t%L(e,gt)===Us,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),ge(this,ct,Wi).call(this,t/L(e,gt),"divSignal")}cmp(e){let t=this.value,n=e.value;const i=this.decimals-e.decimals;return i>0?n*=nl(i):i<0&&(t*=nl(-i)),t<n?-1:t>n?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=L(this,gt);return L(this,gt)<Us&&(e-=L(this,In)-Yo),e=L(this,gt)/L(this,In)*L(this,In),ge(this,ct,Wi).call(this,e,"floor")}ceiling(){let e=L(this,gt);return L(this,gt)>Us&&(e+=L(this,In)-Yo),e=L(this,gt)/L(this,In)*L(this,In),ge(this,ct,Wi).call(this,e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const t=this.decimals-e,n=g8*nl(t-1);let i=this.value+n;const a=nl(t);return i=i/a*a,sh(i,L(this,Vs),"round"),new aa(Po,i,L(this,Vs))}isZero(){return L(this,gt)===Us}isNegative(){return L(this,gt)<Us}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return aa.fromString(this.toString(),e)}static fromValue(e,t,n){const i=t==null?0:Ve(t),a=Wm(n);let l=we(e,"value");const c=i-a.decimals;if(c>0){const h=nl(c);fe(l%h===Us,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),l/=h}else c<0&&(l*=nl(-c));return sh(l,a,"fromValue"),new aa(Po,l,a)}static fromString(e,t){const n=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);H(n&&n[2].length+n[3].length>0,"invalid FixedNumber string value","value",e);const i=Wm(t);let a=n[2]||"0",l=n[3]||"";for(;l.length<i.decimals;)l+=ec;fe(l.substring(i.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),l=l.substring(0,i.decimals);const c=BigInt(n[1]+a+l);return sh(c,i,"fromString"),new aa(Po,c,i)}static fromBytes(e,t){let n=Zd(nt(e,"value"));const i=Wm(t);return i.signed&&(n=wd(n,i.width)),sh(n,i,"fromBytes"),new aa(Po,n,i)}};Vs=new WeakMap,gt=new WeakMap,In=new WeakMap,ct=new WeakSet,il=function(e){H(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},Wi=function(e,t){return e=sh(e,L(this,Vs),t),new aa(Po,e,L(this,Vs))},Up=function(e,t){return ge(this,ct,il).call(this,e),ge(this,ct,Wi).call(this,L(this,gt)+L(e,gt),t)},Fp=function(e,t){return ge(this,ct,il).call(this,e),ge(this,ct,Wi).call(this,L(this,gt)-L(e,gt),t)},Gp=function(e,t){return ge(this,ct,il).call(this,e),ge(this,ct,Wi).call(this,L(this,gt)*L(e,gt)/L(this,In),t)},$p=function(e,t){return fe(L(e,gt)!==Us,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),ge(this,ct,il).call(this,e),ge(this,ct,Wi).call(this,L(this,gt)*L(this,In)/L(e,gt),t)};let Ld=aa;function p8(s){let e=s.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function Gb(s,e,t){let n=0;for(let i=0;i<t;i++)n=n*256+s[e+i];return n}function $b(s,e,t,n){const i=[];for(;t<e+1+n;){const a=nw(s,t);i.push(a.result),t+=a.consumed,fe(t<=e+1+n,"child data too short","BUFFER_OVERRUN",{buffer:s,length:n,offset:e})}return{consumed:1+n,result:i}}function nw(s,e){fe(s.length!==0,"data too short","BUFFER_OVERRUN",{buffer:s,length:0,offset:1});const t=n=>{fe(n<=s.length,"data short segment too short","BUFFER_OVERRUN",{buffer:s,length:s.length,offset:n})};if(s[e]>=248){const n=s[e]-247;t(e+1+n);const i=Gb(s,e+1,n);return t(e+1+n+i),$b(s,e,e+1+n,n+i)}else if(s[e]>=192){const n=s[e]-192;return t(e+1+n),$b(s,e,e+1,n)}else if(s[e]>=184){const n=s[e]-183;t(e+1+n);const i=Gb(s,e+1,n);t(e+1+n+i);const a=Ae(s.slice(e+1+n,e+1+n+i));return{consumed:1+n+i,result:a}}else if(s[e]>=128){const n=s[e]-128;t(e+1+n);const i=Ae(s.slice(e+1,e+1+n));return{consumed:1+n,result:i}}return{consumed:1,result:p8(s[e])}}function Jd(s){const e=nt(s,"data"),t=nw(e,0);return H(t.consumed===e.length,"unexpected junk after rlp payload","data",s),t.result}function Hb(s){const e=[];for(;s;)e.unshift(s&255),s>>=8;return e}function sw(s){if(Array.isArray(s)){let n=[];if(s.forEach(function(a){n=n.concat(sw(a))}),n.length<=55)return n.unshift(192+n.length),n;const i=Hb(n.length);return i.unshift(247+i.length),i.concat(n)}const e=Array.prototype.slice.call(nt(s,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const t=Hb(e.length);return t.unshift(183+t.length),t.concat(e)}const zb="0123456789abcdef";function Fl(s){let e="0x";for(const t of sw(s))e+=zb[t>>4],e+=zb[t&15];return e}function y8(s,e){let t=18;return t=Ve(e,"unit"),Ld.fromValue(s,t,{decimals:t,width:512}).toString()}function v8(s,e){H(typeof s=="string","value must be a string","value",s);let t=18;return t=Ve(e,"unit"),Ld.fromString(s,{decimals:t,width:512}).value}function x8(s){return y8(s,18)}function E8(s){return v8(s,18)}const Mn=32,Hp=new Uint8Array(Mn),b8=["then"],F0={},iw=new WeakMap;function al(s){return iw.get(s)}function Vb(s,e){iw.set(s,e)}function ih(s,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${s}`);throw t.error=e,t}function zp(s,e,t){return s.indexOf(null)>=0?e.map((n,i)=>n instanceof Yc?zp(al(n),n,t):n):s.reduce((n,i,a)=>{let l=e.getValue(i);return i in n||(t&&l instanceof Yc&&(l=zp(al(l),l,t)),n[i]=l),n},{})}var uc;const jo=class jo extends Array{constructor(...t){const n=t[0];let i=t[1],a=(t[2]||[]).slice(),l=!0;n!==F0&&(i=t,a=[],l=!1);super(i.length);ne(this,uc);i.forEach((f,g)=>{this[g]=f});const c=a.reduce((f,g)=>(typeof g=="string"&&f.set(g,(f.get(g)||0)+1),f),new Map);if(Vb(this,Object.freeze(i.map((f,g)=>{const m=a[g];return m!=null&&c.get(m)===1?m:null}))),P(this,uc,[]),L(this,uc)==null&&L(this,uc),!l)return;Object.freeze(this);const h=new Proxy(this,{get:(f,g,m)=>{if(typeof g=="string"){if(g.match(/^[0-9]+$/)){const v=Ve(g,"%index");if(v<0||v>=this.length)throw new RangeError("out of result range");const x=f[v];return x instanceof Error&&ih(`index ${v}`,x),x}if(b8.indexOf(g)>=0)return Reflect.get(f,g,m);const y=f[g];if(y instanceof Function)return function(...v){return y.apply(this===m?f:this,v)};if(!(g in f))return f.getValue.apply(this===m?f:this,[g])}return Reflect.get(f,g,m)}});return Vb(h,al(this)),h}toArray(t){const n=[];return this.forEach((i,a)=>{i instanceof Error&&ih(`index ${a}`,i),t&&i instanceof jo&&(i=i.toArray(t)),n.push(i)}),n}toObject(t){const n=al(this);return n.reduce((i,a,l)=>(fe(a!=null,`value at index ${l} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),zp(n,this,t)),{})}slice(t,n){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const i=al(this),a=[],l=[];for(let c=t;c<n;c++)a.push(this[c]),l.push(i[c]);return new jo(F0,a,l)}filter(t,n){const i=al(this),a=[],l=[];for(let c=0;c<this.length;c++){const h=this[c];h instanceof Error&&ih(`index ${c}`,h),t.call(n,h,c,this)&&(a.push(h),l.push(i[c]))}return new jo(F0,a,l)}map(t,n){const i=[];for(let a=0;a<this.length;a++){const l=this[a];l instanceof Error&&ih(`index ${a}`,l),i.push(t.call(n,l,a,this))}return i}getValue(t){const n=al(this).indexOf(t);if(n===-1)return;const i=this[n];return i instanceof Error&&ih(`property ${JSON.stringify(t)}`,i.error),i}static fromItems(t,n){return new jo(F0,t,n)}};uc=new WeakMap;let Yc=jo;function Kb(s){let e=On(s);return fe(e.length<=Mn,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:Mn,offset:e.length}),e.length!==Mn&&(e=_n(Ht([Hp.slice(e.length%Mn),e]))),e}class kr{constructor(e,t,n,i){X(this,"name");X(this,"type");X(this,"localName");X(this,"dynamic");Oe(this,{name:e,type:t,localName:n,dynamic:i},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){H(!1,e,this.localName,t)}}var ar,El,hc,sd;class Vp{constructor(){ne(this,hc);ne(this,ar);ne(this,El);P(this,ar,[]),P(this,El,0)}get data(){return Ht(L(this,ar))}get length(){return L(this,El)}appendWriter(e){return ge(this,hc,sd).call(this,_n(e.data))}writeBytes(e){let t=_n(e);const n=t.length%Mn;return n&&(t=_n(Ht([t,Hp.slice(n)]))),ge(this,hc,sd).call(this,t)}writeValue(e){return ge(this,hc,sd).call(this,Kb(e))}writeUpdatableValue(){const e=L(this,ar).length;return L(this,ar).push(Hp),P(this,El,L(this,El)+Mn),t=>{L(this,ar)[e]=Kb(t)}}}ar=new WeakMap,El=new WeakMap,hc=new WeakSet,sd=function(e){return L(this,ar).push(e),P(this,El,L(this,El)+e.length),e.length};var $n,is,bl,Al,ca,Vl,Yp,rw;const b3=class b3{constructor(e,t,n){ne(this,Vl);X(this,"allowLoose");ne(this,$n);ne(this,is);ne(this,bl);ne(this,Al);ne(this,ca);Oe(this,{allowLoose:!!t}),P(this,$n,_n(e)),P(this,bl,0),P(this,Al,null),P(this,ca,n??1024),P(this,is,0)}get data(){return Ae(L(this,$n))}get dataLength(){return L(this,$n).length}get consumed(){return L(this,is)}get bytes(){return new Uint8Array(L(this,$n))}subReader(e){const t=new b3(L(this,$n).slice(L(this,is)+e),this.allowLoose,L(this,ca));return P(t,Al,this),t}readBytes(e,t){let n=ge(this,Vl,rw).call(this,0,e,!!t);return ge(this,Vl,Yp).call(this,e),P(this,is,L(this,is)+n.length),n.slice(0,e)}readValue(){return Zd(this.readBytes(Mn))}readIndex(){return WN(this.readBytes(Mn))}};$n=new WeakMap,is=new WeakMap,bl=new WeakMap,Al=new WeakMap,ca=new WeakMap,Vl=new WeakSet,Yp=function(e){var t;if(L(this,Al))return ge(t=L(this,Al),Vl,Yp).call(t,e);P(this,bl,L(this,bl)+e),fe(L(this,ca)<1||L(this,bl)<=L(this,ca)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${L(this,ca)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:_n(L(this,$n)),offset:L(this,is),length:e,info:{bytesRead:L(this,bl),dataLength:this.dataLength}})},rw=function(e,t,n){let i=Math.ceil(t/Mn)*Mn;return L(this,is)+i>L(this,$n).length&&(this.allowLoose&&n&&L(this,is)+t<=L(this,$n).length?i=t:fe(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:_n(L(this,$n)),length:L(this,$n).length,offset:L(this,is)+i})),L(this,$n).slice(L(this,is),L(this,is)+i)};let Kp=b3;function kd(s){if(!Number.isSafeInteger(s)||s<0)throw new Error(`Wrong positive integer: ${s}`)}function Wy(s,...e){if(!(s instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(s.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${s.length}`)}function A8(s){if(typeof s!="function"||typeof s.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");kd(s.outputLen),kd(s.blockLen)}function jc(s,e=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(e&&s.finished)throw new Error("Hash#digest() has already been called")}function aw(s,e){Wy(s);const t=e.outputLen;if(s.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const Zm=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const lw=s=>s instanceof Uint8Array,S8=s=>new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4)),Jm=s=>new DataView(s.buffer,s.byteOffset,s.byteLength),ci=(s,e)=>s<<32-e|s>>>e,T8=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!T8)throw new Error("Non little-endian hardware is not supported");function w8(s){if(typeof s!="string")throw new Error(`utf8ToBytes expected string, got ${typeof s}`);return new Uint8Array(new TextEncoder().encode(s))}function e2(s){if(typeof s=="string"&&(s=w8(s)),!lw(s))throw new Error(`expected Uint8Array, got ${typeof s}`);return s}function R8(...s){const e=new Uint8Array(s.reduce((n,i)=>n+i.length,0));let t=0;return s.forEach(n=>{if(!lw(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}let Zy=class{clone(){return this._cloneInto()}};function Jy(s){const e=n=>s().update(e2(n)).digest(),t=s();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>s(),e}function L8(s=32){if(Zm&&typeof Zm.getRandomValues=="function")return Zm.getRandomValues(new Uint8Array(s));throw new Error("crypto.getRandomValues must be defined")}class ow extends Zy{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,A8(e);const n=e2(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,a=new Uint8Array(i);a.set(n.length>i?e.create().update(n).digest():n);for(let l=0;l<a.length;l++)a[l]^=54;this.iHash.update(a),this.oHash=e.create();for(let l=0;l<a.length;l++)a[l]^=106;this.oHash.update(a),a.fill(0)}update(e){return jc(this),this.iHash.update(e),this}digestInto(e){jc(this),Wy(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:i,destroyed:a,blockLen:l,outputLen:c}=this;return e=e,e.finished=i,e.destroyed=a,e.blockLen=l,e.outputLen=c,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const cw=(s,e,t)=>new ow(s,e).update(t).digest();cw.create=(s,e)=>new ow(s,e);function k8(s,e,t,n){if(typeof s.setBigUint64=="function")return s.setBigUint64(e,t,n);const i=BigInt(32),a=BigInt(4294967295),l=Number(t>>i&a),c=Number(t&a),h=n?4:0,f=n?0:4;s.setUint32(e+h,l,n),s.setUint32(e+f,c,n)}class uw extends Zy{constructor(e,t,n,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Jm(this.buffer)}update(e){jc(this);const{view:t,buffer:n,blockLen:i}=this;e=e2(e);const a=e.length;for(let l=0;l<a;){const c=Math.min(i-this.pos,a-l);if(c===i){const h=Jm(e);for(;i<=a-l;l+=i)this.process(h,l);continue}n.set(e.subarray(l,l+c),this.pos),this.pos+=c,l+=c,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){jc(this),aw(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:i,isLE:a}=this;let{pos:l}=this;t[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>i-l&&(this.process(n,0),l=0);for(let m=l;m<i;m++)t[m]=0;k8(n,i-8,BigInt(this.length*8),a),this.process(n,0);const c=Jm(e),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=h/4,g=this.get();if(f>g.length)throw new Error("_sha2: outputLen bigger than state");for(let m=0;m<f;m++)c.setUint32(4*m,g[m],a)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:i,finished:a,destroyed:l,pos:c}=this;return e.length=i,e.pos=c,e.finished=a,e.destroyed=l,i%t&&e.buffer.set(n),e}}const I8=(s,e,t)=>s&e^~s&t,D8=(s,e,t)=>s&e^s&t^e&t,C8=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Jr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ea=new Uint32Array(64);class _8 extends uw{constructor(){super(64,32,8,!1),this.A=Jr[0]|0,this.B=Jr[1]|0,this.C=Jr[2]|0,this.D=Jr[3]|0,this.E=Jr[4]|0,this.F=Jr[5]|0,this.G=Jr[6]|0,this.H=Jr[7]|0}get(){const{A:e,B:t,C:n,D:i,E:a,F:l,G:c,H:h}=this;return[e,t,n,i,a,l,c,h]}set(e,t,n,i,a,l,c,h){this.A=e|0,this.B=t|0,this.C=n|0,this.D=i|0,this.E=a|0,this.F=l|0,this.G=c|0,this.H=h|0}process(e,t){for(let m=0;m<16;m++,t+=4)ea[m]=e.getUint32(t,!1);for(let m=16;m<64;m++){const y=ea[m-15],v=ea[m-2],x=ci(y,7)^ci(y,18)^y>>>3,b=ci(v,17)^ci(v,19)^v>>>10;ea[m]=b+ea[m-7]+x+ea[m-16]|0}let{A:n,B:i,C:a,D:l,E:c,F:h,G:f,H:g}=this;for(let m=0;m<64;m++){const y=ci(c,6)^ci(c,11)^ci(c,25),v=g+y+I8(c,h,f)+C8[m]+ea[m]|0,b=(ci(n,2)^ci(n,13)^ci(n,22))+D8(n,i,a)|0;g=f,f=h,h=c,c=l+v|0,l=a,a=i,i=n,n=v+b|0}n=n+this.A|0,i=i+this.B|0,a=a+this.C|0,l=l+this.D|0,c=c+this.E|0,h=h+this.F|0,f=f+this.G|0,g=g+this.H|0,this.set(n,i,a,l,c,h,f,g)}roundClean(){ea.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const hw=Jy(()=>new _8),G0=BigInt(2**32-1),jp=BigInt(32);function fw(s,e=!1){return e?{h:Number(s&G0),l:Number(s>>jp&G0)}:{h:Number(s>>jp&G0)|0,l:Number(s&G0)|0}}function dw(s,e=!1){let t=new Uint32Array(s.length),n=new Uint32Array(s.length);for(let i=0;i<s.length;i++){const{h:a,l}=fw(s[i],e);[t[i],n[i]]=[a,l]}return[t,n]}const O8=(s,e)=>BigInt(s>>>0)<<jp|BigInt(e>>>0),M8=(s,e,t)=>s>>>t,P8=(s,e,t)=>s<<32-t|e>>>t,N8=(s,e,t)=>s>>>t|e<<32-t,B8=(s,e,t)=>s<<32-t|e>>>t,U8=(s,e,t)=>s<<64-t|e>>>t-32,F8=(s,e,t)=>s>>>t-32|e<<64-t,G8=(s,e)=>e,$8=(s,e)=>s,gw=(s,e,t)=>s<<t|e>>>32-t,mw=(s,e,t)=>e<<t|s>>>32-t,pw=(s,e,t)=>e<<t-32|s>>>64-t,yw=(s,e,t)=>s<<t-32|e>>>64-t;function H8(s,e,t,n){const i=(e>>>0)+(n>>>0);return{h:s+t+(i/2**32|0)|0,l:i|0}}const z8=(s,e,t)=>(s>>>0)+(e>>>0)+(t>>>0),V8=(s,e,t,n)=>e+t+n+(s/2**32|0)|0,K8=(s,e,t,n)=>(s>>>0)+(e>>>0)+(t>>>0)+(n>>>0),Y8=(s,e,t,n,i)=>e+t+n+i+(s/2**32|0)|0,j8=(s,e,t,n,i)=>(s>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0),Q8=(s,e,t,n,i,a)=>e+t+n+i+a+(s/2**32|0)|0,Ye={fromBig:fw,split:dw,toBig:O8,shrSH:M8,shrSL:P8,rotrSH:N8,rotrSL:B8,rotrBH:U8,rotrBL:F8,rotr32H:G8,rotr32L:$8,rotlSH:gw,rotlSL:mw,rotlBH:pw,rotlBL:yw,add:H8,add3L:z8,add3H:V8,add4L:K8,add4H:Y8,add5H:Q8,add5L:j8},[q8,X8]=Ye.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(s=>BigInt(s))),ta=new Uint32Array(80),na=new Uint32Array(80);class W8 extends uw{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:i,Ch:a,Cl:l,Dh:c,Dl:h,Eh:f,El:g,Fh:m,Fl:y,Gh:v,Gl:x,Hh:b,Hl:A}=this;return[e,t,n,i,a,l,c,h,f,g,m,y,v,x,b,A]}set(e,t,n,i,a,l,c,h,f,g,m,y,v,x,b,A){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=i|0,this.Ch=a|0,this.Cl=l|0,this.Dh=c|0,this.Dl=h|0,this.Eh=f|0,this.El=g|0,this.Fh=m|0,this.Fl=y|0,this.Gh=v|0,this.Gl=x|0,this.Hh=b|0,this.Hl=A|0}process(e,t){for(let R=0;R<16;R++,t+=4)ta[R]=e.getUint32(t),na[R]=e.getUint32(t+=4);for(let R=16;R<80;R++){const _=ta[R-15]|0,C=na[R-15]|0,U=Ye.rotrSH(_,C,1)^Ye.rotrSH(_,C,8)^Ye.shrSH(_,C,7),O=Ye.rotrSL(_,C,1)^Ye.rotrSL(_,C,8)^Ye.shrSL(_,C,7),B=ta[R-2]|0,F=na[R-2]|0,M=Ye.rotrSH(B,F,19)^Ye.rotrBH(B,F,61)^Ye.shrSH(B,F,6),j=Ye.rotrSL(B,F,19)^Ye.rotrBL(B,F,61)^Ye.shrSL(B,F,6),ae=Ye.add4L(O,j,na[R-7],na[R-16]),ye=Ye.add4H(ae,U,M,ta[R-7],ta[R-16]);ta[R]=ye|0,na[R]=ae|0}let{Ah:n,Al:i,Bh:a,Bl:l,Ch:c,Cl:h,Dh:f,Dl:g,Eh:m,El:y,Fh:v,Fl:x,Gh:b,Gl:A,Hh:S,Hl:k}=this;for(let R=0;R<80;R++){const _=Ye.rotrSH(m,y,14)^Ye.rotrSH(m,y,18)^Ye.rotrBH(m,y,41),C=Ye.rotrSL(m,y,14)^Ye.rotrSL(m,y,18)^Ye.rotrBL(m,y,41),U=m&v^~m&b,O=y&x^~y&A,B=Ye.add5L(k,C,O,X8[R],na[R]),F=Ye.add5H(B,S,_,U,q8[R],ta[R]),M=B|0,j=Ye.rotrSH(n,i,28)^Ye.rotrBH(n,i,34)^Ye.rotrBH(n,i,39),ae=Ye.rotrSL(n,i,28)^Ye.rotrBL(n,i,34)^Ye.rotrBL(n,i,39),ye=n&a^n&c^a&c,pe=i&l^i&h^l&h;S=b|0,k=A|0,b=v|0,A=x|0,v=m|0,x=y|0,{h:m,l:y}=Ye.add(f|0,g|0,F|0,M|0),f=c|0,g=h|0,c=a|0,h=l|0,a=n|0,l=i|0;const W=Ye.add3L(M,ae,pe);n=Ye.add3H(W,F,j,ye),i=W|0}({h:n,l:i}=Ye.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:a,l}=Ye.add(this.Bh|0,this.Bl|0,a|0,l|0),{h:c,l:h}=Ye.add(this.Ch|0,this.Cl|0,c|0,h|0),{h:f,l:g}=Ye.add(this.Dh|0,this.Dl|0,f|0,g|0),{h:m,l:y}=Ye.add(this.Eh|0,this.El|0,m|0,y|0),{h:v,l:x}=Ye.add(this.Fh|0,this.Fl|0,v|0,x|0),{h:b,l:A}=Ye.add(this.Gh|0,this.Gl|0,b|0,A|0),{h:S,l:k}=Ye.add(this.Hh|0,this.Hl|0,S|0,k|0),this.set(n,i,a,l,c,h,f,g,m,y,v,x,b,A,S,k)}roundClean(){ta.fill(0),na.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Z8=Jy(()=>new W8);function J8(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const Yb=J8(),jb=Yb.crypto||Yb.msCrypto;function eB(s){switch(s){case"sha256":return hw.create();case"sha512":return Z8.create()}H(!1,"invalid hashing algorithm name","algorithm",s)}function tB(s){fe(jb!=null,"platform does not support secure random numbers","UNSUPPORTED_OPERATION",{operation:"randomBytes"}),H(Number.isInteger(s)&&s>0&&s<=1024,"invalid length","length",s);const e=new Uint8Array(s);return jb.getRandomValues(e),e}const[vw,xw,Ew]=[[],[],[]],nB=BigInt(0),rh=BigInt(1),sB=BigInt(2),iB=BigInt(7),rB=BigInt(256),aB=BigInt(113);for(let s=0,e=rh,t=1,n=0;s<24;s++){[t,n]=[n,(2*t+3*n)%5],vw.push(2*(5*n+t)),xw.push((s+1)*(s+2)/2%64);let i=nB;for(let a=0;a<7;a++)e=(e<<rh^(e>>iB)*aB)%rB,e&sB&&(i^=rh<<(rh<<BigInt(a))-rh);Ew.push(i)}const[lB,oB]=dw(Ew,!0),Qb=(s,e,t)=>t>32?pw(s,e,t):gw(s,e,t),qb=(s,e,t)=>t>32?yw(s,e,t):mw(s,e,t);function cB(s,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let l=0;l<10;l++)t[l]=s[l]^s[l+10]^s[l+20]^s[l+30]^s[l+40];for(let l=0;l<10;l+=2){const c=(l+8)%10,h=(l+2)%10,f=t[h],g=t[h+1],m=Qb(f,g,1)^t[c],y=qb(f,g,1)^t[c+1];for(let v=0;v<50;v+=10)s[l+v]^=m,s[l+v+1]^=y}let i=s[2],a=s[3];for(let l=0;l<24;l++){const c=xw[l],h=Qb(i,a,c),f=qb(i,a,c),g=vw[l];i=s[g],a=s[g+1],s[g]=h,s[g+1]=f}for(let l=0;l<50;l+=10){for(let c=0;c<10;c++)t[c]=s[l+c];for(let c=0;c<10;c++)s[l+c]^=~t[(c+2)%10]&t[(c+4)%10]}s[0]^=lB[n],s[1]^=oB[n]}t.fill(0)}let uB=class bw extends Zy{constructor(e,t,n,i=!1,a=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=i,this.rounds=a,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,kd(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=S8(this.state)}keccak(){cB(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){jc(this);const{blockLen:t,state:n}=this;e=e2(e);const i=e.length;for(let a=0;a<i;){const l=Math.min(t-this.pos,i-a);for(let c=0;c<l;c++)n[this.pos++]^=e[a++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:i}=this;e[n]^=t,(t&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){jc(this,!1),Wy(e),this.finish();const t=this.state,{blockLen:n}=this;for(let i=0,a=e.length;i<a;){this.posOut>=n&&this.keccak();const l=Math.min(n-this.posOut,a-i);e.set(t.subarray(this.posOut,this.posOut+l),i),this.posOut+=l,i+=l}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return kd(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(aw(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:i,rounds:a,enableXOF:l}=this;return e||(e=new bw(t,n,i,l,a)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=a,e.suffix=n,e.outputLen=i,e.enableXOF=l,e.destroyed=this.destroyed,e}};const hB=(s,e,t)=>Jy(()=>new uB(e,s,t)),fB=hB(1,136,256/8);let Aw=!1;const Sw=function(s){return fB(s)};let Tw=Sw;function $t(s){const e=nt(s,"data");return Ae(Tw(e))}$t._=Sw;$t.lock=function(){Aw=!0};$t.register=function(s){if(Aw)throw new TypeError("keccak256 is locked");Tw=s};Object.freeze($t);let ww=!1;const Rw=function(s){return new Uint8Array(tB(s))};let Lw=Rw;function tf(s){return Lw(s)}tf._=Rw;tf.lock=function(){ww=!0};tf.register=function(s){if(ww)throw new Error("randomBytes is locked");Lw=s};Object.freeze(tf);const kw=function(s){return eB("sha256").update(s).digest()};let Iw=kw,Dw=!1;function tu(s){const e=nt(s,"data");return Ae(Iw(e))}tu._=kw;tu.lock=function(){Dw=!0};tu.register=function(s){if(Dw)throw new Error("sha256 is locked");Iw=s};Object.freeze(tu);Object.freeze(tu);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Cw=BigInt(0),t2=BigInt(1),dB=BigInt(2),n2=s=>s instanceof Uint8Array,gB=Array.from({length:256},(s,e)=>e.toString(16).padStart(2,"0"));function Qc(s){if(!n2(s))throw new Error("Uint8Array expected");let e="";for(let t=0;t<s.length;t++)e+=gB[s[t]];return e}function _w(s){const e=s.toString(16);return e.length&1?`0${e}`:e}function e3(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);return BigInt(s===""?"0":`0x${s}`)}function qc(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);const e=s.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let n=0;n<t.length;n++){const i=n*2,a=s.slice(i,i+2),l=Number.parseInt(a,16);if(Number.isNaN(l)||l<0)throw new Error("Invalid byte sequence");t[n]=l}return t}function Pl(s){return e3(Qc(s))}function t3(s){if(!n2(s))throw new Error("Uint8Array expected");return e3(Qc(Uint8Array.from(s).reverse()))}function Xc(s,e){return qc(s.toString(16).padStart(e*2,"0"))}function n3(s,e){return Xc(s,e).reverse()}function mB(s){return qc(_w(s))}function $s(s,e,t){let n;if(typeof e=="string")try{n=qc(e)}catch(a){throw new Error(`${s} must be valid hex string, got "${e}". Cause: ${a}`)}else if(n2(e))n=Uint8Array.from(e);else throw new Error(`${s} must be hex string or Uint8Array`);const i=n.length;if(typeof t=="number"&&i!==t)throw new Error(`${s} expected ${t} bytes, got ${i}`);return n}function Ih(...s){const e=new Uint8Array(s.reduce((n,i)=>n+i.length,0));let t=0;return s.forEach(n=>{if(!n2(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}function pB(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(s[t]!==e[t])return!1;return!0}function yB(s){if(typeof s!="string")throw new Error(`utf8ToBytes expected string, got ${typeof s}`);return new Uint8Array(new TextEncoder().encode(s))}function vB(s){let e;for(e=0;s>Cw;s>>=t2,e+=1);return e}function xB(s,e){return s>>BigInt(e)&t2}const EB=(s,e,t)=>s|(t?t2:Cw)<<BigInt(e),s3=s=>(dB<<BigInt(s-1))-t2,ep=s=>new Uint8Array(s),Xb=s=>Uint8Array.from(s);function Ow(s,e,t){if(typeof s!="number"||s<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=ep(s),i=ep(s),a=0;const l=()=>{n.fill(1),i.fill(0),a=0},c=(...m)=>t(i,n,...m),h=(m=ep())=>{i=c(Xb([0]),m),n=c(),m.length!==0&&(i=c(Xb([1]),m),n=c())},f=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let m=0;const y=[];for(;m<e;){n=c();const v=n.slice();y.push(v),m+=n.length}return Ih(...y)};return(m,y)=>{l(),h(m);let v;for(;!(v=y(f()));)h();return l(),v}}const bB={bigint:s=>typeof s=="bigint",function:s=>typeof s=="function",boolean:s=>typeof s=="boolean",string:s=>typeof s=="string",stringOrUint8Array:s=>typeof s=="string"||s instanceof Uint8Array,isSafeInteger:s=>Number.isSafeInteger(s),array:s=>Array.isArray(s),field:(s,e)=>e.Fp.isValid(s),hash:s=>typeof s=="function"&&Number.isSafeInteger(s.outputLen)};function nf(s,e,t={}){const n=(i,a,l)=>{const c=bB[a];if(typeof c!="function")throw new Error(`Invalid validator "${a}", expected function`);const h=s[i];if(!(l&&h===void 0)&&!c(h,s))throw new Error(`Invalid param ${String(i)}=${h} (${typeof h}), expected ${a}`)};for(const[i,a]of Object.entries(e))n(i,a,!1);for(const[i,a]of Object.entries(t))n(i,a,!0);return s}const AB=Object.freeze(Object.defineProperty({__proto__:null,bitGet:xB,bitLen:vB,bitMask:s3,bitSet:EB,bytesToHex:Qc,bytesToNumberBE:Pl,bytesToNumberLE:t3,concatBytes:Ih,createHmacDrbg:Ow,ensureBytes:$s,equalBytes:pB,hexToBytes:qc,hexToNumber:e3,numberToBytesBE:Xc,numberToBytesLE:n3,numberToHexUnpadded:_w,numberToVarBytesBE:mB,utf8ToBytes:yB,validateObject:nf},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const on=BigInt(0),Ft=BigInt(1),ll=BigInt(2),SB=BigInt(3),Qp=BigInt(4),Wb=BigInt(5),Zb=BigInt(8);BigInt(9);BigInt(16);function zn(s,e){const t=s%e;return t>=on?t:e+t}function TB(s,e,t){if(t<=on||e<on)throw new Error("Expected power/modulo > 0");if(t===Ft)return on;let n=Ft;for(;e>on;)e&Ft&&(n=n*s%t),s=s*s%t,e>>=Ft;return n}function As(s,e,t){let n=s;for(;e-- >on;)n*=n,n%=t;return n}function qp(s,e){if(s===on||e<=on)throw new Error(`invert: expected positive integers, got n=${s} mod=${e}`);let t=zn(s,e),n=e,i=on,a=Ft;for(;t!==on;){const c=n/t,h=n%t,f=i-a*c;n=t,t=h,i=a,a=f}if(n!==Ft)throw new Error("invert: does not exist");return zn(i,e)}function wB(s){const e=(s-Ft)/ll;let t,n,i;for(t=s-Ft,n=0;t%ll===on;t/=ll,n++);for(i=ll;i<s&&TB(i,e,s)!==s-Ft;i++);if(n===1){const l=(s+Ft)/Qp;return function(h,f){const g=h.pow(f,l);if(!h.eql(h.sqr(g),f))throw new Error("Cannot find square root");return g}}const a=(t+Ft)/ll;return function(c,h){if(c.pow(h,e)===c.neg(c.ONE))throw new Error("Cannot find square root");let f=n,g=c.pow(c.mul(c.ONE,i),t),m=c.pow(h,a),y=c.pow(h,t);for(;!c.eql(y,c.ONE);){if(c.eql(y,c.ZERO))return c.ZERO;let v=1;for(let b=c.sqr(y);v<f&&!c.eql(b,c.ONE);v++)b=c.sqr(b);const x=c.pow(g,Ft<<BigInt(f-v-1));g=c.sqr(x),m=c.mul(m,x),y=c.mul(y,g),f=v}return m}}function RB(s){if(s%Qp===SB){const e=(s+Ft)/Qp;return function(n,i){const a=n.pow(i,e);if(!n.eql(n.sqr(a),i))throw new Error("Cannot find square root");return a}}if(s%Zb===Wb){const e=(s-Wb)/Zb;return function(n,i){const a=n.mul(i,ll),l=n.pow(a,e),c=n.mul(i,l),h=n.mul(n.mul(c,ll),l),f=n.mul(c,n.sub(h,n.ONE));if(!n.eql(n.sqr(f),i))throw new Error("Cannot find square root");return f}}return wB(s)}const LB=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function kB(s){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=LB.reduce((n,i)=>(n[i]="function",n),e);return nf(s,t)}function IB(s,e,t){if(t<on)throw new Error("Expected power > 0");if(t===on)return s.ONE;if(t===Ft)return e;let n=s.ONE,i=e;for(;t>on;)t&Ft&&(n=s.mul(n,i)),i=s.sqr(i),t>>=Ft;return n}function DB(s,e){const t=new Array(e.length),n=e.reduce((a,l,c)=>s.is0(l)?a:(t[c]=a,s.mul(a,l)),s.ONE),i=s.inv(n);return e.reduceRight((a,l,c)=>s.is0(l)?a:(t[c]=s.mul(a,t[c]),s.mul(a,l)),i),t}function Mw(s,e){const t=e!==void 0?e:s.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function CB(s,e,t=!1,n={}){if(s<=on)throw new Error(`Expected Field ORDER > 0, got ${s}`);const{nBitLength:i,nByteLength:a}=Mw(s,e);if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");const l=RB(s),c=Object.freeze({ORDER:s,BITS:i,BYTES:a,MASK:s3(i),ZERO:on,ONE:Ft,create:h=>zn(h,s),isValid:h=>{if(typeof h!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof h}`);return on<=h&&h<s},is0:h=>h===on,isOdd:h=>(h&Ft)===Ft,neg:h=>zn(-h,s),eql:(h,f)=>h===f,sqr:h=>zn(h*h,s),add:(h,f)=>zn(h+f,s),sub:(h,f)=>zn(h-f,s),mul:(h,f)=>zn(h*f,s),pow:(h,f)=>IB(c,h,f),div:(h,f)=>zn(h*qp(f,s),s),sqrN:h=>h*h,addN:(h,f)=>h+f,subN:(h,f)=>h-f,mulN:(h,f)=>h*f,inv:h=>qp(h,s),sqrt:n.sqrt||(h=>l(c,h)),invertBatch:h=>DB(c,h),cmov:(h,f,g)=>g?f:h,toBytes:h=>t?n3(h,a):Xc(h,a),fromBytes:h=>{if(h.length!==a)throw new Error(`Fp.fromBytes: expected ${a}, got ${h.length}`);return t?t3(h):Pl(h)}});return Object.freeze(c)}function Pw(s){if(typeof s!="bigint")throw new Error("field order must be bigint");const e=s.toString(2).length;return Math.ceil(e/8)}function Nw(s){const e=Pw(s);return e+Math.ceil(e/2)}function _B(s,e,t=!1){const n=s.length,i=Pw(e),a=Nw(e);if(n<16||n<a||n>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${n}`);const l=t?Pl(s):t3(s),c=zn(l,e-Ft)+Ft;return t?n3(c,i):Xc(c,i)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const OB=BigInt(0),tp=BigInt(1);function MB(s,e){const t=(i,a)=>{const l=a.negate();return i?l:a},n=i=>{const a=Math.ceil(e/i)+1,l=2**(i-1);return{windows:a,windowSize:l}};return{constTimeNegate:t,unsafeLadder(i,a){let l=s.ZERO,c=i;for(;a>OB;)a&tp&&(l=l.add(c)),c=c.double(),a>>=tp;return l},precomputeWindow(i,a){const{windows:l,windowSize:c}=n(a),h=[];let f=i,g=f;for(let m=0;m<l;m++){g=f,h.push(g);for(let y=1;y<c;y++)g=g.add(f),h.push(g);f=g.double()}return h},wNAF(i,a,l){const{windows:c,windowSize:h}=n(i);let f=s.ZERO,g=s.BASE;const m=BigInt(2**i-1),y=2**i,v=BigInt(i);for(let x=0;x<c;x++){const b=x*h;let A=Number(l&m);l>>=v,A>h&&(A-=y,l+=tp);const S=b,k=b+Math.abs(A)-1,R=x%2!==0,_=A<0;A===0?g=g.add(t(R,a[S])):f=f.add(t(_,a[k]))}return{p:f,f:g}},wNAFCached(i,a,l,c){const h=i._WINDOW_SIZE||1;let f=a.get(i);return f||(f=this.precomputeWindow(i,h),h!==1&&a.set(i,c(f))),this.wNAF(h,f,l)}}}function Bw(s){return kB(s.Fp),nf(s,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Mw(s.n,s.nBitLength),...s,p:s.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function PB(s){const e=Bw(s);nf(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:i}=e;if(t){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:NB,hexToBytes:BB}=AB,hl={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(s){const{Err:e}=hl;if(s.length<2||s[0]!==2)throw new e("Invalid signature integer tag");const t=s[1],n=s.subarray(2,t+2);if(!t||n.length!==t)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:NB(n),l:s.subarray(t+2)}},toSig(s){const{Err:e}=hl,t=typeof s=="string"?BB(s):s;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let n=t.length;if(n<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:i,l:a}=hl._parseInt(t.subarray(2)),{d:l,l:c}=hl._parseInt(a);if(c.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s:l}},hexFromSig(s){const e=f=>Number.parseInt(f[0],16)&8?"00"+f:f,t=f=>{const g=f.toString(16);return g.length&1?`0${g}`:g},n=e(t(s.s)),i=e(t(s.r)),a=n.length/2,l=i.length/2,c=t(a),h=t(l);return`30${t(l+a+4)}02${h}${i}02${c}${n}`}},yr=BigInt(0),Ds=BigInt(1);BigInt(2);const Jb=BigInt(3);BigInt(4);function UB(s){const e=PB(s),{Fp:t}=e,n=e.toBytes||((x,b,A)=>{const S=b.toAffine();return Ih(Uint8Array.from([4]),t.toBytes(S.x),t.toBytes(S.y))}),i=e.fromBytes||(x=>{const b=x.subarray(1),A=t.fromBytes(b.subarray(0,t.BYTES)),S=t.fromBytes(b.subarray(t.BYTES,2*t.BYTES));return{x:A,y:S}});function a(x){const{a:b,b:A}=e,S=t.sqr(x),k=t.mul(S,x);return t.add(t.add(k,t.mul(x,b)),A)}if(!t.eql(t.sqr(e.Gy),a(e.Gx)))throw new Error("bad generator point: equation left != right");function l(x){return typeof x=="bigint"&&yr<x&&x<e.n}function c(x){if(!l(x))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function h(x){const{allowedPrivateKeyLengths:b,nByteLength:A,wrapPrivateKey:S,n:k}=e;if(b&&typeof x!="bigint"){if(x instanceof Uint8Array&&(x=Qc(x)),typeof x!="string"||!b.includes(x.length))throw new Error("Invalid key");x=x.padStart(A*2,"0")}let R;try{R=typeof x=="bigint"?x:Pl($s("private key",x,A))}catch{throw new Error(`private key must be ${A} bytes, hex or bigint, not ${typeof x}`)}return S&&(R=zn(R,k)),c(R),R}const f=new Map;function g(x){if(!(x instanceof m))throw new Error("ProjectivePoint expected")}class m{constructor(b,A,S){if(this.px=b,this.py=A,this.pz=S,b==null||!t.isValid(b))throw new Error("x required");if(A==null||!t.isValid(A))throw new Error("y required");if(S==null||!t.isValid(S))throw new Error("z required")}static fromAffine(b){const{x:A,y:S}=b||{};if(!b||!t.isValid(A)||!t.isValid(S))throw new Error("invalid affine point");if(b instanceof m)throw new Error("projective point not allowed");const k=R=>t.eql(R,t.ZERO);return k(A)&&k(S)?m.ZERO:new m(A,S,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(b){const A=t.invertBatch(b.map(S=>S.pz));return b.map((S,k)=>S.toAffine(A[k])).map(m.fromAffine)}static fromHex(b){const A=m.fromAffine(i($s("pointHex",b)));return A.assertValidity(),A}static fromPrivateKey(b){return m.BASE.multiply(h(b))}_setWindowSize(b){this._WINDOW_SIZE=b,f.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:b,y:A}=this.toAffine();if(!t.isValid(b)||!t.isValid(A))throw new Error("bad point: x or y not FE");const S=t.sqr(A),k=a(b);if(!t.eql(S,k))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:b}=this.toAffine();if(t.isOdd)return!t.isOdd(b);throw new Error("Field doesn't support isOdd")}equals(b){g(b);const{px:A,py:S,pz:k}=this,{px:R,py:_,pz:C}=b,U=t.eql(t.mul(A,C),t.mul(R,k)),O=t.eql(t.mul(S,C),t.mul(_,k));return U&&O}negate(){return new m(this.px,t.neg(this.py),this.pz)}double(){const{a:b,b:A}=e,S=t.mul(A,Jb),{px:k,py:R,pz:_}=this;let C=t.ZERO,U=t.ZERO,O=t.ZERO,B=t.mul(k,k),F=t.mul(R,R),M=t.mul(_,_),j=t.mul(k,R);return j=t.add(j,j),O=t.mul(k,_),O=t.add(O,O),C=t.mul(b,O),U=t.mul(S,M),U=t.add(C,U),C=t.sub(F,U),U=t.add(F,U),U=t.mul(C,U),C=t.mul(j,C),O=t.mul(S,O),M=t.mul(b,M),j=t.sub(B,M),j=t.mul(b,j),j=t.add(j,O),O=t.add(B,B),B=t.add(O,B),B=t.add(B,M),B=t.mul(B,j),U=t.add(U,B),M=t.mul(R,_),M=t.add(M,M),B=t.mul(M,j),C=t.sub(C,B),O=t.mul(M,F),O=t.add(O,O),O=t.add(O,O),new m(C,U,O)}add(b){g(b);const{px:A,py:S,pz:k}=this,{px:R,py:_,pz:C}=b;let U=t.ZERO,O=t.ZERO,B=t.ZERO;const F=e.a,M=t.mul(e.b,Jb);let j=t.mul(A,R),ae=t.mul(S,_),ye=t.mul(k,C),pe=t.add(A,S),W=t.add(R,_);pe=t.mul(pe,W),W=t.add(j,ae),pe=t.sub(pe,W),W=t.add(A,k);let G=t.add(R,C);return W=t.mul(W,G),G=t.add(j,ye),W=t.sub(W,G),G=t.add(S,k),U=t.add(_,C),G=t.mul(G,U),U=t.add(ae,ye),G=t.sub(G,U),B=t.mul(F,W),U=t.mul(M,ye),B=t.add(U,B),U=t.sub(ae,B),B=t.add(ae,B),O=t.mul(U,B),ae=t.add(j,j),ae=t.add(ae,j),ye=t.mul(F,ye),W=t.mul(M,W),ae=t.add(ae,ye),ye=t.sub(j,ye),ye=t.mul(F,ye),W=t.add(W,ye),j=t.mul(ae,W),O=t.add(O,j),j=t.mul(G,W),U=t.mul(pe,U),U=t.sub(U,j),j=t.mul(pe,ae),B=t.mul(G,B),B=t.add(B,j),new m(U,O,B)}subtract(b){return this.add(b.negate())}is0(){return this.equals(m.ZERO)}wNAF(b){return v.wNAFCached(this,f,b,A=>{const S=t.invertBatch(A.map(k=>k.pz));return A.map((k,R)=>k.toAffine(S[R])).map(m.fromAffine)})}multiplyUnsafe(b){const A=m.ZERO;if(b===yr)return A;if(c(b),b===Ds)return this;const{endo:S}=e;if(!S)return v.unsafeLadder(this,b);let{k1neg:k,k1:R,k2neg:_,k2:C}=S.splitScalar(b),U=A,O=A,B=this;for(;R>yr||C>yr;)R&Ds&&(U=U.add(B)),C&Ds&&(O=O.add(B)),B=B.double(),R>>=Ds,C>>=Ds;return k&&(U=U.negate()),_&&(O=O.negate()),O=new m(t.mul(O.px,S.beta),O.py,O.pz),U.add(O)}multiply(b){c(b);let A=b,S,k;const{endo:R}=e;if(R){const{k1neg:_,k1:C,k2neg:U,k2:O}=R.splitScalar(A);let{p:B,f:F}=this.wNAF(C),{p:M,f:j}=this.wNAF(O);B=v.constTimeNegate(_,B),M=v.constTimeNegate(U,M),M=new m(t.mul(M.px,R.beta),M.py,M.pz),S=B.add(M),k=F.add(j)}else{const{p:_,f:C}=this.wNAF(A);S=_,k=C}return m.normalizeZ([S,k])[0]}multiplyAndAddUnsafe(b,A,S){const k=m.BASE,R=(C,U)=>U===yr||U===Ds||!C.equals(k)?C.multiplyUnsafe(U):C.multiply(U),_=R(this,A).add(R(b,S));return _.is0()?void 0:_}toAffine(b){const{px:A,py:S,pz:k}=this,R=this.is0();b==null&&(b=R?t.ONE:t.inv(k));const _=t.mul(A,b),C=t.mul(S,b),U=t.mul(k,b);if(R)return{x:t.ZERO,y:t.ZERO};if(!t.eql(U,t.ONE))throw new Error("invZ was invalid");return{x:_,y:C}}isTorsionFree(){const{h:b,isTorsionFree:A}=e;if(b===Ds)return!0;if(A)return A(m,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:b,clearCofactor:A}=e;return b===Ds?this:A?A(m,this):this.multiplyUnsafe(e.h)}toRawBytes(b=!0){return this.assertValidity(),n(m,this,b)}toHex(b=!0){return Qc(this.toRawBytes(b))}}m.BASE=new m(e.Gx,e.Gy,t.ONE),m.ZERO=new m(t.ZERO,t.ONE,t.ZERO);const y=e.nBitLength,v=MB(m,e.endo?Math.ceil(y/2):y);return{CURVE:e,ProjectivePoint:m,normPrivateKeyToScalar:h,weierstrassEquation:a,isWithinCurveOrder:l}}function FB(s){const e=Bw(s);return nf(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function GB(s){const e=FB(s),{Fp:t,n}=e,i=t.BYTES+1,a=2*t.BYTES+1;function l(W){return yr<W&&W<t.ORDER}function c(W){return zn(W,n)}function h(W){return qp(W,n)}const{ProjectivePoint:f,normPrivateKeyToScalar:g,weierstrassEquation:m,isWithinCurveOrder:y}=UB({...e,toBytes(W,G,te){const se=G.toAffine(),Z=t.toBytes(se.x),I=Ih;return te?I(Uint8Array.from([G.hasEvenY()?2:3]),Z):I(Uint8Array.from([4]),Z,t.toBytes(se.y))},fromBytes(W){const G=W.length,te=W[0],se=W.subarray(1);if(G===i&&(te===2||te===3)){const Z=Pl(se);if(!l(Z))throw new Error("Point is not on curve");const I=m(Z);let V=t.sqrt(I);const ie=(V&Ds)===Ds;return(te&1)===1!==ie&&(V=t.neg(V)),{x:Z,y:V}}else if(G===a&&te===4){const Z=t.fromBytes(se.subarray(0,t.BYTES)),I=t.fromBytes(se.subarray(t.BYTES,2*t.BYTES));return{x:Z,y:I}}else throw new Error(`Point of length ${G} was invalid. Expected ${i} compressed bytes or ${a} uncompressed bytes`)}}),v=W=>Qc(Xc(W,e.nByteLength));function x(W){const G=n>>Ds;return W>G}function b(W){return x(W)?c(-W):W}const A=(W,G,te)=>Pl(W.slice(G,te));class S{constructor(G,te,se){this.r=G,this.s=te,this.recovery=se,this.assertValidity()}static fromCompact(G){const te=e.nByteLength;return G=$s("compactSignature",G,te*2),new S(A(G,0,te),A(G,te,2*te))}static fromDER(G){const{r:te,s:se}=hl.toSig($s("DER",G));return new S(te,se)}assertValidity(){if(!y(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!y(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(G){return new S(this.r,this.s,G)}recoverPublicKey(G){const{r:te,s:se,recovery:Z}=this,I=O($s("msgHash",G));if(Z==null||![0,1,2,3].includes(Z))throw new Error("recovery id invalid");const V=Z===2||Z===3?te+e.n:te;if(V>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const ie=(Z&1)===0?"02":"03",ce=f.fromHex(ie+v(V)),ue=h(V),xe=c(-I*ue),ve=c(se*ue),$e=f.BASE.multiplyAndAddUnsafe(ce,xe,ve);if(!$e)throw new Error("point at infinify");return $e.assertValidity(),$e}hasHighS(){return x(this.s)}normalizeS(){return this.hasHighS()?new S(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return qc(this.toDERHex())}toDERHex(){return hl.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return qc(this.toCompactHex())}toCompactHex(){return v(this.r)+v(this.s)}}const k={isValidPrivateKey(W){try{return g(W),!0}catch{return!1}},normPrivateKeyToScalar:g,randomPrivateKey:()=>{const W=Nw(e.n);return _B(e.randomBytes(W),e.n)},precompute(W=8,G=f.BASE){return G._setWindowSize(W),G.multiply(BigInt(3)),G}};function R(W,G=!0){return f.fromPrivateKey(W).toRawBytes(G)}function _(W){const G=W instanceof Uint8Array,te=typeof W=="string",se=(G||te)&&W.length;return G?se===i||se===a:te?se===2*i||se===2*a:W instanceof f}function C(W,G,te=!0){if(_(W))throw new Error("first arg must be private key");if(!_(G))throw new Error("second arg must be public key");return f.fromHex(G).multiply(g(W)).toRawBytes(te)}const U=e.bits2int||function(W){const G=Pl(W),te=W.length*8-e.nBitLength;return te>0?G>>BigInt(te):G},O=e.bits2int_modN||function(W){return c(U(W))},B=s3(e.nBitLength);function F(W){if(typeof W!="bigint")throw new Error("bigint expected");if(!(yr<=W&&W<B))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Xc(W,e.nByteLength)}function M(W,G,te=j){if(["recovered","canonical"].some(Ne=>Ne in te))throw new Error("sign() legacy options not supported");const{hash:se,randomBytes:Z}=e;let{lowS:I,prehash:V,extraEntropy:ie}=te;I==null&&(I=!0),W=$s("msgHash",W),V&&(W=$s("prehashed msgHash",se(W)));const ce=O(W),ue=g(G),xe=[F(ue),F(ce)];if(ie!=null){const Ne=ie===!0?Z(t.BYTES):ie;xe.push($s("extraEntropy",Ne))}const ve=Ih(...xe),$e=ce;function ke(Ne){const Ke=U(Ne);if(!y(Ke))return;const Wt=h(Ke),vn=f.BASE.multiply(Ke).toAffine(),yt=c(vn.x);if(yt===yr)return;const Zt=c(Wt*c($e+yt*ue));if(Zt===yr)return;let ei=(vn.x===yt?0:2)|Number(vn.y&Ds),Ue=Zt;return I&&x(Zt)&&(Ue=b(Zt),ei^=1),new S(yt,Ue,ei)}return{seed:ve,k2sig:ke}}const j={lowS:e.lowS,prehash:!1},ae={lowS:e.lowS,prehash:!1};function ye(W,G,te=j){const{seed:se,k2sig:Z}=M(W,G,te),I=e;return Ow(I.hash.outputLen,I.nByteLength,I.hmac)(se,Z)}f.BASE._setWindowSize(8);function pe(W,G,te,se=ae){var vn;const Z=W;if(G=$s("msgHash",G),te=$s("publicKey",te),"strict"in se)throw new Error("options.strict was renamed to lowS");const{lowS:I,prehash:V}=se;let ie,ce;try{if(typeof Z=="string"||Z instanceof Uint8Array)try{ie=S.fromDER(Z)}catch(yt){if(!(yt instanceof hl.Err))throw yt;ie=S.fromCompact(Z)}else if(typeof Z=="object"&&typeof Z.r=="bigint"&&typeof Z.s=="bigint"){const{r:yt,s:Zt}=Z;ie=new S(yt,Zt)}else throw new Error("PARSE");ce=f.fromHex(te)}catch(yt){if(yt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(I&&ie.hasHighS())return!1;V&&(G=e.hash(G));const{r:ue,s:xe}=ie,ve=O(G),$e=h(xe),ke=c(ve*$e),Ne=c(ue*$e),Ke=(vn=f.BASE.multiplyAndAddUnsafe(ce,ke,Ne))==null?void 0:vn.toAffine();return Ke?c(Ke.x)===ue:!1}return{CURVE:e,getPublicKey:R,getSharedSecret:C,sign:ye,verify:pe,ProjectivePoint:f,Signature:S,utils:k}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function $B(s){return{hash:s,hmac:(e,...t)=>cw(s,e,R8(...t)),randomBytes:L8}}function HB(s,e){const t=n=>GB({...s,...$B(n)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Uw=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),eA=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),zB=BigInt(1),Xp=BigInt(2),tA=(s,e)=>(s+e/Xp)/e;function VB(s){const e=Uw,t=BigInt(3),n=BigInt(6),i=BigInt(11),a=BigInt(22),l=BigInt(23),c=BigInt(44),h=BigInt(88),f=s*s*s%e,g=f*f*s%e,m=As(g,t,e)*g%e,y=As(m,t,e)*g%e,v=As(y,Xp,e)*f%e,x=As(v,i,e)*v%e,b=As(x,a,e)*x%e,A=As(b,c,e)*b%e,S=As(A,h,e)*A%e,k=As(S,c,e)*b%e,R=As(k,t,e)*g%e,_=As(R,l,e)*x%e,C=As(_,n,e)*f%e,U=As(C,Xp,e);if(!Wp.eql(Wp.sqr(U),s))throw new Error("Cannot find square root");return U}const Wp=CB(Uw,void 0,void 0,{sqrt:VB}),sa=HB({a:BigInt(0),b:BigInt(7),Fp:Wp,n:eA,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:s=>{const e=eA,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-zB*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=t,l=BigInt("0x100000000000000000000000000000000"),c=tA(a*s,e),h=tA(-n*s,e);let f=zn(s-c*t-h*i,e),g=zn(-c*n-h*a,e);const m=f>l,y=g>l;if(m&&(f=e-f),y&&(g=e-g),f>l||g>l)throw new Error("splitScalar: Endomorphism failed, k="+s);return{k1neg:m,k1:f,k2neg:y,k2:g}}}},hw);BigInt(0);sa.ProjectivePoint;const Dh="0x0000000000000000000000000000000000000000",nA="0x0000000000000000000000000000000000000000000000000000000000000000",sA=BigInt(0),iA=BigInt(1),rA=BigInt(2),aA=BigInt(27),lA=BigInt(28),$0=BigInt(35),No={};function oA(s){return Ul(On(s),32)}var fc,dc,gc,Sl;const Fs=class Fs{constructor(e,t,n,i){ne(this,fc);ne(this,dc);ne(this,gc);ne(this,Sl);ef(e,No,"Signature"),P(this,fc,t),P(this,dc,n),P(this,gc,i),P(this,Sl,null)}get r(){return L(this,fc)}set r(e){H(Jo(e)===32,"invalid r","value",e),P(this,fc,Ae(e))}get s(){return L(this,dc)}set s(e){H(Jo(e)===32,"invalid s","value",e);const t=Ae(e);H(parseInt(t.substring(0,3))<8,"non-canonical s","value",t),P(this,dc,t)}get v(){return L(this,gc)}set v(e){const t=Ve(e,"value");H(t===27||t===28,"invalid v","v",e),P(this,gc,t)}get networkV(){return L(this,Sl)}get legacyChainId(){const e=this.networkV;return e==null?null:Fs.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=nt(this.s);return this.yParity&&(e[0]|=128),Ae(e)}get compactSerialized(){return Ht([this.r,this.yParityAndS])}get serialized(){return Ht([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this.s}", yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new Fs(No,this.r,this.s,this.v);return this.networkV&&P(e,Sl,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this.s,v:this.v}}static getChainId(e){const t=we(e,"v");return t==aA||t==lA?sA:(H(t>=$0,"invalid EIP-155 v","v",e),(t-$0)/rA)}static getChainIdV(e,t){return we(e)*rA+BigInt(35+t-27)}static getNormalizedV(e){const t=we(e);return t===sA||t===aA?27:t===iA||t===lA?28:(H(t>=$0,"invalid v","v",e),t&iA?27:28)}static from(e){function t(f,g){H(f,g,"signature",e)}if(e==null)return new Fs(No,nA,nA,27);if(typeof e=="string"){const f=nt(e,"signature");if(f.length===64){const g=Ae(f.slice(0,32)),m=f.slice(32,64),y=m[0]&128?28:27;return m[0]&=127,new Fs(No,g,Ae(m),y)}if(f.length===65){const g=Ae(f.slice(0,32)),m=f.slice(32,64);t((m[0]&128)===0,"non-canonical s");const y=Fs.getNormalizedV(f[64]);return new Fs(No,g,Ae(m),y)}t(!1,"invalid raw signature length")}if(e instanceof Fs)return e.clone();const n=e.r;t(n!=null,"missing r");const i=oA(n),a=function(f,g){if(f!=null)return oA(f);if(g!=null){t(Et(g,32),"invalid yParityAndS");const m=nt(g);return m[0]&=127,Ae(m)}t(!1,"missing s")}(e.s,e.yParityAndS);t((nt(a)[0]&128)==0,"non-canonical s");const{networkV:l,v:c}=function(f,g,m){if(f!=null){const y=we(f);return{networkV:y>=$0?y:void 0,v:Fs.getNormalizedV(y)}}if(g!=null)return t(Et(g,32),"invalid yParityAndS"),{v:nt(g)[0]&128?28:27};if(m!=null){switch(Ve(m,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),h=new Fs(No,i,a,c);return l&&P(h,Sl,l),t(e.yParity==null||Ve(e.yParity,"sig.yParity")===h.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===h.yParityAndS,"yParityAndS mismatch"),h}};fc=new WeakMap,dc=new WeakMap,gc=new WeakMap,Sl=new WeakMap;let Xs=Fs;var lr;const ol=class ol{constructor(e){ne(this,lr);H(Jo(e)===32,"invalid private key","privateKey","[REDACTED]"),P(this,lr,Ae(e))}get privateKey(){return L(this,lr)}get publicKey(){return ol.computePublicKey(L(this,lr))}get compressedPublicKey(){return ol.computePublicKey(L(this,lr),!0)}sign(e){H(Jo(e)===32,"invalid digest length","digest",e);const t=sa.sign(_n(e),_n(L(this,lr)),{lowS:!0});return Xs.from({r:ka(t.r,32),s:ka(t.s,32),v:t.recovery?28:27})}computeSharedSecret(e){const t=ol.computePublicKey(e);return Ae(sa.getSharedSecret(_n(L(this,lr)),nt(t),!1))}static computePublicKey(e,t){let n=nt(e,"key");if(n.length===32){const a=sa.getPublicKey(n,!!t);return Ae(a)}if(n.length===64){const a=new Uint8Array(65);a[0]=4,a.set(n,1),n=a}const i=sa.ProjectivePoint.fromHex(n);return Ae(i.toRawBytes(t))}static recoverPublicKey(e,t){H(Jo(e)===32,"invalid digest length","digest",e);const n=Xs.from(t);let i=sa.Signature.fromCompact(_n(Ht([n.r,n.s])));i=i.addRecoveryBit(n.yParity);const a=i.recoverPublicKey(_n(e));return H(a!=null,"invalid signautre for digest","signature",t),"0x"+a.toHex(!1)}static addPoints(e,t,n){const i=sa.ProjectivePoint.fromHex(ol.computePublicKey(e).substring(2)),a=sa.ProjectivePoint.fromHex(ol.computePublicKey(t).substring(2));return"0x"+i.add(a).toHex(!!n)}};lr=new WeakMap;let Ch=ol;const KB=BigInt(0),YB=BigInt(36);function cA(s){s=s.toLowerCase();const e=s.substring(2).split(""),t=new Uint8Array(40);for(let i=0;i<40;i++)t[i]=e[i].charCodeAt(0);const n=nt($t(t));for(let i=0;i<40;i+=2)n[i>>1]>>4>=8&&(e[i]=e[i].toUpperCase()),(n[i>>1]&15)>=8&&(e[i+1]=e[i+1].toUpperCase());return"0x"+e.join("")}const i3={};for(let s=0;s<10;s++)i3[String(s)]=String(s);for(let s=0;s<26;s++)i3[String.fromCharCode(65+s)]=String(10+s);const uA=15;function jB(s){s=s.toUpperCase(),s=s.substring(4)+s.substring(0,2)+"00";let e=s.split("").map(n=>i3[n]).join("");for(;e.length>=uA;){let n=e.substring(0,uA);e=parseInt(n,10)%97+e.substring(n.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const QB=function(){const s={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];s[t]=BigInt(e)}return s}();function qB(s){s=s.toLowerCase();let e=KB;for(let t=0;t<s.length;t++)e=e*YB+QB[s[t]];return e}function mt(s){if(H(typeof s=="string","invalid address","address",s),s.match(/^(0x)?[0-9a-fA-F]{40}$/)){s.startsWith("0x")||(s="0x"+s);const e=cA(s);return H(!s.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===s,"bad address checksum","address",s),e}if(s.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){H(s.substring(2,4)===jB(s),"bad icap checksum","address",s);let e=qB(s.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return cA("0x"+e)}H(!1,"invalid address","address",s)}function XB(s){const e=mt(s.from);let n=we(s.nonce,"tx.nonce").toString(16);return n==="0"?n="0x":n.length%2?n="0x0"+n:n="0x"+n,mt(Nt($t(Fl([e,n])),12))}function Fw(s){return s&&typeof s.getAddress=="function"}async function np(s,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(fe(typeof s!="string","unconfigured name","UNCONFIGURED_NAME",{value:s}),H(!1,"invalid AddressLike value; did not resolve to a value address","target",s)),mt(t)}function Pn(s,e){if(typeof s=="string")return s.match(/^0x[0-9a-f]{40}$/i)?mt(s):(fe(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),np(s,e.resolveName(s)));if(Fw(s))return np(s,s.getAddress());if(s&&typeof s.then=="function")return np(s,s);H(!1,"unsupported addressable value","target",s)}const er={};function be(s,e){let t=!1;return e<0&&(t=!0,e*=-1),new Rn(er,`${t?"":"u"}int${e}`,s,{signed:t,width:e})}function rt(s,e){return new Rn(er,`bytes${e||""}`,s,{size:e})}const hA=Symbol.for("_ethers_typed");var Tl;const tr=class tr{constructor(e,t,n,i){X(this,"type");X(this,"value");ne(this,Tl);X(this,"_typedSymbol");i==null&&(i=null),ef(er,e,"Typed"),Oe(this,{_typedSymbol:hA,type:t,value:n}),P(this,Tl,i),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return L(this,Tl)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return L(this,Tl)===!0?-1:L(this,Tl)===!1?this.value.length:null}static from(e,t){return new tr(er,e,t)}static uint8(e){return be(e,8)}static uint16(e){return be(e,16)}static uint24(e){return be(e,24)}static uint32(e){return be(e,32)}static uint40(e){return be(e,40)}static uint48(e){return be(e,48)}static uint56(e){return be(e,56)}static uint64(e){return be(e,64)}static uint72(e){return be(e,72)}static uint80(e){return be(e,80)}static uint88(e){return be(e,88)}static uint96(e){return be(e,96)}static uint104(e){return be(e,104)}static uint112(e){return be(e,112)}static uint120(e){return be(e,120)}static uint128(e){return be(e,128)}static uint136(e){return be(e,136)}static uint144(e){return be(e,144)}static uint152(e){return be(e,152)}static uint160(e){return be(e,160)}static uint168(e){return be(e,168)}static uint176(e){return be(e,176)}static uint184(e){return be(e,184)}static uint192(e){return be(e,192)}static uint200(e){return be(e,200)}static uint208(e){return be(e,208)}static uint216(e){return be(e,216)}static uint224(e){return be(e,224)}static uint232(e){return be(e,232)}static uint240(e){return be(e,240)}static uint248(e){return be(e,248)}static uint256(e){return be(e,256)}static uint(e){return be(e,256)}static int8(e){return be(e,-8)}static int16(e){return be(e,-16)}static int24(e){return be(e,-24)}static int32(e){return be(e,-32)}static int40(e){return be(e,-40)}static int48(e){return be(e,-48)}static int56(e){return be(e,-56)}static int64(e){return be(e,-64)}static int72(e){return be(e,-72)}static int80(e){return be(e,-80)}static int88(e){return be(e,-88)}static int96(e){return be(e,-96)}static int104(e){return be(e,-104)}static int112(e){return be(e,-112)}static int120(e){return be(e,-120)}static int128(e){return be(e,-128)}static int136(e){return be(e,-136)}static int144(e){return be(e,-144)}static int152(e){return be(e,-152)}static int160(e){return be(e,-160)}static int168(e){return be(e,-168)}static int176(e){return be(e,-176)}static int184(e){return be(e,-184)}static int192(e){return be(e,-192)}static int200(e){return be(e,-200)}static int208(e){return be(e,-208)}static int216(e){return be(e,-216)}static int224(e){return be(e,-224)}static int232(e){return be(e,-232)}static int240(e){return be(e,-240)}static int248(e){return be(e,-248)}static int256(e){return be(e,-256)}static int(e){return be(e,-256)}static bytes1(e){return rt(e,1)}static bytes2(e){return rt(e,2)}static bytes3(e){return rt(e,3)}static bytes4(e){return rt(e,4)}static bytes5(e){return rt(e,5)}static bytes6(e){return rt(e,6)}static bytes7(e){return rt(e,7)}static bytes8(e){return rt(e,8)}static bytes9(e){return rt(e,9)}static bytes10(e){return rt(e,10)}static bytes11(e){return rt(e,11)}static bytes12(e){return rt(e,12)}static bytes13(e){return rt(e,13)}static bytes14(e){return rt(e,14)}static bytes15(e){return rt(e,15)}static bytes16(e){return rt(e,16)}static bytes17(e){return rt(e,17)}static bytes18(e){return rt(e,18)}static bytes19(e){return rt(e,19)}static bytes20(e){return rt(e,20)}static bytes21(e){return rt(e,21)}static bytes22(e){return rt(e,22)}static bytes23(e){return rt(e,23)}static bytes24(e){return rt(e,24)}static bytes25(e){return rt(e,25)}static bytes26(e){return rt(e,26)}static bytes27(e){return rt(e,27)}static bytes28(e){return rt(e,28)}static bytes29(e){return rt(e,29)}static bytes30(e){return rt(e,30)}static bytes31(e){return rt(e,31)}static bytes32(e){return rt(e,32)}static address(e){return new tr(er,"address",e)}static bool(e){return new tr(er,"bool",!!e)}static bytes(e){return new tr(er,"bytes",e)}static string(e){return new tr(er,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new tr(er,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===hA}static dereference(e,t){if(tr.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};Tl=new WeakMap;let Rn=tr;class WB extends kr{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let n=Rn.dereference(t,"string");try{n=mt(n)}catch(i){return this._throwError(i.message,t)}return e.writeValue(n)}decode(e){return mt(ka(e.readValue(),20))}}class ZB extends kr{constructor(t){super(t.name,t.type,"_",t.dynamic);X(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,n){return this.coder.encode(t,n)}decode(t){return this.coder.decode(t)}}function Gw(s,e,t){let n=[];if(Array.isArray(t))n=t;else if(t&&typeof t=="object"){let h={};n=e.map(f=>{const g=f.localName;return fe(g,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:f},value:t}),fe(!h[g],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:f},value:t}),h[g]=!0,t[g]})}else H(!1,"invalid tuple value","tuple",t);H(e.length===n.length,"types/value length mismatch","tuple",t);let i=new Vp,a=new Vp,l=[];e.forEach((h,f)=>{let g=n[f];if(h.dynamic){let m=a.length;h.encode(a,g);let y=i.writeUpdatableValue();l.push(v=>{y(v+m)})}else h.encode(i,g)}),l.forEach(h=>{h(i.length)});let c=s.appendWriter(i);return c+=s.appendWriter(a),c}function $w(s,e){let t=[],n=[],i=s.subReader(0);return e.forEach(a=>{let l=null;if(a.dynamic){let c=s.readIndex(),h=i.subReader(c);try{l=a.decode(h)}catch(f){if(pn(f,"BUFFER_OVERRUN"))throw f;l=f,l.baseType=a.name,l.name=a.localName,l.type=a.type}}else try{l=a.decode(s)}catch(c){if(pn(c,"BUFFER_OVERRUN"))throw c;l=c,l.baseType=a.name,l.name=a.localName,l.type=a.type}if(l==null)throw new Error("investigate");t.push(l),n.push(a.localName||null)}),Yc.fromItems(t,n)}class JB extends kr{constructor(t,n,i){const a=t.type+"["+(n>=0?n:"")+"]",l=n===-1||t.dynamic;super("array",a,i,l);X(this,"coder");X(this,"length");Oe(this,{coder:t,length:n})}defaultValue(){const t=this.coder.defaultValue(),n=[];for(let i=0;i<this.length;i++)n.push(t);return n}encode(t,n){const i=Rn.dereference(n,"array");Array.isArray(i)||this._throwError("expected array value",i);let a=this.length;a===-1&&(a=i.length,t.writeValue(i.length)),YT(i.length,a,"coder array"+(this.localName?" "+this.localName:""));let l=[];for(let c=0;c<i.length;c++)l.push(this.coder);return Gw(t,l,i)}decode(t){let n=this.length;n===-1&&(n=t.readIndex(),fe(n*Mn<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:n*Mn,length:t.dataLength}));let i=[];for(let a=0;a<n;a++)i.push(new ZB(this.coder));return $w(t,i)}}class e4 extends kr{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const n=Rn.dereference(t,"bool");return e.writeValue(n?1:0)}decode(e){return!!e.readValue()}}class Hw extends kr{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=_n(t);let n=e.writeValue(t.length);return n+=e.writeBytes(t),n}decode(e){return e.readBytes(e.readIndex(),!0)}}class t4 extends Hw{constructor(e){super("bytes",e)}decode(e){return Ae(super.decode(e))}}class n4 extends kr{constructor(t,n){let i="bytes"+String(t);super(i,i,n,!1);X(this,"size");Oe(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,n){let i=_n(Rn.dereference(n,this.type));return i.length!==this.size&&this._throwError("incorrect data length",n),t.writeBytes(i)}decode(t){return Ae(t.readBytes(this.size))}}const s4=new Uint8Array([]);class i4 extends kr{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(s4)}decode(e){return e.readBytes(0),null}}const r4=BigInt(0),a4=BigInt(1),l4=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class o4 extends kr{constructor(t,n,i){const a=(n?"int":"uint")+t*8;super(a,a,i,!1);X(this,"size");X(this,"signed");Oe(this,{size:t,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,n){let i=we(Rn.dereference(n,this.type)),a=ul(l4,Mn*8);if(this.signed){let l=ul(a,this.size*8-1);(i>l||i<-(l+a4))&&this._throwError("value out-of-bounds",n),i=qT(i,8*Mn)}else(i<r4||i>ul(a,this.size*8))&&this._throwError("value out-of-bounds",n);return t.writeValue(i)}decode(t){let n=ul(t.readValue(),this.size*8);return this.signed&&(n=wd(n,this.size*8)),n}}class c4 extends Hw{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,br(Rn.dereference(t,"string")))}decode(e){return Rd(super.decode(e))}}class H0 extends kr{constructor(t,n){let i=!1;const a=[];t.forEach(c=>{c.dynamic&&(i=!0),a.push(c.type)});const l="tuple("+a.join(",")+")";super("tuple",l,n,i);X(this,"coders");Oe(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(i=>{t.push(i.defaultValue())});const n=this.coders.reduce((i,a)=>{const l=a.localName;return l&&(i[l]||(i[l]=0),i[l]++),i},{});return this.coders.forEach((i,a)=>{let l=i.localName;!l||n[l]!==1||(l==="length"&&(l="_length"),t[l]==null&&(t[l]=t[a]))}),Object.freeze(t)}encode(t,n){const i=Rn.dereference(n,"tuple");return Gw(t,this.coders,i)}decode(t){return $w(t,this.coders)}}function Gl(s){return $t(br(s))}var u4="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const fA=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),dA=4;function h4(s){let e=0;function t(){return s[e++]<<8|s[e++]}let n=t(),i=1,a=[0,1];for(let C=1;C<n;C++)a.push(i+=t());let l=t(),c=e;e+=l;let h=0,f=0;function g(){return h==0&&(f=f<<8|s[e++],h=8),f>>--h&1}const m=31,y=2**m,v=y>>>1,x=v>>1,b=y-1;let A=0;for(let C=0;C<m;C++)A=A<<1|g();let S=[],k=0,R=y;for(;;){let C=Math.floor(((A-k+1)*i-1)/R),U=0,O=n;for(;O-U>1;){let M=U+O>>>1;C<a[M]?O=M:U=M}if(U==0)break;S.push(U);let B=k+Math.floor(R*a[U]/i),F=k+Math.floor(R*a[U+1]/i)-1;for(;((B^F)&v)==0;)A=A<<1&b|g(),B=B<<1&b,F=F<<1&b|1;for(;B&~F&x;)A=A&v|A<<1&b>>>1|g(),B=B<<1^v,F=(F^v)<<1|v|1;k=B,R=1+F-B}let _=n-4;return S.map(C=>{switch(C-_){case 3:return _+65792+(s[c++]<<16|s[c++]<<8|s[c++]);case 2:return _+256+(s[c++]<<8|s[c++]);case 1:return _+s[c++];default:return C-1}})}function f4(s){let e=0;return()=>s[e++]}function zw(s){return f4(h4(d4(s)))}function d4(s){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((i,a)=>e[i.charCodeAt(0)]=a);let t=s.length,n=new Uint8Array(6*t>>3);for(let i=0,a=0,l=0,c=0;i<t;i++)c=c<<6|e[s.charCodeAt(i)],l+=6,l>=8&&(n[a++]=c>>(l-=8));return n}function g4(s){return s&1?~s>>1:s>>1}function m4(s,e){let t=Array(s);for(let n=0,i=0;n<s;n++)t[n]=i+=g4(e());return t}function _h(s,e=0){let t=[];for(;;){let n=s(),i=s();if(!i)break;e+=n;for(let a=0;a<i;a++)t.push(e+a);e+=i+1}return t}function Vw(s){return Oh(()=>{let e=_h(s);if(e.length)return e})}function Kw(s){let e=[];for(;;){let t=s();if(t==0)break;e.push(p4(t,s))}for(;;){let t=s()-1;if(t<0)break;e.push(y4(t,s))}return e.flat()}function Oh(s){let e=[];for(;;){let t=s(e.length);if(!t)break;e.push(t)}return e}function Yw(s,e,t){let n=Array(s).fill().map(()=>[]);for(let i=0;i<e;i++)m4(s,t).forEach((a,l)=>n[l].push(a));return n}function p4(s,e){let t=1+e(),n=e(),i=Oh(e);return Yw(i.length,1+s,e).flatMap((l,c)=>{let[h,...f]=l;return Array(i[c]).fill().map((g,m)=>{let y=m*n;return[h+m*t,f.map(v=>v+y)]})})}function y4(s,e){let t=1+e();return Yw(t,1+s,e).map(i=>[i[0],i.slice(1)])}function v4(s){let e=[],t=_h(s);return i(n([]),[]),e;function n(a){let l=s(),c=Oh(()=>{let h=_h(s).map(f=>t[f]);if(h.length)return n(h)});return{S:l,B:c,Q:a}}function i({S:a,B:l},c,h){if(!(a&4&&h===c[c.length-1])){a&2&&(h=c[c.length-1]),a&1&&e.push(c);for(let f of l)for(let g of f.Q)i(f,[...c,g],h)}}}function x4(s){return s.toString(16).toUpperCase().padStart(2,"0")}function jw(s){return`{${x4(s)}}`}function E4(s){let e=[];for(let t=0,n=s.length;t<n;){let i=s.codePointAt(t);t+=i<65536?1:2,e.push(i)}return e}function Wc(s){let t=s.length;if(t<4096)return String.fromCodePoint(...s);let n=[];for(let i=0;i<t;)n.push(String.fromCodePoint(...s.slice(i,i+=4096)));return n.join("")}function b4(s,e){let t=s.length,n=t-e.length;for(let i=0;n==0&&i<t;i++)n=s[i]-e[i];return n}var A4="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const Mh=44032,Id=4352,Dd=4449,Cd=4519,Qw=19,qw=21,Zc=28,_d=qw*Zc,S4=Qw*_d,T4=Mh+S4,w4=Id+Qw,R4=Dd+qw,L4=Cd+Zc;function hh(s){return s>>24&255}function Xw(s){return s&16777215}let Zp,gA,Jp,id;function k4(){let s=zw(A4);Zp=new Map(Vw(s).flatMap((e,t)=>e.map(n=>[n,t+1<<24]))),gA=new Set(_h(s)),Jp=new Map,id=new Map;for(let[e,t]of Kw(s)){if(!gA.has(e)&&t.length==2){let[n,i]=t,a=id.get(n);a||(a=new Map,id.set(n,a)),a.set(i,e)}Jp.set(e,t.reverse())}}function Ww(s){return s>=Mh&&s<T4}function I4(s,e){if(s>=Id&&s<w4&&e>=Dd&&e<R4)return Mh+(s-Id)*_d+(e-Dd)*Zc;if(Ww(s)&&e>Cd&&e<L4&&(s-Mh)%Zc==0)return s+(e-Cd);{let t=id.get(s);return t&&(t=t.get(e),t)?t:-1}}function Zw(s){Zp||k4();let e=[],t=[],n=!1;function i(a){let l=Zp.get(a);l&&(n=!0,a|=l),e.push(a)}for(let a of s)for(;;){if(a<128)e.push(a);else if(Ww(a)){let l=a-Mh,c=l/_d|0,h=l%_d/Zc|0,f=l%Zc;i(Id+c),i(Dd+h),f>0&&i(Cd+f)}else{let l=Jp.get(a);l?t.push(...l):i(a)}if(!t.length)break;a=t.pop()}if(n&&e.length>1){let a=hh(e[0]);for(let l=1;l<e.length;l++){let c=hh(e[l]);if(c==0||a<=c){a=c;continue}let h=l-1;for(;;){let f=e[h+1];if(e[h+1]=e[h],e[h]=f,!h||(a=hh(e[--h]),a<=c))break}a=hh(e[l])}}return e}function D4(s){let e=[],t=[],n=-1,i=0;for(let a of s){let l=hh(a),c=Xw(a);if(n==-1)l==0?n=c:e.push(c);else if(i>0&&i>=l)l==0?(e.push(n,...t),t.length=0,n=c):t.push(c),i=l;else{let h=I4(n,c);h>=0?n=h:i==0&&l==0?(e.push(n),n=c):(t.push(c),i=l)}}return n>=0&&e.push(n,...t),e}function Jw(s){return Zw(s).map(Xw)}function C4(s){return D4(Zw(s))}const mA=45,eR=".",tR=65039,nR=1,Od=s=>Array.from(s);function Ph(s,e){return s.P.has(e)||s.Q.has(e)}class _4 extends Array{get is_emoji(){return!0}}let ey,sR,fl,ty,iR,tc,sp,Fo,rl,pA,ny;function r3(){if(ey)return;let s=zw(u4);const e=()=>_h(s),t=()=>new Set(e()),n=(g,m)=>m.forEach(y=>g.add(y));ey=new Map(Kw(s)),sR=t(),fl=e(),ty=new Set(e().map(g=>fl[g])),fl=new Set(fl),iR=t(),t();let i=Vw(s),a=s();const l=()=>{let g=new Set;return e().forEach(m=>n(g,i[m])),n(g,e()),g};tc=Oh(g=>{let m=Oh(s).map(y=>y+96);if(m.length){let y=g>=a;m[0]-=32,m=Wc(m),y&&(m=`Restricted[${m}]`);let v=l(),x=l(),b=!s();return{N:m,P:v,Q:x,M:b,R:y}}}),sp=t(),Fo=new Map;let c=e().concat(Od(sp)).sort((g,m)=>g-m);c.forEach((g,m)=>{let y=s(),v=c[m]=y?c[m-y]:{V:[],M:new Map};v.V.push(g),sp.has(g)||Fo.set(g,v)});for(let{V:g,M:m}of new Set(Fo.values())){let y=[];for(let x of g){let b=tc.filter(S=>Ph(S,x)),A=y.find(({G:S})=>b.some(k=>S.has(k)));A||(A={G:new Set,V:[]},y.push(A)),A.V.push(x),n(A.G,b)}let v=y.flatMap(x=>Od(x.G));for(let{G:x,V:b}of y){let A=new Set(v.filter(S=>!x.has(S)));for(let S of b)m.set(S,A)}}rl=new Set;let h=new Set;const f=g=>rl.has(g)?h.add(g):rl.add(g);for(let g of tc){for(let m of g.P)f(m);for(let m of g.Q)f(m)}for(let g of rl)!Fo.has(g)&&!h.has(g)&&Fo.set(g,nR);n(rl,Jw(rl)),pA=v4(s).map(g=>_4.from(g)).sort(b4),ny=new Map;for(let g of pA){let m=[ny];for(let y of g){let v=m.map(x=>{let b=x.get(y);return b||(b=new Map,x.set(y,b)),b});y===tR?m.push(...v):m=v}for(let y of m)y.V=g}}function a3(s){return(rR(s)?"":`${l3(s2([s]))} `)+jw(s)}function l3(s){return`"${s}"‎`}function O4(s){if(s.length>=4&&s[2]==mA&&s[3]==mA)throw new Error(`invalid label extension: "${Wc(s.slice(0,4))}"`)}function M4(s){for(let t=s.lastIndexOf(95);t>0;)if(s[--t]!==95)throw new Error("underscore allowed only at start")}function P4(s){let e=s[0],t=fA.get(e);if(t)throw vh(`leading ${t}`);let n=s.length,i=-1;for(let a=1;a<n;a++){e=s[a];let l=fA.get(e);if(l){if(i==a)throw vh(`${t} + ${l}`);i=a+1,t=l}}if(i==n)throw vh(`trailing ${t}`)}function s2(s,e=1/0,t=jw){let n=[];N4(s[0])&&n.push("◌"),s.length>e&&(e>>=1,s=[...s.slice(0,e),8230,...s.slice(-e)]);let i=0,a=s.length;for(let l=0;l<a;l++){let c=s[l];rR(c)&&(n.push(Wc(s.slice(i,l))),n.push(t(c)),i=l+1)}return n.push(Wc(s.slice(i,a))),n.join("")}function N4(s){return r3(),fl.has(s)}function rR(s){return r3(),iR.has(s)}function B4(s){return $4(U4(s,C4,V4))}function U4(s,e,t){if(!s)return[];r3();let n=0;return s.split(eR).map(i=>{let a=E4(i),l={input:a,offset:n};n+=a.length+1;try{let c=l.tokens=z4(a,e,t),h=c.length,f;if(!h)throw new Error("empty label");let g=l.output=c.flat();if(M4(g),!(l.emoji=h>1||c[0].is_emoji)&&g.every(y=>y<128))O4(g),f="ASCII";else{let y=c.flatMap(v=>v.is_emoji?[]:v);if(!y.length)f="Emoji";else{if(fl.has(g[0]))throw vh("leading combining mark");for(let b=1;b<h;b++){let A=c[b];if(!A.is_emoji&&fl.has(A[0]))throw vh(`emoji + combining mark: "${Wc(c[b-1])} + ${s2([A[0]])}"`)}P4(g);let v=Od(new Set(y)),[x]=G4(v);H4(x,y),F4(x,v),f=x.N}}l.type=f}catch(c){l.error=c}return l})}function F4(s,e){let t,n=[];for(let i of e){let a=Fo.get(i);if(a===nR)return;if(a){let l=a.M.get(i);if(t=t?t.filter(c=>l.has(c)):Od(l),!t.length)return}else n.push(i)}if(t){for(let i of t)if(n.every(a=>Ph(i,a)))throw new Error(`whole-script confusable: ${s.N}/${i.N}`)}}function G4(s){let e=tc;for(let t of s){let n=e.filter(i=>Ph(i,t));if(!n.length)throw tc.some(i=>Ph(i,t))?lR(e[0],t):aR(t);if(e=n,n.length==1)break}return e}function $4(s){return s.map(({input:e,error:t,output:n})=>{if(t){let i=t.message;throw new Error(s.length==1?i:`Invalid label ${l3(s2(e,63))}: ${i}`)}return Wc(n)}).join(eR)}function aR(s){return new Error(`disallowed character: ${a3(s)}`)}function lR(s,e){let t=a3(e),n=tc.find(i=>i.P.has(e));return n&&(t=`${n.N} ${t}`),new Error(`illegal mixture: ${s.N} + ${t}`)}function vh(s){return new Error(`illegal placement: ${s}`)}function H4(s,e){for(let t of e)if(!Ph(s,t))throw lR(s,t);if(s.M){let t=Jw(e);for(let n=1,i=t.length;n<i;n++)if(ty.has(t[n])){let a=n+1;for(let l;a<i&&ty.has(l=t[a]);a++)for(let c=n;c<a;c++)if(t[c]==l)throw new Error(`duplicate non-spacing marks: ${a3(l)}`);if(a-n>dA)throw new Error(`excessive non-spacing marks: ${l3(s2(t.slice(n-1,a)))} (${a-n}/${dA})`);n=a}}}function z4(s,e,t){let n=[],i=[];for(s=s.slice().reverse();s.length;){let a=K4(s);if(a)i.length&&(n.push(e(i)),i=[]),n.push(t(a));else{let l=s.pop();if(rl.has(l))i.push(l);else{let c=ey.get(l);if(c)i.push(...c);else if(!sR.has(l))throw aR(l)}}}return i.length&&n.push(e(i)),n}function V4(s){return s.filter(e=>e!=tR)}function K4(s,e){let t=ny,n,i=s.length;for(;i&&(t=t.get(s[--i]),!!t);){let{V:a}=t;a&&(n=a,s.length=i)}return n}const oR=new Uint8Array(32);oR.fill(0);function yA(s){return H(s.length!==0,"invalid ENS name; empty component","comp",s),s}function cR(s){const e=br(Y4(s)),t=[];if(s.length===0)return t;let n=0;for(let i=0;i<e.length;i++)e[i]===46&&(t.push(yA(e.slice(n,i))),n=i+1);return H(n<e.length,"invalid ENS name; empty component","name",s),t.push(yA(e.slice(n))),t}function Y4(s){try{if(s.length===0)throw new Error("empty label");return B4(s)}catch(e){H(!1,`invalid ENS name (${e.message})`,"name",s)}}function sy(s){H(typeof s=="string","invalid ENS name; not a string","name",s),H(s.length,"invalid ENS name (empty label)","name",s);let e=oR;const t=cR(s);for(;t.length;)e=$t(Ht([e,$t(t.pop())]));return Ae(e)}function j4(s,e){const t=e;return H(t<=255,"DNS encoded label cannot exceed 255","length",t),Ae(Ht(cR(s).map(n=>{H(n.length<=t,`label ${JSON.stringify(s)} exceeds ${t} bytes`,"name",s);const i=new Uint8Array(n.length+1);return i.set(n,1),i[0]=i.length-1,i})))+"00"}function ip(s,e){return{address:mt(s),storageKeys:e.map((t,n)=>(H(Et(t,32),"invalid slot",`storageKeys[${n}]`,t),t.toLowerCase()))}}function Yl(s){if(Array.isArray(s))return s.map((t,n)=>Array.isArray(t)?(H(t.length===2,"invalid slot set",`value[${n}]`,t),ip(t[0],t[1])):(H(t!=null&&typeof t=="object","invalid address-slot set","value",s),ip(t.address,t.storageKeys)));H(s!=null&&typeof s=="object","invalid access list","value",s);const e=Object.keys(s).map(t=>{const n=s[t].reduce((i,a)=>(i[a]=!0,i),{});return ip(t,Object.keys(n).sort())});return e.sort((t,n)=>t.address.localeCompare(n.address)),e}function Q4(s){let e;return typeof s=="string"?e=Ch.computePublicKey(s,!1):e=s.publicKey,mt($t("0x"+e.substring(4)).substring(26))}function q4(s,e){return Q4(Ch.recoverPublicKey(s,e))}const an=BigInt(0),X4=BigInt(2),W4=BigInt(27),Z4=BigInt(28),J4=BigInt(35),eU=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),rp=4096*32;function vA(s,e){let t=s.toString(16);for(;t.length<2;)t="0"+t;return t+=tu(e).substring(4),"0x"+t}function i2(s){return s==="0x"?null:mt(s)}function o3(s,e){try{return Yl(s)}catch(t){H(!1,t.message,e,s)}}function sf(s,e){return s==="0x"?0:Ve(s,e)}function Gt(s,e){if(s==="0x")return an;const t=we(s,e);return H(t<=eU,"value exceeds uint size",e,t),t}function At(s,e){const t=we(s,"value"),n=On(t);return H(n.length<=32,"value too large",`tx.${e}`,t),n}function c3(s){return Yl(s).map(e=>[e.address,e.storageKeys])}function tU(s,e){H(Array.isArray(s),`invalid ${e}`,"value",s);for(let t=0;t<s.length;t++)H(Et(s[t],32),"invalid ${ param } hash",`value[${t}]`,s[t]);return s}function nU(s){const e=Jd(s);H(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",s);const t={type:0,nonce:sf(e[0],"nonce"),gasPrice:Gt(e[1],"gasPrice"),gasLimit:Gt(e[2],"gasLimit"),to:i2(e[3]),value:Gt(e[4],"value"),data:Ae(e[5]),chainId:an};if(e.length===6)return t;const n=Gt(e[6],"v"),i=Gt(e[7],"r"),a=Gt(e[8],"s");if(i===an&&a===an)t.chainId=n;else{let l=(n-J4)/X4;l<an&&(l=an),t.chainId=l,H(l!==an||n===W4||n===Z4,"non-canonical legacy v","v",e[6]),t.signature=Xs.from({r:Ul(e[7],32),s:Ul(e[8],32),v:n})}return t}function sU(s,e){const t=[At(s.nonce,"nonce"),At(s.gasPrice||0,"gasPrice"),At(s.gasLimit,"gasLimit"),s.to||"0x",At(s.value,"value"),s.data];let n=an;if(s.chainId!=an)n=we(s.chainId,"tx.chainId"),H(!e||e.networkV==null||e.legacyChainId===n,"tx.chainId/sig.v mismatch","sig",e);else if(s.signature){const a=s.signature.legacyChainId;a!=null&&(n=a)}if(!e)return n!==an&&(t.push(On(n)),t.push("0x"),t.push("0x")),Fl(t);let i=BigInt(27+e.yParity);return n!==an?i=Xs.getChainIdV(n,e.v):BigInt(e.v)!==i&&H(!1,"tx.chainId/sig.v mismatch","sig",e),t.push(On(i)),t.push(On(e.r)),t.push(On(e.s)),Fl(t)}function u3(s,e){let t;try{if(t=sf(e[0],"yParity"),t!==0&&t!==1)throw new Error("bad yParity")}catch{H(!1,"invalid yParity","yParity",e[0])}const n=Ul(e[1],32),i=Ul(e[2],32),a=Xs.from({r:n,s:i,yParity:t});s.signature=a}function iU(s){const e=Jd(nt(s).slice(1));H(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",Ae(s));const t={type:2,chainId:Gt(e[0],"chainId"),nonce:sf(e[1],"nonce"),maxPriorityFeePerGas:Gt(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Gt(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Gt(e[4],"gasLimit"),to:i2(e[5]),value:Gt(e[6],"value"),data:Ae(e[7]),accessList:o3(e[8],"accessList")};return e.length===9||u3(t,e.slice(9)),t}function rU(s,e){const t=[At(s.chainId,"chainId"),At(s.nonce,"nonce"),At(s.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),At(s.maxFeePerGas||0,"maxFeePerGas"),At(s.gasLimit,"gasLimit"),s.to||"0x",At(s.value,"value"),s.data,c3(s.accessList||[])];return e&&(t.push(At(e.yParity,"yParity")),t.push(On(e.r)),t.push(On(e.s))),Ht(["0x02",Fl(t)])}function aU(s){const e=Jd(nt(s).slice(1));H(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",Ae(s));const t={type:1,chainId:Gt(e[0],"chainId"),nonce:sf(e[1],"nonce"),gasPrice:Gt(e[2],"gasPrice"),gasLimit:Gt(e[3],"gasLimit"),to:i2(e[4]),value:Gt(e[5],"value"),data:Ae(e[6]),accessList:o3(e[7],"accessList")};return e.length===8||u3(t,e.slice(8)),t}function lU(s,e){const t=[At(s.chainId,"chainId"),At(s.nonce,"nonce"),At(s.gasPrice||0,"gasPrice"),At(s.gasLimit,"gasLimit"),s.to||"0x",At(s.value,"value"),s.data,c3(s.accessList||[])];return e&&(t.push(At(e.yParity,"recoveryParam")),t.push(On(e.r)),t.push(On(e.s))),Ht(["0x01",Fl(t)])}function oU(s){let e=Jd(nt(s).slice(1)),t="3",n=null;if(e.length===4&&Array.isArray(e[0])){t="3 (network format)";const a=e[1],l=e[2],c=e[3];H(Array.isArray(a),"invalid network format: blobs not an array","fields[1]",a),H(Array.isArray(l),"invalid network format: commitments not an array","fields[2]",l),H(Array.isArray(c),"invalid network format: proofs not an array","fields[3]",c),H(a.length===l.length,"invalid network format: blobs/commitments length mismatch","fields",e),H(a.length===c.length,"invalid network format: blobs/proofs length mismatch","fields",e),n=[];for(let h=0;h<e[1].length;h++)n.push({data:a[h],commitment:l[h],proof:c[h]});e=e[0]}H(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${t}`,"data",Ae(s));const i={type:3,chainId:Gt(e[0],"chainId"),nonce:sf(e[1],"nonce"),maxPriorityFeePerGas:Gt(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Gt(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Gt(e[4],"gasLimit"),to:i2(e[5]),value:Gt(e[6],"value"),data:Ae(e[7]),accessList:o3(e[8],"accessList"),maxFeePerBlobGas:Gt(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};n&&(i.blobs=n),H(i.to!=null,`invalid address for transaction type: ${t}`,"data",s),H(Array.isArray(i.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",s);for(let a=0;a<i.blobVersionedHashes.length;a++)H(Et(i.blobVersionedHashes[a],32),`invalid blobVersionedHash at index ${a}: must be length 32`,"data",s);return e.length===11||u3(i,e.slice(11)),i}function cU(s,e,t){const n=[At(s.chainId,"chainId"),At(s.nonce,"nonce"),At(s.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),At(s.maxFeePerGas||0,"maxFeePerGas"),At(s.gasLimit,"gasLimit"),s.to||Dh,At(s.value,"value"),s.data,c3(s.accessList||[]),At(s.maxFeePerBlobGas||0,"maxFeePerBlobGas"),tU(s.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(n.push(At(e.yParity,"yParity")),n.push(On(e.r)),n.push(On(e.s)),t)?Ht(["0x03",Fl([n,t.map(i=>i.data),t.map(i=>i.commitment),t.map(i=>i.proof)])]):Ht(["0x03",Fl(n)])}var di,mc,pc,yc,vc,xc,Ec,bc,Ac,Sc,Tc,wc,wl,ua,or,ha,Rc,rd;const nr=class nr{constructor(){ne(this,Rc);ne(this,di);ne(this,mc);ne(this,pc);ne(this,yc);ne(this,vc);ne(this,xc);ne(this,Ec);ne(this,bc);ne(this,Ac);ne(this,Sc);ne(this,Tc);ne(this,wc);ne(this,wl);ne(this,ua);ne(this,or);ne(this,ha);P(this,di,null),P(this,mc,null),P(this,yc,0),P(this,vc,an),P(this,xc,null),P(this,Ec,null),P(this,bc,null),P(this,pc,"0x"),P(this,Ac,an),P(this,Sc,an),P(this,Tc,null),P(this,wc,null),P(this,wl,null),P(this,ua,null),P(this,ha,null),P(this,or,null)}get type(){return L(this,di)}set type(e){switch(e){case null:P(this,di,null);break;case 0:case"legacy":P(this,di,0);break;case 1:case"berlin":case"eip-2930":P(this,di,1);break;case 2:case"london":case"eip-1559":P(this,di,2);break;case 3:case"cancun":case"eip-4844":P(this,di,3);break;default:H(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844"}return null}get to(){const e=L(this,mc);return e==null&&this.type===3?Dh:e}set to(e){P(this,mc,e==null?null:mt(e))}get nonce(){return L(this,yc)}set nonce(e){P(this,yc,Ve(e,"value"))}get gasLimit(){return L(this,vc)}set gasLimit(e){P(this,vc,we(e))}get gasPrice(){const e=L(this,xc);return e==null&&(this.type===0||this.type===1)?an:e}set gasPrice(e){P(this,xc,e==null?null:we(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=L(this,Ec);return e??(this.type===2||this.type===3?an:null)}set maxPriorityFeePerGas(e){P(this,Ec,e==null?null:we(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=L(this,bc);return e??(this.type===2||this.type===3?an:null)}set maxFeePerGas(e){P(this,bc,e==null?null:we(e,"maxFeePerGas"))}get data(){return L(this,pc)}set data(e){P(this,pc,Ae(e))}get value(){return L(this,Ac)}set value(e){P(this,Ac,we(e,"value"))}get chainId(){return L(this,Sc)}set chainId(e){P(this,Sc,we(e))}get signature(){return L(this,Tc)||null}set signature(e){P(this,Tc,e==null?null:Xs.from(e))}get accessList(){const e=L(this,wc)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){P(this,wc,e==null?null:Yl(e))}get maxFeePerBlobGas(){const e=L(this,wl);return e==null&&this.type===3?an:e}set maxFeePerBlobGas(e){P(this,wl,e==null?null:we(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=L(this,ua);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){H(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)H(Et(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}P(this,ua,e)}get blobs(){return L(this,ha)==null?null:L(this,ha).map(e=>Object.assign({},e))}set blobs(e){if(e==null){P(this,ha,null);return}const t=[],n=[];for(let i=0;i<e.length;i++){const a=e[i];if(Xy(a)){fe(L(this,or),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let l=nt(a);if(H(l.length<=rp,"blob is too large",`blobs[${i}]`,a),l.length!==rp){const f=new Uint8Array(rp);f.set(l),l=f}const c=L(this,or).blobToKzgCommitment(l),h=Ae(L(this,or).computeBlobKzgProof(l,c));t.push({data:Ae(l),commitment:Ae(c),proof:h}),n.push(vA(1,c))}else{const l=Ae(a.commitment);t.push({data:Ae(a.data),commitment:l,proof:Ae(a.proof)}),n.push(vA(1,l))}}P(this,ha,t),P(this,ua,n)}get kzg(){return L(this,or)}set kzg(e){P(this,or,e)}get hash(){return this.signature==null?null:$t(ge(this,Rc,rd).call(this,!0,!1))}get unsignedHash(){return $t(this.unsignedSerialized)}get from(){return this.signature==null?null:q4(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:Ch.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}get serialized(){return ge(this,Rc,rd).call(this,!0,!0)}get unsignedSerialized(){return ge(this,Rc,rd).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,t=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,n=this.accessList!=null,i=L(this,wl)!=null||L(this,ua);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&fe(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),fe(!t||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),fe(this.type!==0||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const a=[];return this.type!=null?a.push(this.type):t?a.push(2):e?(a.push(1),n||a.push(0)):n?(a.push(1),a.push(2)):(i&&this.to||(a.push(0),a.push(1),a.push(2)),a.push(3)),a.sort(),a}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return nr.from(this)}toJSON(){const e=t=>t==null?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new nr;if(typeof e=="string"){const n=nt(e);if(n[0]>=127)return nr.from(nU(n));switch(n[0]){case 1:return nr.from(aU(n));case 2:return nr.from(iU(n));case 3:return nr.from(oU(n))}fe(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const t=new nr;return e.type!=null&&(t.type=e.type),e.to!=null&&(t.to=e.to),e.nonce!=null&&(t.nonce=e.nonce),e.gasLimit!=null&&(t.gasLimit=e.gasLimit),e.gasPrice!=null&&(t.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(t.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(t.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(t.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(t.data=e.data),e.value!=null&&(t.value=e.value),e.chainId!=null&&(t.chainId=e.chainId),e.signature!=null&&(t.signature=Xs.from(e.signature)),e.accessList!=null&&(t.accessList=e.accessList),e.blobVersionedHashes!=null&&(t.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(t.kzg=e.kzg),e.blobs!=null&&(t.blobs=e.blobs),e.hash!=null&&(H(t.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),H(t.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(H(t.isSigned(),"unsigned transaction cannot define '.from'","tx",e),H(t.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),t}};di=new WeakMap,mc=new WeakMap,pc=new WeakMap,yc=new WeakMap,vc=new WeakMap,xc=new WeakMap,Ec=new WeakMap,bc=new WeakMap,Ac=new WeakMap,Sc=new WeakMap,Tc=new WeakMap,wc=new WeakMap,wl=new WeakMap,ua=new WeakMap,or=new WeakMap,ha=new WeakMap,Rc=new WeakSet,rd=function(e,t){fe(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=e?this.signature:null;switch(this.inferType()){case 0:return sU(this,n);case 1:return lU(this,n);case 2:return rU(this,n);case 3:return cU(this,n,t?this.blobs:null)}fe(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let Md=nr;const uR=new Uint8Array(32);uR.fill(0);const uU=BigInt(-1),hR=BigInt(0),fR=BigInt(1),hU=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function fU(s){const e=nt(s),t=e.length%32;return t?Ht([e,uR.slice(t)]):Ae(e)}const dU=ka(fR,32),gU=ka(hR,32),xA={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},ap=["name","version","chainId","verifyingContract","salt"];function EA(s){return function(e){return H(typeof e=="string",`invalid domain value for ${JSON.stringify(s)}`,`domain.${s}`,e),e}}const mU={name:EA("name"),version:EA("version"),chainId:function(s){const e=we(s,"domain.chainId");return H(e>=0,"invalid chain ID","domain.chainId",s),Number.isSafeInteger(e)?Number(e):Ko(e)},verifyingContract:function(s){try{return mt(s).toLowerCase()}catch{}H(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",s)},salt:function(s){const e=nt(s,"domain.salt");return H(e.length===32,'invalid domain value "salt"',"domain.salt",s),Ae(e)}};function lp(s){{const e=s.match(/^(u?)int(\d+)$/);if(e){const t=e[1]==="",n=parseInt(e[2]);H(n%8===0&&n!==0&&n<=256&&e[2]===String(n),"invalid numeric width","type",s);const i=ul(hU,t?n-1:n),a=t?(i+fR)*uU:hR;return function(l){const c=we(l,"value");return H(c>=a&&c<=i,`value out-of-bounds for ${s}`,"value",c),ka(t?qT(c,256):c,32)}}}{const e=s.match(/^bytes(\d+)$/);if(e){const t=parseInt(e[1]);return H(t!==0&&t<=32&&e[1]===String(t),"invalid bytes width","type",s),function(n){const i=nt(n);return H(i.length===t,`invalid length for ${s}`,"value",n),fU(n)}}}switch(s){case"address":return function(e){return Ul(mt(e),32)};case"bool":return function(e){return e?dU:gU};case"bytes":return function(e){return $t(e)};case"string":return function(e){return Gl(e)}}return null}function bA(s,e){return`${s}(${e.map(({name:t,type:n})=>n+" "+t).join(",")})`}function z0(s){const e=s.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:s}}var Hh,cr,Lc,Gd,dR;const Ss=class Ss{constructor(e){ne(this,Gd);X(this,"primaryType");ne(this,Hh);ne(this,cr);ne(this,Lc);P(this,cr,new Map),P(this,Lc,new Map);const t=new Map,n=new Map,i=new Map,a={};Object.keys(e).forEach(h=>{a[h]=e[h].map(({name:f,type:g})=>{let{base:m,index:y}=z0(g);return m==="int"&&!e.int&&(m="int256"),m==="uint"&&!e.uint&&(m="uint256"),{name:f,type:m+(y||"")}}),t.set(h,new Set),n.set(h,[]),i.set(h,new Set)}),P(this,Hh,JSON.stringify(a));for(const h in a){const f=new Set;for(const g of a[h]){H(!f.has(g.name),`duplicate variable name ${JSON.stringify(g.name)} in ${JSON.stringify(h)}`,"types",e),f.add(g.name);const m=z0(g.type).base;H(m!==h,`circular type reference to ${JSON.stringify(m)}`,"types",e),!lp(m)&&(H(n.has(m),`unknown type ${JSON.stringify(m)}`,"types",e),n.get(m).push(h),t.get(h).add(m))}}const l=Array.from(n.keys()).filter(h=>n.get(h).length===0);H(l.length!==0,"missing primary type","types",e),H(l.length===1,`ambiguous primary types or unused types: ${l.map(h=>JSON.stringify(h)).join(", ")}`,"types",e),Oe(this,{primaryType:l[0]});function c(h,f){H(!f.has(h),`circular type reference to ${JSON.stringify(h)}`,"types",e),f.add(h);for(const g of t.get(h))if(n.has(g)){c(g,f);for(const m of f)i.get(m).add(g)}f.delete(h)}c(this.primaryType,new Set);for(const[h,f]of i){const g=Array.from(f);g.sort(),L(this,cr).set(h,bA(h,a[h])+g.map(m=>bA(m,a[m])).join(""))}}get types(){return JSON.parse(L(this,Hh))}getEncoder(e){let t=L(this,Lc).get(e);return t||(t=ge(this,Gd,dR).call(this,e),L(this,Lc).set(e,t)),t}encodeType(e){const t=L(this,cr).get(e);return H(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return $t(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,n){if(lp(e))return n(e,t);const i=z0(e).array;if(i)return H(i.count===-1||i.count===t.length,`array length mismatch; expected length ${i.count}`,"value",t),t.map(l=>this._visit(i.prefix,l,n));const a=this.types[e];if(a)return a.reduce((l,{name:c,type:h})=>(l[c]=this._visit(h,t[c],n),l),{});H(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new Ss(e)}static getPrimaryType(e){return Ss.from(e).primaryType}static hashStruct(e,t,n){return Ss.from(t).hashStruct(e,n)}static hashDomain(e){const t=[];for(const n in e){if(e[n]==null)continue;const i=xA[n];H(i,`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",e),t.push({name:n,type:i})}return t.sort((n,i)=>ap.indexOf(n.name)-ap.indexOf(i.name)),Ss.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,n){return Ht(["0x1901",Ss.hashDomain(e),Ss.from(t).hash(n)])}static hash(e,t,n){return $t(Ss.encode(e,t,n))}static async resolveNames(e,t,n,i){e=Object.assign({},e);for(const c in e)e[c]==null&&delete e[c];const a={};e.verifyingContract&&!Et(e.verifyingContract,20)&&(a[e.verifyingContract]="0x");const l=Ss.from(t);l.visit(n,(c,h)=>(c==="address"&&!Et(h,20)&&(a[h]="0x"),h));for(const c in a)a[c]=await i(c);return e.verifyingContract&&a[e.verifyingContract]&&(e.verifyingContract=a[e.verifyingContract]),n=l.visit(n,(c,h)=>c==="address"&&a[h]?a[h]:h),{domain:e,value:n}}static getPayload(e,t,n){Ss.hashDomain(e);const i={},a=[];ap.forEach(h=>{const f=e[h];f!=null&&(i[h]=mU[h](f),a.push({name:h,type:xA[h]}))});const l=Ss.from(t);t=l.types;const c=Object.assign({},t);return H(c.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",t),c.EIP712Domain=a,l.encode(n),{types:c,domain:i,primaryType:l.primaryType,message:l.visit(n,(h,f)=>{if(h.match(/^bytes(\d*)/))return Ae(nt(f));if(h.match(/^u?int/))return we(f).toString();switch(h){case"address":return f.toLowerCase();case"bool":return!!f;case"string":return H(typeof f=="string","invalid string","value",f),f}H(!1,"unsupported type","type",h)})}}};Hh=new WeakMap,cr=new WeakMap,Lc=new WeakMap,Gd=new WeakSet,dR=function(e){{const i=lp(e);if(i)return i}const t=z0(e).array;if(t){const i=t.prefix,a=this.getEncoder(i);return l=>{H(t.count===-1||t.count===l.length,`array length mismatch; expected length ${t.count}`,"value",l);let c=l.map(a);return L(this,cr).has(i)&&(c=c.map($t)),$t(Ht(c))}}const n=this.types[e];if(n){const i=Gl(L(this,cr).get(e));return a=>{const l=n.map(({name:c,type:h})=>{const f=this.getEncoder(h)(a[c]);return L(this,cr).has(h)?$t(f):f});return l.unshift(i),Ht(l)}}H(!1,`unknown type: ${e}`,"type",e)};let Pd=Ss;function Nn(s){const e=new Set;return s.forEach(t=>e.add(t)),Object.freeze(e)}const pU="external public payable override",yU=Nn(pU.split(" ")),gR="constant external internal payable private public pure view override",vU=Nn(gR.split(" ")),mR="constructor error event fallback function receive struct",pR=Nn(mR.split(" ")),yR="calldata memory storage payable indexed",xU=Nn(yR.split(" ")),EU="tuple returns",bU=[mR,yR,EU,gR].join(" "),AU=Nn(bU.split(" ")),SU={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},TU=new RegExp("^(\\s*)"),wU=new RegExp("^([0-9]+)"),RU=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),vR=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),xR=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var gn,Ks,zh,iy;const $d=class $d{constructor(e){ne(this,zh);ne(this,gn);ne(this,Ks);P(this,gn,0),P(this,Ks,e.slice())}get offset(){return L(this,gn)}get length(){return L(this,Ks).length-L(this,gn)}clone(){return new $d(L(this,Ks))}reset(){P(this,gn,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=ge(this,zh,iy).call(this,L(this,gn)+1,e.match+1);return P(this,gn,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;L(this,gn)<e.match-1;){const n=this.peek().linkNext;t.push(ge(this,zh,iy).call(this,L(this,gn)+1,n)),P(this,gn,n)}return P(this,gn,e.match+1),t}peek(){if(L(this,gn)>=L(this,Ks).length)throw new Error("out-of-bounds");return L(this,Ks)[L(this,gn)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return Wu(this,gn)._++,e}toString(){const e=[];for(let t=L(this,gn);t<L(this,Ks).length;t++){const n=L(this,Ks)[t];e.push(`${n.type}:${n.text}`)}return`<TokenString ${e.join(" ")}>`}};gn=new WeakMap,Ks=new WeakMap,zh=new WeakSet,iy=function(e=0,t=0){return new $d(L(this,Ks).slice(e,t).map(n=>Object.freeze(Object.assign({},n,{match:n.match-e,linkBack:n.linkBack-e,linkNext:n.linkNext-e}))))};let Ws=$d;function _a(s){const e=[],t=l=>{const c=a<s.length?JSON.stringify(s[a]):"$EOI";throw new Error(`invalid token ${c} at ${a}: ${l}`)};let n=[],i=[],a=0;for(;a<s.length;){let l=s.substring(a),c=l.match(TU);c&&(a+=c[1].length,l=s.substring(a));const h={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:a,value:-1};e.push(h);let f=SU[l[0]]||"";if(f){if(h.type=f,h.text=l[0],a++,f==="OPEN_PAREN")n.push(e.length-1),i.push(e.length-1);else if(f=="CLOSE_PAREN")n.length===0&&t("no matching open bracket"),h.match=n.pop(),e[h.match].match=e.length-1,h.depth--,h.linkBack=i.pop(),e[h.linkBack].linkNext=e.length-1;else if(f==="COMMA")h.linkBack=i.pop(),e[h.linkBack].linkNext=e.length-1,i.push(e.length-1);else if(f==="OPEN_BRACKET")h.type="BRACKET";else if(f==="CLOSE_BRACKET"){let g=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const m=e.pop().text;g=m+g,e[e.length-1].value=Ve(m)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=g}continue}if(c=l.match(RU),c){if(h.text=c[1],a+=h.text.length,AU.has(h.text)){h.type="KEYWORD";continue}if(h.text.match(xR)){h.type="TYPE";continue}h.type="ID";continue}if(c=l.match(wU),c){h.text=c[1],h.type="NUMBER",a+=h.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(l[0])} at position ${a}`)}return new Ws(e.map(l=>Object.freeze(l)))}function AA(s,e){let t=[];for(const n in e.keys())s.has(n)&&t.push(n);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function r2(s,e){if(e.peekKeyword(pR)){const t=e.pop().text;if(t!==s)throw new Error(`expected ${s}, got ${t}`)}return e.popType("ID")}function wr(s,e){const t=new Set;for(;;){const n=s.peekType("KEYWORD");if(n==null||e&&!e.has(n))break;if(s.pop(),t.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);t.add(n)}return Object.freeze(t)}function ER(s){let e=wr(s,vU);return AA(e,Nn("constant payable nonpayable".split(" "))),AA(e,Nn("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function Ar(s,e){return s.popParams().map(t=>yn.from(t,e))}function bR(s){if(s.peekType("AT")){if(s.pop(),s.peekType("NUMBER"))return we(s.pop().text);throw new Error("invalid gas")}return null}function $l(s){if(s.length)throw new Error(`unexpected tokens at offset ${s.offset}: ${s.toString()}`)}const LU=new RegExp(/^(.*)\[([0-9]*)\]$/);function SA(s){const e=s.match(xR);if(H(e,"invalid type","type",s),s==="uint")return"uint256";if(s==="int")return"int256";if(e[2]){const t=parseInt(e[2]);H(t!==0&&t<=32,"invalid bytes length","type",s)}else if(e[3]){const t=parseInt(e[3]);H(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",s)}return s}const It={},Yn=Symbol.for("_ethers_internal"),TA="_ParamTypeInternal",wA="_ErrorInternal",RA="_EventInternal",LA="_ConstructorInternal",kA="_FallbackInternal",IA="_FunctionInternal",DA="_StructInternal";var kc,ad;const Ts=class Ts{constructor(e,t,n,i,a,l,c,h){ne(this,kc);X(this,"name");X(this,"type");X(this,"baseType");X(this,"indexed");X(this,"components");X(this,"arrayLength");X(this,"arrayChildren");if(ef(e,It,"ParamType"),Object.defineProperty(this,Yn,{value:TA}),l&&(l=Object.freeze(l.slice())),i==="array"){if(c==null||h==null)throw new Error("")}else if(c!=null||h!=null)throw new Error("");if(i==="tuple"){if(l==null)throw new Error("")}else if(l!=null)throw new Error("");Oe(this,{name:t,type:n,baseType:i,indexed:a,components:l,arrayLength:c,arrayChildren:h})}format(e){if(e==null&&(e="sighash"),e==="json"){const n=this.name||"";if(this.isArray()){const a=JSON.parse(this.arrayChildren.format("json"));return a.name=n,a.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(a)}const i={type:this.baseType==="tuple"?"tuple":this.type,name:n};return typeof this.indexed=="boolean"&&(i.indexed=this.indexed),this.isTuple()&&(i.components=this.components.map(a=>JSON.parse(a.format(e)))),JSON.stringify(i)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(n=>n.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return e.map(i=>n.arrayChildren.walk(i,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const n=this;return e.map((i,a)=>n.components[a].walk(i,t))}return t(this.type,e)}async walkAsync(e,t){const n=[],i=[e];return ge(this,kc,ad).call(this,n,e,t,a=>{i[0]=a}),n.length&&await Promise.all(n),i[0]}static from(e,t){if(Ts.isParamType(e))return e;if(typeof e=="string")try{return Ts.from(_a(e),t)}catch{H(!1,"invalid param type","obj",e)}else if(e instanceof Ws){let c="",h="",f=null;wr(e,Nn(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(h="tuple",f=e.popParams().map(b=>Ts.from(b)),c=`tuple(${f.map(b=>b.format()).join(",")})`):(c=SA(e.popType("TYPE")),h=c);let g=null,m=null;for(;e.length&&e.peekType("BRACKET");){const b=e.pop();g=new Ts(It,"",c,h,null,f,m,g),m=b.value,c+=b.text,h="array",f=null}let y=null;if(wr(e,xU).has("indexed")){if(!t)throw new Error("");y=!0}const x=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new Ts(It,x,c,h,y,f,m,g)}const n=e.name;H(!n||typeof n=="string"&&n.match(vR),"invalid name","obj.name",n);let i=e.indexed;i!=null&&(H(t,"parameter cannot be indexed","obj.indexed",e.indexed),i=!!i);let a=e.type,l=a.match(LU);if(l){const c=parseInt(l[2]||"-1"),h=Ts.from({type:l[1],components:e.components});return new Ts(It,n||"",a,"array",i,null,c,h)}if(a==="tuple"||a.startsWith("tuple(")||a.startsWith("(")){const c=e.components!=null?e.components.map(f=>Ts.from(f)):null;return new Ts(It,n||"",a,"tuple",i,c,null,null)}return a=SA(e.type),new Ts(It,n||"",a,a,i,null,null,null)}static isParamType(e){return e&&e[Yn]===TA}};kc=new WeakSet,ad=function(e,t,n,i){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const l=this.arrayChildren,c=t.slice();c.forEach((h,f)=>{var g;ge(g=l,kc,ad).call(g,e,h,n,m=>{c[f]=m})}),i(c);return}if(this.isTuple()){const l=this.components;let c;if(Array.isArray(t))c=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");c=l.map(h=>{if(!h.name)throw new Error("cannot use object value with unnamed components");if(!(h.name in t))throw new Error(`missing value for component ${h.name}`);return t[h.name]})}if(c.length!==this.components.length)throw new Error("array is wrong length");c.forEach((h,f)=>{var g;ge(g=l[f],kc,ad).call(g,e,h,n,m=>{c[f]=m})}),i(c);return}const a=n(this.type,t);a.then?e.push(async function(){i(await a)}()):i(a)};let yn=Ts;class Hl{constructor(e,t,n){X(this,"type");X(this,"inputs");ef(e,It,"Fragment"),n=Object.freeze(n.slice()),Oe(this,{type:t,inputs:n})}static from(e){if(typeof e=="string"){try{Hl.from(JSON.parse(e))}catch{}return Hl.from(_a(e))}if(e instanceof Ws)switch(e.peekKeyword(pR)){case"constructor":return xr.from(e);case"error":return Kn.from(e);case"event":return bi.from(e);case"fallback":case"receive":return sr.from(e);case"function":return Ai.from(e);case"struct":return Nl.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return xr.from(e);case"error":return Kn.from(e);case"event":return bi.from(e);case"fallback":case"receive":return sr.from(e);case"function":return Ai.from(e);case"struct":return Nl.from(e)}fe(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}H(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return xr.isFragment(e)}static isError(e){return Kn.isFragment(e)}static isEvent(e){return bi.isFragment(e)}static isFunction(e){return Ai.isFragment(e)}static isStruct(e){return Nl.isFragment(e)}}class a2 extends Hl{constructor(t,n,i,a){super(t,n,a);X(this,"name");H(typeof i=="string"&&i.match(vR),"invalid identifier","name",i),a=Object.freeze(a.slice()),Oe(this,{name:i})}}function Nh(s,e){return"("+e.map(t=>t.format(s)).join(s==="full"?", ":",")+")"}class Kn extends a2{constructor(e,t,n){super(e,"error",t,n),Object.defineProperty(this,Yn,{value:wA})}get selector(){return Gl(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+Nh(e,this.inputs)),t.join(" ")}static from(e){if(Kn.isFragment(e))return e;if(typeof e=="string")return Kn.from(_a(e));if(e instanceof Ws){const t=r2("error",e),n=Ar(e);return $l(e),new Kn(It,t,n)}return new Kn(It,e.name,e.inputs?e.inputs.map(yn.from):[])}static isFragment(e){return e&&e[Yn]===wA}}class bi extends a2{constructor(t,n,i,a){super(t,"event",n,i);X(this,"anonymous");Object.defineProperty(this,Yn,{value:RA}),Oe(this,{anonymous:a})}get topicHash(){return Gl(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(i=>JSON.parse(i.format(t)))});const n=[];return t!=="sighash"&&n.push("event"),n.push(this.name+Nh(t,this.inputs)),t!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(t,n){return n=(n||[]).map(a=>yn.from(a)),new bi(It,t,n,!1).topicHash}static from(t){if(bi.isFragment(t))return t;if(typeof t=="string")try{return bi.from(_a(t))}catch{H(!1,"invalid event fragment","obj",t)}else if(t instanceof Ws){const n=r2("event",t),i=Ar(t,!0),a=!!wr(t,Nn(["anonymous"])).has("anonymous");return $l(t),new bi(It,n,i,a)}return new bi(It,t.name,t.inputs?t.inputs.map(n=>yn.from(n,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[Yn]===RA}}class xr extends Hl{constructor(t,n,i,a,l){super(t,n,i);X(this,"payable");X(this,"gas");Object.defineProperty(this,Yn,{value:LA}),Oe(this,{payable:a,gas:l})}format(t){if(fe(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(i=>JSON.parse(i.format(t)))});const n=[`constructor${Nh(t,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(t){if(xr.isFragment(t))return t;if(typeof t=="string")try{return xr.from(_a(t))}catch{H(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof Ws){wr(t,Nn(["constructor"]));const n=Ar(t),i=!!wr(t,yU).has("payable"),a=bR(t);return $l(t),new xr(It,"constructor",n,i,a)}return new xr(It,"constructor",t.inputs?t.inputs.map(yn.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Yn]===LA}}class sr extends Hl{constructor(t,n,i){super(t,"fallback",n);X(this,"payable");Object.defineProperty(this,Yn,{value:kA}),Oe(this,{payable:i})}format(t){const n=this.inputs.length===0?"receive":"fallback";if(t==="json"){const i=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:i})}return`${n}()${this.payable?" payable":""}`}static from(t){if(sr.isFragment(t))return t;if(typeof t=="string")try{return sr.from(_a(t))}catch{H(!1,"invalid fallback fragment","obj",t)}else if(t instanceof Ws){const n=t.toString(),i=t.peekKeyword(Nn(["fallback","receive"]));if(H(i,"type must be fallback or receive","obj",n),t.popKeyword(Nn(["fallback","receive"]))==="receive"){const h=Ar(t);return H(h.length===0,"receive cannot have arguments","obj.inputs",h),wr(t,Nn(["payable"])),$l(t),new sr(It,[],!0)}let l=Ar(t);l.length?H(l.length===1&&l[0].type==="bytes","invalid fallback inputs","obj.inputs",l.map(h=>h.format("minimal")).join(", ")):l=[yn.from("bytes")];const c=ER(t);if(H(c==="nonpayable"||c==="payable","fallback cannot be constants","obj.stateMutability",c),wr(t,Nn(["returns"])).has("returns")){const h=Ar(t);H(h.length===1&&h[0].type==="bytes","invalid fallback outputs","obj.outputs",h.map(f=>f.format("minimal")).join(", "))}return $l(t),new sr(It,l,c==="payable")}if(t.type==="receive")return new sr(It,[],!0);if(t.type==="fallback"){const n=[yn.from("bytes")],i=t.stateMutability==="payable";return new sr(It,n,i)}H(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[Yn]===kA}}class Ai extends a2{constructor(t,n,i,a,l,c){super(t,"function",n,a);X(this,"constant");X(this,"outputs");X(this,"stateMutability");X(this,"payable");X(this,"gas");Object.defineProperty(this,Yn,{value:IA}),l=Object.freeze(l.slice()),Oe(this,{constant:i==="view"||i==="pure",gas:c,outputs:l,payable:i==="payable",stateMutability:i})}get selector(){return Gl(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(i=>JSON.parse(i.format(t))),outputs:this.outputs.map(i=>JSON.parse(i.format(t)))});const n=[];return t!=="sighash"&&n.push("function"),n.push(this.name+Nh(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push(Nh(t,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(t,n){return n=(n||[]).map(a=>yn.from(a)),new Ai(It,t,"view",n,[],null).selector}static from(t){if(Ai.isFragment(t))return t;if(typeof t=="string")try{return Ai.from(_a(t))}catch{H(!1,"invalid function fragment","obj",t)}else if(t instanceof Ws){const i=r2("function",t),a=Ar(t),l=ER(t);let c=[];wr(t,Nn(["returns"])).has("returns")&&(c=Ar(t));const h=bR(t);return $l(t),new Ai(It,i,l,a,c,h)}let n=t.stateMutability;return n==null&&(n="payable",typeof t.constant=="boolean"?(n="view",t.constant||(n="payable",typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable")),new Ai(It,t.name,n,t.inputs?t.inputs.map(yn.from):[],t.outputs?t.outputs.map(yn.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Yn]===IA}}class Nl extends a2{constructor(e,t,n){super(e,"struct",t,n),Object.defineProperty(this,Yn,{value:DA})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Nl.from(_a(e))}catch{H(!1,"invalid struct fragment","obj",e)}else if(e instanceof Ws){const t=r2("struct",e),n=Ar(e);return $l(e),new Nl(It,t,n)}return new Nl(It,e.name,e.inputs?e.inputs.map(yn.from):[])}static isFragment(e){return e&&e[Yn]===DA}}const Js=new Map;Js.set(0,"GENERIC_PANIC");Js.set(1,"ASSERT_FALSE");Js.set(17,"OVERFLOW");Js.set(18,"DIVIDE_BY_ZERO");Js.set(33,"ENUM_RANGE_ERROR");Js.set(34,"BAD_STORAGE_DATA");Js.set(49,"STACK_UNDERFLOW");Js.set(50,"ARRAY_RANGE_ERROR");Js.set(65,"OUT_OF_MEMORY");Js.set(81,"UNINITIALIZED_FUNCTION_CALL");const kU=new RegExp(/^bytes([0-9]*)$/),IU=new RegExp(/^(u?int)([0-9]*)$/);let op=null,CA=1024;function DU(s,e,t,n){let i="missing revert data",a=null;const l=null;let c=null;if(t){i="execution reverted";const f=nt(t);if(t=Ae(t),f.length===0)i+=" (no data present; likely require(false) occurred",a="require(false)";else if(f.length%32!==4)i+=" (could not decode reason; invalid data length)";else if(Ae(f.slice(0,4))==="0x08c379a0")try{a=n.decode(["string"],f.slice(4))[0],c={signature:"Error(string)",name:"Error",args:[a]},i+=`: ${JSON.stringify(a)}`}catch{i+=" (could not decode reason; invalid string data)"}else if(Ae(f.slice(0,4))==="0x4e487b71")try{const g=Number(n.decode(["uint256"],f.slice(4))[0]);c={signature:"Panic(uint256)",name:"Panic",args:[g]},a=`Panic due to ${Js.get(g)||"UNKNOWN"}(${g})`,i+=`: ${a}`}catch{i+=" (could not decode panic code)"}else i+=" (unknown custom error)"}const h={to:e.to?mt(e.to):null,data:e.data||"0x"};return e.from&&(h.from=mt(e.from)),Pt(i,"CALL_EXCEPTION",{action:s,data:t,reason:a,transaction:h,invocation:l,revert:c})}var fa,Go;const Hd=class Hd{constructor(){ne(this,fa)}getDefaultValue(e){const t=e.map(i=>ge(this,fa,Go).call(this,yn.from(i)));return new H0(t,"_").defaultValue()}encode(e,t){YT(t.length,e.length,"types/values length mismatch");const n=e.map(l=>ge(this,fa,Go).call(this,yn.from(l))),i=new H0(n,"_"),a=new Vp;return i.encode(a,t),a.data}decode(e,t,n){const i=e.map(l=>ge(this,fa,Go).call(this,yn.from(l)));return new H0(i,"_").decode(new Kp(t,n,CA))}static _setDefaultMaxInflation(e){H(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),CA=e}static defaultAbiCoder(){return op==null&&(op=new Hd),op}static getBuiltinCallException(e,t,n){return DU(e,t,n,Hd.defaultAbiCoder())}};fa=new WeakSet,Go=function(e){if(e.isArray())return new JB(ge(this,fa,Go).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new H0(e.components.map(n=>ge(this,fa,Go).call(this,n)),e.name);switch(e.baseType){case"address":return new WB(e.name);case"bool":return new e4(e.name);case"string":return new c4(e.name);case"bytes":return new t4(e.name);case"":return new i4(e.name)}let t=e.type.match(IU);if(t){let n=parseInt(t[2]||"256");return H(n!==0&&n<=256&&n%8===0,"invalid "+t[1]+" bit length","param",e),new o4(n/8,t[1]==="int",e.name)}if(t=e.type.match(kU),t){let n=parseInt(t[1]);return H(n!==0&&n<=32,"invalid bytes length","param",e),new n4(n,e.name)}H(!1,"invalid type","type",e.type)};let Bh=Hd;class CU{constructor(e,t,n){X(this,"fragment");X(this,"name");X(this,"signature");X(this,"topic");X(this,"args");const i=e.name,a=e.format();Oe(this,{fragment:e,name:i,signature:a,topic:t,args:n})}}class _U{constructor(e,t,n,i){X(this,"fragment");X(this,"name");X(this,"args");X(this,"signature");X(this,"selector");X(this,"value");const a=e.name,l=e.format();Oe(this,{fragment:e,name:a,args:n,signature:l,selector:t,value:i})}}class OU{constructor(e,t,n){X(this,"fragment");X(this,"name");X(this,"args");X(this,"signature");X(this,"selector");const i=e.name,a=e.format();Oe(this,{fragment:e,name:i,args:n,signature:a,selector:t})}}class _A{constructor(e){X(this,"hash");X(this,"_isIndexed");Oe(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const OA={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},MA={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:s=>`reverted with reason string ${JSON.stringify(s)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:s=>{let e="unknown panic code";return s>=0&&s<=255&&OA[s.toString()]&&(e=OA[s.toString()]),`reverted with panic code 0x${s.toString(16)} (${e})`}}};var gi,mi,pi,An,ki,ld,od;const cl=class cl{constructor(e){ne(this,ki);X(this,"fragments");X(this,"deploy");X(this,"fallback");X(this,"receive");ne(this,gi);ne(this,mi);ne(this,pi);ne(this,An);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,P(this,pi,new Map),P(this,gi,new Map),P(this,mi,new Map);const n=[];for(const l of t)try{n.push(Hl.from(l))}catch(c){console.log(`[Warning] Invalid Fragment ${JSON.stringify(l)}:`,c.message)}Oe(this,{fragments:Object.freeze(n)});let i=null,a=!1;P(this,An,this.getAbiCoder()),this.fragments.forEach((l,c)=>{let h;switch(l.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}Oe(this,{deploy:l});return;case"fallback":l.inputs.length===0?a=!0:(H(!i||l.payable!==i.payable,"conflicting fallback fragments",`fragments[${c}]`,l),i=l,a=i.payable);return;case"function":h=L(this,pi);break;case"event":h=L(this,mi);break;case"error":h=L(this,gi);break;default:return}const f=l.format();h.has(f)||h.set(f,l)}),this.deploy||Oe(this,{deploy:xr.from("constructor()")}),Oe(this,{fallback:i,receive:a})}format(e){const t=e?"minimal":"full";return this.fragments.map(i=>i.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return Bh.defaultAbiCoder()}getFunctionName(e){const t=ge(this,ki,ld).call(this,e,null,!1);return H(t,"no matching function","key",e),t.name}hasFunction(e){return!!ge(this,ki,ld).call(this,e,null,!1)}getFunction(e,t){return ge(this,ki,ld).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(L(this,pi).keys());t.sort((n,i)=>n.localeCompare(i));for(let n=0;n<t.length;n++){const i=t[n];e(L(this,pi).get(i),n)}}getEventName(e){const t=ge(this,ki,od).call(this,e,null,!1);return H(t,"no matching event","key",e),t.name}hasEvent(e){return!!ge(this,ki,od).call(this,e,null,!1)}getEvent(e,t){return ge(this,ki,od).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(L(this,mi).keys());t.sort((n,i)=>n.localeCompare(i));for(let n=0;n<t.length;n++){const i=t[n];e(L(this,mi).get(i),n)}}getError(e,t){if(Et(e)){const i=e.toLowerCase();if(MA[i])return Kn.from(MA[i].signature);for(const a of L(this,gi).values())if(i===a.selector)return a;return null}if(e.indexOf("(")===-1){const i=[];for(const[a,l]of L(this,gi))a.split("(")[0]===e&&i.push(l);if(i.length===0)return e==="Error"?Kn.from("error Error(string)"):e==="Panic"?Kn.from("error Panic(uint256)"):null;if(i.length>1){const a=i.map(l=>JSON.stringify(l.format())).join(", ");H(!1,`ambiguous error description (i.e. ${a})`,"name",e)}return i[0]}if(e=Kn.from(e).format(),e==="Error(string)")return Kn.from("error Error(string)");if(e==="Panic(uint256)")return Kn.from("error Panic(uint256)");const n=L(this,gi).get(e);return n||null}forEachError(e){const t=Array.from(L(this,gi).keys());t.sort((n,i)=>n.localeCompare(i));for(let n=0;n<t.length;n++){const i=t[n];e(L(this,gi).get(i),n)}}_decodeParams(e,t){return L(this,An).decode(e,t)}_encodeParams(e,t){return L(this,An).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);H(n,"unknown error","fragment",e),e=n}return H(Nt(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,Nt(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);H(n,"unknown error","fragment",e),e=n}return Ht([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);H(n,"unknown function","fragment",e),e=n}return H(Nt(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,Nt(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);H(n,"unknown function","fragment",e),e=n}return Ht([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const a=this.getFunction(e);H(a,"unknown function","fragment",e),e=a}let n="invalid length for result data";const i=_n(t);if(i.length%32===0)try{return L(this,An).decode(e.outputs,i)}catch{n="could not decode result data"}fe(!1,n,"BAD_DATA",{value:Ae(i),info:{method:e.name,signature:e.format()}})}makeError(e,t){const n=nt(e,"data"),i=Bh.getBuiltinCallException("call",t,n);if(i.message.startsWith("execution reverted (unknown custom error)")){const c=Ae(n.slice(0,4)),h=this.getError(c);if(h)try{const f=L(this,An).decode(h.inputs,n.slice(4));i.revert={name:h.name,signature:h.format(),args:f},i.reason=i.revert.signature,i.message=`execution reverted: ${i.reason}`}catch{i.message="execution reverted (coult not decode custom error)"}}const l=this.parseTransaction(t);return l&&(i.invocation={method:l.name,signature:l.signature,args:l.args}),i}encodeFunctionResult(e,t){if(typeof e=="string"){const n=this.getFunction(e);H(n,"unknown function","fragment",e),e=n}return Ae(L(this,An).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const a=this.getEvent(e);H(a,"unknown event","eventFragment",e),e=a}fe(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const n=[];e.anonymous||n.push(e.topicHash);const i=(a,l)=>a.type==="string"?Gl(l):a.type==="bytes"?$t(Ae(l)):(a.type==="bool"&&typeof l=="boolean"?l=l?"0x01":"0x00":a.type.match(/^u?int/)?l=ka(l):a.type.match(/^bytes/)?l=XN(l,32):a.type==="address"&&L(this,An).encode(["address"],[l]),Ul(Ae(l),32));for(t.forEach((a,l)=>{const c=e.inputs[l];if(!c.indexed){H(a==null,"cannot filter non-indexed parameters; must be null","contract."+c.name,a);return}a==null?n.push(null):c.baseType==="array"||c.baseType==="tuple"?H(!1,"filtering with tuples or arrays not supported","contract."+c.name,a):Array.isArray(a)?n.push(a.map(h=>i(c,h))):n.push(i(c,a))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(e,t){if(typeof e=="string"){const l=this.getEvent(e);H(l,"unknown event","eventFragment",e),e=l}const n=[],i=[],a=[];return e.anonymous||n.push(e.topicHash),H(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((l,c)=>{const h=t[c];if(l.indexed)if(l.type==="string")n.push(Gl(h));else if(l.type==="bytes")n.push($t(h));else{if(l.baseType==="tuple"||l.baseType==="array")throw new Error("not implemented");n.push(L(this,An).encode([l.type],[h]))}else i.push(l),a.push(h)}),{data:L(this,An).encode(i,a),topics:n}}decodeEventLog(e,t,n){if(typeof e=="string"){const v=this.getEvent(e);H(v,"unknown event","eventFragment",e),e=v}if(n!=null&&!e.anonymous){const v=e.topicHash;H(Et(n[0],32)&&n[0].toLowerCase()===v,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const i=[],a=[],l=[];e.inputs.forEach((v,x)=>{v.indexed?v.type==="string"||v.type==="bytes"||v.baseType==="tuple"||v.baseType==="array"?(i.push(yn.from({type:"bytes32",name:v.name})),l.push(!0)):(i.push(v),l.push(!1)):(a.push(v),l.push(!1))});const c=n!=null?L(this,An).decode(i,Ht(n)):null,h=L(this,An).decode(a,t,!0),f=[],g=[];let m=0,y=0;return e.inputs.forEach((v,x)=>{let b=null;if(v.indexed)if(c==null)b=new _A(null);else if(l[x])b=new _A(c[y++]);else try{b=c[y++]}catch(A){b=A}else try{b=h[m++]}catch(A){b=A}f.push(b),g.push(v.name||null)}),Yc.fromItems(f,g)}parseTransaction(e){const t=nt(e.data,"tx.data"),n=we(e.value!=null?e.value:0,"tx.value"),i=this.getFunction(Ae(t.slice(0,4)));if(!i)return null;const a=L(this,An).decode(i.inputs,t.slice(4));return new _U(i,i.selector,a,n)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new CU(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=Ae(e),n=this.getError(Nt(t,0,4));if(!n)return null;const i=L(this,An).decode(n.inputs,Nt(t,4));return new OU(n,n.selector,i)}static from(e){return e instanceof cl?e:typeof e=="string"?new cl(JSON.parse(e)):typeof e.formatJson=="function"?new cl(e.formatJson()):typeof e.format=="function"?new cl(e.format("json")):new cl(e)}};gi=new WeakMap,mi=new WeakMap,pi=new WeakMap,An=new WeakMap,ki=new WeakSet,ld=function(e,t,n){if(Et(e)){const a=e.toLowerCase();for(const l of L(this,pi).values())if(a===l.selector)return l;return null}if(e.indexOf("(")===-1){const a=[];for(const[l,c]of L(this,pi))l.split("(")[0]===e&&a.push(c);if(t){const l=t.length>0?t[t.length-1]:null;let c=t.length,h=!0;Rn.isTyped(l)&&l.type==="overrides"&&(h=!1,c--);for(let f=a.length-1;f>=0;f--){const g=a[f].inputs.length;g!==c&&(!h||g!==c-1)&&a.splice(f,1)}for(let f=a.length-1;f>=0;f--){const g=a[f].inputs;for(let m=0;m<t.length;m++)if(Rn.isTyped(t[m])){if(m>=g.length){if(t[m].type==="overrides")continue;a.splice(f,1);break}if(t[m].type!==g[m].baseType){a.splice(f,1);break}}}}if(a.length===1&&t&&t.length!==a[0].inputs.length){const l=t[t.length-1];(l==null||Array.isArray(l)||typeof l!="object")&&a.splice(0,1)}if(a.length===0)return null;if(a.length>1&&n){const l=a.map(c=>JSON.stringify(c.format())).join(", ");H(!1,`ambiguous function description (i.e. matches ${l})`,"key",e)}return a[0]}const i=L(this,pi).get(Ai.from(e).format());return i||null},od=function(e,t,n){if(Et(e)){const a=e.toLowerCase();for(const l of L(this,mi).values())if(a===l.topicHash)return l;return null}if(e.indexOf("(")===-1){const a=[];for(const[l,c]of L(this,mi))l.split("(")[0]===e&&a.push(c);if(t){for(let l=a.length-1;l>=0;l--)a[l].inputs.length<t.length&&a.splice(l,1);for(let l=a.length-1;l>=0;l--){const c=a[l].inputs;for(let h=0;h<t.length;h++)if(Rn.isTyped(t[h])&&t[h].type!==c[h].baseType){a.splice(l,1);break}}}if(a.length===0)return null;if(a.length>1&&n){const l=a.map(c=>JSON.stringify(c.format())).join(", ");H(!1,`ambiguous event description (i.e. matches ${l})`,"key",e)}return a[0]}const i=L(this,mi).get(bi.from(e).format());return i||null};let ry=cl;const AR=BigInt(0);function nc(s){return s??null}function Ut(s){return s==null?null:s.toString()}class PA{constructor(e,t,n){X(this,"gasPrice");X(this,"maxFeePerGas");X(this,"maxPriorityFeePerGas");Oe(this,{gasPrice:nc(e),maxFeePerGas:nc(t),maxPriorityFeePerGas:nc(n)})}toJSON(){const{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:n}=this;return{_type:"FeeData",gasPrice:Ut(e),maxFeePerGas:Ut(t),maxPriorityFeePerGas:Ut(n)}}}function Nd(s){const e={};s.to&&(e.to=s.to),s.from&&(e.from=s.from),s.data&&(e.data=Ae(s.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const i of t)!(i in s)||s[i]==null||(e[i]=we(s[i],`request.${i}`));const n="type,nonce".split(/,/);for(const i of n)!(i in s)||s[i]==null||(e[i]=Ve(s[i],`request.${i}`));return s.accessList&&(e.accessList=Yl(s.accessList)),"blockTag"in s&&(e.blockTag=s.blockTag),"enableCcipRead"in s&&(e.enableCcipRead=!!s.enableCcipRead),"customData"in s&&(e.customData=s.customData),"blobVersionedHashes"in s&&s.blobVersionedHashes&&(e.blobVersionedHashes=s.blobVersionedHashes.slice()),"kzg"in s&&(e.kzg=s.kzg),"blobs"in s&&s.blobs&&(e.blobs=s.blobs.map(i=>Xy(i)?Ae(i):Object.assign({},i))),e}var ur;class MU{constructor(e,t){X(this,"provider");X(this,"number");X(this,"hash");X(this,"timestamp");X(this,"parentHash");X(this,"parentBeaconBlockRoot");X(this,"nonce");X(this,"difficulty");X(this,"gasLimit");X(this,"gasUsed");X(this,"stateRoot");X(this,"receiptsRoot");X(this,"blobGasUsed");X(this,"excessBlobGas");X(this,"miner");X(this,"prevRandao");X(this,"extraData");X(this,"baseFeePerGas");ne(this,ur);P(this,ur,e.transactions.map(n=>typeof n!="string"?new Uh(n,t):n)),Oe(this,{provider:t,hash:nc(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:nc(e.prevRandao),extraData:e.extraData,baseFeePerGas:nc(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return L(this,ur).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=L(this,ur).slice();return e.length===0?[]:(fe(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:t,extraData:n,gasLimit:i,gasUsed:a,hash:l,miner:c,prevRandao:h,nonce:f,number:g,parentHash:m,parentBeaconBlockRoot:y,stateRoot:v,receiptsRoot:x,timestamp:b,transactions:A}=this;return{_type:"Block",baseFeePerGas:Ut(e),difficulty:Ut(t),extraData:n,gasLimit:Ut(i),gasUsed:Ut(a),blobGasUsed:Ut(this.blobGasUsed),excessBlobGas:Ut(this.excessBlobGas),hash:l,miner:c,prevRandao:h,nonce:f,number:g,parentHash:m,timestamp:b,parentBeaconBlockRoot:y,stateRoot:v,receiptsRoot:x,transactions:A}}[Symbol.iterator](){let e=0;const t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return L(this,ur).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let t;if(typeof e=="number")t=L(this,ur)[e];else{const n=e.toLowerCase();for(const i of L(this,ur))if(typeof i=="string"){if(i!==n)continue;t=i;break}else{if(i.hash!==n)continue;t=i;break}}if(t==null)throw new Error("no such tx");return typeof t=="string"?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){const t=this.prefetchedTransactions;if(typeof e=="number")return t[e];e=e.toLowerCase();for(const n of t)if(n.hash===e)return n;H(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return PU(this)}}ur=new WeakMap;class rf{constructor(e,t){X(this,"provider");X(this,"transactionHash");X(this,"blockHash");X(this,"blockNumber");X(this,"removed");X(this,"address");X(this,"data");X(this,"topics");X(this,"index");X(this,"transactionIndex");this.provider=t;const n=Object.freeze(e.topics.slice());Oe(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:n,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:n,data:i,index:a,removed:l,topics:c,transactionHash:h,transactionIndex:f}=this;return{_type:"log",address:e,blockHash:t,blockNumber:n,data:i,index:a,removed:l,topics:c,transactionHash:h,transactionIndex:f}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return fe(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return fe(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return fe(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return NU(this)}}var Vh;class SR{constructor(e,t){X(this,"provider");X(this,"to");X(this,"from");X(this,"contractAddress");X(this,"hash");X(this,"index");X(this,"blockHash");X(this,"blockNumber");X(this,"logsBloom");X(this,"gasUsed");X(this,"blobGasUsed");X(this,"cumulativeGasUsed");X(this,"gasPrice");X(this,"blobGasPrice");X(this,"type");X(this,"status");X(this,"root");ne(this,Vh);P(this,Vh,Object.freeze(e.logs.map(i=>new rf(i,t))));let n=AR;e.effectiveGasPrice!=null?n=e.effectiveGasPrice:e.gasPrice!=null&&(n=e.gasPrice),Oe(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:n,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return L(this,Vh)}toJSON(){const{to:e,from:t,contractAddress:n,hash:i,index:a,blockHash:l,blockNumber:c,logsBloom:h,logs:f,status:g,root:m}=this;return{_type:"TransactionReceipt",blockHash:l,blockNumber:c,contractAddress:n,cumulativeGasUsed:Ut(this.cumulativeGasUsed),from:t,gasPrice:Ut(this.gasPrice),blobGasUsed:Ut(this.blobGasUsed),blobGasPrice:Ut(this.blobGasPrice),gasUsed:Ut(this.gasUsed),hash:i,index:a,logs:f,logsBloom:h,root:m,status:g,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return wR(this)}reorderedEvent(e){return fe(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),TR(this,e)}}Vh=new WeakMap;var da;const A3=class A3{constructor(e,t){X(this,"provider");X(this,"blockNumber");X(this,"blockHash");X(this,"index");X(this,"hash");X(this,"type");X(this,"to");X(this,"from");X(this,"nonce");X(this,"gasLimit");X(this,"gasPrice");X(this,"maxPriorityFeePerGas");X(this,"maxFeePerGas");X(this,"maxFeePerBlobGas");X(this,"data");X(this,"value");X(this,"chainId");X(this,"signature");X(this,"accessList");X(this,"blobVersionedHashes");ne(this,da);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,P(this,da,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:n,hash:i,type:a,to:l,from:c,nonce:h,data:f,signature:g,accessList:m,blobVersionedHashes:y}=this;return{_type:"TransactionResponse",accessList:m,blockNumber:e,blockHash:t,blobVersionedHashes:y,chainId:Ut(this.chainId),data:f,from:c,gasLimit:Ut(this.gasLimit),gasPrice:Ut(this.gasPrice),hash:i,maxFeePerGas:Ut(this.maxFeePerGas),maxPriorityFeePerGas:Ut(this.maxPriorityFeePerGas),maxFeePerBlobGas:Ut(this.maxFeePerBlobGas),nonce:h,signature:g,to:l,index:n,type:a,value:Ut(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const n=await this.getTransaction();n&&(e=n.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:n}=await Cn({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:n-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const n=e??1,i=t??0;let a=L(this,da),l=-1,c=a===-1;const h=async()=>{if(c)return null;const{blockNumber:y,nonce:v}=await Cn({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(v<this.nonce){a=y;return}if(c)return null;const x=await this.getTransaction();if(!(x&&x.blockNumber!=null))for(l===-1&&(l=a-3,l<L(this,da)&&(l=L(this,da)));l<=y;){if(c)return null;const b=await this.provider.getBlock(l,!0);if(b==null)return;for(const A of b)if(A===this.hash)return;for(let A=0;A<b.length;A++){const S=await b.getTransaction(A);if(S.from===this.from&&S.nonce===this.nonce){if(c)return null;const k=await this.provider.getTransactionReceipt(S.hash);if(k==null||y-k.blockNumber+1<n)return;let R="replaced";S.data===this.data&&S.to===this.to&&S.value===this.value?R="repriced":S.data==="0x"&&S.from===S.to&&S.value===AR&&(R="cancelled"),fe(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:R==="replaced"||R==="cancelled",reason:R,replacement:S.replaceableTransaction(a),hash:S.hash,receipt:k})}}l++}},f=y=>{if(y==null||y.status!==0)return y;fe(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:y.to,from:y.from,data:""},receipt:y})},g=await this.provider.getTransactionReceipt(this.hash);if(n===0)return f(g);if(g){if(await g.confirmations()>=n)return f(g)}else if(await h(),n===0)return null;return await new Promise((y,v)=>{const x=[],b=()=>{x.forEach(S=>S())};if(x.push(()=>{c=!0}),i>0){const S=setTimeout(()=>{b(),v(Pt("wait for transaction timeout","TIMEOUT"))},i);x.push(()=>{clearTimeout(S)})}const A=async S=>{if(await S.confirmations()>=n){b();try{y(f(S))}catch(k){v(k)}}};if(x.push(()=>{this.provider.off(this.hash,A)}),this.provider.on(this.hash,A),a>=0){const S=async()=>{try{await h()}catch(k){if(pn(k,"TRANSACTION_REPLACED")){b(),v(k);return}}c||this.provider.once("block",S)};x.push(()=>{this.provider.off("block",S)}),this.provider.once("block",S)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return fe(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),wR(this)}reorderedEvent(e){return fe(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),fe(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),TR(this,e)}replaceableTransaction(e){H(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new A3(this,this.provider);return P(t,da,e),t}};da=new WeakMap;let Uh=A3;function PU(s){return{orphan:"drop-block",hash:s.hash,number:s.number}}function TR(s,e){return{orphan:"reorder-transaction",tx:s,other:e}}function wR(s){return{orphan:"drop-transaction",tx:s}}function NU(s){return{orphan:"drop-log",log:{transactionHash:s.transactionHash,blockHash:s.blockHash,blockNumber:s.blockNumber,address:s.address,data:s.data,topics:Object.freeze(s.topics.slice()),index:s.index}}}class h3 extends rf{constructor(t,n,i){super(t,t.provider);X(this,"interface");X(this,"fragment");X(this,"args");const a=n.decodeEventLog(i,t.data,t.topics);Oe(this,{args:a,fragment:i,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class RR extends rf{constructor(t,n){super(t,t.provider);X(this,"error");Oe(this,{error:n})}}var Ic;class BU extends SR{constructor(t,n,i){super(i,n);ne(this,Ic);P(this,Ic,t)}get logs(){return super.logs.map(t=>{const n=t.topics.length?L(this,Ic).getEvent(t.topics[0]):null;if(n)try{return new h3(t,L(this,Ic),n)}catch(i){return new RR(t,i)}return t})}}Ic=new WeakMap;var Kh;class f3 extends Uh{constructor(t,n,i){super(i,n);ne(this,Kh);P(this,Kh,t)}async wait(t,n){const i=await super.wait(t,n);return i==null?null:new BU(L(this,Kh),this.provider,i)}}Kh=new WeakMap;class LR extends XT{constructor(t,n,i,a){super(t,n,i);X(this,"log");Oe(this,{log:a})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class UU extends LR{constructor(e,t,n,i,a){super(e,t,n,new h3(a,e.interface,i));const l=e.interface.decodeEventLog(i,this.log.data,this.log.topics);Oe(this,{args:l,fragment:i})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const NA=BigInt(0);function kR(s){return s&&typeof s.call=="function"}function IR(s){return s&&typeof s.estimateGas=="function"}function l2(s){return s&&typeof s.resolveName=="function"}function DR(s){return s&&typeof s.sendTransaction=="function"}function CR(s){if(s!=null){if(l2(s))return s;if(s.provider)return s.provider}}var Yh;class FU{constructor(e,t,n){ne(this,Yh);X(this,"fragment");if(Oe(this,{fragment:t}),t.inputs.length<n.length)throw new Error("too many arguments");const i=zl(e.runner,"resolveName"),a=l2(i)?i:null;P(this,Yh,async function(){const l=await Promise.all(t.inputs.map((c,h)=>n[h]==null?null:c.walkAsync(n[h],(g,m)=>g==="address"?Array.isArray(m)?Promise.all(m.map(y=>Pn(y,a))):Pn(m,a):m)));return e.interface.encodeFilterTopics(t,l)}())}getTopicFilter(){return L(this,Yh)}}Yh=new WeakMap;function zl(s,e){return s==null?null:typeof s[e]=="function"?s:s.provider&&typeof s.provider[e]=="function"?s.provider:null}function dl(s){return s==null?null:s.provider||null}async function _R(s,e){const t=Rn.dereference(s,"overrides");H(typeof t=="object","invalid overrides parameter","overrides",s);const n=Nd(t);return H(n.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),H(n.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}async function GU(s,e,t){const n=zl(s,"resolveName"),i=l2(n)?n:null;return await Promise.all(e.map((a,l)=>a.walkAsync(t[l],(c,h)=>(h=Rn.dereference(h,c),c==="address"?Pn(h,i):h))))}function $U(s){const e=async function(l){const c=await _R(l,["data"]);c.to=await s.getAddress(),c.from&&(c.from=await Pn(c.from,CR(s.runner)));const h=s.interface,f=we(c.value||NA,"overrides.value")===NA,g=(c.data||"0x")==="0x";h.fallback&&!h.fallback.payable&&h.receive&&!g&&!f&&H(!1,"cannot send data to receive or send value to non-payable fallback","overrides",l),H(h.fallback||g,"cannot send data to receive-only contract","overrides.data",c.data);const m=h.receive||h.fallback&&h.fallback.payable;return H(m||f,"cannot send value to non-payable fallback","overrides.value",c.value),H(h.fallback||g,"cannot send data to receive-only contract","overrides.data",c.data),c},t=async function(l){const c=zl(s.runner,"call");fe(kR(c),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const h=await e(l);try{return await c.call(h)}catch(f){throw qy(f)&&f.data?s.interface.makeError(f.data,h):f}},n=async function(l){const c=s.runner;fe(DR(c),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const h=await c.sendTransaction(await e(l)),f=dl(s.runner);return new f3(s.interface,f,h)},i=async function(l){const c=zl(s.runner,"estimateGas");return fe(IR(c),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await c.estimateGas(await e(l))},a=async l=>await n(l);return Oe(a,{_contract:s,estimateGas:i,populateTransaction:e,send:n,staticCall:t}),a}function HU(s,e){const t=function(...f){const g=s.interface.getFunction(e,f);return fe(g,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:f}}),g},n=async function(...f){const g=t(...f);let m={};if(g.inputs.length+1===f.length&&(m=await _R(f.pop()),m.from&&(m.from=await Pn(m.from,CR(s.runner)))),g.inputs.length!==f.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const y=await GU(s.runner,g.inputs,f);return Object.assign({},m,await Cn({to:s.getAddress(),data:s.interface.encodeFunctionData(g,y)}))},i=async function(...f){const g=await c(...f);return g.length===1?g[0]:g},a=async function(...f){const g=s.runner;fe(DR(g),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const m=await g.sendTransaction(await n(...f)),y=dl(s.runner);return new f3(s.interface,y,m)},l=async function(...f){const g=zl(s.runner,"estimateGas");return fe(IR(g),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await g.estimateGas(await n(...f))},c=async function(...f){const g=zl(s.runner,"call");fe(kR(g),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const m=await n(...f);let y="0x";try{y=await g.call(m)}catch(x){throw qy(x)&&x.data?s.interface.makeError(x.data,m):x}const v=t(...f);return s.interface.decodeFunctionResult(v,y)},h=async(...f)=>t(...f).constant?await i(...f):await a(...f);return Oe(h,{name:s.interface.getFunctionName(e),_contract:s,_key:e,getFragment:t,estimateGas:l,populateTransaction:n,send:a,staticCall:i,staticCallResult:c}),Object.defineProperty(h,"fragment",{configurable:!1,enumerable:!0,get:()=>{const f=s.interface.getFunction(e);return fe(f,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),f}}),h}function zU(s,e){const t=function(...i){const a=s.interface.getEvent(e,i);return fe(a,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:i}}),a},n=function(...i){return new FU(s,t(...i),i)};return Oe(n,{name:s.interface.getEventName(e),_contract:s,_key:e,getFragment:t}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const i=s.interface.getEvent(e);return fe(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),i}}),n}const Bd=Symbol.for("_ethersInternal_contract"),OR=new WeakMap;function VU(s,e){OR.set(s[Bd],e)}function ts(s){return OR.get(s[Bd])}function KU(s){return s&&typeof s=="object"&&"getTopicFilter"in s&&typeof s.getTopicFilter=="function"&&s.fragment}async function d3(s,e){let t,n=null;if(Array.isArray(e)){const a=function(l){if(Et(l,32))return l;const c=s.interface.getEvent(l);return H(c,"unknown fragment","name",l),c.topicHash};t=e.map(l=>l==null?null:Array.isArray(l)?l.map(a):a(l))}else e==="*"?t=[null]:typeof e=="string"?Et(e,32)?t=[e]:(n=s.interface.getEvent(e),H(n,"unknown fragment","event",e),t=[n.topicHash]):KU(e)?t=await e.getTopicFilter():"fragment"in e?(n=e.fragment,t=[n.topicHash]):H(!1,"unknown event name","event",e);t=t.map(a=>{if(a==null)return null;if(Array.isArray(a)){const l=Array.from(new Set(a.map(c=>c.toLowerCase())).values());return l.length===1?l[0]:(l.sort(),l)}return a.toLowerCase()});const i=t.map(a=>a==null?"null":Array.isArray(a)?a.join("|"):a).join("&");return{fragment:n,tag:i,topics:t}}async function fh(s,e){const{subs:t}=ts(s);return t.get((await d3(s,e)).tag)||null}async function BA(s,e,t){const n=dl(s.runner);fe(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:i,tag:a,topics:l}=await d3(s,t),{addr:c,subs:h}=ts(s);let f=h.get(a);if(!f){const m={address:c||s,topics:l},y=A=>{let S=i;if(S==null)try{S=s.interface.getEvent(A.topics[0])}catch{}if(S){const k=S,R=i?s.interface.decodeEventLog(i,A.data,A.topics):[];ly(s,t,R,_=>new UU(s,_,t,k,A))}else ly(s,t,[],k=>new LR(s,k,t,A))};let v=[];f={tag:a,listeners:[],start:()=>{v.length||v.push(n.on(m,y))},stop:async()=>{if(v.length==0)return;let A=v;v=[],await Promise.all(A),n.off(m,y)}},h.set(a,f)}return f}let ay=Promise.resolve();async function YU(s,e,t,n){await ay;const i=await fh(s,e);if(!i)return!1;const a=i.listeners.length;return i.listeners=i.listeners.filter(({listener:l,once:c})=>{const h=Array.from(t);n&&h.push(n(c?null:l));try{l.call(s,...h)}catch{}return!c}),i.listeners.length===0&&(i.stop(),ts(s).subs.delete(i.tag)),a>0}async function ly(s,e,t,n){try{await ay}catch{}const i=YU(s,e,t,n);return ay=i,await i}const V0=["then"];var lS;lS=Bd;const xh=class xh{constructor(e,t,n,i){X(this,"target");X(this,"interface");X(this,"runner");X(this,"filters");X(this,lS);X(this,"fallback");H(typeof e=="string"||Fw(e),"invalid value for Contract target","target",e),n==null&&(n=null);const a=ry.from(t);Oe(this,{target:e,runner:n,interface:a}),Object.defineProperty(this,Bd,{value:{}});let l,c=null,h=null;if(i){const m=dl(n);h=new f3(this.interface,m,i)}let f=new Map;if(typeof e=="string")if(Et(e))c=e,l=Promise.resolve(e);else{const m=zl(n,"resolveName");if(!l2(m))throw Pt("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});l=m.resolveName(e).then(y=>{if(y==null)throw Pt("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return ts(this).addr=y,y})}else l=e.getAddress().then(m=>{if(m==null)throw new Error("TODO");return ts(this).addr=m,m});VU(this,{addrPromise:l,addr:c,deployTx:h,subs:f});const g=new Proxy({},{get:(m,y,v)=>{if(typeof y=="symbol"||V0.indexOf(y)>=0)return Reflect.get(m,y,v);try{return this.getEvent(y)}catch(x){if(!pn(x,"INVALID_ARGUMENT")||x.argument!=="key")throw x}},has:(m,y)=>V0.indexOf(y)>=0?Reflect.has(m,y):Reflect.has(m,y)||this.interface.hasEvent(String(y))});return Oe(this,{filters:g}),Oe(this,{fallback:a.receive||a.fallback?$U(this):null}),new Proxy(this,{get:(m,y,v)=>{if(typeof y=="symbol"||y in m||V0.indexOf(y)>=0)return Reflect.get(m,y,v);try{return m.getFunction(y)}catch(x){if(!pn(x,"INVALID_ARGUMENT")||x.argument!=="key")throw x}},has:(m,y)=>typeof y=="symbol"||y in m||V0.indexOf(y)>=0?Reflect.has(m,y):m.interface.hasFunction(y)})}connect(e){return new xh(this.target,this.interface,e)}attach(e){return new xh(e,this.interface,this.runner)}async getAddress(){return await ts(this).addrPromise}async getDeployedCode(){const e=dl(this.runner);fe(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const n=dl(this.runner);return fe(n!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((i,a)=>{const l=async()=>{try{if(await this.getDeployedCode()!=null)return i(this);n.once("block",l)}catch(c){a(c)}};l()})}deploymentTransaction(){return ts(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),HU(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),zU(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,n){t==null&&(t=0),n==null&&(n="latest");const{addr:i,addrPromise:a}=ts(this),l=i||await a,{fragment:c,topics:h}=await d3(this,e),f={address:l,topics:h,fromBlock:t,toBlock:n},g=dl(this.runner);return fe(g,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await g.getLogs(f)).map(m=>{let y=c;if(y==null)try{y=this.interface.getEvent(m.topics[0])}catch{}if(y)try{return new h3(m,this.interface,y)}catch(v){return new RR(m,v)}return new rf(m,g)})}async on(e,t){const n=await BA(this,"on",e);return n.listeners.push({listener:t,once:!1}),n.start(),this}async once(e,t){const n=await BA(this,"once",e);return n.listeners.push({listener:t,once:!0}),n.start(),this}async emit(e,...t){return await ly(this,e,t,null)}async listenerCount(e){if(e){const i=await fh(this,e);return i?i.listeners.length:0}const{subs:t}=ts(this);let n=0;for(const{listeners:i}of t.values())n+=i.length;return n}async listeners(e){if(e){const i=await fh(this,e);return i?i.listeners.map(({listener:a})=>a):[]}const{subs:t}=ts(this);let n=[];for(const{listeners:i}of t.values())n=n.concat(i.map(({listener:a})=>a));return n}async off(e,t){const n=await fh(this,e);if(!n)return this;if(t){const i=n.listeners.map(({listener:a})=>a).indexOf(t);i>=0&&n.listeners.splice(i,1)}return(t==null||n.listeners.length===0)&&(n.stop(),ts(this).subs.delete(n.tag)),this}async removeAllListeners(e){if(e){const t=await fh(this,e);if(!t)return this;t.stop(),ts(this).subs.delete(t.tag)}else{const{subs:t}=ts(this);for(const{tag:n,stop:i}of t.values())i(),t.delete(n)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends xh{constructor(i,a=null){super(i,e,a)}}return t}static from(e,t,n){return n==null&&(n=null),new this(e,t,n)}};let oy=xh;function jU(){return oy}class sc extends jU(){}function cp(s){return s.match(/^ipfs:\/\/ipfs\//i)?s=s.substring(12):s.match(/^ipfs:\/\//i)?s=s.substring(7):H(!1,"unsupported IPFS format","link",s),`https://gateway.ipfs.io/ipfs/${s}`}class QU{constructor(e){X(this,"name");Oe(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const MR=new RegExp("^(ipfs)://(.*)$","i"),UA=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),MR,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var ga,Rl,ma,$o,zd,PR;const Qo=class Qo{constructor(e,t,n){ne(this,ma);X(this,"provider");X(this,"address");X(this,"name");ne(this,ga);ne(this,Rl);Oe(this,{provider:e,address:t,name:n}),P(this,ga,null),P(this,Rl,new sc(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return L(this,ga)==null&&P(this,ga,(async()=>{try{return await L(this,Rl).supportsInterface("0x9061b923")}catch(e){if(pn(e,"CALL_EXCEPTION"))return!1;throw P(this,ga,null),e}})()),await L(this,ga)}async getAddress(e){if(e==null&&(e=60),e===60)try{const a=await ge(this,ma,$o).call(this,"addr(bytes32)");return a==null||a===Dh?null:a}catch(a){if(pn(a,"CALL_EXCEPTION"))return null;throw a}if(e>=0&&e<2147483648){let a=e+2147483648;const l=await ge(this,ma,$o).call(this,"addr(bytes32,uint)",[a]);if(Et(l,20))return mt(l)}let t=null;for(const a of this.provider.plugins)if(a instanceof QU&&a.supportsCoinType(e)){t=a;break}if(t==null)return null;const n=await ge(this,ma,$o).call(this,"addr(bytes32,uint)",[e]);if(n==null||n==="0x")return null;const i=await t.decodeAddress(e,n);if(i!=null)return i;fe(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:n}})}async getText(e){const t=await ge(this,ma,$o).call(this,"text(bytes32,string)",[e]);return t==null||t==="0x"?null:t}async getContentHash(){const e=await ge(this,ma,$o).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const i=t[1]==="e3010170"?"ipfs":"ipns",a=parseInt(t[4],16);if(t[5].length===a*2)return`${i}://${ZN("0x"+t[2])}`}const n=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&n[1].length===64)return`bzz://${n[1]}`;fe(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const t=await this.getText("avatar");if(t==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let n=0;n<UA.length;n++){const i=t.match(UA[n]);if(i==null)continue;const a=i[1].toLowerCase();switch(a){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{const l=cp(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:l}),{linkage:e,url:l}}case"erc721":case"erc1155":{const l=a==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:a,value:t});const c=await this.getAddress();if(c==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const h=(i[2]||"").split("/");if(h.length!==2)return e.push({type:`!${a}caip`,value:i[2]||""}),{url:null,linkage:e};const f=h[1],g=new sc(h[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(a==="erc721"){const b=await g.ownerOf(f);if(c!==b)return e.push({type:"!owner",value:b}),{url:null,linkage:e};e.push({type:"owner",value:b})}else if(a==="erc1155"){const b=await g.balanceOf(c,f);if(!b)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:b.toString()})}let m=await g[l](f);if(m==null||m==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:m}),a==="erc1155"&&(m=m.replace("{id}",ka(f,32).substring(2)),e.push({type:"metadata-url-expanded",value:m})),m.match(/^ipfs:/i)&&(m=cp(m)),e.push({type:"metadata-url",value:m});let y={};const v=await new Ia(m).send();v.assertOk();try{y=v.bodyJson}catch{try{e.push({type:"!metadata",value:v.bodyText})}catch{const S=v.body;return S&&e.push({type:"!metadata",value:Ae(S)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!y)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(y)});let x=y.image;if(typeof x!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!x.match(/^(https:\/\/|data:)/i)){if(x.match(MR)==null)return e.push({type:"!imageUrl-ipfs",value:x}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:x}),x=cp(x)}return e.push({type:"url",value:x}),{linkage:e,url:x}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),n=t.getPlugin("org.ethers.plugins.network.Ens");return fe(n,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),n.address}static async fromName(e,t){var i;let n=t;for(;;){if(n===""||n==="."||t!=="eth"&&n==="eth")return null;const a=await ge(i=Qo,zd,PR).call(i,e,n);if(a!=null){const l=new Qo(e,a,t);return n!==t&&!await l.supportsWildcard()?null:l}n=n.split(".").slice(1).join(".")}}};ga=new WeakMap,Rl=new WeakMap,ma=new WeakSet,$o=async function(e,t){t=(t||[]).slice();const n=L(this,Rl).interface;t.unshift(sy(this.name));let i=null;await this.supportsWildcard()&&(i=n.getFunction(e),fe(i,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[j4(this.name,255),n.encodeFunctionData(i,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const a=await L(this,Rl)[e](...t);return i?n.decodeFunctionResult(i,a)[0]:a}catch(a){if(!pn(a,"CALL_EXCEPTION"))throw a}return null},zd=new WeakSet,PR=async function(e,t){const n=await Qo.getEnsAddress(e);try{const a=await new sc(n,["function resolver(bytes32) view returns (address)"],e).resolver(sy(t),{enableCcipRead:!0});return a===Dh?null:a}catch(i){throw i}return null},ne(Qo,zd);let Ud=Qo;const FA=BigInt(0);function tt(s,e){return function(t){return t==null?e:s(t)}}function o2(s,e){return t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(n=>s(n))}}function af(s,e){return t=>{const n={};for(const i in s){let a=i;if(e&&i in e&&!(a in t)){for(const l of e[i])if(l in t){a=l;break}}try{const l=s[i](t[a]);l!==void 0&&(n[i]=l)}catch(l){const c=l instanceof Error?l.message:"not-an-error";fe(!1,`invalid value for value.${i} (${c})`,"BAD_DATA",{value:t})}}return n}}function qU(s){switch(s){case!0:case"true":return!0;case!1:case"false":return!1}H(!1,`invalid boolean; ${JSON.stringify(s)}`,"value",s)}function Jc(s){return H(Et(s,!0),"invalid data","value",s),s}function mn(s){return H(Et(s,32),"invalid hash","value",s),s}const XU=af({address:mt,blockHash:mn,blockNumber:Ve,data:Jc,index:Ve,removed:tt(qU,!1),topics:o2(mn),transactionHash:mn,transactionIndex:Ve},{index:["logIndex"]});function WU(s){return XU(s)}const ZU=af({hash:tt(mn),parentHash:mn,parentBeaconBlockRoot:tt(mn,null),number:Ve,timestamp:Ve,nonce:tt(Jc),difficulty:we,gasLimit:we,gasUsed:we,stateRoot:tt(mn,null),receiptsRoot:tt(mn,null),blobGasUsed:tt(we,null),excessBlobGas:tt(we,null),miner:tt(mt),prevRandao:tt(mn,null),extraData:Jc,baseFeePerGas:tt(we)},{prevRandao:["mixHash"]});function JU(s){const e=ZU(s);return e.transactions=s.transactions.map(t=>typeof t=="string"?t:NR(t)),e}const e5=af({transactionIndex:Ve,blockNumber:Ve,transactionHash:mn,address:mt,topics:o2(mn),data:Jc,index:Ve,blockHash:mn},{index:["logIndex"]});function t5(s){return e5(s)}const n5=af({to:tt(mt,null),from:tt(mt,null),contractAddress:tt(mt,null),index:Ve,root:tt(Ae),gasUsed:we,blobGasUsed:tt(we,null),logsBloom:tt(Jc),blockHash:mn,hash:mn,logs:o2(t5),blockNumber:Ve,cumulativeGasUsed:we,effectiveGasPrice:tt(we),blobGasPrice:tt(we,null),status:tt(Ve),type:tt(Ve,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function s5(s){return n5(s)}function NR(s){s.to&&we(s.to)===FA&&(s.to="0x0000000000000000000000000000000000000000");const e=af({hash:mn,index:tt(Ve,void 0),type:t=>t==="0x"||t==null?0:Ve(t),accessList:tt(Yl,null),blobVersionedHashes:tt(o2(mn,!0),null),blockHash:tt(mn,null),blockNumber:tt(Ve,null),transactionIndex:tt(Ve,null),from:mt,gasPrice:tt(we),maxPriorityFeePerGas:tt(we),maxFeePerGas:tt(we),maxFeePerBlobGas:tt(we,null),gasLimit:we,to:tt(mt,null),value:we,nonce:Ve,data:Jc,creates:tt(mt,null),chainId:tt(we,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(s);if(e.to==null&&e.creates==null&&(e.creates=XB(e)),(s.type===1||s.type===2)&&s.accessList==null&&(e.accessList=[]),s.signature?e.signature=Xs.from(s.signature):e.signature=Xs.from(s),e.chainId==null){const t=e.signature.legacyChainId;t!=null&&(e.chainId=t)}return e.blockHash&&we(e.blockHash)===FA&&(e.blockHash=null),e}const i5="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class lf{constructor(e){X(this,"name");Oe(this,{name:e})}clone(){return new lf(this.name)}}class c2 extends lf{constructor(t,n){t==null&&(t=0);super(`org.ethers.network.plugins.GasCost#${t||0}`);X(this,"effectiveBlock");X(this,"txBase");X(this,"txCreate");X(this,"txDataZero");X(this,"txDataNonzero");X(this,"txAccessListStorageKey");X(this,"txAccessListAddress");const i={effectiveBlock:t};function a(l,c){let h=(n||{})[l];h==null&&(h=c),H(typeof h=="number",`invalud value for ${l}`,"costs",n),i[l]=h}a("txBase",21e3),a("txCreate",32e3),a("txDataZero",4),a("txDataNonzero",16),a("txAccessListStorageKey",1900),a("txAccessListAddress",2400),Oe(this,i)}clone(){return new c2(this.effectiveBlock,this)}}class u2 extends lf{constructor(t,n){super("org.ethers.plugins.network.Ens");X(this,"address");X(this,"targetNetwork");Oe(this,{address:t||i5,targetNetwork:n??1})}clone(){return new u2(this.address,this.targetNetwork)}}var jh,Qh;class r5 extends lf{constructor(t,n){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");ne(this,jh);ne(this,Qh);P(this,jh,t),P(this,Qh,n)}get url(){return L(this,jh)}get processFunc(){return L(this,Qh)}clone(){return this}}jh=new WeakMap,Qh=new WeakMap;const up=new Map;var Dc,Cc,pa;const qo=class qo{constructor(e,t){ne(this,Dc);ne(this,Cc);ne(this,pa);P(this,Dc,e),P(this,Cc,we(t)),P(this,pa,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return L(this,Dc)}set name(e){P(this,Dc,e)}get chainId(){return L(this,Cc)}set chainId(e){P(this,Cc,we(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===we(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===we(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===we(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(L(this,pa).values())}attachPlugin(e){if(L(this,pa).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return L(this,pa).set(e.name,e.clone()),this}getPlugin(e){return L(this,pa).get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){const e=new qo(this.name,this.chainId);return this.plugins.forEach(t=>{e.attachPlugin(t.clone())}),e}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new c2;let n=t.txBase;if(e.to==null&&(n+=t.txCreate),e.data)for(let i=2;i<e.data.length;i+=2)e.data.substring(i,i+2)==="00"?n+=t.txDataZero:n+=t.txDataNonzero;if(e.accessList){const i=Yl(e.accessList);for(const a in i)n+=t.txAccessListAddress+t.txAccessListStorageKey*i[a].storageKeys.length}return n}static from(e){if(a5(),e==null)return qo.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const t=up.get(e);if(t)return t();if(typeof e=="bigint")return new qo("unknown",e);H(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){H(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const t=new qo(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&t.attachPlugin(new u2(e.ensAddress,e.ensNetwork)),t}H(!1,"invalid network","network",e)}static register(e,t){typeof e=="number"&&(e=BigInt(e));const n=up.get(e);n&&H(!1,`conflicting network for ${JSON.stringify(n.name)}`,"nameOrChainId",e),up.set(e,t)}};Dc=new WeakMap,Cc=new WeakMap,pa=new WeakMap;let Li=qo;function GA(s,e){const t=String(s);if(!t.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${s}`);const n=t.split(".");if(n.length===1&&n.push(""),n.length!==2)throw new Error(`invalid gwei value: ${s}`);for(;n[1].length<e;)n[1]+="0";if(n[1].length>9){let i=BigInt(n[1].substring(0,9));n[1].substring(9).match(/^0+$/)||i++,n[1]=i.toString()}return BigInt(n[0]+n[1])}function $A(s){return new r5(s,async(e,t,n)=>{n.setHeader("User-Agent","ethers");let i;try{const[a,l]=await Promise.all([n.send(),e()]);i=a;const c=i.bodyJson.standard;return{gasPrice:l.gasPrice,maxFeePerGas:GA(c.maxFee,9),maxPriorityFeePerGas:GA(c.maxPriorityFee,9)}}catch(a){fe(!1,`error encountered with polygon gas station (${JSON.stringify(n.url)})`,"SERVER_ERROR",{request:n,response:i,error:a})}})}let HA=!1;function a5(){if(HA)return;HA=!0;function s(e,t,n){const i=function(){const a=new Li(e,t);return n.ensNetwork!=null&&a.attachPlugin(new u2(null,n.ensNetwork)),a.attachPlugin(new c2),(n.plugins||[]).forEach(l=>{a.attachPlugin(l)}),a};Li.register(e,i),Li.register(t,i),n.altNames&&n.altNames.forEach(a=>{Li.register(a,i)})}s("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),s("ropsten",3,{ensNetwork:3}),s("rinkeby",4,{ensNetwork:4}),s("goerli",5,{ensNetwork:5}),s("kovan",42,{ensNetwork:42}),s("sepolia",11155111,{ensNetwork:11155111}),s("holesky",17e3,{ensNetwork:17e3}),s("classic",61,{}),s("classicKotti",6,{}),s("arbitrum",42161,{ensNetwork:1}),s("arbitrum-goerli",421613,{}),s("arbitrum-sepolia",421614,{}),s("base",8453,{ensNetwork:1}),s("base-goerli",84531,{}),s("base-sepolia",84532,{}),s("bnb",56,{ensNetwork:1}),s("bnbt",97,{}),s("linea",59144,{ensNetwork:1}),s("linea-goerli",59140,{}),s("linea-sepolia",59141,{}),s("matic",137,{ensNetwork:1,plugins:[$A("https://gasstation.polygon.technology/v2")]}),s("matic-amoy",80002,{}),s("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[$A("https://gasstation-testnet.polygon.technology/v2")]}),s("optimism",10,{ensNetwork:1,plugins:[]}),s("optimism-goerli",420,{}),s("optimism-sepolia",11155420,{}),s("xdai",100,{ensNetwork:1})}function cy(s){return JSON.parse(JSON.stringify(s))}var hr,ws,ya,yi,_c,cd;class l5{constructor(e){ne(this,_c);ne(this,hr);ne(this,ws);ne(this,ya);ne(this,yi);P(this,hr,e),P(this,ws,null),P(this,ya,4e3),P(this,yi,-2)}get pollingInterval(){return L(this,ya)}set pollingInterval(e){P(this,ya,e)}start(){L(this,ws)||(P(this,ws,L(this,hr)._setTimeout(ge(this,_c,cd).bind(this),L(this,ya))),ge(this,_c,cd).call(this))}stop(){L(this,ws)&&(L(this,hr)._clearTimeout(L(this,ws)),P(this,ws,null))}pause(e){this.stop(),e&&P(this,yi,-2)}resume(){this.start()}}hr=new WeakMap,ws=new WeakMap,ya=new WeakMap,yi=new WeakMap,_c=new WeakSet,cd=async function(){try{const e=await L(this,hr).getBlockNumber();if(L(this,yi)===-2){P(this,yi,e);return}if(e!==L(this,yi)){for(let t=L(this,yi)+1;t<=e;t++){if(L(this,ws)==null)return;await L(this,hr).emit("block",t)}P(this,yi,e)}}catch{}L(this,ws)!=null&&P(this,ws,L(this,hr)._setTimeout(ge(this,_c,cd).bind(this),L(this,ya)))};var Ll,kl,va;class g3{constructor(e){ne(this,Ll);ne(this,kl);ne(this,va);P(this,Ll,e),P(this,va,!1),P(this,kl,t=>{this._poll(t,L(this,Ll))})}async _poll(e,t){throw new Error("sub-classes must override this")}start(){L(this,va)||(P(this,va,!0),L(this,kl).call(this,-2),L(this,Ll).on("block",L(this,kl)))}stop(){L(this,va)&&(P(this,va,!1),L(this,Ll).off("block",L(this,kl)))}pause(e){this.stop()}resume(){this.start()}}Ll=new WeakMap,kl=new WeakMap,va=new WeakMap;var Oc,fr;class o5 extends g3{constructor(t,n){super(t);ne(this,Oc);ne(this,fr);P(this,Oc,n),P(this,fr,-2)}pause(t){t&&P(this,fr,-2),super.pause(t)}async _poll(t,n){const i=await n.getBlock(L(this,Oc));i!=null&&(L(this,fr)===-2?P(this,fr,i.number):i.number>L(this,fr)&&(n.emit(L(this,Oc),i.number),P(this,fr,i.number)))}}Oc=new WeakMap,fr=new WeakMap;var Vd;class c5 extends g3{constructor(t,n){super(t);ne(this,Vd);P(this,Vd,cy(n))}async _poll(t,n){throw new Error("@TODO")}}Vd=new WeakMap;var Mc;class u5 extends g3{constructor(t,n){super(t);ne(this,Mc);P(this,Mc,n)}async _poll(t,n){const i=await n.getTransactionReceipt(L(this,Mc));i&&n.emit(L(this,Mc),i)}}Mc=new WeakMap;var dr,Pc,Nc,xa,Rs,Kd,BR;class m3{constructor(e,t){ne(this,Kd);ne(this,dr);ne(this,Pc);ne(this,Nc);ne(this,xa);ne(this,Rs);P(this,dr,e),P(this,Pc,cy(t)),P(this,Nc,ge(this,Kd,BR).bind(this)),P(this,xa,!1),P(this,Rs,-2)}start(){L(this,xa)||(P(this,xa,!0),L(this,Rs)===-2&&L(this,dr).getBlockNumber().then(e=>{P(this,Rs,e)}),L(this,dr).on("block",L(this,Nc)))}stop(){L(this,xa)&&(P(this,xa,!1),L(this,dr).off("block",L(this,Nc)))}pause(e){this.stop(),e&&P(this,Rs,-2)}resume(){this.start()}}dr=new WeakMap,Pc=new WeakMap,Nc=new WeakMap,xa=new WeakMap,Rs=new WeakMap,Kd=new WeakSet,BR=async function(e){if(L(this,Rs)===-2)return;const t=cy(L(this,Pc));t.fromBlock=L(this,Rs)+1,t.toBlock=e;const n=await L(this,dr).getLogs(t);if(n.length===0){L(this,Rs)<e-60&&P(this,Rs,e-60);return}for(const i of n)L(this,dr).emit(L(this,Pc),i),P(this,Rs,i.blockNumber)};const h5=BigInt(2),f5=10;function K0(s){return s&&typeof s.then=="function"}function ud(s,e){return s+":"+JSON.stringify(e,(t,n)=>{if(n==null)return"null";if(typeof n=="bigint")return`bigint:${n.toString()}`;if(typeof n=="string")return n.toLowerCase();if(typeof n=="object"&&!Array.isArray(n)){const i=Object.keys(n);return i.sort(),i.reduce((a,l)=>(a[l]=n[l],a),{})}return n})}class UR{constructor(e){X(this,"name");Oe(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function d5(s){return JSON.parse(JSON.stringify(s))}function uy(s){return s=Array.from(new Set(s).values()),s.sort(),s}async function hp(s,e){if(s==null)throw new Error("invalid event");if(Array.isArray(s)&&(s={topics:s}),typeof s=="string")switch(s){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:s,tag:s}}if(Et(s,32)){const t=s.toLowerCase();return{type:"transaction",tag:ud("tx",{hash:t}),hash:t}}if(s.orphan){const t=s;return{type:"orphan",tag:ud("orphan",t),filter:d5(t)}}if(s.address||s.topics){const t=s,n={topics:(t.topics||[]).map(i=>i==null?null:Array.isArray(i)?uy(i.map(a=>a.toLowerCase())):i.toLowerCase())};if(t.address){const i=[],a=[],l=c=>{Et(c)?i.push(c):a.push((async()=>{i.push(await Pn(c,e))})())};Array.isArray(t.address)?t.address.forEach(l):l(t.address),a.length&&await Promise.all(a),n.address=uy(i.map(c=>c.toLowerCase()))}return{filter:n,tag:ud("event",n),type:"event"}}H(!1,"unknown ProviderEvent","event",s)}function fp(){return new Date().getTime()}const g5={cacheTimeout:250,pollingInterval:4e3};var Sn,Ea,Tn,Bc,rs,Il,ba,gr,qh,Ls,Uc,Fc,Xe,es,hy,fy,dh,dy,gh,hd;class m5{constructor(e,t){ne(this,Xe);ne(this,Sn);ne(this,Ea);ne(this,Tn);ne(this,Bc);ne(this,rs);ne(this,Il);ne(this,ba);ne(this,gr);ne(this,qh);ne(this,Ls);ne(this,Uc);ne(this,Fc);if(P(this,Fc,Object.assign({},g5,t||{})),e==="any")P(this,Il,!0),P(this,rs,null);else if(e){const n=Li.from(e);P(this,Il,!1),P(this,rs,Promise.resolve(n)),setTimeout(()=>{this.emit("network",n,null)},0)}else P(this,Il,!1),P(this,rs,null);P(this,gr,-1),P(this,ba,new Map),P(this,Sn,new Map),P(this,Ea,new Map),P(this,Tn,null),P(this,Bc,!1),P(this,qh,1),P(this,Ls,new Map),P(this,Uc,!1)}get pollingInterval(){return L(this,Fc).pollingInterval}get provider(){return this}get plugins(){return Array.from(L(this,Ea).values())}attachPlugin(e){if(L(this,Ea).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return L(this,Ea).set(e.name,e.connect(this)),this}getPlugin(e){return L(this,Ea).get(e)||null}get disableCcipRead(){return L(this,Uc)}set disableCcipRead(e){P(this,Uc,!!e)}async ccipReadFetch(e,t,n){if(this.disableCcipRead||n.length===0||e.to==null)return null;const i=e.to.toLowerCase(),a=t.toLowerCase(),l=[];for(let c=0;c<n.length;c++){const h=n[c],f=h.replace("{sender}",i).replace("{data}",a),g=new Ia(f);h.indexOf("{data}")===-1&&(g.body={data:a,sender:i}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:g,index:c,urls:n});let m="unknown error",y;try{y=await g.send()}catch(v){l.push(v.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:g,result:{error:v}});continue}try{const v=y.bodyJson;if(v.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:g,result:v}),v.data;v.message&&(m=v.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:g,result:v})}catch{}fe(y.statusCode<400||y.statusCode>=500,`response not found during CCIP fetch: ${m}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:h,errorMessage:m}}),l.push(m)}fe(!1,`error encountered during CCIP fetch: ${l.map(c=>JSON.stringify(c)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:n,errorMessages:l}})}_wrapBlock(e,t){return new MU(JU(e),this)}_wrapLog(e,t){return new rf(WU(e),this)}_wrapTransactionReceipt(e,t){return new SR(s5(e),this)}_wrapTransactionResponse(e,t){return new Uh(NR(e),this)}_detectNetwork(){fe(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){fe(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=Ve(await ge(this,Xe,es).call(this,{method:"getBlockNumber"}),"%response");return L(this,gr)>=0&&P(this,gr,e),e}_getAddress(e){return Pn(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(Et(e))return Et(e,32)?e:Ko(e);if(typeof e=="bigint"&&(e=Ve(e,"blockTag")),typeof e=="number")return e>=0?Ko(e):L(this,gr)>=0?Ko(L(this,gr)+e):this.getBlockNumber().then(t=>Ko(t+e));H(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const t=(e.topics||[]).map(h=>h==null?null:Array.isArray(h)?uy(h.map(f=>f.toLowerCase())):h.toLowerCase()),n="blockHash"in e?e.blockHash:void 0,i=(h,f,g)=>{let m;switch(h.length){case 0:break;case 1:m=h[0];break;default:h.sort(),m=h}if(n&&(f!=null||g!=null))throw new Error("invalid filter");const y={};return m&&(y.address=m),t.length&&(y.topics=t),f&&(y.fromBlock=f),g&&(y.toBlock=g),n&&(y.blockHash=n),y};let a=[];if(e.address)if(Array.isArray(e.address))for(const h of e.address)a.push(this._getAddress(h));else a.push(this._getAddress(e.address));let l;"fromBlock"in e&&(l=this._getBlockTag(e.fromBlock));let c;return"toBlock"in e&&(c=this._getBlockTag(e.toBlock)),a.filter(h=>typeof h!="string").length||l!=null&&typeof l!="string"||c!=null&&typeof c!="string"?Promise.all([Promise.all(a),l,c]).then(h=>i(h[0],h[1],h[2])):i(a,l,c)}_getTransactionRequest(e){const t=Nd(e),n=[];if(["to","from"].forEach(i=>{if(t[i]==null)return;const a=Pn(t[i],this);K0(a)?n.push(async function(){t[i]=await a}()):t[i]=a}),t.blockTag!=null){const i=this._getBlockTag(t.blockTag);K0(i)?n.push(async function(){t.blockTag=await i}()):t.blockTag=i}return n.length?async function(){return await Promise.all(n),t}():t}async getNetwork(){if(L(this,rs)==null){const i=(async()=>{try{const a=await this._detectNetwork();return this.emit("network",a,null),a}catch(a){throw L(this,rs)===i&&P(this,rs,null),a}})();return P(this,rs,i),(await i).clone()}const e=L(this,rs),[t,n]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==n.chainId&&(L(this,Il)?(this.emit("network",n,t),L(this,rs)===e&&P(this,rs,Promise.resolve(n))):fe(!1,`network changed: ${t.chainId} => ${n.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:i,gasPrice:a,priorityFee:l}=await Cn({_block:ge(this,Xe,dy).call(this,"latest",!1),gasPrice:(async()=>{try{const g=await ge(this,Xe,es).call(this,{method:"getGasPrice"});return we(g,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const g=await ge(this,Xe,es).call(this,{method:"getPriorityFee"});return we(g,"%response")}catch{}return null})()});let c=null,h=null;const f=this._wrapBlock(i,e);return f&&f.baseFeePerGas&&(h=l??BigInt("1000000000"),c=f.baseFeePerGas*h5+h),new PA(a,c,h)},n=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(n){const i=new Ia(n.url),a=await n.processFunc(t,this,i);return new PA(a.gasPrice,a.maxFeePerGas,a.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return K0(t)&&(t=await t),we(await ge(this,Xe,es).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:n}=await Cn({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await ge(this,Xe,fy).call(this,ge(this,Xe,hy).call(this,t,n,e.enableCcipRead?0:-1))}async getBalance(e,t){return we(await ge(this,Xe,dh).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return Ve(await ge(this,Xe,dh).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return Ae(await ge(this,Xe,dh).call(this,{method:"getCode"},e,t))}async getStorage(e,t,n){const i=we(t,"position");return Ae(await ge(this,Xe,dh).call(this,{method:"getStorage",position:i},e,n))}async broadcastTransaction(e){const{blockNumber:t,hash:n,network:i}=await Cn({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),a=Md.from(e);if(a.hash!==n)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(a,i).replaceableTransaction(t)}async getBlock(e,t){const{network:n,params:i}=await Cn({network:this.getNetwork(),params:ge(this,Xe,dy).call(this,e,!!t)});return i==null?null:this._wrapBlock(i,n)}async getTransaction(e){const{network:t,params:n}=await Cn({network:this.getNetwork(),params:ge(this,Xe,es).call(this,{method:"getTransaction",hash:e})});return n==null?null:this._wrapTransactionResponse(n,t)}async getTransactionReceipt(e){const{network:t,params:n}=await Cn({network:this.getNetwork(),params:ge(this,Xe,es).call(this,{method:"getTransactionReceipt",hash:e})});if(n==null)return null;if(n.gasPrice==null&&n.effectiveGasPrice==null){const i=await ge(this,Xe,es).call(this,{method:"getTransaction",hash:e});if(i==null)throw new Error("report this; could not find tx or effectiveGasPrice");n.effectiveGasPrice=i.gasPrice}return this._wrapTransactionReceipt(n,t)}async getTransactionResult(e){const{result:t}=await Cn({network:this.getNetwork(),result:ge(this,Xe,es).call(this,{method:"getTransactionResult",hash:e})});return t==null?null:Ae(t)}async getLogs(e){let t=this._getFilter(e);K0(t)&&(t=await t);const{network:n,params:i}=await Cn({network:this.getNetwork(),params:ge(this,Xe,es).call(this,{method:"getLogs",filter:t})});return i.map(a=>this._wrapLog(a,n))}_getProvider(e){fe(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await Ud.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){e=mt(e);const t=sy(e.substring(2).toLowerCase()+".addr.reverse");try{const n=await Ud.getEnsAddress(this),a=await new sc(n,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(a==null||a===Dh)return null;const c=await new sc(a,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(c)!==e?null:c}catch(n){if(pn(n,"BAD_DATA")&&n.value==="0x"||pn(n,"CALL_EXCEPTION"))return null;throw n}return null}async waitForTransaction(e,t,n){const i=t??1;return i===0?this.getTransactionReceipt(e):new Promise(async(a,l)=>{let c=null;const h=async f=>{try{const g=await this.getTransactionReceipt(e);if(g!=null&&f-g.blockNumber+1>=i){a(g),c&&(clearTimeout(c),c=null);return}}catch(g){console.log("EEE",g)}this.once("block",h)};n!=null&&(c=setTimeout(()=>{c!=null&&(c=null,this.off("block",h),l(Pt("timeout","TIMEOUT",{reason:"timeout"})))},n)),h(await this.getBlockNumber())})}async waitForBlock(e){fe(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=L(this,Ls).get(e);t&&(t.timer&&clearTimeout(t.timer),L(this,Ls).delete(e))}_setTimeout(e,t){t==null&&(t=0);const n=Wu(this,qh)._++,i=()=>{L(this,Ls).delete(n),e()};if(this.paused)L(this,Ls).set(n,{timer:null,func:i,time:t});else{const a=setTimeout(i,t);L(this,Ls).set(n,{timer:a,func:i,time:fp()})}return n}_forEachSubscriber(e){for(const t of L(this,Sn).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new UR(e.type);case"block":{const t=new l5(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new o5(this,e.type);case"event":return new m3(this,e.filter);case"transaction":return new u5(this,e.hash);case"orphan":return new c5(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const n of L(this,Sn).values())if(n.subscriber===e){n.started&&n.subscriber.stop(),n.subscriber=t,n.started&&t.start(),L(this,Tn)!=null&&t.pause(L(this,Tn));break}}async on(e,t){const n=await ge(this,Xe,hd).call(this,e);return n.listeners.push({listener:t,once:!1}),n.started||(n.subscriber.start(),n.started=!0,L(this,Tn)!=null&&n.subscriber.pause(L(this,Tn))),this}async once(e,t){const n=await ge(this,Xe,hd).call(this,e);return n.listeners.push({listener:t,once:!0}),n.started||(n.subscriber.start(),n.started=!0,L(this,Tn)!=null&&n.subscriber.pause(L(this,Tn))),this}async emit(e,...t){const n=await ge(this,Xe,gh).call(this,e,t);if(!n||n.listeners.length===0)return!1;const i=n.listeners.length;return n.listeners=n.listeners.filter(({listener:a,once:l})=>{const c=new XT(this,l?null:a,e);try{a.call(this,...t,c)}catch{}return!l}),n.listeners.length===0&&(n.started&&n.subscriber.stop(),L(this,Sn).delete(n.tag)),i>0}async listenerCount(e){if(e){const n=await ge(this,Xe,gh).call(this,e);return n?n.listeners.length:0}let t=0;for(const{listeners:n}of L(this,Sn).values())t+=n.length;return t}async listeners(e){if(e){const n=await ge(this,Xe,gh).call(this,e);return n?n.listeners.map(({listener:i})=>i):[]}let t=[];for(const{listeners:n}of L(this,Sn).values())t=t.concat(n.map(({listener:i})=>i));return t}async off(e,t){const n=await ge(this,Xe,gh).call(this,e);if(!n)return this;if(t){const i=n.listeners.map(({listener:a})=>a).indexOf(t);i>=0&&n.listeners.splice(i,1)}return(!t||n.listeners.length===0)&&(n.started&&n.subscriber.stop(),L(this,Sn).delete(n.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:n,subscriber:i}=await ge(this,Xe,hd).call(this,e);n&&i.stop(),L(this,Sn).delete(t)}else for(const[t,{started:n,subscriber:i}]of L(this,Sn))n&&i.stop(),L(this,Sn).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return L(this,Bc)}destroy(){this.removeAllListeners();for(const e of L(this,Ls).keys())this._clearTimeout(e);P(this,Bc,!0)}get paused(){return L(this,Tn)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(P(this,gr,-1),L(this,Tn)!=null){if(L(this,Tn)==!!e)return;fe(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),P(this,Tn,!!e);for(const t of L(this,Ls).values())t.timer&&clearTimeout(t.timer),t.time=fp()-t.time}resume(){if(L(this,Tn)!=null){this._forEachSubscriber(e=>e.resume()),P(this,Tn,null);for(const e of L(this,Ls).values()){let t=e.time;t<0&&(t=0),e.time=fp(),setTimeout(e.func,t)}}}}Sn=new WeakMap,Ea=new WeakMap,Tn=new WeakMap,Bc=new WeakMap,rs=new WeakMap,Il=new WeakMap,ba=new WeakMap,gr=new WeakMap,qh=new WeakMap,Ls=new WeakMap,Uc=new WeakMap,Fc=new WeakMap,Xe=new WeakSet,es=async function(e){const t=L(this,Fc).cacheTimeout;if(t<0)return await this._perform(e);const n=ud(e.method,e);let i=L(this,ba).get(n);return i||(i=this._perform(e),L(this,ba).set(n,i),setTimeout(()=>{L(this,ba).get(n)===i&&L(this,ba).delete(n)},t)),await i},hy=async function(e,t,n){fe(n<f5,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const i=Nd(e);try{return Ae(await this._perform({method:"call",transaction:i,blockTag:t}))}catch(a){if(!this.disableCcipRead&&qy(a)&&a.data&&n>=0&&t==="latest"&&i.to!=null&&Nt(a.data,0,4)==="0x556f1830"){const l=a.data,c=await Pn(i.to,this);let h;try{h=E5(Nt(a.data,4))}catch(m){fe(!1,m.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:i,info:{data:l}})}fe(h.sender.toLowerCase()===c.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:l,reason:"OffchainLookup",transaction:i,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:h.errorArgs}});const f=await this.ccipReadFetch(i,h.calldata,h.urls);fe(f!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:i,info:{data:a.data,errorArgs:h.errorArgs}});const g={to:c,data:Ht([h.selector,x5([f,h.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:g});try{const m=await ge(this,Xe,hy).call(this,g,t,n+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},g),result:m}),m}catch(m){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},g),error:m}),m}}throw a}},fy=async function(e){const{value:t}=await Cn({network:this.getNetwork(),value:e});return t},dh=async function(e,t,n){let i=this._getAddress(t),a=this._getBlockTag(n);return(typeof i!="string"||typeof a!="string")&&([i,a]=await Promise.all([i,a])),await ge(this,Xe,fy).call(this,ge(this,Xe,es).call(this,Object.assign(e,{address:i,blockTag:a})))},dy=async function(e,t){if(Et(e,32))return await ge(this,Xe,es).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let n=this._getBlockTag(e);return typeof n!="string"&&(n=await n),await ge(this,Xe,es).call(this,{method:"getBlock",blockTag:n,includeTransactions:t})},gh=async function(e,t){let n=await hp(e,this);return n.type==="event"&&t&&t.length>0&&t[0].removed===!0&&(n=await hp({orphan:"drop-log",log:t[0]},this)),L(this,Sn).get(n.tag)||null},hd=async function(e){const t=await hp(e,this),n=t.tag;let i=L(this,Sn).get(n);return i||(i={subscriber:this._getSubscriber(t),tag:n,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},L(this,Sn).set(n,i)),i};function p5(s,e){try{const t=gy(s,e);if(t)return Rd(t)}catch{}return null}function gy(s,e){if(s==="0x")return null;try{const t=Ve(Nt(s,e,e+32)),n=Ve(Nt(s,t,t+32));return Nt(s,t+32,t+32+n)}catch{}return null}function zA(s){const e=On(s);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function y5(s){if(s.length%32===0)return s;const e=new Uint8Array(Math.ceil(s.length/32)*32);return e.set(s),e}const v5=new Uint8Array([]);function x5(s){const e=[];let t=0;for(let n=0;n<s.length;n++)e.push(v5),t+=32;for(let n=0;n<s.length;n++){const i=nt(s[n]);e[n]=zA(t),e.push(zA(i.length)),e.push(y5(i)),t+=32+Math.ceil(i.length/32)*32}return Ht(e)}const VA="0x0000000000000000000000000000000000000000000000000000000000000000";function E5(s){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};fe(Jo(s)>=5*32,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const t=Nt(s,0,32);fe(Nt(t,0,12)===Nt(VA,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=Nt(t,12);try{const n=[],i=Ve(Nt(s,32,64)),a=Ve(Nt(s,i,i+32)),l=Nt(s,i+32);for(let c=0;c<a;c++){const h=p5(l,c*32);if(h==null)throw new Error("abort");n.push(h)}e.urls=n}catch{fe(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const n=gy(s,64);if(n==null)throw new Error("abort");e.calldata=n}catch{fe(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}fe(Nt(s,100,128)===Nt(VA,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=Nt(s,96,100);try{const n=gy(s,128);if(n==null)throw new Error("abort");e.extraData=n}catch{fe(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(n=>e[n]),e}function Bo(s,e){if(s.provider)return s.provider;fe(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function KA(s,e){let t=Nd(e);if(t.to!=null&&(t.to=Pn(t.to,s)),t.from!=null){const n=t.from;t.from=Promise.all([s.getAddress(),Pn(n,s)]).then(([i,a])=>(H(i.toLowerCase()===a.toLowerCase(),"transaction from mismatch","tx.from",a),i))}else t.from=s.getAddress();return await Cn(t)}class b5{constructor(e){X(this,"provider");Oe(this,{provider:e||null})}async getNonce(e){return Bo(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await KA(this,e)}async populateTransaction(e){const t=Bo(this,"populateTransaction"),n=await KA(this,e);n.nonce==null&&(n.nonce=await this.getNonce("pending")),n.gasLimit==null&&(n.gasLimit=await this.estimateGas(n));const i=await this.provider.getNetwork();if(n.chainId!=null){const l=we(n.chainId);H(l===i.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else n.chainId=i.chainId;const a=n.maxFeePerGas!=null||n.maxPriorityFeePerGas!=null;if(n.gasPrice!=null&&(n.type===2||a)?H(!1,"eip-1559 transaction do not support gasPrice","tx",e):(n.type===0||n.type===1)&&a&&H(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(n.type===2||n.type==null)&&n.maxFeePerGas!=null&&n.maxPriorityFeePerGas!=null)n.type=2;else if(n.type===0||n.type===1){const l=await t.getFeeData();fe(l.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),n.gasPrice==null&&(n.gasPrice=l.gasPrice)}else{const l=await t.getFeeData();if(n.type==null)if(l.maxFeePerGas!=null&&l.maxPriorityFeePerGas!=null)if(n.type=2,n.gasPrice!=null){const c=n.gasPrice;delete n.gasPrice,n.maxFeePerGas=c,n.maxPriorityFeePerGas=c}else n.maxFeePerGas==null&&(n.maxFeePerGas=l.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=l.maxPriorityFeePerGas);else l.gasPrice!=null?(fe(!a,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),n.gasPrice==null&&(n.gasPrice=l.gasPrice),n.type=0):fe(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(n.type===2||n.type===3)&&(n.maxFeePerGas==null&&(n.maxFeePerGas=l.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=l.maxPriorityFeePerGas))}return await Cn(n)}async estimateGas(e){return Bo(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return Bo(this,"call").call(await this.populateCall(e))}async resolveName(e){return await Bo(this,"resolveName").resolveName(e)}async sendTransaction(e){const t=Bo(this,"sendTransaction"),n=await this.populateTransaction(e);delete n.from;const i=Md.from(n);return await t.broadcastTransaction(await this.signTransaction(i))}}function A5(s){return JSON.parse(JSON.stringify(s))}var Dn,vi,Dl,Aa,Cl,Gc,Da,my,py;class FR{constructor(e){ne(this,Da);ne(this,Dn);ne(this,vi);ne(this,Dl);ne(this,Aa);ne(this,Cl);ne(this,Gc);P(this,Dn,e),P(this,vi,null),P(this,Dl,ge(this,Da,my).bind(this)),P(this,Aa,!1),P(this,Cl,null),P(this,Gc,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){L(this,Aa)||(P(this,Aa,!0),ge(this,Da,my).call(this,-2))}stop(){L(this,Aa)&&(P(this,Aa,!1),P(this,Gc,!0),ge(this,Da,py).call(this),L(this,Dn).off("block",L(this,Dl)))}pause(e){e&&ge(this,Da,py).call(this),L(this,Dn).off("block",L(this,Dl))}resume(){this.start()}}Dn=new WeakMap,vi=new WeakMap,Dl=new WeakMap,Aa=new WeakMap,Cl=new WeakMap,Gc=new WeakMap,Da=new WeakSet,my=async function(e){try{L(this,vi)==null&&P(this,vi,this._subscribe(L(this,Dn)));let t=null;try{t=await L(this,vi)}catch(a){if(!pn(a,"UNSUPPORTED_OPERATION")||a.operation!=="eth_newFilter")throw a}if(t==null){P(this,vi,null),L(this,Dn)._recoverSubscriber(this,this._recover(L(this,Dn)));return}const n=await L(this,Dn).getNetwork();if(L(this,Cl)||P(this,Cl,n),L(this,Cl).chainId!==n.chainId)throw new Error("chaid changed");if(L(this,Gc))return;const i=await L(this,Dn).send("eth_getFilterChanges",[t]);await this._emitResults(L(this,Dn),i)}catch(t){console.log("@TODO",t)}L(this,Dn).once("block",L(this,Dl))},py=function(){const e=L(this,vi);e&&(P(this,vi,null),e.then(t=>{L(this,Dn).destroyed||L(this,Dn).send("eth_uninstallFilter",[t])}))};var _l;class S5 extends FR{constructor(t,n){super(t);ne(this,_l);P(this,_l,A5(n))}_recover(t){return new m3(t,L(this,_l))}async _subscribe(t){return await t.send("eth_newFilter",[L(this,_l)])}async _emitResults(t,n){for(const i of n)t.emit(L(this,_l),t._wrapLog(i,t._network))}}_l=new WeakMap;class T5 extends FR{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const n of t)e.emit("pending",n)}}const w5="bigint,boolean,function,number,string,symbol".split(/,/g);function fd(s){if(s==null||w5.indexOf(typeof s)>=0||typeof s.getAddress=="function")return s;if(Array.isArray(s))return s.map(fd);if(typeof s=="object")return Object.keys(s).reduce((e,t)=>(e[t]=s[t],e),{});throw new Error(`should not happen: ${s} (${typeof s})`)}function R5(s){return new Promise(e=>{setTimeout(e,s)})}function Uo(s){return s&&s.toLowerCase()}function YA(s){return s&&typeof s.pollingInterval=="number"}const GR={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class dp extends b5{constructor(t,n){super(t);X(this,"address");n=mt(n),Oe(this,{address:n})}connect(t){fe(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const n=fd(t),i=[];if(n.from){const l=n.from;i.push((async()=>{const c=await Pn(l,this.provider);H(c!=null&&c.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=c})())}else n.from=this.address;if(n.gasLimit==null&&i.push((async()=>{n.gasLimit=await this.provider.estimateGas({...n,from:this.address})})()),n.to!=null){const l=n.to;i.push((async()=>{n.to=await Pn(l,this.provider)})())}i.length&&await Promise.all(i);const a=this.provider.getRpcTransaction(n);return this.provider.send("eth_sendTransaction",[a])}async sendTransaction(t){const n=await this.provider.getBlockNumber(),i=await this.sendUncheckedTransaction(t);return await new Promise((a,l)=>{const c=[1e3,100];let h=0;const f=async()=>{try{const g=await this.provider.getTransaction(i);if(g!=null){a(g.replaceableTransaction(n));return}}catch(g){if(pn(g,"CANCELLED")||pn(g,"BAD_DATA")||pn(g,"NETWORK_ERROR")||pn(g,"UNSUPPORTED_OPERATION")){g.info==null&&(g.info={}),g.info.sendTransactionHash=i,l(g);return}if(pn(g,"INVALID_ARGUMENT")&&(h++,g.info==null&&(g.info={}),g.info.sendTransactionHash=i,h>10)){l(g);return}this.provider.emit("error",Pt("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:g}))}this.provider._setTimeout(()=>{f()},c.pop()||4e3)};f()})}async signTransaction(t){const n=fd(t);if(n.from){const a=await Pn(n.from,this.provider);H(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=a}else n.from=this.address;const i=this.provider.getRpcTransaction(n);return await this.provider.send("eth_signTransaction",[i])}async signMessage(t){const n=typeof t=="string"?br(t):t;return await this.provider.send("personal_sign",[Ae(n),this.address.toLowerCase()])}async signTypedData(t,n,i){const a=fd(i),l=await Pd.resolveNames(t,n,a,async c=>{const h=await Pn(c);return H(h!=null,"TypedData does not support null address","value",c),h});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(Pd.getPayload(l.domain,n,l.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const n=typeof t=="string"?br(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),Ae(n)])}}var Ol,$c,mr,xi,Ys,ks,Hn,Xh,yy;class L5 extends m5{constructor(t,n){super(t,n);ne(this,Xh);ne(this,Ol);ne(this,$c);ne(this,mr);ne(this,xi);ne(this,Ys);ne(this,ks);ne(this,Hn);P(this,$c,1),P(this,Ol,Object.assign({},GR,n||{})),P(this,mr,[]),P(this,xi,null),P(this,ks,null),P(this,Hn,null);{let a=null;const l=new Promise(c=>{a=c});P(this,Ys,{promise:l,resolve:a})}const i=this._getOption("staticNetwork");typeof i=="boolean"?(H(!i||t!=="any","staticNetwork cannot be used on special network 'any'","options",n),i&&t!=null&&P(this,ks,Li.from(t))):i&&(H(t==null||i.matches(t),"staticNetwork MUST match network object","options",n),P(this,ks,i))}_getOption(t){return L(this,Ol)[t]}get _network(){return fe(L(this,ks),"network is not available yet","NETWORK_ERROR"),L(this,ks)}async _perform(t){if(t.method==="call"||t.method==="estimateGas"){let i=t.transaction;if(i&&i.type!=null&&we(i.type)&&i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null){const a=await this.getFeeData();a.maxFeePerGas==null&&a.maxPriorityFeePerGas==null&&(t=Object.assign({},t,{transaction:Object.assign({},i,{type:void 0})}))}}const n=this.getRpcRequest(t);return n!=null?await this.send(n.method,n.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t)if(t===!0){if(L(this,ks))return L(this,ks)}else return t;return L(this,Hn)?await L(this,Hn):this.ready?(P(this,Hn,(async()=>{try{const n=Li.from(we(await this.send("eth_chainId",[])));return P(this,Hn,null),n}catch(n){throw P(this,Hn,null),n}})()),await L(this,Hn)):(P(this,Hn,(async()=>{const n={id:Wu(this,$c)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:n});let i;try{i=(await this._send(n))[0],P(this,Hn,null)}catch(a){throw P(this,Hn,null),this.emit("debug",{action:"receiveRpcError",error:a}),a}if(this.emit("debug",{action:"receiveRpcResult",result:i}),"result"in i)return Li.from(we(i.result));throw this.getRpcError(n,i)})()),await L(this,Hn))}_start(){L(this,Ys)==null||L(this,Ys).resolve==null||(L(this,Ys).resolve(),P(this,Ys,null),(async()=>{for(;L(this,ks)==null&&!this.destroyed;)try{P(this,ks,await this._detectNetwork())}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",Pt("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await R5(1e3)}ge(this,Xh,yy).call(this)})())}async _waitUntilReady(){if(L(this,Ys)!=null)return await L(this,Ys).promise}_getSubscriber(t){return t.type==="pending"?new T5(this):t.type==="event"?this._getOption("polling")?new m3(this,t.filter):new S5(this,t.filter):t.type==="orphan"&&t.filter.orphan==="drop-log"?new UR("orphan"):super._getSubscriber(t)}get ready(){return L(this,Ys)==null}getRpcTransaction(t){const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(i=>{if(t[i]==null)return;let a=i;i==="gasLimit"&&(a="gas"),n[a]=Ko(we(t[i],`tx.${i}`))}),["from","to","data"].forEach(i=>{t[i]!=null&&(n[i]=Ae(t[i]))}),t.accessList&&(n.accessList=Yl(t.accessList)),t.blobVersionedHashes&&(n.blobVersionedHashes=t.blobVersionedHashes.map(i=>i.toLowerCase())),n}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[Uo(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[Uo(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[Uo(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[Uo(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&t.filter.address!=null&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(Uo):t.filter.address=Uo(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,n){const{method:i}=t,{error:a}=n;if(i==="eth_estimateGas"&&a.message){const h=a.message;if(!h.match(/revert/i)&&h.match(/insufficient funds/i))return Pt("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:a}})}if(i==="eth_call"||i==="eth_estimateGas"){const h=vy(a),f=Bh.getBuiltinCallException(i==="eth_call"?"call":"estimateGas",t.params[0],h?h.data:null);return f.info={error:a,payload:t},f}const l=JSON.stringify(I5(a));if(typeof a.message=="string"&&a.message.match(/user denied|ethers-user-denied/i))return Pt("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[i]||"unknown",reason:"rejected",info:{payload:t,error:a}});if(i==="eth_sendRawTransaction"||i==="eth_sendTransaction"){const h=t.params[0];if(l.match(/insufficient funds|base fee exceeds gas limit/i))return Pt("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:h,info:{error:a}});if(l.match(/nonce/i)&&l.match(/too low/i))return Pt("nonce has already been used","NONCE_EXPIRED",{transaction:h,info:{error:a}});if(l.match(/replacement transaction/i)&&l.match(/underpriced/i))return Pt("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:h,info:{error:a}});if(l.match(/only replay-protected/i))return Pt("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:i,info:{transaction:h,info:{error:a}}})}let c=!!l.match(/the method .* does not exist/i);return c||a&&a.details&&a.details.startsWith("Unauthorized method:")&&(c=!0),c?Pt("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:a,payload:t}}):Pt("could not coalesce error","UNKNOWN_ERROR",{error:a,payload:t})}send(t,n){if(this.destroyed)return Promise.reject(Pt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const i=Wu(this,$c)._++,a=new Promise((l,c)=>{L(this,mr).push({resolve:l,reject:c,payload:{method:t,params:n,id:i,jsonrpc:"2.0"}})});return ge(this,Xh,yy).call(this),a}async getSigner(t){t==null&&(t=0);const n=this.send("eth_accounts",[]);if(typeof t=="number"){const a=await n;if(t>=a.length)throw new Error("no such account");return new dp(this,a[t])}const{accounts:i}=await Cn({network:this.getNetwork(),accounts:n});t=mt(t);for(const a of i)if(mt(a)===t)return new dp(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(n=>new dp(this,n))}destroy(){L(this,xi)&&(clearTimeout(L(this,xi)),P(this,xi,null));for(const{payload:t,reject:n}of L(this,mr))n(Pt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));P(this,mr,[]),super.destroy()}}Ol=new WeakMap,$c=new WeakMap,mr=new WeakMap,xi=new WeakMap,Ys=new WeakMap,ks=new WeakMap,Hn=new WeakMap,Xh=new WeakSet,yy=function(){if(L(this,xi))return;const t=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");P(this,xi,setTimeout(()=>{P(this,xi,null);const n=L(this,mr);for(P(this,mr,[]);n.length;){const i=[n.shift()];for(;n.length&&i.length!==L(this,Ol).batchMaxCount;)if(i.push(n.shift()),JSON.stringify(i.map(l=>l.payload)).length>L(this,Ol).batchMaxSize){n.unshift(i.pop());break}(async()=>{const a=i.length===1?i[0].payload:i.map(l=>l.payload);this.emit("debug",{action:"sendRpcPayload",payload:a});try{const l=await this._send(a);this.emit("debug",{action:"receiveRpcResult",result:l});for(const{resolve:c,reject:h,payload:f}of i){if(this.destroyed){h(Pt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:f.method}));continue}const g=l.filter(m=>m.id===f.id)[0];if(g==null){const m=Pt("missing response for request","BAD_DATA",{value:l,info:{payload:f}});this.emit("error",m),h(m);continue}if("error"in g){h(this.getRpcError(f,g));continue}c(g.result)}}catch(l){this.emit("debug",{action:"receiveRpcError",error:l});for(const{reject:c}of i)c(l)}})()}},t))};var Sa;class k5 extends L5{constructor(t,n){super(t,n);ne(this,Sa);let i=this._getOption("pollingInterval");i==null&&(i=GR.pollingInterval),P(this,Sa,i)}_getSubscriber(t){const n=super._getSubscriber(t);return YA(n)&&(n.pollingInterval=L(this,Sa)),n}get pollingInterval(){return L(this,Sa)}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");P(this,Sa,t),this._forEachSubscriber(n=>{YA(n)&&(n.pollingInterval=L(this,Sa))})}}Sa=new WeakMap;function vy(s){if(s==null)return null;if(typeof s.message=="string"&&s.message.match(/revert/i)&&Et(s.data))return{message:s.message,data:s.data};if(typeof s=="object"){for(const e in s){const t=vy(s[e]);if(t)return t}return null}if(typeof s=="string")try{return vy(JSON.parse(s))}catch{}return null}function xy(s,e){if(s!=null){if(typeof s.message=="string"&&e.push(s.message),typeof s=="object")for(const t in s)xy(s[t],e);if(typeof s=="string")try{return xy(JSON.parse(s),e)}catch{}}}function I5(s){const e=[];return xy(s,e),e}var Hc;class $R extends k5{constructor(t,n,i){const a=Object.assign({},i??{},{batchMaxCount:1});H(t&&t.request,"invalid EIP-1193 provider","ethereum",t);super(n,a);ne(this,Hc);P(this,Hc,async(l,c)=>{const h={method:l,params:c};this.emit("debug",{action:"sendEip1193Request",payload:h});try{const f=await t.request(h);return this.emit("debug",{action:"receiveEip1193Result",result:f}),f}catch(f){const g=new Error(f.message);throw g.code=f.code,g.data=f.data,g.payload=h,this.emit("debug",{action:"receiveEip1193Error",error:g}),g}})}async send(t,n){return await this._start(),await super.send(t,n)}async _send(t){H(!Array.isArray(t),"EIP-1193 does not support batch request","payload",t);try{const n=await L(this,Hc).call(this,t.method,t.params||[]);return[{id:t.id,result:n}]}catch(n){return[{id:t.id,error:{code:n.code,data:n.data,message:n.message}}]}}getRpcError(t,n){switch(n=JSON.parse(JSON.stringify(n)),n.error.code||-1){case 4001:n.error.message=`ethers-user-denied: ${n.error.message}`;break;case 4200:n.error.message=`ethers-unsupported: ${n.error.message}`;break}return super.getRpcError(t,n)}async hasSigner(t){t==null&&(t=0);const n=await this.send("eth_accounts",[]);return typeof t=="number"?n.length>t:(t=t.toLowerCase(),n.filter(i=>i.toLowerCase()===t).length!==0)}async getSigner(t){if(t==null&&(t=0),!await this.hasSigner(t))try{await L(this,Hc).call(this,"eth_requestAccounts",[])}catch(n){const i=n.payload;throw this.getRpcError(i,{id:i.id,error:n})}return await super.getSigner(t)}}Hc=new WeakMap;const D5=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"score",type:"uint8"}],name:"DealerScore",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"label",type:"string"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"DebugUint",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"label",type:"string"},{indexed:!1,internalType:"uint8[]",name:"values",type:"uint8[]"}],name:"DebugUintArray",type:"event"},{inputs:[{internalType:"uint256",name:"gameId",type:"uint256"},{internalType:"bytes32",name:"seed",type:"bytes32"},{internalType:"uint8[]",name:"revealedCards",type:"uint8[]"},{internalType:"uint8",name:"playerCardCount",type:"uint8"}],name:"endGame",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"gameId",type:"uint256"},{indexed:!0,internalType:"address",name:"player",type:"address"},{indexed:!1,internalType:"uint256",name:"bet",type:"uint256"},{indexed:!1,internalType:"bytes32",name:"deckHash",type:"bytes32"}],name:"GameCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"gameId",type:"uint256"},{indexed:!1,internalType:"bool",name:"playerWon",type:"bool"},{indexed:!1,internalType:"string",name:"message",type:"string"}],name:"GameEnded",type:"event"},{inputs:[{internalType:"bytes32",name:"deckHash",type:"bytes32"}],name:"newGame",outputs:[],stateMutability:"payable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"score",type:"uint8"}],name:"PlayerScore",type:"event"},{inputs:[{internalType:"address payable",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Withdraw",type:"event"},{stateMutability:"payable",type:"receive"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"games",outputs:[{internalType:"address",name:"player",type:"address"},{internalType:"uint256",name:"bet",type:"uint256"},{internalType:"bytes32",name:"deckHash",type:"bytes32"},{internalType:"bool",name:"isActive",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_gameId",type:"uint256"}],name:"getGameInfo",outputs:[{internalType:"address",name:"player",type:"address"},{internalType:"uint256",name:"bet",type:"uint256"},{internalType:"bytes32",name:"deckSeed",type:"bytes32"},{internalType:"bool",name:"isActive",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextGameId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"seed",type:"bytes32"}],name:"testShuffle",outputs:[{internalType:"uint8[52]",name:"",type:"uint8[52]"}],stateMutability:"pure",type:"function"}],C5="0xb957db5e482cd63d2e42244594eec09bea22fa0c",jA=async()=>{if(!window.ethereum)throw new Error("請安裝 MetaMask");const e=await new $R(window.ethereum).getSigner();return new sc(C5,D5,e)},_5=(s,e,t,n)=>{const[i,a]=J.useState({canHit:!1,canStand:!1,canDouble:!1,canSplit:!1,canSurrender:!1,canInsurance:!1});return J.useEffect(()=>{if(!t){a({canHit:!1,canStand:!1,canDouble:!1,canSplit:!1,canSurrender:!1,canInsurance:!1});return}if(n){a(()=>({canHit:!1,canStand:!1,canDouble:!1,canSplit:!1,canSurrender:!1,canInsurance:!1}));return}const l=O5(s),c=typeof l=="string"&&l.includes("Bust"),h=s.length===2&&l==="21! Blackjack!";a({canHit:!c&&!h,canStand:!c&&t,canDouble:s.length===2&&!c,canSplit:s.length===2&&M5(s),canSurrender:s.length===2,canInsurance:e.length>0&&P5(e[1])&&s.length===2})},[s,e,t,n]),i};function O5(s){let e=0,t=0;for(const i of s){const a=i%13+1;a===1?(t++,e+=11):a>=10?e+=10:e+=a}let n=e;for(;n>21&&t>0;)n-=10,t--;return n>21?`${n} Bust🧨`:n===21&&s.length===2?"21! Blackjack!":n}function M5(s){const e=s[0]%13+1,t=s[1]%13+1;return s.length===2&&e===t}function P5(s){return s%13+1===1}function N5({onConnect:s,onClose:e}){return me.jsx("div",{className:"fixed inset-0 bg-[#000000c8] flex items-center justify-center z-40",children:me.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 w-[90%] max-w-md",children:[me.jsx("h2",{className:"text-xl font-semibold mb-4 text-center text-[#000000]",children:"Connect To wallet"}),me.jsxs("div",{className:"flex flex-col gap-3",children:[me.jsx("button",{onClick:s,className:"px-6 py-2 rounded-md bg-black text-white hover:bg-blue-500 cursor-pointer transition-colors duration-200",children:"MetaMask"}),me.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700  hover:underline text-sm text-center",children:"Cancel (Test Mode)"})]})]})})}function p3(s,{strict:e=!0}={}){return!s||typeof s!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(s):s.startsWith("0x")}function QA(s){return p3(s,{strict:!1})?Math.ceil((s.length-2)/2):s.length}const HR="2.29.0";let ah={getDocsUrl:({docsBaseUrl:s,docsPath:e="",docsSlug:t})=>e?`${s??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${HR}`};class Zs extends Error{constructor(e,t={}){var c;const n=(()=>{var h;return t.cause instanceof Zs?t.cause.details:(h=t.cause)!=null&&h.message?t.cause.message:t.details})(),i=t.cause instanceof Zs&&t.cause.docsPath||t.docsPath,a=(c=ah.getDocsUrl)==null?void 0:c.call(ah,{...t,docsPath:i}),l=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...a?[`Docs: ${a}`]:[],...n?[`Details: ${n}`]:[],...ah.version?[`Version: ${ah.version}`]:[]].join(`
`);super(l,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=i,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=HR}walk(e){return zR(this,e)}}function zR(s,e){return e!=null&&e(s)?s:s&&typeof s=="object"&&"cause"in s&&s.cause!==void 0?zR(s.cause,e):e?null:s}class B5 extends Zs{constructor({expectedLength:e,givenLength:t}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${e}`,`Given length (values): ${t}`].join(`
`),{name:"AbiEncodingLengthMismatchError"})}}class U5 extends Zs{constructor({expectedSize:e,givenSize:t}){super(`Expected bytes${e}, got bytes${t}.`,{name:"BytesSizeMismatchError"})}}class F5 extends Zs{constructor(e){super(`Type "${e}" is not supported for packed encoding.`,{name:"UnsupportedPackedAbiType"})}}class VR extends Zs{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function Sr(s,{dir:e,size:t=32}={}){return typeof s=="string"?G5(s,{dir:e,size:t}):$5(s,{dir:e,size:t})}function G5(s,{dir:e,size:t=32}={}){if(t===null)return s;const n=s.replace("0x","");if(n.length>t*2)throw new VR({size:Math.ceil(n.length/2),targetSize:t,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function $5(s,{dir:e,size:t=32}={}){if(t===null)return s;if(s.length>t)throw new VR({size:s.length,targetSize:t,type:"bytes"});const n=new Uint8Array(t);for(let i=0;i<t;i++){const a=e==="right";n[a?i:t-i-1]=s[a?i:s.length-i-1]}return n}class H5 extends Zs{constructor({max:e,min:t,signed:n,size:i,value:a}){super(`Number "${a}" is not in safe ${i?`${i*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class z5 extends Zs{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function of(s,{size:e}){if(QA(s)>e)throw new z5({givenSize:QA(s),maxSize:e})}const V5=Array.from({length:256},(s,e)=>e.toString(16).padStart(2,"0"));function K5(s,e={}){return typeof s=="number"||typeof s=="bigint"?y3(s,e):typeof s=="string"?jR(s,e):typeof s=="boolean"?KR(s,e):YR(s,e)}function KR(s,e={}){const t=`0x${Number(s)}`;return typeof e.size=="number"?(of(t,{size:e.size}),Sr(t,{size:e.size})):t}function YR(s,e={}){let t="";for(let i=0;i<s.length;i++)t+=V5[s[i]];const n=`0x${t}`;return typeof e.size=="number"?(of(n,{size:e.size}),Sr(n,{dir:"right",size:e.size})):n}function y3(s,e={}){const{signed:t,size:n}=e,i=BigInt(s);let a;n?t?a=(1n<<BigInt(n)*8n-1n)-1n:a=2n**(BigInt(n)*8n)-1n:typeof s=="number"&&(a=BigInt(Number.MAX_SAFE_INTEGER));const l=typeof a=="bigint"&&t?-a-1n:0;if(a&&i>a||i<l){const h=typeof s=="bigint"?"n":"";throw new H5({max:a?`${a}${h}`:void 0,min:`${l}${h}`,signed:t,size:n,value:`${s}${h}`})}const c=`0x${(t&&i<0?(1n<<BigInt(n*8))+BigInt(i):i).toString(16)}`;return n?Sr(c,{size:n}):c}const Y5=new TextEncoder;function jR(s,e={}){const t=Y5.encode(s);return YR(t,e)}const j5=new TextEncoder;function Q5(s,e={}){return typeof s=="number"||typeof s=="bigint"?X5(s,e):typeof s=="boolean"?q5(s,e):p3(s)?QR(s,e):qR(s,e)}function q5(s,e={}){const t=new Uint8Array(1);return t[0]=Number(s),typeof e.size=="number"?(of(t,{size:e.size}),Sr(t,{size:e.size})):t}const Xi={zero:48,nine:57,A:65,F:70,a:97,f:102};function qA(s){if(s>=Xi.zero&&s<=Xi.nine)return s-Xi.zero;if(s>=Xi.A&&s<=Xi.F)return s-(Xi.A-10);if(s>=Xi.a&&s<=Xi.f)return s-(Xi.a-10)}function QR(s,e={}){let t=s;e.size&&(of(t,{size:e.size}),t=Sr(t,{dir:"right",size:e.size}));let n=t.slice(2);n.length%2&&(n=`0${n}`);const i=n.length/2,a=new Uint8Array(i);for(let l=0,c=0;l<i;l++){const h=qA(n.charCodeAt(c++)),f=qA(n.charCodeAt(c++));if(h===void 0||f===void 0)throw new Zs(`Invalid byte sequence ("${n[c-2]}${n[c-1]}" in "${n}").`);a[l]=h*16+f}return a}function X5(s,e){const t=y3(s,e);return QR(t)}function qR(s,e={}){const t=j5.encode(s);return typeof e.size=="number"?(of(t,{size:e.size}),Sr(t,{dir:"right",size:e.size})):t}function XA(s){if(!Number.isSafeInteger(s)||s<0)throw new Error("positive integer expected, got "+s)}function W5(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function v3(s,...e){if(!W5(s))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(s.length))throw new Error("Uint8Array expected of length "+e+", got length="+s.length)}function WA(s,e=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(e&&s.finished)throw new Error("Hash#digest() has already been called")}function Z5(s,e){v3(s);const t=e.outputLen;if(s.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Y0=BigInt(2**32-1),ZA=BigInt(32);function J5(s,e=!1){return e?{h:Number(s&Y0),l:Number(s>>ZA&Y0)}:{h:Number(s>>ZA&Y0)|0,l:Number(s&Y0)|0}}function eF(s,e=!1){let t=new Uint32Array(s.length),n=new Uint32Array(s.length);for(let i=0;i<s.length;i++){const{h:a,l}=J5(s[i],e);[t[i],n[i]]=[a,l]}return[t,n]}const tF=(s,e,t)=>s<<t|e>>>32-t,nF=(s,e,t)=>e<<t|s>>>32-t,sF=(s,e,t)=>e<<t-32|s>>>64-t,iF=(s,e,t)=>s<<t-32|e>>>64-t;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function rF(s){return new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4))}const JA=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function aF(s){return s<<24&4278190080|s<<8&16711680|s>>>8&65280|s>>>24&255}function eS(s){for(let e=0;e<s.length;e++)s[e]=aF(s[e])}typeof Uint8Array.from([]).toHex=="function"&&Uint8Array.fromHex;function lF(s){if(typeof s!="string")throw new Error("utf8ToBytes expected string, got "+typeof s);return new Uint8Array(new TextEncoder().encode(s))}function XR(s){return typeof s=="string"&&(s=lF(s)),v3(s),s}class oF{clone(){return this._cloneInto()}}function cF(s){const e=n=>s().update(XR(n)).digest(),t=s();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>s(),e}const WR=[],ZR=[],JR=[],uF=BigInt(0),lh=BigInt(1),hF=BigInt(2),fF=BigInt(7),dF=BigInt(256),gF=BigInt(113);for(let s=0,e=lh,t=1,n=0;s<24;s++){[t,n]=[n,(2*t+3*n)%5],WR.push(2*(5*n+t)),ZR.push((s+1)*(s+2)/2%64);let i=uF;for(let a=0;a<7;a++)e=(e<<lh^(e>>fF)*gF)%dF,e&hF&&(i^=lh<<(lh<<BigInt(a))-lh);JR.push(i)}const[mF,pF]=eF(JR,!0),tS=(s,e,t)=>t>32?sF(s,e,t):tF(s,e,t),nS=(s,e,t)=>t>32?iF(s,e,t):nF(s,e,t);function yF(s,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let l=0;l<10;l++)t[l]=s[l]^s[l+10]^s[l+20]^s[l+30]^s[l+40];for(let l=0;l<10;l+=2){const c=(l+8)%10,h=(l+2)%10,f=t[h],g=t[h+1],m=tS(f,g,1)^t[c],y=nS(f,g,1)^t[c+1];for(let v=0;v<50;v+=10)s[l+v]^=m,s[l+v+1]^=y}let i=s[2],a=s[3];for(let l=0;l<24;l++){const c=ZR[l],h=tS(i,a,c),f=nS(i,a,c),g=WR[l];i=s[g],a=s[g+1],s[g]=h,s[g+1]=f}for(let l=0;l<50;l+=10){for(let c=0;c<10;c++)t[c]=s[l+c];for(let c=0;c<10;c++)s[l+c]^=~t[(c+2)%10]&t[(c+4)%10]}s[0]^=mF[n],s[1]^=pF[n]}t.fill(0)}class x3 extends oF{constructor(e,t,n,i=!1,a=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=i,this.rounds=a,XA(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=rF(this.state)}keccak(){JA||eS(this.state32),yF(this.state32,this.rounds),JA||eS(this.state32),this.posOut=0,this.pos=0}update(e){WA(this);const{blockLen:t,state:n}=this;e=XR(e);const i=e.length;for(let a=0;a<i;){const l=Math.min(t-this.pos,i-a);for(let c=0;c<l;c++)n[this.pos++]^=e[a++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:i}=this;e[n]^=t,(t&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){WA(this,!1),v3(e),this.finish();const t=this.state,{blockLen:n}=this;for(let i=0,a=e.length;i<a;){this.posOut>=n&&this.keccak();const l=Math.min(n-this.posOut,a-i);e.set(t.subarray(this.posOut,this.posOut+l),i),this.posOut+=l,i+=l}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return XA(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Z5(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:i,rounds:a,enableXOF:l}=this;return e||(e=new x3(t,n,i,l,a)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=a,e.suffix=n,e.outputLen=i,e.enableXOF=l,e.destroyed=this.destroyed,e}}const vF=(s,e,t)=>cF(()=>new x3(e,s,t)),xF=vF(1,136,256/8);function eL(s,e){const t=e||"hex",n=xF(p3(s,{strict:!1})?Q5(s):s);return t==="bytes"?n:K5(n)}class EF extends Zs{constructor({address:e}){super(`Address "${e}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}class tL extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const gp=new tL(8192);function bF(s,e){if(gp.has(`${s}.${e}`))return gp.get(`${s}.${e}`);const t=s.substring(2).toLowerCase(),n=eL(qR(t),"bytes"),i=t.split("");for(let l=0;l<40;l+=2)n[l>>1]>>4>=8&&i[l]&&(i[l]=i[l].toUpperCase()),(n[l>>1]&15)>=8&&i[l+1]&&(i[l+1]=i[l+1].toUpperCase());const a=`0x${i.join("")}`;return gp.set(`${s}.${e}`,a),a}const AF=/^0x[a-fA-F0-9]{40}$/,mp=new tL(8192);function SF(s,e){const{strict:t=!0}={},n=`${s}.${t}`;if(mp.has(n))return mp.get(n);const i=AF.test(s)?s.toLowerCase()===s?!0:t?bF(s)===s:!0:!1;return mp.set(n,i),i}function nL(s){return`0x${s.reduce((e,t)=>e+t.replace("0x",""),"")}`}const TF=/^(.*)\[([0-9]*)\]$/,wF=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,RF=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function LF(s,e){if(s.length!==e.length)throw new B5({expectedLength:s.length,givenLength:e.length});const t=[];for(let n=0;n<s.length;n++){const i=s[n],a=e[n];t.push(sL(i,a))}return nL(t)}function sL(s,e,t=!1){if(s==="address"){const l=e;if(!SF(l))throw new EF({address:l});return Sr(l.toLowerCase(),{size:t?32:null})}if(s==="string")return jR(e);if(s==="bytes")return e;if(s==="bool")return Sr(KR(e),{size:t?32:1});const n=s.match(RF);if(n){const[l,c,h="256"]=n,f=Number.parseInt(h)/8;return y3(e,{size:t?32:f,signed:c==="int"})}const i=s.match(wF);if(i){const[l,c]=i;if(Number.parseInt(c)!==(e.length-2)/2)throw new U5({expectedSize:Number.parseInt(c),givenSize:(e.length-2)/2});return Sr(e,{dir:"right",size:t?32:null})}const a=s.match(TF);if(a&&Array.isArray(e)){const[l,c]=a,h=[];for(let f=0;f<e.length;f++)h.push(sL(c,e[f],!0));return h.length===0?"0x":nL(h)}throw new F5(s)}const kF=()=>{const[s,e]=J.useState(!0),[t,n]=J.useState(!1),[i,a]=J.useState(""),[l,c]=J.useState(!1),[h,f]=J.useState(!1),[g,m]=J.useState("betting"),[y,v]=J.useState([]),[x,b]=J.useState(""),[A,S]=J.useState(""),[k,R]=J.useState([]),[_,C]=J.useState(0),[U,O]=J.useState(0),[B,F]=J.useState(0),[M,j]=J.useState(0),[ae,ye]=J.useState([]),[pe,W]=J.useState([]),[G,te]=J.useState(""),[se,Z]=J.useState(""),[I,V]=J.useState([]),[ie,ce]=J.useState([]),[ue,xe]=J.useState(!1),[ve,$e]=J.useState(!1),ke=_5(pe,ae,ue,ve);J.useEffect(()=>()=>{},[y]);const Ne=De=>{let Be=0,Me=0;for(const Ct of De){const at=Ct%13+1;at===1?(Me++,Be+=11):at>=10?Be+=10:Be+=at}let _e=Be,bt=!1;for(console.log(bt);_e>21&&Me>0;)_e-=10,Me--,bt=!0;if(_e>21)return`${_e} Bust🧨`;if(_e===21&&De.length===2)return"21! Blackjack!";if(Me>0&&(_e!==Be||Be===_e)){const Ct=_e-10;if(Ct>0&&_e!==Ct)return`${Ct} / ${_e}`}return _e},Ke=De=>{const Be=["C","D","H","S"],Me=Math.floor(De/13),_e=De%13+1;return`${Be[Me]}_${_e}`},Wt=(De,Be=!1)=>De.length===0?me.jsxs("div",{className:"flex",children:[me.jsx("img",{src:P0("BACK"),alt:"empty-card",className:"w-[80px] h-auto mx-1 drop-shadow-md"}),me.jsx("img",{src:P0("BACK"),alt:"empty-card",className:"w-[80px] h-auto mx-1 drop-shadow-md"})]}):De.map((Me,_e)=>me.jsx("img",{src:P0(Be&&_e===0?"BACK":Me),alt:`card-${_e}`,className:"w-[80px] h-auto mx-1 drop-shadow-md"},_e)),vn=(De,Be)=>{ye(De.map(Me=>Me)),W(Be.map(Me=>Me)),V(De.map(Me=>Ke(Me))),ce(Be.map(Me=>Ke(Me))),te(Ne(De.map(Me=>Number(Me))).toString()),console.log(G),Z(Ne(Be.map(Me=>Number(Me))).toString())},yt=De=>{const Be=De.target.value;isNaN(Be)||F(Be)},Zt=async De=>{const Be=De,Me=[Be[0],Be[1]],_e=[Be[2],Be[3]];vn(Me,_e);const bt=Be.slice(4);R([Me[0],Me[1],_e[0],_e[1]]),C(2),v(bt)},ei=De=>{const Be=Array.from({length:52},(_e,bt)=>bt);let Me=BigInt(De);for(let _e=51;_e>0;_e--){const bt=LF(["uint256","uint256"],[Me,BigInt(_e)]),Ct=eL(bt);Me=BigInt(Ct);const at=Number(Me%BigInt(_e+1));[Be[_e],Be[at]]=[Be[at],Be[_e]]}return Be},Ue=async()=>{try{const De=await jA(),Be=tf(32),Me=Ae(Be),_e=$t(Be);b(Me);const Ct=await(await De.newGame(_e,{value:E8(B.toString())})).wait(),at=await De.queryFilter(De.filters.GameCreated(),Ct.blockNumber,Ct.blockNumber);if(at.length>0){const cf=at[0].args.gameId;await De.getGameInfo(cf),S(cf.toString());const ni=ei(Me);Zt(ni)}else console.warn("⚠️ Missing GameCreated Event (queryFilter)")}catch(De){console.error("❌ Error Code:",De)}},Tt=async(De,Be)=>{var Me;f(!0);try{const _e=await jA(),Ct=await(await _e.endGame(A,x,De,Be)).wait();(Me=Ct.events)==null||Me.forEach(wt=>{console.log("Event:",wt.event,wt.args)});const at=await _e.queryFilter(_e.filters.GameEnded(),Ct.blockNumber,Ct.blockNumber);if(at.length>0){const wt=at[0];console.log("✅ GameEnded Event:",wt.args)}else console.warn("⚠️ GameEnded event not found in block.")}catch(_e){console.error("❌ handleGameOver error:",_e),a("Failed to submit game result to contract ❌"),n(!0)}},Yt=()=>{const De=y[0],Be=[...k,De];R(Be);const Me=[...pe,De];W(Me);const _e=_+1;C(_e),ce(Me.map(at=>Ke(Number(at))));const bt=Ne(Me.map(at=>Number(at))).toString();Z(bt);const Ct=y.slice(1);v(Ct),N0(Ne(Me.map(at=>Number(at))))>21&&(m("over"),setTimeout(()=>{l&&Tt(Be,_e),m("over"),a("You Bust! 😢"),n(!0)},1e3))},jn=()=>{$e(!0),m("dealer");let De=[...ae],Be=[...y],Me=[...k];const _e=()=>{const bt=Ne(De);if(N0(bt)>=17){ye(De),V(De.map(at=>Ke(Number(at)))),te(bt.toString()),m("over"),setTimeout(async()=>{const at=N0(se),wt=N0(bt);m("over"),at>wt||wt>21?(a("You Win! 🎉"),O(U+M*2)):at<wt?a("You Lose! 😢"):(a("It's a Tie! 🤝"),O(U+M)),n(!0),l&&(await Tt(Me,_),f(!1))},1200);return}const Ct=Be.shift();Ct!==void 0&&(De.push(Ct),Me.push(Ct),ye([...De]),V(De.map(at=>Ke(Number(at)))),v([...Be]),R([...Me])),setTimeout(_e,800)};setTimeout(_e,1e3)},cn=async()=>{if(B<=0||B>U)return alert("Please enter a valid bet amount!");O(U-B),j(Number(B)),l?(m("waiting"),await Ue()):Zt(jN()),m("player"),xe(!0),F(0)},os=()=>{b(""),S(""),R([]),C(0),v([]),ye([]),W([]),V([]),ce([]),te(""),Z(""),$e(!1),xe(!1),m("betting"),a(""),j(0),n(!1)},_s=async()=>{try{if(window.ethereum){const De=await window.ethereum.request({method:"eth_requestAccounts"});if(De&&De.length>0){c(!0);const Me=await new $R(window.ethereum).getBalance(De[0]),_e=x8(Me);O(Number(_e))}}else alert("Please install MetaMask!")}catch(De){console.error("MetaMask Error",De)}finally{e(!1)}},jl=()=>{e(!1),O(2e3)},un=[{label:"Hit",show:ke.canHit,onclick:Yt},{label:"Stand",show:ke.canStand,onclick:jn},{label:"Double",show:ke.canDouble},{label:"Split",show:ke.canSplit},{label:"Surrender",show:ke.canSurrender},{label:"Insurance",show:ke.canInsurance}],Ql=Ne(ve?ae:ae.slice(1)),ti=Ne(pe)?Ne(pe):Ne(pe).toString();return me.jsx("div",{className:"w-full min-h-screen pt-[50px] bg-gradient-to-b from-green-900 to-green-600 flex flex-col items-center justify-center",children:me.jsxs("div",{className:"min-h-[80vh] flex flex-col items-center py-10 px-4 text-white font-semibold",children:[me.jsxs("div",{className:"flex flex-col items-center",children:[me.jsx("h2",{className:"text-xl mb-2",children:"Dealer"}),me.jsx("div",{className:"flex",children:Wt(I,!ve)}),me.jsxs("h2",{className:"mt-1",children:["Dealer Score: ",Ql]})]}),me.jsxs("div",{className:"flex flex-col items-center my-3 relative",children:[me.jsxs("p",{className:"text-white mb-2 text-lg",children:["Your Current Bet Amount: ",U," ETH"]}),me.jsxs("div",{className:"text-lg",children:[g==="over"&&me.jsx("p",{className:"text-yellow-500 animate-pulse py-4",children:"Game Over..."}),g==="dealer"&&me.jsx("p",{className:"text-fuchsia-500 animate-pulse py-4",children:"Dealer Drawing Cards..."}),g==="player"&&me.jsx("p",{className:"text-red-500 animate-pulse py-4",children:"Player turn..."}),g==="waiting"&&me.jsx("p",{className:"text-yellow-500 animate-pulse py-4",children:"Waiting for transaction confirmation..."}),g!=="betting"&&me.jsxs("p",{className:"text-white",children:[" Your Bet Amount: ",M," ETH"]}),g==="betting"&&me.jsxs("div",{className:"flex flex-col items-center",children:[me.jsx("label",{className:"text-white mb-2 text-lg",children:"Place Your Bet"}),me.jsx("input",{value:B,onChange:yt,className:"px-4 py-2 rounded-lg border-2 border-[#1a1a1a] focus:outline-none w-60 text-white",placeholder:"Enter bet amount"}),me.jsx("button",{onClick:cn,className:".common_button mt-4 px-6 py-2 rounded-md bg-black text-white hover:bg-blue-500 cursor-pointer transition-colors duration-200",children:"Bet"})]})]})]}),me.jsxs("div",{className:"flex flex-col items-center",children:[me.jsx("h2",{className:"text-xl mb-2",children:"You"}),me.jsx("div",{className:"flex",children:Wt(ie)}),me.jsxs("h2",{className:"mt-1",children:["Your Score: ",ti]}),me.jsx("div",{className:"flex gap-2 mt-4",children:un.map(De=>De.show&&me.jsx("button",{className:"px-6 py-2 rounded-md bg-black text-white hover:bg-blue-500 cursor-pointer transition-colors duration-200",onClick:De.onclick,children:De.label},De.label))})]}),s&&me.jsx(N5,{onConnect:()=>_s(),onClose:()=>jl()}),t&&me.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:me.jsxs("div",{className:"bg-white rounded-lg p-6 text-center shadow-lg w-[300px]",children:[me.jsx("h2",{className:"text-xl text-black font-bold mb-4",children:i}),h?me.jsx("p",{className:"text-yellow-500 text-lg animate-pulse mt-4",children:"Waiting for transaction confirmation..."}):me.jsx("button",{onClick:()=>os(),className:"mt-4 px-6 py-2 rounded-md bg-black text-white hover:bg-blue-500 cursor-pointer transition-colors duration-200",children:"Confirm"})]})})]})})};function h2(s,e,t,n){return new(t||(t=Promise))(function(i,a){function l(f){try{h(n.next(f))}catch(g){a(g)}}function c(f){try{h(n.throw(f))}catch(g){a(g)}}function h(f){var g;f.done?i(f.value):(g=f.value,g instanceof t?g:new t(function(m){m(g)})).then(l,c)}h((n=n.apply(s,[])).next())})}function wa(s,e){var t,n,i,a,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(h){return function(f){return function(g){if(t)throw new TypeError("Generator is already executing.");for(;l;)try{if(t=1,n&&(i=2&g[0]?n.return:g[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,g[1])).done)return i;switch(n=0,i&&(g=[2&g[0],i.value]),g[0]){case 0:case 1:i=g;break;case 4:return l.label++,{value:g[1],done:!1};case 5:l.label++,n=g[1],g=[0];continue;case 7:g=l.ops.pop(),l.trys.pop();continue;default:if(i=l.trys,!((i=i.length>0&&i[i.length-1])||g[0]!==6&&g[0]!==2)){l=0;continue}if(g[0]===3&&(!i||g[1]>i[0]&&g[1]<i[3])){l.label=g[1];break}if(g[0]===6&&l.label<i[1]){l.label=i[1],i=g;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(g);break}i[2]&&l.ops.pop(),l.trys.pop();continue}g=e.call(s,l)}catch(m){g=[6,m],n=0}finally{t=i=0}if(5&g[0])throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}([h,f])}}}function Ey(s){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&s[e],n=0;if(t)return t.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qs(s,e){var t=typeof Symbol=="function"&&s[Symbol.iterator];if(!t)return s;var n,i,a=t.call(s),l=[];try{for(;(e===void 0||e-- >0)&&!(n=a.next()).done;)l.push(n.value)}catch(c){i={error:c}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(i)throw i.error}}return l}function Si(s,e,t){if(arguments.length===2)for(var n,i=0,a=e.length;i<a;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return s.concat(n||Array.prototype.slice.call(e))}function sS(s,e,t,n,i){for(var a=[],l=5;l<arguments.length;l++)a[l-5]=arguments[l];return h2(this,void 0,void 0,function(){var c,h,f,g,m,y;return wa(this,function(v){switch(v.label){case 0:v.trys.push([0,12,13,14]),c=Ey(a),h=c.next(),v.label=1;case 1:if(h.done)return[3,11];switch(f=h.value,typeof f){case"string":return[3,2];case"number":return[3,4];case"function":return[3,6]}return[3,8];case 2:return[4,IF(s,e,f,t,n,i)];case 3:return v.sent(),[3,10];case 4:return[4,iL(f)];case 5:return v.sent(),[3,10];case 6:return[4,f.apply(void 0,Si([s,e,t,n,i],Qs(a),!1))];case 7:return v.sent(),[3,10];case 8:return[4,f];case 9:v.sent(),v.label=10;case 10:return h=c.next(),[3,1];case 11:return[3,14];case 12:return g=v.sent(),m={error:g},[3,14];case 13:try{h&&!h.done&&(y=c.return)&&y.call(c)}finally{if(m)throw m.error}return[7];case 14:return[2]}})})}function IF(s,e,t,n,i,a){return h2(this,void 0,void 0,function(){var l,c;return wa(this,function(h){switch(h.label){case 0:return l=s.textContent||"",c=function(f,g){var m=Qs(g).slice(0);return Si(Si([],Qs(f),!1),[NaN],!1).findIndex(function(y,v){return m[v]!==y})}(l,t),[4,DF(s,Si(Si([],Qs(_F(l,e,c)),!1),Qs(CF(t,e,c)),!1),n,i,a)];case 1:return h.sent(),[2]}})})}function iL(s){return h2(this,void 0,void 0,function(){return wa(this,function(e){switch(e.label){case 0:return[4,new Promise(function(t){return setTimeout(t,s)})];case 1:return e.sent(),[2]}})})}function DF(s,e,t,n,i){return h2(this,void 0,void 0,function(){var a,l,c,h,f,g,m,y,v,x,b,A,S;return wa(this,function(k){switch(k.label){case 0:if(a=e,i){for(l=0,c=1;c<e.length;c++)if(h=Qs([e[c-1],e[c]],2),f=h[0],(g=h[1]).length>f.length||g===""){l=c;break}a=e.slice(l,e.length)}k.label=1;case 1:k.trys.push([1,6,7,8]),m=Ey(function(R){var _,C,U,O,B,F,M;return wa(this,function(j){switch(j.label){case 0:_=function(ae){return wa(this,function(ye){switch(ye.label){case 0:return[4,{op:function(pe){return requestAnimationFrame(function(){return pe.textContent=ae})},opCode:function(pe){var W=pe.textContent||"";return ae===""||W.length>ae.length?"DELETE":"WRITING"}}];case 1:return ye.sent(),[2]}})},j.label=1;case 1:j.trys.push([1,6,7,8]),C=Ey(R),U=C.next(),j.label=2;case 2:return U.done?[3,5]:(O=U.value,[5,_(O)]);case 3:j.sent(),j.label=4;case 4:return U=C.next(),[3,2];case 5:return[3,8];case 6:return B=j.sent(),F={error:B},[3,8];case 7:try{U&&!U.done&&(M=C.return)&&M.call(C)}finally{if(F)throw F.error}return[7];case 8:return[2]}})}(a)),y=m.next(),k.label=2;case 2:return y.done?[3,5]:(v=y.value,x=v.opCode(s)==="WRITING"?t+t*(Math.random()-.5):n+n*(Math.random()-.5),v.op(s),[4,iL(x)]);case 3:k.sent(),k.label=4;case 4:return y=m.next(),[3,2];case 5:return[3,8];case 6:return b=k.sent(),A={error:b},[3,8];case 7:try{y&&!y.done&&(S=m.return)&&S.call(m)}finally{if(A)throw A.error}return[7];case 8:return[2]}})})}function CF(s,e,t){var n,i;return t===void 0&&(t=0),wa(this,function(a){switch(a.label){case 0:n=e(s),i=n.length,a.label=1;case 1:return t<i?[4,n.slice(0,++t).join("")]:[3,3];case 2:return a.sent(),[3,1];case 3:return[2]}})}function _F(s,e,t){var n,i;return t===void 0&&(t=0),wa(this,function(a){switch(a.label){case 0:n=e(s),i=n.length,a.label=1;case 1:return i>t?[4,n.slice(0,--i).join("")]:[3,3];case 2:return a.sent(),[3,1];case 3:return[2]}})}var OF="index-module_type__E-SaG";(function(s,e){e===void 0&&(e={});var t=e.insertAt;if(typeof document<"u"){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",t==="top"&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=s:i.appendChild(document.createTextNode(s))}})(`.index-module_type__E-SaG::after {
  content: '|';
  animation: index-module_cursor__PQg0P 1.1s infinite step-start;
}

@keyframes index-module_cursor__PQg0P {
  50% {
    opacity: 0;
  }
}
`);var pp=J.memo(J.forwardRef(function(s,e){var t=s.sequence,n=s.repeat,i=s.className,a=s.speed,l=a===void 0?40:a,c=s.deletionSpeed,h=s.omitDeletionAnimation,f=h!==void 0&&h,g=s.preRenderFirstString,m=g!==void 0&&g,y=s.wrapper,v=y===void 0?"span":y,x=s.splitter,b=x===void 0?function(I){return Si([],Qs(I),!1)}:x,A=s.cursor,S=A===void 0||A,k=s.style,R=function(I,V){var ie={};for(var ce in I)Object.prototype.hasOwnProperty.call(I,ce)&&V.indexOf(ce)<0&&(ie[ce]=I[ce]);if(I!=null&&typeof Object.getOwnPropertySymbols=="function"){var ue=0;for(ce=Object.getOwnPropertySymbols(I);ue<ce.length;ue++)V.indexOf(ce[ue])<0&&Object.prototype.propertyIsEnumerable.call(I,ce[ue])&&(ie[ce[ue]]=I[ce[ue]])}return ie}(s,["sequence","repeat","className","speed","deletionSpeed","omitDeletionAnimation","preRenderFirstString","wrapper","splitter","cursor","style"]),_=R["aria-label"],C=R["aria-hidden"],U=R.role;c||(c=l);var O=new Array(2).fill(40);[l,c].forEach(function(I,V){switch(typeof I){case"number":O[V]=Math.abs(I-100);break;case"object":var ie=I.type,ce=I.value;if(typeof ce!="number")break;ie==="keyStrokeDelayInMs"&&(O[V]=ce)}});var B,F,M,j,ae,ye,pe=O[0],W=O[1],G=function(I,V){V===void 0&&(V=null);var ie=J.useRef(V);return J.useEffect(function(){I&&(typeof I=="function"?I(ie.current):I.current=ie.current)},[I]),ie}(e),te=OF;B=i?"".concat(S?te+" ":"").concat(i):S?te:"",F=J.useRef(function(){var I,V=t;n===1/0?I=sS:typeof n=="number"&&(V=Array(1+n).fill(t).flat());var ie=I?Si(Si([],Qs(V),!1),[I],!1):Si([],Qs(V),!1);return sS.apply(void 0,Si([G.current,b,pe,W,f],Qs(ie),!1)),function(){G.current}}),M=J.useRef(),j=J.useRef(!1),ae=J.useRef(!1),ye=Qs(J.useState(0),2)[1],j.current&&(ae.current=!0),J.useEffect(function(){return j.current||(M.current=F.current(),j.current=!0),ye(function(I){return I+1}),function(){ae.current&&M.current&&M.current()}},[]);var se=v,Z=m?t.find(function(I){return typeof I=="string"})||"":null;return lE.createElement(se,{"aria-hidden":C,"aria-label":_,role:U,style:k,className:B,children:_?lE.createElement("span",{"aria-hidden":"true",ref:G,children:Z}):Z,ref:_?void 0:G})}),function(s,e){return!0});const oh=({children:s,onClick:e,className:t="",type:n="button"})=>me.jsx("button",{type:n,onClick:e,className:`px-8 py-3 border-2 border-cyan-400 rounded-xl text-cyan-300 font-medium text-lg hover:bg-cyan-400 hover:text-black transition text-neon-soft inline-block cursor-pointer ${t}`,children:s}),iS=["(T_T)","(ಥ﹏ಥ)","(；＿；)","(ಥ_ಥ)"],MF=()=>{const[s,e]=J.useState(0);return J.useEffect(()=>{const t=setInterval(()=>{e(n=>(n+1)%iS.length)},2e3);return()=>clearInterval(t)},[]),me.jsx("div",{className:"text-4xl md:text-6xl text-cyan-300 text-neon-soft animate-pulse mt-6",children:iS[s]})},PF=()=>{const[s,e]=J.useState("intro"),[t,n]=J.useState(""),[i,a]=J.useState(""),l=yS();return me.jsxs("div",{className:"neon-scan-bg min-h-screen relative flex items-center justify-center px-4 text-center",children:[s==="intro"&&me.jsxs("div",{className:"z-10 space-y-6 animate-fadeIn",children:[me.jsx("h1",{className:"text-4xl md:text-6xl font-bold text-white text-neon",children:"Welcome to Cyber Park"}),me.jsx("p",{className:"text-xl text-cyan-200 text-neon-soft",children:"Feel the glow, embrace the night"}),me.jsx(oh,{onClick:()=>e("name"),children:"Explore"})]}),s==="name"&&me.jsxs("div",{className:"z-10 space-y-10 animate-fadeIn px-4 text-center",children:[me.jsx(pp,{sequence:["What's your name, explorer?",800],speed:50,wrapper:"p",className:"text-2xl md:text-4xl text-cyan-300 text-neon-soft"}),me.jsx("input",{type:"text",value:t,onChange:c=>n(c.target.value),placeholder:"Enter your name",className:"px-4 py-3 w-[280px] md:w-[320px] rounded-lg bg-black border-2 border-cyan-400 text-cyan-300 text-center text-xl focus:outline-none focus:ring-2 focus:ring-cyan-500 mx-auto"}),me.jsx("div",{className:"flex flex-col items-center space-y-4",children:me.jsx(oh,{onClick:()=>{a(t||"Explorer"),e("question")},children:"Confirm"})})]}),s==="question"&&me.jsxs("div",{className:"z-10 animate-fadeIn space-y-8",children:[me.jsx(pp,{sequence:[`Hello ${i}, which part are you interested in?`,1200],speed:55,wrapper:"div",className:"text-2xl md:text-4xl text-cyan-300 text-neon-soft"}),me.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-center space-y-4 md:space-y-0 md:space-x-8",children:[me.jsx(oh,{onClick:()=>e("frontendMessage"),children:"Frontend"}),me.jsx(oh,{onClick:()=>l("/blackjackTable"),children:"Smart Contract"})]})]}),s==="frontendMessage"&&me.jsxs("div",{className:"z-10 space-y-10 animate-fadeIn text-center px-4",children:[me.jsx(pp,{sequence:["Sorry... Frontend is still under construction.",1200],speed:50,wrapper:"div",className:"text-2xl md:text-4xl text-cyan-300 text-neon-soft"}),me.jsx(MF,{}),me.jsx("div",{className:"flex justify-center",children:me.jsx(oh,{onClick:()=>l("/blackjackTable"),children:"Go to Blackjack instead"})})]})]})},rS=["function initializeSystem(config) {","  console.log('[SYSTEM] Booting in neon mode...');","  for (let i = 0; i < config.modules.length; i++) {","    const status = loadModule(config.modules[i]);","    if (!status.success) throw new Error('Module failed: ' + config.modules[i]);","  }","  console.log('[SYSTEM] All modules loaded.');","}","","while (network.isConnected() && retries < MAX_RETRIES) {","  try {","    sendHeartbeatPacket();","    await delay(1000);","  } catch (err) {","    console.warn('Heartbeat failed, retrying...');","    retries++;","  }","}","","if (auth.isValid(token)) {","  session = createSession(user);","  grantAccess(session);","} else {","  logSecurityEvent('Invalid token: ' + token);","  denyAccess();","}","","const neonUI = await import('@neon/ui-core');","neonUI.mount('#main-display', { theme: 'cyberpunk', animate: true });","","fetch('/api/system/data', { headers: { 'Authorization': token } })","  .then(response => response.json())","  .then(systemData => {","    renderDashboard(systemData);","    console.log('[DATA] Dashboard rendered');","  })","  .catch(error => console.error('[ERROR] Data fetch failed:', error));","",">>> SYSTEM READY <<<"],aS=s=>Array.from({length:s},()=>rS[Math.floor(Math.random()*rS.length)]),NF=()=>{const[s,e]=J.useState(!0),t=[...aS(40),...aS(40)];return J.useEffect(()=>{const n=setTimeout(()=>{e(!1)},2e3);return()=>clearTimeout(n)},[]),s?me.jsxs("div",{className:"fixed inset-0 bg-black z-50 font-mono flex flex-col justify-center px-20",children:[me.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none pl-[40px]",children:me.jsx("div",{className:"code-stream animate-marquee h-[200%]",children:me.jsx("div",{className:"pl-16 text-red-500 neon-red text-left text-2xl font-bold leading-relaxed whitespace-pre",children:t.map((n,i)=>me.jsx("p",{children:n},i))})})}),me.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10",children:me.jsx("h1",{className:"neon-red flicker text-[30px] ...",children:"LOADING..."})})]}):null};function BF(){return me.jsxs(me.Fragment,{children:[me.jsx(NF,{}),me.jsxs(KD,{children:[me.jsx(tC,{}),me.jsxs(AD,{children:[me.jsx(j0,{path:"/",element:me.jsx(PF,{})}),me.jsx(j0,{path:"/liveStream",element:me.jsx(YP,{})}),me.jsx(j0,{path:"/blackjackTable",element:me.jsx(kF,{})})]})]})]})}_I.createRoot(document.getElementById("root")).render(me.jsx(J.StrictMode,{children:me.jsx(BF,{})}));
