var jY=Object.defineProperty;var GP=i=>{throw TypeError(i)};var qY=(i,e,t)=>e in i?jY(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var he=(i,e,t)=>qY(i,typeof e!="symbol"?e+"":e,t),vC=(i,e,t)=>e.has(i)||GP("Cannot "+t);var K=(i,e,t)=>(vC(i,e,"read from private field"),t?t.call(i):e.get(i)),je=(i,e,t)=>e.has(i)?GP("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),fe=(i,e,t,n)=>(vC(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),wt=(i,e,t)=>(vC(i,e,"access private method"),t);var fb=(i,e,t,n)=>({set _(s){fe(i,e,s,t)},get _(){return K(i,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function II(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var xC={exports:{}},db={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zP;function QY(){if(zP)return db;zP=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,r){var a=null;if(r!==void 0&&(a=""+r),s.key!==void 0&&(a=""+s.key),"key"in s){r={};for(var o in s)o!=="key"&&(r[o]=s[o])}else r=s;return s=r.ref,{$$typeof:i,type:n,key:a,ref:s!==void 0?s:null,props:r}}return db.Fragment=e,db.jsx=t,db.jsxs=t,db}var VP;function $Y(){return VP||(VP=1,xC.exports=QY()),xC.exports}var Re=$Y(),bC={exports:{}},kn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YP;function JY(){if(YP)return kn;YP=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;function m(z){return z===null||typeof z!="object"?null:(z=d&&z[d]||z["@@iterator"],typeof z=="function"?z:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,_={};function b(z,ae,ge){this.props=z,this.context=ae,this.refs=_,this.updater=ge||y}b.prototype.isReactComponent={},b.prototype.setState=function(z,ae){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,ae,"setState")},b.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function A(){}A.prototype=b.prototype;function T(z,ae,ge){this.props=z,this.context=ae,this.refs=_,this.updater=ge||y}var w=T.prototype=new A;w.constructor=T,x(w,b.prototype),w.isPureReactComponent=!0;var R=Array.isArray,O={H:null,A:null,T:null,S:null},N=Object.prototype.hasOwnProperty;function U(z,ae,ge,Ee,le,Ce){return ge=Ce.ref,{$$typeof:i,type:z,key:ae,ref:ge!==void 0?ge:null,props:Ce}}function P(z,ae){return U(z.type,ae,void 0,void 0,void 0,z.props)}function B(z){return typeof z=="object"&&z!==null&&z.$$typeof===i}function L(z){var ae={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(ge){return ae[ge]})}var F=/\/+/g;function j(z,ae){return typeof z=="object"&&z!==null&&z.key!=null?L(""+z.key):ae.toString(36)}function J(){}function re(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(J,J):(z.status="pending",z.then(function(ae){z.status==="pending"&&(z.status="fulfilled",z.value=ae)},function(ae){z.status==="pending"&&(z.status="rejected",z.reason=ae)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function q(z,ae,ge,Ee,le){var Ce=typeof z;(Ce==="undefined"||Ce==="boolean")&&(z=null);var Me=!1;if(z===null)Me=!0;else switch(Ce){case"bigint":case"string":case"number":Me=!0;break;case"object":switch(z.$$typeof){case i:case e:Me=!0;break;case h:return Me=z._init,q(Me(z._payload),ae,ge,Ee,le)}}if(Me)return le=le(z),Me=Ee===""?"."+j(z,0):Ee,R(le)?(ge="",Me!=null&&(ge=Me.replace(F,"$&/")+"/"),q(le,ae,ge,"",function(Mt){return Mt})):le!=null&&(B(le)&&(le=P(le,ge+(le.key==null||z&&z.key===le.key?"":(""+le.key).replace(F,"$&/")+"/")+Me)),ae.push(le)),1;Me=0;var Ze=Ee===""?".":Ee+":";if(R(z))for(var tt=0;tt<z.length;tt++)Ee=z[tt],Ce=Ze+j(Ee,tt),Me+=q(Ee,ae,ge,Ce,le);else if(tt=m(z),typeof tt=="function")for(z=tt.call(z),tt=0;!(Ee=z.next()).done;)Ee=Ee.value,Ce=Ze+j(Ee,tt++),Me+=q(Ee,ae,ge,Ce,le);else if(Ce==="object"){if(typeof z.then=="function")return q(re(z),ae,ge,Ee,le);throw ae=String(z),Error("Objects are not valid as a React child (found: "+(ae==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":ae)+"). If you meant to render a collection of children, use an array instead.")}return Me}function W(z,ae,ge){if(z==null)return z;var Ee=[],le=0;return q(z,Ee,"","",function(Ce){return ae.call(ge,Ce,le++)}),Ee}function ne(z){if(z._status===-1){var ae=z._result;ae=ae(),ae.then(function(ge){(z._status===0||z._status===-1)&&(z._status=1,z._result=ge)},function(ge){(z._status===0||z._status===-1)&&(z._status=2,z._result=ge)}),z._status===-1&&(z._status=0,z._result=ae)}if(z._status===1)return z._result.default;throw z._result}var ie=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ae=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(ae))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)};function ue(){}return kn.Children={map:W,forEach:function(z,ae,ge){W(z,function(){ae.apply(this,arguments)},ge)},count:function(z){var ae=0;return W(z,function(){ae++}),ae},toArray:function(z){return W(z,function(ae){return ae})||[]},only:function(z){if(!B(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},kn.Component=b,kn.Fragment=t,kn.Profiler=s,kn.PureComponent=T,kn.StrictMode=n,kn.Suspense=l,kn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,kn.act=function(){throw Error("act(...) is not supported in production builds of React.")},kn.cache=function(z){return function(){return z.apply(null,arguments)}},kn.cloneElement=function(z,ae,ge){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var Ee=x({},z.props),le=z.key,Ce=void 0;if(ae!=null)for(Me in ae.ref!==void 0&&(Ce=void 0),ae.key!==void 0&&(le=""+ae.key),ae)!N.call(ae,Me)||Me==="key"||Me==="__self"||Me==="__source"||Me==="ref"&&ae.ref===void 0||(Ee[Me]=ae[Me]);var Me=arguments.length-2;if(Me===1)Ee.children=ge;else if(1<Me){for(var Ze=Array(Me),tt=0;tt<Me;tt++)Ze[tt]=arguments[tt+2];Ee.children=Ze}return U(z.type,le,void 0,void 0,Ce,Ee)},kn.createContext=function(z){return z={$$typeof:a,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:r,_context:z},z},kn.createElement=function(z,ae,ge){var Ee,le={},Ce=null;if(ae!=null)for(Ee in ae.key!==void 0&&(Ce=""+ae.key),ae)N.call(ae,Ee)&&Ee!=="key"&&Ee!=="__self"&&Ee!=="__source"&&(le[Ee]=ae[Ee]);var Me=arguments.length-2;if(Me===1)le.children=ge;else if(1<Me){for(var Ze=Array(Me),tt=0;tt<Me;tt++)Ze[tt]=arguments[tt+2];le.children=Ze}if(z&&z.defaultProps)for(Ee in Me=z.defaultProps,Me)le[Ee]===void 0&&(le[Ee]=Me[Ee]);return U(z,Ce,void 0,void 0,null,le)},kn.createRef=function(){return{current:null}},kn.forwardRef=function(z){return{$$typeof:o,render:z}},kn.isValidElement=B,kn.lazy=function(z){return{$$typeof:h,_payload:{_status:-1,_result:z},_init:ne}},kn.memo=function(z,ae){return{$$typeof:c,type:z,compare:ae===void 0?null:ae}},kn.startTransition=function(z){var ae=O.T,ge={};O.T=ge;try{var Ee=z(),le=O.S;le!==null&&le(ge,Ee),typeof Ee=="object"&&Ee!==null&&typeof Ee.then=="function"&&Ee.then(ue,ie)}catch(Ce){ie(Ce)}finally{O.T=ae}},kn.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},kn.use=function(z){return O.H.use(z)},kn.useActionState=function(z,ae,ge){return O.H.useActionState(z,ae,ge)},kn.useCallback=function(z,ae){return O.H.useCallback(z,ae)},kn.useContext=function(z){return O.H.useContext(z)},kn.useDebugValue=function(){},kn.useDeferredValue=function(z,ae){return O.H.useDeferredValue(z,ae)},kn.useEffect=function(z,ae){return O.H.useEffect(z,ae)},kn.useId=function(){return O.H.useId()},kn.useImperativeHandle=function(z,ae,ge){return O.H.useImperativeHandle(z,ae,ge)},kn.useInsertionEffect=function(z,ae){return O.H.useInsertionEffect(z,ae)},kn.useLayoutEffect=function(z,ae){return O.H.useLayoutEffect(z,ae)},kn.useMemo=function(z,ae){return O.H.useMemo(z,ae)},kn.useOptimistic=function(z,ae){return O.H.useOptimistic(z,ae)},kn.useReducer=function(z,ae,ge){return O.H.useReducer(z,ae,ge)},kn.useRef=function(z){return O.H.useRef(z)},kn.useState=function(z){return O.H.useState(z)},kn.useSyncExternalStore=function(z,ae,ge){return O.H.useSyncExternalStore(z,ae,ge)},kn.useTransition=function(){return O.H.useTransition()},kn.version="19.0.0",kn}var KP;function Vv(){return KP||(KP=1,bC.exports=JY()),bC.exports}var ce=Vv();const mv=II(ce);var AC={exports:{}},pb={},EC={exports:{}},_C={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WP;function ZY(){return WP||(WP=1,function(i){function e(W,ne){var ie=W.length;W.push(ne);e:for(;0<ie;){var ue=ie-1>>>1,z=W[ue];if(0<s(z,ne))W[ue]=ne,W[ie]=z,ie=ue;else break e}}function t(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var ne=W[0],ie=W.pop();if(ie!==ne){W[0]=ie;e:for(var ue=0,z=W.length,ae=z>>>1;ue<ae;){var ge=2*(ue+1)-1,Ee=W[ge],le=ge+1,Ce=W[le];if(0>s(Ee,ie))le<z&&0>s(Ce,Ee)?(W[ue]=Ce,W[le]=ie,ue=le):(W[ue]=Ee,W[ge]=ie,ue=ge);else if(le<z&&0>s(Ce,ie))W[ue]=Ce,W[le]=ie,ue=le;else break e}}return ne}function s(W,ne){var ie=W.sortIndex-ne.sortIndex;return ie!==0?ie:W.id-ne.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();i.unstable_now=function(){return a.now()-o}}var l=[],c=[],h=1,d=null,m=3,y=!1,x=!1,_=!1,b=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function w(W){for(var ne=t(c);ne!==null;){if(ne.callback===null)n(c);else if(ne.startTime<=W)n(c),ne.sortIndex=ne.expirationTime,e(l,ne);else break;ne=t(c)}}function R(W){if(_=!1,w(W),!x)if(t(l)!==null)x=!0,re();else{var ne=t(c);ne!==null&&q(R,ne.startTime-W)}}var O=!1,N=-1,U=5,P=-1;function B(){return!(i.unstable_now()-P<U)}function L(){if(O){var W=i.unstable_now();P=W;var ne=!0;try{e:{x=!1,_&&(_=!1,A(N),N=-1),y=!0;var ie=m;try{t:{for(w(W),d=t(l);d!==null&&!(d.expirationTime>W&&B());){var ue=d.callback;if(typeof ue=="function"){d.callback=null,m=d.priorityLevel;var z=ue(d.expirationTime<=W);if(W=i.unstable_now(),typeof z=="function"){d.callback=z,w(W),ne=!0;break t}d===t(l)&&n(l),w(W)}else n(l);d=t(l)}if(d!==null)ne=!0;else{var ae=t(c);ae!==null&&q(R,ae.startTime-W),ne=!1}}break e}finally{d=null,m=ie,y=!1}ne=void 0}}finally{ne?F():O=!1}}}var F;if(typeof T=="function")F=function(){T(L)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,J=j.port2;j.port1.onmessage=L,F=function(){J.postMessage(null)}}else F=function(){b(L,0)};function re(){O||(O=!0,F())}function q(W,ne){N=b(function(){W(i.unstable_now())},ne)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(W){W.callback=null},i.unstable_continueExecution=function(){x||y||(x=!0,re())},i.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<W?Math.floor(1e3/W):5},i.unstable_getCurrentPriorityLevel=function(){return m},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function(W){switch(m){case 1:case 2:case 3:var ne=3;break;default:ne=m}var ie=m;m=ne;try{return W()}finally{m=ie}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(W,ne){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ie=m;m=W;try{return ne()}finally{m=ie}},i.unstable_scheduleCallback=function(W,ne,ie){var ue=i.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?ue+ie:ue):ie=ue,W){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=ie+z,W={id:h++,callback:ne,priorityLevel:W,startTime:ie,expirationTime:z,sortIndex:-1},ie>ue?(W.sortIndex=ie,e(c,W),t(l)===null&&W===t(c)&&(_?(A(N),N=-1):_=!0,q(R,ie-ue))):(W.sortIndex=z,e(l,W),x||y||(x=!0,re())),W},i.unstable_shouldYield=B,i.unstable_wrapCallback=function(W){var ne=m;return function(){var ie=m;m=ne;try{return W.apply(this,arguments)}finally{m=ie}}}}(_C)),_C}var XP;function BI(){return XP||(XP=1,EC.exports=ZY()),EC.exports}var SC={exports:{}},Ea={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jP;function eK(){if(jP)return Ea;jP=1;var i=Vv();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function r(l,c,h){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:d==null?null:""+d,children:l,containerInfo:c,implementation:h}}var a=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return Ea.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Ea.createPortal=function(l,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return r(l,c,null,h)},Ea.flushSync=function(l){var c=a.T,h=n.p;try{if(a.T=null,n.p=2,l)return l()}finally{a.T=c,n.p=h,n.d.f()}},Ea.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,n.d.C(l,c))},Ea.prefetchDNS=function(l){typeof l=="string"&&n.d.D(l)},Ea.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var h=c.as,d=o(h,c.crossOrigin),m=typeof c.integrity=="string"?c.integrity:void 0,y=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;h==="style"?n.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:m,fetchPriority:y}):h==="script"&&n.d.X(l,{crossOrigin:d,integrity:m,fetchPriority:y,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},Ea.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var h=o(c.as,c.crossOrigin);n.d.M(l,{crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&n.d.M(l)},Ea.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var h=c.as,d=o(h,c.crossOrigin);n.d.L(l,h,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},Ea.preloadModule=function(l,c){if(typeof l=="string")if(c){var h=o(c.as,c.crossOrigin);n.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else n.d.m(l)},Ea.requestFormReset=function(l){n.d.r(l)},Ea.unstable_batchedUpdates=function(l,c){return l(c)},Ea.useFormState=function(l,c,h){return a.H.useFormState(l,c,h)},Ea.useFormStatus=function(){return a.H.useHostTransitionStatus()},Ea.version="19.0.0",Ea}var qP;function tK(){if(qP)return SC.exports;qP=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),SC.exports=eK(),SC.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QP;function nK(){if(QP)return pb;QP=1;var i=BI(),e=Vv(),t=tK();function n(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)f+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}var r=Symbol.for("react.element"),a=Symbol.for("react.transitional.element"),o=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),m=Symbol.for("react.consumer"),y=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),b=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),w=Symbol.for("react.offscreen"),R=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function N(u){return u===null||typeof u!="object"?null:(u=O&&u[O]||u["@@iterator"],typeof u=="function"?u:null)}var U=Symbol.for("react.client.reference");function P(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===U?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case l:return"Fragment";case o:return"Portal";case h:return"Profiler";case c:return"StrictMode";case _:return"Suspense";case b:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case y:return(u.displayName||"Context")+".Provider";case m:return(u._context.displayName||"Context")+".Consumer";case x:var f=u.render;return u=u.displayName,u||(u=f.displayName||f.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case A:return f=u.displayName||null,f!==null?f:P(u.type)||"Memo";case T:f=u._payload,u=u._init;try{return P(u(f))}catch{}}return null}var B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=Object.assign,F,j;function J(u){if(F===void 0)try{throw Error()}catch(v){var f=v.stack.trim().match(/\n( *(at )?)/);F=f&&f[1]||"",j=-1<v.stack.indexOf(`
    at`)?" (<anonymous>)":-1<v.stack.indexOf("@")?"@unknown:0:0":""}return`
`+F+u+j}var re=!1;function q(u,f){if(!u||re)return"";re=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var E={DetermineComponentFrameRoot:function(){try{if(f){var xt=function(){throw Error()};if(Object.defineProperty(xt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xt,[])}catch(at){var Ye=at}Reflect.construct(u,[],xt)}else{try{xt.call()}catch(at){Ye=at}u.call(xt.prototype)}}else{try{throw Error()}catch(at){Ye=at}(xt=u())&&typeof xt.catch=="function"&&xt.catch(function(){})}}catch(at){if(at&&Ye&&typeof at.stack=="string")return[at.stack,Ye.stack]}return[null,null]}};E.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var M=Object.getOwnPropertyDescriptor(E.DetermineComponentFrameRoot,"name");M&&M.configurable&&Object.defineProperty(E.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=E.DetermineComponentFrameRoot(),G=D[0],Q=D[1];if(G&&Q){var pe=G.split(`
`),Te=Q.split(`
`);for(M=E=0;E<pe.length&&!pe[E].includes("DetermineComponentFrameRoot");)E++;for(;M<Te.length&&!Te[M].includes("DetermineComponentFrameRoot");)M++;if(E===pe.length||M===Te.length)for(E=pe.length-1,M=Te.length-1;1<=E&&0<=M&&pe[E]!==Te[M];)M--;for(;1<=E&&0<=M;E--,M--)if(pe[E]!==Te[M]){if(E!==1||M!==1)do if(E--,M--,0>M||pe[E]!==Te[M]){var ct=`
`+pe[E].replace(" at new "," at ");return u.displayName&&ct.includes("<anonymous>")&&(ct=ct.replace("<anonymous>",u.displayName)),ct}while(1<=E&&0<=M);break}}}finally{re=!1,Error.prepareStackTrace=v}return(v=u?u.displayName||u.name:"")?J(v):""}function W(u){switch(u.tag){case 26:case 27:case 5:return J(u.type);case 16:return J("Lazy");case 13:return J("Suspense");case 19:return J("SuspenseList");case 0:case 15:return u=q(u.type,!1),u;case 11:return u=q(u.type.render,!1),u;case 1:return u=q(u.type,!0),u;default:return""}}function ne(u){try{var f="";do f+=W(u),u=u.return;while(u);return f}catch(v){return`
Error generating stack: `+v.message+`
`+v.stack}}function ie(u){var f=u,v=u;if(u.alternate)for(;f.return;)f=f.return;else{u=f;do f=u,(f.flags&4098)!==0&&(v=f.return),u=f.return;while(u)}return f.tag===3?v:null}function ue(u){if(u.tag===13){var f=u.memoizedState;if(f===null&&(u=u.alternate,u!==null&&(f=u.memoizedState)),f!==null)return f.dehydrated}return null}function z(u){if(ie(u)!==u)throw Error(n(188))}function ae(u){var f=u.alternate;if(!f){if(f=ie(u),f===null)throw Error(n(188));return f!==u?null:u}for(var v=u,E=f;;){var M=v.return;if(M===null)break;var D=M.alternate;if(D===null){if(E=M.return,E!==null){v=E;continue}break}if(M.child===D.child){for(D=M.child;D;){if(D===v)return z(M),u;if(D===E)return z(M),f;D=D.sibling}throw Error(n(188))}if(v.return!==E.return)v=M,E=D;else{for(var G=!1,Q=M.child;Q;){if(Q===v){G=!0,v=M,E=D;break}if(Q===E){G=!0,E=M,v=D;break}Q=Q.sibling}if(!G){for(Q=D.child;Q;){if(Q===v){G=!0,v=D,E=M;break}if(Q===E){G=!0,E=D,v=M;break}Q=Q.sibling}if(!G)throw Error(n(189))}}if(v.alternate!==E)throw Error(n(190))}if(v.tag!==3)throw Error(n(188));return v.stateNode.current===v?u:f}function ge(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u;for(u=u.child;u!==null;){if(f=ge(u),f!==null)return f;u=u.sibling}return null}var Ee=Array.isArray,le=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ce={pending:!1,data:null,method:null,action:null},Me=[],Ze=-1;function tt(u){return{current:u}}function Mt(u){0>Ze||(u.current=Me[Ze],Me[Ze]=null,Ze--)}function bt(u,f){Ze++,Me[Ze]=u.current,u.current=f}var cn=tt(null),tn=tt(null),Ot=tt(null),te=tt(null);function At(u,f){switch(bt(Ot,f),bt(tn,u),bt(cn,null),u=f.nodeType,u){case 9:case 11:f=(f=f.documentElement)&&(f=f.namespaceURI)?gP(f):0;break;default:if(u=u===8?f.parentNode:f,f=u.tagName,u=u.namespaceURI)u=gP(u),f=yP(u,f);else switch(f){case"svg":f=1;break;case"math":f=2;break;default:f=0}}Mt(cn),bt(cn,f)}function Ve(){Mt(cn),Mt(tn),Mt(Ot)}function st(u){u.memoizedState!==null&&bt(te,u);var f=cn.current,v=yP(f,u.type);f!==v&&(bt(tn,u),bt(cn,v))}function $e(u){tn.current===u&&(Mt(cn),Mt(tn)),te.current===u&&(Mt(te),ob._currentValue=Ce)}var Pt=Object.prototype.hasOwnProperty,nt=i.unstable_scheduleCallback,ee=i.unstable_cancelCallback,X=i.unstable_shouldYield,we=i.unstable_requestPaint,Fe=i.unstable_now,ut=i.unstable_getCurrentPriorityLevel,We=i.unstable_ImmediatePriority,ot=i.unstable_UserBlockingPriority,et=i.unstable_NormalPriority,pt=i.unstable_LowPriority,vt=i.unstable_IdlePriority,it=i.log,Ct=i.unstable_setDisableYieldValue,Et=null,Dt=null;function Nt(u){if(Dt&&typeof Dt.onCommitFiberRoot=="function")try{Dt.onCommitFiberRoot(Et,u,void 0,(u.current.flags&128)===128)}catch{}}function ve(u){if(typeof it=="function"&&Ct(u),Dt&&typeof Dt.setStrictMode=="function")try{Dt.setStrictMode(Et,u)}catch{}}var He=Math.clz32?Math.clz32:Oe,St=Math.log,xe=Math.LN2;function Oe(u){return u>>>=0,u===0?32:31-(St(u)/xe|0)|0}var Ge=128,rt=4194304;function It(u){var f=u&42;if(f!==0)return f;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function Bt(u,f){var v=u.pendingLanes;if(v===0)return 0;var E=0,M=u.suspendedLanes,D=u.pingedLanes,G=u.warmLanes;u=u.finishedLanes!==0;var Q=v&134217727;return Q!==0?(v=Q&~M,v!==0?E=It(v):(D&=Q,D!==0?E=It(D):u||(G=Q&~G,G!==0&&(E=It(G))))):(Q=v&~M,Q!==0?E=It(Q):D!==0?E=It(D):u||(G=v&~G,G!==0&&(E=It(G)))),E===0?0:f!==0&&f!==E&&(f&M)===0&&(M=E&-E,G=f&-f,M>=G||M===32&&(G&4194176)!==0)?f:E}function $t(u,f){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&f)===0}function Pn(u,f){switch(u){case 1:case 2:case 4:case 8:return f+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gi(){var u=Ge;return Ge<<=1,(Ge&4194176)===0&&(Ge=128),u}function _n(){var u=rt;return rt<<=1,(rt&62914560)===0&&(rt=4194304),u}function ts(u){for(var f=[],v=0;31>v;v++)f.push(u);return f}function cs(u,f){u.pendingLanes|=f,f!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function xh(u,f,v,E,M,D){var G=u.pendingLanes;u.pendingLanes=v,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=v,u.entangledLanes&=v,u.errorRecoveryDisabledLanes&=v,u.shellSuspendCounter=0;var Q=u.entanglements,pe=u.expirationTimes,Te=u.hiddenUpdates;for(v=G&~v;0<v;){var ct=31-He(v),xt=1<<ct;Q[ct]=0,pe[ct]=-1;var Ye=Te[ct];if(Ye!==null)for(Te[ct]=null,ct=0;ct<Ye.length;ct++){var at=Ye[ct];at!==null&&(at.lane&=-536870913)}v&=~xt}E!==0&&Vl(u,E,0),D!==0&&M===0&&u.tag!==0&&(u.suspendedLanes|=D&~(G&~f))}function Vl(u,f,v){u.pendingLanes|=f,u.suspendedLanes&=~f;var E=31-He(f);u.entangledLanes|=f,u.entanglements[E]=u.entanglements[E]|1073741824|v&4194218}function vr(u,f){var v=u.entangledLanes|=f;for(u=u.entanglements;v;){var E=31-He(v),M=1<<E;M&f|u[E]&f&&(u[E]|=f),v&=~M}}function Wr(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function to(){var u=le.p;return u!==0?u:(u=window.event,u===void 0?32:PP(u.type))}function xr(u,f){var v=le.p;try{return le.p=u,f()}finally{le.p=v}}var sn=Math.random().toString(36).slice(2),$i="__reactFiber$"+sn,Ln="__reactProps$"+sn,V="__reactContainer$"+sn,Z="__reactEvents$"+sn,be="__reactListeners$"+sn,ze="__reactHandles$"+sn,Je="__reactResources$"+sn,Xe="__reactMarker$"+sn;function Rt(u){delete u[$i],delete u[Ln],delete u[Z],delete u[be],delete u[ze]}function gt(u){var f=u[$i];if(f)return f;for(var v=u.parentNode;v;){if(f=v[V]||v[$i]){if(v=f.alternate,f.child!==null||v!==null&&v.child!==null)for(u=bP(u);u!==null;){if(v=u[$i])return v;u=bP(u)}return f}u=v,v=u.parentNode}return null}function Y(u){if(u=u[$i]||u[V]){var f=u.tag;if(f===5||f===6||f===13||f===26||f===27||f===3)return u}return null}function oe(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u.stateNode;throw Error(n(33))}function me(u){var f=u[Je];return f||(f=u[Je]={hoistableStyles:new Map,hoistableScripts:new Map}),f}function de(u){u[Xe]=!0}var Ae=new Set,Ne={};function qe(u,f){ft(u,f),ft(u+"Capture",f)}function ft(u,f){for(Ne[u]=f,u=0;u<f.length;u++)Ae.add(f[u])}var dt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ft=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),kt={},Ht={};function ln(u){return Pt.call(Ht,u)?!0:Pt.call(kt,u)?!1:Ft.test(u)?Ht[u]=!0:(kt[u]=!0,!1)}function jt(u,f,v){if(ln(f))if(v===null)u.removeAttribute(f);else{switch(typeof v){case"undefined":case"function":case"symbol":u.removeAttribute(f);return;case"boolean":var E=f.toLowerCase().slice(0,5);if(E!=="data-"&&E!=="aria-"){u.removeAttribute(f);return}}u.setAttribute(f,""+v)}}function Kn(u,f,v){if(v===null)u.removeAttribute(f);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(f);return}u.setAttribute(f,""+v)}}function Jt(u,f,v,E){if(E===null)u.removeAttribute(v);else{switch(typeof E){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(v);return}u.setAttributeNS(f,v,""+E)}}function Yt(u){switch(typeof u){case"bigint":case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function Kt(u){var f=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function Ki(u){var f=Kt(u)?"checked":"value",v=Object.getOwnPropertyDescriptor(u.constructor.prototype,f),E=""+u[f];if(!u.hasOwnProperty(f)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var M=v.get,D=v.set;return Object.defineProperty(u,f,{configurable:!0,get:function(){return M.call(this)},set:function(G){E=""+G,D.call(this,G)}}),Object.defineProperty(u,f,{enumerable:v.enumerable}),{getValue:function(){return E},setValue:function(G){E=""+G},stopTracking:function(){u._valueTracker=null,delete u[f]}}}}function pn(u){u._valueTracker||(u._valueTracker=Ki(u))}function Sn(u){if(!u)return!1;var f=u._valueTracker;if(!f)return!0;var v=f.getValue(),E="";return u&&(E=Kt(u)?u.checked?"true":"false":u.value),u=E,u!==v?(f.setValue(u),!0):!1}function Ai(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}var In=/[\n"\\]/g;function mn(u){return u.replace(In,function(f){return"\\"+f.charCodeAt(0).toString(16)+" "})}function wn(u,f,v,E,M,D,G,Q){u.name="",G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?u.type=G:u.removeAttribute("type"),f!=null?G==="number"?(f===0&&u.value===""||u.value!=f)&&(u.value=""+Yt(f)):u.value!==""+Yt(f)&&(u.value=""+Yt(f)):G!=="submit"&&G!=="reset"||u.removeAttribute("value"),f!=null?yi(u,G,Yt(f)):v!=null?yi(u,G,Yt(v)):E!=null&&u.removeAttribute("value"),M==null&&D!=null&&(u.defaultChecked=!!D),M!=null&&(u.checked=M&&typeof M!="function"&&typeof M!="symbol"),Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?u.name=""+Yt(Q):u.removeAttribute("name")}function ns(u,f,v,E,M,D,G,Q){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(u.type=D),f!=null||v!=null){if(!(D!=="submit"&&D!=="reset"||f!=null))return;v=v!=null?""+Yt(v):"",f=f!=null?""+Yt(f):v,Q||f===u.value||(u.value=f),u.defaultValue=f}E=E??M,E=typeof E!="function"&&typeof E!="symbol"&&!!E,u.checked=Q?u.checked:!!E,u.defaultChecked=!!E,G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"&&(u.name=G)}function yi(u,f,v){f==="number"&&Ai(u.ownerDocument)===u||u.defaultValue===""+v||(u.defaultValue=""+v)}function vi(u,f,v,E){if(u=u.options,f){f={};for(var M=0;M<v.length;M++)f["$"+v[M]]=!0;for(v=0;v<u.length;v++)M=f.hasOwnProperty("$"+u[v].value),u[v].selected!==M&&(u[v].selected=M),M&&E&&(u[v].defaultSelected=!0)}else{for(v=""+Yt(v),f=null,M=0;M<u.length;M++){if(u[M].value===v){u[M].selected=!0,E&&(u[M].defaultSelected=!0);return}f!==null||u[M].disabled||(f=u[M])}f!==null&&(f.selected=!0)}}function hr(u,f,v){if(f!=null&&(f=""+Yt(f),f!==u.value&&(u.value=f),v==null)){u.defaultValue!==f&&(u.defaultValue=f);return}u.defaultValue=v!=null?""+Yt(v):""}function Io(u,f,v,E){if(f==null){if(E!=null){if(v!=null)throw Error(n(92));if(Ee(E)){if(1<E.length)throw Error(n(93));E=E[0]}v=E}v==null&&(v=""),f=v}v=Yt(f),u.defaultValue=v,E=u.textContent,E===v&&E!==""&&E!==null&&(u.value=E)}function Xr(u,f){if(f){var v=u.firstChild;if(v&&v===u.lastChild&&v.nodeType===3){v.nodeValue=f;return}}u.textContent=f}var Ig=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function j0(u,f,v){var E=f.indexOf("--")===0;v==null||typeof v=="boolean"||v===""?E?u.setProperty(f,""):f==="float"?u.cssFloat="":u[f]="":E?u.setProperty(f,v):typeof v!="number"||v===0||Ig.has(f)?f==="float"?u.cssFloat=v:u[f]=(""+v).trim():u[f]=v+"px"}function tx(u,f,v){if(f!=null&&typeof f!="object")throw Error(n(62));if(u=u.style,v!=null){for(var E in v)!v.hasOwnProperty(E)||f!=null&&f.hasOwnProperty(E)||(E.indexOf("--")===0?u.setProperty(E,""):E==="float"?u.cssFloat="":u[E]="");for(var M in f)E=f[M],f.hasOwnProperty(M)&&v[M]!==E&&j0(u,M,E)}else for(var D in f)f.hasOwnProperty(D)&&j0(u,D,f[D])}function q0(u){if(u.indexOf("-")===-1)return!1;switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var s1=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),r1=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Q0(u){return r1.test(""+u)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":u}var Bg=null;function $0(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var bh=null,Ah=null;function Og(u){var f=Y(u);if(f&&(u=f.stateNode)){var v=u[Ln]||null;e:switch(u=f.stateNode,f.type){case"input":if(wn(u,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name),f=v.name,v.type==="radio"&&f!=null){for(v=u;v.parentNode;)v=v.parentNode;for(v=v.querySelectorAll('input[name="'+mn(""+f)+'"][type="radio"]'),f=0;f<v.length;f++){var E=v[f];if(E!==u&&E.form===u.form){var M=E[Ln]||null;if(!M)throw Error(n(90));wn(E,M.value,M.defaultValue,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name)}}for(f=0;f<v.length;f++)E=v[f],E.form===u.form&&Sn(E)}break e;case"textarea":hr(u,v.value,v.defaultValue);break e;case"select":f=v.value,f!=null&&vi(u,!!v.multiple,f,!1)}}}var Pg=!1;function nx(u,f,v){if(Pg)return u(f,v);Pg=!0;try{var E=u(f);return E}finally{if(Pg=!1,(bh!==null||Ah!==null)&&(Vh(),bh&&(f=bh,u=Ah,Ah=bh=null,Og(f),u)))for(f=0;f<u.length;f++)Og(u[f])}}function Qf(u,f){var v=u.stateNode;if(v===null)return null;var E=v[Ln]||null;if(E===null)return null;v=E[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(E=!E.disabled)||(u=u.type,E=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!E;break e;default:u=!1}if(u)return null;if(v&&typeof v!="function")throw Error(n(231,f,typeof v));return v}var J0=!1;if(dt)try{var $f={};Object.defineProperty($f,"passive",{get:function(){J0=!0}}),window.addEventListener("test",$f,$f),window.removeEventListener("test",$f,$f)}catch{J0=!1}var Yl=null,ix=null,Ng=null;function sx(){if(Ng)return Ng;var u,f=ix,v=f.length,E,M="value"in Yl?Yl.value:Yl.textContent,D=M.length;for(u=0;u<v&&f[u]===M[u];u++);var G=v-u;for(E=1;E<=G&&f[v-E]===M[D-E];E++);return Ng=M.slice(u,1<E?1-E:void 0)}function tu(u){var f=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&f===13&&(u=13)):u=f,u===10&&(u=13),32<=u||u===13?u:0}function Jf(){return!0}function Z0(){return!1}function jr(u){function f(v,E,M,D,G){this._reactName=v,this._targetInst=M,this.type=E,this.nativeEvent=D,this.target=G,this.currentTarget=null;for(var Q in u)u.hasOwnProperty(Q)&&(v=u[Q],this[Q]=v?v(D):D[Q]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?Jf:Z0,this.isPropagationStopped=Z0,this}return L(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var v=this.nativeEvent;v&&(v.preventDefault?v.preventDefault():typeof v.returnValue!="unknown"&&(v.returnValue=!1),this.isDefaultPrevented=Jf)},stopPropagation:function(){var v=this.nativeEvent;v&&(v.stopPropagation?v.stopPropagation():typeof v.cancelBubble!="unknown"&&(v.cancelBubble=!0),this.isPropagationStopped=Jf)},persist:function(){},isPersistent:Jf}),f}var nu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zf=jr(nu),ed=L({},nu,{view:0,detail:0}),a1=jr(ed),Kl,td,nd,id=L({},ed,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tp,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==nd&&(nd&&u.type==="mousemove"?(Kl=u.screenX-nd.screenX,td=u.screenY-nd.screenY):td=Kl=0,nd=u),Kl)},movementY:function(u){return"movementY"in u?u.movementY:td}}),rx=jr(id),o1=L({},id,{dataTransfer:0}),UM=jr(o1),br=L({},ed,{relatedTarget:0}),Ug=jr(br),l1=L({},nu,{animationName:0,elapsedTime:0,pseudoElement:0}),c1=jr(l1),u1=L({},nu,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),h1=jr(u1),ep=L({},nu,{data:0}),kg=jr(ep),f1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},d1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},p1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ax(u){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(u):(u=p1[u])?!!f[u]:!1}function tp(){return ax}var m1=L({},ed,{key:function(u){if(u.key){var f=f1[u.key]||u.key;if(f!=="Unidentified")return f}return u.type==="keypress"?(u=tu(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?d1[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tp,charCode:function(u){return u.type==="keypress"?tu(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?tu(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),ox=jr(m1),lx=L({},id,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fg=jr(lx),g1=L({},ed,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tp}),cx=jr(g1),y1=L({},nu,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wl=jr(y1),ux=L({},id,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),kM=jr(ux),v1=L({},nu,{newState:0,oldState:0}),iu=jr(v1),Xl=[9,13,27,32],np=dt&&"CompositionEvent"in window,Eh=null;dt&&"documentMode"in document&&(Eh=document.documentMode);var ip=dt&&"TextEvent"in window&&!Eh,sp=dt&&(!np||Eh&&8<Eh&&11>=Eh),su=" ",Ar=!1;function rp(u,f){switch(u){case"keyup":return Xl.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hx(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var ru=!1;function ap(u,f){switch(u){case"compositionend":return hx(f);case"keypress":return f.which!==32?null:(Ar=!0,su);case"textInput":return u=f.data,u===su&&Ar?null:u;default:return null}}function fx(u,f){if(ru)return u==="compositionend"||!np&&rp(u,f)?(u=sx(),Ng=ix=Yl=null,ru=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return sp&&f.locale!=="ko"?null:f.data;default:return null}}var Hg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dx(u){var f=u&&u.nodeName&&u.nodeName.toLowerCase();return f==="input"?!!Hg[u.type]:f==="textarea"}function fa(u,f,v,E){bh?Ah?Ah.push(E):Ah=[E]:bh=E,f=v_(f,"onChange"),0<f.length&&(v=new Zf("onChange","change",null,v,E),u.push({event:v,listeners:f}))}var sd=null,_h=null;function x1(u){hP(u,0)}function op(u){var f=oe(u);if(Sn(f))return u}function Gg(u,f){if(u==="change")return f}var zg=!1;if(dt){var Vg;if(dt){var rd="oninput"in document;if(!rd){var ad=document.createElement("div");ad.setAttribute("oninput","return;"),rd=typeof ad.oninput=="function"}Vg=rd}else Vg=!1;zg=Vg&&(!document.documentMode||9<document.documentMode)}function is(){sd&&(sd.detachEvent("onpropertychange",b1),_h=sd=null)}function b1(u){if(u.propertyName==="value"&&op(_h)){var f=[];fa(f,_h,u,$0(u)),nx(x1,f)}}function FM(u,f,v){u==="focusin"?(is(),sd=f,_h=v,sd.attachEvent("onpropertychange",b1)):u==="focusout"&&is()}function A1(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return op(_h)}function lp(u,f){if(u==="click")return op(f)}function au(u,f){if(u==="input"||u==="change")return op(f)}function E1(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}var da=typeof Object.is=="function"?Object.is:E1;function Bo(u,f){if(da(u,f))return!0;if(typeof u!="object"||u===null||typeof f!="object"||f===null)return!1;var v=Object.keys(u),E=Object.keys(f);if(v.length!==E.length)return!1;for(E=0;E<v.length;E++){var M=v[E];if(!Pt.call(f,M)||!da(u[M],f[M]))return!1}return!0}function pa(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function px(u,f){var v=pa(u);u=0;for(var E;v;){if(v.nodeType===3){if(E=u+v.textContent.length,u<=f&&E>=f)return{node:v,offset:f-u};u=E}e:{for(;v;){if(v.nextSibling){v=v.nextSibling;break e}v=v.parentNode}v=void 0}v=pa(v)}}function mx(u,f){return u&&f?u===f?!0:u&&u.nodeType===3?!1:f&&f.nodeType===3?mx(u,f.parentNode):"contains"in u?u.contains(f):u.compareDocumentPosition?!!(u.compareDocumentPosition(f)&16):!1:!1}function gx(u){u=u!=null&&u.ownerDocument!=null&&u.ownerDocument.defaultView!=null?u.ownerDocument.defaultView:window;for(var f=Ai(u.document);f instanceof u.HTMLIFrameElement;){try{var v=typeof f.contentWindow.location.href=="string"}catch{v=!1}if(v)u=f.contentWindow;else break;f=Ai(u.document)}return f}function cp(u){var f=u&&u.nodeName&&u.nodeName.toLowerCase();return f&&(f==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||f==="textarea"||u.contentEditable==="true")}function yx(u,f){var v=gx(f);f=u.focusedElem;var E=u.selectionRange;if(v!==f&&f&&f.ownerDocument&&mx(f.ownerDocument.documentElement,f)){if(E!==null&&cp(f)){if(u=E.start,v=E.end,v===void 0&&(v=u),"selectionStart"in f)f.selectionStart=u,f.selectionEnd=Math.min(v,f.value.length);else if(v=(u=f.ownerDocument||document)&&u.defaultView||window,v.getSelection){v=v.getSelection();var M=f.textContent.length,D=Math.min(E.start,M);E=E.end===void 0?D:Math.min(E.end,M),!v.extend&&D>E&&(M=E,E=D,D=M),M=px(f,D);var G=px(f,E);M&&G&&(v.rangeCount!==1||v.anchorNode!==M.node||v.anchorOffset!==M.offset||v.focusNode!==G.node||v.focusOffset!==G.offset)&&(u=u.createRange(),u.setStart(M.node,M.offset),v.removeAllRanges(),D>E?(v.addRange(u),v.extend(G.node,G.offset)):(u.setEnd(G.node,G.offset),v.addRange(u)))}}for(u=[],v=f;v=v.parentNode;)v.nodeType===1&&u.push({element:v,left:v.scrollLeft,top:v.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<u.length;f++)v=u[f],v.element.scrollLeft=v.left,v.element.scrollTop=v.top}}var Yg=dt&&"documentMode"in document&&11>=document.documentMode,Sh=null,vx=null,od=null,Kg=!1;function no(u,f,v){var E=v.window===v?v.document:v.nodeType===9?v:v.ownerDocument;Kg||Sh==null||Sh!==Ai(E)||(E=Sh,"selectionStart"in E&&cp(E)?E={start:E.selectionStart,end:E.selectionEnd}:(E=(E.ownerDocument&&E.ownerDocument.defaultView||window).getSelection(),E={anchorNode:E.anchorNode,anchorOffset:E.anchorOffset,focusNode:E.focusNode,focusOffset:E.focusOffset}),od&&Bo(od,E)||(od=E,E=v_(vx,"onSelect"),0<E.length&&(f=new Zf("onSelect","select",null,f,v),u.push({event:f,listeners:E}),f.target=Sh)))}function jl(u,f){var v={};return v[u.toLowerCase()]=f.toLowerCase(),v["Webkit"+u]="webkit"+f,v["Moz"+u]="moz"+f,v}var Th={animationend:jl("Animation","AnimationEnd"),animationiteration:jl("Animation","AnimationIteration"),animationstart:jl("Animation","AnimationStart"),transitionrun:jl("Transition","TransitionRun"),transitionstart:jl("Transition","TransitionStart"),transitioncancel:jl("Transition","TransitionCancel"),transitionend:jl("Transition","TransitionEnd")},xx={},Wg={};dt&&(Wg=document.createElement("div").style,"AnimationEvent"in window||(delete Th.animationend.animation,delete Th.animationiteration.animation,delete Th.animationstart.animation),"TransitionEvent"in window||delete Th.transitionend.transition);function Ps(u){if(xx[u])return xx[u];if(!Th[u])return u;var f=Th[u],v;for(v in f)if(f.hasOwnProperty(v)&&v in Wg)return xx[u]=f[v];return u}var bx=Ps("animationend"),ma=Ps("animationiteration"),Ax=Ps("animationstart"),ql=Ps("transitionrun"),ld=Ps("transitionstart"),ou=Ps("transitioncancel"),Xg=Ps("transitionend"),jg=new Map,Ql="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function io(u,f){jg.set(u,f),qe(f,[u])}var Er=[],rl=0,$l=0;function up(){for(var u=rl,f=$l=rl=0;f<u;){var v=Er[f];Er[f++]=null;var E=Er[f];Er[f++]=null;var M=Er[f];Er[f++]=null;var D=Er[f];if(Er[f++]=null,E!==null&&M!==null){var G=E.pending;G===null?M.next=M:(M.next=G.next,G.next=M),E.pending=M}D!==0&&fp(v,M,D)}}function hp(u,f,v,E){Er[rl++]=u,Er[rl++]=f,Er[rl++]=v,Er[rl++]=E,$l|=E,u.lanes|=E,u=u.alternate,u!==null&&(u.lanes|=E)}function wh(u,f,v,E){return hp(u,f,v,E),dp(u)}function Jl(u,f){return hp(u,null,null,f),dp(u)}function fp(u,f,v){u.lanes|=v;var E=u.alternate;E!==null&&(E.lanes|=v);for(var M=!1,D=u.return;D!==null;)D.childLanes|=v,E=D.alternate,E!==null&&(E.childLanes|=v),D.tag===22&&(u=D.stateNode,u===null||u._visibility&1||(M=!0)),u=D,D=D.return;M&&f!==null&&u.tag===3&&(D=u.stateNode,M=31-He(v),D=D.hiddenUpdates,u=D[M],u===null?D[M]=[f]:u.push(f),f.lane=v|536870912)}function dp(u){if(50<po)throw po=0,xc=null,Error(n(185));for(var f=u.return;f!==null;)u=f,f=u.return;return u.tag===3?u.stateNode:null}var lu={},qg=new WeakMap;function ga(u,f){if(typeof u=="object"&&u!==null){var v=qg.get(u);return v!==void 0?v:(f={value:u,source:f,stack:ne(f)},qg.set(u,f),f)}return{value:u,source:f,stack:ne(f)}}var Mh=[],cu=0,Rr=null,pp=0,Wi=[],Pa=0,Zl=null,al=1,ec="";function qr(u,f){Mh[cu++]=pp,Mh[cu++]=Rr,Rr=u,pp=f}function Ex(u,f,v){Wi[Pa++]=al,Wi[Pa++]=ec,Wi[Pa++]=Zl,Zl=u;var E=al;u=ec;var M=32-He(E)-1;E&=~(1<<M),v+=1;var D=32-He(f)+M;if(30<D){var G=M-M%5;D=(E&(1<<G)-1).toString(32),E>>=G,M-=G,al=1<<32-He(f)+M|v<<M|E,ec=D+u}else al=1<<D|v<<M|E,ec=u}function mp(u){u.return!==null&&(qr(u,1),Ex(u,1,0))}function uu(u){for(;u===Rr;)Rr=Mh[--cu],Mh[cu]=null,pp=Mh[--cu],Mh[cu]=null;for(;u===Zl;)Zl=Wi[--Pa],Wi[Pa]=null,ec=Wi[--Pa],Wi[Pa]=null,al=Wi[--Pa],Wi[Pa]=null}var Dr=null,fr=null,ni=!1,so=null,ro=!1,gp=Error(n(519));function Ch(u){var f=Error(n(418,""));throw ol(ga(f,u)),gp}function _1(u){var f=u.stateNode,v=u.type,E=u.memoizedProps;switch(f[$i]=u,f[Ln]=E,v){case"dialog":si("cancel",f),si("close",f);break;case"iframe":case"object":case"embed":si("load",f);break;case"video":case"audio":for(v=0;v<nb.length;v++)si(nb[v],f);break;case"source":si("error",f);break;case"img":case"image":case"link":si("error",f),si("load",f);break;case"details":si("toggle",f);break;case"input":si("invalid",f),ns(f,E.value,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name,!0),pn(f);break;case"select":si("invalid",f);break;case"textarea":si("invalid",f),Io(f,E.value,E.defaultValue,E.children),pn(f)}v=E.children,typeof v!="string"&&typeof v!="number"&&typeof v!="bigint"||f.textContent===""+v||E.suppressHydrationWarning===!0||mP(f.textContent,v)?(E.popover!=null&&(si("beforetoggle",f),si("toggle",f)),E.onScroll!=null&&si("scroll",f),E.onScrollEnd!=null&&si("scrollend",f),E.onClick!=null&&(f.onclick=x_),f=!0):f=!1,f||Ch(u)}function S1(u){for(Dr=u.return;Dr;)switch(Dr.tag){case 3:case 27:ro=!0;return;case 5:case 13:ro=!1;return;default:Dr=Dr.return}}function cd(u){if(u!==Dr)return!1;if(!ni)return S1(u),ni=!0,!1;var f=!1,v;if((v=u.tag!==3&&u.tag!==27)&&((v=u.tag===5)&&(v=u.type,v=!(v!=="form"&&v!=="button")||rC(u.type,u.memoizedProps)),v=!v),v&&(f=!0),f&&fr&&Ch(u),S1(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(n(317));e:{for(u=u.nextSibling,f=0;u;){if(u.nodeType===8)if(v=u.data,v==="/$"){if(f===0){fr=Ac(u.nextSibling);break e}f--}else v!=="$"&&v!=="$!"&&v!=="$?"||f++;u=u.nextSibling}fr=null}}else fr=Dr?Ac(u.stateNode.nextSibling):null;return!0}function ud(){fr=Dr=null,ni=!1}function ol(u){so===null?so=[u]:so.push(u)}var hu=Error(n(460)),_x=Error(n(474)),Qg={then:function(){}};function T1(u){return u=u.status,u==="fulfilled"||u==="rejected"}function yp(){}function fu(u,f,v){switch(v=u[v],v===void 0?u.push(f):v!==f&&(f.then(yp,yp),f=v),f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,u===hu?Error(n(483)):u;default:if(typeof f.status=="string")f.then(yp,yp);else{if(u=Ii,u!==null&&100<u.shellSuspendCounter)throw Error(n(482));u=f,u.status="pending",u.then(function(E){if(f.status==="pending"){var M=f;M.status="fulfilled",M.value=E}},function(E){if(f.status==="pending"){var M=f;M.status="rejected",M.reason=E}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,u===hu?Error(n(483)):u}throw hd=f,hu}}var hd=null;function Ei(){if(hd===null)throw Error(n(459));var u=hd;return hd=null,u}var du=null,vp=0;function xp(u){var f=vp;return vp+=1,du===null&&(du=[]),fu(du,u,f)}function bp(u,f){f=f.props.ref,u.ref=f!==void 0?f:null}function $g(u,f){throw f.$$typeof===r?Error(n(525)):(u=Object.prototype.toString.call(f),Error(n(31,u==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":u)))}function w1(u){var f=u._init;return f(u._payload)}function M1(u){function f(Le,_e){if(u){var Ue=Le.deletions;Ue===null?(Le.deletions=[_e],Le.flags|=16):Ue.push(_e)}}function v(Le,_e){if(!u)return null;for(;_e!==null;)f(Le,_e),_e=_e.sibling;return null}function E(Le){for(var _e=new Map;Le!==null;)Le.key!==null?_e.set(Le.key,Le):_e.set(Le.index,Le),Le=Le.sibling;return _e}function M(Le,_e){return Le=Zr(Le,_e),Le.index=0,Le.sibling=null,Le}function D(Le,_e,Ue){return Le.index=Ue,u?(Ue=Le.alternate,Ue!==null?(Ue=Ue.index,Ue<_e?(Le.flags|=33554434,_e):Ue):(Le.flags|=33554434,_e)):(Le.flags|=1048576,_e)}function G(Le){return u&&Le.alternate===null&&(Le.flags|=33554434),Le}function Q(Le,_e,Ue,mt){return _e===null||_e.tag!==6?(_e=Fs(Ue,Le.mode,mt),_e.return=Le,_e):(_e=M(_e,Ue),_e.return=Le,_e)}function pe(Le,_e,Ue,mt){var qt=Ue.type;return qt===l?ct(Le,_e,Ue.props.children,mt,Ue.key):_e!==null&&(_e.elementType===qt||typeof qt=="object"&&qt!==null&&qt.$$typeof===T&&w1(qt)===_e.type)?(_e=M(_e,Ue.props),bp(_e,Ue),_e.return=Le,_e):(_e=wd(Ue.type,Ue.key,Ue.props,null,Le.mode,mt),bp(_e,Ue),_e.return=Le,_e)}function Te(Le,_e,Ue,mt){return _e===null||_e.tag!==4||_e.stateNode.containerInfo!==Ue.containerInfo||_e.stateNode.implementation!==Ue.implementation?(_e=Ip(Ue,Le.mode,mt),_e.return=Le,_e):(_e=M(_e,Ue.children||[]),_e.return=Le,_e)}function ct(Le,_e,Ue,mt,qt){return _e===null||_e.tag!==7?(_e=Iu(Ue,Le.mode,mt,qt),_e.return=Le,_e):(_e=M(_e,Ue),_e.return=Le,_e)}function xt(Le,_e,Ue){if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return _e=Fs(""+_e,Le.mode,Ue),_e.return=Le,_e;if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case a:return Ue=wd(_e.type,_e.key,_e.props,null,Le.mode,Ue),bp(Ue,_e),Ue.return=Le,Ue;case o:return _e=Ip(_e,Le.mode,Ue),_e.return=Le,_e;case T:var mt=_e._init;return _e=mt(_e._payload),xt(Le,_e,Ue)}if(Ee(_e)||N(_e))return _e=Iu(_e,Le.mode,Ue,null),_e.return=Le,_e;if(typeof _e.then=="function")return xt(Le,xp(_e),Ue);if(_e.$$typeof===y)return xt(Le,p2(Le,_e),Ue);$g(Le,_e)}return null}function Ye(Le,_e,Ue,mt){var qt=_e!==null?_e.key:null;if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint")return qt!==null?null:Q(Le,_e,""+Ue,mt);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case a:return Ue.key===qt?pe(Le,_e,Ue,mt):null;case o:return Ue.key===qt?Te(Le,_e,Ue,mt):null;case T:return qt=Ue._init,Ue=qt(Ue._payload),Ye(Le,_e,Ue,mt)}if(Ee(Ue)||N(Ue))return qt!==null?null:ct(Le,_e,Ue,mt,null);if(typeof Ue.then=="function")return Ye(Le,_e,xp(Ue),mt);if(Ue.$$typeof===y)return Ye(Le,_e,p2(Le,Ue),mt);$g(Le,Ue)}return null}function at(Le,_e,Ue,mt,qt){if(typeof mt=="string"&&mt!==""||typeof mt=="number"||typeof mt=="bigint")return Le=Le.get(Ue)||null,Q(_e,Le,""+mt,qt);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case a:return Le=Le.get(mt.key===null?Ue:mt.key)||null,pe(_e,Le,mt,qt);case o:return Le=Le.get(mt.key===null?Ue:mt.key)||null,Te(_e,Le,mt,qt);case T:var Qn=mt._init;return mt=Qn(mt._payload),at(Le,_e,Ue,mt,qt)}if(Ee(mt)||N(mt))return Le=Le.get(Ue)||null,ct(_e,Le,mt,qt,null);if(typeof mt.then=="function")return at(Le,_e,Ue,xp(mt),qt);if(mt.$$typeof===y)return at(Le,_e,Ue,p2(_e,mt),qt);$g(_e,mt)}return null}function an(Le,_e,Ue,mt){for(var qt=null,Qn=null,on=_e,xn=_e=0,Ur=null;on!==null&&xn<Ue.length;xn++){on.index>xn?(Ur=on,on=null):Ur=on.sibling;var _i=Ye(Le,on,Ue[xn],mt);if(_i===null){on===null&&(on=Ur);break}u&&on&&_i.alternate===null&&f(Le,on),_e=D(_i,_e,xn),Qn===null?qt=_i:Qn.sibling=_i,Qn=_i,on=Ur}if(xn===Ue.length)return v(Le,on),ni&&qr(Le,xn),qt;if(on===null){for(;xn<Ue.length;xn++)on=xt(Le,Ue[xn],mt),on!==null&&(_e=D(on,_e,xn),Qn===null?qt=on:Qn.sibling=on,Qn=on);return ni&&qr(Le,xn),qt}for(on=E(on);xn<Ue.length;xn++)Ur=at(on,Le,xn,Ue[xn],mt),Ur!==null&&(u&&Ur.alternate!==null&&on.delete(Ur.key===null?xn:Ur.key),_e=D(Ur,_e,xn),Qn===null?qt=Ur:Qn.sibling=Ur,Qn=Ur);return u&&on.forEach(function(Pd){return f(Le,Pd)}),ni&&qr(Le,xn),qt}function Mn(Le,_e,Ue,mt){if(Ue==null)throw Error(n(151));for(var qt=null,Qn=null,on=_e,xn=_e=0,Ur=null,_i=Ue.next();on!==null&&!_i.done;xn++,_i=Ue.next()){on.index>xn?(Ur=on,on=null):Ur=on.sibling;var Pd=Ye(Le,on,_i.value,mt);if(Pd===null){on===null&&(on=Ur);break}u&&on&&Pd.alternate===null&&f(Le,on),_e=D(Pd,_e,xn),Qn===null?qt=Pd:Qn.sibling=Pd,Qn=Pd,on=Ur}if(_i.done)return v(Le,on),ni&&qr(Le,xn),qt;if(on===null){for(;!_i.done;xn++,_i=Ue.next())_i=xt(Le,_i.value,mt),_i!==null&&(_e=D(_i,_e,xn),Qn===null?qt=_i:Qn.sibling=_i,Qn=_i);return ni&&qr(Le,xn),qt}for(on=E(on);!_i.done;xn++,_i=Ue.next())_i=at(on,Le,xn,_i.value,mt),_i!==null&&(u&&_i.alternate!==null&&on.delete(_i.key===null?xn:_i.key),_e=D(_i,_e,xn),Qn===null?qt=_i:Qn.sibling=_i,Qn=_i);return u&&on.forEach(function(XY){return f(Le,XY)}),ni&&qr(Le,xn),qt}function zs(Le,_e,Ue,mt){if(typeof Ue=="object"&&Ue!==null&&Ue.type===l&&Ue.key===null&&(Ue=Ue.props.children),typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case a:e:{for(var qt=Ue.key;_e!==null;){if(_e.key===qt){if(qt=Ue.type,qt===l){if(_e.tag===7){v(Le,_e.sibling),mt=M(_e,Ue.props.children),mt.return=Le,Le=mt;break e}}else if(_e.elementType===qt||typeof qt=="object"&&qt!==null&&qt.$$typeof===T&&w1(qt)===_e.type){v(Le,_e.sibling),mt=M(_e,Ue.props),bp(mt,Ue),mt.return=Le,Le=mt;break e}v(Le,_e);break}else f(Le,_e);_e=_e.sibling}Ue.type===l?(mt=Iu(Ue.props.children,Le.mode,mt,Ue.key),mt.return=Le,Le=mt):(mt=wd(Ue.type,Ue.key,Ue.props,null,Le.mode,mt),bp(mt,Ue),mt.return=Le,Le=mt)}return G(Le);case o:e:{for(qt=Ue.key;_e!==null;){if(_e.key===qt)if(_e.tag===4&&_e.stateNode.containerInfo===Ue.containerInfo&&_e.stateNode.implementation===Ue.implementation){v(Le,_e.sibling),mt=M(_e,Ue.children||[]),mt.return=Le,Le=mt;break e}else{v(Le,_e);break}else f(Le,_e);_e=_e.sibling}mt=Ip(Ue,Le.mode,mt),mt.return=Le,Le=mt}return G(Le);case T:return qt=Ue._init,Ue=qt(Ue._payload),zs(Le,_e,Ue,mt)}if(Ee(Ue))return an(Le,_e,Ue,mt);if(N(Ue)){if(qt=N(Ue),typeof qt!="function")throw Error(n(150));return Ue=qt.call(Ue),Mn(Le,_e,Ue,mt)}if(typeof Ue.then=="function")return zs(Le,_e,xp(Ue),mt);if(Ue.$$typeof===y)return zs(Le,_e,p2(Le,Ue),mt);$g(Le,Ue)}return typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint"?(Ue=""+Ue,_e!==null&&_e.tag===6?(v(Le,_e.sibling),mt=M(_e,Ue),mt.return=Le,Le=mt):(v(Le,_e),mt=Fs(Ue,Le.mode,mt),mt.return=Le,Le=mt),G(Le)):v(Le,_e)}return function(Le,_e,Ue,mt){try{vp=0;var qt=zs(Le,_e,Ue,mt);return du=null,qt}catch(on){if(on===hu)throw on;var Qn=ws(29,on,null,Le.mode);return Qn.lanes=mt,Qn.return=Le,Qn}finally{}}}var tc=M1(!0),nc=M1(!1),Rh=tt(null),Dh=tt(0);function pu(u,f){u=vc,bt(Dh,u),bt(Rh,f),vc=u|f.baseLanes}function Jg(){bt(Dh,vc),bt(Rh,Rh.current)}function Ap(){vc=Dh.current,Mt(Rh),Mt(Dh)}var ya=tt(null),ll=null;function ic(u){var f=u.alternate;bt(Ns,Ns.current&1),bt(ya,u),ll===null&&(f===null||Rh.current!==null||f.memoizedState!==null)&&(ll=u)}function Sx(u){if(u.tag===22){if(bt(Ns,Ns.current),bt(ya,u),ll===null){var f=u.alternate;f!==null&&f.memoizedState!==null&&(ll=u)}}else sc()}function sc(){bt(Ns,Ns.current),bt(ya,ya.current)}function cl(u){Mt(ya),ll===u&&(ll=null),Mt(Ns)}var Ns=tt(0);function fd(u){for(var f=u;f!==null;){if(f.tag===13){var v=f.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||v.data==="$?"||v.data==="$!"))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}var Wn=typeof AbortController<"u"?AbortController:function(){var u=[],f=this.signal={aborted:!1,addEventListener:function(v,E){u.push(E)}};this.abort=function(){f.aborted=!0,u.forEach(function(v){return v()})}},HM=i.unstable_scheduleCallback,Na=i.unstable_NormalPriority,bs={$$typeof:y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Tx(){return{controller:new Wn,data:new Map,refCount:0}}function mu(u){u.refCount--,u.refCount===0&&HM(Na,function(){u.controller.abort()})}var ul=null,gu=0,Lh=0,yu=null;function GM(u,f){if(ul===null){var v=ul=[];gu=0,Lh=QM(),yu={status:"pending",value:void 0,then:function(E){v.push(E)}}}return gu++,f.then(wx,wx),f}function wx(){if(--gu===0&&ul!==null){yu!==null&&(yu.status="fulfilled");var u=ul;ul=null,Lh=0,yu=null;for(var f=0;f<u.length;f++)(0,u[f])()}}function vu(u,f){var v=[],E={status:"pending",value:null,reason:null,then:function(M){v.push(M)}};return u.then(function(){E.status="fulfilled",E.value=f;for(var M=0;M<v.length;M++)(0,v[M])(f)},function(M){for(E.status="rejected",E.reason=M,M=0;M<v.length;M++)(0,v[M])(void 0)}),E}var Zg=B.S;B.S=function(u,f){typeof f=="object"&&f!==null&&typeof f.then=="function"&&GM(u,f),Zg!==null&&Zg(u,f)};var rc=tt(null);function Ep(){var u=rc.current;return u!==null?u:Ii.pooledCache}function dd(u,f){f===null?bt(rc,rc.current):bt(rc,f.pool)}function ac(){var u=Ep();return u===null?null:{parent:bs._currentValue,pool:u}}var oc=0,Nn=null,Mi=null,Us=null,vn=!1,xu=!1,bu=!1,pd=0,Au=0,md=null,zM=0;function gs(){throw Error(n(321))}function Ih(u,f){if(f===null)return!1;for(var v=0;v<f.length&&v<u.length;v++)if(!da(u[v],f[v]))return!1;return!0}function Mx(u,f,v,E,M,D){return oc=D,Nn=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,B.H=u===null||u.memoizedState===null?_u:cc,bu=!1,D=v(E,M),bu=!1,xu&&(D=R1(f,v,E,M)),C1(u),D}function C1(u){B.H=fl;var f=Mi!==null&&Mi.next!==null;if(oc=0,Us=Mi=Nn=null,vn=!1,Au=0,md=null,f)throw Error(n(300));u===null||$s||(u=u.dependencies,u!==null&&bd(u)&&($s=!0))}function R1(u,f,v,E){Nn=u;var M=0;do{if(xu&&(md=null),Au=0,xu=!1,25<=M)throw Error(n(301));if(M+=1,Us=Mi=null,u.updateQueue!=null){var D=u.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}B.H=Ph,D=f(v,E)}while(xu);return D}function VM(){var u=B.H,f=u.useState()[0];return f=typeof f.then=="function"?Sp(f):f,u=u.useState()[0],(Mi!==null?Mi.memoizedState:null)!==u&&(Nn.flags|=1024),f}function Cx(){var u=pd!==0;return pd=0,u}function _p(u,f,v){f.updateQueue=u.updateQueue,f.flags&=-2053,u.lanes&=~v}function e2(u){if(vn){for(u=u.memoizedState;u!==null;){var f=u.queue;f!==null&&(f.pending=null),u=u.next}vn=!1}oc=0,Us=Mi=Nn=null,xu=!1,Au=pd=0,md=null}function _r(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Us===null?Nn.memoizedState=Us=u:Us=Us.next=u,Us}function As(){if(Mi===null){var u=Nn.alternate;u=u!==null?u.memoizedState:null}else u=Mi.next;var f=Us===null?Nn.memoizedState:Us.next;if(f!==null)Us=f,Mi=u;else{if(u===null)throw Nn.alternate===null?Error(n(467)):Error(n(310));Mi=u,u={memoizedState:Mi.memoizedState,baseState:Mi.baseState,baseQueue:Mi.baseQueue,queue:Mi.queue,next:null},Us===null?Nn.memoizedState=Us=u:Us=Us.next=u}return Us}var t2;t2=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Sp(u){var f=Au;return Au+=1,md===null&&(md=[]),u=fu(md,u,f),f=Nn,(Us===null?f.memoizedState:Us.next)===null&&(f=f.alternate,B.H=f===null||f.memoizedState===null?_u:cc),u}function gd(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return Sp(u);if(u.$$typeof===y)return Lr(u)}throw Error(n(438,String(u)))}function Oo(u){var f=null,v=Nn.updateQueue;if(v!==null&&(f=v.memoCache),f==null){var E=Nn.alternate;E!==null&&(E=E.updateQueue,E!==null&&(E=E.memoCache,E!=null&&(f={data:E.data.map(function(M){return M.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),v===null&&(v=t2(),Nn.updateQueue=v),v.memoCache=f,v=f.data[f.index],v===void 0)for(v=f.data[f.index]=Array(u),E=0;E<u;E++)v[E]=R;return f.index++,v}function ss(u,f){return typeof f=="function"?f(u):f}function Po(u){var f=As();return va(f,Mi,u)}function va(u,f,v){var E=u.queue;if(E===null)throw Error(n(311));E.lastRenderedReducer=v;var M=u.baseQueue,D=E.pending;if(D!==null){if(M!==null){var G=M.next;M.next=D.next,D.next=G}f.baseQueue=M=D,E.pending=null}if(D=u.baseState,M===null)u.memoizedState=D;else{f=M.next;var Q=G=null,pe=null,Te=f,ct=!1;do{var xt=Te.lane&-536870913;if(xt!==Te.lane?(un&xt)===xt:(oc&xt)===xt){var Ye=Te.revertLane;if(Ye===0)pe!==null&&(pe=pe.next={lane:0,revertLane:0,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null}),xt===Lh&&(ct=!0);else if((oc&Ye)===Ye){Te=Te.next,Ye===Lh&&(ct=!0);continue}else xt={lane:0,revertLane:Te.revertLane,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null},pe===null?(Q=pe=xt,G=D):pe=pe.next=xt,Nn.lanes|=Ye,zo|=Ye;xt=Te.action,bu&&v(D,xt),D=Te.hasEagerState?Te.eagerState:v(D,xt)}else Ye={lane:xt,revertLane:Te.revertLane,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null},pe===null?(Q=pe=Ye,G=D):pe=pe.next=Ye,Nn.lanes|=xt,zo|=xt;Te=Te.next}while(Te!==null&&Te!==f);if(pe===null?G=D:pe.next=Q,!da(D,u.memoizedState)&&($s=!0,ct&&(v=yu,v!==null)))throw v;u.memoizedState=D,u.baseState=G,u.baseQueue=pe,E.lastRenderedState=D}return M===null&&(E.lanes=0),[u.memoizedState,E.dispatch]}function n2(u){var f=As(),v=f.queue;if(v===null)throw Error(n(311));v.lastRenderedReducer=u;var E=v.dispatch,M=v.pending,D=f.memoizedState;if(M!==null){v.pending=null;var G=M=M.next;do D=u(D,G.action),G=G.next;while(G!==M);da(D,f.memoizedState)||($s=!0),f.memoizedState=D,f.baseQueue===null&&(f.baseState=D),v.lastRenderedState=D}return[D,E]}function D1(u,f,v){var E=Nn,M=As(),D=ni;if(D){if(v===void 0)throw Error(n(407));v=v()}else v=f();var G=!da((Mi||M).memoizedState,v);if(G&&(M.memoizedState=v,$s=!0),M=M.queue,Ix(L1.bind(null,E,M,u),[u]),M.getSnapshot!==f||G||Us!==null&&Us.memoizedState.tag&1){if(E.flags|=2048,hl(9,Eu.bind(null,E,M,v,f),{destroy:void 0},null),Ii===null)throw Error(n(349));D||(oc&60)!==0||Qr(E,f,v)}return v}function Qr(u,f,v){u.flags|=16384,u={getSnapshot:f,value:v},f=Nn.updateQueue,f===null?(f=t2(),Nn.updateQueue=f,f.stores=[u]):(v=f.stores,v===null?f.stores=[u]:v.push(u))}function Eu(u,f,v,E){f.value=v,f.getSnapshot=E,I1(f)&&B1(u)}function L1(u,f,v){return v(function(){I1(f)&&B1(u)})}function I1(u){var f=u.getSnapshot;u=u.value;try{var v=f();return!da(u,v)}catch{return!0}}function B1(u){var f=Jl(u,2);f!==null&&Gs(f,u,2)}function Rx(u){var f=_r();if(typeof u=="function"){var v=u;if(u=v(),bu){ve(!0);try{v()}finally{ve(!1)}}}return f.memoizedState=f.baseState=u,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ss,lastRenderedState:u},f}function Dx(u,f,v,E){return u.baseState=v,va(u,Mi,typeof E=="function"?E:ss)}function YM(u,f,v,E,M){if(o2(u))throw Error(n(485));if(u=f.action,u!==null){var D={payload:M,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(G){D.listeners.push(G)}};B.T!==null?v(!0):D.isTransition=!1,E(D),v=f.pending,v===null?(D.next=f.pending=D,Lx(f,D)):(D.next=v.next,f.pending=v.next=D)}}function Lx(u,f){var v=f.action,E=f.payload,M=u.state;if(f.isTransition){var D=B.T,G={};B.T=G;try{var Q=v(M,E),pe=B.S;pe!==null&&pe(G,Q),O1(u,f,Q)}catch(Te){lc(u,f,Te)}finally{B.T=D}}else try{D=v(M,E),O1(u,f,D)}catch(Te){lc(u,f,Te)}}function O1(u,f,v){v!==null&&typeof v=="object"&&typeof v.then=="function"?v.then(function(E){Bh(u,f,E)},function(E){return lc(u,f,E)}):Bh(u,f,v)}function Bh(u,f,v){f.status="fulfilled",f.value=v,P1(f),u.state=v,f=u.pending,f!==null&&(v=f.next,v===f?u.pending=null:(v=v.next,f.next=v,Lx(u,v)))}function lc(u,f,v){var E=u.pending;if(u.pending=null,E!==null){E=E.next;do f.status="rejected",f.reason=v,P1(f),f=f.next;while(f!==E)}u.action=null}function P1(u){u=u.listeners;for(var f=0;f<u.length;f++)(0,u[f])()}function N1(u,f){return f}function U1(u,f){if(ni){var v=Ii.formState;if(v!==null){e:{var E=Nn;if(ni){if(fr){t:{for(var M=fr,D=ro;M.nodeType!==8;){if(!D){M=null;break t}if(M=Ac(M.nextSibling),M===null){M=null;break t}}D=M.data,M=D==="F!"||D==="F"?M:null}if(M){fr=Ac(M.nextSibling),E=M.data==="F!";break e}}Ch(E)}E=!1}E&&(f=v[0])}}return v=_r(),v.memoizedState=v.baseState=f,E={pending:null,lanes:0,dispatch:null,lastRenderedReducer:N1,lastRenderedState:f},v.queue=E,v=Nx.bind(null,Nn,E),E.dispatch=v,E=Rx(!1),D=Tp.bind(null,Nn,!1,E.queue),E=_r(),M={state:f,dispatch:null,action:u,pending:null},E.queue=M,v=YM.bind(null,Nn,M,D,v),M.dispatch=v,E.memoizedState=u,[f,v,!1]}function yd(u){var f=As();return k1(f,Mi,u)}function k1(u,f,v){f=va(u,f,N1)[0],u=Po(ss)[0],f=typeof f=="object"&&f!==null&&typeof f.then=="function"?Sp(f):f;var E=As(),M=E.queue,D=M.dispatch;return v!==E.memoizedState&&(Nn.flags|=2048,hl(9,KM.bind(null,M,v),{destroy:void 0},null)),[f,D,u]}function KM(u,f){u.action=f}function F1(u){var f=As(),v=Mi;if(v!==null)return k1(f,v,u);As(),f=f.memoizedState,v=As();var E=v.queue.dispatch;return v.memoizedState=u,[f,E,!1]}function hl(u,f,v,E){return u={tag:u,create:f,inst:v,deps:E,next:null},f=Nn.updateQueue,f===null&&(f=t2(),Nn.updateQueue=f),v=f.lastEffect,v===null?f.lastEffect=u.next=u:(E=v.next,v.next=u,u.next=E,f.lastEffect=u),u}function H1(){return As().memoizedState}function i2(u,f,v,E){var M=_r();Nn.flags|=u,M.memoizedState=hl(1|f,v,{destroy:void 0},E===void 0?null:E)}function s2(u,f,v,E){var M=As();E=E===void 0?null:E;var D=M.memoizedState.inst;Mi!==null&&E!==null&&Ih(E,Mi.memoizedState.deps)?M.memoizedState=hl(f,v,D,E):(Nn.flags|=u,M.memoizedState=hl(1|f,v,D,E))}function G1(u,f){i2(8390656,8,u,f)}function Ix(u,f){s2(2048,8,u,f)}function z1(u,f){return s2(4,2,u,f)}function V1(u,f){return s2(4,4,u,f)}function Y1(u,f){if(typeof f=="function"){u=u();var v=f(u);return function(){typeof v=="function"?v():f(null)}}if(f!=null)return u=u(),f.current=u,function(){f.current=null}}function K1(u,f,v){v=v!=null?v.concat([u]):null,s2(4,4,Y1.bind(null,f,u),v)}function Bx(){}function W1(u,f){var v=As();f=f===void 0?null:f;var E=v.memoizedState;return f!==null&&Ih(f,E[1])?E[0]:(v.memoizedState=[u,f],u)}function X1(u,f){var v=As();f=f===void 0?null:f;var E=v.memoizedState;if(f!==null&&Ih(f,E[1]))return E[0];if(E=u(),bu){ve(!0);try{u()}finally{ve(!1)}}return v.memoizedState=[E,f],E}function r2(u,f,v){return v===void 0||(oc&1073741824)!==0?u.memoizedState=f:(u.memoizedState=v,u=Ga(),Nn.lanes|=u,zo|=u,v)}function j1(u,f,v,E){return da(v,f)?v:Rh.current!==null?(u=r2(u,v,E),da(u,f)||($s=!0),u):(oc&42)===0?($s=!0,u.memoizedState=v):(u=Ga(),Nn.lanes|=u,zo|=u,f)}function q1(u,f,v,E,M){var D=le.p;le.p=D!==0&&8>D?D:8;var G=B.T,Q={};B.T=Q,Tp(u,!1,f,v);try{var pe=M(),Te=B.S;if(Te!==null&&Te(Q,pe),pe!==null&&typeof pe=="object"&&typeof pe.then=="function"){var ct=vu(pe,E);Oh(u,f,ct,ta(u))}else Oh(u,f,E,ta(u))}catch(xt){Oh(u,f,{then:function(){},status:"rejected",reason:xt},ta())}finally{le.p=D,B.T=G}}function WM(){}function Ox(u,f,v,E){if(u.tag!==5)throw Error(n(476));var M=Q1(u).queue;q1(u,M,f,Ce,v===null?WM:function(){return $1(u),v(E)})}function Q1(u){var f=u.memoizedState;if(f!==null)return f;f={memoizedState:Ce,baseState:Ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ss,lastRenderedState:Ce},next:null};var v={};return f.next={memoizedState:v,baseState:v,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ss,lastRenderedState:v},next:null},u.memoizedState=f,u=u.alternate,u!==null&&(u.memoizedState=f),f}function $1(u){var f=Q1(u).next.queue;Oh(u,f,{},ta())}function a2(){return Lr(ob)}function Px(){return As().memoizedState}function J1(){return As().memoizedState}function Z1(u){for(var f=u.return;f!==null;){switch(f.tag){case 24:case 3:var v=ta();u=Fa(v);var E=Ha(f,u,v);E!==null&&(Gs(E,f,v),wu(E,f,v)),f={cache:Tx()},u.payload=f;return}f=f.return}}function e_(u,f,v){var E=ta();v={lane:E,revertLane:0,action:v,hasEagerState:!1,eagerState:null,next:null},o2(u)?t_(f,v):(v=wh(u,f,v,E),v!==null&&(Gs(v,u,E),n_(v,f,E)))}function Nx(u,f,v){var E=ta();Oh(u,f,v,E)}function Oh(u,f,v,E){var M={lane:E,revertLane:0,action:v,hasEagerState:!1,eagerState:null,next:null};if(o2(u))t_(f,M);else{var D=u.alternate;if(u.lanes===0&&(D===null||D.lanes===0)&&(D=f.lastRenderedReducer,D!==null))try{var G=f.lastRenderedState,Q=D(G,v);if(M.hasEagerState=!0,M.eagerState=Q,da(Q,G))return hp(u,f,M,0),Ii===null&&up(),!1}catch{}finally{}if(v=wh(u,f,M,E),v!==null)return Gs(v,u,E),n_(v,f,E),!0}return!1}function Tp(u,f,v,E){if(E={lane:2,revertLane:QM(),action:E,hasEagerState:!1,eagerState:null,next:null},o2(u)){if(f)throw Error(n(479))}else f=wh(u,v,E,2),f!==null&&Gs(f,u,2)}function o2(u){var f=u.alternate;return u===Nn||f!==null&&f===Nn}function t_(u,f){xu=vn=!0;var v=u.pending;v===null?f.next=f:(f.next=v.next,v.next=f),u.pending=f}function n_(u,f,v){if((v&4194176)!==0){var E=f.lanes;E&=u.pendingLanes,v|=E,f.lanes=v,vr(u,v)}}var fl={readContext:Lr,use:gd,useCallback:gs,useContext:gs,useEffect:gs,useImperativeHandle:gs,useLayoutEffect:gs,useInsertionEffect:gs,useMemo:gs,useReducer:gs,useRef:gs,useState:gs,useDebugValue:gs,useDeferredValue:gs,useTransition:gs,useSyncExternalStore:gs,useId:gs};fl.useCacheRefresh=gs,fl.useMemoCache=gs,fl.useHostTransitionStatus=gs,fl.useFormState=gs,fl.useActionState=gs,fl.useOptimistic=gs;var _u={readContext:Lr,use:gd,useCallback:function(u,f){return _r().memoizedState=[u,f===void 0?null:f],u},useContext:Lr,useEffect:G1,useImperativeHandle:function(u,f,v){v=v!=null?v.concat([u]):null,i2(4194308,4,Y1.bind(null,f,u),v)},useLayoutEffect:function(u,f){return i2(4194308,4,u,f)},useInsertionEffect:function(u,f){i2(4,2,u,f)},useMemo:function(u,f){var v=_r();f=f===void 0?null:f;var E=u();if(bu){ve(!0);try{u()}finally{ve(!1)}}return v.memoizedState=[E,f],E},useReducer:function(u,f,v){var E=_r();if(v!==void 0){var M=v(f);if(bu){ve(!0);try{v(f)}finally{ve(!1)}}}else M=f;return E.memoizedState=E.baseState=M,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:M},E.queue=u,u=u.dispatch=e_.bind(null,Nn,u),[E.memoizedState,u]},useRef:function(u){var f=_r();return u={current:u},f.memoizedState=u},useState:function(u){u=Rx(u);var f=u.queue,v=Nx.bind(null,Nn,f);return f.dispatch=v,[u.memoizedState,v]},useDebugValue:Bx,useDeferredValue:function(u,f){var v=_r();return r2(v,u,f)},useTransition:function(){var u=Rx(!1);return u=q1.bind(null,Nn,u.queue,!0,!1),_r().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,f,v){var E=Nn,M=_r();if(ni){if(v===void 0)throw Error(n(407));v=v()}else{if(v=f(),Ii===null)throw Error(n(349));(un&60)!==0||Qr(E,f,v)}M.memoizedState=v;var D={value:v,getSnapshot:f};return M.queue=D,G1(L1.bind(null,E,D,u),[u]),E.flags|=2048,hl(9,Eu.bind(null,E,D,v,f),{destroy:void 0},null),v},useId:function(){var u=_r(),f=Ii.identifierPrefix;if(ni){var v=ec,E=al;v=(E&~(1<<32-He(E)-1)).toString(32)+v,f=":"+f+"R"+v,v=pd++,0<v&&(f+="H"+v.toString(32)),f+=":"}else v=zM++,f=":"+f+"r"+v.toString(32)+":";return u.memoizedState=f},useCacheRefresh:function(){return _r().memoizedState=Z1.bind(null,Nn)}};_u.useMemoCache=Oo,_u.useHostTransitionStatus=a2,_u.useFormState=U1,_u.useActionState=U1,_u.useOptimistic=function(u){var f=_r();f.memoizedState=f.baseState=u;var v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=v,f=Tp.bind(null,Nn,!0,v),v.dispatch=f,[u,f]};var cc={readContext:Lr,use:gd,useCallback:W1,useContext:Lr,useEffect:Ix,useImperativeHandle:K1,useInsertionEffect:z1,useLayoutEffect:V1,useMemo:X1,useReducer:Po,useRef:H1,useState:function(){return Po(ss)},useDebugValue:Bx,useDeferredValue:function(u,f){var v=As();return j1(v,Mi.memoizedState,u,f)},useTransition:function(){var u=Po(ss)[0],f=As().memoizedState;return[typeof u=="boolean"?u:Sp(u),f]},useSyncExternalStore:D1,useId:Px};cc.useCacheRefresh=J1,cc.useMemoCache=Oo,cc.useHostTransitionStatus=a2,cc.useFormState=yd,cc.useActionState=yd,cc.useOptimistic=function(u,f){var v=As();return Dx(v,Mi,u,f)};var Ph={readContext:Lr,use:gd,useCallback:W1,useContext:Lr,useEffect:Ix,useImperativeHandle:K1,useInsertionEffect:z1,useLayoutEffect:V1,useMemo:X1,useReducer:n2,useRef:H1,useState:function(){return n2(ss)},useDebugValue:Bx,useDeferredValue:function(u,f){var v=As();return Mi===null?r2(v,u,f):j1(v,Mi.memoizedState,u,f)},useTransition:function(){var u=n2(ss)[0],f=As().memoizedState;return[typeof u=="boolean"?u:Sp(u),f]},useSyncExternalStore:D1,useId:Px};Ph.useCacheRefresh=J1,Ph.useMemoCache=Oo,Ph.useHostTransitionStatus=a2,Ph.useFormState=F1,Ph.useActionState=F1,Ph.useOptimistic=function(u,f){var v=As();return Mi!==null?Dx(v,Mi,u,f):(v.baseState=u,[u,v.queue.dispatch])};function Ux(u,f,v,E){f=u.memoizedState,v=v(E,f),v=v==null?f:L({},f,v),u.memoizedState=v,u.lanes===0&&(u.updateQueue.baseState=v)}var kx={isMounted:function(u){return(u=u._reactInternals)?ie(u)===u:!1},enqueueSetState:function(u,f,v){u=u._reactInternals;var E=ta(),M=Fa(E);M.payload=f,v!=null&&(M.callback=v),f=Ha(u,M,E),f!==null&&(Gs(f,u,E),wu(f,u,E))},enqueueReplaceState:function(u,f,v){u=u._reactInternals;var E=ta(),M=Fa(E);M.tag=1,M.payload=f,v!=null&&(M.callback=v),f=Ha(u,M,E),f!==null&&(Gs(f,u,E),wu(f,u,E))},enqueueForceUpdate:function(u,f){u=u._reactInternals;var v=ta(),E=Fa(v);E.tag=2,f!=null&&(E.callback=f),f=Ha(u,E,v),f!==null&&(Gs(f,u,v),wu(f,u,v))}};function i_(u,f,v,E,M,D,G){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(E,D,G):f.prototype&&f.prototype.isPureReactComponent?!Bo(v,E)||!Bo(M,D):!0}function s_(u,f,v,E){u=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(v,E),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(v,E),f.state!==u&&kx.enqueueReplaceState(f,f.state,null)}function Nh(u,f){var v=f;if("ref"in f){v={};for(var E in f)E!=="ref"&&(v[E]=f[E])}if(u=u.defaultProps){v===f&&(v=L({},v));for(var M in u)v[M]===void 0&&(v[M]=u[M])}return v}var l2=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)};function r_(u){l2(u)}function a_(u){console.error(u)}function o_(u){l2(u)}function c2(u,f){try{var v=u.onUncaughtError;v(f.value,{componentStack:f.stack})}catch(E){setTimeout(function(){throw E})}}function l_(u,f,v){try{var E=u.onCaughtError;E(v.value,{componentStack:v.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(M){setTimeout(function(){throw M})}}function Fx(u,f,v){return v=Fa(v),v.tag=3,v.payload={element:null},v.callback=function(){c2(u,f)},v}function Hx(u){return u=Fa(u),u.tag=3,u}function c_(u,f,v,E){var M=v.type.getDerivedStateFromError;if(typeof M=="function"){var D=E.value;u.payload=function(){return M(D)},u.callback=function(){l_(f,v,E)}}var G=v.stateNode;G!==null&&typeof G.componentDidCatch=="function"&&(u.callback=function(){l_(f,v,E),typeof M!="function"&&(Hs===null?Hs=new Set([this]):Hs.add(this));var Q=E.stack;this.componentDidCatch(E.value,{componentStack:Q!==null?Q:""})})}function XM(u,f,v,E,M){if(v.flags|=32768,E!==null&&typeof E=="object"&&typeof E.then=="function"){if(f=v.alternate,f!==null&&Mp(f,v,M,!0),v=ya.current,v!==null){switch(v.tag){case 13:return ll===null?Pp():v.alternate===null&&es===0&&(es=3),v.flags&=-257,v.flags|=65536,v.lanes=M,E===Qg?v.flags|=16384:(f=v.updateQueue,f===null?v.updateQueue=new Set([E]):f.add(E),En(u,E,M)),!1;case 22:return v.flags|=65536,E===Qg?v.flags|=16384:(f=v.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([E])},v.updateQueue=f):(v=f.retryQueue,v===null?f.retryQueue=new Set([E]):v.add(E)),En(u,E,M)),!1}throw Error(n(435,v.tag))}return En(u,E,M),Pp(),!1}if(ni)return f=ya.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=M,E!==gp&&(u=Error(n(422),{cause:E}),ol(ga(u,v)))):(E!==gp&&(f=Error(n(423),{cause:E}),ol(ga(f,v))),u=u.current.alternate,u.flags|=65536,M&=-M,u.lanes|=M,E=ga(E,v),M=Fx(u.stateNode,E,M),Ed(u,M),es!==4&&(es=2)),!1;var D=Error(n(520),{cause:E});if(D=ga(D,v),Op===null?Op=[D]:Op.push(D),es!==4&&(es=2),f===null)return!0;E=ga(E,v),v=f;do{switch(v.tag){case 3:return v.flags|=65536,u=M&-M,v.lanes|=u,u=Fx(v.stateNode,E,u),Ed(v,u),!1;case 1:if(f=v.type,D=v.stateNode,(v.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(Hs===null||!Hs.has(D))))return v.flags|=65536,M&=-M,v.lanes|=M,M=Hx(M),c_(M,u,v,E),Ed(v,M),!1}v=v.return}while(v!==null);return!1}var Ua=Error(n(461)),$s=!1;function Js(u,f,v,E){f.child=u===null?nc(f,null,v,E):tc(f,u.child,v,E)}function Gx(u,f,v,E,M){v=v.render;var D=f.ref;if("ref"in E){var G={};for(var Q in E)Q!=="ref"&&(G[Q]=E[Q])}else G=E;return kh(f),E=Mx(u,f,v,G,D,M),Q=Cx(),u!==null&&!$s?(_p(u,f,M),Es(u,f,M)):(ni&&Q&&mp(f),f.flags|=1,Js(u,f,E,M),f.child)}function zx(u,f,v,E,M){if(u===null){var D=v.type;return typeof D=="function"&&!gc(D)&&D.defaultProps===void 0&&v.compare===null?(f.tag=15,f.type=D,Vx(u,f,D,E,M)):(u=wd(v.type,null,E,f,f.mode,M),u.ref=f.ref,u.return=f,f.child=u)}if(D=u.child,!Qx(u,M)){var G=D.memoizedProps;if(v=v.compare,v=v!==null?v:Bo,v(G,E)&&u.ref===f.ref)return Es(u,f,M)}return f.flags|=1,u=Zr(D,E),u.ref=f.ref,u.return=f,f.child=u}function Vx(u,f,v,E,M){if(u!==null){var D=u.memoizedProps;if(Bo(D,E)&&u.ref===f.ref)if($s=!1,f.pendingProps=E=D,Qx(u,M))(u.flags&131072)!==0&&($s=!0);else return f.lanes=u.lanes,Es(u,f,M)}return Kx(u,f,v,E,M)}function u_(u,f,v){var E=f.pendingProps,M=E.children,D=(f.stateNode._pendingVisibility&2)!==0,G=u!==null?u.memoizedState:null;if(vd(u,f),E.mode==="hidden"||D){if((f.flags&128)!==0){if(E=G!==null?G.baseLanes|v:v,u!==null){for(M=f.child=u.child,D=0;M!==null;)D=D|M.lanes|M.childLanes,M=M.sibling;f.childLanes=D&~E}else f.childLanes=0,f.child=null;return Yx(u,f,E,v)}if((v&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},u!==null&&dd(f,G!==null?G.cachePool:null),G!==null?pu(f,G):Jg(),Sx(f);else return f.lanes=f.childLanes=536870912,Yx(u,f,G!==null?G.baseLanes|v:v,v)}else G!==null?(dd(f,G.cachePool),pu(f,G),sc(),f.memoizedState=null):(u!==null&&dd(f,null),Jg(),sc());return Js(u,f,M,v),f.child}function Yx(u,f,v,E){var M=Ep();return M=M===null?null:{parent:bs._currentValue,pool:M},f.memoizedState={baseLanes:v,cachePool:M},u!==null&&dd(f,null),Jg(),Sx(f),u!==null&&Mp(u,f,E,!0),null}function vd(u,f){var v=f.ref;if(v===null)u!==null&&u.ref!==null&&(f.flags|=2097664);else{if(typeof v!="function"&&typeof v!="object")throw Error(n(284));(u===null||u.ref!==v)&&(f.flags|=2097664)}}function Kx(u,f,v,E,M){return kh(f),v=Mx(u,f,v,E,void 0,M),E=Cx(),u!==null&&!$s?(_p(u,f,M),Es(u,f,M)):(ni&&E&&mp(f),f.flags|=1,Js(u,f,v,M),f.child)}function h_(u,f,v,E,M,D){return kh(f),f.updateQueue=null,v=R1(f,E,v,M),C1(u),E=Cx(),u!==null&&!$s?(_p(u,f,D),Es(u,f,D)):(ni&&E&&mp(f),f.flags|=1,Js(u,f,v,D),f.child)}function f_(u,f,v,E,M){if(kh(f),f.stateNode===null){var D=lu,G=v.contextType;typeof G=="object"&&G!==null&&(D=Lr(G)),D=new v(E,D),f.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=kx,f.stateNode=D,D._reactInternals=f,D=f.stateNode,D.props=E,D.state=f.memoizedState,D.refs={},$r(f),G=v.contextType,D.context=typeof G=="object"&&G!==null?Lr(G):lu,D.state=f.memoizedState,G=v.getDerivedStateFromProps,typeof G=="function"&&(Ux(f,v,G,E),D.state=f.memoizedState),typeof v.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(G=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),G!==D.state&&kx.enqueueReplaceState(D,D.state,null),Uo(f,E,D,M),Ir(),D.state=f.memoizedState),typeof D.componentDidMount=="function"&&(f.flags|=4194308),E=!0}else if(u===null){D=f.stateNode;var Q=f.memoizedProps,pe=Nh(v,Q);D.props=pe;var Te=D.context,ct=v.contextType;G=lu,typeof ct=="object"&&ct!==null&&(G=Lr(ct));var xt=v.getDerivedStateFromProps;ct=typeof xt=="function"||typeof D.getSnapshotBeforeUpdate=="function",Q=f.pendingProps!==Q,ct||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(Q||Te!==G)&&s_(f,D,E,G),ks=!1;var Ye=f.memoizedState;D.state=Ye,Uo(f,E,D,M),Ir(),Te=f.memoizedState,Q||Ye!==Te||ks?(typeof xt=="function"&&(Ux(f,v,xt,E),Te=f.memoizedState),(pe=ks||i_(f,v,pe,E,Ye,Te,G))?(ct||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(f.flags|=4194308)):(typeof D.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=E,f.memoizedState=Te),D.props=E,D.state=Te,D.context=G,E=pe):(typeof D.componentDidMount=="function"&&(f.flags|=4194308),E=!1)}else{D=f.stateNode,m2(u,f),G=f.memoizedProps,ct=Nh(v,G),D.props=ct,xt=f.pendingProps,Ye=D.context,Te=v.contextType,pe=lu,typeof Te=="object"&&Te!==null&&(pe=Lr(Te)),Q=v.getDerivedStateFromProps,(Te=typeof Q=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(G!==xt||Ye!==pe)&&s_(f,D,E,pe),ks=!1,Ye=f.memoizedState,D.state=Ye,Uo(f,E,D,M),Ir();var at=f.memoizedState;G!==xt||Ye!==at||ks||u!==null&&u.dependencies!==null&&bd(u.dependencies)?(typeof Q=="function"&&(Ux(f,v,Q,E),at=f.memoizedState),(ct=ks||i_(f,v,ct,E,Ye,at,pe)||u!==null&&u.dependencies!==null&&bd(u.dependencies))?(Te||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(E,at,pe),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(E,at,pe)),typeof D.componentDidUpdate=="function"&&(f.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof D.componentDidUpdate!="function"||G===u.memoizedProps&&Ye===u.memoizedState||(f.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||G===u.memoizedProps&&Ye===u.memoizedState||(f.flags|=1024),f.memoizedProps=E,f.memoizedState=at),D.props=E,D.state=at,D.context=pe,E=ct):(typeof D.componentDidUpdate!="function"||G===u.memoizedProps&&Ye===u.memoizedState||(f.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||G===u.memoizedProps&&Ye===u.memoizedState||(f.flags|=1024),E=!1)}return D=E,vd(u,f),E=(f.flags&128)!==0,D||E?(D=f.stateNode,v=E&&typeof v.getDerivedStateFromError!="function"?null:D.render(),f.flags|=1,u!==null&&E?(f.child=tc(f,u.child,null,M),f.child=tc(f,null,v,M)):Js(u,f,v,M),f.memoizedState=D.state,u=f.child):u=Es(u,f,M),u}function Wx(u,f,v,E){return ud(),f.flags|=256,Js(u,f,v,E),f.child}var Xx={dehydrated:null,treeContext:null,retryLane:0};function dr(u){return{baseLanes:u,cachePool:ac()}}function u2(u,f,v){return u=u!==null?u.childLanes&~v:0,f&&(u|=ea),u}function d_(u,f,v){var E=f.pendingProps,M=!1,D=(f.flags&128)!==0,G;if((G=D)||(G=u!==null&&u.memoizedState===null?!1:(Ns.current&2)!==0),G&&(M=!0,f.flags&=-129),G=(f.flags&32)!==0,f.flags&=-33,u===null){if(ni){if(M?ic(f):sc(),ni){var Q=fr,pe;if(pe=Q){e:{for(pe=Q,Q=ro;pe.nodeType!==8;){if(!Q){Q=null;break e}if(pe=Ac(pe.nextSibling),pe===null){Q=null;break e}}Q=pe}Q!==null?(f.memoizedState={dehydrated:Q,treeContext:Zl!==null?{id:al,overflow:ec}:null,retryLane:536870912},pe=ws(18,null,null,0),pe.stateNode=Q,pe.return=f,f.child=pe,Dr=f,fr=null,pe=!0):pe=!1}pe||Ch(f)}if(Q=f.memoizedState,Q!==null&&(Q=Q.dehydrated,Q!==null))return Q.data==="$!"?f.lanes=16:f.lanes=536870912,null;cl(f)}return Q=E.children,E=E.fallback,M?(sc(),M=f.mode,Q=qx({mode:"hidden",children:Q},M),E=Iu(E,M,v,null),Q.return=f,E.return=f,Q.sibling=E,f.child=Q,M=f.child,M.memoizedState=dr(v),M.childLanes=u2(u,G,v),f.memoizedState=Xx,E):(ic(f),jx(f,Q))}if(pe=u.memoizedState,pe!==null&&(Q=pe.dehydrated,Q!==null)){if(D)f.flags&256?(ic(f),f.flags&=-257,f=h2(u,f,v)):f.memoizedState!==null?(sc(),f.child=u.child,f.flags|=128,f=null):(sc(),M=E.fallback,Q=f.mode,E=qx({mode:"visible",children:E.children},Q),M=Iu(M,Q,v,null),M.flags|=2,E.return=f,M.return=f,E.sibling=M,f.child=E,tc(f,u.child,null,v),E=f.child,E.memoizedState=dr(v),E.childLanes=u2(u,G,v),f.memoizedState=Xx,f=M);else if(ic(f),Q.data==="$!"){if(G=Q.nextSibling&&Q.nextSibling.dataset,G)var Te=G.dgst;G=Te,E=Error(n(419)),E.stack="",E.digest=G,ol({value:E,source:null,stack:null}),f=h2(u,f,v)}else if($s||Mp(u,f,v,!1),G=(v&u.childLanes)!==0,$s||G){if(G=Ii,G!==null){if(E=v&-v,(E&42)!==0)E=1;else switch(E){case 2:E=1;break;case 8:E=4;break;case 32:E=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:E=64;break;case 268435456:E=134217728;break;default:E=0}if(E=(E&(G.suspendedLanes|v))!==0?0:E,E!==0&&E!==pe.retryLane)throw pe.retryLane=E,Jl(u,E),Gs(G,u,E),Ua}Q.data==="$?"||Pp(),f=h2(u,f,v)}else Q.data==="$?"?(f.flags|=128,f.child=u.child,f=Kh.bind(null,u),Q._reactRetry=f,f=null):(u=pe.treeContext,fr=Ac(Q.nextSibling),Dr=f,ni=!0,so=null,ro=!1,u!==null&&(Wi[Pa++]=al,Wi[Pa++]=ec,Wi[Pa++]=Zl,al=u.id,ec=u.overflow,Zl=f),f=jx(f,E.children),f.flags|=4096);return f}return M?(sc(),M=E.fallback,Q=f.mode,pe=u.child,Te=pe.sibling,E=Zr(pe,{mode:"hidden",children:E.children}),E.subtreeFlags=pe.subtreeFlags&31457280,Te!==null?M=Zr(Te,M):(M=Iu(M,Q,v,null),M.flags|=2),M.return=f,E.return=f,E.sibling=M,f.child=E,E=M,M=f.child,Q=u.child.memoizedState,Q===null?Q=dr(v):(pe=Q.cachePool,pe!==null?(Te=bs._currentValue,pe=pe.parent!==Te?{parent:Te,pool:Te}:pe):pe=ac(),Q={baseLanes:Q.baseLanes|v,cachePool:pe}),M.memoizedState=Q,M.childLanes=u2(u,G,v),f.memoizedState=Xx,E):(ic(f),v=u.child,u=v.sibling,v=Zr(v,{mode:"visible",children:E.children}),v.return=f,v.sibling=null,u!==null&&(G=f.deletions,G===null?(f.deletions=[u],f.flags|=16):G.push(u)),f.child=v,f.memoizedState=null,v)}function jx(u,f){return f=qx({mode:"visible",children:f},u.mode),f.return=u,u.child=f}function qx(u,f){return Jx(u,f,0,null)}function h2(u,f,v){return tc(f,u.child,null,v),u=jx(f,f.pendingProps.children),u.flags|=2,f.memoizedState=null,u}function f2(u,f,v){u.lanes|=f;var E=u.alternate;E!==null&&(E.lanes|=f),ka(u.return,f,v)}function Su(u,f,v,E,M){var D=u.memoizedState;D===null?u.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:E,tail:v,tailMode:M}:(D.isBackwards=f,D.rendering=null,D.renderingStartTime=0,D.last=E,D.tail=v,D.tailMode=M)}function Uh(u,f,v){var E=f.pendingProps,M=E.revealOrder,D=E.tail;if(Js(u,f,E.children,v),E=Ns.current,(E&2)!==0)E=E&1|2,f.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=f.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&f2(u,v,f);else if(u.tag===19)f2(u,v,f);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===f)break e;for(;u.sibling===null;){if(u.return===null||u.return===f)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}E&=1}switch(bt(Ns,E),M){case"forwards":for(v=f.child,M=null;v!==null;)u=v.alternate,u!==null&&fd(u)===null&&(M=v),v=v.sibling;v=M,v===null?(M=f.child,f.child=null):(M=v.sibling,v.sibling=null),Su(f,!1,M,v,D);break;case"backwards":for(v=null,M=f.child,f.child=null;M!==null;){if(u=M.alternate,u!==null&&fd(u)===null){f.child=M;break}u=M.sibling,M.sibling=v,v=M,M=u}Su(f,!0,v,null,D);break;case"together":Su(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function Es(u,f,v){if(u!==null&&(f.dependencies=u.dependencies),zo|=f.lanes,(v&f.childLanes)===0)if(u!==null){if(Mp(u,f,v,!1),(v&f.childLanes)===0)return null}else return null;if(u!==null&&f.child!==u.child)throw Error(n(153));if(f.child!==null){for(u=f.child,v=Zr(u,u.pendingProps),f.child=v,v.return=f;u.sibling!==null;)u=u.sibling,v=v.sibling=Zr(u,u.pendingProps),v.return=f;v.sibling=null}return f.child}function Qx(u,f){return(u.lanes&f)!==0?!0:(u=u.dependencies,!!(u!==null&&bd(u)))}function jM(u,f,v){switch(f.tag){case 3:At(f,f.stateNode.containerInfo),Tu(f,bs,u.memoizedState.cache),ud();break;case 27:case 5:st(f);break;case 4:At(f,f.stateNode.containerInfo);break;case 10:Tu(f,f.type,f.memoizedProps.value);break;case 13:var E=f.memoizedState;if(E!==null)return E.dehydrated!==null?(ic(f),f.flags|=128,null):(v&f.child.childLanes)!==0?d_(u,f,v):(ic(f),u=Es(u,f,v),u!==null?u.sibling:null);ic(f);break;case 19:var M=(u.flags&128)!==0;if(E=(v&f.childLanes)!==0,E||(Mp(u,f,v,!1),E=(v&f.childLanes)!==0),M){if(E)return Uh(u,f,v);f.flags|=128}if(M=f.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),bt(Ns,Ns.current),E)break;return null;case 22:case 23:return f.lanes=0,u_(u,f,v);case 24:Tu(f,bs,u.memoizedState.cache)}return Es(u,f,v)}function wp(u,f,v){if(u!==null)if(u.memoizedProps!==f.pendingProps)$s=!0;else{if(!Qx(u,v)&&(f.flags&128)===0)return $s=!1,jM(u,f,v);$s=(u.flags&131072)!==0}else $s=!1,ni&&(f.flags&1048576)!==0&&Ex(f,pp,f.index);switch(f.lanes=0,f.tag){case 16:e:{u=f.pendingProps;var E=f.elementType,M=E._init;if(E=M(E._payload),f.type=E,typeof E=="function")gc(E)?(u=Nh(E,u),f.tag=1,f=f_(null,f,E,u,v)):(f.tag=0,f=Kx(null,f,E,u,v));else{if(E!=null){if(M=E.$$typeof,M===x){f.tag=11,f=Gx(null,f,E,u,v);break e}else if(M===A){f.tag=14,f=zx(null,f,E,u,v);break e}}throw f=P(E)||E,Error(n(306,f,""))}}return f;case 0:return Kx(u,f,f.type,f.pendingProps,v);case 1:return E=f.type,M=Nh(E,f.pendingProps),f_(u,f,E,M,v);case 3:e:{if(At(f,f.stateNode.containerInfo),u===null)throw Error(n(387));var D=f.pendingProps;M=f.memoizedState,E=M.element,m2(u,f),Uo(f,D,null,v);var G=f.memoizedState;if(D=G.cache,Tu(f,bs,D),D!==M.cache&&d2(f,[bs],v,!0),Ir(),D=G.element,M.isDehydrated)if(M={element:D,isDehydrated:!1,cache:G.cache},f.updateQueue.baseState=M,f.memoizedState=M,f.flags&256){f=Wx(u,f,D,v);break e}else if(D!==E){E=ga(Error(n(424)),f),ol(E),f=Wx(u,f,D,v);break e}else for(fr=Ac(f.stateNode.containerInfo.firstChild),Dr=f,ni=!0,so=null,ro=!0,v=nc(f,null,D,v),f.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if(ud(),D===E){f=Es(u,f,v);break e}Js(u,f,D,v)}f=f.child}return f;case 26:return vd(u,f),u===null?(v=SP(f.type,null,f.pendingProps,null))?f.memoizedState=v:ni||(v=f.type,u=f.pendingProps,E=b_(Ot.current).createElement(v),E[$i]=f,E[Ln]=u,na(E,v,u),de(E),f.stateNode=E):f.memoizedState=SP(f.type,u.memoizedProps,f.pendingProps,u.memoizedState),null;case 27:return st(f),u===null&&ni&&(E=f.stateNode=AP(f.type,f.pendingProps,Ot.current),Dr=f,ro=!0,fr=Ac(E.firstChild)),E=f.pendingProps.children,u!==null||ni?Js(u,f,E,v):f.child=tc(f,null,E,v),vd(u,f),f.child;case 5:return u===null&&ni&&((M=E=fr)&&(E=_Y(E,f.type,f.pendingProps,ro),E!==null?(f.stateNode=E,Dr=f,fr=Ac(E.firstChild),ro=!1,M=!0):M=!1),M||Ch(f)),st(f),M=f.type,D=f.pendingProps,G=u!==null?u.memoizedProps:null,E=D.children,rC(M,D)?E=null:G!==null&&rC(M,G)&&(f.flags|=32),f.memoizedState!==null&&(M=Mx(u,f,VM,null,null,v),ob._currentValue=M),vd(u,f),Js(u,f,E,v),f.child;case 6:return u===null&&ni&&((u=v=fr)&&(v=SY(v,f.pendingProps,ro),v!==null?(f.stateNode=v,Dr=f,fr=null,u=!0):u=!1),u||Ch(f)),null;case 13:return d_(u,f,v);case 4:return At(f,f.stateNode.containerInfo),E=f.pendingProps,u===null?f.child=tc(f,null,E,v):Js(u,f,E,v),f.child;case 11:return Gx(u,f,f.type,f.pendingProps,v);case 7:return Js(u,f,f.pendingProps,v),f.child;case 8:return Js(u,f,f.pendingProps.children,v),f.child;case 12:return Js(u,f,f.pendingProps.children,v),f.child;case 10:return E=f.pendingProps,Tu(f,f.type,E.value),Js(u,f,E.children,v),f.child;case 9:return M=f.type._context,E=f.pendingProps.children,kh(f),M=Lr(M),E=E(M),f.flags|=1,Js(u,f,E,v),f.child;case 14:return zx(u,f,f.type,f.pendingProps,v);case 15:return Vx(u,f,f.type,f.pendingProps,v);case 19:return Uh(u,f,v);case 22:return u_(u,f,v);case 24:return kh(f),E=Lr(bs),u===null?(M=Ep(),M===null&&(M=Ii,D=Tx(),M.pooledCache=D,D.refCount++,D!==null&&(M.pooledCacheLanes|=v),M=D),f.memoizedState={parent:E,cache:M},$r(f),Tu(f,bs,M)):((u.lanes&v)!==0&&(m2(u,f),Uo(f,null,null,v),Ir()),M=u.memoizedState,D=f.memoizedState,M.parent!==E?(M={parent:E,cache:E},f.memoizedState=M,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=M),Tu(f,bs,E)):(E=D.cache,Tu(f,bs,E),E!==M.cache&&d2(f,[bs],v,!0))),Js(u,f,f.pendingProps.children,v),f.child;case 29:throw f.pendingProps}throw Error(n(156,f.tag))}var xd=tt(null),dl=null,No=null;function Tu(u,f,v){bt(xd,f._currentValue),f._currentValue=v}function uc(u){u._currentValue=xd.current,Mt(xd)}function ka(u,f,v){for(;u!==null;){var E=u.alternate;if((u.childLanes&f)!==f?(u.childLanes|=f,E!==null&&(E.childLanes|=f)):E!==null&&(E.childLanes&f)!==f&&(E.childLanes|=f),u===v)break;u=u.return}}function d2(u,f,v,E){var M=u.child;for(M!==null&&(M.return=u);M!==null;){var D=M.dependencies;if(D!==null){var G=M.child;D=D.firstContext;e:for(;D!==null;){var Q=D;D=M;for(var pe=0;pe<f.length;pe++)if(Q.context===f[pe]){D.lanes|=v,Q=D.alternate,Q!==null&&(Q.lanes|=v),ka(D.return,v,u),E||(G=null);break e}D=Q.next}}else if(M.tag===18){if(G=M.return,G===null)throw Error(n(341));G.lanes|=v,D=G.alternate,D!==null&&(D.lanes|=v),ka(G,v,u),G=null}else G=M.child;if(G!==null)G.return=M;else for(G=M;G!==null;){if(G===u){G=null;break}if(M=G.sibling,M!==null){M.return=G.return,G=M;break}G=G.return}M=G}}function Mp(u,f,v,E){u=null;for(var M=f,D=!1;M!==null;){if(!D){if((M.flags&524288)!==0)D=!0;else if((M.flags&262144)!==0)break}if(M.tag===10){var G=M.alternate;if(G===null)throw Error(n(387));if(G=G.memoizedProps,G!==null){var Q=M.type;da(M.pendingProps.value,G.value)||(u!==null?u.push(Q):u=[Q])}}else if(M===te.current){if(G=M.alternate,G===null)throw Error(n(387));G.memoizedState.memoizedState!==M.memoizedState.memoizedState&&(u!==null?u.push(ob):u=[ob])}M=M.return}u!==null&&d2(f,u,v,E),f.flags|=262144}function bd(u){for(u=u.firstContext;u!==null;){if(!da(u.context._currentValue,u.memoizedValue))return!0;u=u.next}return!1}function kh(u){dl=u,No=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function Lr(u){return Ad(dl,u)}function p2(u,f){return dl===null&&kh(u),Ad(u,f)}function Ad(u,f){var v=f._currentValue;if(f={context:f,memoizedValue:v,next:null},No===null){if(u===null)throw Error(n(308));No=f,u.dependencies={lanes:0,firstContext:f},u.flags|=524288}else No=No.next=f;return v}var ks=!1;function $r(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function m2(u,f){u=u.updateQueue,f.updateQueue===u&&(f.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function Fa(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function Ha(u,f,v){var E=u.updateQueue;if(E===null)return null;if(E=E.shared,(An&2)!==0){var M=E.pending;return M===null?f.next=f:(f.next=M.next,M.next=f),E.pending=f,f=dp(u),fp(u,null,v),f}return hp(u,E,f,v),dp(u)}function wu(u,f,v){if(f=f.updateQueue,f!==null&&(f=f.shared,(v&4194176)!==0)){var E=f.lanes;E&=u.pendingLanes,v|=E,f.lanes=v,vr(u,v)}}function Ed(u,f){var v=u.updateQueue,E=u.alternate;if(E!==null&&(E=E.updateQueue,v===E)){var M=null,D=null;if(v=v.firstBaseUpdate,v!==null){do{var G={lane:v.lane,tag:v.tag,payload:v.payload,callback:null,next:null};D===null?M=D=G:D=D.next=G,v=v.next}while(v!==null);D===null?M=D=f:D=D.next=f}else M=D=f;v={baseState:E.baseState,firstBaseUpdate:M,lastBaseUpdate:D,shared:E.shared,callbacks:E.callbacks},u.updateQueue=v;return}u=v.lastBaseUpdate,u===null?v.firstBaseUpdate=f:u.next=f,v.lastBaseUpdate=f}var xa=!1;function Ir(){if(xa){var u=yu;if(u!==null)throw u}}function Uo(u,f,v,E){xa=!1;var M=u.updateQueue;ks=!1;var D=M.firstBaseUpdate,G=M.lastBaseUpdate,Q=M.shared.pending;if(Q!==null){M.shared.pending=null;var pe=Q,Te=pe.next;pe.next=null,G===null?D=Te:G.next=Te,G=pe;var ct=u.alternate;ct!==null&&(ct=ct.updateQueue,Q=ct.lastBaseUpdate,Q!==G&&(Q===null?ct.firstBaseUpdate=Te:Q.next=Te,ct.lastBaseUpdate=pe))}if(D!==null){var xt=M.baseState;G=0,ct=Te=pe=null,Q=D;do{var Ye=Q.lane&-536870913,at=Ye!==Q.lane;if(at?(un&Ye)===Ye:(E&Ye)===Ye){Ye!==0&&Ye===Lh&&(xa=!0),ct!==null&&(ct=ct.next={lane:0,tag:Q.tag,payload:Q.payload,callback:null,next:null});e:{var an=u,Mn=Q;Ye=f;var zs=v;switch(Mn.tag){case 1:if(an=Mn.payload,typeof an=="function"){xt=an.call(zs,xt,Ye);break e}xt=an;break e;case 3:an.flags=an.flags&-65537|128;case 0:if(an=Mn.payload,Ye=typeof an=="function"?an.call(zs,xt,Ye):an,Ye==null)break e;xt=L({},xt,Ye);break e;case 2:ks=!0}}Ye=Q.callback,Ye!==null&&(u.flags|=64,at&&(u.flags|=8192),at=M.callbacks,at===null?M.callbacks=[Ye]:at.push(Ye))}else at={lane:Ye,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},ct===null?(Te=ct=at,pe=xt):ct=ct.next=at,G|=Ye;if(Q=Q.next,Q===null){if(Q=M.shared.pending,Q===null)break;at=Q,Q=at.next,at.next=null,M.lastBaseUpdate=at,M.shared.pending=null}}while(!0);ct===null&&(pe=xt),M.baseState=pe,M.firstBaseUpdate=Te,M.lastBaseUpdate=ct,D===null&&(M.shared.lanes=0),zo|=G,u.lanes=G,u.memoizedState=xt}}function pl(u,f){if(typeof u!="function")throw Error(n(191,u));u.call(f)}function ml(u,f){var v=u.callbacks;if(v!==null)for(u.callbacks=null,u=0;u<v.length;u++)pl(v[u],f)}function _s(u,f){try{var v=f.updateQueue,E=v!==null?v.lastEffect:null;if(E!==null){var M=E.next;v=M;do{if((v.tag&u)===u){E=void 0;var D=v.create,G=v.inst;E=D(),G.destroy=E}v=v.next}while(v!==M)}}catch(Q){Tt(f,f.return,Q)}}function ao(u,f,v){try{var E=f.updateQueue,M=E!==null?E.lastEffect:null;if(M!==null){var D=M.next;E=D;do{if((E.tag&u)===u){var G=E.inst,Q=G.destroy;if(Q!==void 0){G.destroy=void 0,M=f;var pe=v;try{Q()}catch(Te){Tt(M,pe,Te)}}}E=E.next}while(E!==D)}}catch(Te){Tt(f,f.return,Te)}}function hc(u){var f=u.updateQueue;if(f!==null){var v=u.stateNode;try{ml(f,v)}catch(E){Tt(u,u.return,E)}}}function Cp(u,f,v){v.props=Nh(u.type,u.memoizedProps),v.state=u.memoizedState;try{v.componentWillUnmount()}catch(E){Tt(u,f,E)}}function Ss(u,f){try{var v=u.ref;if(v!==null){var E=u.stateNode;switch(u.tag){case 26:case 27:case 5:var M=E;break;default:M=E}typeof v=="function"?u.refCleanup=v(M):v.current=M}}catch(D){Tt(u,f,D)}}function Li(u,f){var v=u.ref,E=u.refCleanup;if(v!==null)if(typeof E=="function")try{E()}catch(M){Tt(u,f,M)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof v=="function")try{v(null)}catch(M){Tt(u,f,M)}else v.current=null}function ii(u){var f=u.type,v=u.memoizedProps,E=u.stateNode;try{e:switch(f){case"button":case"input":case"select":case"textarea":v.autoFocus&&E.focus();break e;case"img":v.src?E.src=v.src:v.srcSet&&(E.srcset=v.srcSet)}}catch(M){Tt(u,u.return,M)}}function oo(u,f,v){try{var E=u.stateNode;vY(E,u.type,v,f),E[Ln]=f}catch(M){Tt(u,u.return,M)}}function ko(u){return u.tag===5||u.tag===3||u.tag===26||u.tag===27||u.tag===4}function Rp(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||ko(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==27&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function ba(u,f,v){var E=u.tag;if(E===5||E===6)u=u.stateNode,f?v.nodeType===8?v.parentNode.insertBefore(u,f):v.insertBefore(u,f):(v.nodeType===8?(f=v.parentNode,f.insertBefore(u,v)):(f=v,f.appendChild(u)),v=v._reactRootContainer,v!=null||f.onclick!==null||(f.onclick=x_));else if(E!==4&&E!==27&&(u=u.child,u!==null))for(ba(u,f,v),u=u.sibling;u!==null;)ba(u,f,v),u=u.sibling}function fc(u,f,v){var E=u.tag;if(E===5||E===6)u=u.stateNode,f?v.insertBefore(u,f):v.appendChild(u);else if(E!==4&&E!==27&&(u=u.child,u!==null))for(fc(u,f,v),u=u.sibling;u!==null;)fc(u,f,v),u=u.sibling}var Fo=!1,Ji=!1,Mu=!1,g2=typeof WeakSet=="function"?WeakSet:Set,Ts=null,y2=!1;function _d(u,f){if(u=u.containerInfo,iC=w_,u=gx(u),cp(u)){if("selectionStart"in u)var v={start:u.selectionStart,end:u.selectionEnd};else e:{v=(v=u.ownerDocument)&&v.defaultView||window;var E=v.getSelection&&v.getSelection();if(E&&E.rangeCount!==0){v=E.anchorNode;var M=E.anchorOffset,D=E.focusNode;E=E.focusOffset;try{v.nodeType,D.nodeType}catch{v=null;break e}var G=0,Q=-1,pe=-1,Te=0,ct=0,xt=u,Ye=null;t:for(;;){for(var at;xt!==v||M!==0&&xt.nodeType!==3||(Q=G+M),xt!==D||E!==0&&xt.nodeType!==3||(pe=G+E),xt.nodeType===3&&(G+=xt.nodeValue.length),(at=xt.firstChild)!==null;)Ye=xt,xt=at;for(;;){if(xt===u)break t;if(Ye===v&&++Te===M&&(Q=G),Ye===D&&++ct===E&&(pe=G),(at=xt.nextSibling)!==null)break;xt=Ye,Ye=xt.parentNode}xt=at}v=Q===-1||pe===-1?null:{start:Q,end:pe}}else v=null}v=v||{start:0,end:0}}else v=null;for(sC={focusedElem:u,selectionRange:v},w_=!1,Ts=f;Ts!==null;)if(f=Ts,u=f.child,(f.subtreeFlags&1028)!==0&&u!==null)u.return=f,Ts=u;else for(;Ts!==null;){switch(f=Ts,D=f.alternate,u=f.flags,f.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&D!==null){u=void 0,v=f,M=D.memoizedProps,D=D.memoizedState,E=v.stateNode;try{var an=Nh(v.type,M,v.elementType===v.type);u=E.getSnapshotBeforeUpdate(an,D),E.__reactInternalSnapshotBeforeUpdate=u}catch(Mn){Tt(v,v.return,Mn)}}break;case 3:if((u&1024)!==0){if(u=f.stateNode.containerInfo,v=u.nodeType,v===9)lC(u);else if(v===1)switch(u.nodeName){case"HEAD":case"HTML":case"BODY":lC(u);break;default:u.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(n(163))}if(u=f.sibling,u!==null){u.return=f.return,Ts=u;break}Ts=f.return}return an=y2,y2=!1,an}function Sd(u,f,v){var E=v.flags;switch(v.tag){case 0:case 11:case 15:gl(u,v),E&4&&_s(5,v);break;case 1:if(gl(u,v),E&4)if(u=v.stateNode,f===null)try{u.componentDidMount()}catch(Q){Tt(v,v.return,Q)}else{var M=Nh(v.type,f.memoizedProps);f=f.memoizedState;try{u.componentDidUpdate(M,f,u.__reactInternalSnapshotBeforeUpdate)}catch(Q){Tt(v,v.return,Q)}}E&64&&hc(v),E&512&&Ss(v,v.return);break;case 3:if(gl(u,v),E&64&&(E=v.updateQueue,E!==null)){if(u=null,v.child!==null)switch(v.child.tag){case 27:case 5:u=v.child.stateNode;break;case 1:u=v.child.stateNode}try{ml(E,u)}catch(Q){Tt(v,v.return,Q)}}break;case 26:gl(u,v),E&512&&Ss(v,v.return);break;case 27:case 5:gl(u,v),f===null&&E&4&&ii(v),E&512&&Ss(v,v.return);break;case 12:gl(u,v);break;case 13:gl(u,v),E&4&&p_(u,v);break;case 22:if(M=v.memoizedState!==null||Fo,!M){f=f!==null&&f.memoizedState!==null||Ji;var D=Fo,G=Ji;Fo=M,(Ji=f)&&!G?Go(u,v,(v.subtreeFlags&8772)!==0):gl(u,v),Fo=D,Ji=G}E&512&&(v.memoizedProps.mode==="manual"?Ss(v,v.return):Li(v,v.return));break;default:gl(u,v)}}function v2(u){var f=u.alternate;f!==null&&(u.alternate=null,v2(f)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(f=u.stateNode,f!==null&&Rt(f)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}var Zi=null,pr=!1;function Br(u,f,v){for(v=v.child;v!==null;)x2(u,f,v),v=v.sibling}function x2(u,f,v){if(Dt&&typeof Dt.onCommitFiberUnmount=="function")try{Dt.onCommitFiberUnmount(Et,v)}catch{}switch(v.tag){case 26:Ji||Li(v,f),Br(u,f,v),v.memoizedState?v.memoizedState.count--:v.stateNode&&(v=v.stateNode,v.parentNode.removeChild(v));break;case 27:Ji||Li(v,f);var E=Zi,M=pr;for(Zi=v.stateNode,Br(u,f,v),v=v.stateNode,f=v.attributes;f.length;)v.removeAttributeNode(f[0]);Rt(v),Zi=E,pr=M;break;case 5:Ji||Li(v,f);case 6:M=Zi;var D=pr;if(Zi=null,Br(u,f,v),Zi=M,pr=D,Zi!==null)if(pr)try{u=Zi,E=v.stateNode,u.nodeType===8?u.parentNode.removeChild(E):u.removeChild(E)}catch(G){Tt(v,f,G)}else try{Zi.removeChild(v.stateNode)}catch(G){Tt(v,f,G)}break;case 18:Zi!==null&&(pr?(f=Zi,v=v.stateNode,f.nodeType===8?oC(f.parentNode,v):f.nodeType===1&&oC(f,v),hb(f)):oC(Zi,v.stateNode));break;case 4:E=Zi,M=pr,Zi=v.stateNode.containerInfo,pr=!0,Br(u,f,v),Zi=E,pr=M;break;case 0:case 11:case 14:case 15:Ji||ao(2,v,f),Ji||ao(4,v,f),Br(u,f,v);break;case 1:Ji||(Li(v,f),E=v.stateNode,typeof E.componentWillUnmount=="function"&&Cp(v,f,E)),Br(u,f,v);break;case 21:Br(u,f,v);break;case 22:Ji||Li(v,f),Ji=(E=Ji)||v.memoizedState!==null,Br(u,f,v),Ji=E;break;default:Br(u,f,v)}}function p_(u,f){if(f.memoizedState===null&&(u=f.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{hb(u)}catch(v){Tt(f,f.return,v)}}function Dp(u){switch(u.tag){case 13:case 19:var f=u.stateNode;return f===null&&(f=u.stateNode=new g2),f;case 22:return u=u.stateNode,f=u._retryCache,f===null&&(f=u._retryCache=new g2),f;default:throw Error(n(435,u.tag))}}function Lp(u,f){var v=Dp(u);f.forEach(function(E){var M=ke.bind(null,u,E);v.has(E)||(v.add(E),E.then(M,M))})}function Jr(u,f){var v=f.deletions;if(v!==null)for(var E=0;E<v.length;E++){var M=v[E],D=u,G=f,Q=G;e:for(;Q!==null;){switch(Q.tag){case 27:case 5:Zi=Q.stateNode,pr=!1;break e;case 3:Zi=Q.stateNode.containerInfo,pr=!0;break e;case 4:Zi=Q.stateNode.containerInfo,pr=!0;break e}Q=Q.return}if(Zi===null)throw Error(n(160));x2(D,G,M),Zi=null,pr=!1,D=M.alternate,D!==null&&(D.return=null),M.return=null}if(f.subtreeFlags&13878)for(f=f.child;f!==null;)Fh(f,u),f=f.sibling}var Or=null;function Fh(u,f){var v=u.alternate,E=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:Jr(f,u),Pr(u),E&4&&(ao(3,u,u.return),_s(3,u),ao(5,u,u.return));break;case 1:Jr(f,u),Pr(u),E&512&&(Ji||v===null||Li(v,v.return)),E&64&&Fo&&(u=u.updateQueue,u!==null&&(E=u.callbacks,E!==null&&(v=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=v===null?E:v.concat(E))));break;case 26:var M=Or;if(Jr(f,u),Pr(u),E&512&&(Ji||v===null||Li(v,v.return)),E&4){var D=v!==null?v.memoizedState:null;if(E=u.memoizedState,v===null)if(E===null)if(u.stateNode===null){e:{E=u.type,v=u.memoizedProps,M=M.ownerDocument||M;t:switch(E){case"title":D=M.getElementsByTagName("title")[0],(!D||D[Xe]||D[$i]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=M.createElement(E),M.head.insertBefore(D,M.querySelector("head > title"))),na(D,E,v),D[$i]=u,de(D),E=D;break e;case"link":var G=MP("link","href",M).get(E+(v.href||""));if(G){for(var Q=0;Q<G.length;Q++)if(D=G[Q],D.getAttribute("href")===(v.href==null?null:v.href)&&D.getAttribute("rel")===(v.rel==null?null:v.rel)&&D.getAttribute("title")===(v.title==null?null:v.title)&&D.getAttribute("crossorigin")===(v.crossOrigin==null?null:v.crossOrigin)){G.splice(Q,1);break t}}D=M.createElement(E),na(D,E,v),M.head.appendChild(D);break;case"meta":if(G=MP("meta","content",M).get(E+(v.content||""))){for(Q=0;Q<G.length;Q++)if(D=G[Q],D.getAttribute("content")===(v.content==null?null:""+v.content)&&D.getAttribute("name")===(v.name==null?null:v.name)&&D.getAttribute("property")===(v.property==null?null:v.property)&&D.getAttribute("http-equiv")===(v.httpEquiv==null?null:v.httpEquiv)&&D.getAttribute("charset")===(v.charSet==null?null:v.charSet)){G.splice(Q,1);break t}}D=M.createElement(E),na(D,E,v),M.head.appendChild(D);break;default:throw Error(n(468,E))}D[$i]=u,de(D),E=D}u.stateNode=E}else CP(M,u.type,u.stateNode);else u.stateNode=wP(M,E,u.memoizedProps);else D!==E?(D===null?v.stateNode!==null&&(v=v.stateNode,v.parentNode.removeChild(v)):D.count--,E===null?CP(M,u.type,u.stateNode):wP(M,E,u.memoizedProps)):E===null&&u.stateNode!==null&&oo(u,u.memoizedProps,v.memoizedProps)}break;case 27:if(E&4&&u.alternate===null){M=u.stateNode,D=u.memoizedProps;try{for(var pe=M.firstChild;pe;){var Te=pe.nextSibling,ct=pe.nodeName;pe[Xe]||ct==="HEAD"||ct==="BODY"||ct==="SCRIPT"||ct==="STYLE"||ct==="LINK"&&pe.rel.toLowerCase()==="stylesheet"||M.removeChild(pe),pe=Te}for(var xt=u.type,Ye=M.attributes;Ye.length;)M.removeAttributeNode(Ye[0]);na(M,xt,D),M[$i]=u,M[Ln]=D}catch(an){Tt(u,u.return,an)}}case 5:if(Jr(f,u),Pr(u),E&512&&(Ji||v===null||Li(v,v.return)),u.flags&32){M=u.stateNode;try{Xr(M,"")}catch(an){Tt(u,u.return,an)}}E&4&&u.stateNode!=null&&(M=u.memoizedProps,oo(u,M,v!==null?v.memoizedProps:M)),E&1024&&(Mu=!0);break;case 6:if(Jr(f,u),Pr(u),E&4){if(u.stateNode===null)throw Error(n(162));E=u.memoizedProps,v=u.stateNode;try{v.nodeValue=E}catch(an){Tt(u,u.return,an)}}break;case 3:if(__=null,M=Or,Or=A_(f.containerInfo),Jr(f,u),Or=M,Pr(u),E&4&&v!==null&&v.memoizedState.isDehydrated)try{hb(f.containerInfo)}catch(an){Tt(u,u.return,an)}Mu&&(Mu=!1,Cu(u));break;case 4:E=Or,Or=A_(u.stateNode.containerInfo),Jr(f,u),Pr(u),Or=E;break;case 12:Jr(f,u),Pr(u);break;case 13:Jr(f,u),Pr(u),u.child.flags&8192&&u.memoizedState!==null!=(v!==null&&v.memoizedState!==null)&&(Un=Fe()),E&4&&(E=u.updateQueue,E!==null&&(u.updateQueue=null,Lp(u,E)));break;case 22:if(E&512&&(Ji||v===null||Li(v,v.return)),pe=u.memoizedState!==null,Te=v!==null&&v.memoizedState!==null,ct=Fo,xt=Ji,Fo=ct||pe,Ji=xt||Te,Jr(f,u),Ji=xt,Fo=ct,Pr(u),f=u.stateNode,f._current=u,f._visibility&=-3,f._visibility|=f._pendingVisibility&2,E&8192&&(f._visibility=pe?f._visibility&-2:f._visibility|1,pe&&(f=Fo||Ji,v===null||Te||f||Ho(u)),u.memoizedProps===null||u.memoizedProps.mode!=="manual"))e:for(v=null,f=u;;){if(f.tag===5||f.tag===26||f.tag===27){if(v===null){Te=v=f;try{if(M=Te.stateNode,pe)D=M.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none";else{G=Te.stateNode,Q=Te.memoizedProps.style;var at=Q!=null&&Q.hasOwnProperty("display")?Q.display:null;G.style.display=at==null||typeof at=="boolean"?"":(""+at).trim()}}catch(an){Tt(Te,Te.return,an)}}}else if(f.tag===6){if(v===null){Te=f;try{Te.stateNode.nodeValue=pe?"":Te.memoizedProps}catch(an){Tt(Te,Te.return,an)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===u)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break e;for(;f.sibling===null;){if(f.return===null||f.return===u)break e;v===f&&(v=null),f=f.return}v===f&&(v=null),f.sibling.return=f.return,f=f.sibling}E&4&&(E=u.updateQueue,E!==null&&(v=E.retryQueue,v!==null&&(E.retryQueue=null,Lp(u,v))));break;case 19:Jr(f,u),Pr(u),E&4&&(E=u.updateQueue,E!==null&&(u.updateQueue=null,Lp(u,E)));break;case 21:break;default:Jr(f,u),Pr(u)}}function Pr(u){var f=u.flags;if(f&2){try{if(u.tag!==27){e:{for(var v=u.return;v!==null;){if(ko(v)){var E=v;break e}v=v.return}throw Error(n(160))}switch(E.tag){case 27:var M=E.stateNode,D=Rp(u);fc(u,D,M);break;case 5:var G=E.stateNode;E.flags&32&&(Xr(G,""),E.flags&=-33);var Q=Rp(u);fc(u,Q,G);break;case 3:case 4:var pe=E.stateNode.containerInfo,Te=Rp(u);ba(u,Te,pe);break;default:throw Error(n(161))}}}catch(ct){Tt(u,u.return,ct)}u.flags&=-3}f&4096&&(u.flags&=-4097)}function Cu(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var f=u;Cu(f),f.tag===5&&f.flags&1024&&f.stateNode.reset(),u=u.sibling}}function gl(u,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)Sd(u,f.alternate,f),f=f.sibling}function Ho(u){for(u=u.child;u!==null;){var f=u;switch(f.tag){case 0:case 11:case 14:case 15:ao(4,f,f.return),Ho(f);break;case 1:Li(f,f.return);var v=f.stateNode;typeof v.componentWillUnmount=="function"&&Cp(f,f.return,v),Ho(f);break;case 26:case 27:case 5:Li(f,f.return),Ho(f);break;case 22:Li(f,f.return),f.memoizedState===null&&Ho(f);break;default:Ho(f)}u=u.sibling}}function Go(u,f,v){for(v=v&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var E=f.alternate,M=u,D=f,G=D.flags;switch(D.tag){case 0:case 11:case 15:Go(M,D,v),_s(4,D);break;case 1:if(Go(M,D,v),E=D,M=E.stateNode,typeof M.componentDidMount=="function")try{M.componentDidMount()}catch(Te){Tt(E,E.return,Te)}if(E=D,M=E.updateQueue,M!==null){var Q=E.stateNode;try{var pe=M.shared.hiddenCallbacks;if(pe!==null)for(M.shared.hiddenCallbacks=null,M=0;M<pe.length;M++)pl(pe[M],Q)}catch(Te){Tt(E,E.return,Te)}}v&&G&64&&hc(D),Ss(D,D.return);break;case 26:case 27:case 5:Go(M,D,v),v&&E===null&&G&4&&ii(D),Ss(D,D.return);break;case 12:Go(M,D,v);break;case 13:Go(M,D,v),v&&G&4&&p_(M,D);break;case 22:D.memoizedState===null&&Go(M,D,v),Ss(D,D.return);break;default:Go(M,D,v)}f=f.sibling}}function Aa(u,f){var v=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),u=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(u=f.memoizedState.cachePool.pool),u!==v&&(u!=null&&u.refCount++,v!=null&&mu(v))}function lo(u,f){u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&mu(u))}function Xi(u,f,v,E){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)dc(u,f,v,E),f=f.sibling}function dc(u,f,v,E){var M=f.flags;switch(f.tag){case 0:case 11:case 15:Xi(u,f,v,E),M&2048&&_s(9,f);break;case 3:Xi(u,f,v,E),M&2048&&(u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&mu(u)));break;case 12:if(M&2048){Xi(u,f,v,E),u=f.stateNode;try{var D=f.memoizedProps,G=D.id,Q=D.onPostCommit;typeof Q=="function"&&Q(G,f.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(pe){Tt(f,f.return,pe)}}else Xi(u,f,v,E);break;case 23:break;case 22:D=f.stateNode,f.memoizedState!==null?D._visibility&4?Xi(u,f,v,E):ui(u,f):D._visibility&4?Xi(u,f,v,E):(D._visibility|=4,bn(u,f,v,E,(f.subtreeFlags&10256)!==0)),M&2048&&Aa(f.alternate,f);break;case 24:Xi(u,f,v,E),M&2048&&lo(f.alternate,f);break;default:Xi(u,f,v,E)}}function bn(u,f,v,E,M){for(M=M&&(f.subtreeFlags&10256)!==0,f=f.child;f!==null;){var D=u,G=f,Q=v,pe=E,Te=G.flags;switch(G.tag){case 0:case 11:case 15:bn(D,G,Q,pe,M),_s(8,G);break;case 23:break;case 22:var ct=G.stateNode;G.memoizedState!==null?ct._visibility&4?bn(D,G,Q,pe,M):ui(D,G):(ct._visibility|=4,bn(D,G,Q,pe,M)),M&&Te&2048&&Aa(G.alternate,G);break;case 24:bn(D,G,Q,pe,M),M&&Te&2048&&lo(G.alternate,G);break;default:bn(D,G,Q,pe,M)}f=f.sibling}}function ui(u,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var v=u,E=f,M=E.flags;switch(E.tag){case 22:ui(v,E),M&2048&&Aa(E.alternate,E);break;case 24:ui(v,E),M&2048&&lo(E.alternate,E);break;default:ui(v,E)}f=f.sibling}}var rs=8192;function pc(u){if(u.subtreeFlags&rs)for(u=u.child;u!==null;)Hh(u),u=u.sibling}function Hh(u){switch(u.tag){case 26:pc(u),u.flags&rs&&u.memoizedState!==null&&UY(Or,u.memoizedState,u.memoizedProps);break;case 5:pc(u);break;case 3:case 4:var f=Or;Or=A_(u.stateNode.containerInfo),pc(u),Or=f;break;case 22:u.memoizedState===null&&(f=u.alternate,f!==null&&f.memoizedState!==null?(f=rs,rs=16777216,pc(u),rs=f):pc(u));break;default:pc(u)}}function Ru(u){var f=u.alternate;if(f!==null&&(u=f.child,u!==null)){f.child=null;do f=u.sibling,u.sibling=null,u=f;while(u!==null)}}function Du(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var v=0;v<f.length;v++){var E=f[v];Ts=E,m_(E,u)}Ru(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Td(u),u=u.sibling}function Td(u){switch(u.tag){case 0:case 11:case 15:Du(u),u.flags&2048&&ao(9,u,u.return);break;case 3:Du(u);break;case 12:Du(u);break;case 22:var f=u.stateNode;u.memoizedState!==null&&f._visibility&4&&(u.return===null||u.return.tag!==13)?(f._visibility&=-5,mc(u)):Du(u);break;default:Du(u)}}function mc(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var v=0;v<f.length;v++){var E=f[v];Ts=E,m_(E,u)}Ru(u)}for(u=u.child;u!==null;){switch(f=u,f.tag){case 0:case 11:case 15:ao(8,f,f.return),mc(f);break;case 22:v=f.stateNode,v._visibility&4&&(v._visibility&=-5,mc(f));break;default:mc(f)}u=u.sibling}}function m_(u,f){for(;Ts!==null;){var v=Ts;switch(v.tag){case 0:case 11:case 15:ao(8,v,f);break;case 23:case 22:if(v.memoizedState!==null&&v.memoizedState.cachePool!==null){var E=v.memoizedState.cachePool.pool;E!=null&&E.refCount++}break;case 24:mu(v.memoizedState.cache)}if(E=v.child,E!==null)E.return=v,Ts=E;else e:for(v=u;Ts!==null;){E=Ts;var M=E.sibling,D=E.return;if(v2(E),E===v){Ts=null;break e}if(M!==null){M.return=D,Ts=M;break e}Ts=D}}}function $x(u,f,v,E){this.tag=u,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ws(u,f,v,E){return new $x(u,f,v,E)}function gc(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Zr(u,f){var v=u.alternate;return v===null?(v=ws(u.tag,f,u.key,u.mode),v.elementType=u.elementType,v.type=u.type,v.stateNode=u.stateNode,v.alternate=u,u.alternate=v):(v.pendingProps=f,v.type=u.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=u.flags&31457280,v.childLanes=u.childLanes,v.lanes=u.lanes,v.child=u.child,v.memoizedProps=u.memoizedProps,v.memoizedState=u.memoizedState,v.updateQueue=u.updateQueue,f=u.dependencies,v.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},v.sibling=u.sibling,v.index=u.index,v.ref=u.ref,v.refCleanup=u.refCleanup,v}function Lu(u,f){u.flags&=31457282;var v=u.alternate;return v===null?(u.childLanes=0,u.lanes=f,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=v.childLanes,u.lanes=v.lanes,u.child=v.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=v.memoizedProps,u.memoizedState=v.memoizedState,u.updateQueue=v.updateQueue,u.type=v.type,f=v.dependencies,u.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),u}function wd(u,f,v,E,M,D){var G=0;if(E=u,typeof u=="function")gc(u)&&(G=1);else if(typeof u=="string")G=PY(u,v,cn.current)?26:u==="html"||u==="head"||u==="body"?27:5;else e:switch(u){case l:return Iu(v.children,M,D,f);case c:G=8,M|=24;break;case h:return u=ws(12,v,f,M|2),u.elementType=h,u.lanes=D,u;case _:return u=ws(13,v,f,M),u.elementType=_,u.lanes=D,u;case b:return u=ws(19,v,f,M),u.elementType=b,u.lanes=D,u;case w:return Jx(v,M,D,f);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case d:case y:G=10;break e;case m:G=9;break e;case x:G=11;break e;case A:G=14;break e;case T:G=16,E=null;break e}G=29,v=Error(n(130,u===null?"null":typeof u,"")),E=null}return f=ws(G,v,f,M),f.elementType=u,f.type=E,f.lanes=D,f}function Iu(u,f,v,E){return u=ws(7,u,E,f),u.lanes=v,u}function Jx(u,f,v,E){u=ws(22,u,E,f),u.elementType=w,u.lanes=v;var M={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var D=M._current;if(D===null)throw Error(n(456));if((M._pendingVisibility&2)===0){var G=Jl(D,2);G!==null&&(M._pendingVisibility|=2,Gs(G,D,2))}},attach:function(){var D=M._current;if(D===null)throw Error(n(456));if((M._pendingVisibility&2)!==0){var G=Jl(D,2);G!==null&&(M._pendingVisibility&=-3,Gs(G,D,2))}}};return u.stateNode=M,u}function Fs(u,f,v){return u=ws(6,u,null,f),u.lanes=v,u}function Ip(u,f,v){return f=ws(4,u.children!==null?u.children:[],u.key,f),f.lanes=v,f.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},f}function co(u){u.flags|=4}function Bu(u,f){if(f.type!=="stylesheet"||(f.state.loading&4)!==0)u.flags&=-16777217;else if(u.flags|=16777216,!RP(f)){if(f=ya.current,f!==null&&((un&4194176)===un?ll!==null:(un&62914560)!==un&&(un&536870912)===0||f!==ll))throw hd=Qg,_x;u.flags|=8192}}function uo(u,f){f!==null&&(u.flags|=4),u.flags&16384&&(f=u.tag!==22?_n():536870912,u.lanes|=f,vl|=f)}function Bp(u,f){if(!ni)switch(u.tailMode){case"hidden":f=u.tail;for(var v=null;f!==null;)f.alternate!==null&&(v=f),f=f.sibling;v===null?u.tail=null:v.sibling=null;break;case"collapsed":v=u.tail;for(var E=null;v!==null;)v.alternate!==null&&(E=v),v=v.sibling;E===null?f||u.tail===null?u.tail=null:u.tail.sibling=null:E.sibling=null}}function us(u){var f=u.alternate!==null&&u.alternate.child===u.child,v=0,E=0;if(f)for(var M=u.child;M!==null;)v|=M.lanes|M.childLanes,E|=M.subtreeFlags&31457280,E|=M.flags&31457280,M.return=u,M=M.sibling;else for(M=u.child;M!==null;)v|=M.lanes|M.childLanes,E|=M.subtreeFlags,E|=M.flags,M.return=u,M=M.sibling;return u.subtreeFlags|=E,u.childLanes=v,f}function qM(u,f,v){var E=f.pendingProps;switch(uu(f),f.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return us(f),null;case 1:return us(f),null;case 3:return v=f.stateNode,E=null,u!==null&&(E=u.memoizedState.cache),f.memoizedState.cache!==E&&(f.flags|=2048),uc(bs),Ve(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(u===null||u.child===null)&&(cd(f)?co(f):u===null||u.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,so!==null&&(mo(so),so=null))),us(f),null;case 26:return v=f.memoizedState,u===null?(co(f),v!==null?(us(f),Bu(f,v)):(us(f),f.flags&=-16777217)):v?v!==u.memoizedState?(co(f),us(f),Bu(f,v)):(us(f),f.flags&=-16777217):(u.memoizedProps!==E&&co(f),us(f),f.flags&=-16777217),null;case 27:$e(f),v=Ot.current;var M=f.type;if(u!==null&&f.stateNode!=null)u.memoizedProps!==E&&co(f);else{if(!E){if(f.stateNode===null)throw Error(n(166));return us(f),null}u=cn.current,cd(f)?_1(f):(u=AP(M,E,v),f.stateNode=u,co(f))}return us(f),null;case 5:if($e(f),v=f.type,u!==null&&f.stateNode!=null)u.memoizedProps!==E&&co(f);else{if(!E){if(f.stateNode===null)throw Error(n(166));return us(f),null}if(u=cn.current,cd(f))_1(f);else{switch(M=b_(Ot.current),u){case 1:u=M.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:u=M.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":u=M.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":u=M.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":u=M.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild);break;case"select":u=typeof E.is=="string"?M.createElement("select",{is:E.is}):M.createElement("select"),E.multiple?u.multiple=!0:E.size&&(u.size=E.size);break;default:u=typeof E.is=="string"?M.createElement(v,{is:E.is}):M.createElement(v)}}u[$i]=f,u[Ln]=E;e:for(M=f.child;M!==null;){if(M.tag===5||M.tag===6)u.appendChild(M.stateNode);else if(M.tag!==4&&M.tag!==27&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===f)break e;for(;M.sibling===null;){if(M.return===null||M.return===f)break e;M=M.return}M.sibling.return=M.return,M=M.sibling}f.stateNode=u;e:switch(na(u,v,E),v){case"button":case"input":case"select":case"textarea":u=!!E.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&co(f)}}return us(f),f.flags&=-16777217,null;case 6:if(u&&f.stateNode!=null)u.memoizedProps!==E&&co(f);else{if(typeof E!="string"&&f.stateNode===null)throw Error(n(166));if(u=Ot.current,cd(f)){if(u=f.stateNode,v=f.memoizedProps,E=null,M=Dr,M!==null)switch(M.tag){case 27:case 5:E=M.memoizedProps}u[$i]=f,u=!!(u.nodeValue===v||E!==null&&E.suppressHydrationWarning===!0||mP(u.nodeValue,v)),u||Ch(f)}else u=b_(u).createTextNode(E),u[$i]=f,f.stateNode=u}return us(f),null;case 13:if(E=f.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(M=cd(f),E!==null&&E.dehydrated!==null){if(u===null){if(!M)throw Error(n(318));if(M=f.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(n(317));M[$i]=f}else ud(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;us(f),M=!1}else so!==null&&(mo(so),so=null),M=!0;if(!M)return f.flags&256?(cl(f),f):(cl(f),null)}if(cl(f),(f.flags&128)!==0)return f.lanes=v,f;if(v=E!==null,u=u!==null&&u.memoizedState!==null,v){E=f.child,M=null,E.alternate!==null&&E.alternate.memoizedState!==null&&E.alternate.memoizedState.cachePool!==null&&(M=E.alternate.memoizedState.cachePool.pool);var D=null;E.memoizedState!==null&&E.memoizedState.cachePool!==null&&(D=E.memoizedState.cachePool.pool),D!==M&&(E.flags|=2048)}return v!==u&&v&&(f.child.flags|=8192),uo(f,f.updateQueue),us(f),null;case 4:return Ve(),u===null&&eC(f.stateNode.containerInfo),us(f),null;case 10:return uc(f.type),us(f),null;case 19:if(Mt(Ns),M=f.memoizedState,M===null)return us(f),null;if(E=(f.flags&128)!==0,D=M.rendering,D===null)if(E)Bp(M,!1);else{if(es!==0||u!==null&&(u.flags&128)!==0)for(u=f.child;u!==null;){if(D=fd(u),D!==null){for(f.flags|=128,Bp(M,!1),u=D.updateQueue,f.updateQueue=u,uo(f,u),f.subtreeFlags=0,u=v,v=f.child;v!==null;)Lu(v,u),v=v.sibling;return bt(Ns,Ns.current&1|2),f.child}u=u.sibling}M.tail!==null&&Fe()>jn&&(f.flags|=128,E=!0,Bp(M,!1),f.lanes=4194304)}else{if(!E)if(u=fd(D),u!==null){if(f.flags|=128,E=!0,u=u.updateQueue,f.updateQueue=u,uo(f,u),Bp(M,!0),M.tail===null&&M.tailMode==="hidden"&&!D.alternate&&!ni)return us(f),null}else 2*Fe()-M.renderingStartTime>jn&&v!==536870912&&(f.flags|=128,E=!0,Bp(M,!1),f.lanes=4194304);M.isBackwards?(D.sibling=f.child,f.child=D):(u=M.last,u!==null?u.sibling=D:f.child=D,M.last=D)}return M.tail!==null?(f=M.tail,M.rendering=f,M.tail=f.sibling,M.renderingStartTime=Fe(),f.sibling=null,u=Ns.current,bt(Ns,E?u&1|2:u&1),f):(us(f),null);case 22:case 23:return cl(f),Ap(),E=f.memoizedState!==null,u!==null?u.memoizedState!==null!==E&&(f.flags|=8192):E&&(f.flags|=8192),E?(v&536870912)!==0&&(f.flags&128)===0&&(us(f),f.subtreeFlags&6&&(f.flags|=8192)):us(f),v=f.updateQueue,v!==null&&uo(f,v.retryQueue),v=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),E=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(E=f.memoizedState.cachePool.pool),E!==v&&(f.flags|=2048),u!==null&&Mt(rc),null;case 24:return v=null,u!==null&&(v=u.memoizedState.cache),f.memoizedState.cache!==v&&(f.flags|=2048),uc(bs),us(f),null;case 25:return null}throw Error(n(156,f.tag))}function ys(u,f){switch(uu(f),f.tag){case 1:return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 3:return uc(bs),Ve(),u=f.flags,(u&65536)!==0&&(u&128)===0?(f.flags=u&-65537|128,f):null;case 26:case 27:case 5:return $e(f),null;case 13:if(cl(f),u=f.memoizedState,u!==null&&u.dehydrated!==null){if(f.alternate===null)throw Error(n(340));ud()}return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 19:return Mt(Ns),null;case 4:return Ve(),null;case 10:return uc(f.type),null;case 22:case 23:return cl(f),Ap(),u!==null&&Mt(rc),u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 24:return uc(bs),null;case 25:return null;default:return null}}function Zx(u,f){switch(uu(f),f.tag){case 3:uc(bs),Ve();break;case 26:case 27:case 5:$e(f);break;case 4:Ve();break;case 13:cl(f);break;case 19:Mt(Ns);break;case 10:uc(f.type);break;case 22:case 23:cl(f),Ap(),u!==null&&Mt(rc);break;case 24:uc(bs)}}var Gh={getCacheForType:function(u){var f=Lr(bs),v=f.data.get(u);return v===void 0&&(v=u(),f.data.set(u,v)),v}},yc=typeof WeakMap=="function"?WeakMap:Map,An=0,Ii=null,zn=null,un=0,ki=0,hi=null,Ms=!1,Nr=!1,Ou=!1,vc=0,es=0,zo=0,yl=0,Md=0,ea=0,vl=0,Op=null,Xn=null,Bi=!1,Un=0,jn=1/0,Ci=null,Hs=null,ho=!1,fo=null,zh=0,Vo=0,as=null,po=0,xc=null;function ta(){if((An&2)!==0&&un!==0)return un&-un;if(B.T!==null){var u=Lh;return u!==0?u:QM()}return to()}function Ga(){ea===0&&(ea=(un&536870912)===0||ni?gi():536870912);var u=ya.current;return u!==null&&(u.flags|=32),ea}function Gs(u,f,v){(u===Ii&&ki===2||u.cancelPendingCommit!==null)&&(bc(u,0),za(u,un,ea,!1)),cs(u,v),((An&2)===0||u!==Ii)&&(u===Ii&&((An&2)===0&&(yl|=v),es===4&&za(u,un,ea,!1)),Fi(u))}function Cd(u,f,v){if((An&6)!==0)throw Error(n(327));var E=!v&&(f&60)===0&&(f&u.expiredLanes)===0||$t(u,f),M=E?p(u,f):Yh(u,f,!0),D=E;do{if(M===0){Nr&&!E&&za(u,f,0,!1);break}else if(M===6)za(u,f,0,!Ms);else{if(v=u.current.alternate,D&&!eb(v)){M=Yh(u,f,!1),D=!1;continue}if(M===2){if(D=f,u.errorRecoveryDisabledLanes&D)var G=0;else G=u.pendingLanes&-536870913,G=G!==0?G:G&536870912?536870912:0;if(G!==0){f=G;e:{var Q=u;M=Op;var pe=Q.current.memoizedState.isDehydrated;if(pe&&(bc(Q,G).flags|=256),G=Yh(Q,G,!1),G!==2){if(Ou&&!pe){Q.errorRecoveryDisabledLanes|=D,yl|=D,M=4;break e}D=Xn,Xn=M,D!==null&&mo(D)}M=G}if(D=!1,M!==2)continue}}if(M===1){bc(u,0),za(u,f,0,!0);break}e:{switch(E=u,M){case 0:case 1:throw Error(n(345));case 4:if((f&4194176)===f){za(E,f,ea,!Ms);break e}break;case 2:Xn=null;break;case 3:case 5:break;default:throw Error(n(329))}if(E.finishedWork=v,E.finishedLanes=f,(f&62914560)===f&&(D=Un+300-Fe(),10<D)){if(za(E,f,ea,!Ms),Bt(E,0)!==0)break e;E.timeoutHandle=vP(b2.bind(null,E,v,Xn,Ci,Bi,f,ea,yl,vl,Ms,2,-0,0),D);break e}b2(E,v,Xn,Ci,Bi,f,ea,yl,vl,Ms,0,-0,0)}}break}while(!0);Fi(u)}function mo(u){Xn===null?Xn=u:Xn.push.apply(Xn,u)}function b2(u,f,v,E,M,D,G,Q,pe,Te,ct,xt,Ye){var at=f.subtreeFlags;if((at&8192||(at&16785408)===16785408)&&(ab={stylesheets:null,count:0,unsuspend:NY},Hh(f),f=kY(),f!==null)){u.cancelPendingCommit=f(ye.bind(null,u,v,E,M,G,Q,pe,1,xt,Ye)),za(u,D,G,!Te);return}ye(u,v,E,M,G,Q,pe,ct,xt,Ye)}function eb(u){for(var f=u;;){var v=f.tag;if((v===0||v===11||v===15)&&f.flags&16384&&(v=f.updateQueue,v!==null&&(v=v.stores,v!==null)))for(var E=0;E<v.length;E++){var M=v[E],D=M.getSnapshot;M=M.value;try{if(!da(D(),M))return!1}catch{return!1}}if(v=f.child,f.subtreeFlags&16384&&v!==null)v.return=f,f=v;else{if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function za(u,f,v,E){f&=~Md,f&=~yl,u.suspendedLanes|=f,u.pingedLanes&=~f,E&&(u.warmLanes|=f),E=u.expirationTimes;for(var M=f;0<M;){var D=31-He(M),G=1<<D;E[D]=-1,M&=~G}v!==0&&Vl(u,v,f)}function Vh(){return(An&6)===0?(qn(0),!1):!0}function xl(){if(zn!==null){if(ki===0)var u=zn.return;else u=zn,No=dl=null,e2(u),du=null,vp=0,u=zn;for(;u!==null;)Zx(u.alternate,u),u=u.return;zn=null}}function bc(u,f){u.finishedWork=null,u.finishedLanes=0;var v=u.timeoutHandle;v!==-1&&(u.timeoutHandle=-1,bY(v)),v=u.cancelPendingCommit,v!==null&&(u.cancelPendingCommit=null,v()),xl(),Ii=u,zn=v=Zr(u.current,null),un=f,ki=0,hi=null,Ms=!1,Nr=$t(u,f),Ou=!1,vl=ea=Md=yl=zo=es=0,Xn=Op=null,Bi=!1,(f&8)!==0&&(f|=f&32);var E=u.entangledLanes;if(E!==0)for(u=u.entanglements,E&=f;0<E;){var M=31-He(E),D=1<<M;f|=u[M],E&=~D}return vc=f,up(),v}function Pu(u,f){Nn=null,B.H=fl,f===hu?(f=Ei(),ki=3):f===_x?(f=Ei(),ki=4):ki=f===Ua?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,hi=f,zn===null&&(es=1,c2(u,ga(f,u.current)))}function Rd(){var u=B.H;return B.H=fl,u===null?fl:u}function A2(){var u=B.A;return B.A=Gh,u}function Pp(){es=4,Ms||(un&4194176)!==un&&ya.current!==null||(Nr=!0),(zo&134217727)===0&&(yl&134217727)===0||Ii===null||za(Ii,un,ea,!1)}function Yh(u,f,v){var E=An;An|=2;var M=Rd(),D=A2();(Ii!==u||un!==f)&&(Ci=null,bc(u,f)),f=!1;var G=es;e:do try{if(ki!==0&&zn!==null){var Q=zn,pe=hi;switch(ki){case 8:xl(),G=6;break e;case 3:case 2:case 6:ya.current===null&&(f=!0);var Te=ki;if(ki=0,hi=null,I(u,Q,pe,Te),v&&Nr){G=0;break e}break;default:Te=ki,ki=0,hi=null,I(u,Q,pe,Te)}}tb(),G=es;break}catch(ct){Pu(u,ct)}while(!0);return f&&u.shellSuspendCounter++,No=dl=null,An=E,B.H=M,B.A=D,zn===null&&(Ii=null,un=0,up()),G}function tb(){for(;zn!==null;)S(zn)}function p(u,f){var v=An;An|=2;var E=Rd(),M=A2();Ii!==u||un!==f?(Ci=null,jn=Fe()+500,bc(u,f)):Nr=$t(u,f);e:do try{if(ki!==0&&zn!==null){f=zn;var D=hi;t:switch(ki){case 1:ki=0,hi=null,I(u,f,D,1);break;case 2:if(T1(D)){ki=0,hi=null,C(f);break}f=function(){ki===2&&Ii===u&&(ki=7),Fi(u)},D.then(f,f);break e;case 3:ki=7;break e;case 4:ki=5;break e;case 7:T1(D)?(ki=0,hi=null,C(f)):(ki=0,hi=null,I(u,f,D,7));break;case 5:var G=null;switch(zn.tag){case 26:G=zn.memoizedState;case 5:case 27:var Q=zn;if(!G||RP(G)){ki=0,hi=null;var pe=Q.sibling;if(pe!==null)zn=pe;else{var Te=Q.return;Te!==null?(zn=Te,k(Te)):zn=null}break t}}ki=0,hi=null,I(u,f,D,5);break;case 6:ki=0,hi=null,I(u,f,D,6);break;case 8:xl(),es=6;break e;default:throw Error(n(462))}}g();break}catch(ct){Pu(u,ct)}while(!0);return No=dl=null,B.H=E,B.A=M,An=v,zn!==null?0:(Ii=null,un=0,up(),es)}function g(){for(;zn!==null&&!X();)S(zn)}function S(u){var f=wp(u.alternate,u,vc);u.memoizedProps=u.pendingProps,f===null?k(u):zn=f}function C(u){var f=u,v=f.alternate;switch(f.tag){case 15:case 0:f=h_(v,f,f.pendingProps,f.type,void 0,un);break;case 11:f=h_(v,f,f.pendingProps,f.type.render,f.ref,un);break;case 5:e2(f);default:Zx(v,f),f=zn=Lu(f,vc),f=wp(v,f,vc)}u.memoizedProps=u.pendingProps,f===null?k(u):zn=f}function I(u,f,v,E){No=dl=null,e2(f),du=null,vp=0;var M=f.return;try{if(XM(u,M,f,v,un)){es=1,c2(u,ga(v,u.current)),zn=null;return}}catch(D){if(M!==null)throw zn=M,D;es=1,c2(u,ga(v,u.current)),zn=null;return}f.flags&32768?(ni||E===1?u=!0:Nr||(un&536870912)!==0?u=!1:(Ms=u=!0,(E===2||E===3||E===6)&&(E=ya.current,E!==null&&E.tag===13&&(E.flags|=16384))),$(f,u)):k(f)}function k(u){var f=u;do{if((f.flags&32768)!==0){$(f,Ms);return}u=f.return;var v=qM(f.alternate,f,vc);if(v!==null){zn=v;return}if(f=f.sibling,f!==null){zn=f;return}zn=f=u}while(f!==null);es===0&&(es=5)}function $(u,f){do{var v=ys(u.alternate,u);if(v!==null){v.flags&=32767,zn=v;return}if(v=u.return,v!==null&&(v.flags|=32768,v.subtreeFlags=0,v.deletions=null),!f&&(u=u.sibling,u!==null)){zn=u;return}zn=u=v}while(u!==null);es=6,zn=null}function ye(u,f,v,E,M,D,G,Q,pe,Te){var ct=B.T,xt=le.p;try{le.p=2,B.T=null,Ie(u,f,v,E,xt,M,D,G,Q,pe,Te)}finally{B.T=ct,le.p=xt}}function Ie(u,f,v,E,M,D,G,Q){do Lt();while(fo!==null);if((An&6)!==0)throw Error(n(327));var pe=u.finishedWork;if(E=u.finishedLanes,pe===null)return null;if(u.finishedWork=null,u.finishedLanes=0,pe===u.current)throw Error(n(177));u.callbackNode=null,u.callbackPriority=0,u.cancelPendingCommit=null;var Te=pe.lanes|pe.childLanes;if(Te|=$l,xh(u,E,Te,D,G,Q),u===Ii&&(zn=Ii=null,un=0),(pe.subtreeFlags&10256)===0&&(pe.flags&10256)===0||ho||(ho=!0,Vo=Te,as=v,De(et,function(){return Lt(),null})),v=(pe.flags&15990)!==0,(pe.subtreeFlags&15990)!==0||v?(v=B.T,B.T=null,D=le.p,le.p=2,G=An,An|=4,_d(u,pe),Fh(pe,u),yx(sC,u.containerInfo),w_=!!iC,sC=iC=null,u.current=pe,Sd(u,pe.alternate,pe),we(),An=G,le.p=D,B.T=v):u.current=pe,ho?(ho=!1,fo=u,zh=E):lt(u,Te),Te=u.pendingLanes,Te===0&&(Hs=null),Nt(pe.stateNode),Fi(u),f!==null)for(M=u.onRecoverableError,pe=0;pe<f.length;pe++)Te=f[pe],M(Te.value,{componentStack:Te.stack});return(zh&3)!==0&&Lt(),Te=u.pendingLanes,(E&4194218)!==0&&(Te&42)!==0?u===xc?po++:(po=0,xc=u):po=0,qn(0),null}function lt(u,f){(u.pooledCacheLanes&=f)===0&&(f=u.pooledCache,f!=null&&(u.pooledCache=null,mu(f)))}function Lt(){if(fo!==null){var u=fo,f=Vo;Vo=0;var v=Wr(zh),E=B.T,M=le.p;try{if(le.p=32>v?32:v,B.T=null,fo===null)var D=!1;else{v=as,as=null;var G=fo,Q=zh;if(fo=null,zh=0,(An&6)!==0)throw Error(n(331));var pe=An;if(An|=4,Td(G.current),dc(G,G.current,Q,v),An=pe,qn(0,!1),Dt&&typeof Dt.onPostCommitFiberRoot=="function")try{Dt.onPostCommitFiberRoot(Et,G)}catch{}D=!0}return D}finally{le.p=M,B.T=E,lt(u,f)}}return!1}function Gt(u,f,v){f=ga(v,f),f=Fx(u.stateNode,f,2),u=Ha(u,f,2),u!==null&&(cs(u,2),Fi(u))}function Tt(u,f,v){if(u.tag===3)Gt(u,u,v);else for(;f!==null;){if(f.tag===3){Gt(f,u,v);break}else if(f.tag===1){var E=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(Hs===null||!Hs.has(E))){u=ga(v,u),v=Hx(2),E=Ha(f,v,2),E!==null&&(c_(v,E,f,u),cs(E,2),Fi(E));break}}f=f.return}}function En(u,f,v){var E=u.pingCache;if(E===null){E=u.pingCache=new yc;var M=new Set;E.set(f,M)}else M=E.get(f),M===void 0&&(M=new Set,E.set(f,M));M.has(v)||(Ou=!0,M.add(v),u=go.bind(null,u,f,v),f.then(u,u))}function go(u,f,v){var E=u.pingCache;E!==null&&E.delete(f),u.pingedLanes|=u.suspendedLanes&v,u.warmLanes&=~v,Ii===u&&(un&v)===v&&(es===4||es===3&&(un&62914560)===un&&300>Fe()-Un?(An&2)===0&&bc(u,0):Md|=v,vl===un&&(vl=0)),Fi(u)}function Dd(u,f){f===0&&(f=_n()),u=Jl(u,f),u!==null&&(cs(u,f),Fi(u))}function Kh(u){var f=u.memoizedState,v=0;f!==null&&(v=f.retryLane),Dd(u,v)}function ke(u,f){var v=0;switch(u.tag){case 13:var E=u.stateNode,M=u.memoizedState;M!==null&&(v=M.retryLane);break;case 19:E=u.stateNode;break;case 22:E=u.stateNode._retryCache;break;default:throw Error(n(314))}E!==null&&E.delete(f),Dd(u,v)}function De(u,f){return nt(u,f)}var Ke=null,_t=null,rn=!1,Oi=!1,gn=!1,Vn=0;function Fi(u){u!==_t&&u.next===null&&(_t===null?Ke=_t=u:_t=_t.next=u),Oi=!0,rn||(rn=!0,hY(Nu))}function qn(u,f){if(!gn&&Oi){gn=!0;do for(var v=!1,E=Ke;E!==null;){if(u!==0){var M=E.pendingLanes;if(M===0)var D=0;else{var G=E.suspendedLanes,Q=E.pingedLanes;D=(1<<31-He(42|u)+1)-1,D&=M&~(G&~Q),D=D&201326677?D&201326677|1:D?D|2:0}D!==0&&(v=!0,lP(E,D))}else D=un,D=Bt(E,E===Ii?D:0),(D&3)===0||$t(E,D)||(v=!0,lP(E,D));E=E.next}while(v);gn=!1}}function Nu(){Oi=rn=!1;var u=0;Vn!==0&&(xY()&&(u=Vn),Vn=0);for(var f=Fe(),v=null,E=Ke;E!==null;){var M=E.next,D=g_(E,f);D===0?(E.next=null,v===null?Ke=M:v.next=M,M===null&&(_t=v)):(v=E,(u!==0||(D&3)!==0)&&(Oi=!0)),E=M}qn(u)}function g_(u,f){for(var v=u.suspendedLanes,E=u.pingedLanes,M=u.expirationTimes,D=u.pendingLanes&-62914561;0<D;){var G=31-He(D),Q=1<<G,pe=M[G];pe===-1?((Q&v)===0||(Q&E)!==0)&&(M[G]=Pn(Q,f)):pe<=f&&(u.expiredLanes|=Q),D&=~Q}if(f=Ii,v=un,v=Bt(u,u===f?v:0),E=u.callbackNode,v===0||u===f&&ki===2||u.cancelPendingCommit!==null)return E!==null&&E!==null&&ee(E),u.callbackNode=null,u.callbackPriority=0;if((v&3)===0||$t(u,v)){if(f=v&-v,f===u.callbackPriority)return f;switch(E!==null&&ee(E),Wr(v)){case 2:case 8:v=ot;break;case 32:v=et;break;case 268435456:v=vt;break;default:v=et}return E=oP.bind(null,u),v=nt(v,E),u.callbackPriority=f,u.callbackNode=v,f}return E!==null&&E!==null&&ee(E),u.callbackPriority=2,u.callbackNode=null,2}function oP(u,f){var v=u.callbackNode;if(Lt()&&u.callbackNode!==v)return null;var E=un;return E=Bt(u,u===Ii?E:0),E===0?null:(Cd(u,E,f),g_(u,Fe()),u.callbackNode!=null&&u.callbackNode===v?oP.bind(null,u):null)}function lP(u,f){if(Lt())return null;Cd(u,f,!0)}function hY(u){AY(function(){(An&6)!==0?nt(We,u):u()})}function QM(){return Vn===0&&(Vn=gi()),Vn}function cP(u){return u==null||typeof u=="symbol"||typeof u=="boolean"?null:typeof u=="function"?u:Q0(""+u)}function uP(u,f){var v=f.ownerDocument.createElement("input");return v.name=f.name,v.value=f.value,u.id&&v.setAttribute("form",u.id),f.parentNode.insertBefore(v,f),u=new FormData(u),v.parentNode.removeChild(v),u}function fY(u,f,v,E,M){if(f==="submit"&&v&&v.stateNode===M){var D=cP((M[Ln]||null).action),G=E.submitter;G&&(f=(f=G[Ln]||null)?cP(f.formAction):G.getAttribute("formAction"),f!==null&&(D=f,G=null));var Q=new Zf("action","action",null,E,M);u.push({event:Q,listeners:[{instance:null,listener:function(){if(E.defaultPrevented){if(Vn!==0){var pe=G?uP(M,G):new FormData(M);Ox(v,{pending:!0,data:pe,method:M.method,action:D},null,pe)}}else typeof D=="function"&&(Q.preventDefault(),pe=G?uP(M,G):new FormData(M),Ox(v,{pending:!0,data:pe,method:M.method,action:D},D,pe))},currentTarget:M}]})}}for(var $M=0;$M<Ql.length;$M++){var JM=Ql[$M],dY=JM.toLowerCase(),pY=JM[0].toUpperCase()+JM.slice(1);io(dY,"on"+pY)}io(bx,"onAnimationEnd"),io(ma,"onAnimationIteration"),io(Ax,"onAnimationStart"),io("dblclick","onDoubleClick"),io("focusin","onFocus"),io("focusout","onBlur"),io(ql,"onTransitionRun"),io(ld,"onTransitionStart"),io(ou,"onTransitionCancel"),io(Xg,"onTransitionEnd"),ft("onMouseEnter",["mouseout","mouseover"]),ft("onMouseLeave",["mouseout","mouseover"]),ft("onPointerEnter",["pointerout","pointerover"]),ft("onPointerLeave",["pointerout","pointerover"]),qe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),qe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),qe("onBeforeInput",["compositionend","keypress","textInput","paste"]),qe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),qe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),qe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nb="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mY=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(nb));function hP(u,f){f=(f&4)!==0;for(var v=0;v<u.length;v++){var E=u[v],M=E.event;E=E.listeners;e:{var D=void 0;if(f)for(var G=E.length-1;0<=G;G--){var Q=E[G],pe=Q.instance,Te=Q.currentTarget;if(Q=Q.listener,pe!==D&&M.isPropagationStopped())break e;D=Q,M.currentTarget=Te;try{D(M)}catch(ct){l2(ct)}M.currentTarget=null,D=pe}else for(G=0;G<E.length;G++){if(Q=E[G],pe=Q.instance,Te=Q.currentTarget,Q=Q.listener,pe!==D&&M.isPropagationStopped())break e;D=Q,M.currentTarget=Te;try{D(M)}catch(ct){l2(ct)}M.currentTarget=null,D=pe}}}}function si(u,f){var v=f[Z];v===void 0&&(v=f[Z]=new Set);var E=u+"__bubble";v.has(E)||(fP(f,u,2,!1),v.add(E))}function ZM(u,f,v){var E=0;f&&(E|=4),fP(v,u,E,f)}var y_="_reactListening"+Math.random().toString(36).slice(2);function eC(u){if(!u[y_]){u[y_]=!0,Ae.forEach(function(v){v!=="selectionchange"&&(mY.has(v)||ZM(v,!1,u),ZM(v,!0,u))});var f=u.nodeType===9?u:u.ownerDocument;f===null||f[y_]||(f[y_]=!0,ZM("selectionchange",!1,f))}}function fP(u,f,v,E){switch(PP(f)){case 2:var M=GY;break;case 8:M=zY;break;default:M=dC}v=M.bind(null,f,v,u),M=void 0,!J0||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(M=!0),E?M!==void 0?u.addEventListener(f,v,{capture:!0,passive:M}):u.addEventListener(f,v,!0):M!==void 0?u.addEventListener(f,v,{passive:M}):u.addEventListener(f,v,!1)}function tC(u,f,v,E,M){var D=E;if((f&1)===0&&(f&2)===0&&E!==null)e:for(;;){if(E===null)return;var G=E.tag;if(G===3||G===4){var Q=E.stateNode.containerInfo;if(Q===M||Q.nodeType===8&&Q.parentNode===M)break;if(G===4)for(G=E.return;G!==null;){var pe=G.tag;if((pe===3||pe===4)&&(pe=G.stateNode.containerInfo,pe===M||pe.nodeType===8&&pe.parentNode===M))return;G=G.return}for(;Q!==null;){if(G=gt(Q),G===null)return;if(pe=G.tag,pe===5||pe===6||pe===26||pe===27){E=D=G;continue e}Q=Q.parentNode}}E=E.return}nx(function(){var Te=D,ct=$0(v),xt=[];e:{var Ye=jg.get(u);if(Ye!==void 0){var at=Zf,an=u;switch(u){case"keypress":if(tu(v)===0)break e;case"keydown":case"keyup":at=ox;break;case"focusin":an="focus",at=Ug;break;case"focusout":an="blur",at=Ug;break;case"beforeblur":case"afterblur":at=Ug;break;case"click":if(v.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":at=rx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":at=UM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":at=cx;break;case bx:case ma:case Ax:at=c1;break;case Xg:at=Wl;break;case"scroll":case"scrollend":at=a1;break;case"wheel":at=kM;break;case"copy":case"cut":case"paste":at=h1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":at=Fg;break;case"toggle":case"beforetoggle":at=iu}var Mn=(f&4)!==0,zs=!Mn&&(u==="scroll"||u==="scrollend"),Le=Mn?Ye!==null?Ye+"Capture":null:Ye;Mn=[];for(var _e=Te,Ue;_e!==null;){var mt=_e;if(Ue=mt.stateNode,mt=mt.tag,mt!==5&&mt!==26&&mt!==27||Ue===null||Le===null||(mt=Qf(_e,Le),mt!=null&&Mn.push(ib(_e,mt,Ue))),zs)break;_e=_e.return}0<Mn.length&&(Ye=new at(Ye,an,null,v,ct),xt.push({event:Ye,listeners:Mn}))}}if((f&7)===0){e:{if(Ye=u==="mouseover"||u==="pointerover",at=u==="mouseout"||u==="pointerout",Ye&&v!==Bg&&(an=v.relatedTarget||v.fromElement)&&(gt(an)||an[V]))break e;if((at||Ye)&&(Ye=ct.window===ct?ct:(Ye=ct.ownerDocument)?Ye.defaultView||Ye.parentWindow:window,at?(an=v.relatedTarget||v.toElement,at=Te,an=an?gt(an):null,an!==null&&(zs=ie(an),Mn=an.tag,an!==zs||Mn!==5&&Mn!==27&&Mn!==6)&&(an=null)):(at=null,an=Te),at!==an)){if(Mn=rx,mt="onMouseLeave",Le="onMouseEnter",_e="mouse",(u==="pointerout"||u==="pointerover")&&(Mn=Fg,mt="onPointerLeave",Le="onPointerEnter",_e="pointer"),zs=at==null?Ye:oe(at),Ue=an==null?Ye:oe(an),Ye=new Mn(mt,_e+"leave",at,v,ct),Ye.target=zs,Ye.relatedTarget=Ue,mt=null,gt(ct)===Te&&(Mn=new Mn(Le,_e+"enter",an,v,ct),Mn.target=Ue,Mn.relatedTarget=zs,mt=Mn),zs=mt,at&&an)t:{for(Mn=at,Le=an,_e=0,Ue=Mn;Ue;Ue=E2(Ue))_e++;for(Ue=0,mt=Le;mt;mt=E2(mt))Ue++;for(;0<_e-Ue;)Mn=E2(Mn),_e--;for(;0<Ue-_e;)Le=E2(Le),Ue--;for(;_e--;){if(Mn===Le||Le!==null&&Mn===Le.alternate)break t;Mn=E2(Mn),Le=E2(Le)}Mn=null}else Mn=null;at!==null&&dP(xt,Ye,at,Mn,!1),an!==null&&zs!==null&&dP(xt,zs,an,Mn,!0)}}e:{if(Ye=Te?oe(Te):window,at=Ye.nodeName&&Ye.nodeName.toLowerCase(),at==="select"||at==="input"&&Ye.type==="file")var qt=Gg;else if(dx(Ye))if(zg)qt=au;else{qt=A1;var Qn=FM}else at=Ye.nodeName,!at||at.toLowerCase()!=="input"||Ye.type!=="checkbox"&&Ye.type!=="radio"?Te&&q0(Te.elementType)&&(qt=Gg):qt=lp;if(qt&&(qt=qt(u,Te))){fa(xt,qt,v,ct);break e}Qn&&Qn(u,Ye,Te),u==="focusout"&&Te&&Ye.type==="number"&&Te.memoizedProps.value!=null&&yi(Ye,"number",Ye.value)}switch(Qn=Te?oe(Te):window,u){case"focusin":(dx(Qn)||Qn.contentEditable==="true")&&(Sh=Qn,vx=Te,od=null);break;case"focusout":od=vx=Sh=null;break;case"mousedown":Kg=!0;break;case"contextmenu":case"mouseup":case"dragend":Kg=!1,no(xt,v,ct);break;case"selectionchange":if(Yg)break;case"keydown":case"keyup":no(xt,v,ct)}var on;if(np)e:{switch(u){case"compositionstart":var xn="onCompositionStart";break e;case"compositionend":xn="onCompositionEnd";break e;case"compositionupdate":xn="onCompositionUpdate";break e}xn=void 0}else ru?rp(u,v)&&(xn="onCompositionEnd"):u==="keydown"&&v.keyCode===229&&(xn="onCompositionStart");xn&&(sp&&v.locale!=="ko"&&(ru||xn!=="onCompositionStart"?xn==="onCompositionEnd"&&ru&&(on=sx()):(Yl=ct,ix="value"in Yl?Yl.value:Yl.textContent,ru=!0)),Qn=v_(Te,xn),0<Qn.length&&(xn=new kg(xn,u,null,v,ct),xt.push({event:xn,listeners:Qn}),on?xn.data=on:(on=hx(v),on!==null&&(xn.data=on)))),(on=ip?ap(u,v):fx(u,v))&&(xn=v_(Te,"onBeforeInput"),0<xn.length&&(Qn=new kg("onBeforeInput","beforeinput",null,v,ct),xt.push({event:Qn,listeners:xn}),Qn.data=on)),fY(xt,u,Te,v,ct)}hP(xt,f)})}function ib(u,f,v){return{instance:u,listener:f,currentTarget:v}}function v_(u,f){for(var v=f+"Capture",E=[];u!==null;){var M=u,D=M.stateNode;M=M.tag,M!==5&&M!==26&&M!==27||D===null||(M=Qf(u,v),M!=null&&E.unshift(ib(u,M,D)),M=Qf(u,f),M!=null&&E.push(ib(u,M,D))),u=u.return}return E}function E2(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5&&u.tag!==27);return u||null}function dP(u,f,v,E,M){for(var D=f._reactName,G=[];v!==null&&v!==E;){var Q=v,pe=Q.alternate,Te=Q.stateNode;if(Q=Q.tag,pe!==null&&pe===E)break;Q!==5&&Q!==26&&Q!==27||Te===null||(pe=Te,M?(Te=Qf(v,D),Te!=null&&G.unshift(ib(v,Te,pe))):M||(Te=Qf(v,D),Te!=null&&G.push(ib(v,Te,pe)))),v=v.return}G.length!==0&&u.push({event:f,listeners:G})}var gY=/\r\n?/g,yY=/\u0000|\uFFFD/g;function pP(u){return(typeof u=="string"?u:""+u).replace(gY,`
`).replace(yY,"")}function mP(u,f){return f=pP(f),pP(u)===f}function x_(){}function ji(u,f,v,E,M,D){switch(v){case"children":typeof E=="string"?f==="body"||f==="textarea"&&E===""||Xr(u,E):(typeof E=="number"||typeof E=="bigint")&&f!=="body"&&Xr(u,""+E);break;case"className":Kn(u,"class",E);break;case"tabIndex":Kn(u,"tabindex",E);break;case"dir":case"role":case"viewBox":case"width":case"height":Kn(u,v,E);break;case"style":tx(u,E,D);break;case"data":if(f!=="object"){Kn(u,"data",E);break}case"src":case"href":if(E===""&&(f!=="a"||v!=="href")){u.removeAttribute(v);break}if(E==null||typeof E=="function"||typeof E=="symbol"||typeof E=="boolean"){u.removeAttribute(v);break}E=Q0(""+E),u.setAttribute(v,E);break;case"action":case"formAction":if(typeof E=="function"){u.setAttribute(v,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(v==="formAction"?(f!=="input"&&ji(u,f,"name",M.name,M,null),ji(u,f,"formEncType",M.formEncType,M,null),ji(u,f,"formMethod",M.formMethod,M,null),ji(u,f,"formTarget",M.formTarget,M,null)):(ji(u,f,"encType",M.encType,M,null),ji(u,f,"method",M.method,M,null),ji(u,f,"target",M.target,M,null)));if(E==null||typeof E=="symbol"||typeof E=="boolean"){u.removeAttribute(v);break}E=Q0(""+E),u.setAttribute(v,E);break;case"onClick":E!=null&&(u.onclick=x_);break;case"onScroll":E!=null&&si("scroll",u);break;case"onScrollEnd":E!=null&&si("scrollend",u);break;case"dangerouslySetInnerHTML":if(E!=null){if(typeof E!="object"||!("__html"in E))throw Error(n(61));if(v=E.__html,v!=null){if(M.children!=null)throw Error(n(60));u.innerHTML=v}}break;case"multiple":u.multiple=E&&typeof E!="function"&&typeof E!="symbol";break;case"muted":u.muted=E&&typeof E!="function"&&typeof E!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(E==null||typeof E=="function"||typeof E=="boolean"||typeof E=="symbol"){u.removeAttribute("xlink:href");break}v=Q0(""+E),u.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",v);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":E!=null&&typeof E!="function"&&typeof E!="symbol"?u.setAttribute(v,""+E):u.removeAttribute(v);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":E&&typeof E!="function"&&typeof E!="symbol"?u.setAttribute(v,""):u.removeAttribute(v);break;case"capture":case"download":E===!0?u.setAttribute(v,""):E!==!1&&E!=null&&typeof E!="function"&&typeof E!="symbol"?u.setAttribute(v,E):u.removeAttribute(v);break;case"cols":case"rows":case"size":case"span":E!=null&&typeof E!="function"&&typeof E!="symbol"&&!isNaN(E)&&1<=E?u.setAttribute(v,E):u.removeAttribute(v);break;case"rowSpan":case"start":E==null||typeof E=="function"||typeof E=="symbol"||isNaN(E)?u.removeAttribute(v):u.setAttribute(v,E);break;case"popover":si("beforetoggle",u),si("toggle",u),jt(u,"popover",E);break;case"xlinkActuate":Jt(u,"http://www.w3.org/1999/xlink","xlink:actuate",E);break;case"xlinkArcrole":Jt(u,"http://www.w3.org/1999/xlink","xlink:arcrole",E);break;case"xlinkRole":Jt(u,"http://www.w3.org/1999/xlink","xlink:role",E);break;case"xlinkShow":Jt(u,"http://www.w3.org/1999/xlink","xlink:show",E);break;case"xlinkTitle":Jt(u,"http://www.w3.org/1999/xlink","xlink:title",E);break;case"xlinkType":Jt(u,"http://www.w3.org/1999/xlink","xlink:type",E);break;case"xmlBase":Jt(u,"http://www.w3.org/XML/1998/namespace","xml:base",E);break;case"xmlLang":Jt(u,"http://www.w3.org/XML/1998/namespace","xml:lang",E);break;case"xmlSpace":Jt(u,"http://www.w3.org/XML/1998/namespace","xml:space",E);break;case"is":jt(u,"is",E);break;case"innerText":case"textContent":break;default:(!(2<v.length)||v[0]!=="o"&&v[0]!=="O"||v[1]!=="n"&&v[1]!=="N")&&(v=s1.get(v)||v,jt(u,v,E))}}function nC(u,f,v,E,M,D){switch(v){case"style":tx(u,E,D);break;case"dangerouslySetInnerHTML":if(E!=null){if(typeof E!="object"||!("__html"in E))throw Error(n(61));if(v=E.__html,v!=null){if(M.children!=null)throw Error(n(60));u.innerHTML=v}}break;case"children":typeof E=="string"?Xr(u,E):(typeof E=="number"||typeof E=="bigint")&&Xr(u,""+E);break;case"onScroll":E!=null&&si("scroll",u);break;case"onScrollEnd":E!=null&&si("scrollend",u);break;case"onClick":E!=null&&(u.onclick=x_);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ne.hasOwnProperty(v))e:{if(v[0]==="o"&&v[1]==="n"&&(M=v.endsWith("Capture"),f=v.slice(2,M?v.length-7:void 0),D=u[Ln]||null,D=D!=null?D[v]:null,typeof D=="function"&&u.removeEventListener(f,D,M),typeof E=="function")){typeof D!="function"&&D!==null&&(v in u?u[v]=null:u.hasAttribute(v)&&u.removeAttribute(v)),u.addEventListener(f,E,M);break e}v in u?u[v]=E:E===!0?u.setAttribute(v,""):jt(u,v,E)}}}function na(u,f,v){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":si("error",u),si("load",u);var E=!1,M=!1,D;for(D in v)if(v.hasOwnProperty(D)){var G=v[D];if(G!=null)switch(D){case"src":E=!0;break;case"srcSet":M=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,f));default:ji(u,f,D,G,v,null)}}M&&ji(u,f,"srcSet",v.srcSet,v,null),E&&ji(u,f,"src",v.src,v,null);return;case"input":si("invalid",u);var Q=D=G=M=null,pe=null,Te=null;for(E in v)if(v.hasOwnProperty(E)){var ct=v[E];if(ct!=null)switch(E){case"name":M=ct;break;case"type":G=ct;break;case"checked":pe=ct;break;case"defaultChecked":Te=ct;break;case"value":D=ct;break;case"defaultValue":Q=ct;break;case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(n(137,f));break;default:ji(u,f,E,ct,v,null)}}ns(u,D,Q,pe,Te,G,M,!1),pn(u);return;case"select":si("invalid",u),E=G=D=null;for(M in v)if(v.hasOwnProperty(M)&&(Q=v[M],Q!=null))switch(M){case"value":D=Q;break;case"defaultValue":G=Q;break;case"multiple":E=Q;default:ji(u,f,M,Q,v,null)}f=D,v=G,u.multiple=!!E,f!=null?vi(u,!!E,f,!1):v!=null&&vi(u,!!E,v,!0);return;case"textarea":si("invalid",u),D=M=E=null;for(G in v)if(v.hasOwnProperty(G)&&(Q=v[G],Q!=null))switch(G){case"value":E=Q;break;case"defaultValue":M=Q;break;case"children":D=Q;break;case"dangerouslySetInnerHTML":if(Q!=null)throw Error(n(91));break;default:ji(u,f,G,Q,v,null)}Io(u,E,M,D),pn(u);return;case"option":for(pe in v)if(v.hasOwnProperty(pe)&&(E=v[pe],E!=null))switch(pe){case"selected":u.selected=E&&typeof E!="function"&&typeof E!="symbol";break;default:ji(u,f,pe,E,v,null)}return;case"dialog":si("cancel",u),si("close",u);break;case"iframe":case"object":si("load",u);break;case"video":case"audio":for(E=0;E<nb.length;E++)si(nb[E],u);break;case"image":si("error",u),si("load",u);break;case"details":si("toggle",u);break;case"embed":case"source":case"link":si("error",u),si("load",u);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Te in v)if(v.hasOwnProperty(Te)&&(E=v[Te],E!=null))switch(Te){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,f));default:ji(u,f,Te,E,v,null)}return;default:if(q0(f)){for(ct in v)v.hasOwnProperty(ct)&&(E=v[ct],E!==void 0&&nC(u,f,ct,E,v,void 0));return}}for(Q in v)v.hasOwnProperty(Q)&&(E=v[Q],E!=null&&ji(u,f,Q,E,v,null))}function vY(u,f,v,E){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var M=null,D=null,G=null,Q=null,pe=null,Te=null,ct=null;for(at in v){var xt=v[at];if(v.hasOwnProperty(at)&&xt!=null)switch(at){case"checked":break;case"value":break;case"defaultValue":pe=xt;default:E.hasOwnProperty(at)||ji(u,f,at,null,E,xt)}}for(var Ye in E){var at=E[Ye];if(xt=v[Ye],E.hasOwnProperty(Ye)&&(at!=null||xt!=null))switch(Ye){case"type":D=at;break;case"name":M=at;break;case"checked":Te=at;break;case"defaultChecked":ct=at;break;case"value":G=at;break;case"defaultValue":Q=at;break;case"children":case"dangerouslySetInnerHTML":if(at!=null)throw Error(n(137,f));break;default:at!==xt&&ji(u,f,Ye,at,E,xt)}}wn(u,G,Q,pe,Te,ct,D,M);return;case"select":at=G=Q=Ye=null;for(D in v)if(pe=v[D],v.hasOwnProperty(D)&&pe!=null)switch(D){case"value":break;case"multiple":at=pe;default:E.hasOwnProperty(D)||ji(u,f,D,null,E,pe)}for(M in E)if(D=E[M],pe=v[M],E.hasOwnProperty(M)&&(D!=null||pe!=null))switch(M){case"value":Ye=D;break;case"defaultValue":Q=D;break;case"multiple":G=D;default:D!==pe&&ji(u,f,M,D,E,pe)}f=Q,v=G,E=at,Ye!=null?vi(u,!!v,Ye,!1):!!E!=!!v&&(f!=null?vi(u,!!v,f,!0):vi(u,!!v,v?[]:"",!1));return;case"textarea":at=Ye=null;for(Q in v)if(M=v[Q],v.hasOwnProperty(Q)&&M!=null&&!E.hasOwnProperty(Q))switch(Q){case"value":break;case"children":break;default:ji(u,f,Q,null,E,M)}for(G in E)if(M=E[G],D=v[G],E.hasOwnProperty(G)&&(M!=null||D!=null))switch(G){case"value":Ye=M;break;case"defaultValue":at=M;break;case"children":break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(n(91));break;default:M!==D&&ji(u,f,G,M,E,D)}hr(u,Ye,at);return;case"option":for(var an in v)if(Ye=v[an],v.hasOwnProperty(an)&&Ye!=null&&!E.hasOwnProperty(an))switch(an){case"selected":u.selected=!1;break;default:ji(u,f,an,null,E,Ye)}for(pe in E)if(Ye=E[pe],at=v[pe],E.hasOwnProperty(pe)&&Ye!==at&&(Ye!=null||at!=null))switch(pe){case"selected":u.selected=Ye&&typeof Ye!="function"&&typeof Ye!="symbol";break;default:ji(u,f,pe,Ye,E,at)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Mn in v)Ye=v[Mn],v.hasOwnProperty(Mn)&&Ye!=null&&!E.hasOwnProperty(Mn)&&ji(u,f,Mn,null,E,Ye);for(Te in E)if(Ye=E[Te],at=v[Te],E.hasOwnProperty(Te)&&Ye!==at&&(Ye!=null||at!=null))switch(Te){case"children":case"dangerouslySetInnerHTML":if(Ye!=null)throw Error(n(137,f));break;default:ji(u,f,Te,Ye,E,at)}return;default:if(q0(f)){for(var zs in v)Ye=v[zs],v.hasOwnProperty(zs)&&Ye!==void 0&&!E.hasOwnProperty(zs)&&nC(u,f,zs,void 0,E,Ye);for(ct in E)Ye=E[ct],at=v[ct],!E.hasOwnProperty(ct)||Ye===at||Ye===void 0&&at===void 0||nC(u,f,ct,Ye,E,at);return}}for(var Le in v)Ye=v[Le],v.hasOwnProperty(Le)&&Ye!=null&&!E.hasOwnProperty(Le)&&ji(u,f,Le,null,E,Ye);for(xt in E)Ye=E[xt],at=v[xt],!E.hasOwnProperty(xt)||Ye===at||Ye==null&&at==null||ji(u,f,xt,Ye,E,at)}var iC=null,sC=null;function b_(u){return u.nodeType===9?u:u.ownerDocument}function gP(u){switch(u){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function yP(u,f){if(u===0)switch(f){case"svg":return 1;case"math":return 2;default:return 0}return u===1&&f==="foreignObject"?0:u}function rC(u,f){return u==="textarea"||u==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.children=="bigint"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var aC=null;function xY(){var u=window.event;return u&&u.type==="popstate"?u===aC?!1:(aC=u,!0):(aC=null,!1)}var vP=typeof setTimeout=="function"?setTimeout:void 0,bY=typeof clearTimeout=="function"?clearTimeout:void 0,xP=typeof Promise=="function"?Promise:void 0,AY=typeof queueMicrotask=="function"?queueMicrotask:typeof xP<"u"?function(u){return xP.resolve(null).then(u).catch(EY)}:vP;function EY(u){setTimeout(function(){throw u})}function oC(u,f){var v=f,E=0;do{var M=v.nextSibling;if(u.removeChild(v),M&&M.nodeType===8)if(v=M.data,v==="/$"){if(E===0){u.removeChild(M),hb(f);return}E--}else v!=="$"&&v!=="$?"&&v!=="$!"||E++;v=M}while(v);hb(f)}function lC(u){var f=u.firstChild;for(f&&f.nodeType===10&&(f=f.nextSibling);f;){var v=f;switch(f=f.nextSibling,v.nodeName){case"HTML":case"HEAD":case"BODY":lC(v),Rt(v);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(v.rel.toLowerCase()==="stylesheet")continue}u.removeChild(v)}}function _Y(u,f,v,E){for(;u.nodeType===1;){var M=v;if(u.nodeName.toLowerCase()!==f.toLowerCase()){if(!E&&(u.nodeName!=="INPUT"||u.type!=="hidden"))break}else if(E){if(!u[Xe])switch(f){case"meta":if(!u.hasAttribute("itemprop"))break;return u;case"link":if(D=u.getAttribute("rel"),D==="stylesheet"&&u.hasAttribute("data-precedence"))break;if(D!==M.rel||u.getAttribute("href")!==(M.href==null?null:M.href)||u.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin)||u.getAttribute("title")!==(M.title==null?null:M.title))break;return u;case"style":if(u.hasAttribute("data-precedence"))break;return u;case"script":if(D=u.getAttribute("src"),(D!==(M.src==null?null:M.src)||u.getAttribute("type")!==(M.type==null?null:M.type)||u.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin))&&D&&u.hasAttribute("async")&&!u.hasAttribute("itemprop"))break;return u;default:return u}}else if(f==="input"&&u.type==="hidden"){var D=M.name==null?null:""+M.name;if(M.type==="hidden"&&u.getAttribute("name")===D)return u}else return u;if(u=Ac(u.nextSibling),u===null)break}return null}function SY(u,f,v){if(f==="")return null;for(;u.nodeType!==3;)if((u.nodeType!==1||u.nodeName!=="INPUT"||u.type!=="hidden")&&!v||(u=Ac(u.nextSibling),u===null))return null;return u}function Ac(u){for(;u!=null;u=u.nextSibling){var f=u.nodeType;if(f===1||f===3)break;if(f===8){if(f=u.data,f==="$"||f==="$!"||f==="$?"||f==="F!"||f==="F")break;if(f==="/$")return null}}return u}function bP(u){u=u.previousSibling;for(var f=0;u;){if(u.nodeType===8){var v=u.data;if(v==="$"||v==="$!"||v==="$?"){if(f===0)return u;f--}else v==="/$"&&f++}u=u.previousSibling}return null}function AP(u,f,v){switch(f=b_(v),u){case"html":if(u=f.documentElement,!u)throw Error(n(452));return u;case"head":if(u=f.head,!u)throw Error(n(453));return u;case"body":if(u=f.body,!u)throw Error(n(454));return u;default:throw Error(n(451))}}var bl=new Map,EP=new Set;function A_(u){return typeof u.getRootNode=="function"?u.getRootNode():u.ownerDocument}var Wh=le.d;le.d={f:TY,r:wY,D:MY,C:CY,L:RY,m:DY,X:IY,S:LY,M:BY};function TY(){var u=Wh.f(),f=Vh();return u||f}function wY(u){var f=Y(u);f!==null&&f.tag===5&&f.type==="form"?$1(f):Wh.r(u)}var _2=typeof document>"u"?null:document;function _P(u,f,v){var E=_2;if(E&&typeof f=="string"&&f){var M=mn(f);M='link[rel="'+u+'"][href="'+M+'"]',typeof v=="string"&&(M+='[crossorigin="'+v+'"]'),EP.has(M)||(EP.add(M),u={rel:u,crossOrigin:v,href:f},E.querySelector(M)===null&&(f=E.createElement("link"),na(f,"link",u),de(f),E.head.appendChild(f)))}}function MY(u){Wh.D(u),_P("dns-prefetch",u,null)}function CY(u,f){Wh.C(u,f),_P("preconnect",u,f)}function RY(u,f,v){Wh.L(u,f,v);var E=_2;if(E&&u&&f){var M='link[rel="preload"][as="'+mn(f)+'"]';f==="image"&&v&&v.imageSrcSet?(M+='[imagesrcset="'+mn(v.imageSrcSet)+'"]',typeof v.imageSizes=="string"&&(M+='[imagesizes="'+mn(v.imageSizes)+'"]')):M+='[href="'+mn(u)+'"]';var D=M;switch(f){case"style":D=S2(u);break;case"script":D=T2(u)}bl.has(D)||(u=L({rel:"preload",href:f==="image"&&v&&v.imageSrcSet?void 0:u,as:f},v),bl.set(D,u),E.querySelector(M)!==null||f==="style"&&E.querySelector(sb(D))||f==="script"&&E.querySelector(rb(D))||(f=E.createElement("link"),na(f,"link",u),de(f),E.head.appendChild(f)))}}function DY(u,f){Wh.m(u,f);var v=_2;if(v&&u){var E=f&&typeof f.as=="string"?f.as:"script",M='link[rel="modulepreload"][as="'+mn(E)+'"][href="'+mn(u)+'"]',D=M;switch(E){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=T2(u)}if(!bl.has(D)&&(u=L({rel:"modulepreload",href:u},f),bl.set(D,u),v.querySelector(M)===null)){switch(E){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(v.querySelector(rb(D)))return}E=v.createElement("link"),na(E,"link",u),de(E),v.head.appendChild(E)}}}function LY(u,f,v){Wh.S(u,f,v);var E=_2;if(E&&u){var M=me(E).hoistableStyles,D=S2(u);f=f||"default";var G=M.get(D);if(!G){var Q={loading:0,preload:null};if(G=E.querySelector(sb(D)))Q.loading=5;else{u=L({rel:"stylesheet",href:u,"data-precedence":f},v),(v=bl.get(D))&&cC(u,v);var pe=G=E.createElement("link");de(pe),na(pe,"link",u),pe._p=new Promise(function(Te,ct){pe.onload=Te,pe.onerror=ct}),pe.addEventListener("load",function(){Q.loading|=1}),pe.addEventListener("error",function(){Q.loading|=2}),Q.loading|=4,E_(G,f,E)}G={type:"stylesheet",instance:G,count:1,state:Q},M.set(D,G)}}}function IY(u,f){Wh.X(u,f);var v=_2;if(v&&u){var E=me(v).hoistableScripts,M=T2(u),D=E.get(M);D||(D=v.querySelector(rb(M)),D||(u=L({src:u,async:!0},f),(f=bl.get(M))&&uC(u,f),D=v.createElement("script"),de(D),na(D,"link",u),v.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},E.set(M,D))}}function BY(u,f){Wh.M(u,f);var v=_2;if(v&&u){var E=me(v).hoistableScripts,M=T2(u),D=E.get(M);D||(D=v.querySelector(rb(M)),D||(u=L({src:u,async:!0,type:"module"},f),(f=bl.get(M))&&uC(u,f),D=v.createElement("script"),de(D),na(D,"link",u),v.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},E.set(M,D))}}function SP(u,f,v,E){var M=(M=Ot.current)?A_(M):null;if(!M)throw Error(n(446));switch(u){case"meta":case"title":return null;case"style":return typeof v.precedence=="string"&&typeof v.href=="string"?(f=S2(v.href),v=me(M).hoistableStyles,E=v.get(f),E||(E={type:"style",instance:null,count:0,state:null},v.set(f,E)),E):{type:"void",instance:null,count:0,state:null};case"link":if(v.rel==="stylesheet"&&typeof v.href=="string"&&typeof v.precedence=="string"){u=S2(v.href);var D=me(M).hoistableStyles,G=D.get(u);if(G||(M=M.ownerDocument||M,G={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(u,G),(D=M.querySelector(sb(u)))&&!D._p&&(G.instance=D,G.state.loading=5),bl.has(u)||(v={rel:"preload",as:"style",href:v.href,crossOrigin:v.crossOrigin,integrity:v.integrity,media:v.media,hrefLang:v.hrefLang,referrerPolicy:v.referrerPolicy},bl.set(u,v),D||OY(M,u,v,G.state))),f&&E===null)throw Error(n(528,""));return G}if(f&&E!==null)throw Error(n(529,""));return null;case"script":return f=v.async,v=v.src,typeof v=="string"&&f&&typeof f!="function"&&typeof f!="symbol"?(f=T2(v),v=me(M).hoistableScripts,E=v.get(f),E||(E={type:"script",instance:null,count:0,state:null},v.set(f,E)),E):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,u))}}function S2(u){return'href="'+mn(u)+'"'}function sb(u){return'link[rel="stylesheet"]['+u+"]"}function TP(u){return L({},u,{"data-precedence":u.precedence,precedence:null})}function OY(u,f,v,E){u.querySelector('link[rel="preload"][as="style"]['+f+"]")?E.loading=1:(f=u.createElement("link"),E.preload=f,f.addEventListener("load",function(){return E.loading|=1}),f.addEventListener("error",function(){return E.loading|=2}),na(f,"link",v),de(f),u.head.appendChild(f))}function T2(u){return'[src="'+mn(u)+'"]'}function rb(u){return"script[async]"+u}function wP(u,f,v){if(f.count++,f.instance===null)switch(f.type){case"style":var E=u.querySelector('style[data-href~="'+mn(v.href)+'"]');if(E)return f.instance=E,de(E),E;var M=L({},v,{"data-href":v.href,"data-precedence":v.precedence,href:null,precedence:null});return E=(u.ownerDocument||u).createElement("style"),de(E),na(E,"style",M),E_(E,v.precedence,u),f.instance=E;case"stylesheet":M=S2(v.href);var D=u.querySelector(sb(M));if(D)return f.state.loading|=4,f.instance=D,de(D),D;E=TP(v),(M=bl.get(M))&&cC(E,M),D=(u.ownerDocument||u).createElement("link"),de(D);var G=D;return G._p=new Promise(function(Q,pe){G.onload=Q,G.onerror=pe}),na(D,"link",E),f.state.loading|=4,E_(D,v.precedence,u),f.instance=D;case"script":return D=T2(v.src),(M=u.querySelector(rb(D)))?(f.instance=M,de(M),M):(E=v,(M=bl.get(D))&&(E=L({},v),uC(E,M)),u=u.ownerDocument||u,M=u.createElement("script"),de(M),na(M,"link",E),u.head.appendChild(M),f.instance=M);case"void":return null;default:throw Error(n(443,f.type))}else f.type==="stylesheet"&&(f.state.loading&4)===0&&(E=f.instance,f.state.loading|=4,E_(E,v.precedence,u));return f.instance}function E_(u,f,v){for(var E=v.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),M=E.length?E[E.length-1]:null,D=M,G=0;G<E.length;G++){var Q=E[G];if(Q.dataset.precedence===f)D=Q;else if(D!==M)break}D?D.parentNode.insertBefore(u,D.nextSibling):(f=v.nodeType===9?v.head:v,f.insertBefore(u,f.firstChild))}function cC(u,f){u.crossOrigin==null&&(u.crossOrigin=f.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=f.referrerPolicy),u.title==null&&(u.title=f.title)}function uC(u,f){u.crossOrigin==null&&(u.crossOrigin=f.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=f.referrerPolicy),u.integrity==null&&(u.integrity=f.integrity)}var __=null;function MP(u,f,v){if(__===null){var E=new Map,M=__=new Map;M.set(v,E)}else M=__,E=M.get(v),E||(E=new Map,M.set(v,E));if(E.has(u))return E;for(E.set(u,null),v=v.getElementsByTagName(u),M=0;M<v.length;M++){var D=v[M];if(!(D[Xe]||D[$i]||u==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var G=D.getAttribute(f)||"";G=u+G;var Q=E.get(G);Q?Q.push(D):E.set(G,[D])}}return E}function CP(u,f,v){u=u.ownerDocument||u,u.head.insertBefore(v,f==="title"?u.querySelector("head > title"):null)}function PY(u,f,v){if(v===1||f.itemProp!=null)return!1;switch(u){case"meta":case"title":return!0;case"style":if(typeof f.precedence!="string"||typeof f.href!="string"||f.href==="")break;return!0;case"link":if(typeof f.rel!="string"||typeof f.href!="string"||f.href===""||f.onLoad||f.onError)break;switch(f.rel){case"stylesheet":return u=f.disabled,typeof f.precedence=="string"&&u==null;default:return!0}case"script":if(f.async&&typeof f.async!="function"&&typeof f.async!="symbol"&&!f.onLoad&&!f.onError&&f.src&&typeof f.src=="string")return!0}return!1}function RP(u){return!(u.type==="stylesheet"&&(u.state.loading&3)===0)}var ab=null;function NY(){}function UY(u,f,v){if(ab===null)throw Error(n(475));var E=ab;if(f.type==="stylesheet"&&(typeof v.media!="string"||matchMedia(v.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var M=S2(v.href),D=u.querySelector(sb(M));if(D){u=D._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(E.count++,E=S_.bind(E),u.then(E,E)),f.state.loading|=4,f.instance=D,de(D);return}D=u.ownerDocument||u,v=TP(v),(M=bl.get(M))&&cC(v,M),D=D.createElement("link"),de(D);var G=D;G._p=new Promise(function(Q,pe){G.onload=Q,G.onerror=pe}),na(D,"link",v),f.instance=D}E.stylesheets===null&&(E.stylesheets=new Map),E.stylesheets.set(f,u),(u=f.state.preload)&&(f.state.loading&3)===0&&(E.count++,f=S_.bind(E),u.addEventListener("load",f),u.addEventListener("error",f))}}function kY(){if(ab===null)throw Error(n(475));var u=ab;return u.stylesheets&&u.count===0&&hC(u,u.stylesheets),0<u.count?function(f){var v=setTimeout(function(){if(u.stylesheets&&hC(u,u.stylesheets),u.unsuspend){var E=u.unsuspend;u.unsuspend=null,E()}},6e4);return u.unsuspend=f,function(){u.unsuspend=null,clearTimeout(v)}}:null}function S_(){if(this.count--,this.count===0){if(this.stylesheets)hC(this,this.stylesheets);else if(this.unsuspend){var u=this.unsuspend;this.unsuspend=null,u()}}}var T_=null;function hC(u,f){u.stylesheets=null,u.unsuspend!==null&&(u.count++,T_=new Map,f.forEach(FY,u),T_=null,S_.call(u))}function FY(u,f){if(!(f.state.loading&4)){var v=T_.get(u);if(v)var E=v.get(null);else{v=new Map,T_.set(u,v);for(var M=u.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<M.length;D++){var G=M[D];(G.nodeName==="LINK"||G.getAttribute("media")!=="not all")&&(v.set(G.dataset.precedence,G),E=G)}E&&v.set(null,E)}M=f.instance,G=M.getAttribute("data-precedence"),D=v.get(G)||E,D===E&&v.set(null,M),v.set(G,M),this.count++,E=S_.bind(this),M.addEventListener("load",E),M.addEventListener("error",E),D?D.parentNode.insertBefore(M,D.nextSibling):(u=u.nodeType===9?u.head:u,u.insertBefore(M,u.firstChild)),f.state.loading|=4}}var ob={$$typeof:y,Provider:null,Consumer:null,_currentValue:Ce,_currentValue2:Ce,_threadCount:0};function HY(u,f,v,E,M,D,G,Q){this.tag=1,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ts(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ts(0),this.hiddenUpdates=ts(null),this.identifierPrefix=E,this.onUncaughtError=M,this.onCaughtError=D,this.onRecoverableError=G,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Q,this.incompleteTransitions=new Map}function DP(u,f,v,E,M,D,G,Q,pe,Te,ct,xt){return u=new HY(u,f,v,G,Q,pe,Te,xt),f=1,D===!0&&(f|=24),D=ws(3,null,null,f),u.current=D,D.stateNode=u,f=Tx(),f.refCount++,u.pooledCache=f,f.refCount++,D.memoizedState={element:E,isDehydrated:v,cache:f},$r(D),u}function LP(u){return u?(u=lu,u):lu}function IP(u,f,v,E,M,D){M=LP(M),E.context===null?E.context=M:E.pendingContext=M,E=Fa(f),E.payload={element:v},D=D===void 0?null:D,D!==null&&(E.callback=D),v=Ha(u,E,f),v!==null&&(Gs(v,u,f),wu(v,u,f))}function BP(u,f){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var v=u.retryLane;u.retryLane=v!==0&&v<f?v:f}}function fC(u,f){BP(u,f),(u=u.alternate)&&BP(u,f)}function OP(u){if(u.tag===13){var f=Jl(u,67108864);f!==null&&Gs(f,u,67108864),fC(u,67108864)}}var w_=!0;function GY(u,f,v,E){var M=B.T;B.T=null;var D=le.p;try{le.p=2,dC(u,f,v,E)}finally{le.p=D,B.T=M}}function zY(u,f,v,E){var M=B.T;B.T=null;var D=le.p;try{le.p=8,dC(u,f,v,E)}finally{le.p=D,B.T=M}}function dC(u,f,v,E){if(w_){var M=pC(E);if(M===null)tC(u,f,E,M_,v),NP(u,E);else if(YY(M,u,f,v,E))E.stopPropagation();else if(NP(u,E),f&4&&-1<VY.indexOf(u)){for(;M!==null;){var D=Y(M);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var G=It(D.pendingLanes);if(G!==0){var Q=D;for(Q.pendingLanes|=2,Q.entangledLanes|=2;G;){var pe=1<<31-He(G);Q.entanglements[1]|=pe,G&=~pe}Fi(D),(An&6)===0&&(jn=Fe()+500,qn(0))}}break;case 13:Q=Jl(D,2),Q!==null&&Gs(Q,D,2),Vh(),fC(D,2)}if(D=pC(E),D===null&&tC(u,f,E,M_,v),D===M)break;M=D}M!==null&&E.stopPropagation()}else tC(u,f,E,null,v)}}function pC(u){return u=$0(u),mC(u)}var M_=null;function mC(u){if(M_=null,u=gt(u),u!==null){var f=ie(u);if(f===null)u=null;else{var v=f.tag;if(v===13){if(u=ue(f),u!==null)return u;u=null}else if(v===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;u=null}else f!==u&&(u=null)}}return M_=u,null}function PP(u){switch(u){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ut()){case We:return 2;case ot:return 8;case et:case pt:return 32;case vt:return 268435456;default:return 32}default:return 32}}var gC=!1,Ld=null,Id=null,Bd=null,lb=new Map,cb=new Map,Od=[],VY="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function NP(u,f){switch(u){case"focusin":case"focusout":Ld=null;break;case"dragenter":case"dragleave":Id=null;break;case"mouseover":case"mouseout":Bd=null;break;case"pointerover":case"pointerout":lb.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":cb.delete(f.pointerId)}}function ub(u,f,v,E,M,D){return u===null||u.nativeEvent!==D?(u={blockedOn:f,domEventName:v,eventSystemFlags:E,nativeEvent:D,targetContainers:[M]},f!==null&&(f=Y(f),f!==null&&OP(f)),u):(u.eventSystemFlags|=E,f=u.targetContainers,M!==null&&f.indexOf(M)===-1&&f.push(M),u)}function YY(u,f,v,E,M){switch(f){case"focusin":return Ld=ub(Ld,u,f,v,E,M),!0;case"dragenter":return Id=ub(Id,u,f,v,E,M),!0;case"mouseover":return Bd=ub(Bd,u,f,v,E,M),!0;case"pointerover":var D=M.pointerId;return lb.set(D,ub(lb.get(D)||null,u,f,v,E,M)),!0;case"gotpointercapture":return D=M.pointerId,cb.set(D,ub(cb.get(D)||null,u,f,v,E,M)),!0}return!1}function UP(u){var f=gt(u.target);if(f!==null){var v=ie(f);if(v!==null){if(f=v.tag,f===13){if(f=ue(v),f!==null){u.blockedOn=f,xr(u.priority,function(){if(v.tag===13){var E=ta(),M=Jl(v,E);M!==null&&Gs(M,v,E),fC(v,E)}});return}}else if(f===3&&v.stateNode.current.memoizedState.isDehydrated){u.blockedOn=v.tag===3?v.stateNode.containerInfo:null;return}}}u.blockedOn=null}function C_(u){if(u.blockedOn!==null)return!1;for(var f=u.targetContainers;0<f.length;){var v=pC(u.nativeEvent);if(v===null){v=u.nativeEvent;var E=new v.constructor(v.type,v);Bg=E,v.target.dispatchEvent(E),Bg=null}else return f=Y(v),f!==null&&OP(f),u.blockedOn=v,!1;f.shift()}return!0}function kP(u,f,v){C_(u)&&v.delete(f)}function KY(){gC=!1,Ld!==null&&C_(Ld)&&(Ld=null),Id!==null&&C_(Id)&&(Id=null),Bd!==null&&C_(Bd)&&(Bd=null),lb.forEach(kP),cb.forEach(kP)}function R_(u,f){u.blockedOn===f&&(u.blockedOn=null,gC||(gC=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,KY)))}var D_=null;function FP(u){D_!==u&&(D_=u,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){D_===u&&(D_=null);for(var f=0;f<u.length;f+=3){var v=u[f],E=u[f+1],M=u[f+2];if(typeof E!="function"){if(mC(E||v)===null)continue;break}var D=Y(v);D!==null&&(u.splice(f,3),f-=3,Ox(D,{pending:!0,data:M,method:v.method,action:E},E,M))}}))}function hb(u){function f(pe){return R_(pe,u)}Ld!==null&&R_(Ld,u),Id!==null&&R_(Id,u),Bd!==null&&R_(Bd,u),lb.forEach(f),cb.forEach(f);for(var v=0;v<Od.length;v++){var E=Od[v];E.blockedOn===u&&(E.blockedOn=null)}for(;0<Od.length&&(v=Od[0],v.blockedOn===null);)UP(v),v.blockedOn===null&&Od.shift();if(v=(u.ownerDocument||u).$$reactFormReplay,v!=null)for(E=0;E<v.length;E+=3){var M=v[E],D=v[E+1],G=M[Ln]||null;if(typeof D=="function")G||FP(v);else if(G){var Q=null;if(D&&D.hasAttribute("formAction")){if(M=D,G=D[Ln]||null)Q=G.formAction;else if(mC(M)!==null)continue}else Q=G.action;typeof Q=="function"?v[E+1]=Q:(v.splice(E,3),E-=3),FP(v)}}}function yC(u){this._internalRoot=u}L_.prototype.render=yC.prototype.render=function(u){var f=this._internalRoot;if(f===null)throw Error(n(409));var v=f.current,E=ta();IP(v,E,u,f,null,null)},L_.prototype.unmount=yC.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var f=u.containerInfo;u.tag===0&&Lt(),IP(u.current,2,null,u,null,null),Vh(),f[V]=null}};function L_(u){this._internalRoot=u}L_.prototype.unstable_scheduleHydration=function(u){if(u){var f=to();u={blockedOn:null,target:u,priority:f};for(var v=0;v<Od.length&&f!==0&&f<Od[v].priority;v++);Od.splice(v,0,u),v===0&&UP(u)}};var HP=e.version;if(HP!=="19.0.0")throw Error(n(527,HP,"19.0.0"));le.findDOMNode=function(u){var f=u._reactInternals;if(f===void 0)throw typeof u.render=="function"?Error(n(188)):(u=Object.keys(u).join(","),Error(n(268,u)));return u=ae(f),u=u!==null?ge(u):null,u=u===null?null:u.stateNode,u};var WY={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:B,findFiberByHostInstance:gt,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var I_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!I_.isDisabled&&I_.supportsFiber)try{Et=I_.inject(WY),Dt=I_}catch{}}return pb.createRoot=function(u,f){if(!s(u))throw Error(n(299));var v=!1,E="",M=r_,D=a_,G=o_,Q=null;return f!=null&&(f.unstable_strictMode===!0&&(v=!0),f.identifierPrefix!==void 0&&(E=f.identifierPrefix),f.onUncaughtError!==void 0&&(M=f.onUncaughtError),f.onCaughtError!==void 0&&(D=f.onCaughtError),f.onRecoverableError!==void 0&&(G=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(Q=f.unstable_transitionCallbacks)),f=DP(u,1,!1,null,null,v,E,M,D,G,Q,null),u[V]=f.current,eC(u.nodeType===8?u.parentNode:u),new yC(f)},pb.hydrateRoot=function(u,f,v){if(!s(u))throw Error(n(299));var E=!1,M="",D=r_,G=a_,Q=o_,pe=null,Te=null;return v!=null&&(v.unstable_strictMode===!0&&(E=!0),v.identifierPrefix!==void 0&&(M=v.identifierPrefix),v.onUncaughtError!==void 0&&(D=v.onUncaughtError),v.onCaughtError!==void 0&&(G=v.onCaughtError),v.onRecoverableError!==void 0&&(Q=v.onRecoverableError),v.unstable_transitionCallbacks!==void 0&&(pe=v.unstable_transitionCallbacks),v.formState!==void 0&&(Te=v.formState)),f=DP(u,1,!0,f,v??null,E,M,D,G,Q,pe,Te),f.context=LP(null),v=f.current,E=ta(),M=Fa(E),M.callback=null,Ha(v,M,E),f.current.lanes=E,cs(f,E),Fi(f),u[V]=f.current,eC(u),new L_(f)},pb.version="19.0.0",pb}var $P;function iK(){if($P)return AC.exports;$P=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),AC.exports=nK(),AC.exports}var sK=iK(),mb={},JP;function rK(){if(JP)return mb;JP=1,Object.defineProperty(mb,"__esModule",{value:!0}),mb.parse=a,mb.serialize=c;const i=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,s=Object.prototype.toString,r=(()=>{const m=function(){};return m.prototype=Object.create(null),m})();function a(m,y){const x=new r,_=m.length;if(_<2)return x;const b=(y==null?void 0:y.decode)||h;let A=0;do{const T=m.indexOf("=",A);if(T===-1)break;const w=m.indexOf(";",A),R=w===-1?_:w;if(T>R){A=m.lastIndexOf(";",T-1)+1;continue}const O=o(m,A,T),N=l(m,T,O),U=m.slice(O,N);if(x[U]===void 0){let P=o(m,T+1,R),B=l(m,R,P);const L=b(m.slice(P,B));x[U]=L}A=R+1}while(A<_);return x}function o(m,y,x){do{const _=m.charCodeAt(y);if(_!==32&&_!==9)return y}while(++y<x);return x}function l(m,y,x){for(;y>x;){const _=m.charCodeAt(--y);if(_!==32&&_!==9)return y+1}return x}function c(m,y,x){const _=(x==null?void 0:x.encode)||encodeURIComponent;if(!i.test(m))throw new TypeError(`argument name is invalid: ${m}`);const b=_(y);if(!e.test(b))throw new TypeError(`argument val is invalid: ${y}`);let A=m+"="+b;if(!x)return A;if(x.maxAge!==void 0){if(!Number.isInteger(x.maxAge))throw new TypeError(`option maxAge is invalid: ${x.maxAge}`);A+="; Max-Age="+x.maxAge}if(x.domain){if(!t.test(x.domain))throw new TypeError(`option domain is invalid: ${x.domain}`);A+="; Domain="+x.domain}if(x.path){if(!n.test(x.path))throw new TypeError(`option path is invalid: ${x.path}`);A+="; Path="+x.path}if(x.expires){if(!d(x.expires)||!Number.isFinite(x.expires.valueOf()))throw new TypeError(`option expires is invalid: ${x.expires}`);A+="; Expires="+x.expires.toUTCString()}if(x.httpOnly&&(A+="; HttpOnly"),x.secure&&(A+="; Secure"),x.partitioned&&(A+="; Partitioned"),x.priority)switch(typeof x.priority=="string"?x.priority.toLowerCase():void 0){case"low":A+="; Priority=Low";break;case"medium":A+="; Priority=Medium";break;case"high":A+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${x.priority}`)}if(x.sameSite)switch(typeof x.sameSite=="string"?x.sameSite.toLowerCase():x.sameSite){case!0:case"strict":A+="; SameSite=Strict";break;case"lax":A+="; SameSite=Lax";break;case"none":A+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${x.sameSite}`)}return A}function h(m){if(m.indexOf("%")===-1)return m;try{return decodeURIComponent(m)}catch{return m}}function d(m){return s.call(m)==="[object Date]"}return mb}rK();/**
 * react-router v7.4.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var ZP="popstate";function aK(i={}){function e(s,r){let{pathname:a="/",search:o="",hash:l=""}=Eg(s.location.hash.substring(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),FD("",{pathname:a,search:o,hash:l},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(s,r){let a=s.document.querySelector("base"),o="";if(a&&a.getAttribute("href")){let l=s.location.href,c=l.indexOf("#");o=c===-1?l:l.slice(0,c)}return o+"#"+(typeof r=="string"?r:DA(r))}function n(s,r){Kc(s.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(r)})`)}return lK(e,t,n,i)}function Bs(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function Kc(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function oK(){return Math.random().toString(36).substring(2,10)}function eN(i,e){return{usr:i.state,key:i.key,idx:e}}function FD(i,e,t=null,n){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof e=="string"?Eg(e):e,state:t,key:e&&e.key||n||oK()}}function DA({pathname:i="/",search:e="",hash:t=""}){return e&&e!=="?"&&(i+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(i+=t.charAt(0)==="#"?t:"#"+t),i}function Eg(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substring(t),i=i.substring(0,t));let n=i.indexOf("?");n>=0&&(e.search=i.substring(n),i=i.substring(0,n)),i&&(e.pathname=i)}return e}function lK(i,e,t,n={}){let{window:s=document.defaultView,v5Compat:r=!1}=n,a=s.history,o="POP",l=null,c=h();c==null&&(c=0,a.replaceState({...a.state,idx:c},""));function h(){return(a.state||{idx:null}).idx}function d(){o="POP";let b=h(),A=b==null?null:b-c;c=b,l&&l({action:o,location:_.location,delta:A})}function m(b,A){o="PUSH";let T=FD(_.location,b,A);t&&t(T,b),c=h()+1;let w=eN(T,c),R=_.createHref(T);try{a.pushState(w,"",R)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(R)}r&&l&&l({action:o,location:_.location,delta:1})}function y(b,A){o="REPLACE";let T=FD(_.location,b,A);t&&t(T,b),c=h();let w=eN(T,c),R=_.createHref(T);a.replaceState(w,"",R),r&&l&&l({action:o,location:_.location,delta:0})}function x(b){let A=s.location.origin!=="null"?s.location.origin:s.location.href,T=typeof b=="string"?b:DA(b);return T=T.replace(/ $/,"%20"),Bs(A,`No window.location.(origin|href) available to create URL for href: ${T}`),new URL(T,A)}let _={get action(){return o},get location(){return i(s,a)},listen(b){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(ZP,d),l=b,()=>{s.removeEventListener(ZP,d),l=null}},createHref(b){return e(s,b)},createURL:x,encodeLocation(b){let A=x(b);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:m,replace:y,go(b){return a.go(b)}};return _}function M5(i,e,t="/"){return cK(i,e,t,!1)}function cK(i,e,t,n){let s=typeof e=="string"?Eg(e):e,r=zf(s.pathname||"/",t);if(r==null)return null;let a=C5(i);uK(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let c=AK(r);o=xK(a[l],c,n)}return o}function C5(i,e=[],t=[],n=""){let s=(r,a,o)=>{let l={relativePath:o===void 0?r.path||"":o,caseSensitive:r.caseSensitive===!0,childrenIndex:a,route:r};l.relativePath.startsWith("/")&&(Bs(l.relativePath.startsWith(n),`Absolute route path "${l.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(n.length));let c=Nf([n,l.relativePath]),h=t.concat(l);r.children&&r.children.length>0&&(Bs(r.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),C5(r.children,e,h,c)),!(r.path==null&&!r.index)&&e.push({path:c,score:yK(c,r.index),routesMeta:h})};return i.forEach((r,a)=>{var o;if(r.path===""||!((o=r.path)!=null&&o.includes("?")))s(r,a);else for(let l of R5(r.path))s(r,a,l)}),e}function R5(i){let e=i.split("/");if(e.length===0)return[];let[t,...n]=e,s=t.endsWith("?"),r=t.replace(/\?$/,"");if(n.length===0)return s?[r,""]:[r];let a=R5(n.join("/")),o=[];return o.push(...a.map(l=>l===""?r:[r,l].join("/"))),s&&o.push(...a),o.map(l=>i.startsWith("/")&&l===""?"/":l)}function uK(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:vK(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var hK=/^:[\w-]+$/,fK=3,dK=2,pK=1,mK=10,gK=-2,tN=i=>i==="*";function yK(i,e){let t=i.split("/"),n=t.length;return t.some(tN)&&(n+=gK),e&&(n+=dK),t.filter(s=>!tN(s)).reduce((s,r)=>s+(hK.test(r)?fK:r===""?pK:mK),n)}function vK(i,e){return i.length===e.length&&i.slice(0,-1).every((n,s)=>n===e[s])?i[i.length-1]-e[e.length-1]:0}function xK(i,e,t=!1){let{routesMeta:n}=i,s={},r="/",a=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,h=r==="/"?e:e.slice(r.length)||"/",d=QT({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},h),m=l.route;if(!d&&c&&t&&!n[n.length-1].route.index&&(d=QT({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!d)return null;Object.assign(s,d.params),a.push({params:s,pathname:Nf([r,d.pathname]),pathnameBase:TK(Nf([r,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(r=Nf([r,d.pathnameBase]))}return a}function QT(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,n]=bK(i.path,i.caseSensitive,i.end),s=e.match(t);if(!s)return null;let r=s[0],a=r.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,{paramName:h,isOptional:d},m)=>{if(h==="*"){let x=o[m]||"";a=r.slice(0,r.length-x.length).replace(/(.)\/+$/,"$1")}const y=o[m];return d&&!y?c[h]=void 0:c[h]=(y||"").replace(/%2F/g,"/"),c},{}),pathname:r,pathnameBase:a,pattern:i}}function bK(i,e=!1,t=!0){Kc(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let n=[],s="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(n.push({paramName:"*"}),s+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":i!==""&&i!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function AK(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Kc(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),i}}function zf(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=i.charAt(t);return n&&n!=="/"?null:i.slice(t)||"/"}function EK(i,e="/"){let{pathname:t,search:n="",hash:s=""}=typeof i=="string"?Eg(i):i;return{pathname:t?t.startsWith("/")?t:_K(t,e):e,search:wK(n),hash:MK(s)}}function _K(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function TC(i,e,t,n){return`Cannot include a '${i}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function SK(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function D5(i){let e=SK(i);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function L5(i,e,t,n=!1){let s;typeof i=="string"?s=Eg(i):(s={...i},Bs(!s.pathname||!s.pathname.includes("?"),TC("?","pathname","search",s)),Bs(!s.pathname||!s.pathname.includes("#"),TC("#","pathname","hash",s)),Bs(!s.search||!s.search.includes("#"),TC("#","search","hash",s)));let r=i===""||s.pathname==="",a=r?"/":s.pathname,o;if(a==null)o=t;else{let d=e.length-1;if(!n&&a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),d-=1;s.pathname=m.join("/")}o=d>=0?e[d]:"/"}let l=EK(s,o),c=a&&a!=="/"&&a.endsWith("/"),h=(r||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}var Nf=i=>i.join("/").replace(/\/\/+/g,"/"),TK=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),wK=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,MK=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function CK(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}var I5=["POST","PUT","PATCH","DELETE"];new Set(I5);var RK=["GET",...I5];new Set(RK);var Yv=ce.createContext(null);Yv.displayName="DataRouter";var Lw=ce.createContext(null);Lw.displayName="DataRouterState";var B5=ce.createContext({isTransitioning:!1});B5.displayName="ViewTransition";var DK=ce.createContext(new Map);DK.displayName="Fetchers";var LK=ce.createContext(null);LK.displayName="Await";var vh=ce.createContext(null);vh.displayName="Navigation";var wE=ce.createContext(null);wE.displayName="Location";var Wf=ce.createContext({outlet:null,matches:[],isDataRoute:!1});Wf.displayName="Route";var OI=ce.createContext(null);OI.displayName="RouteError";function IK(i,{relative:e}={}){Bs(ME(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=ce.useContext(vh),{hash:s,pathname:r,search:a}=CE(i,{relative:e}),o=r;return t!=="/"&&(o=r==="/"?t:Nf([t,r])),n.createHref({pathname:o,search:a,hash:s})}function ME(){return ce.useContext(wE)!=null}function Xf(){return Bs(ME(),"useLocation() may be used only in the context of a <Router> component."),ce.useContext(wE).location}var O5="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function P5(i){ce.useContext(vh).static||ce.useLayoutEffect(i)}function N5(){let{isDataRoute:i}=ce.useContext(Wf);return i?KK():BK()}function BK(){Bs(ME(),"useNavigate() may be used only in the context of a <Router> component.");let i=ce.useContext(Yv),{basename:e,navigator:t}=ce.useContext(vh),{matches:n}=ce.useContext(Wf),{pathname:s}=Xf(),r=JSON.stringify(D5(n)),a=ce.useRef(!1);return P5(()=>{a.current=!0}),ce.useCallback((l,c={})=>{if(Kc(a.current,O5),!a.current)return;if(typeof l=="number"){t.go(l);return}let h=L5(l,JSON.parse(r),s,c.relative==="path");i==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Nf([e,h.pathname])),(c.replace?t.replace:t.push)(h,c.state,c)},[e,t,r,s,i])}ce.createContext(null);function CE(i,{relative:e}={}){let{matches:t}=ce.useContext(Wf),{pathname:n}=Xf(),s=JSON.stringify(D5(t));return ce.useMemo(()=>L5(i,JSON.parse(s),n,e==="path"),[i,s,n,e])}function OK(i,e){return U5(i,e)}function U5(i,e,t,n){var T;Bs(ME(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s,static:r}=ce.useContext(vh),{matches:a}=ce.useContext(Wf),o=a[a.length-1],l=o?o.params:{},c=o?o.pathname:"/",h=o?o.pathnameBase:"/",d=o&&o.route;{let w=d&&d.path||"";k5(c,!d||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let m=Xf(),y;if(e){let w=typeof e=="string"?Eg(e):e;Bs(h==="/"||((T=w.pathname)==null?void 0:T.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${w.pathname}" was given in the \`location\` prop.`),y=w}else y=m;let x=y.pathname||"/",_=x;if(h!=="/"){let w=h.replace(/^\//,"").split("/");_="/"+x.replace(/^\//,"").split("/").slice(w.length).join("/")}let b=!r&&t&&t.matches&&t.matches.length>0?t.matches:M5(i,{pathname:_});Kc(d||b!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),Kc(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let A=FK(b&&b.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:Nf([h,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?h:Nf([h,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,t,n);return e&&A?ce.createElement(wE.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},A):A}function PK(){let i=YK(),e=CK(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},r={padding:"2px 4px",backgroundColor:n},a=null;return console.error("Error handled by React Router default ErrorBoundary:",i),a=ce.createElement(ce.Fragment,null,ce.createElement("p",null,"💿 Hey developer 👋"),ce.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ce.createElement("code",{style:r},"ErrorBoundary")," or"," ",ce.createElement("code",{style:r},"errorElement")," prop on your route.")),ce.createElement(ce.Fragment,null,ce.createElement("h2",null,"Unexpected Application Error!"),ce.createElement("h3",{style:{fontStyle:"italic"}},e),t?ce.createElement("pre",{style:s},t):null,a)}var NK=ce.createElement(PK,null),UK=class extends ce.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,e){return e.location!==i.location||e.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:e.error,location:e.location,revalidation:i.revalidation||e.revalidation}}componentDidCatch(i,e){console.error("React Router caught the following error during render",i,e)}render(){return this.state.error!==void 0?ce.createElement(Wf.Provider,{value:this.props.routeContext},ce.createElement(OI.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function kK({routeContext:i,match:e,children:t}){let n=ce.useContext(Yv);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),ce.createElement(Wf.Provider,{value:i},t)}function FK(i,e=[],t=null,n=null){if(i==null){if(!t)return null;if(t.errors)i=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)i=t.matches;else return null}let s=i,r=t==null?void 0:t.errors;if(r!=null){let l=s.findIndex(c=>c.route.id&&(r==null?void 0:r[c.route.id])!==void 0);Bs(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(r).join(",")}`),s=s.slice(0,Math.min(s.length,l+1))}let a=!1,o=-1;if(t)for(let l=0;l<s.length;l++){let c=s[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(o=l),c.route.id){let{loaderData:h,errors:d}=t,m=c.route.loader&&!h.hasOwnProperty(c.route.id)&&(!d||d[c.route.id]===void 0);if(c.route.lazy||m){a=!0,o>=0?s=s.slice(0,o+1):s=[s[0]];break}}}return s.reduceRight((l,c,h)=>{let d,m=!1,y=null,x=null;t&&(d=r&&c.route.id?r[c.route.id]:void 0,y=c.route.errorElement||NK,a&&(o<0&&h===0?(k5("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,x=null):o===h&&(m=!0,x=c.route.hydrateFallbackElement||null)));let _=e.concat(s.slice(0,h+1)),b=()=>{let A;return d?A=y:m?A=x:c.route.Component?A=ce.createElement(c.route.Component,null):c.route.element?A=c.route.element:A=l,ce.createElement(kK,{match:c,routeContext:{outlet:l,matches:_,isDataRoute:t!=null},children:A})};return t&&(c.route.ErrorBoundary||c.route.errorElement||h===0)?ce.createElement(UK,{location:t.location,revalidation:t.revalidation,component:y,error:d,children:b(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):b()},null)}function PI(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function HK(i){let e=ce.useContext(Yv);return Bs(e,PI(i)),e}function GK(i){let e=ce.useContext(Lw);return Bs(e,PI(i)),e}function zK(i){let e=ce.useContext(Wf);return Bs(e,PI(i)),e}function NI(i){let e=zK(i),t=e.matches[e.matches.length-1];return Bs(t.route.id,`${i} can only be used on routes that contain a unique "id"`),t.route.id}function VK(){return NI("useRouteId")}function YK(){var n;let i=ce.useContext(OI),e=GK("useRouteError"),t=NI("useRouteError");return i!==void 0?i:(n=e.errors)==null?void 0:n[t]}function KK(){let{router:i}=HK("useNavigate"),e=NI("useNavigate"),t=ce.useRef(!1);return P5(()=>{t.current=!0}),ce.useCallback(async(s,r={})=>{Kc(t.current,O5),t.current&&(typeof s=="number"?i.navigate(s):await i.navigate(s,{fromRouteId:e,...r}))},[i,e])}var nN={};function k5(i,e,t){!e&&!nN[i]&&(nN[i]=!0,Kc(!1,t))}ce.memo(WK);function WK({routes:i,future:e,state:t}){return U5(i,void 0,t,e)}function sy(i){Bs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function XK({basename:i="/",children:e=null,location:t,navigationType:n="POP",navigator:s,static:r=!1}){Bs(!ME(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=i.replace(/^\/*/,"/"),o=ce.useMemo(()=>({basename:a,navigator:s,static:r,future:{}}),[a,s,r]);typeof t=="string"&&(t=Eg(t));let{pathname:l="/",search:c="",hash:h="",state:d=null,key:m="default"}=t,y=ce.useMemo(()=>{let x=zf(l,a);return x==null?null:{location:{pathname:x,search:c,hash:h,state:d,key:m},navigationType:n}},[a,l,c,h,d,m,n]);return Kc(y!=null,`<Router basename="${a}"> is not able to match the URL "${l}${c}${h}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:ce.createElement(vh.Provider,{value:o},ce.createElement(wE.Provider,{children:e,value:y}))}function jK({children:i,location:e}){return OK(HD(i),e)}function HD(i,e=[]){let t=[];return ce.Children.forEach(i,(n,s)=>{if(!ce.isValidElement(n))return;let r=[...e,s];if(n.type===ce.Fragment){t.push.apply(t,HD(n.props.children,r));return}Bs(n.type===sy,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Bs(!n.props.index||!n.props.children,"An index route cannot have child routes.");let a={id:n.props.id||r.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=HD(n.props.children,r)),t.push(a)}),t}var AT="get",ET="application/x-www-form-urlencoded";function Iw(i){return i!=null&&typeof i.tagName=="string"}function qK(i){return Iw(i)&&i.tagName.toLowerCase()==="button"}function QK(i){return Iw(i)&&i.tagName.toLowerCase()==="form"}function $K(i){return Iw(i)&&i.tagName.toLowerCase()==="input"}function JK(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function ZK(i,e){return i.button===0&&(!e||e==="_self")&&!JK(i)}var B_=null;function eW(){if(B_===null)try{new FormData(document.createElement("form"),0),B_=!1}catch{B_=!0}return B_}var tW=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function wC(i){return i!=null&&!tW.has(i)?(Kc(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ET}"`),null):i}function nW(i,e){let t,n,s,r,a;if(QK(i)){let o=i.getAttribute("action");n=o?zf(o,e):null,t=i.getAttribute("method")||AT,s=wC(i.getAttribute("enctype"))||ET,r=new FormData(i)}else if(qK(i)||$K(i)&&(i.type==="submit"||i.type==="image")){let o=i.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=i.getAttribute("formaction")||o.getAttribute("action");if(n=l?zf(l,e):null,t=i.getAttribute("formmethod")||o.getAttribute("method")||AT,s=wC(i.getAttribute("formenctype"))||wC(o.getAttribute("enctype"))||ET,r=new FormData(o,i),!eW()){let{name:c,type:h,value:d}=i;if(h==="image"){let m=c?`${c}.`:"";r.append(`${m}x`,"0"),r.append(`${m}y`,"0")}else c&&r.append(c,d)}}else{if(Iw(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=AT,n=null,s=ET,a=i}return r&&s==="text/plain"&&(a=r,r=void 0),{action:n,method:t.toLowerCase(),encType:s,formData:r,body:a}}function UI(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}async function iW(i,e){if(i.id in e)return e[i.id];try{let t=await import(i.module);return e[i.id]=t,t}catch(t){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function sW(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function rW(i,e,t){let n=await Promise.all(i.map(async s=>{let r=e.routes[s.route.id];if(r){let a=await iW(r,t);return a.links?a.links():[]}return[]}));return cW(n.flat(1).filter(sW).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function iN(i,e,t,n,s,r){let a=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,o=(l,c)=>{var h;return t[c].pathname!==l.pathname||((h=t[c].route.path)==null?void 0:h.endsWith("*"))&&t[c].params["*"]!==l.params["*"]};return r==="assets"?e.filter((l,c)=>a(l,c)||o(l,c)):r==="data"?e.filter((l,c)=>{var d;let h=n.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(a(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((d=t[0])==null?void 0:d.params)||{},nextUrl:new URL(i,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function aW(i,e,{includeHydrateFallback:t}={}){return oW(i.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let r=[s.module];return s.clientActionModule&&(r=r.concat(s.clientActionModule)),s.clientLoaderModule&&(r=r.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(r=r.concat(s.hydrateFallbackModule)),s.imports&&(r=r.concat(s.imports)),r}).flat(1))}function oW(i){return[...new Set(i)]}function lW(i){let e={},t=Object.keys(i).sort();for(let n of t)e[n]=i[n];return e}function cW(i,e){let t=new Set;return new Set(e),i.reduce((n,s)=>{let r=JSON.stringify(lW(s));return t.has(r)||(t.add(r),n.push({key:r,link:s})),n},[])}function uW(i,e){let t=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return t.pathname==="/"?t.pathname="_root.data":e&&zf(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function F5(){let i=ce.useContext(Yv);return UI(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function hW(){let i=ce.useContext(Lw);return UI(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var kI=ce.createContext(void 0);kI.displayName="FrameworkContext";function H5(){let i=ce.useContext(kI);return UI(i,"You must render this element inside a <HydratedRouter> element"),i}function fW(i,e){let t=ce.useContext(kI),[n,s]=ce.useState(!1),[r,a]=ce.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:h,onTouchStart:d}=e,m=ce.useRef(null);ce.useEffect(()=>{if(i==="render"&&a(!0),i==="viewport"){let _=A=>{A.forEach(T=>{a(T.isIntersecting)})},b=new IntersectionObserver(_,{threshold:.5});return m.current&&b.observe(m.current),()=>{b.disconnect()}}},[i]),ce.useEffect(()=>{if(n){let _=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(_)}}},[n]);let y=()=>{s(!0)},x=()=>{s(!1),a(!1)};return t?i!=="intent"?[r,m,{}]:[r,m,{onFocus:gb(o,y),onBlur:gb(l,x),onMouseEnter:gb(c,y),onMouseLeave:gb(h,x),onTouchStart:gb(d,y)}]:[!1,m,{}]}function gb(i,e){return t=>{i&&i(t),t.defaultPrevented||e(t)}}function dW({page:i,...e}){let{router:t}=F5(),n=ce.useMemo(()=>M5(t.routes,i,t.basename),[t.routes,i,t.basename]);return n?ce.createElement(mW,{page:i,matches:n,...e}):null}function pW(i){let{manifest:e,routeModules:t}=H5(),[n,s]=ce.useState([]);return ce.useEffect(()=>{let r=!1;return rW(i,e,t).then(a=>{r||s(a)}),()=>{r=!0}},[i,e,t]),n}function mW({page:i,matches:e,...t}){let n=Xf(),{manifest:s,routeModules:r}=H5(),{basename:a}=F5(),{loaderData:o,matches:l}=hW(),c=ce.useMemo(()=>iN(i,e,l,s,n,"data"),[i,e,l,s,n]),h=ce.useMemo(()=>iN(i,e,l,s,n,"assets"),[i,e,l,s,n]),d=ce.useMemo(()=>{if(i===n.pathname+n.search+n.hash)return[];let x=new Set,_=!1;if(e.forEach(A=>{var w;let T=s.routes[A.route.id];!T||!T.hasLoader||(!c.some(R=>R.route.id===A.route.id)&&A.route.id in o&&((w=r[A.route.id])!=null&&w.shouldRevalidate)||T.hasClientLoader?_=!0:x.add(A.route.id))}),x.size===0)return[];let b=uW(i,a);return _&&x.size>0&&b.searchParams.set("_routes",e.filter(A=>x.has(A.route.id)).map(A=>A.route.id).join(",")),[b.pathname+b.search]},[a,o,n,s,c,e,i,r]),m=ce.useMemo(()=>aW(h,s),[h,s]),y=pW(h);return ce.createElement(ce.Fragment,null,d.map(x=>ce.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...t})),m.map(x=>ce.createElement("link",{key:x,rel:"modulepreload",href:x,...t})),y.map(({key:x,link:_})=>ce.createElement("link",{key:x,..._})))}function gW(...i){return e=>{i.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var G5=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{G5&&(window.__reactRouterVersion="7.4.0")}catch{}function yW({basename:i,children:e,window:t}){let n=ce.useRef();n.current==null&&(n.current=aK({window:t,v5Compat:!0}));let s=n.current,[r,a]=ce.useState({action:s.action,location:s.location}),o=ce.useCallback(l=>{ce.startTransition(()=>a(l))},[a]);return ce.useLayoutEffect(()=>s.listen(o),[s,o]),ce.createElement(XK,{basename:i,children:e,location:r.location,navigationType:r.action,navigator:s})}var z5=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Bw=ce.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:s,reloadDocument:r,replace:a,state:o,target:l,to:c,preventScrollReset:h,viewTransition:d,...m},y){let{basename:x}=ce.useContext(vh),_=typeof c=="string"&&z5.test(c),b,A=!1;if(typeof c=="string"&&_&&(b=c,G5))try{let B=new URL(window.location.href),L=c.startsWith("//")?new URL(B.protocol+c):new URL(c),F=zf(L.pathname,x);L.origin===B.origin&&F!=null?c=F+L.search+L.hash:A=!0}catch{Kc(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let T=IK(c,{relative:s}),[w,R,O]=fW(n,m),N=AW(c,{replace:a,state:o,target:l,preventScrollReset:h,relative:s,viewTransition:d});function U(B){e&&e(B),B.defaultPrevented||N(B)}let P=ce.createElement("a",{...m,...O,href:b||T,onClick:A||r?e:U,ref:gW(y,R),target:l,"data-discover":!_&&t==="render"?"true":void 0});return w&&!_?ce.createElement(ce.Fragment,null,P,ce.createElement(dW,{page:T})):P});Bw.displayName="Link";var vW=ce.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:s=!1,style:r,to:a,viewTransition:o,children:l,...c},h){let d=CE(a,{relative:c.relative}),m=Xf(),y=ce.useContext(Lw),{navigator:x,basename:_}=ce.useContext(vh),b=y!=null&&wW(d)&&o===!0,A=x.encodeLocation?x.encodeLocation(d).pathname:d.pathname,T=m.pathname,w=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;t||(T=T.toLowerCase(),w=w?w.toLowerCase():null,A=A.toLowerCase()),w&&_&&(w=zf(w,_)||w);const R=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let O=T===A||!s&&T.startsWith(A)&&T.charAt(R)==="/",N=w!=null&&(w===A||!s&&w.startsWith(A)&&w.charAt(A.length)==="/"),U={isActive:O,isPending:N,isTransitioning:b},P=O?e:void 0,B;typeof n=="function"?B=n(U):B=[n,O?"active":null,N?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let L=typeof r=="function"?r(U):r;return ce.createElement(Bw,{...c,"aria-current":P,className:B,ref:h,style:L,to:a,viewTransition:o},typeof l=="function"?l(U):l)});vW.displayName="NavLink";var xW=ce.forwardRef(({discover:i="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:s,state:r,method:a=AT,action:o,onSubmit:l,relative:c,preventScrollReset:h,viewTransition:d,...m},y)=>{let x=SW(),_=TW(o,{relative:c}),b=a.toLowerCase()==="get"?"get":"post",A=typeof o=="string"&&z5.test(o),T=w=>{if(l&&l(w),w.defaultPrevented)return;w.preventDefault();let R=w.nativeEvent.submitter,O=(R==null?void 0:R.getAttribute("formmethod"))||a;x(R||w.currentTarget,{fetcherKey:e,method:O,navigate:t,replace:s,state:r,relative:c,preventScrollReset:h,viewTransition:d})};return ce.createElement("form",{ref:y,method:b,action:_,onSubmit:n?l:T,...m,"data-discover":!A&&i==="render"?"true":void 0})});xW.displayName="Form";function bW(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function V5(i){let e=ce.useContext(Yv);return Bs(e,bW(i)),e}function AW(i,{target:e,replace:t,state:n,preventScrollReset:s,relative:r,viewTransition:a}={}){let o=N5(),l=Xf(),c=CE(i,{relative:r});return ce.useCallback(h=>{if(ZK(h,e)){h.preventDefault();let d=t!==void 0?t:DA(l)===DA(c);o(i,{replace:d,state:n,preventScrollReset:s,relative:r,viewTransition:a})}},[l,o,c,t,n,e,i,s,r,a])}var EW=0,_W=()=>`__${String(++EW)}__`;function SW(){let{router:i}=V5("useSubmit"),{basename:e}=ce.useContext(vh),t=VK();return ce.useCallback(async(n,s={})=>{let{action:r,method:a,encType:o,formData:l,body:c}=nW(n,e);if(s.navigate===!1){let h=s.fetcherKey||_W();await i.fetch(h,t,s.action||r,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||a,formEncType:s.encType||o,flushSync:s.flushSync})}else await i.navigate(s.action||r,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||a,formEncType:s.encType||o,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[i,e,t])}function TW(i,{relative:e}={}){let{basename:t}=ce.useContext(vh),n=ce.useContext(Wf);Bs(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),r={...CE(i||".",{relative:e})},a=Xf();if(i==null){r.search=a.search;let o=new URLSearchParams(r.search),l=o.getAll("index");if(l.some(h=>h==="")){o.delete("index"),l.filter(d=>d).forEach(d=>o.append("index",d));let h=o.toString();r.search=h?`?${h}`:""}}return(!i||i===".")&&s.route.index&&(r.search=r.search?r.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(r.pathname=r.pathname==="/"?t:Nf([t,r.pathname])),DA(r)}function wW(i,e={}){let t=ce.useContext(B5);Bs(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=V5("useViewTransitionState"),s=CE(i,{relative:e.relative});if(!t.isTransitioning)return!1;let r=zf(t.currentLocation.pathname,n)||t.currentLocation.pathname,a=zf(t.nextLocation.pathname,n)||t.nextLocation.pathname;return QT(s.pathname,a)!=null||QT(s.pathname,r)!=null}new TextEncoder;const Uu=({to:i,children:e})=>{const n=Xf().pathname===i;return Re.jsx(Bw,{to:i,className:`px-4 py-2 text-cyan-300 text-neon-soft transition ${n?"underline text-white":"hover:text-white hover:underline"}`,children:e})};function MW(){const i=Xf(),[e,t]=ce.useState(!1),s=["/","/LiveStream","/CryptoMarket"].includes(i.pathname);return Re.jsxs("nav",{className:`bg-black p-4 flex items-center justify-between fixed top-0 left-0 w-full h-[90px] z-40 text-white ${s?"shadow-lg shadow-cyan-500/30":""}`,children:[Re.jsx(Bw,{to:"/",className:"text-4xl font-bold text-neon",children:"Cyber Park"}),Re.jsx("button",{onClick:()=>t(!e),className:"md:hidden text-cyan-300 text-3xl focus:outline-none",children:"☰"}),Re.jsxs("div",{className:"hidden md:flex items-center space-x-6",children:[Re.jsx(Uu,{to:"/",children:"Home"}),Re.jsx(Uu,{to:"/LiveStream",children:"LiveStream"}),Re.jsx(Uu,{to:"/CryptoMarket",children:"CryptoMarket"}),Re.jsx(Uu,{to:"/BlackjackTable",children:"BlackjackTable"}),Re.jsx(Uu,{to:"/CyberCity",children:"CyberCity"})]}),e&&Re.jsxs("div",{className:"absolute top-[90px] left-0 w-full bg-black z-30 md:hidden flex flex-col shadow-lg shadow-cyan-500/30 border-glow-top",children:[Re.jsx(Uu,{to:"/",children:"Home"}),Re.jsx(Uu,{to:"/LiveStream",children:"LiveStream"}),Re.jsx(Uu,{to:"/CryptoMarket",children:"CryptoMarket"}),Re.jsx(Uu,{to:"/BlackjackTable",children:"BlackjackTable"}),Re.jsx(Uu,{to:"/NeonScene",children:"NeonScene"})]})]})}const Vt=Number.isFinite||function(i){return typeof i=="number"&&isFinite(i)},CW=Number.isSafeInteger||function(i){return typeof i=="number"&&Math.abs(i)<=RW},RW=Number.MAX_SAFE_INTEGER||9007199254740991;let nn=function(i){return i.NETWORK_ERROR="networkError",i.MEDIA_ERROR="mediaError",i.KEY_SYSTEM_ERROR="keySystemError",i.MUX_ERROR="muxError",i.OTHER_ERROR="otherError",i}({}),Pe=function(i){return i.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",i.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",i.KEY_SYSTEM_NO_SESSION="keySystemNoSession",i.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",i.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",i.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",i.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",i.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",i.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",i.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",i.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",i.MANIFEST_LOAD_ERROR="manifestLoadError",i.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",i.MANIFEST_PARSING_ERROR="manifestParsingError",i.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",i.LEVEL_EMPTY_ERROR="levelEmptyError",i.LEVEL_LOAD_ERROR="levelLoadError",i.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",i.LEVEL_PARSING_ERROR="levelParsingError",i.LEVEL_SWITCH_ERROR="levelSwitchError",i.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",i.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",i.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",i.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",i.FRAG_LOAD_ERROR="fragLoadError",i.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",i.FRAG_DECRYPT_ERROR="fragDecryptError",i.FRAG_PARSING_ERROR="fragParsingError",i.FRAG_GAP="fragGap",i.REMUX_ALLOC_ERROR="remuxAllocError",i.KEY_LOAD_ERROR="keyLoadError",i.KEY_LOAD_TIMEOUT="keyLoadTimeOut",i.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",i.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",i.BUFFER_APPEND_ERROR="bufferAppendError",i.BUFFER_APPENDING_ERROR="bufferAppendingError",i.BUFFER_STALLED_ERROR="bufferStalledError",i.BUFFER_FULL_ERROR="bufferFullError",i.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",i.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",i.ASSET_LIST_LOAD_ERROR="assetListLoadError",i.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",i.ASSET_LIST_PARSING_ERROR="assetListParsingError",i.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",i.INTERNAL_EXCEPTION="internalException",i.INTERNAL_ABORTED="aborted",i.ATTACH_MEDIA_ERROR="attachMediaError",i.UNKNOWN="unknown",i}({}),H=function(i){return i.MEDIA_ATTACHING="hlsMediaAttaching",i.MEDIA_ATTACHED="hlsMediaAttached",i.MEDIA_DETACHING="hlsMediaDetaching",i.MEDIA_DETACHED="hlsMediaDetached",i.MEDIA_ENDED="hlsMediaEnded",i.STALL_RESOLVED="hlsStallResolved",i.BUFFER_RESET="hlsBufferReset",i.BUFFER_CODECS="hlsBufferCodecs",i.BUFFER_CREATED="hlsBufferCreated",i.BUFFER_APPENDING="hlsBufferAppending",i.BUFFER_APPENDED="hlsBufferAppended",i.BUFFER_EOS="hlsBufferEos",i.BUFFERED_TO_END="hlsBufferedToEnd",i.BUFFER_FLUSHING="hlsBufferFlushing",i.BUFFER_FLUSHED="hlsBufferFlushed",i.MANIFEST_LOADING="hlsManifestLoading",i.MANIFEST_LOADED="hlsManifestLoaded",i.MANIFEST_PARSED="hlsManifestParsed",i.LEVEL_SWITCHING="hlsLevelSwitching",i.LEVEL_SWITCHED="hlsLevelSwitched",i.LEVEL_LOADING="hlsLevelLoading",i.LEVEL_LOADED="hlsLevelLoaded",i.LEVEL_UPDATED="hlsLevelUpdated",i.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",i.LEVELS_UPDATED="hlsLevelsUpdated",i.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",i.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",i.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",i.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",i.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",i.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",i.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",i.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",i.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",i.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",i.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",i.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",i.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",i.CUES_PARSED="hlsCuesParsed",i.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",i.INIT_PTS_FOUND="hlsInitPtsFound",i.FRAG_LOADING="hlsFragLoading",i.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",i.FRAG_LOADED="hlsFragLoaded",i.FRAG_DECRYPTED="hlsFragDecrypted",i.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",i.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",i.FRAG_PARSING_METADATA="hlsFragParsingMetadata",i.FRAG_PARSED="hlsFragParsed",i.FRAG_BUFFERED="hlsFragBuffered",i.FRAG_CHANGED="hlsFragChanged",i.FPS_DROP="hlsFpsDrop",i.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",i.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",i.ERROR="hlsError",i.DESTROYING="hlsDestroying",i.KEY_LOADING="hlsKeyLoading",i.KEY_LOADED="hlsKeyLoaded",i.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",i.BACK_BUFFER_REACHED="hlsBackBufferReached",i.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",i.ASSET_LIST_LOADING="hlsAssetListLoading",i.ASSET_LIST_LOADED="hlsAssetListLoaded",i.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",i.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",i.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",i.INTERSTITIAL_STARTED="hlsInterstitialStarted",i.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",i.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",i.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",i.INTERSTITIAL_ENDED="hlsInterstitialEnded",i.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",i.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",i.EVENT_CUE_ENTER="hlsEventCueEnter",i}({});var $n={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Zt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class w2{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class DW{constructor(e,t,n,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new w2(e),this.fast_=new w2(t),this.defaultTTFB_=s,this.ttfb_=new w2(e)}update(e,t){const{slow_:n,fast_:s,ttfb_:r}=this;n.halfLife!==e&&(this.slow_=new w2(e,n.getEstimate(),n.getTotalWeight())),s.halfLife!==t&&(this.fast_=new w2(t,s.getEstimate(),s.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new w2(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,s=e/1e3,r=n/s;this.fast_.sample(s,r),this.slow_.sample(s,r)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function LW(i,e,t){return(e=BW(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Yi(){return Yi=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Yi.apply(null,arguments)}function sN(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),t.push.apply(t,n)}return t}function Pi(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?sN(Object(t),!0).forEach(function(n){LW(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):sN(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function IW(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function BW(i){var e=IW(i,"string");return typeof e=="symbol"?e:e+""}class jf{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const n=`[${e}]:`;this.trace=n0,this.debug=t.debug.bind(null,n),this.log=t.log.bind(null,n),this.warn=t.warn.bind(null,n),this.info=t.info.bind(null,n),this.error=t.error.bind(null,n)}}const n0=function(){},OW={trace:n0,debug:n0,log:n0,warn:n0,info:n0,error:n0};function GD(){return Yi({},OW)}function PW(i,e){const t=self.console[i];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${i}] >`):n0}function rN(i,e,t){return e[i]?e[i].bind(e):PW(i,t)}const zD=GD();function NW(i,e,t){const n=GD();if(typeof console=="object"&&i===!0||typeof i=="object"){const s=["debug","log","info","warn","error"];s.forEach(r=>{n[r]=rN(r,i,t)});try{n.log(`Debug logs enabled for "${e}" in hls.js version 1.6.2`)}catch{return GD()}s.forEach(r=>{zD[r]=rN(r,i)})}else Yi(zD,n);return n}const oi=zD;function L0(i=!0){return typeof self>"u"?void 0:(i||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function UW(i){return typeof self<"u"&&i===self.ManagedMediaSource}function Y5(i,e){const t=Object.keys(i),n=Object.keys(e),s=t.length,r=n.length;return!s||!r||s===r&&!t.some(a=>n.indexOf(a)===-1)}function el(i,e=!1){if(typeof TextDecoder<"u"){const c=new TextDecoder("utf-8").decode(i);if(e){const h=c.indexOf("\0");return h!==-1?c.substring(0,h):c}return c.replace(/\0/g,"")}const t=i.length;let n,s,r,a="",o=0;for(;o<t;){if(n=i[o++],n===0&&e)return a;if(n===0||n===3)continue;switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(n);break;case 12:case 13:s=i[o++],a+=String.fromCharCode((n&31)<<6|s&63);break;case 14:s=i[o++],r=i[o++],a+=String.fromCharCode((n&15)<<12|(s&63)<<6|(r&63)<<0);break}}return a}const Wu={hexDump:function(i){let e="";for(let t=0;t<i.length;t++){let n=i[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}};function kW(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var MC={exports:{}},aN;function FW(){return aN||(aN=1,function(i,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,s=/^(?=([^\/?#]*))\1([^]*)$/,r=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(l,c,h){if(h=h||{},l=l.trim(),c=c.trim(),!c){if(!h.alwaysNormalize)return l;var d=o.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");return d.path=o.normalizePath(d.path),o.buildURLFromParts(d)}var m=o.parseURL(c);if(!m)throw new Error("Error trying to parse relative URL.");if(m.scheme)return h.alwaysNormalize?(m.path=o.normalizePath(m.path),o.buildURLFromParts(m)):c;var y=o.parseURL(l);if(!y)throw new Error("Error trying to parse base URL.");if(!y.netLoc&&y.path&&y.path[0]!=="/"){var x=s.exec(y.path);y.netLoc=x[1],y.path=x[2]}y.netLoc&&!y.path&&(y.path="/");var _={scheme:y.scheme,netLoc:m.netLoc,path:null,params:m.params,query:m.query,fragment:m.fragment};if(!m.netLoc&&(_.netLoc=y.netLoc,m.path[0]!=="/"))if(!m.path)_.path=y.path,m.params||(_.params=y.params,m.query||(_.query=y.query));else{var b=y.path,A=b.substring(0,b.lastIndexOf("/")+1)+m.path;_.path=o.normalizePath(A)}return _.path===null&&(_.path=h.alwaysNormalize?o.normalizePath(m.path):m.path),o.buildURLFromParts(_)},parseURL:function(l){var c=n.exec(l);return c?{scheme:c[1]||"",netLoc:c[2]||"",path:c[3]||"",params:c[4]||"",query:c[5]||"",fragment:c[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(r,"");l.length!==(l=l.replace(a,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};i.exports=o})()}(MC)),MC.exports}var FI=FW();class HI{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Vi={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class K5{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,GW(this,"stats")}setByteRange(e,t){const n=e.split("@",2);let s;n.length===1?s=(t==null?void 0:t.byteRangeEndOffset)||0:s=parseInt(n[1]),this._byteRange=[s,parseInt(n[0])+s]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[Vi.AUDIO]:null,[Vi.VIDEO]:null,[Vi.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new HI),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=FI.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Vi.AUDIO]=null,e[Vi.VIDEO]=null,e[Vi.AUDIOVIDEO]=null}}function zr(i){return i.sn!=="initSegment"}let CC=class extends K5{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange){const e=this.byteRange[0],t=this.byteRange[1];if(Vt(e)&&Vt(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(n.length===1)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=Vt(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),n=t.length;if(n>1||n===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!Vt(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return zr(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,s,r,a=!1){const{elementaryStreams:o}=this,l=o[e];if(!l){o[e]={startPTS:t,endPTS:n,startDTS:s,endDTS:r,partial:a};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,n),l.startDTS=Math.min(l.startDTS,s),l.endDTS=Math.max(l.endDTS,r)}};class HW extends K5{constructor(e,t,n,s,r){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=s;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function W5(i,e){const t=Object.getPrototypeOf(i);if(t){const n=Object.getOwnPropertyDescriptor(t,e);return n||W5(t,e)}}function GW(i,e){const t=W5(i,e);t&&(t.enumerable=!0,Object.defineProperty(i,e,t))}const $T=Math.pow(2,32)-1,zW=[].push,X5={video:1,audio:2,id3:3,text:4};function Sr(i){return String.fromCharCode.apply(null,i)}function j5(i,e){const t=i[e]<<8|i[e+1];return t<0?65536+t:t}function dn(i,e){const t=q5(i,e);return t<0?4294967296+t:t}function oN(i,e){let t=dn(i,e);return t*=Math.pow(2,32),t+=dn(i,e+4),t}function q5(i,e){return i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}function RC(i,e,t){i[e]=t>>24,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=t&255}function VW(i){const e=i.byteLength;for(let t=0;t<e;){const n=dn(i,t);if(n>8&&i[t+4]===109&&i[t+5]===111&&i[t+6]===111&&i[t+7]===102)return!0;t=n>1?t+n:e}return!1}function Cn(i,e){const t=[];if(!e.length)return t;const n=i.byteLength;for(let s=0;s<n;){const r=dn(i,s),a=Sr(i.subarray(s+4,s+8)),o=r>1?s+r:n;if(a===e[0])if(e.length===1)t.push(i.subarray(s+8,o));else{const l=Cn(i.subarray(s+8,o),e.slice(1));l.length&&zW.apply(t,l)}s=o}return t}function YW(i){const e=[],t=i[0];let n=8;const s=dn(i,n);n+=4;let r=0,a=0;t===0?(r=dn(i,n),a=dn(i,n+4),n+=8):(r=oN(i,n),a=oN(i,n+8),n+=16),n+=2;let o=i.length+a;const l=j5(i,n);n+=2;for(let c=0;c<l;c++){let h=n;const d=dn(i,h);h+=4;const m=d&2147483647;if((d&2147483648)>>>31===1)return oi.warn("SIDX has hierarchical references (not supported)"),null;const x=dn(i,h);h+=4,e.push({referenceSize:m,subsegmentDuration:x,info:{duration:x/s,start:o,end:o+m-1}}),o+=m,h+=4,n=h}return{earliestPresentationTime:r,timescale:s,version:t,referencesCount:l,references:e}}function Q5(i){const e=[],t=Cn(i,["moov","trak"]);for(let s=0;s<t.length;s++){const r=t[s],a=Cn(r,["tkhd"])[0];if(a){let o=a[0];const l=dn(a,o===0?12:20),c=Cn(r,["mdia","mdhd"])[0];if(c){o=c[0];const h=dn(c,o===0?12:20),d=Cn(r,["mdia","hdlr"])[0];if(d){const m=Sr(d.subarray(8,12)),y={soun:Vi.AUDIO,vide:Vi.VIDEO}[m],x=Cn(r,["mdia","minf","stbl","stsd"])[0],_=KW(x);y?(e[l]={timescale:h,type:y,stsd:_},e[y]=Pi({timescale:h,id:l},_)):e[l]={timescale:h,type:m,stsd:_}}}}}return Cn(i,["moov","mvex","trex"]).forEach(s=>{const r=dn(s,4),a=e[r];a&&(a.default={duration:dn(s,12),flags:dn(s,20)})}),e}function KW(i){const e=i.subarray(8),t=e.subarray(86),n=Sr(e.subarray(4,8));let s=n,r;const a=n==="enca"||n==="encv";if(a){const c=Cn(e,[n])[0].subarray(n==="enca"?28:78);Cn(c,["sinf"]).forEach(d=>{const m=Cn(d,["schm"])[0];if(m){const y=Sr(m.subarray(4,8));if(y==="cbcs"||y==="cenc"){const x=Cn(d,["frma"])[0];x&&(s=Sr(x))}}})}const o=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const l=Cn(t,["avcC"])[0];l&&l.length>3&&(s+="."+P_(l[1])+P_(l[2])+P_(l[3]),r=O_(o==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const l=Cn(e,[n])[0],c=Cn(l.subarray(28),["esds"])[0];if(c&&c.length>7){let h=4;if(c[h++]!==3)break;h=DC(c,h),h+=2;const d=c[h++];if(d&128&&(h+=2),d&64&&(h+=c[h++]),c[h++]!==4)break;h=DC(c,h);const m=c[h++];if(m===64)s+="."+P_(m);else break;if(h+=12,c[h++]!==5)break;h=DC(c,h);const y=c[h++];let x=(y&248)>>3;x===31&&(x+=1+((y&7)<<3)+((c[h]&224)>>5)),s+="."+x}break}case"hvc1":case"hev1":{const l=Cn(t,["hvcC"])[0];if(l&&l.length>12){const c=l[1],h=["","A","B","C"][c>>6],d=c&31,m=dn(l,2),y=(c&32)>>5?"H":"L",x=l[12],_=l.subarray(6,12);s+="."+h+d,s+="."+m.toString(16).toUpperCase(),s+="."+y+x;let b="";for(let A=_.length;A--;){const T=_[A];(T||b)&&(b="."+T.toString(16).toUpperCase()+b)}s+=b}r=O_(o=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{s=O_(s,t)||s;break}case"vp09":{const l=Cn(t,["vpcC"])[0];if(l&&l.length>6){const c=l[4],h=l[5],d=l[6]>>4&15;s+="."+Yu(c)+"."+Yu(h)+"."+Yu(d)}break}case"av01":{const l=Cn(t,["av1C"])[0];if(l&&l.length>2){const c=l[1]>>>5,h=l[1]&31,d=l[2]>>>7?"H":"M",m=(l[2]&64)>>6,y=(l[2]&32)>>5,x=c===2&&m?y?12:10:m?10:8,_=(l[2]&16)>>4,b=(l[2]&8)>>3,A=(l[2]&4)>>2,T=l[2]&3;s+="."+c+"."+Yu(h)+d+"."+Yu(x)+"."+_+"."+b+A+T+"."+Yu(1)+"."+Yu(1)+"."+Yu(1)+"."+0,r=O_("dav1",t)}break}}return{codec:s,encrypted:a,supplemental:r}}function O_(i,e){const t=Cn(e,["dvvC"]),n=t.length?t[0]:Cn(e,["dvcC"])[0];if(n){const s=n[2]>>1&127,r=n[2]<<5&32|n[3]>>3&31;return i+"."+Yu(s)+"."+Yu(r)}}function DC(i,e){const t=e+5;for(;i[e++]&128&&e<t;);return e}function P_(i){return("0"+i.toString(16).toUpperCase()).slice(-2)}function Yu(i){return(i<10?"0":"")+i}function WW(i,e){if(!i||!e)return i;const t=e.keyId;return t&&e.isCommonEncryption&&Cn(i,["moov","trak"]).forEach(s=>{const a=Cn(s,["mdia","minf","stbl","stsd"])[0].subarray(8);let o=Cn(a,["enca"]);const l=o.length>0;l||(o=Cn(a,["encv"])),o.forEach(c=>{const h=l?c.subarray(28):c.subarray(78);Cn(h,["sinf"]).forEach(m=>{const y=$5(m);if(y){const x=y.subarray(8,24);x.some(_=>_!==0)||(oi.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${Wu.hexDump(x)} -> ${Wu.hexDump(t)}`),y.set(t,8))}})})}),i}function $5(i){const e=Cn(i,["schm"])[0];if(e){const t=Sr(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return Cn(i,["schi","tenc"])[0]}return null}function XW(i,e){return Cn(e,["moof","traf"]).reduce((t,n)=>{const s=Cn(n,["tfdt"])[0],r=s[0],a=Cn(n,["tfhd"]).reduce((o,l)=>{const c=dn(l,4),h=i[c];if(h){let d=dn(s,4);if(r===1){if(d===$T)return oi.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),o;d*=$T+1,d+=dn(s,8)}const m=h.timescale||9e4,y=d/m;if(Vt(y)&&(o===null||y<o))return y}return o},null);return a!==null&&Vt(a)&&(t===null||a<t)?a:t},null)}function jW(i,e){let t=0,n=0,s=0;const r=Cn(i,["moof","traf"]);for(let a=0;a<r.length;a++){const o=r[a],l=Cn(o,["tfhd"])[0],c=dn(l,4),h=e[c];if(!h)continue;const d=h.default,m=dn(l,0)|(d==null?void 0:d.flags);let y=d==null?void 0:d.duration;m&8&&(m&2?y=dn(l,12):y=dn(l,8));const x=h.timescale||9e4,_=Cn(o,["trun"]);for(let b=0;b<_.length;b++){if(t=qW(_[b]),!t&&y){const A=dn(_[b],4);t=y*A}h.type===Vi.VIDEO?n+=t/x:h.type===Vi.AUDIO&&(s+=t/x)}}if(n===0&&s===0){let a=1/0,o=0,l=0;const c=Cn(i,["sidx"]);for(let h=0;h<c.length;h++){const d=YW(c[h]);if(d!=null&&d.references){a=Math.min(a,d.earliestPresentationTime/d.timescale);const m=d.references.reduce((y,x)=>y+x.info.duration||0,0);o=Math.max(o,m+d.earliestPresentationTime/d.timescale),l=o-a}}if(l&&Vt(l))return l}return n||s}function qW(i){const e=dn(i,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let n=0;const s=dn(i,4);for(let r=0;r<s;r++){if(e&256){const a=dn(i,t);n+=a,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return n}function QW(i,e,t){Cn(e,["moof","traf"]).forEach(n=>{Cn(n,["tfhd"]).forEach(s=>{const r=dn(s,4),a=i[r];if(!a)return;const o=a.timescale||9e4;Cn(n,["tfdt"]).forEach(l=>{const c=l[0],h=t*o;if(h){let d=dn(l,4);if(c===0)d-=h,d=Math.max(d,0),RC(l,4,d);else{d*=Math.pow(2,32),d+=dn(l,8),d-=h,d=Math.max(d,0);const m=Math.floor(d/($T+1)),y=Math.floor(d%($T+1));RC(l,4,m),RC(l,8,y)}}})})})}function $W(i){const e={valid:null,remainder:null},t=Cn(i,["moof"]);if(t.length<2)return e.remainder=i,e;const n=t[t.length-1];return e.valid=i.slice(0,n.byteOffset-8),e.remainder=i.slice(n.byteOffset-8),e}function Fl(i,e){const t=new Uint8Array(i.length+e.length);return t.set(i),t.set(e,i.length),t}function lN(i,e){const t=[],n=e.samples,s=e.timescale,r=e.id;let a=!1;return Cn(n,["moof"]).map(l=>{const c=l.byteOffset-8;Cn(l,["traf"]).map(d=>{const m=Cn(d,["tfdt"]).map(y=>{const x=y[0];let _=dn(y,4);return x===1&&(_*=Math.pow(2,32),_+=dn(y,8)),_/s})[0];return m!==void 0&&(i=m),Cn(d,["tfhd"]).map(y=>{const x=dn(y,4),_=dn(y,0)&16777215,b=(_&1)!==0,A=(_&2)!==0,T=(_&8)!==0;let w=0;const R=(_&16)!==0;let O=0;const N=(_&32)!==0;let U=8;x===r&&(b&&(U+=8),A&&(U+=4),T&&(w=dn(y,U),U+=4),R&&(O=dn(y,U),U+=4),N&&(U+=4),e.type==="video"&&(a=Ow(e.codec)),Cn(d,["trun"]).map(P=>{const B=P[0],L=dn(P,0)&16777215,F=(L&1)!==0;let j=0;const J=(L&4)!==0,re=(L&256)!==0;let q=0;const W=(L&512)!==0;let ne=0;const ie=(L&1024)!==0,ue=(L&2048)!==0;let z=0;const ae=dn(P,4);let ge=8;F&&(j=dn(P,ge),ge+=4),J&&(ge+=4);let Ee=j+c;for(let le=0;le<ae;le++){if(re?(q=dn(P,ge),ge+=4):q=w,W?(ne=dn(P,ge),ge+=4):ne=O,ie&&(ge+=4),ue&&(B===0?z=dn(P,ge):z=q5(P,ge),ge+=4),e.type===Vi.VIDEO){let Ce=0;for(;Ce<ne;){const Me=dn(n,Ee);if(Ee+=4,JW(a,n[Ee])){const Ze=n.subarray(Ee,Ee+Me);GI(Ze,a?2:1,i+z/s,t)}Ee+=Me,Ce+=Me+4}}i+=q/s}}))})})}),t}function Ow(i){if(!i)return!1;const e=i.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function JW(i,e){if(i){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function GI(i,e,t,n){const s=J5(i);let r=0;r+=e;let a=0,o=0,l=0;for(;r<s.length;){a=0;do{if(r>=s.length)break;l=s[r++],a+=l}while(l===255);o=0;do{if(r>=s.length)break;l=s[r++],o+=l}while(l===255);const c=s.length-r;let h=r;if(o<c)r+=o;else if(o>c){oi.error(`Malformed SEI payload. ${o} is too small, only ${c} bytes left to parse.`);break}if(a===4){if(s[h++]===181){const m=j5(s,h);if(h+=2,m===49){const y=dn(s,h);if(h+=4,y===1195456820){const x=s[h++];if(x===3){const _=s[h++],b=31&_,A=64&_,T=A?2+b*3:0,w=new Uint8Array(T);if(A){w[0]=_;for(let R=1;R<T;R++)w[R]=s[h++]}n.push({type:x,payloadType:a,pts:t,bytes:w})}}}}}else if(a===5&&o>16){const d=[];for(let x=0;x<16;x++){const _=s[h++].toString(16);d.push(_.length==1?"0"+_:_),(x===3||x===5||x===7||x===9)&&d.push("-")}const m=o-16,y=new Uint8Array(m);for(let x=0;x<m;x++)y[x]=s[h++];n.push({payloadType:a,pts:t,uuid:d.join(""),userData:el(y),userDataBytes:y})}}}function J5(i){const e=i.byteLength,t=[];let n=1;for(;n<e-2;)i[n]===0&&i[n+1]===0&&i[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return i;const s=e-t.length,r=new Uint8Array(s);let a=0;for(n=0;n<s;a++,n++)a===t[0]&&(a++,t.shift()),r[n]=i[a];return r}function ZW(i){const e=i[0];let t="",n="",s=0,r=0,a=0,o=0,l=0,c=0;if(e===0){for(;Sr(i.subarray(c,c+1))!=="\0";)t+=Sr(i.subarray(c,c+1)),c+=1;for(t+=Sr(i.subarray(c,c+1)),c+=1;Sr(i.subarray(c,c+1))!=="\0";)n+=Sr(i.subarray(c,c+1)),c+=1;n+=Sr(i.subarray(c,c+1)),c+=1,s=dn(i,12),r=dn(i,16),o=dn(i,20),l=dn(i,24),c=28}else if(e===1){c+=4,s=dn(i,c),c+=4;const d=dn(i,c);c+=4;const m=dn(i,c);for(c+=4,a=2**32*d+m,CW(a)||(a=Number.MAX_SAFE_INTEGER,oi.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=dn(i,c),c+=4,l=dn(i,c),c+=4;Sr(i.subarray(c,c+1))!=="\0";)t+=Sr(i.subarray(c,c+1)),c+=1;for(t+=Sr(i.subarray(c,c+1)),c+=1;Sr(i.subarray(c,c+1))!=="\0";)n+=Sr(i.subarray(c,c+1)),c+=1;n+=Sr(i.subarray(c,c+1)),c+=1}const h=i.subarray(c,i.byteLength);return{schemeIdUri:t,value:n,timeScale:s,presentationTime:a,presentationTimeDelta:r,eventDuration:o,id:l,payload:h}}function eX(i,...e){const t=e.length;let n=8,s=t;for(;s--;)n+=e[s].byteLength;const r=new Uint8Array(n);for(r[0]=n>>24&255,r[1]=n>>16&255,r[2]=n>>8&255,r[3]=n&255,r.set(i,4),s=0,n=8;s<t;s++)r.set(e[s],n),n+=e[s].byteLength;return r}function tX(i,e,t){if(i.byteLength!==16)throw new RangeError("Invalid system id");let n,s;n=0,s=new Uint8Array;let r;n>0?(r=new Uint8Array(4),e.length>0&&new DataView(r.buffer).setUint32(0,e.length,!1)):r=new Uint8Array;const a=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(a.buffer).setUint32(0,t.byteLength,!1),eX([112,115,115,104],new Uint8Array([n,0,0,0]),i,r,s,a,t||new Uint8Array)}function nX(i){const e=[];if(i instanceof ArrayBuffer){const t=i.byteLength;let n=0;for(;n+32<t;){const s=new DataView(i,n),r=iX(s);e.push(r),n+=r.size}}return e}function iX(i){const e=i.getUint32(0),t=i.byteOffset,n=i.byteLength;if(n<e)return{offset:t,size:n};if(i.getUint32(4)!==1886614376)return{offset:t,size:e};const r=i.getUint32(8)>>>24;if(r!==0&&r!==1)return{offset:t,size:e};const a=i.buffer,o=Wu.hexDump(new Uint8Array(a,t+12,16)),l=i.getUint32(28);let c=null,h=null;if(r===0){if(e-32<l||l<22)return{offset:t,size:e};h=new Uint8Array(a,t+32,l)}else if(r===1){if(!l||n<t+32+l*16+16)return{offset:t,size:e};c=[];for(let d=0;d<l;d++)c.push(new Uint8Array(a,t+32+d*16,16))}return{version:r,systemId:o,kids:c,data:h,offset:t,size:e}}const Z5=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),gv={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function eH(i,e){const t=gv[e];return!!t&&!!t[i.slice(0,4)]}function VD(i,e,t=!0){return!i.split(",").some(n=>!tH(n,e,t))}function tH(i,e,t=!0){var n;const s=L0(t);return(n=s==null?void 0:s.isTypeSupported(LA(i,e)))!=null?n:!1}function LA(i,e){return`${e}/mp4;codecs=${i}`}function cN(i){if(i){const e=i.substring(0,4);return gv.video[e]}return 2}function JT(i){const e=Z5();return i.split(",").reduce((t,n)=>{const r=e&&Ow(n)?9:gv.video[n];return r?(r*2+t)/(t?3:2):(gv.audio[n]+t)/(t?2:1)},0)}const LC={};function sX(i,e=!0){if(LC[i])return LC[i];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[i];for(let s=0;s<t.length;s++){var n;if(tH(t[s],"audio",e))return LC[i]=t[s],t[s];if(t[s]==="mp3"&&(n=L0(e))!=null&&n.isTypeSupported("audio/mpeg"))return""}return i}const rX=/flac|opus|mp4a\.40\.34/i;function ZT(i,e=!0){return i.replace(rX,t=>sX(t.toLowerCase(),e))}function aX(i,e){const t=[];if(i){const n=i.split(",");for(let s=0;s<n.length;s++)eH(n[s],"video")||t.push(n[s])}return e&&t.push(e),t.join(",")}function _T(i,e){if(i&&(i.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(i)!==-1))return i;if(e){const t=e.split(",");if(t.length>1){if(i){for(let n=t.length;n--;)if(t[n].substring(0,4)===i.substring(0,4))return t[n]}return t[0]}}return e||i}function oX(i){const e=i.split(",");for(let t=0;t<e.length;t++){const n=e[t].split(".");if(n.length>2){let s=n.shift()+".";s+=parseInt(n.shift()).toString(16),s+=("000"+parseInt(n.shift()).toString(16)).slice(-4),e[t]=s}}return e.join(",")}function lX(i){if(i.startsWith("av01.")){const e=i.split("."),t=["0","111","01","01","01","0"];for(let n=e.length;n>4&&n<10;n++)e[n]=t[n-4];return e.join(".")}return i}function uN(i){const e=L0(i)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function nH(i){return i.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const iH={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function sH(i,e){return{supported:!1,configurations:e,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:i}}const hN={};function cX(i,e,t,n,s,r){const a=i.audioCodec?i.audioGroups:null,o=r==null?void 0:r.audioCodec,l=r==null?void 0:r.channels,c=l?parseInt(l):o?1/0:2;let h=null;if(a!=null&&a.length)try{a.length===1&&a[0]?h=e.groups[a[0]].channels:h=a.reduce((d,m)=>{if(m){const y=e.groups[m];if(!y)throw new Error(`Audio track group ${m} not found`);Object.keys(y.channels).forEach(x=>{d[x]=(d[x]||0)+y.channels[x]})}return d},{2:0})}catch{return!0}return i.videoCodec!==void 0&&(i.width>1920&&i.height>1088||i.height>1920&&i.width>1088||i.frameRate>Math.max(n,30)||i.videoRange!=="SDR"&&i.videoRange!==t||i.bitrate>Math.max(s,8e6))||!!h&&Vt(c)&&Object.keys(h).some(d=>parseInt(d)>c)}function rH(i,e,t){const n=i.videoCodec,s=i.audioCodec;if(!n&&!s||!t)return Promise.resolve(iH);const r=[];if(n){const a={width:i.width,height:i.height,bitrate:Math.ceil(Math.max(i.bitrate*.9,i.averageBitrate)),framerate:i.frameRate||30},o=i.videoRange;o!=="SDR"&&(a.transferFunction=o.toLowerCase());const l=n.split(","),c=navigator.userAgent;if(l.some(h=>Ow(h))&&Z5())return Promise.resolve(sH(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: (${c})`),r));r.push.apply(r,l.map(h=>({type:"media-source",video:Pi(Pi({},a),{},{contentType:LA(lX(h),"video")})})))}return s&&i.audioGroups&&i.audioGroups.forEach(a=>{var o;a&&((o=e.groups[a])==null||o.tracks.forEach(l=>{if(l.groupId===a){const c=l.channels||"",h=parseFloat(c);Vt(h)&&h>2&&r.push.apply(r,s.split(",").map(d=>({type:"media-source",audio:{contentType:LA(d,"audio"),channels:""+h}})))}}))}),Promise.all(r.map(a=>{const o=uX(a);return hN[o]||(hN[o]=t.decodingInfo(a))})).then(a=>({supported:!a.some(o=>!o.supported),configurations:r,decodingInfoResults:a})).catch(a=>({supported:!1,configurations:r,decodingInfoResults:[],error:a}))}function uX(i){const{audio:e,video:t}=i,n=t||e;if(n){const s=nH(n.contentType);if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${s}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${s}`}return""}const YD=["NONE","TYPE-0","TYPE-1",null];function hX(i){return YD.indexOf(i)>-1}const e3=["SDR","PQ","HLG"];function fX(i){return!!i&&e3.indexOf(i)>-1}var ST={No:"",Yes:"YES",v2:"v2"};function fN(i){const{canSkipUntil:e,canSkipDateRanges:t,age:n}=i,s=n<e/2;return e&&s?t?ST.v2:ST.Yes:ST.No}class dN{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class IA{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(n=>!!n).map(n=>n.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const n=(t=e.supplemental)==null?void 0:t.videoCodec;n&&n!==e.videoCodec&&(this.codecSet+=`,${n.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return pN(this._audioGroups,e)}hasSubtitleGroup(e){return pN(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function pN(i,e){return!e||!i?!1:i.indexOf(e)!==-1}function dX(){if(typeof matchMedia=="function"){const i=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(i.media!==e.media)return i.matches===!0}return!1}function pX(i,e){let t=!1,n=[];if(i&&(t=i!=="SDR",n=[i]),e){n=e.allowedVideoRanges||e3.slice(0);const s=n.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:s&&dX(),t||(n=["SDR"])}return{preferHDR:t,allowedVideoRanges:n}}const mX=i=>{const e=new WeakSet;return(t,n)=>{if(i&&(n=i(t,n)),typeof n=="object"&&n!==null){if(e.has(n))return;e.add(n)}return n}},xs=(i,e)=>JSON.stringify(i,mX(e));function gX(i,e,t,n,s){const r=Object.keys(i),a=n==null?void 0:n.channels,o=n==null?void 0:n.audioCodec,l=s==null?void 0:s.videoCodec,c=a&&parseInt(a)===2;let h=!1,d=!1,m=1/0,y=1/0,x=1/0,_=1/0,b=0,A=[];const{preferHDR:T,allowedVideoRanges:w}=pX(e,s);for(let P=r.length;P--;){const B=i[r[P]];h||(h=B.channels[2]>0),m=Math.min(m,B.minHeight),y=Math.min(y,B.minFramerate),x=Math.min(x,B.minBitrate),w.filter(F=>B.videoRanges[F]>0).length>0&&(d=!0)}m=Vt(m)?m:0,y=Vt(y)?y:0;const R=Math.max(1080,m),O=Math.max(30,y);x=Vt(x)?x:t,t=Math.max(x,t),d||(e=void 0);const N=r.length>1;return{codecSet:r.reduce((P,B)=>{const L=i[B];if(B===P)return P;if(A=d?w.filter(F=>L.videoRanges[F]>0):[],N){if(L.minBitrate>t)return ku(B,`min bitrate of ${L.minBitrate} > current estimate of ${t}`),P;if(!L.hasDefaultAudio)return ku(B,"no renditions with default or auto-select sound found"),P;if(o&&B.indexOf(o.substring(0,4))%5!==0)return ku(B,`audio codec preference "${o}" not found`),P;if(a&&!c){if(!L.channels[a])return ku(B,`no renditions with ${a} channel sound found (channels options: ${Object.keys(L.channels)})`),P}else if((!o||c)&&h&&L.channels[2]===0)return ku(B,"no renditions with stereo sound found"),P;if(L.minHeight>R)return ku(B,`min resolution of ${L.minHeight} > maximum of ${R}`),P;if(L.minFramerate>O)return ku(B,`min framerate of ${L.minFramerate} > maximum of ${O}`),P;if(!A.some(F=>L.videoRanges[F]>0))return ku(B,`no variants with VIDEO-RANGE of ${xs(A)} found`),P;if(l&&B.indexOf(l.substring(0,4))%5!==0)return ku(B,`video codec preference "${l}" not found`),P;if(L.maxScore<b)return ku(B,`max score of ${L.maxScore} < selected max of ${b}`),P}return P&&(JT(B)>=JT(P)||L.fragmentError>i[P].fragmentError)?P:(_=L.minIndex,b=L.maxScore,B)},void 0),videoRanges:A,preferHDR:T,minFramerate:y,minBitrate:x,minIndex:_}}function ku(i,e){oi.log(`[abr] start candidates with "${i}" ignored because ${e}`)}function aH(i){return i.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const s=t.channels||"2";return n.channels[s]=(n.channels[s]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function yX(i,e,t,n){return i.slice(t,n+1).reduce((s,r,a)=>{if(!r.codecSet)return s;const o=r.audioGroups;let l=s[r.codecSet];l||(s[r.codecSet]=l={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:a,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!o,fragmentError:0}),l.minBitrate=Math.min(l.minBitrate,r.bitrate);const c=Math.min(r.height,r.width);return l.minHeight=Math.min(l.minHeight,c),l.minFramerate=Math.min(l.minFramerate,r.frameRate),l.minIndex=Math.min(l.minIndex,a),l.maxScore=Math.max(l.maxScore,r.score),l.fragmentError+=r.fragmentError,l.videoRanges[r.videoRange]=(l.videoRanges[r.videoRange]||0)+1,o&&o.forEach(h=>{if(!h)return;const d=e.groups[h];d&&(l.hasDefaultAudio=l.hasDefaultAudio||e.hasDefaultAudio?d.hasDefault:d.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(d.channels).forEach(m=>{l.channels[m]=(l.channels[m]||0)+d.channels[m]}))}),s},{})}function mN(i){if(!i)return i;const{lang:e,assocLang:t,characteristics:n,channels:s,audioCodec:r}=i;return{lang:e,assocLang:t,characteristics:n,channels:s,audioCodec:r}}function lh(i,e,t){if("attrs"in i){const n=e.indexOf(i);if(n!==-1)return n}for(let n=0;n<e.length;n++){const s=e[n];if(qm(i,s,t))return n}return-1}function qm(i,e,t){const{groupId:n,name:s,lang:r,assocLang:a,default:o}=i,l=i.forced;return(n===void 0||e.groupId===n)&&(s===void 0||e.name===s)&&(r===void 0||vX(r,e.lang))&&(r===void 0||e.assocLang===a)&&(o===void 0||e.default===o)&&(l===void 0||e.forced===l)&&(!("characteristics"in i)||xX(i.characteristics||"",e.characteristics))&&(t===void 0||t(i,e))}function vX(i,e="--"){return i.length===e.length?i===e:i.startsWith(e)||e.startsWith(i)}function xX(i,e=""){const t=i.split(","),n=e.split(",");return t.length===n.length&&!t.some(s=>n.indexOf(s)===-1)}function tm(i,e){const{audioCodec:t,channels:n}=i;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function bX(i,e,t,n,s){const r=e[n],o=e.reduce((m,y,x)=>{const _=y.uri;return(m[_]||(m[_]=[])).push(x),m},{})[r.uri];o.length>1&&(n=Math.max.apply(Math,o));const l=r.videoRange,c=r.frameRate,h=r.codecSet.substring(0,4),d=gN(e,n,m=>{if(m.videoRange!==l||m.frameRate!==c||m.codecSet.substring(0,4)!==h)return!1;const y=m.audioGroups,x=t.filter(_=>!y||y.indexOf(_.groupId)!==-1);return lh(i,x,s)>-1});return d>-1?d:gN(e,n,m=>{const y=m.audioGroups,x=t.filter(_=>!y||y.indexOf(_.groupId)!==-1);return lh(i,x,s)>-1})}function gN(i,e,t){for(let n=e;n>-1;n--)if(t(i[n]))return n;for(let n=e+1;n<i.length;n++)if(t(i[n]))return n;return-1}function t3(i,e){var t;return!!i&&i!==((t=e.loadLevelObj)==null?void 0:t.uri)}class AX extends jf{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var n;const{fragCurrent:s,partCurrent:r,hls:a}=this,{autoLevelEnabled:o,media:l}=a;if(!s||!l)return;const c=performance.now(),h=r?r.stats:s.stats,d=r?r.duration:s.duration,m=c-h.loading.start,y=a.minAutoLevel,x=s.level,_=this._nextAutoLevel;if(h.aborted||h.loaded&&h.loaded===h.total||x<=y){this.clearTimer(),this._nextAutoLevel=-1;return}if(!o)return;const b=_>-1&&_!==x,A=!!t||b;if(!A&&(l.paused||!l.playbackRate||!l.readyState))return;const T=a.mainForwardBufferInfo;if(!A&&T===null)return;const w=this.bwEstimator.getEstimateTTFB(),R=Math.abs(l.playbackRate);if(m<=Math.max(w,1e3*(d/(R*2))))return;const O=T?T.len/R:0,N=h.loading.first?h.loading.first-h.loading.start:-1,U=h.loaded&&N>-1,P=this.getBwEstimate(),B=a.levels,L=B[x],F=Math.max(h.loaded,Math.round(d*(s.bitrate||L.averageBitrate)/8));let j=U?m-N:m;j<1&&U&&(j=Math.min(m,h.loaded*8/P));const J=U?h.loaded*1e3/j:0,re=w/1e3,q=J?(F-h.loaded)/J:F*8/P+re;if(q<=O)return;const W=J?J*8:P,ne=((n=(t==null?void 0:t.details)||this.hls.latestLevelDetails)==null?void 0:n.live)===!0,ie=this.hls.config.abrBandWidthUpFactor;let ue=Number.POSITIVE_INFINITY,z;for(z=x-1;z>y;z--){const le=B[z].maxBitrate,Ce=!B[z].details||ne;if(ue=this.getTimeToLoadFrag(re,W,d*le,Ce),ue<Math.min(O,d+re))break}if(ue>=q||ue>d*10)return;U?this.bwEstimator.sample(m-Math.min(w,N),h.loaded):this.bwEstimator.sampleTTFB(m);const ae=B[z].maxBitrate;this.getBwEstimate()*ie>ae&&this.resetEstimator(ae);const ge=this.findBestLevel(ae,y,z,0,O,1,1);ge>-1&&(z=ge),this.warn(`Fragment ${s.sn}${r?" part "+r.index:""} of level ${x} is loading too slowly;
      Fragment duration: ${s.duration.toFixed(3)}
      Time to underbuffer: ${O.toFixed(3)} s
      Estimated load time for current fragment: ${q.toFixed(3)} s
      Estimated load time for down switch fragment: ${ue.toFixed(3)} s
      TTFB estimate: ${N|0} ms
      Current BW estimate: ${Vt(P)?P|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${z} @ ${ae|0} bps`),a.nextLoadLevel=a.nextAutoLevel=z,this.clearTimer();const Ee=()=>{if(this.clearTimer(),this.fragCurrent===s&&this.hls.loadLevel===z&&z>0){const le=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${z>0?"and switching down":""}
      Fragment duration: ${s.duration.toFixed(3)} s
      Time to underbuffer: ${le.toFixed(3)} s`),s.abortRequests(),this.fragCurrent=this.partCurrent=null,z>y){let Ce=this.findBestLevel(this.hls.levels[y].bitrate,y,z,0,le,1,1);Ce===-1&&(Ce=y),this.hls.nextLoadLevel=this.hls.nextAutoLevel=Ce,this.resetEstimator(this.hls.levels[Ce].bitrate)}}};b||q>ue*2?Ee():this.timer=self.setInterval(Ee,ue*1e3),a.trigger(H.FRAG_LOAD_EMERGENCY_ABORTED,{frag:s,part:r,stats:h})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new DW(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.FRAG_LOADING,this.onFragLoading,this),e.on(H.FRAG_LOADED,this.onFragLoaded,this),e.on(H.FRAG_BUFFERED,this.onFragBuffered,this),e.on(H.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(H.LEVEL_LOADED,this.onLevelLoaded,this),e.on(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(H.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(H.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.FRAG_LOADING,this.onFragLoading,this),e.off(H.FRAG_LOADED,this.onFragLoaded,this),e.off(H.FRAG_BUFFERED,this.onFragBuffered,this),e.off(H.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(H.LEVEL_LOADED,this.onLevelLoaded,this),e.off(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(H.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(H.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var s;this.fragCurrent=n,this.partCurrent=(s=t.part)!=null?s:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case Pe.BUFFER_ADD_CODEC_ERROR:case Pe.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Pe.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:s,partCurrent:r}=this;if(n&&s&&n.sn===s.sn&&n.level===s.level){const a=performance.now(),o=r?r.stats:n.stats,l=a-o.loading.start,c=o.loading.first?o.loading.first-o.loading.start:-1;if(o.loaded&&c>-1){const d=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(d,c),o.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,t,n,s){const r=e+n/t,a=s?e+this.lastLevelLoadSec:0;return r+a}onLevelLoaded(e,t){const n=this.hls.config,{loading:s}=t.stats,r=s.end-s.first;Vt(r)&&(this.lastLevelLoadSec=r/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:n}){const s=n?n.stats:t.stats;if(t.type===Zt.MAIN&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const r=n?n.duration:t.duration,a=this.hls.levels[t.level],o=(a.loaded?a.loaded.bytes:0)+s.loaded,l=(a.loaded?a.loaded.duration:0)+r;a.loaded={bytes:o,duration:l},a.realBitrate=Math.round(8*o/l)}if(t.bitrateTest){const r={stats:s,frag:t,part:n,id:t.type};this.onFragBuffered(H.FRAG_BUFFERED,r),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:s}=t,r=s!=null&&s.stats.loaded?s.stats:n.stats;if(r.aborted||this.ignoreFragment(n))return;const a=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,r.loaded),r.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Zt.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),s=this.hls.config.maxStarvationDelay,r=this.findBestLevel(n,t,e,0,s,1,1);if(r>-1)return r;const a=this.hls.firstLevel,o=Math.min(Math.max(a,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${a} clamped to ${o}`),o}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),s=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!s||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const r=n&&s?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const a=this.hls.levels;if(a.length>Math.max(e,r)&&a[e].loadError<=a[r].loadError)return e}return this._nextAutoLevel=r,this.nextAutoLevelKey=this.getAutoLevelKey(),r}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this;if(n.levels.length<=1)return n.loadLevel;const{maxAutoLevel:s,config:r,minAutoLevel:a}=n,o=t?t.duration:e?e.duration:0,l=this.getBwEstimate(),c=this.getStarvationDelay();let h=r.abrBandWidthFactor,d=r.abrBandWidthUpFactor;if(c){const b=this.findBestLevel(l,a,s,c,0,h,d);if(b>=0)return this.rebufferNotice=-1,b}let m=o?Math.min(o,r.maxStarvationDelay):r.maxStarvationDelay;if(!c){const b=this.bitrateTestDelay;b&&(m=(o?Math.min(o,r.maxLoadingDelay):r.maxLoadingDelay)-b,this.info(`bitrate test took ${Math.round(1e3*b)}ms, set first fragment max fetchDuration to ${Math.round(1e3*m)} ms`),h=d=1)}const y=this.findBestLevel(l,a,s,c,m,h,d);if(this.rebufferNotice!==y&&(this.rebufferNotice=y,this.info(`${c?"rebuffering expected":"buffer is empty"}, optimal quality level ${y}`)),y>-1)return y;const x=n.levels[a],_=n.loadLevelObj;return _&&(x==null?void 0:x.bitrate)<_.bitrate?a:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,s=e.mainForwardBufferInfo;return(s?s.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,s,r,a,o){var l;const c=s+r,h=this.lastLoadedFragLevel,d=h===-1?this.hls.firstLevel:h,{fragCurrent:m,partCurrent:y}=this,{levels:x,allAudioTracks:_,loadLevel:b,config:A}=this.hls;if(x.length===1)return 0;const T=x[d],w=!!((l=this.hls.latestLevelDetails)!=null&&l.live),R=b===-1||h===-1;let O,N="SDR",U=(T==null?void 0:T.frameRate)||0;const{audioPreference:P,videoPreference:B}=A,L=this.audioTracksByGroup||(this.audioTracksByGroup=aH(_));let F=-1;if(R){if(this.firstSelection!==-1)return this.firstSelection;const W=this.codecTiers||(this.codecTiers=yX(x,L,t,n)),ne=gX(W,N,e,P,B),{codecSet:ie,videoRanges:ue,minFramerate:z,minBitrate:ae,minIndex:ge,preferHDR:Ee}=ne;F=ge,O=ie,N=Ee?ue[ue.length-1]:ue[0],U=z,e=Math.max(e,ae),this.log(`picked start tier ${xs(ne)}`)}else O=T==null?void 0:T.codecSet,N=T==null?void 0:T.videoRange;const j=y?y.duration:m?m.duration:0,J=this.bwEstimator.getEstimateTTFB()/1e3,re=[];for(let W=n;W>=t;W--){var q;const ne=x[W],ie=W>d;if(!ne)continue;if(A.useMediaCapabilities&&!ne.supportedResult&&!ne.supportedPromise){const Ce=navigator.mediaCapabilities;typeof(Ce==null?void 0:Ce.decodingInfo)=="function"&&(cX(ne,L,N,U,e,P)||Ow(ne.videoCodec))?(ne.supportedPromise=rH(ne,L,Ce),ne.supportedPromise.then(Me=>{if(!this.hls)return;ne.supportedResult=Me;const Ze=this.hls.levels,tt=Ze.indexOf(ne);Me.error?this.warn(`MediaCapabilities decodingInfo error: "${Me.error}" for level ${tt} ${xs(Me)}`):Me.supported||(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${tt} ${xs(Me)}`),tt>-1&&Ze.length>1&&(this.log(`Removing unsupported level ${tt}`),this.hls.removeLevel(tt),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))})):ne.supportedResult=iH}if((O&&ne.codecSet!==O||N&&ne.videoRange!==N||ie&&U>ne.frameRate||!ie&&U>0&&U<ne.frameRate||ne.supportedResult&&!((q=ne.supportedResult.decodingInfoResults)!=null&&q[0].smooth))&&(!R||W!==F)){re.push(W);continue}const ue=ne.details,z=(y?ue==null?void 0:ue.partTarget:ue==null?void 0:ue.averagetargetduration)||j;let ae;ie?ae=o*e:ae=a*e;const ge=j&&s>=j*2&&r===0?ne.averageBitrate:ne.maxBitrate,Ee=this.getTimeToLoadFrag(J,ae,ge*z,ue===void 0);if(ae>=ge&&(W===h||ne.loadError===0&&ne.fragmentError===0)&&(Ee<=J||!Vt(Ee)||w&&!this.bitrateTestDelay||Ee<c)){const Ce=this.forcedAutoLevel;return W!==b&&(Ce===-1||Ce!==b)&&(re.length&&this.trace(`Skipped level(s) ${re.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${x[re[0]].codecs}" ${x[re[0]].videoRange}; not compatible with "${O}" ${N}`),this.info(`switch candidate:${d}->${W} adjustedbw(${Math.round(ae)})-bitrate=${Math.round(ae-ge)} ttfb:${J.toFixed(1)} avgDuration:${z.toFixed(1)} maxFetchDuration:${c.toFixed(1)} fetchDuration:${Ee.toFixed(1)} firstSelection:${R} codecSet:${ne.codecSet} videoRange:${ne.videoRange} hls.loadLevel:${b}`)),R&&(this.firstSelection=W),W}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls;return Math.min(Math.max(e,n),t)}}const zI={search:function(i,e){let t=0,n=i.length-1,s=null,r=null;for(;t<=n;){s=(t+n)/2|0,r=i[s];const a=e(r);if(a>0)t=s+1;else if(a<0)n=s-1;else return r}return null}};function EX(i,e,t){if(e===null||!Array.isArray(i)||!i.length||!Vt(e))return null;const n=i[0].programDateTime;if(e<(n||0))return null;const s=i[i.length-1].endProgramDateTime;if(e>=(s||0))return null;t=t||0;for(let r=0;r<i.length;++r){const a=i[r];if(SX(e,t,a))return a}return null}function ig(i,e,t=0,n=0,s=.005){let r=null;if(i){r=e[1+i.sn-e[0].sn]||null;const o=i.endDTS-t;o>0&&o<15e-7&&(t+=15e-7),r&&i.level!==r.level&&r.end<=i.end&&(r=e[2+i.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(r=e[0]);if(r&&((!i||i.level===r.level)&&yN(t,n,r)===0||_X(r,i,Math.min(s,n))))return r;const a=zI.search(e,yN.bind(null,t,n));return a&&(a!==i||!r)?a:r}function _X(i,e,t){if(e&&e.start===0&&e.level<i.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((s,r)=>(r[0]==="INF"&&(s+=parseFloat(r[1])),s),t);return i.start<=n}return!1}function yN(i=0,e=0,t){if(t.start<=i&&t.start+t.duration>i)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=i?1:t.start-n>i&&t.start?-1:0}function SX(i,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>i}function oH(i,e){return zI.search(i,t=>t.cc<e?1:t.cc>e?-1:0)}function TX(i,e,t){if(i&&i.startCC<=e&&i.endCC>=e){const n=t.start,s=t.end;let r=i.fragments;if(!t.relurl){const{fragmentHint:a}=i;a&&(r=r.concat(a))}return zI.search(r,a=>a.cc<e||a.end<=n?1:a.cc>e||a.start>=s?-1:0)}return null}function n3(i){switch(i.details){case Pe.FRAG_LOAD_TIMEOUT:case Pe.KEY_LOAD_TIMEOUT:case Pe.LEVEL_LOAD_TIMEOUT:case Pe.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function vN(i,e){const t=n3(e);return i.default[`${t?"timeout":"error"}Retry`]}function VI(i,e){const t=i.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*i.retryDelayMs,i.maxRetryDelayMs)}function xN(i){return Pi(Pi({},i),{errorRetry:null,timeoutRetry:null})}function i3(i,e,t,n){if(!i)return!1;const s=n==null?void 0:n.code,r=e<i.maxNumRetry&&(wX(s)||!!t);return i.shouldRetry?i.shouldRetry(i,e,t,n,r):r}function wX(i){return i===0&&navigator.onLine===!1||!!i&&(i<400||i>499)}var Ra={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},Rc={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2};class MX extends jf{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(H.ERROR,this.onError,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(H.ERROR,this.onError,this),e.off(H.ERROR,this.onErrorOut,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Zt.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n;if(t.fatal)return;const s=this.hls,r=t.context;switch(t.details){case Pe.FRAG_LOAD_ERROR:case Pe.FRAG_LOAD_TIMEOUT:case Pe.KEY_LOAD_ERROR:case Pe.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case Pe.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction=BA();return}case Pe.FRAG_GAP:case Pe.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Ra.SendAlternateToPenaltyBox;return}case Pe.LEVEL_EMPTY_ERROR:case Pe.LEVEL_PARSING_ERROR:{var a,o;const c=t.parent===Zt.MAIN?t.level:s.loadLevel;t.details===Pe.LEVEL_EMPTY_ERROR&&((a=t.context)!=null&&(o=a.levelDetails)!=null&&o.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,c):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,c))}return;case Pe.LEVEL_LOAD_ERROR:case Pe.LEVEL_LOAD_TIMEOUT:typeof(r==null?void 0:r.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.level));return;case Pe.AUDIO_TRACK_LOAD_ERROR:case Pe.AUDIO_TRACK_LOAD_TIMEOUT:case Pe.SUBTITLE_LOAD_ERROR:case Pe.SUBTITLE_TRACK_LOAD_TIMEOUT:if(r){const c=s.loadLevelObj;if(c&&(r.type===$n.AUDIO_TRACK&&c.hasAudioGroup(r.groupId)||r.type===$n.SUBTITLE_TRACK&&c.hasSubtitleGroup(r.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=Ra.SendAlternateToPenaltyBox,t.errorAction.flags=Rc.MoveAllAlternatesMatchingHost;return}}return;case Pe.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const c=s.loadLevelObj,h=c==null?void 0:c.attrs["HDCP-LEVEL"];h?t.errorAction={action:Ra.SendAlternateToPenaltyBox,flags:Rc.MoveAllAlternatesMatchingHDCP,hdcpLevel:h}:this.keySystemError(t)}return;case Pe.BUFFER_ADD_CODEC_ERROR:case Pe.REMUX_ALLOC_ERROR:case Pe.BUFFER_APPEND_ERROR:if(!t.errorAction){var l;t.errorAction=this.getLevelSwitchAction(t,(l=t.level)!=null?l:s.loadLevel)}return;case Pe.INTERNAL_EXCEPTION:case Pe.BUFFER_APPENDING_ERROR:case Pe.BUFFER_FULL_ERROR:case Pe.LEVEL_SWITCH_ERROR:case Pe.BUFFER_STALLED_ERROR:case Pe.BUFFER_SEEK_OVER_HOLE:case Pe.BUFFER_NUDGE_ON_STALL:t.errorAction=BA();return}t.type===nn.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,s=vN(n.config.playlistLoadPolicy,e),r=this.playlistError++;if(i3(s,r,n3(e),e.response))return{action:Ra.RetryRequest,flags:Rc.None,retryConfig:s,retryCount:r};const o=this.getLevelSwitchAction(e,t);return s&&(o.retryConfig=s,o.retryCount=r),o}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),s=t.levels[n],{fragLoadPolicy:r,keyLoadPolicy:a}=t.config,o=vN(e.details.startsWith("key")?a:r,e),l=t.levels.reduce((h,d)=>h+d.fragmentError,0);if(s&&(e.details!==Pe.FRAG_GAP&&s.fragmentError++,i3(o,l,n3(e),e.response)))return{action:Ra.RetryRequest,flags:Rc.None,retryConfig:o,retryCount:l};const c=this.getLevelSwitchAction(e,n);return o&&(c.retryConfig=o,c.retryCount=l),c}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const s=this.hls.levels[t];if(s){var r,a;const c=e.details;s.loadError++,c===Pe.BUFFER_APPEND_ERROR&&s.fragmentError++;let h=-1;const{levels:d,loadLevel:m,minAutoLevel:y,maxAutoLevel:x}=n;n.autoLevelEnabled||(n.loadLevel=-1);const _=(r=e.frag)==null?void 0:r.type,A=(_===Zt.AUDIO&&c===Pe.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(c===Pe.BUFFER_ADD_CODEC_ERROR||c===Pe.BUFFER_APPEND_ERROR))&&d.some(({audioCodec:N})=>s.audioCodec!==N),w=e.sourceBufferName==="video"&&(c===Pe.BUFFER_ADD_CODEC_ERROR||c===Pe.BUFFER_APPEND_ERROR)&&d.some(({codecSet:N,audioCodec:U})=>s.codecSet!==N&&s.audioCodec===U),{type:R,groupId:O}=(a=e.context)!=null?a:{};for(let N=d.length;N--;){const U=(N+m)%d.length;if(U!==m&&U>=y&&U<=x&&d[U].loadError===0){var o,l;const P=d[U];if(c===Pe.FRAG_GAP&&_===Zt.MAIN&&e.frag){const B=d[U].details;if(B){const L=ig(e.frag,B.fragments,e.frag.start);if(L!=null&&L.gap)continue}}else{if(R===$n.AUDIO_TRACK&&P.hasAudioGroup(O)||R===$n.SUBTITLE_TRACK&&P.hasSubtitleGroup(O))continue;if(_===Zt.AUDIO&&(o=s.audioGroups)!=null&&o.some(B=>P.hasAudioGroup(B))||_===Zt.SUBTITLE&&(l=s.subtitleGroups)!=null&&l.some(B=>P.hasSubtitleGroup(B))||A&&s.audioCodec===P.audioCodec||!A&&s.audioCodec!==P.audioCodec||w&&s.codecSet===P.codecSet)continue}h=U;break}}if(h>-1&&n.loadLevel!==h)return e.levelRetry=!0,this.playlistError=0,{action:Ra.SendAlternateToPenaltyBox,flags:Rc.None,nextAutoLevel:h}}return{action:Ra.SendAlternateToPenaltyBox,flags:Rc.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case Ra.DoNothing:break;case Ra.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==Pe.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:s,hdcpLevel:r,nextAutoLevel:a}=n;switch(s){case Rc.None:this.switchLevel(e,a);break;case Rc.MoveAllAlternatesMatchingHDCP:r&&(t.maxHdcpLevel=YD[YD.indexOf(r)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,a)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===Pe.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const n=nH(e.mimeType),s=this.hls.levels;for(let r=s.length;r--;)s[r][`${e.sourceBufferName}Codec`]===n&&this.hls.removeLevel(r)}}}function BA(i){const e={action:Ra.DoNothing,flags:Rc.None};return i&&(e.resolved=!0),e}var Tr={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class CX{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.BUFFER_APPENDED,this.onBufferAppended,this),e.on(H.FRAG_BUFFERED,this.onFragBuffered,this),e.on(H.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.BUFFER_APPENDED,this.onBufferAppended,this),e.off(H.FRAG_BUFFERED,this.onFragBuffered,this),e.off(H.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let s=n.length;s--;){const r=n[s];if(!r)break;const a=r.end;if(r.start<=e&&a!==null&&e<=a)return r}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,n){const{fragments:s}=this,r=Object.keys(s);for(let a=r.length;a--;){const o=s[r[a]];if((o==null?void 0:o.body.type)===t&&(!n||o.buffered)){const l=o.body;if(l.start<=e&&e<=l.end)return l}}return null}detectEvictedFragments(e,t,n,s,r){this.timeRanges&&(this.timeRanges[e]=t);const a=(s==null?void 0:s.fragment.sn)||-1;Object.keys(this.fragments).forEach(o=>{const l=this.fragments[o];if(!l||a>=l.body.sn)return;if(!l.buffered&&(!l.loaded||r)){l.body.type===n&&this.removeFragment(l.body);return}const c=l.range[e];if(c){if(c.time.length===0){this.removeFragment(l.body);return}c.time.some(h=>{const d=!this.isTimeBuffered(h.startPTS,h.endPTS,t);return d&&this.removeFragment(l.body),d})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const n=e.frag,s=M2(n),r=this.fragments[s];if(!r||r.buffered&&n.gap)return;const a=!n.relurl;Object.keys(t).forEach(o=>{const l=n.elementaryStreams[o];if(!l)return;const c=t[o],h=a||l.partial===!0;r.range[o]=this.getBufferedTimes(n,e.part,h,c)}),r.loaded=null,Object.keys(r.range).length?(r.buffered=!0,(r.body.endList=n.endList||r.body.endList)&&(this.endListFragments[r.body.type]=r),N_(r)||this.removeParts(n.sn-1,n.type)):this.removeFragment(r.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=bN(n,s=>s.fragment.sn>=e))}fragBuffered(e,t){const n=M2(e);let s=this.fragments[n];!s&&t&&(s=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,s.buffered=!0)}getBufferedTimes(e,t,n,s){const r={time:[],partial:n},a=e.start,o=e.end,l=e.minEndPTS||o,c=e.maxStartPTS||a;for(let h=0;h<s.length;h++){const d=s.start(h)-this.bufferPadding,m=s.end(h)+this.bufferPadding;if(c>=d&&l<=m){r.time.push({startPTS:Math.max(a,s.start(h)),endPTS:Math.min(o,s.end(h))});break}else if(a<m&&o>d){const y=Math.max(a,s.start(h)),x=Math.min(o,s.end(h));x>y&&(r.partial=!0,r.time.push({startPTS:y,endPTS:x}))}else if(o<=d)break}return r}getPartialFragment(e){let t=null,n,s,r,a=0;const{bufferPadding:o,fragments:l}=this;return Object.keys(l).forEach(c=>{const h=l[c];h&&N_(h)&&(s=h.body.start-o,r=h.body.end+o,e>=s&&e<=r&&(n=Math.min(e-s,r-e),a<=n&&(t=h.body,a=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||N_(t))}getState(e){const t=M2(e),n=this.fragments[t];return n?n.buffered?N_(n)?Tr.PARTIAL:Tr.OK:Tr.APPENDING:Tr.NOT_LOADED}isTimeBuffered(e,t,n){let s,r;for(let a=0;a<n.length;a++){if(s=n.start(a)-this.bufferPadding,r=n.end(a)+this.bufferPadding,e>=s&&t<=r)return!0;if(t<=s)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const n=t.frag,s=t.part?null:t,r=M2(n);this.fragments[r]={body:n,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:s,timeRanges:r,type:a}=t;if(n.sn==="initSegment")return;const o=n.type;if(s){let c=this.activePartLists[o];c||(this.activePartLists[o]=c=[]),c.push(s)}this.timeRanges=r;const l=r[a];this.detectEvictedFragments(a,l,o,s)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=M2(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,n=Object.keys(t);if(!e)return n.length>0;for(let s=n.length;s--;){const r=t[n[s]];if((r==null?void 0:r.body.type)===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,s,r){s&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o)return;const l=o.body;l.type!==n||s&&!l.gap||l.start<t&&l.end>e&&(o.buffered||r)&&this.removeFragment(l)})}removeFragment(e){const t=M2(e);e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const s=e.sn;this.activePartLists[e.type]=bN(n,r=>r.fragment.sn!==s)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e,t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const n=(e=this.hls)==null||(t=e.latestLevelDetails)==null?void 0:t.partList;n&&n.forEach(s=>s.clearElementaryStreamInfo())}}function N_(i){var e,t,n;return i.buffered&&(i.body.gap||((e=i.range.video)==null?void 0:e.partial)||((t=i.range.audio)==null?void 0:t.partial)||((n=i.range.audiovideo)==null?void 0:n.partial))}function M2(i){return`${i.type}_${i.level}_${i.sn}`}function bN(i,e){return i.filter(t=>{const n=e(t);return n||t.clearElementaryStreamInfo(),n})}var I0={cbc:0,ctr:1};class RX{constructor(e,t,n){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=n}decrypt(e,t){switch(this.aesMode){case I0.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case I0.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function DX(i){const e=i.byteLength,t=e&&new DataView(i.buffer).getUint8(e-1);return t?i.slice(0,e-t):i}class LX{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let s=0;s<4;s++)n[s]=t.getUint32(s*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,s=n[0],r=n[1],a=n[2],o=n[3],l=this.invSubMix,c=l[0],h=l[1],d=l[2],m=l[3],y=new Uint32Array(256);let x=0,_=0,b=0;for(b=0;b<256;b++)b<128?y[b]=b<<1:y[b]=b<<1^283;for(b=0;b<256;b++){let A=_^_<<1^_<<2^_<<3^_<<4;A=A>>>8^A&255^99,e[x]=A,t[A]=x;const T=y[x],w=y[T],R=y[w];let O=y[A]*257^A*16843008;s[x]=O<<24|O>>>8,r[x]=O<<16|O>>>16,a[x]=O<<8|O>>>24,o[x]=O,O=R*16843009^w*65537^T*257^x*16843008,c[A]=O<<24|O>>>8,h[A]=O<<16|O>>>16,d[A]=O<<8|O>>>24,m[A]=O,x?(x=T^y[y[y[R^T]]],_^=y[y[_]]):x=_=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,s=0;for(;s<t.length&&n;)n=t[s]===this.key[s],s++;if(n)return;this.key=t;const r=this.keySize=t.length;if(r!==4&&r!==6&&r!==8)throw new Error("Invalid aes key size="+r);const a=this.ksRows=(r+6+1)*4;let o,l;const c=this.keySchedule=new Uint32Array(a),h=this.invKeySchedule=new Uint32Array(a),d=this.sBox,m=this.rcon,y=this.invSubMix,x=y[0],_=y[1],b=y[2],A=y[3];let T,w;for(o=0;o<a;o++){if(o<r){T=c[o]=t[o];continue}w=T,o%r===0?(w=w<<8|w>>>24,w=d[w>>>24]<<24|d[w>>>16&255]<<16|d[w>>>8&255]<<8|d[w&255],w^=m[o/r|0]<<24):r>6&&o%r===4&&(w=d[w>>>24]<<24|d[w>>>16&255]<<16|d[w>>>8&255]<<8|d[w&255]),c[o]=T=(c[o-r]^w)>>>0}for(l=0;l<a;l++)o=a-l,l&3?w=c[o]:w=c[o-4],l<4||o<=4?h[l]=w:h[l]=x[d[w>>>24]]^_[d[w>>>16&255]]^b[d[w>>>8&255]]^A[d[w&255]],h[l]=h[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const s=this.keySize+6,r=this.invKeySchedule,a=this.invSBox,o=this.invSubMix,l=o[0],c=o[1],h=o[2],d=o[3],m=this.uint8ArrayToUint32Array_(n);let y=m[0],x=m[1],_=m[2],b=m[3];const A=new Int32Array(e),T=new Int32Array(A.length);let w,R,O,N,U,P,B,L,F,j,J,re,q,W;const ne=this.networkToHostOrderSwap;for(;t<A.length;){for(F=ne(A[t]),j=ne(A[t+1]),J=ne(A[t+2]),re=ne(A[t+3]),U=F^r[0],P=re^r[1],B=J^r[2],L=j^r[3],q=4,W=1;W<s;W++)w=l[U>>>24]^c[P>>16&255]^h[B>>8&255]^d[L&255]^r[q],R=l[P>>>24]^c[B>>16&255]^h[L>>8&255]^d[U&255]^r[q+1],O=l[B>>>24]^c[L>>16&255]^h[U>>8&255]^d[P&255]^r[q+2],N=l[L>>>24]^c[U>>16&255]^h[P>>8&255]^d[B&255]^r[q+3],U=w,P=R,B=O,L=N,q=q+4;w=a[U>>>24]<<24^a[P>>16&255]<<16^a[B>>8&255]<<8^a[L&255]^r[q],R=a[P>>>24]<<24^a[B>>16&255]<<16^a[L>>8&255]<<8^a[U&255]^r[q+1],O=a[B>>>24]<<24^a[L>>16&255]<<16^a[U>>8&255]<<8^a[P&255]^r[q+2],N=a[L>>>24]<<24^a[U>>16&255]<<16^a[P>>8&255]<<8^a[B&255]^r[q+3],T[t]=ne(w^y),T[t+1]=ne(N^x),T[t+2]=ne(O^_),T[t+3]=ne(R^b),y=F,x=j,_=J,b=re,t=t+4}return T.buffer}}class IX{constructor(e,t,n){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=n}expandKey(){const e=BX(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function BX(i){switch(i){case I0.cbc:return"AES-CBC";case I0.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${i}`)}}const OX=16;class YI{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?DX(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n,s){return this.useSoftware?new Promise((r,a)=>{const o=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(o,t,n,s);const l=this.flush();l?r(l.buffer):a(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n,s)}softwareDecrypt(e,t,n,s){const{currentIV:r,currentResult:a,remainderData:o}=this;if(s!==I0.cbc||t.byteLength!==16)return oi.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),o&&(e=Fl(o,e),this.remainderData=null);const l=this.getValidChunk(e);if(!l.length)return null;r&&(n=r);let c=this.softwareDecrypter;c||(c=this.softwareDecrypter=new LX),c.expandKey(t);const h=a;return this.currentResult=c.decrypt(l.buffer,0,n),this.currentIV=l.slice(-16).buffer,h||null}webCryptoDecrypt(e,t,n,s){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n,s));this.key=t,this.fastAesKey=new IX(this.subtle,t,s)}return this.fastAesKey.expandKey().then(r=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new RX(this.subtle,new Uint8Array(n),s).decrypt(e.buffer,r)):Promise.reject(new Error("web crypto not initialized"))).catch(r=>(oi.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,n,s)))}onWebCryptoError(e,t,n,s){const r=this.enableSoftwareAES;if(r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n,s);const a=this.flush();if(a)return a.buffer}throw new Error("WebCrypto"+(r?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%OX;return n!==e.length&&(t=e.slice(0,n),this.remainderData=e.slice(n)),t}logOnce(e){this.logEnabled&&(oi.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const AN=Math.pow(2,17);class PX{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new lf({type:nn.NETWORK_ERROR,details:Pe.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const s=this.config,r=s.fLoader,a=s.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(x=>x[0]==="GAP")){l(_N(e));return}else e.gap=!1;const c=this.loader=r?new r(s):new a(s),h=EN(e);e.loader=c;const d=xN(s.fragLoadPolicy.default),m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:AN};e.stats=c.stats;const y={onSuccess:(x,_,b,A)=>{this.resetLoader(e,c);let T=x.data;b.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(T.slice(0,16)),T=T.slice(16)),o({frag:e,part:null,payload:T,networkDetails:A})},onError:(x,_,b,A)=>{this.resetLoader(e,c),l(new lf({type:nn.NETWORK_ERROR,details:Pe.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Pi({url:n,data:void 0},x),error:new Error(`HTTP Error ${x.code} ${x.text}`),networkDetails:b,stats:A}))},onAbort:(x,_,b)=>{this.resetLoader(e,c),l(new lf({type:nn.NETWORK_ERROR,details:Pe.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:b,stats:x}))},onTimeout:(x,_,b)=>{this.resetLoader(e,c),l(new lf({type:nn.NETWORK_ERROR,details:Pe.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${m.timeout}ms`),networkDetails:b,stats:x}))}};t&&(y.onProgress=(x,_,b,A)=>t({frag:e,part:null,payload:b,networkDetails:A})),c.load(h,m,y)})}loadPart(e,t,n){this.abort();const s=this.config,r=s.fLoader,a=s.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(_N(e,t));return}const c=this.loader=r?new r(s):new a(s),h=EN(e,t);e.loader=c;const d=xN(s.fragLoadPolicy.default),m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:AN};t.stats=c.stats,c.load(h,m,{onSuccess:(y,x,_,b)=>{this.resetLoader(e,c),this.updateStatsFromPart(e,t);const A={frag:e,part:t,payload:y.data,networkDetails:b};n(A),o(A)},onError:(y,x,_,b)=>{this.resetLoader(e,c),l(new lf({type:nn.NETWORK_ERROR,details:Pe.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Pi({url:h.url,data:void 0},y),error:new Error(`HTTP Error ${y.code} ${y.text}`),networkDetails:_,stats:b}))},onAbort:(y,x,_)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,c),l(new lf({type:nn.NETWORK_ERROR,details:Pe.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:_,stats:y}))},onTimeout:(y,x,_)=>{this.resetLoader(e,c),l(new lf({type:nn.NETWORK_ERROR,details:Pe.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${m.timeout}ms`),networkDetails:_,stats:y}))}})})}updateStatsFromPart(e,t){const n=e.stats,s=t.stats,r=s.total;if(n.loaded+=s.loaded,r){const l=Math.round(e.duration/t.duration),c=Math.min(Math.round(n.loaded/r),l),d=(l-c)*Math.round(n.loaded/c);n.total=n.loaded+d}else n.total=Math.max(n.loaded,n.total);const a=n.loading,o=s.loading;a.start?a.first+=o.first-o.start:(a.start=o.start,a.first=o.first),a.end=o.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function EN(i,e=null){const t=e||i,n={frag:i,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},s=t.byteRangeStartOffset,r=t.byteRangeEndOffset;if(Vt(s)&&Vt(r)){var a;let o=s,l=r;if(i.sn==="initSegment"&&NX((a=i.decryptdata)==null?void 0:a.method)){const c=r-s;c%16&&(l=r+(16-c%16)),s!==0&&(n.resetIV=!0,o=s-16)}n.rangeStart=o,n.rangeEnd=l}return n}function _N(i,e){const t=new Error(`GAP ${i.gap?"tag":"attribute"} found`),n={type:nn.MEDIA_ERROR,details:Pe.FRAG_GAP,fatal:!1,frag:i,error:t,networkDetails:null};return e&&(n.part=e),(e||i).stats.aborted=!0,new lf(n)}function NX(i){return i==="AES-128"||i==="AES-256"}class lf extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class lH extends jf{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class KI{constructor(e,t,n,s=0,r=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=U_(),this.buffering={audio:U_(),video:U_(),audiovideo:U_()},this.level=e,this.sn=t,this.id=n,this.size=s,this.part=r,this.partial=a}}function U_(){return{start:0,executeStart:0,executeEnd:0,end:0}}const SN={length:0,start:()=>0,end:()=>0};class Hn{static isBuffered(e,t){if(e){const n=Hn.getBuffered(e);for(let s=n.length;s--;)if(t>=n.start(s)&&t<=n.end(s))return!0}return!1}static bufferedRanges(e){if(e){const t=Hn.getBuffered(e);return Hn.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}static bufferInfo(e,t,n){if(e){const s=Hn.bufferedRanges(e);if(s.length)return Hn.bufferedInfo(s,t,n)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.length>1&&e.sort((h,d)=>h.start-d.start||d.end-h.end);let s=-1,r=[];if(n)for(let h=0;h<e.length;h++){t>=e[h].start&&t<=e[h].end&&(s=h);const d=r.length;if(d){const m=r[d-1].end;e[h].start-m<n?e[h].end>m&&(r[d-1].end=e[h].end):r.push(e[h])}else r.push(e[h])}else r=e;let a=0,o,l=t,c=t;for(let h=0;h<r.length;h++){const d=r[h].start,m=r[h].end;if(s===-1&&t>=d&&t<=m&&(s=h),t+n>=d&&t<m)l=d,c=m,a=c-t;else if(t+n<d){o=d;break}}return{len:a,start:l||0,end:c||0,nextStart:o,buffered:e,bufferedIndex:s}}static getBuffered(e){try{return e.buffered||SN}catch(t){return oi.log("failed to get media.buffered",t),SN}}}const cH=/\{\$([a-zA-Z0-9-_]+)\}/g;function TN(i){return cH.test(i)}function KD(i,e){if(i.variableList!==null||i.hasVariableRefs){const t=i.variableList;return e.replace(cH,n=>{const s=n.substring(2,n.length-1),r=t==null?void 0:t[s];return r===void 0?(i.playlistParsingError||(i.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),n):r})}return e}function wN(i,e,t){let n=i.variableList;n||(i.variableList=n={});let s,r;if("QUERYPARAM"in e){s=e.QUERYPARAM;try{const a=new self.URL(t).searchParams;if(a.has(s))r=a.get(s);else throw new Error(`"${s}" does not match any query parameter in URI: "${t}"`)}catch(a){i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else s=e.NAME,r=e.VALUE;s in n?i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):n[s]=r||""}function UX(i,e,t){const n=e.IMPORT;if(t&&n in t){let s=i.variableList;s||(i.variableList=s={}),s[n]=t[n]}else i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}const kX=/^(\d+)x(\d+)$/,MN=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Cs{constructor(e,t){typeof e=="string"&&(e=Cs.parseAttrList(e,t)),Yi(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let s=0;s<t.length/2;s++)n[s]=parseInt(t.slice(s*2,s*2+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const n=this[e];return(n?n.split(/[ ,]+/):[]).reduce((s,r)=>(s[r.toLowerCase()]=!0,s),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=kX.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let n;const s={},r='"';for(MN.lastIndex=0;(n=MN.exec(e))!==null;){const a=n[1].trim();let o=n[2];const l=o.indexOf(r)===0&&o.lastIndexOf(r)===o.length-1;let c=!1;if(l)o=o.slice(1,-1);else switch(a){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":c=!0}if(t&&(l||c))o=KD(t,o);else if(!c&&!l)switch(a){case"CLOSED-CAPTIONS":if(o==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":oi.warn(`${e}: attribute ${a} is missing quotes`)}s[a]=o}return s}}const FX="com.apple.hls.interstitial";function HX(i){return i!=="ID"&&i!=="CLASS"&&i!=="CUE"&&i!=="START-DATE"&&i!=="DURATION"&&i!=="END-DATE"&&i!=="END-ON-NEXT"}function GX(i){return i==="SCTE35-OUT"||i==="SCTE35-IN"||i==="SCTE35-CMD"}class uH{constructor(e,t,n=0){var s;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(t==null?void 0:t.tagAnchor)||null,this.tagOrder=(s=t==null?void 0:t.tagOrder)!=null?s:n,t){const r=t.attr;for(const a in r)if(Object.prototype.hasOwnProperty.call(e,a)&&e[a]!==r[a]){oi.warn(`DATERANGE tag attribute: "${a}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=a;break}e=Yi(new Cs({}),r,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const r=(t==null?void 0:t.endDate)||new Date(this.attr["END-DATE"]);Vt(r.getTime())&&(this._endDate=r)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(oi.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Vt(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===FX}get isValid(){return!!this.id&&!this._badValueForSameId&&Vt(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const zX=10;class VX{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}get hasProgramDateTime(){return this.fragments.length?Vt(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||zX}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let n=e.length;n--;)if(e[n].index>t)return e[n].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function yy(i){return i==="AES-128"||i==="AES-256"||i==="AES-256-CTR"}function WI(i){switch(i){case"AES-128":case"AES-256":return I0.cbc;case"AES-256-CTR":return I0.ctr;default:throw new Error(`invalid full segment method ${i}`)}}function XI(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0))}function WD(i){return Uint8Array.from(unescape(encodeURIComponent(i)),e=>e.charCodeAt(0))}function YX(i){const e=WD(i).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function KX(i){const e=function(n,s,r){const a=n[s];n[s]=n[r],n[r]=a};e(i,0,3),e(i,1,2),e(i,4,5),e(i,6,7)}function WX(i){const e=i.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),s=n[n.length-1].split(",");if(s.length===2){const r=s[0]==="base64",a=s[1];r?(n.splice(-1,1),t=XI(a)):t=YX(a)}}return t}const s3=typeof self<"u"?self:void 0;var Ni={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},So={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function IC(i){switch(i){case So.FAIRPLAY:return Ni.FAIRPLAY;case So.PLAYREADY:return Ni.PLAYREADY;case So.WIDEVINE:return Ni.WIDEVINE;case So.CLEARKEY:return Ni.CLEARKEY}}var k_={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function BC(i){if(i===k_.WIDEVINE)return Ni.WIDEVINE;if(i===k_.PLAYREADY)return Ni.PLAYREADY;if(i===k_.CENC||i===k_.CLEARKEY)return Ni.CLEARKEY}function OC(i){switch(i){case Ni.FAIRPLAY:return So.FAIRPLAY;case Ni.PLAYREADY:return So.PLAYREADY;case Ni.WIDEVINE:return So.WIDEVINE;case Ni.CLEARKEY:return So.CLEARKEY}}function F_(i){const{drmSystems:e,widevineLicenseUrl:t}=i,n=e?[Ni.FAIRPLAY,Ni.WIDEVINE,Ni.PLAYREADY,Ni.CLEARKEY].filter(s=>!!e[s]):[];return!n[Ni.WIDEVINE]&&t&&n.push(Ni.WIDEVINE),n}const hH=function(i){return s3!=null&&(i=s3.navigator)!=null&&i.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function XX(i,e,t,n){let s;switch(i){case Ni.FAIRPLAY:s=["cenc","sinf"];break;case Ni.WIDEVINE:case Ni.PLAYREADY:s=["cenc"];break;case Ni.CLEARKEY:s=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${i}`)}return jX(s,e,t,n)}function jX(i,e,t,n){return[{initDataTypes:i,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(r=>({contentType:`audio/mp4; codecs=${r}`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(r=>({contentType:`video/mp4; codecs=${r}`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function qX(i){var e;return i.sessionType==="persistent-license"||!!((e=i.sessionTypes)!=null&&e.some(t=>t==="persistent-license"))}function fH(i){const e=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),n=t.substring(t.indexOf("<"),t.length),a=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(a){const o=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(o){const l=XI(o).subarray(0,16);return KX(l),l}}return null}let H_={};class OA{static clearKeyUriToKeyIdMap(){H_={}}constructor(e,t,n,s=[1],r=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=s,this.iv=r,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!yy(e)}isSupported(){if(this.method){if(yy(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case So.FAIRPLAY:case So.WIDEVINE:case So.PLAYREADY:case So.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(yy(this.method)&&this.uri&&!this.iv){typeof e!="number"&&(oi.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=QX(e);return new OA(this.method,this.uri,"identity",this.keyFormatVersions,n)}const t=WX(this.uri);if(t)switch(this.keyFormat){case So.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case So.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=tX(n,null,t),this.keyId=fH(t);break}default:{let n=t.subarray(0,16);if(n.length!==16){const s=new Uint8Array(16);s.set(n,16-n.length),n=s}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=H_[this.uri];if(!n){const s=Object.keys(H_).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,s),H_[this.uri]=n}this.keyId=n}return this}}function QX(i){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=i>>8*(15-t)&255;return e}const CN=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,RN=/#EXT-X-MEDIA:(.*)/g,$X=/^#EXT(?:INF|-X-TARGETDURATION):/m,PC=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),JX=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class ch{static findGroup(e,t){for(let n=0;n<e.length;n++){const s=e[n];if(s.id===t)return s}}static resolve(e,t){return FI.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return $X.test(e)}static parseMasterPlaylist(e,t){const n=TN(e),s={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},r=[];CN.lastIndex=0;let a;for(;(a=CN.exec(e))!=null;)if(a[1]){var o;const c=new Cs(a[1],s),h=KD(s,a[2]),d={attrs:c,bitrate:c.decimalInteger("BANDWIDTH")||c.decimalInteger("AVERAGE-BANDWIDTH"),name:c.NAME,url:ch.resolve(h,t)},m=c.decimalResolution("RESOLUTION");m&&(d.width=m.width,d.height=m.height),IN(c.CODECS,d);const y=c["SUPPLEMENTAL-CODECS"];y&&(d.supplemental={},IN(y,d.supplemental)),(o=d.unknownCodecs)!=null&&o.length||r.push(d),s.levels.push(d)}else if(a[3]){const c=a[3],h=a[4];switch(c){case"SESSION-DATA":{const d=new Cs(h,s),m=d["DATA-ID"];m&&(s.sessionData===null&&(s.sessionData={}),s.sessionData[m]=d);break}case"SESSION-KEY":{const d=DN(h,t,s);d.encrypted&&d.isSupported()?(s.sessionKeys===null&&(s.sessionKeys=[]),s.sessionKeys.push(d)):oi.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${h}"`);break}case"DEFINE":{{const d=new Cs(h,s);wN(s,d,t)}break}case"CONTENT-STEERING":{const d=new Cs(h,s);s.contentSteering={uri:ch.resolve(d["SERVER-URI"],t),pathwayId:d["PATHWAY-ID"]||"."};break}case"START":{s.startTimeOffset=LN(h);break}}}const l=r.length>0&&r.length<s.levels.length;return s.levels=l?r:s.levels,s.levels.length===0&&(s.playlistParsingError=new Error("no levels found in manifest")),s}static parseMasterPlaylistMedia(e,t,n){let s;const r={},a=n.levels,o={AUDIO:a.map(c=>({id:c.attrs.AUDIO,audioCodec:c.audioCodec})),SUBTITLES:a.map(c=>({id:c.attrs.SUBTITLES,textCodec:c.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(RN.lastIndex=0;(s=RN.exec(e))!==null;){const c=new Cs(s[1],n),h=c.TYPE;if(h){const d=o[h],m=r[h]||[];r[h]=m;const y=c.LANGUAGE,x=c["ASSOC-LANGUAGE"],_=c.CHANNELS,b=c.CHARACTERISTICS,A=c["INSTREAM-ID"],T={attrs:c,bitrate:0,id:l++,groupId:c["GROUP-ID"]||"",name:c.NAME||y||"",type:h,default:c.bool("DEFAULT"),autoselect:c.bool("AUTOSELECT"),forced:c.bool("FORCED"),lang:y,url:c.URI?ch.resolve(c.URI,t):""};if(x&&(T.assocLang=x),_&&(T.channels=_),b&&(T.characteristics=b),A&&(T.instreamId=A),d!=null&&d.length){const w=ch.findGroup(d,T.groupId)||d[0];BN(T,w,"audioCodec"),BN(T,w,"textCodec")}m.push(T)}}return r}static parseLevelPlaylist(e,t,n,s,r,a){var o;const l={url:t},c=new VX(t),h=c.fragments,d=[];let m=null,y=0,x=0,_=0,b=0,A=0,T=null,w=new CC(s,l),R,O,N,U=-1,P=!1,B=null,L;if(PC.lastIndex=0,c.m3u8=e,c.hasVariableRefs=TN(e),((o=PC.exec(e))==null?void 0:o[0])!=="#EXTM3U")return c.playlistParsingError=new Error("Missing format identifier #EXTM3U"),c;for(;(R=PC.exec(e))!==null;){P&&(P=!1,w=new CC(s,l),w.playlistOffset=_,w.start=_,w.sn=y,w.cc=b,A&&(w.bitrate=A),w.level=n,m&&(w.initSegment=m,m.rawProgramDateTime&&(w.rawProgramDateTime=m.rawProgramDateTime,m.rawProgramDateTime=null),B&&(w.setByteRange(B),B=null)));const re=R[1];if(re){w.duration=parseFloat(re);const q=(" "+R[2]).slice(1);w.title=q||null,w.tagList.push(q?["INF",re,q]:["INF",re])}else if(R[3]){if(Vt(w.duration)){w.playlistOffset=_,w.start=_,N&&PN(w,N,c),w.sn=y,w.level=n,w.cc=b,h.push(w);const q=(" "+R[3]).slice(1);w.relurl=KD(c,q),XD(w,T,d),T=w,_+=w.duration,y++,x=0,P=!0}}else{if(R=R[0].match(JX),!R){oi.warn("No matches on slow regex match for level playlist!");continue}for(O=1;O<R.length&&R[O]===void 0;O++);const q=(" "+R[O]).slice(1),W=(" "+R[O+1]).slice(1),ne=R[O+2]?(" "+R[O+2]).slice(1):null;switch(q){case"BYTERANGE":T?w.setByteRange(W,T):w.setByteRange(W);break;case"PROGRAM-DATE-TIME":w.rawProgramDateTime=W,w.tagList.push(["PROGRAM-DATE-TIME",W]),U===-1&&(U=h.length);break;case"PLAYLIST-TYPE":c.type&&Xh(c,q,R),c.type=W.toUpperCase();break;case"MEDIA-SEQUENCE":c.startSN!==0?Xh(c,q,R):h.length>0&&NN(c,q,R),y=c.startSN=parseInt(W);break;case"SKIP":{c.skippedSegments&&Xh(c,q,R);const ie=new Cs(W,c),ue=ie.decimalInteger("SKIPPED-SEGMENTS");if(Vt(ue)){c.skippedSegments+=ue;for(let ae=ue;ae--;)h.push(null);y+=ue}const z=ie.enumeratedString("RECENTLY-REMOVED-DATERANGES");z&&(c.recentlyRemovedDateranges=(c.recentlyRemovedDateranges||[]).concat(z.split("	")));break}case"TARGETDURATION":c.targetduration!==0&&Xh(c,q,R),c.targetduration=Math.max(parseInt(W),1);break;case"VERSION":c.version!==null&&Xh(c,q,R),c.version=parseInt(W);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":c.live||Xh(c,q,R),c.live=!1;break;case"#":(W||ne)&&w.tagList.push(ne?[W,ne]:[W]);break;case"DISCONTINUITY":b++,w.tagList.push(["DIS"]);break;case"GAP":w.gap=!0,w.tagList.push([q]);break;case"BITRATE":w.tagList.push([q,W]),A=parseInt(W)*1e3,Vt(A)?w.bitrate=A:A=0;break;case"DATERANGE":{const ie=new Cs(W,c),ue=new uH(ie,c.dateRanges[ie.ID],c.dateRangeTagCount);c.dateRangeTagCount++,ue.isValid||c.skippedSegments?c.dateRanges[ue.id]=ue:oi.warn(`Ignoring invalid DATERANGE tag: "${W}"`),w.tagList.push(["EXT-X-DATERANGE",W]);break}case"DEFINE":{{const ie=new Cs(W,c);"IMPORT"in ie?UX(c,ie,a):wN(c,ie,t)}break}case"DISCONTINUITY-SEQUENCE":c.startCC!==0?Xh(c,q,R):h.length>0&&NN(c,q,R),c.startCC=b=parseInt(W);break;case"KEY":{const ie=DN(W,t,c);if(ie.isSupported()){if(ie.method==="NONE"){N=void 0;break}N||(N={}),N[ie.keyFormat]&&(N=Yi({},N)),N[ie.keyFormat]=ie}else oi.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${W}"`);break}case"START":c.startTimeOffset=LN(W);break;case"MAP":{const ie=new Cs(W,c);if(w.duration){const ue=new CC(s,l);ON(ue,ie,n,N),m=ue,w.initSegment=m,m.rawProgramDateTime&&!w.rawProgramDateTime&&(w.rawProgramDateTime=m.rawProgramDateTime)}else{const ue=w.byteRangeEndOffset;if(ue){const z=w.byteRangeStartOffset;B=`${ue-z}@${z}`}else B=null;ON(w,ie,n,N),m=w,P=!0}m.cc=b;break}case"SERVER-CONTROL":{L&&Xh(c,q,R),L=new Cs(W),c.canBlockReload=L.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=L.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&L.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=L.optionalFloat("PART-HOLD-BACK",0),c.holdBack=L.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{c.partTarget&&Xh(c,q,R);const ie=new Cs(W);c.partTarget=ie.decimalFloatingPoint("PART-TARGET");break}case"PART":{let ie=c.partList;ie||(ie=c.partList=[]);const ue=x>0?ie[ie.length-1]:void 0,z=x++,ae=new Cs(W,c),ge=new HW(ae,w,l,z,ue);ie.push(ge),w.duration+=ge.duration;break}case"PRELOAD-HINT":{const ie=new Cs(W,c);c.preloadHint=ie;break}case"RENDITION-REPORT":{const ie=new Cs(W,c);c.renditionReports=c.renditionReports||[],c.renditionReports.push(ie);break}default:oi.warn(`line parsed but not handled: ${R}`);break}}}T&&!T.relurl?(h.pop(),_-=T.duration,c.partList&&(c.fragmentHint=T)):c.partList&&(XD(w,T,d),w.cc=b,c.fragmentHint=w,N&&PN(w,N,c)),c.targetduration||(c.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const F=h.length,j=h[0],J=h[F-1];if(_+=c.skippedSegments*c.targetduration,_>0&&F&&J){c.averagetargetduration=_/F;const re=J.sn;c.endSN=re!=="initSegment"?re:0,c.live||(J.endList=!0),j&&c.startCC===void 0&&(c.startCC=j.cc),U>0&&(ej(h,U),j&&d.unshift(j))}else c.endSN=0,c.startCC=0;return c.fragmentHint&&(_+=c.fragmentHint.duration),c.totalduration=_,d.length&&c.dateRangeTagCount&&j&&dH(d,c),c.endCC=b,c}}function dH(i,e){const t=i.length,n=i[t-1],s=e.live?1/0:e.totalduration,r=Object.keys(e.dateRanges);for(let a=r.length;a--;){const o=e.dateRanges[r[a]],l=o.startDate.getTime();o.tagAnchor=n.ref;for(let c=t;c--;){const h=ZX(e,l,i,c,s);if(h!==-1){o.tagAnchor=e.fragments[h].ref;break}}}}function ZX(i,e,t,n,s){const r=t[n];if(r){const o=r.programDateTime;if(e>=o||n===0){var a;const l=(((a=t[n+1])==null?void 0:a.start)||s)-r.start;if(e<=o+l*1e3){const c=t[n].sn-i.startSN,h=i.fragments;if(h.length>t.length){const m=(t[n+1]||h[h.length-1]).sn-i.startSN;for(let y=m;y>c;y--){const x=h[y].programDateTime;if(e>=x&&e<x+h[y].duration*1e3)return y}}return c}}}return-1}function DN(i,e,t){var n,s;const r=new Cs(i,t),a=(n=r.METHOD)!=null?n:"",o=r.URI,l=r.hexadecimalInteger("IV"),c=r.KEYFORMATVERSIONS,h=(s=r.KEYFORMAT)!=null?s:"identity";o&&r.IV&&!l&&oi.error(`Invalid IV: ${r.IV}`);const d=o?ch.resolve(o,e):"",m=(c||"1").split("/").map(Number).filter(Number.isFinite);return new OA(a,d,h,m,l)}function LN(i){const t=new Cs(i).decimalFloatingPoint("TIME-OFFSET");return Vt(t)?t:null}function IN(i,e){let t=(i||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const s=t.filter(r=>eH(r,n));s.length&&(e[`${n}Codec`]=s.map(r=>r.split("/")[0]).join(","),t=t.filter(r=>s.indexOf(r)===-1))}),e.unknownCodecs=t}function BN(i,e,t){const n=e[t];n&&(i[t]=n)}function ej(i,e){let t=i[e];for(let n=e;n--;){const s=i[n];if(!s)return;s.programDateTime=t.programDateTime-s.duration*1e3,t=s}}function XD(i,e,t){i.rawProgramDateTime?t.push(i):e!=null&&e.programDateTime&&(i.programDateTime=e.endProgramDateTime)}function ON(i,e,t,n){i.relurl=e.URI,e.BYTERANGE&&i.setByteRange(e.BYTERANGE),i.level=t,i.sn="initSegment",n&&(i.levelkeys=n),i.initSegment=null}function PN(i,e,t){i.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(s=>e[s].isCommonEncryption)&&n.push(i)}function Xh(i,e,t){i.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function NN(i,e,t){i.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function NC(i,e){const t=e.startPTS;if(Vt(t)){let n=0,s;e.sn>i.sn?(n=t-i.start,s=i):(n=i.start-t,s=e),s.duration!==n&&s.setDuration(n)}else e.sn>i.sn?i.cc===e.cc&&i.minEndPTS?e.setStart(i.start+(i.minEndPTS-i.start)):e.setStart(i.start+i.duration):e.setStart(Math.max(i.start-e.duration,0))}function pH(i,e,t,n,s,r){n-t<=0&&(oi.warn("Fragment should have a positive duration",e),n=t+e.duration,r=s+e.duration);let o=t,l=n;const c=e.startPTS,h=e.endPTS;if(Vt(c)){const b=Math.abs(c-t);Vt(e.deltaPTS)?e.deltaPTS=Math.max(b,e.deltaPTS):e.deltaPTS=b,o=Math.max(t,c),t=Math.min(t,c),s=Math.min(s,e.startDTS),l=Math.min(n,h),n=Math.max(n,h),r=Math.max(r,e.endDTS)}const d=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(n-e.start),e.startPTS=t,e.maxStartPTS=o,e.startDTS=s,e.endPTS=n,e.minEndPTS=l,e.endDTS=r;const m=e.sn;if(!i||m<i.startSN||m>i.endSN)return 0;let y;const x=m-i.startSN,_=i.fragments;for(_[x]=e,y=x;y>0;y--)NC(_[y],_[y-1]);for(y=x;y<_.length-1;y++)NC(_[y],_[y+1]);return i.fragmentHint&&NC(_[_.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,d}function tj(i,e){if(i===e)return;let t=null;const n=i.fragments;for(let l=n.length-1;l>=0;l--){const c=n[l].initSegment;if(c){t=c;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;let s;sj(i,e,(l,c,h,d)=>{if(!e.startCC&&c.cc!==l.cc){var m,y;const x=l.cc-c.cc;for(let _=h;_<d.length;_++)d[_].cc+=x;e.startCC=(m=(y=yH(i,e.startSN-1))==null?void 0:y.cc)!=null?m:d[0].cc,e.endCC=d[d.length-1].cc}Vt(l.startPTS)&&Vt(l.endPTS)&&(c.setStart(c.startPTS=l.startPTS),c.startDTS=l.startDTS,c.maxStartPTS=l.maxStartPTS,c.endPTS=l.endPTS,c.endDTS=l.endDTS,c.minEndPTS=l.minEndPTS,c.setDuration(l.endPTS-l.startPTS),c.duration&&(s=c),e.PTSKnown=e.alignedSliding=!0),l.hasStreams&&(c.elementaryStreams=l.elementaryStreams),c.loader=l.loader,l.hasStats&&(c.stats=l.stats),l.initSegment&&(c.initSegment=l.initSegment,t=l.initSegment)});const r=e.fragments,a=e.fragmentHint?r.concat(e.fragmentHint):r;if(t&&a.forEach(l=>{var c;l&&(!l.initSegment||l.initSegment.relurl===((c=t)==null?void 0:c.relurl))&&(l.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=r.some(l=>!l),e.deltaUpdateFailed){oi.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=e.skippedSegments;l--;)r.shift();e.startSN=r[0].sn}else{e.endCC=r[r.length-1].cc,e.canSkipDateRanges&&(e.dateRanges=nj(i.dateRanges,e));const l=i.fragments.filter(c=>c.rawProgramDateTime);if(i.hasProgramDateTime&&!e.hasProgramDateTime)for(let c=1;c<a.length;c++)a[c].programDateTime===null&&XD(a[c],a[c-1],l);dH(l,e)}ij(i.partList,e.partList,(l,c)=>{c.elementaryStreams=l.elementaryStreams,c.stats=l.stats}),s?pH(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):mH(i,e),r.length&&(e.totalduration=e.edge-r[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;const o=e.advancedDateTime;if(e.advanced&&o){const l=e.edge;e.driftStart||(e.driftStartTime=o,e.driftStart=l),e.driftEndTime=o,e.driftEnd=l}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=i.requestScheduled)}function nj(i,e){const{dateRanges:t,recentlyRemovedDateranges:n}=e,s=Yi({},i);n&&n.forEach(o=>{delete s[o]});const a=Object.keys(s).length;return a&&Object.keys(t).forEach(o=>{const l=s[o],c=new uH(t[o].attr,l);c.isValid?(s[o]=c,l||(c.tagOrder+=a)):oi.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${xs(t[o].attr)}"`)}),s}function ij(i,e,t){if(i&&e){let n=0;for(let s=0,r=i.length;s<=r;s++){const a=i[s],o=e[s+n];a&&o&&a.index===o.index&&a.fragment.sn===o.fragment.sn?t(a,o):n--}}}function sj(i,e,t){const n=e.skippedSegments,s=Math.max(i.startSN,e.startSN)-e.startSN,r=(i.fragmentHint?1:0)+(n?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,a=e.startSN-i.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments;for(let c=s;c<=r;c++){const h=l[a+c];let d=o[c];if(n&&!d&&h&&(d=e.fragments[c]=h),h&&d){if(t(h,d,c,o),h.url&&h.url!==d.url){e.playlistParsingError=UN(`media sequence mismatch ${d.sn}:`,i,e,h,d);return}else if(h.cc!==d.cc){e.playlistParsingError=UN(`discontinuity sequence mismatch (${h.cc}!=${d.cc})`,i,e,h,d);return}}}}function UN(i,e,t,n,s){return new Error(`${i} ${s.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function mH(i,e,t=!0){const n=e.startSN+e.skippedSegments-i.startSN,s=i.fragments,r=n>=0;let a=0;if(r&&n<s.length)a=s[n].start;else if(r&&e.startSN===i.endSN+1)a=i.fragmentEnd;else if(r&&t)a=i.fragmentStart+n*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)a=i.fragmentStart;else return;jD(e,a)}function jD(i,e){if(e){const t=i.fragments;for(let n=i.skippedSegments;n<t.length;n++)t[n].addStart(e);i.fragmentHint&&i.fragmentHint.addStart(e)}}function gH(i,e=1/0){let t=1e3*i.targetduration;if(i.updated){const n=i.fragments;if(n.length&&t*4>e){const r=n[n.length-1].duration*1e3;r<t&&(t=r)}}else t/=2;return Math.round(t)}function yH(i,e,t){if(!i)return null;let n=i.fragments[e-i.startSN];return n||(n=i.fragmentHint,n&&n.sn===e)?n:e<i.startSN&&t&&t.sn===e?t:null}function kN(i,e,t){return i?vH(i.partList,e,t):null}function vH(i,e,t){if(i)for(let n=i.length;n--;){const s=i[n];if(s.index===t&&s.fragment.sn===e)return s}return null}function xH(i){i.forEach((e,t)=>{var n;(n=e.details)==null||n.fragments.forEach(s=>{s.level=t,s.initSegment&&(s.initSegment.level=t)})})}function aA(i,e){for(let n=0,s=i.length;n<s;n++){var t;if(((t=i[n])==null?void 0:t.cc)===e)return i[n]}return null}function rj(i,e){return!!(i&&e.startCC<i.endCC&&e.endCC>i.startCC)}function FN(i,e){if(i){const t=i.start+e;i.start=i.startPTS=t,i.endPTS=t+i.duration}}function bH(i,e){const t=e.fragments;for(let n=0,s=t.length;n<s;n++)FN(t[n],i);e.fragmentHint&&FN(e.fragmentHint,i),e.alignedSliding=!0}function aj(i,e){i&&(AH(e,i),!e.alignedSliding&&i&&r3(e,i),!e.alignedSliding&&i&&!e.skippedSegments&&mH(i,e,!1))}function AH(i,e){if(!rj(e,i))return;const t=Math.min(e.endCC,i.endCC),n=aA(e.fragments,t),s=aA(i.fragments,t);if(!n||!s)return;oi.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const r=n.start-s.start;bH(r,i)}function r3(i,e){if(!i.hasProgramDateTime||!e.hasProgramDateTime)return;const t=i.fragments,n=e.fragments;if(!t.length||!n.length)return;let s,r;const a=Math.min(e.endCC,i.endCC);e.startCC<a&&i.startCC<a&&(s=aA(n,a),r=aA(t,a)),(!s||!r)&&(s=n[Math.floor(n.length/2)],r=aA(t,s.cc)||t[Math.floor(t.length/2)]);const o=s.programDateTime,l=r.programDateTime;if(!o||!l)return;const c=(l-o)/1e3-(r.start-s.start);bH(c,i)}const oj={toString:function(i){let e="";const t=i.length;for(let n=0;n<t;n++)e+=`[${i.start(n).toFixed(3)}-${i.end(n).toFixed(3)}]`;return e}},ht={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class jI extends lH{constructor(e,t,n,s,r){super(s,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=ht.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:a,fragCurrent:o,media:l,mediaBuffer:c,state:h}=this,d=l?l.currentTime:0,m=Hn.bufferInfo(c||l,d,a.maxBufferHole);if(this.log(`media seeking to ${Vt(d)?d.toFixed(3):d}, state: ${h}`),this.state===ht.ENDED)this.resetLoadingState();else if(o){const y=a.maxFragLookUpTolerance,x=o.start-y,_=o.start+o.duration+y;if(!m.len||_<m.start||x>m.end){const b=d>_;(d<x||b)&&(b&&o.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),o.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(l){this.fragmentTracker.removeFragmentsInRange(d,1/0,this.playlistType,!0);const y=this.lastCurrentTime;if(d>y&&(this.lastCurrentTime=d),!this.loadingParts){const x=Math.max(m.end,d),_=this.shouldLoadParts(this.getLevelDetails(),x);_&&(this.log(`LL-Part loading ON after seeking to ${d.toFixed(2)} with buffer @${x.toFixed(2)}`),this.loadingParts=_)}}!this.hls.hasEnoughToStart&&!m.len&&(this.log(`setting startPosition to ${d} because of seek before start`),this.nextLoadPosition=this.startPosition=d),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=r,this.hls=e,this.fragmentLoader=new PX(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new YI(e.config)}registerListeners(){const{hls:e}=this;e.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(H.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(H.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===ht.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ht.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const n=e.end||0,s=this.config.timelineOffset||0;if(n<=s)return!1;const r=e.nextStart;if(r&&r>s&&r<t.edge||this.media.currentTime<e.start)return!1;const o=t.partList;if(o!=null&&o.length){const c=o[o.length-1];return Hn.isBuffered(this.media,c.start+c.duration/2)}const l=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(l)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;n.removeEventListener("seeking",this.onMediaSeeking),n.removeEventListener("ended",this.onMediaEnded),n.addEventListener("seeking",this.onMediaSeeking),n.addEventListener("ended",this.onMediaEnded);const s=this.config;this.levels&&s.autoStartLoad&&this.state===ht.STOPPED&&this.startLoad(s.startPosition)}onMediaDetaching(e,t){const n=!!t.transferMedia,s=this.media;if(s!==null){if(s.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),s.removeEventListener("seeking",this.onMediaSeeking),s.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!n&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,n){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=ht.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this.startFragRequested=!0,this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const s=r=>{const a=r.frag;if(this.fragContextChanged(a)){this.warn(`${a.type} sn: ${a.sn}${r.part?" part: "+r.part.index:""} of ${this.fragInfo(a,!1,r.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(a);return}a.stats.chunkCount++,this._handleFragmentLoadProgress(r)};this._doFragLoad(e,t,n,s).then(r=>{if(!r)return;const a=this.state,o=r.frag;if(this.fragContextChanged(o)){(a===ht.FRAG_LOADING||!this.fragCurrent&&a===ht.PARSING)&&(this.fragmentTracker.removeFragment(o),this.state=ht.IDLE);return}"payload"in r&&(this.log(`Loaded ${o.type} sn: ${o.sn} of ${this.playlistLabel()} ${o.level}`),this.hls.trigger(H.FRAG_LOADED,r)),this._handleFragmentLoadComplete(r)}).catch(r=>{this.state===ht.STOPPED||this.state===ht.ERROR||(this.warn(`Frag error: ${(r==null?void 0:r.message)||r}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===Tr.APPENDING){const r=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,r),o=Math.max(e.duration,a?a.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(o,e.duration))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Tr.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(t==null?void 0:t.live)&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const s={startOffset:e,endOffset:t,type:n};this.hls.trigger(H.BUFFER_FLUSHING,s)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{const s=n==null?void 0:n.frag;if(!s||this.fragContextChanged(s)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:s}=this,{frag:r,payload:a}=n,o=r.decryptdata;if(a&&a.byteLength>0&&o!=null&&o.key&&o.iv&&yy(o.method)){const l=self.performance.now();return this.decrypter.decrypt(new Uint8Array(a),o.key.buffer,o.iv.buffer,WI(o.method)).catch(c=>{throw s.trigger(H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:r}),c}).then(c=>{const h=self.performance.now();return s.trigger(H.FRAG_DECRYPTED,{frag:r,payload:c,stats:{tstart:l,tdecrypt:h}}),n.payload=c,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===ht.STOPPED||this.state===ht.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state!==ht.STOPPED&&(this.state=ht.IDLE),e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const n=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${n?oj.toString(Hn.getBuffered(n)):"(detached)"})`),zr(e)){var s;if(e.type!==Zt.SUBTITLE){const a=e.elementaryStreams;if(!Object.keys(a).some(o=>!!a[o])){this.state=ht.IDLE;return}}const r=(s=this.levels)==null?void 0:s[e.level];r!=null&&r.fragmentError&&(this.log(`Resetting level fragment error count of ${r.fragmentError} on frag buffered`),r.fragmentError=0)}this.state=ht.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:s,partsLoaded:r}=e,a=!r||r.length===0||r.some(l=>!l),o=new KI(n.level,n.sn,n.stats.chunkCount+1,0,s?s.index:-1,!a);t.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,s){var r;this.fragCurrent=e;const a=t==null?void 0:t.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;e.encrypted&&!((r=e.decryptdata)!=null&&r.key)?(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=ht.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(d=>{if(!this.fragContextChanged(d.frag))return this.hls.trigger(H.KEY_LOADED,d),this.state===ht.KEY_LOADING&&(this.state=ht.IDLE),d}),this.hls.trigger(H.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&a.encryptedFragments.length&&this.keyLoader.loadClear(e,a.encryptedFragments);const l=this.fragPrevious;if(zr(e)&&(!l||e.sn!==l.sn)){const d=this.shouldLoadParts(t.details,e.end);d!==this.loadingParts&&(this.log(`LL-Part loading ${d?"ON":"OFF"} loading sn ${l==null?void 0:l.sn}->${e.sn}`),this.loadingParts=d)}if(n=Math.max(e.start,n||0),this.loadingParts&&zr(e)){const d=a.partList;if(d&&s){n>e.end&&a.fragmentHint&&(e=a.fragmentHint);const m=this.getNextPart(d,e,n);if(m>-1){const y=d[m];e=this.fragCurrent=y.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${y.index} (${m}/${d.length-1}) of ${this.fragInfo(e,!1,y)}) cc: ${e.cc} [${a.startSN}-${a.endSN}], target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=y.start+y.duration,this.state=ht.FRAG_LOADING;let x;return o?x=o.then(_=>!_||this.fragContextChanged(_.frag)?null:this.doFragPartsLoad(e,y,t,s)).catch(_=>this.handleFragLoadError(_)):x=this.doFragPartsLoad(e,y,t,s).catch(_=>this.handleFragLoadError(_)),this.hls.trigger(H.FRAG_LOADING,{frag:e,part:y,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):x}else if(!e.url||this.loadedEndOfParts(d,n))return Promise.resolve(null)}}if(zr(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${n.toFixed(2)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${a?"["+a.startSN+"-"+a.endSN+"]":""}, target: ${parseFloat(n.toFixed(3))}`),Vt(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=ht.FRAG_LOADING;const c=this.config.progressive;let h;return c&&o?h=o.then(d=>!d||this.fragContextChanged(d==null?void 0:d.frag)?null:this.fragmentLoader.load(e,s)).catch(d=>this.handleFragLoadError(d)):h=Promise.all([this.fragmentLoader.load(e,c?s:void 0),o]).then(([d])=>(!c&&d&&s&&s(d),d)).catch(d=>this.handleFragLoadError(d)),this.hls.trigger(H.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):h}doFragPartsLoad(e,t,n,s){return new Promise((r,a)=>{var o;const l=[],c=(o=n.details)==null?void 0:o.partList,h=d=>{this.fragmentLoader.loadPart(e,d,s).then(m=>{l[d.index]=m;const y=m.part;this.hls.trigger(H.FRAG_LOADED,m);const x=kN(n.details,e.sn,d.index+1)||vH(c,e.sn,d.index+1);if(x)h(x);else return r({frag:e,part:y,partsLoaded:l})}).catch(a)};h(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===Pe.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(H.ERROR,t)}else this.hls.trigger(H.ERROR,{type:nn.OTHER_ERROR,details:Pe.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==ht.PARSING){!this.fragCurrent&&this.state!==ht.STOPPED&&this.state!==ht.ERROR&&(this.state=ht.IDLE);return}const{frag:n,part:s,level:r}=t,a=self.performance.now();n.stats.parsing.end=a,s&&(s.stats.parsing.end=a);const o=this.getLevelDetails(),c=o&&n.sn>o.endSN||this.shouldLoadParts(o,n.end);c!==this.loadingParts&&(this.log(`LL-Part loading ${c?"ON":"OFF"} after parsing segment ending @${n.end.toFixed(2)}`),this.loadingParts=c),this.updateLevelTiming(n,s,r,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e!=null&&e.partList){var n;const r=e.partList[0],a=r.end+(((n=e.fragmentHint)==null?void 0:n.duration)||0);if(t>=a){var s;if((this.hls.hasEnoughToStart?((s=this.media)==null?void 0:s.currentTime)||this.lastCurrentTime:this.getLoadPosition())>r.start-r.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:s,sn:r,part:a}=e;if(!(t!=null&&t[s]))return this.warn(`Levels object was unset while buffering fragment ${r} of ${this.playlistLabel()} ${s}. The current chunk will not be buffered.`),null;const o=t[s],l=o.details,c=a>-1?kN(l,r,a):null,h=c?c.fragment:yH(l,r,n);return h?(n&&n!==h&&(h.stats=n.stats),{frag:h,part:c,level:o}):null}bufferFragmentData(e,t,n,s,r){var a;if(!e||this.state!==ht.PARSING)return;const{data1:o,data2:l}=e;let c=o;if(o&&l&&(c=Fl(o,l)),!((a=c)!=null&&a.length))return;const h={type:e.type,frag:t,part:n,chunkMeta:s,parent:t.type,data:c};if(this.hls.trigger(H.BUFFER_APPENDING,h),e.dropped&&e.independent&&!n){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Hn.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,s=Hn.bufferInfo(t,n,0),r=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,r*.25),o=Math.max(Math.min(e.start-a,s.end-a),n+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,t){var n;const s=this.getLoadPosition();if(!Vt(s))return null;const a=this.lastCurrentTime>s||(n=this.media)!=null&&n.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,s,t,a)}getFwdBufferInfoAtPos(e,t,n,s){const r=Hn.bufferInfo(e,t,s);if(r.len===0&&r.nextStart!==void 0){const a=this.fragmentTracker.getBufferedFrag(t,n);if(a&&(r.nextStart<=a.end||a.gap)){const o=Math.max(Math.min(r.nextStart,a.end)-t,s);return Hn.bufferInfo(e,t,o)}}return r}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,s=Math.max(Math.min(e-t,n.maxBufferLength),t),r=Math.max(e-t*3,n.maxMaxBufferLength/2,s);return r>=s?(n.maxMaxBufferLength=r,this.warn(`Reduce max buffer length to ${r}s`),!0):!1}getAppendedFrag(e,t=Zt.MAIN){var n;const s=(n=this.fragmentTracker)==null?void 0:n.getAppendedFrag(e,t);return s&&"fragment"in s?s.fragment:s}getNextFragment(e,t){const n=t.fragments,s=n.length;if(!s)return null;const{config:r}=this,a=n[0].start,o=r.lowLatencyMode&&!!t.partList;let l=null;if(t.live){const d=r.initialLiveManifestSize;if(s<d)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${d})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<a){var c;o&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),l=this.getInitialLiveFragment(t,n);const m=this.hls.startPosition,y=this.hls.liveSyncPosition,x=l?(m!==-1&&m>=a?m:y)||l.start:e;this.log(`Setting startPosition to ${x} to match start frag at live edge. mainStart: ${m} liveSyncPosition: ${y} frag.start: ${(c=l)==null?void 0:c.start}`),this.startPosition=this.nextLoadPosition=x}}else e<=a&&(l=n[0]);if(!l){const d=this.loadingParts?t.partEnd:t.fragmentEnd;l=this.getFragmentAtPosition(e,d,t)}let h=this.filterReplacedPrimary(l,t);if(!h&&l){const d=l.sn-t.startSN;h=this.filterReplacedPrimary(n[d+1]||null,t)}return this.mapToInitFragWhenRequired(h)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===Tr.OK||n===Tr.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,s,r){let a=null;if(e.gap&&(a=this.getNextFragment(this.nextLoadPosition,t),a&&!a.gap&&n.nextStart)){const o=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,s,0);if(o!==null&&n.len+o.len>=r){const l=a.sn;return this.loopSn!==l&&(this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${l}`),this.loopSn=l),null}}return this.loopSn=void 0,a}get primaryPrefetch(){if(HN(this.hls.config)){var e,t;if((e=this.hls.interstitialsManager)==null||(t=e.playingItem)==null?void 0:t.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(HN(this.hls.config)&&e.type!==Zt.SUBTITLE){const n=this.hls.interstitialsManager,s=n==null?void 0:n.bufferingItem;if(s){const a=s.event;if(a){if(a.appendInPlace||Math.abs(e.start-s.start)>1||s.start===0)return null}else if(e.end<=s.start&&(t==null?void 0:t.live)===!1||e.start>s.end&&s.nextEvent&&(s.nextEvent.appendInPlace||e.start-s.end>1))return null}const r=n==null?void 0:n.playerQueue;if(r)for(let a=r.length;a--;){const o=r[a].interstitial;if(o.appendInPlace&&e.start>=o.startTime&&e.end<=o.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let s=-1,r=!1,a=!0;for(let o=0,l=e.length;o<l;o++){const c=e[o];if(a=a&&!c.independent,s>-1&&n<c.start)break;const h=c.loaded;h?s=-1:(r||c.independent||a)&&c.fragment===t&&(s=o),r=h}return s}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let s=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),s=EX(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){const r=n.sn+1;if(r>=e.startSN&&r<=e.endSN){const a=t[r-e.startSN];n.cc===a.cc&&(s=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=oH(t,n.cc),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{const r=this.hls.liveSyncPosition;r!==null&&(s=this.getFragmentAtPosition(r,this.bitrateTest?e.fragmentEnd:e.edge,e))}return s}getFragmentAtPosition(e,t,n){const{config:s}=this;let{fragPrevious:r}=this,{fragments:a,endSN:o}=n;const{fragmentHint:l}=n,{maxFragLookUpTolerance:c}=s,h=n.partList,d=!!(this.loadingParts&&h!=null&&h.length&&l);d&&l&&!this.bitrateTest&&h[h.length-1].fragment.sn===l.sn&&(a=a.concat(l),o=l.sn);let m;if(e<t){var y;const _=e<this.lastCurrentTime||e>t-c||(y=this.media)!=null&&y.paused||!this.startFragRequested?0:c;m=ig(r,a,e,_)}else m=a[a.length-1];if(m){const x=m.sn-n.startSN,_=this.fragmentTracker.getState(m);if((_===Tr.OK||_===Tr.PARTIAL&&m.gap)&&(r=m),r&&m.sn===r.sn&&(!d||h[0].fragment.sn>m.sn||!n.live&&!d)&&r&&m.level===r.level){const A=a[x+1];m.sn<o&&this.fragmentTracker.getState(A)!==Tr.OK?m=A:m=null}}return m}alignPlaylists(e,t,n){const s=e.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;const r=e.fragmentStart,a=!t,o=e.alignedSliding&&Vt(r);if(a||!o&&!r){aj(n,e);const l=e.fragmentStart;return this.log(`Live playlist sliding: ${l.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${s}`),l}return r}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;n<t&&(n=-1);const s=this.timelineOffset;if(n===-1){const r=this.startTimeOffset!==null,a=r?this.startTimeOffset:e.startTimeOffset;a!==null&&Vt(a)?(n=t+a,a<0&&(n+=e.edge),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Setting startPosition to ${n} for start time offset ${a} found in ${r?"multivariant":"media"} playlist`),this.startPosition=n):e.live?(n=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${n}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=n=0),this.lastCurrentTime=n+s}this.nextLoadPosition=n+s}getLoadPosition(){var e;const{media:t}=this;let n=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?n=t.currentTime:this.nextLoadPosition>=0&&(n=this.nextLoadPosition),n}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&zr(e)&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==ht.FRAG_LOADING_WAITING_RETRY)&&(this.state=ht.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const x=this.getCurrentContext(t.chunkMeta);x&&(t.frag=x.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var s;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(s=this.fragCurrent)==null?void 0:s.url}`);return}const r=t.details===Pe.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(n,!0);const a=t.errorAction,{action:o,flags:l,retryCount:c=0,retryConfig:h}=a||{},d=!!a&&!!h,m=d&&o===Ra.RetryRequest,y=d&&!a.resolved&&l===Rc.MoveAllAlternatesMatchingHost;if(!m&&y&&zr(n)&&!n.endList)this.resetFragmentErrors(e),this.treatAsGap(n),a.resolved=!0;else if((m||y)&&c<h.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);const x=VI(h,c);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${c+1}/${h.maxNumRetry} in ${x}ms`),a.resolved=!0,this.retryDate=self.performance.now()+x,this.state=ht.FRAG_LOADING_WAITING_RETRY}else if(h&&a)if(this.resetFragmentErrors(e),c<h.maxNumRetry)!r&&o!==Ra.RemoveAlternatePermanently&&(a.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${c})`);return}else o===Ra.SendAlternateToPenaltyBox?this.state=ht.WAITING_LEVEL:this.state=ht.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===ht.PARSING||this.state===ht.PARSED){const t=e.frag,n=e.parent,s=this.getFwdBufferInfo(this.mediaBuffer,n),r=s&&s.len>.5;r&&this.reduceMaxBufferLength(s.len,(t==null?void 0:t.duration)||10);const a=!r;return a&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),a}return!1}resetFragmentErrors(e){e===Zt.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==ht.STOPPED&&(this.state=ht.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const s=Hn.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,s,n),this.state===ht.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==ht.STOPPED&&(this.state=ht.IDLE)}resetStartWhenNotLoaded(e){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of ${this.playlistLabel()} ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,s){const r=n.details;if(!r){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,c)=>{const h=e.elementaryStreams[c];if(h){const d=h.endPTS-h.startPTS;if(d<=0)return this.warn(`Could not parse fragment ${e.sn} ${c} duration reliably (${d})`),l||!1;const m=s?0:pH(r,e,h.startPTS,h.endPTS,h.startDTS,h.endDTS);return this.hls.trigger(H.LEVEL_PTS_UPDATED,{details:r,level:n,drift:m,type:c,frag:e,start:h.startPTS,end:h.endPTS}),!0}return l},!1)){var o;if(n.fragmentError===0&&this.treatAsGap(e,n),((o=this.transmuxer)==null?void 0:o.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(l.message),this.hls.trigger(H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=ht.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(H.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===Zt.MAIN?"level":"track"}fragInfo(e,t=!0,n){var s,r;return`${this.playlistLabel()} ${e.level} (${n?"part":"frag"}:[${((s=t&&!n?e.startPTS:(n||e).start)!=null?s:NaN).toFixed(3)}-${((r=t&&!n?e.endPTS:(n||e).end)!=null?r:NaN).toFixed(3)}]${n&&e.type==="main"?"INDEPENDENT="+(n.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function HN(i){return!!i.interstitialsController&&i.enableInterstitialPlayback!==!1}class EH{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=lj(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function lj(i,e){const t=new Uint8Array(e);let n=0;for(let s=0;s<i.length;s++){const r=i[s];t.set(r,n),n+=r.length}return t}var UC={exports:{}},GN;function cj(){return GN||(GN=1,function(i){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function s(l,c,h){this.fn=l,this.context=c,this.once=h||!1}function r(l,c,h,d,m){if(typeof h!="function")throw new TypeError("The listener must be a function");var y=new s(h,d||l,m),x=t?t+c:c;return l._events[x]?l._events[x].fn?l._events[x]=[l._events[x],y]:l._events[x].push(y):(l._events[x]=y,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],h,d;if(this._eventsCount===0)return c;for(d in h=this._events)e.call(h,d)&&c.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(h)):c},o.prototype.listeners=function(c){var h=t?t+c:c,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var m=0,y=d.length,x=new Array(y);m<y;m++)x[m]=d[m].fn;return x},o.prototype.listenerCount=function(c){var h=t?t+c:c,d=this._events[h];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,h,d,m,y,x){var _=t?t+c:c;if(!this._events[_])return!1;var b=this._events[_],A=arguments.length,T,w;if(b.fn){switch(b.once&&this.removeListener(c,b.fn,void 0,!0),A){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,h),!0;case 3:return b.fn.call(b.context,h,d),!0;case 4:return b.fn.call(b.context,h,d,m),!0;case 5:return b.fn.call(b.context,h,d,m,y),!0;case 6:return b.fn.call(b.context,h,d,m,y,x),!0}for(w=1,T=new Array(A-1);w<A;w++)T[w-1]=arguments[w];b.fn.apply(b.context,T)}else{var R=b.length,O;for(w=0;w<R;w++)switch(b[w].once&&this.removeListener(c,b[w].fn,void 0,!0),A){case 1:b[w].fn.call(b[w].context);break;case 2:b[w].fn.call(b[w].context,h);break;case 3:b[w].fn.call(b[w].context,h,d);break;case 4:b[w].fn.call(b[w].context,h,d,m);break;default:if(!T)for(O=1,T=new Array(A-1);O<A;O++)T[O-1]=arguments[O];b[w].fn.apply(b[w].context,T)}}return!0},o.prototype.on=function(c,h,d){return r(this,c,h,d,!1)},o.prototype.once=function(c,h,d){return r(this,c,h,d,!0)},o.prototype.removeListener=function(c,h,d,m){var y=t?t+c:c;if(!this._events[y])return this;if(!h)return a(this,y),this;var x=this._events[y];if(x.fn)x.fn===h&&(!m||x.once)&&(!d||x.context===d)&&a(this,y);else{for(var _=0,b=[],A=x.length;_<A;_++)(x[_].fn!==h||m&&!x[_].once||d&&x[_].context!==d)&&b.push(x[_]);b.length?this._events[y]=b.length===1?b[0]:b:a(this,y)}return this},o.prototype.removeAllListeners=function(c){var h;return c?(h=t?t+c:c,this._events[h]&&a(this,h)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,i.exports=o}(UC)),UC.exports}var uj=cj(),qI=kW(uj);const PA="1.6.2",yv={};function hj(){return typeof __HLS_WORKER_BUNDLE__=="function"}function fj(){const i=yv[PA];if(i)return i.clientCount++,i;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),s={worker:new self.Worker(t),objectURL:t,clientCount:1};return yv[PA]=s,s}function dj(i){const e=yv[i];if(e)return e.clientCount++,e;const t=new self.URL(i,self.location.href).href,s={worker:new self.Worker(t),scriptURL:t,clientCount:1};return yv[i]=s,s}function pj(i){const e=yv[i||PA];if(e&&e.clientCount--===1){const{worker:n,objectURL:s}=e;delete yv[i||PA],s&&self.URL.revokeObjectURL(s),n.terminate()}}function _H(i,e){return e+10<=i.length&&i[e]===51&&i[e+1]===68&&i[e+2]===73&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128}function QI(i,e){return e+10<=i.length&&i[e]===73&&i[e+1]===68&&i[e+2]===51&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128}function Pw(i,e){let t=0;return t=(i[e]&127)<<21,t|=(i[e+1]&127)<<14,t|=(i[e+2]&127)<<7,t|=i[e+3]&127,t}function NA(i,e){const t=e;let n=0;for(;QI(i,e);){n+=10;const s=Pw(i,e+6);n+=s,_H(i,e+10)&&(n+=10),e+=n}if(n>0)return i.subarray(t,t+n)}function mj(i,e,t,n){const s=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],r=e[t+2],a=r>>2&15;if(a>12){const y=new Error(`invalid ADTS sampling index:${a}`);i.emit(H.ERROR,H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.FRAG_PARSING_ERROR,fatal:!0,error:y,reason:y.message});return}const o=(r>>6&3)+1,l=e[t+3]>>6&3|(r&1)<<2,c="mp4a.40."+o,h=s[a];let d=a;(o===5||o===29)&&(d-=3);const m=[o<<3|(d&14)>>1,(d&1)<<7|l<<3];return oi.log(`manifest codec:${n}, parsed codec:${c}, channels:${l}, rate:${h} (ADTS object type:${o} sampling index:${a})`),{config:m,samplerate:h,channelCount:l,codec:c,parsedCodec:c,manifestCodec:n}}function SH(i,e){return i[e]===255&&(i[e+1]&246)===240}function TH(i,e){return i[e+1]&1?7:9}function $I(i,e){return(i[e+3]&3)<<11|i[e+4]<<3|(i[e+5]&224)>>>5}function gj(i,e){return e+5<i.length}function a3(i,e){return e+1<i.length&&SH(i,e)}function yj(i,e){return gj(i,e)&&SH(i,e)&&$I(i,e)<=i.length-e}function vj(i,e){if(a3(i,e)){const t=TH(i,e);if(e+t>=i.length)return!1;const n=$I(i,e);if(n<=t)return!1;const s=e+n;return s===i.length||a3(i,s)}return!1}function wH(i,e,t,n,s){if(!i.samplerate){const r=mj(e,t,n,s);if(!r)return;Yi(i,r)}}function MH(i){return 1024*9e4/i}function xj(i,e){const t=TH(i,e);if(e+t<=i.length){const n=$I(i,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function CH(i,e,t,n,s){const r=MH(i.samplerate),a=n+s*r,o=xj(e,t);let l;if(o){const{frameLength:d,headerLength:m}=o,y=m+d,x=Math.max(0,t+y-e.length);x?(l=new Uint8Array(y-m),l.set(e.subarray(t+m,e.length),0)):l=e.subarray(t+m,t+y);const _={unit:l,pts:a};return x||i.samples.push(_),{sample:_,length:y,missing:x}}const c=e.length-t;return l=new Uint8Array(c),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:a},length:c,missing:-1}}function bj(i,e){return QI(i,e)&&Pw(i,e+6)+10<=i.length-e}function Aj(i){if(i.size<2)return;const e=el(i.data,!0),t=new Uint8Array(i.data.subarray(e.length+1));return{key:i.type,info:e,data:t.buffer}}function Ej(i){if(i.size<2)return;if(i.type==="TXXX"){let t=1;const n=el(i.data.subarray(t),!0);t+=n.length+1;const s=el(i.data.subarray(t));return{key:i.type,info:n,data:s}}const e=el(i.data.subarray(1));return{key:i.type,info:"",data:e}}function _j(i){if(i.type==="WXXX"){if(i.size<2)return;let t=1;const n=el(i.data.subarray(t),!0);t+=n.length+1;const s=el(i.data.subarray(t));return{key:i.type,info:n,data:s}}const e=el(i.data);return{key:i.type,info:"",data:e}}function Sj(i){return btoa(String.fromCharCode(...i))}function RH(i,e){if(i<0)return-RH(-i,e);const t=Math.pow(10,e);if(Math.abs(i*t%1-.5)<Number.EPSILON){const s=Math.floor(i*t);return(s%2===0?s:s+1)/t}else return Math.round(i*t)/t}function Tj(i,e){const t=new URL(i),n=new URL(e);if(t.origin!==n.origin)return i;const s=t.pathname.split("/").slice(1),r=n.pathname.split("/").slice(1,-1);for(;s[0]===r[0];)s.shift(),r.shift();for(;r.length;)r.shift(),s.unshift("..");return s.join("/")}function wj(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const r=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(s=="x"?r:r&3|8).toString(16)})}}}function Mj(i){return i instanceof ArrayBuffer?i:i.byteOffset==0&&i.byteLength==i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer}function kC(i,e=0,t=1/0){return Cj(i,e,t,Uint8Array)}function Cj(i,e,t,n){const s=Rj(i);let r=1;"BYTES_PER_ELEMENT"in n&&(r=n.BYTES_PER_ELEMENT);const a=Dj(i)?i.byteOffset:0,o=(a+i.byteLength)/r,l=(a+e)/r,c=Math.floor(Math.max(0,Math.min(l,o))),h=Math.floor(Math.min(c+Math.max(t,0),o));return new n(s,c,h-c)}function Rj(i){return i instanceof ArrayBuffer?i:i.buffer}function Dj(i){return i&&i.buffer instanceof ArrayBuffer&&i.byteLength!==void 0&&i.byteOffset!==void 0}function Lj(i){const e={key:i.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(i.size<2)return;if(i.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const n=i.data.subarray(1).indexOf(0);if(n===-1)return;const s=el(kC(i.data,1,n)),r=i.data[2+n],a=i.data.subarray(3+n).indexOf(0);if(a===-1)return;const o=el(kC(i.data,3+n,a));let l;return s==="-->"?l=el(kC(i.data,4+n+a)):l=Mj(i.data.subarray(4+n+a)),e.mimeType=s,e.pictureType=r,e.description=o,e.data=l,e}function Ij(i){return i.type==="PRIV"?Aj(i):i.type[0]==="W"?_j(i):i.type==="APIC"?Lj(i):Ej(i)}function Bj(i){const e=String.fromCharCode(i[0],i[1],i[2],i[3]),t=Pw(i,4),n=10;return{type:e,size:t,data:i.subarray(n,n+t)}}const G_=10,Oj=10;function DH(i){let e=0;const t=[];for(;QI(i,e);){const n=Pw(i,e+6);i[e+5]>>6&1&&(e+=G_),e+=G_;const s=e+n;for(;e+Oj<s;){const r=Bj(i.subarray(e)),a=Ij(r);a&&t.push(a),e+=r.size+G_}_H(i,e)&&(e+=G_)}return t}function LH(i){return i&&i.key==="PRIV"&&i.info==="com.apple.streaming.transportStreamTimestamp"}function Pj(i){if(i.data.byteLength===8){const e=new Uint8Array(i.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}}function JI(i){const e=DH(i);for(let t=0;t<e.length;t++){const n=e[t];if(LH(n))return Pj(n)}}let Zo=function(i){return i.audioId3="org.id3",i.dateRange="com.apple.quicktime.HLS",i.emsg="https://aomedia.org/emsg/ID3",i.misbklv="urn:misb:KLV:bin:1910.1",i}({});function th(i="",e=9e4){return{type:i,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class ZI{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=Fl(this.cachedData,e),this.cachedData=null);let n=NA(e,0),s=n?n.length:0,r;const a=this._audioTrack,o=this._id3Track,l=n?JI(n):void 0,c=e.length;for((this.basePTS===null||this.frameIndex===0&&Vt(l))&&(this.basePTS=Nj(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Zo.audioId3,duration:Number.POSITIVE_INFINITY});s<c;){if(this.canParse(e,s)){const h=this.appendFrame(a,e,s);h?(this.frameIndex++,this.lastPTS=h.sample.pts,s+=h.length,r=s):s=c}else bj(e,s)?(n=NA(e,s),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Zo.audioId3,duration:Number.POSITIVE_INFINITY}),s+=n.length,r=s):s++;if(s===c&&r!==c){const h=e.slice(r);this.cachedData?this.cachedData=Fl(this.cachedData,h):this.cachedData=h}}return{audioTrack:a,videoTrack:th(),id3Track:o,textTrack:th()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:th(),id3Track:this._id3Track,textTrack:th()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const Nj=(i,e,t)=>{if(Vt(i))return i*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};let z_=null;const Uj=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],kj=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Fj=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Hj=[0,1,1,4];function IH(i,e,t,n,s){if(t+24>e.length)return;const r=BH(e,t);if(r&&t+r.frameLength<=e.length){const a=r.samplesPerFrame*9e4/r.sampleRate,o=n+s*a,l={unit:e.subarray(t,t+r.frameLength),pts:o,dts:o};return i.config=[],i.channelCount=r.channelCount,i.samplerate=r.sampleRate,i.samples.push(l),{sample:l,length:r.frameLength,missing:0}}}function BH(i,e){const t=i[e+1]>>3&3,n=i[e+1]>>1&3,s=i[e+2]>>4&15,r=i[e+2]>>2&3;if(t!==1&&s!==0&&s!==15&&r!==3){const a=i[e+2]>>1&1,o=i[e+3]>>6,l=t===3?3-n:n===3?3:4,c=Uj[l*14+s-1]*1e3,d=kj[(t===3?0:t===2?1:2)*3+r],m=o===3?1:2,y=Fj[t][n],x=Hj[n],_=y*8*x,b=Math.floor(y*c/d+a)*x;if(z_===null){const w=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);z_=w?parseInt(w[1]):0}return!!z_&&z_<=87&&n===2&&c>=224e3&&o===0&&(i[e+3]=i[e+3]|128),{sampleRate:d,channelCount:m,frameLength:b,samplesPerFrame:_}}}function eB(i,e){return i[e]===255&&(i[e+1]&224)===224&&(i[e+1]&6)!==0}function OH(i,e){return e+1<i.length&&eB(i,e)}function Gj(i,e){return eB(i,e)&&4<=i.length-e}function PH(i,e){if(e+1<i.length&&eB(i,e)){const n=BH(i,e);let s=4;n!=null&&n.frameLength&&(s=n.frameLength);const r=e+s;return r===i.length||OH(i,r)}return!1}class zj extends ZI{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,s){super.resetInitSegment(e,t,n,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const n=NA(e,0);let s=(n==null?void 0:n.length)||0;if(PH(e,s))return!1;for(let r=e.length;s<r;s++)if(vj(e,s))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return yj(e,t)}appendFrame(e,t,n){wH(e,this.observer,t,n,e.manifestCodec);const s=CH(e,t,n,this.basePTS,this.frameIndex);if(s&&s.missing===0)return s}}const NH=(i,e)=>{let t=0,n=5;e+=n;const s=new Uint32Array(1),r=new Uint32Array(1),a=new Uint8Array(1);for(;n>0;){a[0]=i[e];const o=Math.min(n,8),l=8-o;r[0]=4278190080>>>24+l<<l,s[0]=(a[0]&r[0])>>l,t=t?t<<o|s[0]:s[0],e+=1,n-=o}return t};class Vj extends ZI{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,s){super.resetInitSegment(e,t,n,s),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const s=UH(e,t,n,this.basePTS,this.frameIndex);if(s!==-1)return{sample:e.samples[e.samples.length-1],length:s,missing:0}}static probe(e){if(!e)return!1;const t=NA(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&JI(t)!==void 0&&NH(e,n)<16}}function UH(i,e,t,n,s){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const r=e[t+4]>>6;if(r>=3)return-1;const o=[48e3,44100,32e3][r],l=e[t+4]&63,h=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+r]*2;if(t+h>e.length)return-1;const d=e[t+6]>>5;let m=0;d===2?m+=2:(d&1&&d!==1&&(m+=2),d&4&&(m+=2));const y=(e[t+6]<<8|e[t+7])>>12-m&1,_=[2,1,2,3,3,4,4,5][d]+y,b=e[t+5]>>3,A=e[t+5]&7,T=new Uint8Array([r<<6|b<<1|A>>2,(A&3)<<6|d<<3|y<<2|l>>4,l<<4&224]),w=1536/o*9e4,R=n+s*w,O=e.subarray(t,t+h);return i.config=T,i.channelCount=_,i.samplerate=o,i.samples.push({unit:O,pts:R}),h}class Yj extends ZI{resetInitSegment(e,t,n,s){super.resetInitSegment(e,t,n,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=NA(e,0);let n=(t==null?void 0:t.length)||0;if(t&&e[n]===11&&e[n+1]===119&&JI(t)!==void 0&&NH(e,n)<=16)return!1;for(let s=e.length;n<s;n++)if(PH(e,n))return oi.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return Gj(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return IH(e,t,n,this.basePTS,this.frameIndex)}}const Kj=/\/emsg[-/]ID3/i;class Wj{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,s){const r=this.videoTrack=th("video",1),a=this.audioTrack=th("audio",1),o=this.txtTrack=th("text",1);if(this.id3Track=th("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=Q5(e);if(l.video){const{id:c,timescale:h,codec:d,supplemental:m}=l.video;r.id=c,r.timescale=o.timescale=h,r.codec=d,r.supplemental=m}if(l.audio){const{id:c,timescale:h,codec:d}=l.audio;a.id=c,a.timescale=h,a.codec=d}o.id=X5.text,r.sampleDuration=0,r.duration=a.duration=s}resetContiguity(){this.remainderData=null}static probe(e){return VW(e)}demux(e,t){this.timeOffset=t;let n=e;const s=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Fl(this.remainderData,e));const o=$W(n);this.remainderData=o.remainder,s.samples=o.valid||new Uint8Array}else s.samples=n;const a=this.extractID3Track(s,t);return r.samples=lN(t,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const s=this.extractID3Track(t,this.timeOffset);return n.samples=lN(e,t),{videoTrack:t,audioTrack:th(),id3Track:s,textTrack:th()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const s=Cn(e.samples,["emsg"]);s&&s.forEach(r=>{const a=ZW(r);if(Kj.test(a.schemeIdUri)){const o=zN(a,t);let l=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const c=a.payload;n.samples.push({data:c,len:c.byteLength,dts:o,pts:o,type:Zo.emsg,duration:l})}else if(this.config.enableEmsgKLVMetadata&&a.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const o=zN(a,t);n.samples.push({data:a.payload,len:a.payload.byteLength,dts:o,pts:o,type:Zo.misbklv,duration:Number.POSITIVE_INFINITY})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function zN(i,e){return Vt(i.presentationTime)?i.presentationTime/i.timeScale:e+i.presentationTimeDelta/i.timeScale}class Xj{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new YI(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,I0.cbc)}decryptAacSample(e,t,n){const s=e[t].unit;if(s.length<=16)return;const r=s.subarray(16,s.length-s.length%16),a=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(a).then(o=>{const l=new Uint8Array(o);s.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let s=0;for(let r=32;r<e.length-16;r+=160,s+=16)n.set(e.subarray(r,r+16),s);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let s=0;for(let r=32;r<e.length-16;r+=160,s+=16)e.set(n.subarray(s,s+16),r);return e}decryptAvcSample(e,t,n,s,r){const a=J5(r.data),o=this.getAvcEncryptedData(a);this.decryptBuffer(o.buffer).then(l=>{r.data=this.getAvcDecryptedUnit(a,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,s)})}decryptAvcSamples(e,t,n,s){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){s();return}const r=e[t].units;for(;!(n>=r.length);n++){const a=r[n];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,t,n,s,a),!this.decrypter.isSync()))return}}}}class kH{constructor(){this.VideoSample=null}createVideoSample(e,t,n){return{key:e,frame:!1,pts:t,dts:n,units:[],length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,s;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const r=n.units;s=r[r.length-1]}return s}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,s=n.length;if(s){const r=n[s-1];e.pts=r.pts,e.dts=r.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,n){const s=t.byteLength;let r=e.naluState||0;const a=r,o=[];let l=0,c,h,d,m=-1,y=0;for(r===-1&&(m=0,y=this.getNALuType(t,0),r=0,l=1);l<s;){if(c=t[l++],!r){r=c?0:1;continue}if(r===1){r=c?0:2;continue}if(!c)r=3;else if(c===1){if(h=l-r-1,m>=0){const x={data:t.subarray(m,h),type:y};o.push(x)}else{const x=this.getLastNalUnit(e.samples);x&&(a&&l<=4-a&&x.state&&(x.data=x.data.subarray(0,x.data.byteLength-a)),h>0&&(x.data=Fl(x.data,t.subarray(0,h)),x.state=0))}l<s?(d=this.getNALuType(t,l),m=l,y=d,r=0):r=-1}else r=0}if(m>=0&&r>=0){const x={data:t.subarray(m,s),type:y,state:r};o.push(x)}if(o.length===0){const x=this.getLastNalUnit(e.samples);x&&(x.data=Fl(x.data,t))}return e.naluState=r,o}}class oA{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,s=new Uint8Array(4),r=Math.min(4,t);if(r===0)throw new Error("no bytes available");s.set(e.subarray(n,n+r)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=r*8,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&oi.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class VN extends kH{parsePES(e,t,n,s){const r=this.parseNALu(e,n.data,s);let a=this.VideoSample,o,l=!1;n.data=null,a&&r.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),r.forEach(c=>{var h,d;switch(c.type){case 1:{let _=!1;o=!0;const b=c.data;if(l&&b.length>4){const A=this.readSliceType(b);(A===2||A===4||A===7||A===9)&&(_=!0)}if(_){var m;(m=a)!=null&&m.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.frame=!0,a.key=_;break}case 5:o=!0,(h=a)!=null&&h.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 6:{o=!0,GI(c.data,1,n.pts,t.samples);break}case 7:{var y,x;o=!0,l=!0;const _=c.data,b=this.readSPS(_);if(!e.sps||e.width!==b.width||e.height!==b.height||((y=e.pixelRatio)==null?void 0:y[0])!==b.pixelRatio[0]||((x=e.pixelRatio)==null?void 0:x[1])!==b.pixelRatio[1]){e.width=b.width,e.height=b.height,e.pixelRatio=b.pixelRatio,e.sps=[_];const A=_.subarray(1,4);let T="avc1.";for(let w=0;w<3;w++){let R=A[w].toString(16);R.length<2&&(R="0"+R),T+=R}e.codec=T}break}case 8:o=!0,e.pps=[c.data];break;case 9:o=!0,e.audFound=!0,(d=a)!=null&&d.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;case 12:o=!0;break;default:o=!1;break}a&&o&&a.units.push(c)}),s&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new oA(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let n=8,s=8,r;for(let a=0;a<e;a++)s!==0&&(r=t.readEG(),s=(n+r+256)%256),n=s===0?n:s}readSPS(e){const t=new oA(e);let n=0,s=0,r=0,a=0,o,l,c;const h=t.readUByte.bind(t),d=t.readBits.bind(t),m=t.readUEG.bind(t),y=t.readBoolean.bind(t),x=t.skipBits.bind(t),_=t.skipEG.bind(t),b=t.skipUEG.bind(t),A=this.skipScalingList.bind(this);h();const T=h();if(d(5),x(3),h(),b(),T===100||T===110||T===122||T===244||T===44||T===83||T===86||T===118||T===128){const P=m();if(P===3&&x(1),b(),b(),x(1),y())for(l=P!==3?8:12,c=0;c<l;c++)y()&&(c<6?A(16,t):A(64,t))}b();const w=m();if(w===0)m();else if(w===1)for(x(1),_(),_(),o=m(),c=0;c<o;c++)_();b(),x(1);const R=m(),O=m(),N=d(1);N===0&&x(1),x(1),y()&&(n=m(),s=m(),r=m(),a=m());let U=[1,1];if(y()&&y())switch(h()){case 1:U=[1,1];break;case 2:U=[12,11];break;case 3:U=[10,11];break;case 4:U=[16,11];break;case 5:U=[40,33];break;case 6:U=[24,11];break;case 7:U=[20,11];break;case 8:U=[32,11];break;case 9:U=[80,33];break;case 10:U=[18,11];break;case 11:U=[15,11];break;case 12:U=[64,33];break;case 13:U=[160,99];break;case 14:U=[4,3];break;case 15:U=[3,2];break;case 16:U=[2,1];break;case 255:{U=[h()<<8|h(),h()<<8|h()];break}}return{width:Math.ceil((R+1)*16-n*2-s*2),height:(2-N)*(O+1)*16-(N?2:4)*(r+a),pixelRatio:U}}}class YN extends kH{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,n,s){const r=this.parseNALu(e,n.data,s);let a=this.VideoSample,o,l=!1;n.data=null,a&&r.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),r.forEach(c=>{var h,d;switch(c.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),a.frame=!0,o=!0;break;case 16:case 17:case 18:case 21:if(o=!0,l){var m;(m=a)!=null&&m.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:o=!0,(h=a)!=null&&h.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 39:o=!0,GI(c.data,2,n.pts,t.samples);break;case 32:o=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=Yi(e.params,this.readVPS(c.data)),this.initVPS=c.data),e.vps=[c.data];break;case 33:if(o=!0,l=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],c.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const y=this.readSPS(c.data);e.width=y.width,e.height=y.height,e.pixelRatio=y.pixelRatio,e.codec=y.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const x in y.params)e.params[x]=y.params[x]}this.pushParameterSet(e.sps,c.data,e.vps),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0;break;case 34:if(o=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const y=this.readPPS(c.data);for(const x in y)e.params[x]=y[x]}this.pushParameterSet(e.pps,c.data,e.vps)}break;case 35:o=!0,e.audFound=!0,(d=a)!=null&&d.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;default:o=!1;break}a&&o&&a.units.push(c)}),s&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}pushParameterSet(e,t,n){(n&&n[0]===this.initVPS||!n&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let n=0;for(let s=0;s<e.byteLength;s++)s>=2&&e[s]===3&&e[s-1]===0&&e[s-2]===0||(t[n]=e[s],n++);return new Uint8Array(t.buffer,0,n)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new oA(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const n=t.readBits(3),s=t.readBoolean();return{numTemporalLayers:n+1,temporalIdNested:s}}readSPS(e){const t=new oA(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const n=t.readBits(3);t.readBoolean();const s=t.readBits(2),r=t.readBoolean(),a=t.readBits(5),o=t.readUByte(),l=t.readUByte(),c=t.readUByte(),h=t.readUByte(),d=t.readUByte(),m=t.readUByte(),y=t.readUByte(),x=t.readUByte(),_=t.readUByte(),b=t.readUByte(),A=t.readUByte(),T=[],w=[];for(let Ve=0;Ve<n;Ve++)T.push(t.readBoolean()),w.push(t.readBoolean());if(n>0)for(let Ve=n;Ve<8;Ve++)t.readBits(2);for(let Ve=0;Ve<n;Ve++)T[Ve]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),w[Ve]&&t.readUByte();t.readUEG();const R=t.readUEG();R==3&&t.skipBits(1);const O=t.readUEG(),N=t.readUEG(),U=t.readBoolean();let P=0,B=0,L=0,F=0;U&&(P+=t.readUEG(),B+=t.readUEG(),L+=t.readUEG(),F+=t.readUEG());const j=t.readUEG(),J=t.readUEG(),re=t.readUEG(),q=t.readBoolean();for(let Ve=q?0:n;Ve<=n;Ve++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let st=0;st<4;st++)for(let $e=0;$e<(st===3?2:6);$e++)if(!t.readBoolean())t.readUEG();else{const nt=Math.min(64,1<<4+(st<<1));st>1&&t.readEG();for(let ee=0;ee<nt;ee++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const ie=t.readUEG();let ue=0;for(let Ve=0;Ve<ie;Ve++){let st=!1;if(Ve!==0&&(st=t.readBoolean()),st){Ve===ie&&t.readUEG(),t.readBoolean(),t.readUEG();let $e=0;for(let Pt=0;Pt<=ue;Pt++){const nt=t.readBoolean();let ee=!1;nt||(ee=t.readBoolean()),(nt||ee)&&$e++}ue=$e}else{const $e=t.readUEG(),Pt=t.readUEG();ue=$e+Pt;for(let nt=0;nt<$e;nt++)t.readUEG(),t.readBoolean();for(let nt=0;nt<Pt;nt++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const Ve=t.readUEG();for(let st=0;st<Ve;st++){for(let $e=0;$e<re+4;$e++)t.readBits(1);t.readBits(1)}}let ae=0,ge=1,Ee=1,le=!0,Ce=1,Me=0;t.readBoolean(),t.readBoolean();let Ze=!1;if(t.readBoolean()){if(t.readBoolean()){const X=t.readUByte(),we=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],Fe=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];X>0&&X<16?(ge=we[X-1],Ee=Fe[X-1]):X===255&&(ge=t.readBits(16),Ee=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),Ze=t.readBoolean(),Ze&&(P+=t.readUEG(),B+=t.readUEG(),L+=t.readUEG(),F+=t.readUEG()),t.readBoolean()&&(Ce=t.readBits(32),Me=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const Fe=t.readBoolean(),ut=t.readBoolean();let We=!1;(Fe||ut)&&(We=t.readBoolean(),We&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),We&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let ot=0;ot<=n;ot++){le=t.readBoolean();const et=le||t.readBoolean();let pt=!1;et?t.readEG():pt=t.readBoolean();const vt=pt?1:t.readUEG()+1;if(Fe)for(let it=0;it<vt;it++)t.readUEG(),t.readUEG(),We&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(ut)for(let it=0;it<vt;it++)t.readUEG(),t.readUEG(),We&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),ae=t.readUEG())}let Mt=O,bt=N;if(U||Ze){let Ve=1,st=1;R===1?Ve=st=2:R==2&&(Ve=2),Mt=O-Ve*B-Ve*P,bt=N-st*F-st*L}const cn=s?["A","B","C"][s]:"",tn=o<<24|l<<16|c<<8|h;let Ot=0;for(let Ve=0;Ve<32;Ve++)Ot=(Ot|(tn>>Ve&1)<<31-Ve)>>>0;let te=Ot.toString(16);return a===1&&te==="2"&&(te="6"),{codecString:`hvc1.${cn}${a}.${te}.${r?"H":"L"}${A}.B0`,params:{general_tier_flag:r,general_profile_idc:a,general_profile_space:s,general_profile_compatibility_flags:[o,l,c,h],general_constraint_indicator_flags:[d,m,y,x,_,b],general_level_idc:A,bit_depth:j+8,bit_depth_luma_minus8:j,bit_depth_chroma_minus8:J,min_spatial_segmentation_idc:ae,chroma_format_idc:R,frame_rate:{fixed:le,fps:Me/Ce}},width:Mt,height:bt,pixelRatio:[ge,Ee]}}readPPS(e){const t=new oA(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const s=t.readBoolean(),r=t.readBoolean();let a=1;return r&&s?a=0:r?a=3:s&&(a=2),{parallelismType:a}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const kr=188;class i0{constructor(e,t,n,s){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=s,this.videoParser=null}static probe(e,t){const n=i0.syncOffset(e);return n>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),n!==-1}static syncOffset(e){const t=e.length;let n=Math.min(kr*5,t-kr)+1,s=0;for(;s<n;){let r=!1,a=-1,o=0;for(let l=s;l<t;l+=kr)if(e[l]===71&&(t-l===kr||e[l+kr]===71)){if(o++,a===-1&&(a=l,a!==0&&(n=Math.min(a+kr*99,e.length-kr)+1)),r||(r=qD(e,l)===0),r&&o>1&&(a===0&&o>2||l+kr>n))return a}else{if(o)return-1;break}s++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:X5[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,s){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=i0.createTrack("video"),this._videoTrack.duration=s,this._audioTrack=i0.createTrack("audio",s),this._id3Track=i0.createTrack("id3"),this._txtTrack=i0.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,s=!1){n||(this.sampleAes=null);let r;const a=this._videoTrack,o=this._audioTrack,l=this._id3Track,c=this._txtTrack;let h=a.pid,d=a.pesData,m=o.pid,y=l.pid,x=o.pesData,_=l.pesData,b=null,A=this.pmtParsed,T=this._pmtId,w=e.length;if(this.remainderData&&(e=Fl(this.remainderData,e),w=e.length,this.remainderData=null),w<kr&&!s)return this.remainderData=e,{audioTrack:o,videoTrack:a,id3Track:l,textTrack:c};const R=Math.max(0,i0.syncOffset(e));w-=(w-R)%kr,w<e.byteLength&&!s&&(this.remainderData=new Uint8Array(e.buffer,w,e.buffer.byteLength-w));let O=0;for(let U=R;U<w;U+=kr)if(e[U]===71){const P=!!(e[U+1]&64),B=qD(e,U),L=(e[U+3]&48)>>4;let F;if(L>1){if(F=U+5+e[U+4],F===U+kr)continue}else F=U+4;switch(B){case h:if(P){if(d&&(r=C2(d,this.logger))){if(this.videoParser===null)switch(a.segmentCodec){case"avc":this.videoParser=new VN;break;case"hevc":this.videoParser=new YN;break}this.videoParser!==null&&this.videoParser.parsePES(a,c,r,!1)}d={data:[],size:0}}d&&(d.data.push(e.subarray(F,U+kr)),d.size+=U+kr-F);break;case m:if(P){if(x&&(r=C2(x,this.logger)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,r);break;case"mp3":this.parseMPEGPES(o,r);break;case"ac3":this.parseAC3PES(o,r);break}x={data:[],size:0}}x&&(x.data.push(e.subarray(F,U+kr)),x.size+=U+kr-F);break;case y:P&&(_&&(r=C2(_,this.logger))&&this.parseID3PES(l,r),_={data:[],size:0}),_&&(_.data.push(e.subarray(F,U+kr)),_.size+=U+kr-F);break;case 0:P&&(F+=e[F]+1),T=this._pmtId=jj(e,F);break;case T:{P&&(F+=e[F]+1);const j=qj(e,F,this.typeSupported,n,this.observer,this.logger);h=j.videoPid,h>0&&(a.pid=h,a.segmentCodec=j.segmentVideoCodec),m=j.audioPid,m>0&&(o.pid=m,o.segmentCodec=j.segmentAudioCodec),y=j.id3Pid,y>0&&(l.pid=y),b!==null&&!A&&(this.logger.warn(`MPEG-TS PMT found at ${U} after unknown PID '${b}'. Backtracking to sync byte @${R} to parse all TS packets.`),b=null,U=R-188),A=this.pmtParsed=!0;break}case 17:case 8191:break;default:b=B;break}}else O++;O>0&&QD(this.observer,new Error(`Found ${O} TS packet/s that do not start with 0x47`),void 0,this.logger),a.pesData=d,o.pesData=x,l.pesData=_;const N={audioTrack:o,videoTrack:a,id3Track:l,textTrack:c};return s&&this.extractRemainingSamples(N),N}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:s,textTrack:r}=e,a=n.pesData,o=t.pesData,l=s.pesData;let c;if(a&&(c=C2(a,this.logger))){if(this.videoParser===null)switch(n.segmentCodec){case"avc":this.videoParser=new VN;break;case"hevc":this.videoParser=new YN;break}this.videoParser!==null&&(this.videoParser.parsePES(n,r,c,!0),n.pesData=null)}else n.pesData=a;if(o&&(c=C2(o,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,c);break;case"mp3":this.parseMPEGPES(t,c);break;case"ac3":this.parseAC3PES(t,c);break}t.pesData=null}else o!=null&&o.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=o;l&&(c=C2(l,this.logger))?(this.parseID3PES(s,c),s.pesData=null):s.pesData=l}demuxSampleAes(e,t,n){const s=this.demux(e,n,!0,!this.config.progressive),r=this.sampleAes=new Xj(this.observer,this.config,t);return this.decrypt(s,r)}decrypt(e,t){return new Promise(n=>{const{audioTrack:s,videoTrack:r}=e;s.samples&&s.segmentCodec==="aac"?t.decryptAacSamples(s.samples,0,()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,()=>{n(e)}):n(e)}):r.samples&&t.decryptAvcSamples(r.samples,0,0,()=>{n(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let n=0;const s=this.aacOverFlow;let r=t.data;if(s){this.aacOverFlow=null;const d=s.missing,m=s.sample.unit.byteLength;if(d===-1)r=Fl(s.sample.unit,r);else{const y=m-d;s.sample.unit.set(r.subarray(0,d),y),e.samples.push(s.sample),n=s.missing}}let a,o;for(a=n,o=r.length;a<o-1&&!a3(r,a);a++);if(a!==n){let d;const m=a<o-1;if(m?d=`AAC PES did not start with ADTS header,offset:${a}`:d="No ADTS header found in AAC PES",QD(this.observer,new Error(d),m,this.logger),!m)return}wH(e,this.observer,r,a,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(s){const d=MH(e.samplerate);l=s.sample.pts+d}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let c=0,h;for(;a<o;)if(h=CH(e,r,a,l,c),a+=h.length,h.missing){this.aacOverFlow=h;break}else for(c++;a<o-1&&!a3(r,a);a++);}parseMPEGPES(e,t){const n=t.data,s=n.length;let r=0,a=0;const o=t.pts;if(o===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<s;)if(OH(n,a)){const l=IH(e,n,a,o,r);if(l)a+=l.length,r++;else break}else a++}parseAC3PES(e,t){{const n=t.data,s=t.pts;if(s===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const r=n.length;let a=0,o=0,l;for(;o<r&&(l=UH(e,n,o,s,a++))>0;)o+=l}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=Yi({},t,{type:this._videoTrack?Zo.emsg:Zo.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function qD(i,e){return((i[e+1]&31)<<8)+i[e+2]}function jj(i,e){return(i[e+10]&31)<<8|i[e+11]}function qj(i,e,t,n,s,r){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(i[e+1]&15)<<8|i[e+2],l=e+3+o-4,c=(i[e+10]&15)<<8|i[e+11];for(e+=12+c;e<l;){const h=qD(i,e),d=(i[e+3]&15)<<8|i[e+4];switch(i[e]){case 207:if(!n){FC("ADTS AAC",r);break}case 15:a.audioPid===-1&&(a.audioPid=h);break;case 21:a.id3Pid===-1&&(a.id3Pid=h);break;case 219:if(!n){FC("H.264",r);break}case 27:a.videoPid===-1&&(a.videoPid=h);break;case 3:case 4:!t.mpeg&&!t.mp3?r.log("MPEG audio found, not supported in this browser"):a.audioPid===-1&&(a.audioPid=h,a.segmentAudioCodec="mp3");break;case 193:if(!n){FC("AC-3",r);break}case 129:t.ac3?a.audioPid===-1&&(a.audioPid=h,a.segmentAudioCodec="ac3"):r.log("AC-3 audio found, not supported in this browser");break;case 6:if(a.audioPid===-1&&d>0){let m=e+5,y=d;for(;y>2;){switch(i[m]){case 106:t.ac3!==!0?r.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=h,a.segmentAudioCodec="ac3");break}const _=i[m+1]+2;m+=_,y-=_}}break;case 194:case 135:return QD(s,new Error("Unsupported EC-3 in M2TS found"),void 0,r),a;case 36:a.videoPid===-1&&(a.videoPid=h,a.segmentVideoCodec="hevc",r.log("HEVC in M2TS found"));break}e+=d+5}return a}function QD(i,e,t,n){n.warn(`parsing error: ${e.message}`),i.emit(H.ERROR,H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function FC(i,e){e.log(`${i} with AES-128-CBC encryption found in unencrypted stream`)}function C2(i,e){let t=0,n,s,r,a,o;const l=i.data;if(!i||i.size===0)return null;for(;l[0].length<19&&l.length>1;)l[0]=Fl(l[0],l[1]),l.splice(1,1);if(n=l[0],(n[0]<<16)+(n[1]<<8)+n[2]===1){if(s=(n[4]<<8)+n[5],s&&s>i.size-6)return null;const h=n[7];h&192&&(a=(n[9]&14)*536870912+(n[10]&255)*4194304+(n[11]&254)*16384+(n[12]&255)*128+(n[13]&254)/2,h&64?(o=(n[14]&14)*536870912+(n[15]&255)*4194304+(n[16]&254)*16384+(n[17]&255)*128+(n[18]&254)/2,a-o>60*9e4&&(e.warn(`${Math.round((a-o)/9e4)}s delta between PTS and DTS, align them`),a=o)):o=a),r=n[8];let d=r+9;if(i.size<=d)return null;i.size-=d;const m=new Uint8Array(i.size);for(let y=0,x=l.length;y<x;y++){n=l[y];let _=n.byteLength;if(d)if(d>_){d-=_;continue}else n=n.subarray(d),_-=d,d=0;m.set(n,t),t+=_}return s&&(s-=r+3),{data:m,pts:a,dts:o,len:s}}return null}class Qj{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Nd=Math.pow(2,32)-1;class Be{static init(){Be.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in Be.types)Be.types.hasOwnProperty(e)&&(Be.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Be.HDLR_TYPES={video:t,audio:n};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);Be.STTS=Be.STSC=Be.STCO=r,Be.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Be.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Be.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Be.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);Be.FTYP=Be.box(Be.types.ftyp,a,l,a,o),Be.DINF=Be.box(Be.types.dinf,Be.box(Be.types.dref,s))}static box(e,...t){let n=8,s=t.length;const r=s;for(;s--;)n+=t[s].byteLength;const a=new Uint8Array(n);for(a[0]=n>>24&255,a[1]=n>>16&255,a[2]=n>>8&255,a[3]=n&255,a.set(e,4),s=0,n=8;s<r;s++)a.set(t[s],n),n+=t[s].byteLength;return a}static hdlr(e){return Be.box(Be.types.hdlr,Be.HDLR_TYPES[e])}static mdat(e){return Be.box(Be.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(Nd+1)),s=Math.floor(t%(Nd+1));return Be.box(Be.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,s>>24,s>>16&255,s>>8&255,s&255,85,196,0,0]))}static mdia(e){return Be.box(Be.types.mdia,Be.mdhd(e.timescale||0,e.duration||0),Be.hdlr(e.type),Be.minf(e))}static mfhd(e){return Be.box(Be.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?Be.box(Be.types.minf,Be.box(Be.types.smhd,Be.SMHD),Be.DINF,Be.stbl(e)):Be.box(Be.types.minf,Be.box(Be.types.vmhd,Be.VMHD),Be.DINF,Be.stbl(e))}static moof(e,t,n){return Be.box(Be.types.moof,Be.mfhd(e),Be.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=Be.trak(e[t]);return Be.box.apply(null,[Be.types.moov,Be.mvhd(e[0].timescale||0,e[0].duration||0)].concat(n).concat(Be.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=Be.trex(e[t]);return Be.box.apply(null,[Be.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(Nd+1)),s=Math.floor(t%(Nd+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,s>>24,s>>16&255,s>>8&255,s&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Be.box(Be.types.mvhd,r)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let s,r;for(s=0;s<t.length;s++)r=t[s].flags,n[s+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return Be.box(Be.types.sdtp,n)}static stbl(e){return Be.box(Be.types.stbl,Be.stsd(e),Be.box(Be.types.stts,Be.STTS),Be.box(Be.types.stsc,Be.STSC),Be.box(Be.types.stsz,Be.STSZ),Be.box(Be.types.stco,Be.STCO))}static avc1(e){let t=[],n=[],s,r,a;for(s=0;s<e.sps.length;s++)r=e.sps[s],a=r.byteLength,t.push(a>>>8&255),t.push(a&255),t=t.concat(Array.prototype.slice.call(r));for(s=0;s<e.pps.length;s++)r=e.pps[s],a=r.byteLength,n.push(a>>>8&255),n.push(a&255),n=n.concat(Array.prototype.slice.call(r));const o=Be.box(Be.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),l=e.width,c=e.height,h=e.pixelRatio[0],d=e.pixelRatio[1];return Be.box(Be.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,c>>8&255,c&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,Be.box(Be.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Be.box(Be.types.pasp,new Uint8Array([h>>24,h>>16&255,h>>8&255,h&255,d>>24,d>>16&255,d>>8&255,d&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return Be.box(Be.types.mp4a,Be.audioStsd(e),Be.box(Be.types.esds,Be.esds(e)))}static mp3(e){return Be.box(Be.types[".mp3"],Be.audioStsd(e))}static ac3(e){return Be.box(Be.types["ac-3"],Be.audioStsd(e),Be.box(Be.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return Be.box(Be.types.stsd,Be.STSD,Be.mp4a(e));if(t==="ac3"&&e.config)return Be.box(Be.types.stsd,Be.STSD,Be.ac3(e));if(t==="mp3"&&e.codec==="mp3")return Be.box(Be.types.stsd,Be.STSD,Be.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return Be.box(Be.types.stsd,Be.STSD,Be.avc1(e));if(t==="hevc"&&e.vps)return Be.box(Be.types.stsd,Be.STSD,Be.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,n=(e.duration||0)*(e.timescale||0),s=e.width||0,r=e.height||0,a=Math.floor(n/(Nd+1)),o=Math.floor(n%(Nd+1));return Be.box(Be.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,s&255,0,0,r>>8&255,r&255,0,0]))}static traf(e,t){const n=Be.sdtp(e),s=e.id,r=Math.floor(t/(Nd+1)),a=Math.floor(t%(Nd+1));return Be.box(Be.types.traf,Be.box(Be.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])),Be.box(Be.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,r&255,a>>24,a>>16&255,a>>8&255,a&255])),Be.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,Be.box(Be.types.trak,Be.tkhd(e),Be.mdia(e))}static trex(e){const t=e.id;return Be.box(Be.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],s=n.length,r=12+16*s,a=new Uint8Array(r);let o,l,c,h,d,m;for(t+=8+r,a.set([e.type==="video"?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,s&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),o=0;o<s;o++)l=n[o],c=l.duration,h=l.size,d=l.flags,m=l.cts,a.set([c>>>24&255,c>>>16&255,c>>>8&255,c&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,d.degradPrio&61440,d.degradPrio&15,m>>>24&255,m>>>16&255,m>>>8&255,m&255],12+16*o);return Be.box(Be.types.trun,a)}static initSegment(e){Be.types||Be.init();const t=Be.moov(e);return Fl(Be.FTYP,t)}static hvc1(e){const t=e.params,n=[e.vps,e.sps,e.pps],s=4,r=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),s-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),n.length]);let a=r.length;for(let x=0;x<n.length;x+=1){a+=3;for(let _=0;_<n[x].length;_+=1)a+=2+n[x][_].length}const o=new Uint8Array(a);o.set(r,0),a=r.length;const l=n.length-1;for(let x=0;x<n.length;x+=1){o.set(new Uint8Array([32+x|(x===l?128:0),0,n[x].length]),a),a+=3;for(let _=0;_<n[x].length;_+=1)o.set(new Uint8Array([n[x][_].length>>8,n[x][_].length&255]),a),a+=2,o.set(n[x][_],a),a+=n[x][_].length}const c=Be.box(Be.types.hvcC,o),h=e.width,d=e.height,m=e.pixelRatio[0],y=e.pixelRatio[1];return Be.box(Be.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,h&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c,Be.box(Be.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Be.box(Be.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,m&255,y>>24,y>>16&255,y>>8&255,y&255])))}}Be.types=void 0;Be.HDLR_TYPES=void 0;Be.STTS=void 0;Be.STSC=void 0;Be.STCO=void 0;Be.STSZ=void 0;Be.VMHD=void 0;Be.SMHD=void 0;Be.STSD=void 0;Be.FTYP=void 0;Be.DINF=void 0;const FH=9e4;function tB(i,e,t=1,n=!1){const s=i*e*t;return n?Math.round(s):s}function $j(i,e,t=1,n=!1){return tB(i,e,1/t,n)}function yb(i,e=!1){return tB(i,1e3,1/FH,e)}function Jj(i,e=1){return tB(i,FH,1/e)}const Zj=10*1e3,eq=1024,tq=1152,nq=1536;let R2=null,HC=null;function KN(i,e,t,n){return{duration:e,size:t,cts:n,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:i?2:1,isNonSync:i?0:1}}}class TT{constructor(e,t,n,s){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=s,this.ISGenerated=!1,R2===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);R2=a?parseInt(a[1]):0}if(HC===null){const r=navigator.userAgent.match(/Safari\/(\d+)/i);HC=r?parseInt(r[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,s=e.reduce((r,a)=>{let o=a.pts,l=o-r;return l<-4294967296&&(t=!0,o=Bl(o,n),l=o-r),l>0?r:o},n);return t&&this.logger.debug("PTS rollover detected"),s}remux(e,t,n,s,r,a,o,l){let c,h,d,m,y,x,_=r,b=r;const A=e.pid>-1,T=t.pid>-1,w=t.samples.length,R=e.samples.length>0,O=o&&w>0||w>1;if((!A||R)&&(!T||O)||this.ISGenerated||o){if(this.ISGenerated){var U,P,B,L;const re=this.videoTrackConfig;(re&&(t.width!==re.width||t.height!==re.height||((U=t.pixelRatio)==null?void 0:U[0])!==((P=re.pixelRatio)==null?void 0:P[0])||((B=t.pixelRatio)==null?void 0:B[1])!==((L=re.pixelRatio)==null?void 0:L[1]))||!re&&O||this.nextAudioPts===null&&R)&&this.resetInitSegment()}this.ISGenerated||(d=this.generateIS(e,t,r,a));const F=this.isVideoContiguous;let j=-1,J;if(O&&(j=iq(t.samples),!F&&this.config.forceKeyFrameOnDiscontinuity))if(x=!0,j>0){this.logger.warn(`[mp4-remuxer]: Dropped ${j} out of ${w} video samples due to a missing keyframe`);const re=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(j),t.dropped+=j,b+=(t.samples[0].pts-re)/t.inputTimeScale,J=b}else j===-1&&(this.logger.warn(`[mp4-remuxer]: No keyframe found out of ${w} video samples`),x=!1);if(this.ISGenerated){if(R&&O){const re=this.getVideoStartPts(t.samples),W=(Bl(e.samples[0].pts,re)-re)/t.inputTimeScale;_+=Math.max(0,W),b+=Math.max(0,-W)}if(R){if(e.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,t,r,a)),h=this.remuxAudio(e,_,this.isAudioContiguous,a,T||O||l===Zt.AUDIO?b:void 0),O){const re=h?h.endPTS-h.startPTS:0;t.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,t,r,a)),c=this.remuxVideo(t,b,F,re)}}else O&&(c=this.remuxVideo(t,b,F,0));c&&(c.firstKeyFrame=j,c.independent=j!==-1,c.firstKeyFramePTS=J)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(y=HH(n,r,this._initPTS,this._initDTS)),s.samples.length&&(m=GH(s,r,this._initPTS))),{audio:h,video:c,initSegment:d,independent:x,text:m,id3:y}}generateIS(e,t,n,s){const r=e.samples,a=t.samples,o=this.typeSupported,l={},c=this._initPTS;let h=!c||s,d="audio/mp4",m,y,x;if(h&&(m=y=1/0),e.config&&r.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":o.mpeg?(d="audio/mpeg",e.codec=""):o.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:d,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&o.mpeg?new Uint8Array(0):Be.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(x=e.inputTimeScale,!c||x!==c.timescale?m=y=r[0].pts-Math.round(x*n):h=!1)}if(t.sps&&t.pps&&a.length){if(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Be.initSegment([t]),metadata:{width:t.width,height:t.height}},h)if(x=t.inputTimeScale,!c||x!==c.timescale){const _=this.getVideoStartPts(a),b=Math.round(x*n);y=Math.min(y,Bl(a[0].dts,_)-b),m=Math.min(m,_-b)}else h=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,h?(this._initPTS={baseTime:m,timescale:x},this._initDTS={baseTime:y,timescale:x}):m=x=void 0,{tracks:l,initPTS:m,timescale:x}}remuxVideo(e,t,n,s){const r=e.inputTimeScale,a=e.samples,o=[],l=a.length,c=this._initPTS;let h=this.nextAvcDts,d=8,m=this.videoSampleDuration,y,x,_=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,A=!1;if(!n||h===null){const ue=t*r,z=a[0].pts-Bl(a[0].dts,a[0].pts);R2&&h!==null&&Math.abs(ue-z-h)<15e3?n=!0:h=ue-z}const T=c.baseTime*r/c.timescale;for(let ue=0;ue<l;ue++){const z=a[ue];z.pts=Bl(z.pts-T,h),z.dts=Bl(z.dts-T,h),z.dts<a[ue>0?ue-1:ue].dts&&(A=!0)}A&&a.sort(function(ue,z){const ae=ue.dts-z.dts,ge=ue.pts-z.pts;return ae||ge}),y=a[0].dts,x=a[a.length-1].dts;const w=x-y,R=w?Math.round(w/(l-1)):m||e.inputTimeScale/30;if(n){const ue=y-h,z=ue>R,ae=ue<-1;if((z||ae)&&(z?this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${yb(ue,!0)} ms (${ue}dts) hole between fragments detected at ${t.toFixed(3)}`):this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${yb(-ue,!0)} ms (${ue}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!ae||h>=a[0].pts||R2)){y=h;const ge=a[0].pts-ue;if(z)a[0].dts=y,a[0].pts=ge;else{let Ee=!0;for(let le=0;le<a.length&&!(a[le].dts>ge&&Ee);le++){const Ce=a[le].pts;if(a[le].dts-=ue,a[le].pts-=ue,le<a.length-1){const Me=a[le+1].pts,Ze=a[le].pts,tt=Me<=Ze,Mt=Me<=Ce;Ee=tt==Mt}}}this.logger.log(`Video: Initial PTS/DTS adjusted: ${yb(ge,!0)}/${yb(y,!0)}, delta: ${yb(ue,!0)} ms`)}}y=Math.max(0,y);let O=0,N=0,U=y;for(let ue=0;ue<l;ue++){const z=a[ue],ae=z.units,ge=ae.length;let Ee=0;for(let le=0;le<ge;le++)Ee+=ae[le].data.length;N+=Ee,O+=ge,z.length=Ee,z.dts<U?(z.dts=U,U+=R/4|0||1):U=z.dts,_=Math.min(z.pts,_),b=Math.max(z.pts,b)}x=a[l-1].dts;const P=N+4*O+8;let B;try{B=new Uint8Array(P)}catch(ue){this.observer.emit(H.ERROR,H.ERROR,{type:nn.MUX_ERROR,details:Pe.REMUX_ALLOC_ERROR,fatal:!1,error:ue,bytes:P,reason:`fail allocating video mdat ${P}`});return}const L=new DataView(B.buffer);L.setUint32(0,P),B.set(Be.types.mdat,4);let F=!1,j=Number.POSITIVE_INFINITY,J=Number.POSITIVE_INFINITY,re=Number.NEGATIVE_INFINITY,q=Number.NEGATIVE_INFINITY;for(let ue=0;ue<l;ue++){const z=a[ue],ae=z.units;let ge=0;for(let Ce=0,Me=ae.length;Ce<Me;Ce++){const Ze=ae[Ce],tt=Ze.data,Mt=Ze.data.byteLength;L.setUint32(d,Mt),d+=4,B.set(tt,d),d+=Mt,ge+=4+Mt}let Ee;if(ue<l-1)m=a[ue+1].dts-z.dts,Ee=a[ue+1].pts-z.pts;else{const Ce=this.config,Me=ue>0?z.dts-a[ue-1].dts:R;if(Ee=ue>0?z.pts-a[ue-1].pts:R,Ce.stretchShortVideoTrack&&this.nextAudioPts!==null){const Ze=Math.floor(Ce.maxBufferHole*r),tt=(s?_+s*r:this.nextAudioPts)-z.pts;tt>Ze?(m=tt-Me,m<0?m=Me:F=!0,this.logger.log(`[mp4-remuxer]: It is approximately ${tt/90} ms to the next segment; using duration ${m/90} ms for the last video frame.`)):m=Me}else m=Me}const le=Math.round(z.pts-z.dts);j=Math.min(j,m),re=Math.max(re,m),J=Math.min(J,Ee),q=Math.max(q,Ee),o.push(KN(z.key,m,ge,le))}if(o.length){if(R2){if(R2<70){const ue=o[0].flags;ue.dependsOn=2,ue.isNonSync=0}}else if(HC&&q-J<re-j&&R/re<.025&&o[0].cts===0){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let ue=y;for(let z=0,ae=o.length;z<ae;z++){const ge=ue+o[z].duration,Ee=ue+o[z].cts;if(z<ae-1){const le=ge+o[z+1].cts;o[z].duration=le-Ee}else o[z].duration=z?o[z-1].duration:R;o[z].cts=0,ue=ge}}}m=F||!m?R:m,this.nextAvcDts=h=x+m,this.videoSampleDuration=m,this.isVideoContiguous=!0;const ie={data1:Be.moof(e.sequenceNumber++,y,Yi(e,{samples:o})),data2:B,startPTS:_/r,endPTS:(b+m)/r,startDTS:y/r,endDTS:h/r,type:"video",hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,ie}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return tq;case"ac3":return nq;default:return eq}}remuxAudio(e,t,n,s,r){const a=e.inputTimeScale,o=e.samplerate?e.samplerate:a,l=a/o,c=this.getSamplesPerFrame(e),h=c*l,d=this._initPTS,m=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,y=[],x=r!==void 0;let _=e.samples,b=m?0:8,A=this.nextAudioPts||-1;const T=t*a,w=d.baseTime*a/d.timescale;if(this.isAudioContiguous=n=n||_.length&&A>0&&(s&&Math.abs(T-A)<9e3||Math.abs(Bl(_[0].pts-w,T)-A)<20*h),_.forEach(function(W){W.pts=Bl(W.pts-w,T)}),!n||A<0){if(_=_.filter(W=>W.pts>=0),!_.length)return;r===0?A=0:s&&!x?A=Math.max(0,T):A=_[0].pts}if(e.segmentCodec==="aac"){const W=this.config.maxAudioFramesDrift;for(let ne=0,ie=A;ne<_.length;ne++){const ue=_[ne],z=ue.pts,ae=z-ie,ge=Math.abs(1e3*ae/a);if(ae<=-W*h&&x)ne===0&&(this.logger.warn(`Audio frame @ ${(z/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*ae/a)} ms.`),this.nextAudioPts=A=ie=z);else if(ae>=W*h&&ge<Zj&&x){let Ee=Math.round(ae/h);ie=z-Ee*h,ie<0&&(Ee--,ie+=h),ne===0&&(this.nextAudioPts=A=ie),this.logger.warn(`[mp4-remuxer]: Injecting ${Ee} audio frame @ ${(ie/a).toFixed(3)}s due to ${Math.round(1e3*ae/a)} ms gap.`);for(let le=0;le<Ee;le++){const Ce=Math.max(ie,0);let Me=Qj.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);Me||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Me=ue.unit.subarray()),_.splice(ne,0,{unit:Me,pts:Ce}),ie+=h,ne++}}ue.pts=ie,ie+=h}}let R=null,O=null,N,U=0,P=_.length;for(;P--;)U+=_[P].unit.byteLength;for(let W=0,ne=_.length;W<ne;W++){const ie=_[W],ue=ie.unit;let z=ie.pts;if(O!==null){const ge=y[W-1];ge.duration=Math.round((z-O)/l)}else if(n&&e.segmentCodec==="aac"&&(z=A),R=z,U>0){U+=b;try{N=new Uint8Array(U)}catch(ge){this.observer.emit(H.ERROR,H.ERROR,{type:nn.MUX_ERROR,details:Pe.REMUX_ALLOC_ERROR,fatal:!1,error:ge,bytes:U,reason:`fail allocating audio mdat ${U}`});return}m||(new DataView(N.buffer).setUint32(0,U),N.set(Be.types.mdat,4))}else return;N.set(ue,b);const ae=ue.byteLength;b+=ae,y.push(KN(!0,c,ae,0)),O=z}const B=y.length;if(!B)return;const L=y[y.length-1];this.nextAudioPts=A=O+l*L.duration;const F=m?new Uint8Array(0):Be.moof(e.sequenceNumber++,R/l,Yi({},e,{samples:y}));e.samples=[];const j=R/a,J=A/a,q={data1:F,data2:N,startPTS:j,endPTS:J,startDTS:j,endDTS:J,type:"audio",hasAudio:!0,hasVideo:!1,nb:B};return this.isAudioContiguous=!0,q}}function Bl(i,e){let t;if(e===null)return i;for(e<i?t=-8589934592:t=8589934592;Math.abs(i-e)>4294967296;)i+=t;return i}function iq(i){for(let e=0;e<i.length;e++)if(i[e].key)return e;return-1}function HH(i,e,t,n){const s=i.samples.length;if(!s)return;const r=i.inputTimeScale;for(let o=0;o<s;o++){const l=i.samples[o];l.pts=Bl(l.pts-t.baseTime*r/t.timescale,e*r)/r,l.dts=Bl(l.dts-n.baseTime*r/n.timescale,e*r)/r}const a=i.samples;return i.samples=[],{samples:a}}function GH(i,e,t){const n=i.samples.length;if(!n)return;const s=i.inputTimeScale;for(let a=0;a<n;a++){const o=i.samples[a];o.pts=Bl(o.pts-t.baseTime*s/t.timescale,e*s)/s}i.samples.sort((a,o)=>a.pts-o.pts);const r=i.samples;return i.samples=[],{samples:r}}class sq{constructor(e,t,n,s){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.logger=s}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,s){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(WW(e,s)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const s=this.initData=Q5(e);s.audio&&(t=WN(s.audio,Vi.AUDIO)),s.video&&(n=WN(s.video,Vi.VIDEO));const r={};s.audio&&s.video?r.audiovideo={container:"video/mp4",codec:t+","+n,supplemental:s.video.supplemental,initSegment:e,id:"main"}:s.audio?r.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:s.video?r.video={container:"video/mp4",codec:n,supplemental:s.video.supplemental,initSegment:e,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(e,t,n,s,r,a){var o,l;let{initPTS:c,lastEndTime:h}=this;const d={audio:void 0,video:void 0,text:s,id3:n,initSegment:void 0};Vt(h)||(h=this.lastEndTime=r||0);const m=t.samples;if(!(m!=null&&m.length))return d;const y={initPTS:void 0,timescale:1};let x=this.initData;if((o=x)!=null&&o.length||(this.generateInitSegment(m),x=this.initData),!((l=x)!=null&&l.length))return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(y.tracks=this.initTracks,this.emitInitSegment=!1);const _=jW(m,x),b=XW(x,m),A=b===null?r:b;(a||!c)&&(rq(c,A,r,_)||y.timescale!==c.timescale)&&(y.initPTS=A-r,c&&c.timescale===1&&this.logger.warn(`Adjusting initPTS @${r} from ${c.baseTime/c.timescale} to ${y.initPTS}`),this.initPTS=c={baseTime:y.initPTS,timescale:1});const T=e?A-c.baseTime/c.timescale:h,w=T+_;QW(x,m,c.baseTime/c.timescale),_>0?this.lastEndTime=w:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const R=!!x.audio,O=!!x.video;let N="";R&&(N+="audio"),O&&(N+="video");const U={data1:m,startPTS:T,startDTS:T,endPTS:w,endDTS:w,type:N,hasAudio:R,hasVideo:O,nb:1,dropped:0};return d.audio=U.type==="audio"?U:void 0,d.video=U.type!=="audio"?U:void 0,d.initSegment=y,d.id3=HH(n,r,c,c),s.samples.length&&(d.text=GH(s,r,c)),d}}function rq(i,e,t,n){if(i===null)return!0;const s=Math.max(n,1),r=e-i.baseTime/i.timescale;return Math.abs(r-t)>s}function WN(i,e){const t=i==null?void 0:i.codec;return t&&t.length>4?t:e===Vi.AUDIO?t==="ec-3"||t==="ac-3"||t==="alac"?t:t==="fLaC"||t==="Opus"?ZT(t,!1):(oi.warn(`Unhandled audio codec "${t}" in mp4 MAP`),t||"mp4a"):(oi.warn(`Unhandled video codec "${t}" in mp4 MAP`),t||"avc1")}let cf;try{cf=self.performance.now.bind(self.performance)}catch{cf=Date.now}const wT=[{demux:Wj,remux:sq},{demux:i0,remux:TT},{demux:zj,remux:TT},{demux:Yj,remux:TT}];wT.splice(2,0,{demux:Vj,remux:TT});class XN{constructor(e,t,n,s,r,a){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.id=r,this.logger=a}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,s){const r=n.transmuxing;r.executeStart=cf();let a=new Uint8Array(e);const{currentTransmuxState:o,transmuxConfig:l}=this;s&&(this.currentTransmuxState=s);const{contiguous:c,discontinuity:h,trackSwitch:d,accurateTimeOffset:m,timeOffset:y,initSegmentChange:x}=s||o,{audioCodec:_,videoCodec:b,defaultInitPts:A,duration:T,initSegmentData:w}=l,R=aq(a,t);if(R&&yy(R.method)){const P=this.getDecrypter(),B=WI(R.method);if(P.isSync()){let L=P.softwareDecrypt(a,R.key.buffer,R.iv.buffer,B);if(n.part>-1){const j=P.flush();L=j&&j.buffer}if(!L)return r.executeEnd=cf(),GC(n);a=new Uint8Array(L)}else return this.asyncResult=!0,this.decryptionPromise=P.webCryptoDecrypt(a,R.key.buffer,R.iv.buffer,B).then(L=>{const F=this.push(L,null,n);return this.decryptionPromise=null,F}),this.decryptionPromise}const O=this.needsProbing(h,d);if(O){const P=this.configureTransmuxer(a);if(P)return this.logger.warn(`[transmuxer] ${P.message}`),this.observer.emit(H.ERROR,H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.FRAG_PARSING_ERROR,fatal:!1,error:P,reason:P.message}),r.executeEnd=cf(),GC(n)}(h||d||x||O)&&this.resetInitSegment(w,_,b,T,t),(h||x||O)&&this.resetInitialTimestamp(A),c||this.resetContiguity();const N=this.transmux(a,R,y,m,n);this.asyncResult=UA(N);const U=this.currentTransmuxState;return U.contiguous=!0,U.discontinuity=!1,U.trackSwitch=!1,r.executeEnd=cf(),N}flush(e){const t=e.transmuxing;t.executeStart=cf();const{decrypter:n,currentTransmuxState:s,decryptionPromise:r}=this;if(r)return this.asyncResult=!0,r.then(()=>this.flush(e));const a=[],{timeOffset:o}=s;if(n){const d=n.flush();d&&a.push(this.push(d.buffer,null,e))}const{demuxer:l,remuxer:c}=this;if(!l||!c){t.executeEnd=cf();const d=[GC(e)];return this.asyncResult?Promise.resolve(d):d}const h=l.flush(o);return UA(h)?(this.asyncResult=!0,h.then(d=>(this.flushRemux(a,d,e),a))):(this.flushRemux(a,h,e),this.asyncResult?Promise.resolve(a):a)}flushRemux(e,t,n){const{audioTrack:s,videoTrack:r,id3Track:a,textTrack:o}=t,{accurateTimeOffset:l,timeOffset:c}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${n.sn}${n.part>-1?" part: "+n.part:""} of ${this.id===Zt.MAIN?"level":"track"} ${n.level}`);const h=this.remuxer.remux(s,r,a,o,c,l,!0,this.id);e.push({remuxResult:h,chunkMeta:n}),n.transmuxing.executeEnd=cf()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,s,r){const{demuxer:a,remuxer:o}=this;!a||!o||(a.resetInitSegment(e,t,n,s),o.resetInitSegment(e,t,n,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,s,r){let a;return t&&t.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,t,n,s,r):a=this.transmuxUnencrypted(e,n,s,r),a}transmuxUnencrypted(e,t,n,s){const{audioTrack:r,videoTrack:a,id3Track:o,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,a,o,l,t,n,!1,this.id),chunkMeta:s}}transmuxSampleAes(e,t,n,s,r){return this.demuxer.demuxSampleAes(e,t,n).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,n,s,!1,this.id),chunkMeta:r}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:s}=this;let r;for(let d=0,m=wT.length;d<m;d++){var a;if((a=wT[d].demux)!=null&&a.probe(e,this.logger)){r=wT[d];break}}if(!r)return new Error("Failed to find demuxer by probing fragment data");const o=this.demuxer,l=this.remuxer,c=r.remux,h=r.demux;(!l||!(l instanceof c))&&(this.remuxer=new c(n,t,s,this.logger)),(!o||!(o instanceof h))&&(this.demuxer=new h(n,t,s,this.logger),this.probe=h.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new YI(this.config)),e}}function aq(i,e){let t=null;return i.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const GC=i=>({remuxResult:{},chunkMeta:i});function UA(i){return"then"in i&&i.then instanceof Function}class oq{constructor(e,t,n,s,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=s,this.defaultInitPts=r||null}}class lq{constructor(e,t,n,s,r,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=s,this.timeOffset=r,this.initSegmentChange=a}}let jN=0;class zH{constructor(e,t,n,s){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=jN++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=l=>{const c=l.data,h=this.hls;if(!(!h||!(c!=null&&c.event)||c.instanceNo!==this.instanceNo))switch(c.event){case"init":{var d;const m=(d=this.workerContext)==null?void 0:d.objectURL;m&&self.URL.revokeObjectURL(m);break}case"transmuxComplete":{this.handleTransmuxComplete(c.data);break}case"flush":{this.onFlush(c.data);break}case"workerLog":{h.logger[c.data.logType]&&h.logger[c.data.logType](c.data.message);break}default:{c.data=c.data||{},c.data.frag=this.frag,c.data.part=this.part,c.data.id=this.id,h.trigger(c.event,c.data);break}}},this.onWorkerError=l=>{if(!this.hls)return;const c=new Error(`${l.message}  (${l.filename}:${l.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(H.ERROR,{type:nn.OTHER_ERROR,details:Pe.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:c})};const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=n,this.onFlush=s;const a=(l,c)=>{c=c||{},c.frag=this.frag||void 0,l===H.ERROR&&(c=c,c.parent=this.id,c.part=this.part,this.error=c.error),this.hls.trigger(l,c)};this.observer=new qI,this.observer.on(H.FRAG_DECRYPTED,a),this.observer.on(H.ERROR,a);const o=uN(r.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const l=this.hls.logger;if(r.workerPath||hj()){try{r.workerPath?(l.log(`loading Web Worker ${r.workerPath} for "${t}"`),this.workerContext=dj(r.workerPath)):(l.log(`injecting Web Worker for "${t}"`),this.workerContext=fj());const{worker:h}=this.workerContext;h.addEventListener("message",this.onWorkerMessage),h.addEventListener("error",this.onWorkerError),h.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:o,id:t,config:xs(r)})}catch(h){l.warn(`Error setting up "${t}" Web Worker, fallback to inline`,h),this.terminateWorker(),this.error=null,this.transmuxer=new XN(this.observer,o,r,"",t,e.logger)}return}}this.transmuxer=new XN(this.observer,o,r,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=jN++;const t=this.hls.config,n=uN(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:n,id:this.id,config:xs(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),pj(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,n,s,r,a,o,l,c,h){var d,m;c.transmuxing.start=self.performance.now();const{instanceNo:y,transmuxer:x}=this,_=a?a.start:r.start,b=r.decryptdata,A=this.frag,T=!(A&&r.cc===A.cc),w=!(A&&c.level===A.level),R=A?c.sn-A.sn:-1,O=this.part?c.part-this.part.index:-1,N=R===0&&c.id>1&&c.id===(A==null?void 0:A.stats.chunkCount),U=!w&&(R===1||R===0&&(O===1||N&&O<=0)),P=self.performance.now();(w||R||r.stats.parsing.start===0)&&(r.stats.parsing.start=P),a&&(O||!U)&&(a.stats.parsing.start=P);const B=!(A&&((d=r.initSegment)==null?void 0:d.url)===((m=A.initSegment)==null?void 0:m.url)),L=new lq(T,U,l,w,_,B);if(!U||T||B){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${r.type} sn: ${c.sn}${c.part>-1?" part: "+c.part:""} ${this.id===Zt.MAIN?"level":"track"}: ${c.level} id: ${c.id}
        discontinuity: ${T}
        trackSwitch: ${w}
        contiguous: ${U}
        accurateTimeOffset: ${l}
        timeOffset: ${_}
        initSegmentChange: ${B}`);const F=new oq(n,s,t,o,h);this.configureTransmuxer(F)}if(this.frag=r,this.part=a,this.workerContext)this.workerContext.worker.postMessage({instanceNo:y,cmd:"demux",data:e,decryptdata:b,chunkMeta:c,state:L},e instanceof ArrayBuffer?[e]:[]);else if(x){const F=x.push(e,b,c,L);UA(F)?F.then(j=>{this.handleTransmuxComplete(j)}).catch(j=>{this.transmuxerError(j,c,"transmuxer-interface push error")}):this.handleTransmuxComplete(F)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(n){const s=n.flush(e);UA(s)?s.then(r=>{this.handleFlushResult(r,e)}).catch(r=>{this.transmuxerError(r,e,"transmuxer-interface flush error")}):this.handleFlushResult(s,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):n&&n.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const qN=100;class cq extends jI{constructor(e,t,n){super(e,t,n,"audio-stream-controller",Zt.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(H.LEVEL_LOADED,this.onLevelLoaded,this),e.on(H.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(H.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(H.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(H.BUFFER_RESET,this.onBufferReset,this),e.on(H.BUFFER_CREATED,this.onBufferCreated,this),e.on(H.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(H.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(H.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(H.FRAG_LOADING,this.onFragLoading,this),e.on(H.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(H.LEVEL_LOADED,this.onLevelLoaded,this),e.off(H.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(H.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(H.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(H.BUFFER_RESET,this.onBufferReset,this),e.off(H.BUFFER_CREATED,this.onBufferCreated,this),e.off(H.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(H.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(H.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(H.FRAG_LOADING,this.onFragLoading,this),e.off(H.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:n,initPTS:s,timescale:r}){if(n===Zt.MAIN){const a=t.cc,o=this.fragCurrent;if(this.initPTS[a]={baseTime:s,timescale:r},this.log(`InitPTS for cc: ${a} found from main: ${s}/${r}`),this.mainAnchor=t,this.state===ht.WAITING_INIT_PTS){const l=this.waitingData;(!l&&!this.loadingParts||l&&l.frag.cc!==a)&&(this.nextLoadPosition=this.findSyncFrag(t).start),this.tick()}else!this.hls.hasEnoughToStart&&o&&o.cc!==a?(this.startFragRequested=!1,this.nextLoadPosition=this.findSyncFrag(t).start,o.abortRequests(),this.resetLoadingState()):this.state===ht.IDLE&&this.tick()}}findSyncFrag(e){const t=this.getLevelDetails(),n=e.cc;return TX(t,n,e)||t&&oH(t.fragments,n)||e}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=ht.STOPPED;return}const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(qN),n>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n,this.state=ht.IDLE):this.state=ht.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case ht.IDLE:this.doTickIdle();break;case ht.WAITING_TRACK:{const{levels:t,trackId:n}=this,s=t==null?void 0:t[n],r=s==null?void 0:s.details;if(r&&!this.waitForLive(s)){if(this.waitForCdnTuneIn(r))break;this.state=ht.WAITING_INIT_PTS}break}case ht.FRAG_LOADING_WAITING_RETRY:{var e;const t=performance.now(),n=this.retryDate;if(!n||t>=n||(e=this.media)!=null&&e.seeking){const{levels:s,trackId:r}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((s==null?void 0:s[r])||null),this.state=ht.IDLE}break}case ht.WAITING_INIT_PTS:{const t=this.waitingData;if(t){const{frag:n,part:s,cache:r,complete:a}=t,o=this.mainAnchor;if(this.initPTS[n.cc]!==void 0){this.waitingData=null,this.state=ht.FRAG_LOADING;const l=r.flush().buffer,c={frag:n,part:s,payload:l,networkDetails:null};this._handleFragmentLoadProgress(c),a&&super._handleFragmentLoadComplete(c)}else o&&o.cc!==t.frag.cc&&(this.log(`Waiting fragment cc (${n.cc}) cancelled because video is at cc ${o.cc}`),this.nextLoadPosition=this.findSyncFrag(o).start,this.clearWaitingFragment())}else this.state=ht.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.state!==ht.STOPPED&&(this.state=ht.IDLE))}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:n,media:s,trackId:r}=this,a=t.config;if(!this.buffering||!s&&!this.primaryPrefetch&&(this.startFragRequested||!a.startFragPrefetch)||!(n!=null&&n[r]))return;const o=n[r],l=o.details;if(!l||this.waitForLive(o)||this.waitForCdnTuneIn(l)){this.state=ht.WAITING_TRACK,this.startFragRequested=!1;return}const c=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&c&&(this.bufferFlushed=!1,this.afterBufferFlushed(c,Vi.AUDIO,Zt.AUDIO));const h=this.getFwdBufferInfo(c,Zt.AUDIO);if(h===null)return;if(!this.switchingTrack&&this._streamEnded(h,l)){t.trigger(H.BUFFER_EOS,{type:"audio"}),this.state=ht.ENDED;return}const d=h.len,m=t.maxBufferLength,y=l.fragments,x=y[0].start,_=this.getLoadPosition(),b=this.flushing?_:h.end;if(this.switchingTrack&&s){const w=_;l.PTSKnown&&w<x&&(h.end>x||h.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),s.currentTime=x+.05)}if(d>=m&&!this.switchingTrack&&b<y[y.length-1].start)return;let A=this.getNextFragment(b,l);if(A&&this.isLoopLoading(A,b)&&(A=this.getNextFragmentLoopLoading(A,l,h,Zt.MAIN,m)),!A){this.bufferFlushed=!0;return}let T=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&T&&zr(A)&&!A.endList&&(!l.live||!this.loadingParts&&b<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(T)===Tr.OK&&(this.mainFragLoading=T=null),T&&zr(T))){if(A.start>T.end){const R=this.fragmentTracker.getFragAtPos(b,Zt.MAIN);R&&R.end>T.end&&(T=R,this.mainFragLoading={frag:R,targetBufferTime:null})}if(A.start>T.end)return}this.loadFragment(A,o,b)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new IA(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),n?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==ht.STOPPED&&(this.setInterval(qN),this.state=ht.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const n=this.cachedTrackLoadedData;n&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(H.AUDIO_TRACK_LOADED,n))}onAudioTrackLoaded(e,t){var n;const{levels:s}=this,{details:r,id:a,groupId:o,track:l}=t;if(!s){this.warn(`Audio tracks reset while loading track ${a} "${l.name}" of "${o}"`);return}const c=this.mainDetails;if(!c||r.endCC>c.endCC||c.expired){this.cachedTrackLoadedData=t,this.state!==ht.STOPPED&&(this.state=ht.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${a} "${l.name}" of "${o}" loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const h=s[a];let d=0;if(r.live||(n=h.details)!=null&&n.live){if(this.checkLiveUpdate(r),r.deltaUpdateFailed)return;if(h.details){var m;d=this.alignPlaylists(r,h.details,(m=this.levelLastLoaded)==null?void 0:m.details)}r.alignedSliding||(AH(r,c),r.alignedSliding||r3(r,c),d=r.fragmentStart)}h.details=r,this.levelLastLoaded=h,this.startFragRequested||this.setStartPosition(c,d),this.hls.trigger(H.AUDIO_TRACK_UPDATED,{details:r,id:a,groupId:t.groupId}),this.state===ht.WAITING_TRACK&&!this.waitForCdnTuneIn(r)&&(this.state=ht.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:s,payload:r}=e,{config:a,trackId:o,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const c=l[o];if(!c){this.warn("Audio track is undefined on fragment load progress");return}const h=c.details;if(!h){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const d=a.defaultAudioCodec||c.audioCodec||"mp4a.40.2";let m=this.transmuxer;m||(m=this.transmuxer=new zH(this.hls,Zt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const y=this.initPTS[n.cc],x=(t=n.initSegment)==null?void 0:t.data;if(y!==void 0){const b=s?s.index:-1,A=b!==-1,T=new KI(n.level,n.sn,n.stats.chunkCount,r.byteLength,b,A);m.push(r,x,d,"",n,s,h.totalduration,!1,T,y)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${h.startSN} ,${h.endSN}],track ${o}`);const{cache:_}=this.waitingData=this.waitingData||{frag:n,part:s,cache:new EH,complete:!1};_.push(new Uint8Array(r)),this.state!==ht.STOPPED&&(this.state=ht.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===Zt.MAIN&&zr(t.frag)&&(this.mainFragLoading=t,this.state===ht.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:n,part:s}=t;if(n.type!==Zt.AUDIO){!this.audioOnly&&n.type===Zt.MAIN&&!n.elementaryStreams.video&&!n.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${s?" p: "+s.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(zr(n)){this.fragPrevious=n;const r=this.switchingTrack;r&&(this.bufferedTrack=r,this.switchingTrack=null,this.hls.trigger(H.AUDIO_TRACK_SWITCHED,Pi({},r)))}this.fragBufferedComplete(n,s),this.media&&this.tick()}onError(e,t){var n;if(t.fatal){this.state=ht.ERROR;return}switch(t.details){case Pe.FRAG_GAP:case Pe.FRAG_PARSING_ERROR:case Pe.FRAG_DECRYPT_ERROR:case Pe.FRAG_LOAD_ERROR:case Pe.FRAG_LOAD_TIMEOUT:case Pe.KEY_LOAD_ERROR:case Pe.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Zt.AUDIO,t);break;case Pe.AUDIO_TRACK_LOAD_ERROR:case Pe.AUDIO_TRACK_LOAD_TIMEOUT:case Pe.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ht.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===$n.AUDIO_TRACK&&(this.state=ht.IDLE);break;case Pe.BUFFER_ADD_CODEC_ERROR:case Pe.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.resetLoadingState();break;case Pe.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Pe.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==Vi.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==Vi.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===ht.ENDED&&(this.state=ht.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,Zt.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:s}=this,{remuxResult:r,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:c,level:h}=o,{details:d}=h,{audio:m,text:y,id3:x,initSegment:_}=r;if(this.fragContextChanged(l)||!d){this.fragmentTracker.removeFragment(l);return}if(this.state=ht.PARSING,this.switchingTrack&&m&&this.completeAudioSwitch(this.switchingTrack),_!=null&&_.tracks){const b=l.initSegment||l;this._bufferInitSegment(h,_.tracks,b,a),s.trigger(H.FRAG_PARSING_INIT_SEGMENT,{frag:b,id:n,tracks:_.tracks})}if(m){const{startPTS:b,endPTS:A,startDTS:T,endDTS:w}=m;c&&(c.elementaryStreams[Vi.AUDIO]={startPTS:b,endPTS:A,startDTS:T,endDTS:w}),l.setElementaryStreamInfo(Vi.AUDIO,b,A,T,w),this.bufferFragmentData(m,l,c,a)}if(x!=null&&(t=x.samples)!=null&&t.length){const b=Yi({id:n,frag:l,details:d},x);s.trigger(H.FRAG_PARSING_METADATA,b)}if(y){const b=Yi({id:n,frag:l,details:d},y);s.trigger(H.FRAG_PARSING_USERDATA,b)}}_bufferInitSegment(e,t,n,s){if(this.state!==ht.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const r=t.audio;r.id=Zt.AUDIO;const a=e.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${a}/${r.codec}]`),a&&a.split(",").length===1&&(r.levelCodec=a),this.hls.trigger(H.BUFFER_CODECS,t);const o=r.initSegment;if(o!=null&&o.byteLength){const l={type:"audio",frag:n,part:null,chunkMeta:s,parent:n.type,data:o};this.hls.trigger(H.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,t,n){const s=this.fragmentTracker.getState(e);if(this.switchingTrack||s===Tr.NOT_LOADED||s===Tr.PARTIAL){var r;if(!zr(e))this._loadInitSegment(e,t);else if((r=t.details)!=null&&r.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=ht.WAITING_INIT_PTS;const a=this.mainDetails;a&&a.fragmentStart!==t.details.fragmentStart&&r3(t.details,a)}else super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:s,characteristics:r,audioCodec:a,channels:o}=this.bufferedTrack;qm({name:t,lang:n,assocLang:s,characteristics:r,audioCodec:a,channels:o},e,tm)||(t3(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(H.AUDIO_TRACK_SWITCHED,Pi({},e))}}class nB extends jf{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const s=t==null?void 0:t.renditionReports;if(s){let r=-1;for(let a=0;a<s.length;a++){const o=s[a];let l;try{l=new self.URL(o.URI,t.url).href}catch(c){this.warn(`Could not construct new URL for Rendition Report: ${c}`),l=o.URI||""}if(l===e){r=a;break}else l===e.substring(0,l.length)&&(r=a)}if(r!==-1){const a=s[r],o=parseInt(a["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let l=parseInt(a["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const h=Math.min(t.age-t.partTarget,t.targetduration);l>=0&&h>t.partTarget&&(l+=1)}const c=n&&fN(n);return new dN(o,l>=0?l:void 0,c)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(n){this.warn(`Could not construct new URL with HLS Delivery Directives: ${n}`)}return e}playlistLoaded(e,t,n){const{details:s,stats:r}=t,a=self.performance.now(),o=r.loading.first?Math.max(0,a-r.loading.first):0;s.advancedDateTime=Date.now()-o;const l=this.hls.config.timelineOffset;if(l!==s.appliedTimelineOffset){const h=Math.max(l||0,0);s.appliedTimelineOffset=h,s.fragments.forEach(d=>{d.start=d.playlistOffset+h})}if(s.live||n!=null&&n.live){const h="levelInfo"in t?t.levelInfo:t.track;if(s.reloaded(n),n&&s.fragments.length>0){tj(n,s);const T=s.playlistParsingError;if(T){this.warn(T);const w=this.hls;if(!w.config.ignorePlaylistParsingErrors){var c;const{networkDetails:R}=t;w.trigger(H.ERROR,{type:nn.NETWORK_ERROR,details:Pe.LEVEL_PARSING_ERROR,fatal:!1,url:s.url,error:T,reason:T.message,level:t.level||void 0,parent:(c=s.fragments[0])==null?void 0:c.type,networkDetails:R,stats:r});return}s.playlistParsingError=null}}s.requestScheduled===-1&&(s.requestScheduled=r.loading.start);const d=this.hls.mainForwardBufferInfo,m=d?d.end-d.len:0,y=(s.edge-m)*1e3,x=gH(s,y);if(s.requestScheduled+x<a?s.requestScheduled=a:s.requestScheduled+=x,this.log(`live playlist ${e} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED"}`),!this.canLoad||!s.live)return;let _,b,A;if(s.canBlockReload&&s.endSN&&s.advanced){const T=this.hls.config.lowLatencyMode,w=s.lastPartSn,R=s.endSN,O=s.lastPartIndex,N=O!==-1,U=w===R;N?U?(b=R+1,A=T?0:O):(b=w,A=T?O+1:s.maxPartIndex):b=R+1;const P=s.age,B=P+s.ageHeader;let L=Math.min(B-s.partTarget,s.targetduration*1.5);if(L>0){if(B>s.targetduration*3)this.log(`Playlist last advanced ${P.toFixed(2)}s ago. Omitting segment and part directives.`),b=void 0,A=void 0;else if(n!=null&&n.tuneInGoal&&B-s.partTarget>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${L} with playlist age: ${s.age}`),L=0;else{const F=Math.floor(L/s.targetduration);if(b+=F,A!==void 0){const j=Math.round(L%s.targetduration/s.partTarget);A+=j}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${P.toFixed(2)}s goal: ${L} skip sn ${F} to part ${A}`)}s.tuneInGoal=L}if(_=this.getDeliveryDirectives(s,t.deliveryDirectives,b,A),T||!U){s.requestScheduled=a,this.loadingPlaylist(h,_);return}}else(s.canBlockReload||s.canSkipUntil)&&(_=this.getDeliveryDirectives(s,t.deliveryDirectives,b,A));_&&b!==void 0&&s.canBlockReload&&(s.requestScheduled=r.loading.first+Math.max(x-o*2,x/2)),this.scheduleLoading(h,_,s)}else this.clearTimer()}scheduleLoading(e,t,n){const s=n||e.details;if(!s){this.loadingPlaylist(e,t);return}const r=self.performance.now(),a=s.requestScheduled;if(r>=a){this.loadingPlaylist(e,t);return}const o=a-r;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(o)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),o)}getDeliveryDirectives(e,t,n,s){let r=fN(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,s=t.part,r=ST.No),new dN(n,s,r)}checkRetry(e){const t=e.details,n=n3(e),s=e.errorAction,{action:r,retryCount:a=0,retryConfig:o}=s||{},l=!!s&&!!o&&(r===Ra.RetryRequest||!s.resolved&&r===Ra.SendAlternateToPenaltyBox);if(l){var c;if(a>=o.maxNumRetry)return!1;if(n&&(c=e.context)!=null&&c.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const h=VI(o,a);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),h),this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" in ${h}ms`)}e.levelRetry=!0,s.resolved=!0}return l}}function VH(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!kA(i[t].attrs,e[t].attrs))return!1;return!0}function kA(i,e,t){const n=i["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(s=>i[s]!==e[s])}function $D(i,e){return e.label.toLowerCase()===i.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(i.lang||"").toLowerCase())}class uq extends nB{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.MANIFEST_PARSED,this.onManifestParsed,this),e.on(H.LEVEL_LOADING,this.onLevelLoading,this),e.on(H.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(H.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(H.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.MANIFEST_PARSED,this.onManifestParsed,this),e.off(H.LEVEL_LOADING,this.onLevelLoading,this),e.off(H.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(H.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(H.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:s,details:r}=t,a=this.tracksInGroup[n];if(!a||a.groupId!==s){this.warn(`Audio track with id:${n} and group:${s} not found in active group ${a==null?void 0:a.groupId}`);return}const o=a.details;a.details=t.details,this.log(`Audio track ${n} "${a.name}" lang:${a.lang} group:${s} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,s=this.groupIds;let r=this.currentTrack;if(!n||(s==null?void 0:s.length)!==(n==null?void 0:n.length)||n!=null&&n.some(o=>(s==null?void 0:s.indexOf(o))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(m=>!n||n.indexOf(m.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(m=>m.default)&&(this.selectDefaultTrack=!1),o.forEach((m,y)=>{m.id=y});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const l=this.hls.config.audioPreference;if(!r&&l){const m=lh(l,o,tm);if(m>-1)r=o[m];else{const y=lh(l,this.tracks);r=this.tracks[y]}}let c=this.findTrackId(r);c===-1&&r&&(c=this.findTrackId(null));const h={audioTracks:o};this.log(`Updating audio tracks, ${o.length} track(s) found in group(s): ${n==null?void 0:n.join(",")}`),this.hls.trigger(H.AUDIO_TRACKS_UPDATED,h);const d=this.trackId;if(c!==-1&&d===-1)this.setAudioTrack(c);else if(o.length&&d===-1){var a;const m=new Error(`No audio track selected for current audio group-ID(s): ${(a=this.groupIds)==null?void 0:a.join(",")} track count: ${o.length}`);this.warn(m.message),this.hls.trigger(H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:m})}}}onError(e,t){t.fatal||!t.context||t.context.type===$n.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const s=this.currentTrack;if(s&&qm(e,s,tm))return s;const r=lh(e,this.tracksInGroup,tm);if(r>-1){const a=this.tracksInGroup[r];return this.setAudioTrack(r),a}else if(s){let a=t.loadLevel;a===-1&&(a=t.firstAutoLevel);const o=bX(e,t.levels,n,a,tm);if(o===-1)return null;t.nextLoadLevel=o}if(e.channels||e.audioCodec){const a=lh(e,n);if(a>-1)return n[a]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,s=t[e],r=s.details&&!s.details.live;if(e===this.trackId&&s===n&&r||(this.log(`Switching to audio-track ${e} "${s.name}" lang:${s.lang} group:${s.groupId} channels:${s.channels}`),this.trackId=e,this.currentTrack=s,this.hls.trigger(H.AUDIO_TRACK_SWITCHING,Pi({},s)),r))return;const a=this.switchParams(s.url,n==null?void 0:n.details,s.details);this.loadPlaylist(a)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const s=t[n];if(!(this.selectDefaultTrack&&!s.default)&&(!e||qm(e,s,tm)))return n}if(e){const{name:n,lang:s,assocLang:r,characteristics:a,audioCodec:o,channels:l}=e;for(let c=0;c<t.length;c++){const h=t[c];if(qm({name:n,lang:s,assocLang:r,characteristics:a,audioCodec:o,channels:l},h,tm))return c}for(let c=0;c<t.length;c++){const h=t[c];if(kA(e.attrs,h.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return c}for(let c=0;c<t.length;c++){const h=t[c];if(kA(e.attrs,h.attrs,["LANGUAGE"]))return c}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&t3(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,s=e.groupId,r=this.getUrlWithDirectives(e.url,t),a=e.details,o=a==null?void 0:a.age;this.log(`Loading audio-track ${n} "${e.name}" lang:${e.lang} group:${s}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${r}`),this.hls.trigger(H.AUDIO_TRACK_LOADING,{url:r,id:n,groupId:s,deliveryDirectives:t||null,track:e})}}class hq{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,n){if(this.queues===null||this.tracks===null)return;const s=this.queues[t];s.push(e),s.length===1&&!n&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const n={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(n,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const n={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(n)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const n=(t=e[0])==null?void 0:t.label;(n==="async-blocker"||n==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const s=t[0];try{s.execute()}catch(r){var n;if(s.onError(r),this.queues===null||this.tracks===null)return;const a=(n=this.tracks[e])==null?void 0:n.buffer;a!=null&&a.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,n;return(t=this.queues)!=null&&t[e]||(n=this.tracks)!=null&&n[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const n=(t=this.tracks)==null?void 0:t[e],s=n==null?void 0:n.buffer;return s?`SourceBuffer${s.updating?" updating":""}${n.ended?" ended":""}${n.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(n=>n.label).join(", "))||""}}const QN=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,YH="HlsJsTrackRemovedError";class fq extends Error{constructor(e){super(e),this.name=YH}}class dq extends jf{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=n=>{var s;this.hls&&((s=this.mediaSource)==null?void 0:s.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=n=>{const{media:s,mediaSource:r}=this;n&&this.log("Media source opened"),!(!s||!r)&&(r.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(H.MEDIA_ATTACHED,{media:s,mediaSource:r}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:s}=this;n!==s&&this.error(`Media element src was set while attaching MediaSource (${s} > ${n})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=UW(L0(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.MANIFEST_PARSED,this.onManifestParsed,this),e.on(H.BUFFER_RESET,this.onBufferReset,this),e.on(H.BUFFER_APPENDING,this.onBufferAppending,this),e.on(H.BUFFER_CODECS,this.onBufferCodecs,this),e.on(H.BUFFER_EOS,this.onBufferEos,this),e.on(H.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(H.FRAG_PARSED,this.onFragParsed,this),e.on(H.FRAG_CHANGED,this.onFragChanged,this),e.on(H.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.MANIFEST_PARSED,this.onManifestParsed,this),e.off(H.BUFFER_RESET,this.onBufferReset,this),e.off(H.BUFFER_APPENDING,this.onBufferAppending,this),e.off(H.BUFFER_CODECS,this.onBufferCodecs,this),e.off(H.BUFFER_EOS,this.onBufferEos,this),e.off(H.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(H.FRAG_PARSED,this.onFragParsed,this),e.off(H.FRAG_CHANGED,this.onFragChanged,this),e.off(H.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const n={};if(this.operationQueue){const r=this.isUpdating();r||this.operationQueue.removeBlockers();const a=this.isQueued();(r||a)&&this.warn(`Transfering MediaSource with${a?" operations in queue":""}${r?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const s=this.transferData;return!this.sourceBufferCount&&s&&s.mediaSource===t?Yi(n,s.tracks):this.sourceBuffers.forEach(r=>{const[a]=r;a&&(n[a]=Yi({},this.tracks[a]),this.removeBuffer(a)),r[0]=r[1]=null}),{media:e,mediaSource:t,tracks:n}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var n;let s=2;(t.audio&&!t.video||!t.altAudio)&&(s=1),this.bufferCodecEventsTotal=s,this.log(`${s} bufferCodec event(s) expected.`),(n=this.transferData)!=null&&n.mediaSource&&this.sourceBufferCount&&s&&this.bufferCreated()}onMediaAttaching(e,t){const n=this.media=t.media,s=L0(this.appendSource);if(this.transferData=this.overrides=void 0,n&&s){const r=!!t.mediaSource;(r||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const a=this.mediaSource=t.mediaSource||new s;if(this.assignMediaSource(a),r)this._objectUrl=n.src,this.attachTransferred();else{const o=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{n.removeAttribute("src");const l=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||l&&a instanceof l,$N(n),pq(n,o),n.load()}catch{n.src=o}else n.src=o}n.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,n;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(n=e.constructor)==null?void 0:n.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const n=this.tracks,s=t.tracks,r=s?Object.keys(s):null,a=r?r.length:0,o=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(s&&r&&a){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${xs(n,(l,c)=>l==="initSegment"?void 0:c)};
transfer tracks: ${xs(s,(l,c)=>l==="initSegment"?void 0:c)}}`),!Y5(s,n)){t.mediaSource=null,t.tracks=void 0;const l=e.currentTime,c=this.details,h=Math.max(l,(c==null?void 0:c.fragments[0].start)||0);if(h-l>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${l} -> ${h}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(s)}"->"${Object.keys(n)}") start time: ${h} currentTime: ${l}`),this.onMediaDetaching(H.MEDIA_DETACHING,{}),this.onMediaAttaching(H.MEDIA_ATTACHING,t),e.currentTime=h;return}this.transferData=void 0,r.forEach(l=>{const c=l,h=s[c];if(h){const d=h.buffer;if(d){const m=this.fragmentTracker,y=h.id;if(m.hasFragments(y)||m.hasParts(y)){const b=Hn.getBuffered(d);m.detectEvictedFragments(c,b,y,null,!0)}const x=zC(c),_=[c,d];this.sourceBuffers[x]=_,d.updating&&this.operationQueue&&this.operationQueue.prependBlocker(c),this.trackSourceBuffer(c,h)}}}),o(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),o()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const n=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:s,mediaSource:r,_objectUrl:a}=this;if(r){if(this.log(`media source ${n?"transferring":"detaching"}`),n)this.sourceBuffers.forEach(([o])=>{o&&this.removeBuffer(o)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const o=r.readyState==="open";try{const l=r.sourceBuffers;for(let c=l.length;c--;)o&&l[c].abort(),r.removeSourceBuffer(l[c]);o&&r.endOfStream()}catch(l){this.warn(`onMediaDetaching: ${l.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}r.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("sourceended",this._onMediaSourceEnded),r.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}s&&(s.removeEventListener("emptied",this._onMediaEmptied),n||(a&&self.URL.revokeObjectURL(a),this.mediaSrc===a?(s.removeAttribute("src"),this.appendSource&&$N(s),s.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(H.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const n=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),n)try{var s;(s=this.mediaSource)!=null&&s.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}catch(r){this.warn(`onBufferReset ${e}`,r)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[zC(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new hq(this.tracks)}onBufferCodecs(e,t){const n=this.tracks,s=Object.keys(t);this.log(`BUFFER_CODECS: "${s}" (current SB count ${this.sourceBufferCount})`);const r="audiovideo"in t&&(n.audio||n.video)||n.audiovideo&&("audio"in t||"video"in t),a=!r&&this.sourceBufferCount&&this.media&&s.some(o=>!n[o]);if(r||a){this.warn(`Unsupported transition between "${Object.keys(n)}" and "${s}" SourceBuffers`);return}s.forEach(o=>{var l,c,h;const d=t[o],{id:m,codec:y,levelCodec:x,container:_,metadata:b,supplemental:A}=d;let T=n[o];const w=(l=this.transferData)==null||(c=l.tracks)==null?void 0:c[o],R=w!=null&&w.buffer?w:T,O=(R==null?void 0:R.pendingCodec)||(R==null?void 0:R.codec),N=R==null?void 0:R.levelCodec;T||(T=n[o]={buffer:void 0,listeners:[],codec:y,supplemental:A,container:_,levelCodec:x,metadata:b,id:m});const U=_T(O,N),P=U==null?void 0:U.replace(QN,"$1");let B=_T(y,x);const L=(h=B)==null?void 0:h.replace(QN,"$1");B&&U&&P!==L&&(o.slice(0,5)==="audio"&&(B=ZT(B,this.appendSource)),this.log(`switching codec ${O} to ${B}`),B!==(T.pendingCodec||T.codec)&&(T.pendingCodec=B),T.container=_,this.appendChangeType(o,_,B))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&this.mediaSourceOpenOrEnded&&this.checkPendingTracks()}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const n=this.tracks[t];return e[t]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},e},{})}appendChangeType(e,t,n){const s=`${t};codecs=${n}`,r={label:`change-type=${s}`,execute:()=>{const a=this.tracks[e];if(a){const o=a.buffer;o!=null&&o.changeType&&(this.log(`changing ${e} sourceBuffer type to ${s}`),o.changeType(s),a.codec=n,a.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn(`Failed to change ${e} SourceBuffer type`,a)}};this.append(r,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const n=e.start,s=n+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(n,Zt.MAIN))==null?void 0:t.gap)===!0)return;const a={label:"block-audio",execute:()=>{var o;const l=this.tracks.video;(this.lastVideoAppendEnd>s||l!=null&&l.buffer&&Hn.isBuffered(l.buffer,s)||((o=this.fragmentTracker.getAppendedFrag(s,Zt.MAIN))==null?void 0:o.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn("Error executing block-audio operation",o)}};this.blockedAudioAppend={op:a,frag:e},this.append(a,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:n}=this,{data:s,type:r,parent:a,frag:o,part:l,chunkMeta:c}=t,h=c.buffering[r],d=o.sn,m=self.performance.now();h.start=m;const y=o.stats.buffering,x=l?l.stats.buffering:null;y.start===0&&(y.start=m),x&&x.start===0&&(x.start=m);const _=n.audio;let b=!1;r==="audio"&&(_==null?void 0:_.container)==="audio/mpeg"&&(b=!this.lastMpegAudioChunk||c.id===1||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);const A=this.tracks.video,T=A==null?void 0:A.buffer;if(T&&d!=="initSegment"){const O=l||o,N=this.blockedAudioAppend;if(r==="audio"&&a!=="main"&&!this.blockedAudioAppend){const P=O.start+O.duration*.05,B=T.buffered,L=this.currentOp("video");!B.length&&!L?this.blockAudio(O):!L&&!Hn.isBuffered(T,P)&&this.lastVideoAppendEnd<P&&this.blockAudio(O)}else if(r==="video"){const U=O.end;if(N){const P=N.frag.start;(U>P||U<this.lastVideoAppendEnd||Hn.isBuffered(T,P))&&this.unblockAudio()}this.lastVideoAppendEnd=U}}const w=(l||o).start,R={label:`append-${r}`,execute:()=>{if(h.executeStart=self.performance.now(),b){const O=this.tracks[r];if(O){const N=O.buffer;if(N){const U=w-N.timestampOffset;Math.abs(U)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${w} (delta: ${U}) sn: ${d})`),N.timestampOffset=w)}}}this.appendExecutor(s,r)},onStart:()=>{},onComplete:()=>{const O=self.performance.now();h.executeEnd=h.end=O,y.first===0&&(y.first=O),x&&x.first===0&&(x.first=O);const N={};this.sourceBuffers.forEach(([U,P])=>{U&&(N[U]=Hn.getBuffered(P))}),this.appendErrors[r]=0,r==="audio"||r==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(H.BUFFER_APPENDED,{type:r,frag:o,part:l,chunkMeta:c,parent:o.type,timeRanges:N})},onError:O=>{var N;const U={type:nn.MEDIA_ERROR,parent:o.type,details:Pe.BUFFER_APPEND_ERROR,sourceBufferName:r,frag:o,part:l,chunkMeta:c,error:O,err:O,fatal:!1},P=(N=this.media)==null?void 0:N.error;if(O.code===DOMException.QUOTA_EXCEEDED_ERR)U.details=Pe.BUFFER_FULL_ERROR;else if(O.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!P)U.errorAction=BA(!0);else if(O.name===YH&&this.sourceBufferCount===0)U.errorAction=BA(!0);else{const B=++this.appendErrors[r];this.warn(`Failed ${B}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${r}" sourceBuffer (${P||"no media error"})`),(B>=this.hls.config.appendErrorMaxRetry||P)&&(U.fatal=!0)}this.hls.trigger(H.ERROR,U)}};this.append(R,r,this.isPending(this.tracks[r]))}getFlushOp(e,t,n){return this.log(`queuing "${e}" remove ${t}-${n}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,n)},onStart:()=>{},onComplete:()=>{this.hls.trigger(H.BUFFER_FLUSHED,{type:e})},onError:s=>{this.warn(`Failed to remove ${t}-${n} from "${e}" SourceBuffer`,s)}}}onBufferFlushing(e,t){const{type:n,startOffset:s,endOffset:r}=t;n?this.append(this.getFlushOp(n,s,r),n):this.sourceBuffers.forEach(([a])=>{a&&this.append(this.getFlushOp(a,s,r),a)})}onFragParsed(e,t){const{frag:n,part:s}=t,r=[],a=s?s.elementaryStreams:n.elementaryStreams;a[Vi.AUDIOVIDEO]?r.push("audiovideo"):(a[Vi.AUDIO]&&r.push("audio"),a[Vi.VIDEO]&&r.push("video"));const o=()=>{const l=self.performance.now();n.stats.buffering.end=l,s&&(s.stats.buffering.end=l);const c=s?s.stats:n.stats;this.hls.trigger(H.FRAG_BUFFERED,{frag:n,part:s,stats:c,id:n.type})};r.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(o,r).catch(l=>{this.warn(`Fragment buffered callback ${l}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t,n;return e&&(!((t=this.tracks[e])!=null&&t.ended)||((n=this.tracks[e])==null?void 0:n.ending))})}onBufferEos(e,t){var n;this.sourceBuffers.forEach(([a])=>{if(a){const o=this.tracks[a];(!t.type||t.type===a)&&(o.ending=!0,o.ended||(o.ended=!0,this.log(`${a} buffer reached EOS`)))}});const s=((n=this.overrides)==null?void 0:n.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([a])=>{var o;return a&&!((o=this.tracks[a])!=null&&o.ended)})&&(s?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:a}=this;if(!a||a.readyState!=="open"){a&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${a.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),a.endOfStream(),this.hls.trigger(H.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(H.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){const e=this.getDurationAndRange();e&&this.blockUntilOpen(()=>this.updateMediaSource(e))}onError(e,t){if(t.details===Pe.BUFFER_APPEND_ERROR&&t.frag){var n;const s=(n=t.errorAction)==null?void 0:n.nextAutoLevel;Vt(s)&&s!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.sourceBufferCount)return;const s=e.config,r=n.currentTime,a=t.levelTargetDuration,o=t.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(Vt(o)&&o>=0){const l=Math.max(o,a),c=Math.floor(r/a)*a-l;this.flushBackBuffer(r,a,c)}if(Vt(s.frontBufferFlushThreshold)&&s.frontBufferFlushThreshold>0){const l=Math.max(s.maxBufferLength,s.frontBufferFlushThreshold),c=Math.max(l,a),h=Math.floor(r/a)*a+c;this.flushFrontBuffer(r,a,h)}}flushBackBuffer(e,t,n){this.sourceBuffers.forEach(([s,r])=>{if(r){const o=Hn.getBuffered(r);if(o.length>0&&n>o.start(0)){var a;this.hls.trigger(H.BACK_BUFFER_REACHED,{bufferEnd:n});const l=this.tracks[s];if((a=this.details)!=null&&a.live)this.hls.trigger(H.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(l!=null&&l.ended){this.log(`Cannot flush ${s} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(H.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:s})}}})}flushFrontBuffer(e,t,n){this.sourceBuffers.forEach(([s,r])=>{if(r){const a=Hn.getBuffered(r),o=a.length;if(o<2)return;const l=a.start(o-1),c=a.end(o-1);if(n>l||e>=l&&e<=c)return;this.hls.trigger(H.BUFFER_FLUSHING,{startOffset:l,endOffset:1/0,type:s})}})}getDurationAndRange(){var e;const{details:t,mediaSource:n}=this;if(!t||!this.media||(n==null?void 0:n.readyState)!=="open")return null;const s=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&t.live&&n.setLiveSeekableRange){const c=Math.max(0,t.fragmentStart),h=Math.max(c,s);return{duration:1/0,start:c,end:h}}return{duration:1/0}}const r=(e=this.overrides)==null?void 0:e.duration;if(r)return Vt(r)?{duration:r}:null;const a=this.media.duration,o=Vt(n.duration)?n.duration:0;return s>o&&s>a||!Vt(a)?{duration:s}:null}updateMediaSource({duration:e,start:t,end:n}){const s=this.mediaSource;!this.media||!s||s.readyState!=="open"||(s.duration!==e&&(Vt(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),s.duration=e),t!==void 0&&n!==void 0&&(this.log(`MediaSource duration is set to ${s.duration}. Setting seekable range to ${t}-${n}.`),s.setLiveSeekableRange(t,n)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:n}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${xs(n)}`),this.tracksReady){var s;const r=(s=this.transferData)==null?void 0:s.tracks;r&&Object.keys(r).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,n])=>{if(t){const s=this.tracks[t];e[t]={buffer:n,container:s.container,codec:s.codec,supplemental:s.supplemental,levelCodec:s.levelCodec,id:s.id,metadata:s.metadata}}}),this.hls.trigger(H.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:n}=this;if(!n)throw new Error("createSourceBuffers called when mediaSource was null");for(const r in e){const a=r,o=e[a];if(this.isPending(o)){const l=this.getTrackCodec(o,a),c=`${o.container};codecs=${l}`;o.codec=l,this.log(`creating sourceBuffer(${c})${this.currentOp(a)?" Queued":""} ${xs(o)}`);try{const h=n.addSourceBuffer(c),d=zC(a),m=[a,h];t[d]=m,o.buffer=h}catch(h){var s;this.error(`error while trying to add sourceBuffer: ${h.message}`),this.shiftAndExecuteNext(a),(s=this.operationQueue)==null||s.removeBlockers(),delete this.tracks[a],this.hls.trigger(H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,sourceBufferName:a,mimeType:c,parent:o.id});return}this.trackSourceBuffer(a,o)}}this.bufferCreated()}getTrackCodec(e,t){const n=e.supplemental;let s=e.codec;n&&(t==="video"||t==="audiovideo")&&VD(n,"video")&&(s=aX(s,n));const r=_T(s,e.levelCodec);return r?t.slice(0,5)==="audio"?ZT(r,this.appendSource):r:""}trackSourceBuffer(e,t){const n=t.buffer;if(!n)return;const s=this.getTrackCodec(t,e);this.tracks[e]={buffer:n,codec:s,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(r,a)=>{const o=a.removedRanges;o!=null&&o.length&&this.hls.trigger(H.BUFFER_FLUSHED,{type:r})})}get mediaSrc(){var e,t;const n=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return n==null?void 0:n.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const n=this.currentOp(e);n&&(n.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var n;const s=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${s}`,t),this.hls.trigger(H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:s,fatal:!1});const r=this.currentOp(e);r&&r.onError(s)}removeExecutor(e,t,n){const{media:s,mediaSource:r}=this,a=this.tracks[e],o=a==null?void 0:a.buffer;if(!s||!r||!o){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const l=Vt(s.duration)?s.duration:1/0,c=Vt(r.duration)?r.duration:1/0,h=Math.max(0,t),d=Math.min(n,l,c);d>h&&(!a.ending||a.ended)?(a.ended=!1,this.log(`Removing [${h},${d}] from the ${e} SourceBuffer`),o.remove(h,d)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.tracks[t],s=n==null?void 0:n.buffer;if(!s)throw new fq(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);n.ending=!1,n.ended=!1,s.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:n}=this,s=t.map(a=>this.appendBlocker(a));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(s).then(a=>{n===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var n;const s=(n=this.tracks[t])==null?void 0:n.buffer;!s||s.updating||this.shiftAndExecuteNext(t)})}append(e,t,n){this.operationQueue&&this.operationQueue.append(e,t,n)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,n){const s=this.tracks[e];if(!s)return;const r=s.buffer;if(!r)return;const a=n.bind(this,e);s.listeners.push({event:t,listener:a}),r.addEventListener(t,a)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const n=t.buffer;n&&(t.listeners.forEach(s=>{n.removeEventListener(s.event,s.listener)}),t.listeners.length=0)}}function $N(i){const e=i.querySelectorAll("source");[].slice.call(e).forEach(t=>{i.removeChild(t)})}function pq(i,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,i.appendChild(t)}function zC(i){return i==="audio"?1:0}class iB{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(H.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(H.MANIFEST_PARSED,this.onManifestParsed,this),e.on(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(H.BUFFER_CODECS,this.onBufferCodecs,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(H.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(H.MANIFEST_PARSED,this.onManifestParsed,this),e.off(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(H.BUFFER_CODECS,this.onBufferCodecs,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&Vt(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((s,r)=>this.isLevelAllowed(s)&&r<=e);return this.clientRect=null,iB.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const s=(o,l)=>l?o.width!==l.width||o.height!==l.height:!0;let r=e.length-1;const a=Math.max(t,n);for(let o=0;o<e.length;o+=1){const l=e[o];if((l.width>=a||l.height>=a)&&s(l,e[o+1])){r=o;break}}return r}}const mq={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},yo=mq,gq={HLS:"h"},yq=gq,vq="CMCD-Object",xq="CMCD-Request",bq="CMCD-Session",Aq="CMCD-Status",Wb={OBJECT:vq,REQUEST:xq,SESSION:bq,STATUS:Aq},Eq={[Wb.OBJECT]:["br","d","ot","tb"],[Wb.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[Wb.SESSION]:["cid","pr","sf","sid","st","v"],[Wb.STATUS]:["bs","rtp"]};class vv{constructor(e,t){Array.isArray(e)&&(e=e.map(n=>n instanceof vv?n:new vv(n))),this.value=e,this.params=t}}const _q="Dict";function Sq(i){return Array.isArray(i)?JSON.stringify(i):i instanceof Map?"Map{}":i instanceof Set?"Set{}":typeof i=="object"?JSON.stringify(i):String(i)}function Tq(i,e,t,n){return new Error(`failed to ${i} "${Sq(e)}" as ${t}`,{cause:n})}function mh(i,e,t){return Tq("serialize",i,e,t)}class KH{constructor(e){this.description=e}}const JN="Bare Item",wq="Boolean";function Mq(i){if(typeof i!="boolean")throw mh(i,wq);return i?"?1":"?0"}const Cq="Byte Sequence";function Rq(i){if(ArrayBuffer.isView(i)===!1)throw mh(i,Cq);return`:${Sj(i)}:`}const Dq="Integer";function Lq(i){return i<-999999999999999||999999999999999<i}function WH(i){if(Lq(i))throw mh(i,Dq);return i.toString()}function Iq(i){return`@${WH(i.getTime()/1e3)}`}const Bq="Decimal";function Oq(i){const e=RH(i,3);if(Math.floor(Math.abs(e)).toString().length>12)throw mh(i,Bq);const t=e.toString();return t.includes(".")?t:`${t}.0`}const Pq="String",Nq=/[\x00-\x1f\x7f]+/;function Uq(i){if(Nq.test(i))throw mh(i,Pq);return`"${i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function kq(i){return i.description||i.toString().slice(7,-1)}const Fq="Token";function ZN(i){const e=kq(i);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw mh(e,Fq);return e}function JD(i){switch(typeof i){case"number":if(!Vt(i))throw mh(i,JN);return Number.isInteger(i)?WH(i):Oq(i);case"string":return Uq(i);case"symbol":return ZN(i);case"boolean":return Mq(i);case"object":if(i instanceof Date)return Iq(i);if(i instanceof Uint8Array)return Rq(i);if(i instanceof KH)return ZN(i);default:throw mh(i,JN)}}const Hq="Key";function ZD(i){if(/^[a-z*][a-z0-9\-_.*]*$/.test(i)===!1)throw mh(i,Hq);return i}function sB(i){return i==null?"":Object.entries(i).map(([e,t])=>t===!0?`;${ZD(e)}`:`;${ZD(e)}=${JD(t)}`).join("")}function XH(i){return i instanceof vv?`${JD(i.value)}${sB(i.params)}`:JD(i)}function Gq(i){return`(${i.value.map(XH).join(" ")})${sB(i.params)}`}function zq(i,e={whitespace:!0}){if(typeof i!="object")throw mh(i,_q);const t=i instanceof Map?i.entries():Object.entries(i),n=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([s,r])=>{r instanceof vv||(r=new vv(r));let a=ZD(s);return r.value===!0?a+=sB(r.params):(a+="=",Array.isArray(r.value)?a+=Gq(r):a+=XH(r)),a}).join(`,${n}`)}function Vq(i,e){return zq(i,e)}function Yq(i){return i==="ot"||i==="sf"||i==="st"}function Kq(i){return typeof i=="number"?Vt(i):i!=null&&i!==""&&i!==!1}const MT=i=>Math.round(i),Wq=(i,e)=>(e!=null&&e.baseUrl&&(i=Tj(i,e.baseUrl)),encodeURIComponent(i)),V_=i=>MT(i/100)*100,Xq={br:MT,d:MT,bl:V_,dl:V_,mtp:V_,nor:Wq,rtp:V_,tb:MT};function jq(i,e){const t={};if(i==null||typeof i!="object")return t;const n=Object.keys(i).sort(),s=Yi({},Xq,e==null?void 0:e.formatters),r=e==null?void 0:e.filter;return n.forEach(a=>{if(r!=null&&r(a))return;let o=i[a];const l=s[a];l&&(o=l(o,e)),!(a==="v"&&o===1)&&(a=="pr"&&o===1||Kq(o)&&(Yq(a)&&typeof o=="string"&&(o=new KH(o)),t[a]=o))}),t}function jH(i,e={}){return i?Vq(jq(i,e),Yi({whitespace:!1},e)):""}function qq(i,e={}){const t={};if(!i)return t;const n=Object.entries(i),s=Object.entries(Eq).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),r=n.reduce((a,o)=>{var l,c;const[h,d]=o,m=((l=s.find(y=>y[1].includes(h)))===null||l===void 0?void 0:l[0])||Wb.REQUEST;return(c=a[m])!==null&&c!==void 0||(a[m]={}),a[m][h]=d,a},{});return Object.entries(r).reduce((a,[o,l])=>(a[o]=jH(l,e),a),t)}function Qq(i,e,t){return Yi(i,qq(e,t))}const $q="CMCD";function Jq(i,e={}){if(!i)return"";const t=jH(i,e);return`${$q}=${encodeURIComponent(t)}`}const eU=/CMCD=[^&#]+/;function Zq(i,e,t){const n=Jq(e,t);if(!n)return i;if(eU.test(i))return i.replace(eU,n);const s=i.includes("?")?"&":"?";return`${i}${s}${n}`}class eQ{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=s=>{try{this.apply(s,{ot:yo.MANIFEST,su:!this.initialized})}catch(r){this.hls.logger.warn("Could not generate manifest CMCD data.",r)}},this.applyFragmentData=s=>{try{const{frag:r,part:a}=s,o=this.hls.levels[r.level],l=this.getObjectType(r),c={d:(a||r).duration*1e3,ot:l};(l===yo.VIDEO||l===yo.AUDIO||l==yo.MUXED)&&(c.br=o.bitrate/1e3,c.tb=this.getTopBandwidth(l)/1e3,c.bl=this.getBufferLength(l));const h=a?this.getNextPart(a):this.getNextFrag(r);h!=null&&h.url&&h.url!==r.url&&(c.nor=h.url),this.apply(s,c)}catch(r){this.hls.logger.warn("Could not generate segment CMCD data.",r)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.sessionId,this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(H.MEDIA_DETACHED,this.onMediaDetached,this),e.on(H.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(H.MEDIA_DETACHED,this.onMediaDetached,this),e.off(H.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,s;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(s=t.tracks.video)==null?void 0:s.buffer}createData(){var e;return{v:1,sf:yq.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Yi(t,this.createData());const n=t.ot===yo.INIT||t.ot===yo.VIDEO||t.ot===yo.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:s}=this;s&&(t=Object.keys(t).reduce((a,o)=>(s.includes(o)&&(a[o]=t[o]),a),{}));const r={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),Qq(e.headers,t,r)):e.url=Zq(e.url,t,r)}getNextFrag(e){var t;const n=(t=this.hls.levels[e.level])==null?void 0:t.details;if(n){const s=e.sn-n.startSN;return n.fragments[s+1]}}getNextPart(e){var t,n;const{index:s,fragment:r}=e,a=(t=this.hls.levels[r.level])==null||(n=t.details)==null?void 0:n.partList;if(a){const{sn:o}=r;for(let l=a.length-1;l>=0;l--){const c=a[l];if(c.index===s&&c.fragment.sn===o)return a[l+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return yo.TIMED_TEXT;if(e.sn==="initSegment")return yo.INIT;if(t==="audio")return yo.AUDIO;if(t==="main")return this.hls.audioTracks.length?yo.VIDEO:yo.MUXED}getTopBandwidth(e){let t=0,n;const s=this.hls;if(e===yo.AUDIO)n=s.audioTracks;else{const r=s.maxAutoLevel,a=r>-1?r+1:s.levels.length;n=s.levels.slice(0,a)}for(const r of n)r.bitrate>t&&(t=r.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.media,n=e===yo.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:Hn.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(r){this.loader=void 0,this.loader=new n(r)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(r,a,o){t(r),this.loader.load(r,a,o)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(r){this.loader=void 0,this.loader=new n(r)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(r,a,o){t(r),this.loader.load(r,a,o)}}}}const tQ=3e5;class nQ extends jf{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(H.MANIFEST_PARSED,this.onManifestParsed,this),e.on(H.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(H.MANIFEST_PARSED,this.onManifestParsed,this),e.off(H.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((n==null?void 0:n.action)===Ra.SendAlternateToPenaltyBox&&n.flags===Rc.MoveAllAlternatesMatchingHost){const s=this.levels;let r=this._pathwayPriority,a=this.pathwayId;if(t.context){const{groupId:o,pathwayId:l,type:c}=t.context;o&&s?a=this.getPathwayForGroupId(o,c,a):l&&(a=l)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!r&&s&&(r=this.pathways()),r&&r.length>1&&(this.updatePathwayPriority(r),n.resolved=this.pathwayId!==a),n.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${a} levels: ${s&&s.length} priorities: ${xs(r)} penalized: ${xs(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const n=this.penalizedPathways,s=performance.now();Object.keys(n).forEach(r=>{s-n[r]>tQ&&delete n[r]});for(let r=0;r<e.length;r++){const a=e[r];if(a in n)continue;if(a===this.pathwayId)return;const o=this.hls.nextLoadLevel,l=this.hls.levels[o];if(t=this.getLevelsForPathway(a),t.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,xH(t),this.hls.trigger(H.LEVELS_UPDATED,{levels:t});const c=this.hls.levels[o];l&&c&&this.levels&&(c.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&c.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${c.bitrate}`),this.hls.nextLoadLevel=o);break}}}getPathwayForGroupId(e,t,n){const s=this.getLevelsForPathway(n).concat(this.levels||[]);for(let r=0;r<s.length;r++)if(t===$n.AUDIO_TRACK&&s[r].hasAudioGroup(e)||t===$n.SUBTITLE_TRACK&&s[r].hasSubtitleGroup(e))return s[r].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},s={};e.forEach(r=>{const{ID:a,"BASE-ID":o,"URI-REPLACEMENT":l}=r;if(t.some(h=>h.pathwayId===a))return;const c=this.getLevelsForPathway(o).map(h=>{const d=new Cs(h.attrs);d["PATHWAY-ID"]=a;const m=d.AUDIO&&`${d.AUDIO}_clone_${a}`,y=d.SUBTITLES&&`${d.SUBTITLES}_clone_${a}`;m&&(n[d.AUDIO]=m,d.AUDIO=m),y&&(s[d.SUBTITLES]=y,d.SUBTITLES=y);const x=qH(h.uri,d["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),_=new IA({attrs:d,audioCodec:h.audioCodec,bitrate:h.bitrate,height:h.height,name:h.name,url:x,videoCodec:h.videoCodec,width:h.width});if(h.audioGroups)for(let b=1;b<h.audioGroups.length;b++)_.addGroupId("audio",`${h.audioGroups[b]}_clone_${a}`);if(h.subtitleGroups)for(let b=1;b<h.subtitleGroups.length;b++)_.addGroupId("text",`${h.subtitleGroups[b]}_clone_${a}`);return _});t.push(...c),tU(this.audioTracks,n,l,a),tU(this.subtitleTracks,s,l,a)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let s;try{s=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(s.protocol!=="data:"){const h=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+h)}const r={responseType:"json",url:s.href},a=t.steeringManifestLoadPolicy.default,o=a.errorRetry||a.timeoutRetry||{},l={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},c={onSuccess:(h,d,m,y)=>{this.log(`Loaded steering manifest: "${s}"`);const x=h.data;if((x==null?void 0:x.VERSION)!==1){this.log(`Steering VERSION ${x.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=x.TTL;const{"RELOAD-URI":_,"PATHWAY-CLONES":b,"PATHWAY-PRIORITY":A}=x;if(_)try{this.uri=new self.URL(_,s).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${_}`);return}this.scheduleRefresh(this.uri||m.url),b&&this.clonePathways(b);const T={steeringManifest:x,url:s.toString()};this.hls.trigger(H.STEERING_MANIFEST_LOADED,T),A&&this.updatePathwayPriority(A)},onError:(h,d,m,y)=>{if(this.log(`Error loading steering manifest: ${h.code} ${h.text} (${d.url})`),this.stopLoad(),h.code===410){this.enabled=!1,this.log(`Steering manifest ${d.url} no longer available`);return}let x=this.timeToLoad*1e3;if(h.code===429){const _=this.loader;if(typeof(_==null?void 0:_.getResponseHeader)=="function"){const b=_.getResponseHeader("Retry-After");b&&(x=parseFloat(b)*1e3)}this.log(`Steering manifest ${d.url} rate limited`);return}this.scheduleRefresh(this.uri||d.url,x)},onTimeout:(h,d,m)=>{this.log(`Timeout loading steering manifest (${d.url})`),this.scheduleRefresh(this.uri||d.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(r,l,c)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const s=(n=this.hls)==null?void 0:n.media;if(s&&!s.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function tU(i,e,t,n){i&&Object.keys(e).forEach(s=>{const r=i.filter(a=>a.groupId===s).map(a=>{const o=Yi({},a);return o.details=void 0,o.attrs=new Cs(o.attrs),o.url=o.attrs.URI=qH(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),o.groupId=o.attrs["GROUP-ID"]=e[s],o.attrs["PATHWAY-ID"]=n,o});i.push(...r)})}function qH(i,e,t,n){const{HOST:s,PARAMS:r,[t]:a}=n;let o;e&&(o=a==null?void 0:a[e],o&&(i=o));const l=new self.URL(i);return s&&!o&&(l.host=s),r&&Object.keys(r).sort().forEach(c=>{c&&l.searchParams.set(c,r[c])}),l.href}class vy extends jf{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=vy.CDMCleanupPromise?[vy.CDMCleanupPromise]:[],this.onMediaEncrypted=t=>{const{initDataType:n,initData:s}=t,r=`"${t.type}" event: init data type: "${n}"`;if(this.debug(r),s!==null){if(!this.keyFormatPromise){let a=Object.keys(this.keySystemAccessPromises);a.length||(a=F_(this.config));const o=a.map(OC).filter(l=>!!l);this.keyFormatPromise=this.getKeyFormatPromise(o)}this.keyFormatPromise.then(a=>{const o=IC(a);let l,c;if(n==="sinf"){if(o!==Ni.FAIRPLAY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${n}" for selected key-system ${o}`);return}const x=Sr(new Uint8Array(s));try{const _=XI(JSON.parse(x).sinf),b=$5(_);if(!b)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");l=new Uint8Array(b.subarray(8,24)),c=Ni.FAIRPLAY}catch(_){this.warn(`${r} Failed to parse sinf: ${_}`);return}}else{if(o!==Ni.WIDEVINE&&o!==Ni.PLAYREADY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${n}" for selected key-system ${o}`);return}const x=nX(s),_=x.filter(A=>!!A.systemId&&BC(A.systemId)===o);_.length>1&&this.warn(`${r} Using first of ${_.length} pssh found for selected key-system ${o}`);const b=_[0];if(!b){x.length===0||x.some(A=>!A.systemId)?this.warn(`${r} contains incomplete or invalid pssh data`):this.log(`ignoring ${r} for ${x.map(A=>BC(A.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(c=BC(b.systemId),b.version===0&&b.data)if(c===Ni.WIDEVINE){const A=b.data.length-22;l=new Uint8Array(b.data.subarray(A,A+16))}else c===Ni.PLAYREADY&&(l=fH(b.data))}if(!c||!l)return;const h=Wu.hexDump(l),{keyIdToKeySessionPromise:d,mediaKeySessions:m}=this;let y=d[h];for(let x=0;x<m.length;x++){const _=m[x],b=_.decryptdata;if(!b.keyId)continue;const A=Wu.hexDump(b.keyId);if(h===A||b.uri.replace(/-/g,"").indexOf(h)!==-1){if(y=d[A],b.pssh)break;delete d[A],b.pssh=new Uint8Array(s),b.keyId=l,y=d[h]=y.then(()=>this.generateRequestWithPreferredKeySession(_,n,s,"encrypted-event-key-match")),y.catch(T=>this.handleError(T));break}}if(!y){if(c!==o){this.log(`Ignoring "${t.type}" event with ${c} init data for selected key-system ${o}`);return}y=d[h]=this.getKeySystemSelectionPromise([c]).then(({keySystem:x,mediaKeys:_})=>{var b;this.throwIfDestroyed();const A=new OA("ISO-23001-7",h,(b=OC(x))!=null?b:"");return A.pssh=new Uint8Array(s),A.keyId=l,this.attemptSetMediaKeys(x,_).then(()=>{this.throwIfDestroyed();const T=this.createMediaKeySessionContext({decryptdata:A,keySystem:x,mediaKeys:_});return this.generateRequestWithPreferredKeySession(T,n,s,"encrypted-event-no-match")})}),y.catch(x=>this.handleError(x))}})}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){const e=this.media;this.unregisterListeners(),this.onMediaDetached(),this._clear(e);const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(H.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(H.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(H.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(H.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(H.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(H.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,s=t[e];if(s)return s.licenseUrl;if(e===Ni.WIDEVINE&&n)return n}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(a,o,l)=>!!a&&l.indexOf(a)===o,s=t.map(a=>a.audioCodec).filter(n),r=t.map(a=>a.videoCodec).filter(n);return s.length+r.length===0&&r.push("avc1.42e01e"),new Promise((a,o)=>{const l=c=>{const h=c.shift();this.getMediaKeysPromise(h,s,r).then(d=>a({keySystem:h,mediaKeys:d})).catch(d=>{c.length?l(c):d instanceof Al?o(d):o(new Al({type:nn.KEY_SYSTEM_ERROR,details:Pe.KEY_SYSTEM_NO_ACCESS,error:d,fatal:!0},d.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let s=`Configured requestMediaKeySystemAccess is not a function ${n}`;return hH===null&&self.location.protocol==="http:"&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return n(e,t)}getMediaKeysPromise(e,t,n){const s=XX(e,t,n,this.config.drmSystemOptions),r=this.keySystemAccessPromises[e];let a=r==null?void 0:r.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${xs(s)}`),a=this.requestMediaKeySystemAccess(e,s);const o=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),a.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const c=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),o.mediaKeys=l.createMediaKeys().then(h=>(this.log(`Media-keys created for "${e}"`),c.then(d=>d?this.setMediaKeysServerCertificate(h,e,d):h))),o.mediaKeys.catch(h=>{this.error(`Failed to create media-keys for "${e}"}: ${h}`)}),o.mediaKeys})}return a.then(()=>r.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${Wu.hexDump(e.keyId||[])}`);const s=n.createSession(),r={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),s=this.getKeyIdString(t),r="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(n,r,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Wu.hexDump(e.keyId)}updateKeySession(e,t){var n;const s=e.mediaKeysSession;return this.log(`Updating key-session "${s.sessionId}" for keyID ${Wu.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),s.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{const s=F_(this.config),r=e.map(IC).filter(a=>!!a&&s.indexOf(a)!==-1);return this.getKeySystemSelectionPromise(r).then(({keySystem:a})=>{const o=OC(a);o?t(o):n(new Error(`Unable to find format for key-system "${a}"`))}).catch(n)})}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),s=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${s}`);let r=this.keyIdToKeySessionPromise[n];return r||(r=this.getKeySystemForKeyPromise(t).then(({keySystem:o,mediaKeys:l})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${s}`),this.attemptSetMediaKeys(o,l).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:o,mediaKeys:l,decryptdata:t}))))),(this.keyIdToKeySessionPromise[n]=r.then(o=>{const l="cenc",c=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(o,l,c,"playlist-key")})).catch(o=>this.handleError(o))),r}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Al?this.hls.trigger(H.ERROR,e.data):this.hls.trigger(H.ERROR,{type:nn.KEY_SYSTEM_ERROR,details:Pe.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const s=IC(e.keyFormat),r=s?[s]:F_(this.config);return this.attemptKeySystemAccess(r)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=F_(this.config)),e.length===0)throw new Al({type:nn.KEY_SYSTEM_ERROR,details:Pe.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${xs({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const s=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(r=>n.indexOf(r)===-1)})}generateRequestWithPreferredKeySession(e,t,n,s){var r,a;const o=(r=this.config.drmSystems)==null||(a=r[e.keySystem])==null?void 0:a.generateRequest;if(o)try{const x=o.call(this.hls,t,n,e);if(!x)throw new Error("Invalid response from configured generateRequest filter");t=x.initDataType,n=x.initData?x.initData:null,e.decryptdata.pssh=n?new Uint8Array(n):null}catch(x){var l;if(this.warn(x.message),(l=this.hls)!=null&&l.config.debug)throw x}if(n===null)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(e);const c=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${s}": ${c} (init data type: ${t} length: ${n?n.byteLength:null})`);const h=new qI,d=e._onmessage=x=>{const _=e.mediaKeysSession;if(!_){h.emit("error",new Error("invalid state"));return}const{messageType:b,message:A}=x;this.log(`"${b}" message event for session "${_.sessionId}" message size: ${A.byteLength}`),b==="license-request"||b==="license-renewal"?this.renewLicense(e,A).catch(T=>{h.eventNames().length?h.emit("error",T):this.handleError(T)}):b==="license-release"?e.keySystem===Ni.FAIRPLAY&&(this.updateKeySession(e,WD("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${b}"`)},m=e._onkeystatuseschange=x=>{if(!e.mediaKeysSession){h.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const b=e.keyStatus;h.emit("keyStatus",b),b==="expired"&&(this.warn(`${e.keySystem} expired for key ${c}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",d),e.mediaKeysSession.addEventListener("keystatuseschange",m);const y=new Promise((x,_)=>{h.on("error",_),h.on("keyStatus",b=>{b.startsWith("usable")?x():b==="output-restricted"?_(new Al({type:nn.KEY_SYSTEM_ERROR,details:Pe.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):b==="internal-error"?_(new Al({type:nn.KEY_SYSTEM_ERROR,details:Pe.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${b}"`)):b==="expired"?_(new Error("key expired while generating request")):this.warn(`unhandled key status change "${b}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var x;this.log(`Request generated for key-session "${(x=e.mediaKeysSession)==null?void 0:x.sessionId}" keyId: ${c}`)}).catch(x=>{throw new Al({type:nn.KEY_SYSTEM_ERROR,details:Pe.KEY_SYSTEM_NO_SESSION,error:x,fatal:!1},`Error generating key-session request: ${x}`)}).then(()=>y).catch(x=>{throw h.removeAllListeners(),this.removeSession(e),x}).then(()=>(h.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{if(typeof n=="string"&&typeof t=="object"){const s=n;n=t,t=s}this.log(`key status change "${t}" for keyStatuses keyId: ${Wu.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${Wu.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,s=new n(t),r=this.getServerCertificateUrl(e);return r?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,o)=>{const l={responseType:"arraybuffer",url:r},c=t.certLoadPolicy.default,h={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(m,y,x,_)=>{a(m.data)},onError:(m,y,x,_)=>{o(new Al({type:nn.KEY_SYSTEM_ERROR,details:Pe.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:x,response:Pi({url:l.url,data:void 0},m)},`"${e}" certificate request failed (${r}). Status: ${m.code} (${m.text})`))},onTimeout:(m,y,x)=>{o(new Al({type:nn.KEY_SYSTEM_ERROR,details:Pe.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:x,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${r})`))},onAbort:(m,y,x)=>{o(new Error("aborted"))}};s.load(l,h,d)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((s,r)=>{e.setServerCertificate(n).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${n==null?void 0:n.byteLength}) on "${t}"`),s(e)}).catch(a=>{r(new Al({type:nn.KEY_SYSTEM_ERROR,details:Pe.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(s=>{throw new Al({type:nn.KEY_SYSTEM_ERROR,details:Pe.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:s,fatal:!0},s.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const s=new DOMParser().parseFromString(n,"application/xml"),r=s.querySelectorAll("HttpHeader");if(r.length>0){let h;for(let d=0,m=r.length;d<m;d++){var a,o;h=r[d];const y=(a=h.querySelector("name"))==null?void 0:a.textContent,x=(o=h.querySelector("value"))==null?void 0:o.textContent;y&&x&&e.setRequestHeader(y,x)}}const l=s.querySelector("Challenge"),c=l==null?void 0:l.textContent;if(!c)throw new Error("Cannot find <Challenge> in key message");return WD(atob(c))}setupLicenseXHR(e,t,n,s){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,n,s)}).catch(a=>{if(!n.decryptdata)throw a;return e.open("POST",t,!0),r.call(this.hls,e,t,n,s)}).then(a=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:a||s})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:s}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((s,r)=>{const a=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${a}`);const o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(o.readyState===4)if(o.status===200){this._requestLicenseFailureCount=0;let l=o.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const c=this.config.licenseResponseCallback;if(c)try{l=c.call(this.hls,o,a,e)}catch(h){this.error(h)}s(l)}else{const l=n.errorRetry,c=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>c||o.status>=400&&o.status<500)r(new Al({type:nn.KEY_SYSTEM_ERROR,details:Pe.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:a,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${a}). Status: ${o.status} (${o.statusText})`));else{const h=c-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${h} attempts left`),this.requestLicense(e,t).then(s,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,a,e,t).then(({xhr:l,licenseChallenge:c})=>{e.keySystem==Ni.PLAYREADY&&(c=this.unpackPlayReadyKeyMessage(l,c)),l.send(c)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.removeEventListener("encrypted",this.onMediaEncrypted),n.removeEventListener("waitingforkey",this.onWaitingForKey),n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null)}_clear(e){var t;const n=this.mediaKeySessions;this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},OA.clearKeyUriToKeyIdMap();const s=n.length;vy.CDMCleanupPromise=Promise.all(n.map(r=>this.removeSession(r)).concat(e==null||(t=e.setMediaKeys(null))==null?void 0:t.catch(r=>{var a;this.log(`Could not clear media keys: ${r}`),(a=this.hls)==null||a.trigger(H.ERROR,{type:nn.OTHER_ERROR,details:Pe.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${r}`)})}))).then(()=>{s&&(this.log("finished closing key sessions and clearing media keys"),n.length=0)}).catch(r=>{var a;this.log(`Could not close sessions and clear media keys: ${r}`),(a=this.hls)==null||a.trigger(H.ERROR,{type:nn.OTHER_ERROR,details:Pe.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${r}`)})})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((s,r)=>(s.indexOf(r.keyFormat)===-1&&s.push(r.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const s=this.mediaKeySessions.indexOf(e);s>-1&&this.mediaKeySessions.splice(s,1);const{drmSystemOptions:r}=this.config;return(qX(r)?new Promise((o,l)=>{self.setTimeout(()=>l(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(o)}):Promise.resolve()).catch(o=>{var l;this.log(`Could not remove session: ${o}`),(l=this.hls)==null||l.trigger(H.ERROR,{type:nn.OTHER_ERROR,details:Pe.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${o}`)})}).then(()=>t.close()).catch(o=>{var l;this.log(`Could not close session: ${o}`),(l=this.hls)==null||l.trigger(H.ERROR,{type:nn.OTHER_ERROR,details:Pe.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${o}`)})})}}}vy.CDMCleanupPromise=void 0;class Al extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}class iQ{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(H.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(H.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(H.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(H.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const s=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=s,s&&typeof s.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,n){const s=performance.now();if(t){if(this.lastTime){const r=s-this.lastTime,a=n-this.lastDroppedFrames,o=t-this.lastDecodedFrames,l=1e3*a/r,c=this.hls;if(c.trigger(H.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:n}),l>0&&a>c.config.fpsDroppedMonitoringThreshold*o){let h=c.currentLevel;c.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h),h>0&&(c.autoLevelCapping===-1||c.autoLevelCapping>=h)&&(h=h-1,c.trigger(H.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:c.currentLevel}),c.autoLevelCapping=h,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function QH(i,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=i,e.dispatchEvent(t)}function $H(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues&&!i.cues.getCueById(e.id))try{if(i.addCue(e),!i.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){oi.debug(`[texttrack-utils]: ${n}`);try{const s=new self.TextTrackCue(e.startTime,e.endTime,e.text);s.id=e.id,i.addCue(s)}catch(s){oi.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${s}`)}}t==="disabled"&&(i.mode=t)}function ly(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues)for(let n=i.cues.length;n--;)e&&i.cues[n].removeEventListener("enter",e),i.removeCue(i.cues[n]);t==="disabled"&&(i.mode=t)}function eL(i,e,t,n){const s=i.mode;if(s==="disabled"&&(i.mode="hidden"),i.cues&&i.cues.length>0){const r=rQ(i.cues,e,t);for(let a=0;a<r.length;a++)(!n||n(r[a]))&&i.removeCue(r[a])}s==="disabled"&&(i.mode=s)}function sQ(i,e){if(e<=i[0].startTime)return 0;const t=i.length-1;if(e>i[t].endTime)return-1;let n=0,s=t,r;for(;n<=s;)if(r=Math.floor((s+n)/2),e<i[r].startTime)s=r-1;else if(e>i[r].startTime&&n<t)n=r+1;else return r;return i[n].startTime-e<e-i[s].startTime?n:s}function rQ(i,e,t){const n=[],s=sQ(i,e);if(s>-1)for(let r=s,a=i.length;r<a;r++){const o=i[r];if(o.startTime>=e&&o.endTime<=t)n.push(o);else if(o.startTime>t)return n}return n}function CT(i){const e=[];for(let t=0;t<i.length;t++){const n=i[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(i[t])}return e}class aQ extends nB{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=CT(this.media.textTracks);for(let r=0;r<n.length;r++)if(n[r].mode==="hidden")t=n[r];else if(n[r].mode==="showing"){t=n[r];break}const s=this.findTrackForTextTrack(t);this.subtitleTrack!==s&&this.setSubtitleTrack(s)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.MANIFEST_PARSED,this.onManifestParsed,this),e.on(H.LEVEL_LOADING,this.onLevelLoading,this),e.on(H.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(H.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(H.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.MANIFEST_PARSED,this.onManifestParsed,this),e.off(H.LEVEL_LOADING,this.onLevelLoading,this),e.off(H.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(H.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(H.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const n=this.media;if(!n)return;const s=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||n.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,s)return;CT(n.textTracks).forEach(a=>{ly(a)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:s,details:r}=t,a=this.tracksInGroup[n];if(!a||a.groupId!==s){this.warn(`Subtitle track with id:${n} and group:${s} not found in active group ${a==null?void 0:a.groupId}`);return}const o=a.details;a.details=t.details,this.log(`Subtitle track ${n} "${a.name}" lang:${a.lang} group:${s} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,s=this.groupIds;let r=this.currentTrack;if(!n||(s==null?void 0:s.length)!==(n==null?void 0:n.length)||n!=null&&n.some(a=>(s==null?void 0:s.indexOf(a))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(h=>!n||n.indexOf(h.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(h=>h.default)&&(this.selectDefaultTrack=!1),a.forEach((h,d)=>{h.id=d});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const o=this.hls.config.subtitlePreference;if(!r&&o){this.selectDefaultTrack=!1;const h=lh(o,a);if(h>-1)r=a[h];else{const d=lh(o,this.tracks);r=this.tracks[d]}}let l=this.findTrackId(r);l===-1&&r&&(l=this.findTrackId(null));const c={subtitleTracks:a};this.log(`Updating subtitle tracks, ${a.length} track(s) found in "${n==null?void 0:n.join(",")}" group-id`),this.hls.trigger(H.SUBTITLE_TRACKS_UPDATED,c),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let s=0;s<t.length;s++){const r=t[s];if(!(n&&!r.default||!n&&!e)&&(!e||qm(r,e)))return s}if(e){for(let s=0;s<t.length;s++){const r=t[s];if(kA(e.attrs,r.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return s}for(let s=0;s<t.length;s++){const r=t[s];if(kA(e.attrs,r.attrs,["LANGUAGE"]))return s}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const s=t[n];if($D(s,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===$n.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&qm(e,n))return n;const s=lh(e,this.tracksInGroup);if(s>-1){const r=this.tracksInGroup[s];return this.setSubtitleTrack(s),r}else{if(n)return null;{const r=lh(e,t);if(r>-1)return t[r]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,s=e.groupId,r=this.getUrlWithDirectives(e.url,t),a=e.details,o=a==null?void 0:a.age;this.log(`Loading subtitle ${n} "${e.name}" lang:${e.lang} group:${s}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${r}`),this.hls.trigger(H.SUBTITLE_TRACK_LOADING,{url:r,id:n,groupId:s,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=CT(e.textTracks),n=this.currentTrack;let s;if(n&&(s=t.filter(r=>$D(n,r))[0],s||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(r=>{r.mode!=="disabled"&&r!==s&&(r.mode="disabled")}),s){const r=this.subtitleDisplay?"showing":"hidden";s.mode!==r&&(s.mode=r)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!Vt(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,s=t[e]||null;if(this.trackId=e,this.currentTrack=s,this.toggleTrackModes(),!s){this.hls.trigger(H.SUBTITLE_TRACK_SWITCH,{id:e});return}const r=!!s.details&&!s.details.live;if(e===this.trackId&&s===n&&r)return;this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:""));const{id:a,groupId:o="",name:l,type:c,url:h}=s;this.hls.trigger(H.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:l,type:c,url:h});const d=this.switchParams(s.url,n==null?void 0:n.details,s.details);this.loadPlaylist(d)}}function lA(i){let e=5381,t=i.length;for(;t;)e=e*33^i.charCodeAt(--t);return(e>>>0).toString()}const xy=.025;let o3=function(i){return i[i.Point=0]="Point",i[i.Range=1]="Range",i}({});function oQ(i,e,t){return`${i.identifier}-${t+1}-${lA(e)}`}class lQ{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){if(e>=this.assetList.length)return!0;const t=this.playoutLimit;return e<=0||isNaN(t)?!1:this.assetList[e].startOffset>t}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return VC(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,n=VC(t,e);return t-n<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=Vt(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return VC(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<xy))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?o3.Range:o3.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return cQ(this)}}function VC(i,e){return i-e.start<e.duration/2&&!(Math.abs(i-(e.start+e.duration))<xy)?e.start:e.start+e.duration}function JH(i,e,t){const n=new self.URL(i,t);return n.protocol!=="data:"&&n.searchParams.set("_HLS_primary_id",e),n}function cQ(i){return`["${i.identifier}" ${i.cue.pre?"<pre>":i.cue.post?"<post>":""}${i.timelineStart.toFixed(2)}-${i.resumeTime.toFixed(2)}]`}function tL(i){const e=i.timelineStart,t=i.duration||0;return`["${i.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class uQ{constructor(e,t,n,s){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{const c=this.interstitial.playoutLimit,h=this.currentTime;this.startOffset+h>=c&&this.hls.trigger(H.PLAYOUT_LIMIT_REACHED,{})};const r=this.hls=new e(t);this.interstitial=n,this.assetItem=s;let a=s.uri;try{a=JH(a,r.sessionId).href}catch{}r.loadSource(a);const o=()=>{this.hasDetails=!0};r.once(H.LEVEL_LOADED,o),r.once(H.AUDIO_TRACK_LOADED,o),r.once(H.SUBTITLE_TRACK_LOADED,o),r.on(H.MEDIA_ATTACHING,(l,{media:c})=>{this.removeMediaListeners(),this.mediaAttached=c,this.interstitial.playoutLimit&&c.addEventListener("timeupdate",this.checkPlayout)})}bufferedInPlaceToEnd(e){var t;if(!this.interstitial.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e||!this._bufferedEosTime)return!1;const n=this.timelineOffset,s=Hn.bufferInfo(e,n,0);return this.getAssetTime(s.end)>=this._bufferedEosTime-.02}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Hn.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;return e||0}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const n=e-t;if(Math.abs(n)>1/9e4){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,n=this.duration;return Math.min(Math.max(0,e-t),n)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){this.hls.attachMedia(e)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}on(e,t,n){this.hls.on(e,t)}once(e,t,n){this.hls.once(e,t)}off(e,t,n){this.hls.off(e,t)}toString(){var e,t;return`HlsAssetPlayer: ${tL(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${(t=this.interstitial)!=null&&t.appendInPlace?"append-in-place":""}`}}const nU=.033;class hQ extends jf{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((n,s)=>e<=s.startOffset&&t>s.startOffset?(delete s.error,n+1):n,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let n=-1;e.nextEvent?n=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(n=this.findEventIndex(e.previousEvent.identifier)+1);const s=this.items;if(s)for(s[n]||(t===void 0&&(t=e.start),n=this.findItemIndexAtTime(t));n>=0&&(r=s[n])!=null&&r.event;){var r;n--}return n}findItemIndexAtTime(e,t){const n=this.items;if(n)for(let s=0;s<n.length;s++){let r=n[s];if(t&&t!=="primary"&&(r=r[t]),e===r.start||e>r.start&&e<r.end)return s}return-1}findJumpRestrictedIndex(e,t){const n=this.items;if(n)for(let s=e;s<=t&&n[s];s++){const r=n[s].event;if(r!=null&&r.restrictions.jump&&!r.appendInPlace)return s}return-1}findEventIndex(e){const t=this.items;if(t)for(let s=t.length;s--;){var n;if(((n=t[s].event)==null?void 0:n.identifier)===e)return s}return-1}findAssetIndex(e,t){const n=e.assetList,s=n.length;if(s>1)for(let r=0;r<s;r++){const a=n[r];if(!a.error){const o=a.timelineStart;if(t===o||t>o&&t<o+(a.duration||0))return r}}return 0}get assetIdAtEnd(){var e,t;const n=(e=this.items)==null||(t=e[this.length-1])==null?void 0:t.event;if(n){const s=n.assetList,r=s[s.length-1];if(r)return r.identifier}return null}parseInterstitialDateRanges(e,t){const n=e.main.details,{dateRanges:s}=n,r=this.events,a=this.parseDateRanges(s,{url:n.url},t),o=Object.keys(s),l=r?r.filter(c=>!o.includes(c.identifier)):[];a.length&&a.sort((c,h)=>{const d=c.cue.pre,m=c.cue.post,y=h.cue.pre,x=h.cue.post;if(d&&!y)return-1;if(y&&!d||m&&!x)return 1;if(x&&!m)return-1;if(!d&&!y&&!m&&!x){const _=c.startTime,b=h.startTime;if(_!==b)return _-b}return c.dateRange.tagOrder-h.dateRange.tagOrder}),this.events=a,l.forEach(c=>{this.removeEvent(c)}),this.updateSchedule(e,l)}updateSchedule(e,t=[]){const n=this.events||[];if(n.length||t.length||this.length<2){const s=this.items,r=this.parseSchedule(n,e);(t.length||(s==null?void 0:s.length)!==r.length||r.some((o,l)=>Math.abs(o.playout.start-s[l].playout.start)>.005||Math.abs(o.playout.end-s[l].playout.end)>.005))&&(this.items=r,this.onScheduleUpdate(t,s))}}parseDateRanges(e,t,n){const s=[],r=Object.keys(e);for(let a=0;a<r.length;a++){const o=r[a],l=e[o];if(l.isInterstitial){let c=this.eventMap[o];c?c.setDateRange(l):(c=new lQ(l,t),this.eventMap[o]=c,n===!1&&(c.appendInPlace=n)),s.push(c)}}return s}parseSchedule(e,t){const n=[],s=t.main.details,r=s.live?1/0:s.edge;let a=0;if(e=e.filter(l=>!l.error&&!(l.cue.once&&l.hasPlayed)),e.length){this.resolveOffsets(e,t);let l=0,c=0;if(e.forEach((h,d)=>{const m=h.cue.pre,y=h.cue.post,x=e[d-1]||null,_=h.appendInPlace,b=y?r:h.startOffset,A=h.duration,T=h.timelineOccupancy===o3.Range?A:0,w=h.resumptionOffset,R=(x==null?void 0:x.startTime)===b,O=b+h.cumulativeDuration;let N=_?O+A:b+w;if(m||!y&&b<=0){const P=c;c+=T,h.timelineStart=O;const B=a;a+=A,n.push({event:h,start:O,end:N,playout:{start:B,end:a},integrated:{start:P,end:c}})}else if(b<=r){if(!R){const L=b-l;if(L>nU){const F=l,j=c;c+=L;const J=a;a+=L;const re={previousEvent:e[d-1]||null,nextEvent:h,start:F,end:F+L,playout:{start:J,end:a},integrated:{start:j,end:c}};n.push(re)}else L>0&&x&&(x.cumulativeDuration+=L,n[n.length-1].end=b)}y&&(N=O),h.timelineStart=O;const P=c;c+=T;const B=a;a+=A,n.push({event:h,start:O,end:N,playout:{start:B,end:a},integrated:{start:P,end:c}})}else return;const U=h.resumeTime;y||U>r?l=r:l=U}),l<r){var o;const h=l,d=c,m=r-l;c+=m;const y=a;a+=m,n.push({previousEvent:((o=n[n.length-1])==null?void 0:o.event)||null,nextEvent:null,start:l,end:h+m,playout:{start:y,end:a},integrated:{start:d,end:c}})}this.setDurations(r,a,c)}else n.push({previousEvent:null,nextEvent:null,start:0,end:r,playout:{start:0,end:r},integrated:{start:0,end:r}}),this.setDurations(r,r,r);return n}setDurations(e,t,n){this.durations={primary:e,playout:t,integrated:n}}resolveOffsets(e,t){const n=t.main.details,s=n.live?1/0:n.edge;let r=0,a=-1;e.forEach((o,l)=>{const c=o.cue.pre,h=o.cue.post,d=c?0:h?s:o.startTime;this.updateAssetDurations(o),a===d?o.cumulativeDuration=r:(r=0,a=d),!h&&o.snapOptions.in&&(o.resumeAnchor=ig(null,n.fragments,o.startOffset+o.resumptionOffset,0,0)||void 0),o.appendInPlace&&!o.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(o,t)||(o.appendInPlace=!1)),!o.appendInPlace&&l+1<e.length&&e[l+1].startTime-e[l].resumeTime<nU&&(e[l+1].appendInPlace=!1,e[l+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${o}`));const y=Vt(o.resumeOffset)?o.resumeOffset:o.duration;r+=y})}primaryCanResumeInPlaceAt(e,t){const n=e.resumeTime,s=e.startTime+e.resumptionOffset;return Math.abs(n-s)>xy?(this.log(`"${e.identifier}" resumption ${n} not aligned with estimated timeline end ${s}`),!1):t?!Object.keys(t).some(a=>{const o=t[a].details,l=o.edge;if(n>=l)return this.log(`"${e.identifier}" resumption ${n} past ${a} playlist end ${l}`),!1;const c=ig(null,o.fragments,n);if(!c)return this.log(`"${e.identifier}" resumption ${n} does not align with any fragments in ${a} playlist (${o.fragStart}-${o.fragmentEnd})`),!0;const h=a==="audio"?.175:0;return Math.abs(c.start-n)<xy+h||Math.abs(c.end-n)<xy+h?!1:(this.log(`"${e.identifier}" resumption ${n} not aligned with ${a} fragment bounds (${c.start}-${c.end} sn: ${c.sn} cc: ${c.cc})`),!0)}):(this.log(`"${e.identifier}" resumption ${n} can not be aligned with media (none selected)`),!1)}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let n=0,s=!1,r=!1;e.assetList.forEach((a,o)=>{const l=t+n;a.startOffset=n,a.timelineStart=l,s||(s=a.duration===null),r||(r=!!a.error);const c=a.error?0:a.duration||0;n+=c}),s&&!r?e.duration=Math.max(n,e.duration):e.duration=n}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function Ud(i){return`[${i.event?'"'+i.event.identifier+'"':"primary"}: ${i.start.toFixed(2)}-${i.end.toFixed(2)}]`}class fQ{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const n=e.assetListUrl;let s;try{s=JH(n,this.hls.sessionId,e.baseUrl)}catch(m){const y=this.assignAssetListError(e,Pe.ASSET_LIST_LOAD_ERROR,m,n);this.hls.trigger(H.ERROR,y);return}t&&s.protocol!=="data:"&&s.searchParams.set("_HLS_start_offset",""+t);const r=this.hls.config,a=r.loader,o=new a(r),l={responseType:"json",url:s.href},c=r.interstitialAssetListLoadPolicy.default,h={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(m,y,x,_)=>{const b=m.data,A=b==null?void 0:b.ASSETS;if(!Array.isArray(A)){const T=this.assignAssetListError(e,Pe.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),x.url,y,_);this.hls.trigger(H.ERROR,T);return}e.assetListResponse=b,this.hls.trigger(H.ASSET_LIST_LOADED,{event:e,assetListResponse:b,networkDetails:_})},onError:(m,y,x,_)=>{const b=this.assignAssetListError(e,Pe.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${m.code} ${m.text} (${y.url})`),y.url,_,x);this.hls.trigger(H.ERROR,b)},onTimeout:(m,y,x)=>{const _=this.assignAssetListError(e,Pe.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${y.url})`),y.url,m,x);this.hls.trigger(H.ERROR,_)}};return o.load(l,h,d),this.hls.trigger(H.ASSET_LIST_LOADING,{event:e}),o}assignAssetListError(e,t,n,s,r,a){return e.error=n,{type:nn.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:s,error:n,networkDetails:a,stats:r}}}function If(i,e,t){uh(i,e,t),i.addEventListener(e,t)}function uh(i,e,t){i.removeEventListener(e,t)}function iU(i){i==null||i.play().catch(()=>{})}class dQ extends jf{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled)return;const s=n-this.timelinePos;if(Math.abs(s)<1/7056e5)return;const a=s<=-.01;this.timelinePos=n,this.bufferedPos=n;const o=this.playingItem;if(!o){this.checkBuffer();return}if(a&&this.schedule.resetErrorsInRange(n,n-s)&&this.updateSchedule(),this.checkBuffer(),a&&n<o.start||n>=o.end){var l;const m=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(o)&&(l=this.media)!=null&&l.paused&&(this.shouldPlay=!1),!a){const y=this.findItemIndex(o);if(m>y){const x=this.schedule.findJumpRestrictedIndex(y+1,m);if(x>y){this.setSchedulePosition(x);return}}}this.setSchedulePosition(m);return}const c=this.playingAsset;if(!c){if(this.playingLastItem&&this.isInterstitial(o)){const m=o.event.assetList[0];m&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(n,m))}return}const h=c.timelineStart,d=c.duration||0;(a&&n<h||n>=h+d)&&this.setScheduleToAssetAtTime(n,c)},this.onTimeupdate=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled)return;if(n>this.timelinePos)this.timelinePos=n,n>this.bufferedPos&&this.checkBuffer();else return;const s=this.playingItem;if(!s||this.playingLastItem)return;if(n>=s.end){this.timelinePos=s.end;const o=this.findItemIndex(s);this.setSchedulePosition(o+1)}const r=this.playingAsset;if(!r)return;const a=r.timelineStart+(r.duration||0);n>=a&&this.setScheduleToAssetAtTime(n,r)},this.onScheduleUpdate=(n,s)=>{const r=this.schedule,a=this.playingItem,o=r.events||[],l=r.items||[],c=r.durations,h=n.map(y=>y.identifier),d=!!(o.length||h.length);if(d&&this.log(`INTERSTITIALS_UPDATED (${o.length}): ${o}
Schedule: ${l.map(y=>Ud(y))}`),h.length&&this.log(`Removed events ${h}`),this.playerQueue.forEach(y=>{if(y.interstitial.appendInPlace){const x=y.assetItem.timelineStart,_=y.timelineOffset-x;if(_)try{y.timelineOffset=x}catch(b){Math.abs(_)>xy&&this.warn(`${b} ("${y.assetId}" ${y.timelineOffset}->${x})`)}}}),a){const y=this.updateItem(a,this.timelinePos);this.itemsMatch(a,y)&&(this.playingItem=y,this.waitingItem=this.endedItem=null)}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const m=this.bufferingItem;if(m){const y=this.updateItem(m,this.bufferedPos);this.itemsMatch(m,y)?this.bufferingItem=y:m.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(m.event,null))}if(n.forEach(y=>{y.assetList.forEach(x=>{this.clearAssetPlayer(x.identifier,null)})}),d||s){if(this.hls.trigger(H.INTERSTITIALS_UPDATED,{events:o.slice(0),schedule:l.slice(0),durations:c,removedIds:h}),this.isInterstitial(a)&&h.includes(a.event.identifier)){this.warn(`Interstitial "${a.event.identifier}" removed while playing`),this.primaryFallback(a.event);return}this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new fQ(e),this.schedule=new hQ(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e.on(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(H.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(H.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(H.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(H.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(H.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(H.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(H.BUFFER_APPENDED,this.onBufferAppended,this),e.on(H.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(H.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(H.MEDIA_ENDED,this.onMediaEnded,this),e.on(H.ERROR,this.onError,this),e.on(H.DESTROYING,this.onDestroying,this)}unregisterListeners(){const e=this.hls;e&&(e.off(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(H.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(H.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(H.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(H.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(H.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(H.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(H.BUFFER_CODECS,this.onBufferCodecs,this),e.off(H.BUFFER_APPENDED,this.onBufferAppended,this),e.off(H.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(H.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(H.MEDIA_ENDED,this.onMediaEnded,this),e.off(H.ERROR,this.onError,this),e.off(H.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){uh(e,"play",this.onPlay),uh(e,"pause",this.onPause),uh(e,"seeking",this.onSeeking),uh(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const n=this.media=t.media;If(n,"seeking",this.onSeeking),If(n,"timeupdate",this.onTimeupdate),If(n,"play",this.onPlay),If(n,"pause",this.onPause)}onMediaAttached(e,t){const n=this.effectivePlayingItem,s=this.detachedData;if(this.detachedData=null,n===null)this.checkStart();else if(!s){this.clearScheduleState();const r=this.findItemIndex(n);this.setSchedulePosition(r)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const n=!!t.transferMedia,s=this.media;if(this.media=null,!n&&(s&&this.removeMediaListeners(s),this.detachedData)){const r=this.getBufferingPlayer();r&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,r.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const e=this,t=()=>e.bufferingItem||e.waitingItem,n=d=>d&&e.getAssetPlayer(d.identifier),s=(d,m,y,x,_)=>{if(d){let b=d[m].start;const A=d.event;if(A){if(m==="playout"||A.timelineOccupancy!==o3.Point){const T=n(y);(T==null?void 0:T.interstitial)===A&&(b+=T.assetItem.startOffset+T[_])}}else{const T=x==="bufferedPos"?a():e[x];b+=T-d.start}return b}return 0},r=(d,m)=>{if(d!==0&&m!=="primary"&&e.schedule.length){var y;const x=e.schedule.findItemIndexAtTime(d),_=(y=e.schedule.items)==null?void 0:y[x];if(_){const b=_[m].start-_.start;return d+b}}return d},a=()=>{const d=e.bufferedPos;return d===Number.MAX_VALUE?o("primary"):Math.max(d,0)},o=d=>{var m;return(m=e.primaryDetails)!=null&&m.live?e.primaryDetails.edge:e.schedule.durations[d]},l=(d,m)=>{var y,x;const _=e.effectivePlayingItem;if(_!=null&&(y=_.event)!=null&&y.restrictions.skip)return;e.log(`seek to ${d} "${m}"`);const b=e.effectivePlayingItem,A=e.schedule.findItemIndexAtTime(d,m),T=(x=e.schedule.items)==null?void 0:x[A],w=e.getBufferingPlayer(),R=w==null?void 0:w.interstitial,O=R==null?void 0:R.appendInPlace,N=b&&e.itemsMatch(b,T);if(b&&(O||N)){const P=n(e.playingAsset),B=(P==null?void 0:P.media)||e.primaryMedia;if(B){const L=m==="primary"?B.currentTime:s(b,m,e.playingAsset,"timelinePos","currentTime"),F=d-L,j=(O?L:B.currentTime)+F;if(j>=0&&(!P||O||j<=P.duration)){B.currentTime=j;return}}}if(T){let P=d;if(m!=="primary"){const L=T[m].start,F=d-L;P=T.start+F}const B=!e.isInterstitial(T);if((!e.isInterstitial(b)||b.event.appendInPlace)&&(B||T.event.appendInPlace)){const L=e.media||(O?w==null?void 0:w.media:null);L&&(L.currentTime=P)}else if(b){const L=e.findItemIndex(b);if(A>L){const j=e.schedule.findJumpRestrictedIndex(L+1,A);if(j>L){e.setSchedulePosition(j);return}}let F=0;if(B)e.timelinePos=P,e.checkBuffer();else{var U;const j=T==null||(U=T.event)==null?void 0:U.assetList;if(j){const J=d-(T[m]||T).start;for(let re=j.length;re--;){const q=j[re];if(q.duration&&J>=q.startOffset&&J<q.startOffset+q.duration){F=re;break}}}}e.setSchedulePosition(A,F)}}},c=()=>{const d=e.effectivePlayingItem;if(e.isInterstitial(d))return d;const m=t();return e.isInterstitial(m)?m:null},h={get currentTime(){const d=c(),m=e.effectivePlayingItem;return m&&m===d?s(m,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-m.playout.start:0},set currentTime(d){const m=c(),y=e.effectivePlayingItem;y&&y===m&&l(d+y.playout.start,"playout")},get duration(){const d=c();return d?d.playout.end-d.playout.start:0},get assetPlayers(){var d;const m=(d=c())==null?void 0:d.event.assetList;return m?m.map(y=>e.getAssetPlayer(y.identifier)):[]},get playingIndex(){var d;const m=(d=c())==null?void 0:d.event;return m&&e.effectivePlayingAsset?m.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return c()}};this.manager={get events(){var d,m;return((d=e.schedule)==null||(m=d.events)==null?void 0:m.slice(0))||[]},get schedule(){var d,m;return((d=e.schedule)==null||(m=d.items)==null?void 0:m.slice(0))||[]},get interstitialPlayer(){return c()?h:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const d=t();return e.findItemIndex(d)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const d=e.effectivePlayingItem;return e.findItemIndex(d)},primary:{get bufferedEnd(){return a()},get currentTime(){const d=e.timelinePos;return d>0?d:0},set currentTime(d){l(d,"primary")},get duration(){return o("primary")},get seekableStart(){var d;return((d=e.primaryDetails)==null?void 0:d.fragmentStart)||0}},integrated:{get bufferedEnd(){return s(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return s(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(d){l(d,"integrated")},get duration(){return o("integrated")},get seekableStart(){var d;return r(((d=e.primaryDetails)==null?void 0:d.fragmentStart)||0,"integrated")}},skip:()=>{const d=e.effectivePlayingItem,m=d==null?void 0:d.event;if(m&&!m.restrictions.skip){const y=e.findItemIndex(d);if(m.appendInPlace){const x=d.playout.start+d.event.duration;l(x+.001,"playout")}else e.advanceAfterAssetEnded(m,y,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,n=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!n?!1:this.findItemIndex(t)===n.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t,n;if(this.mediaSelection===null)return;const s=this.waitingItem||this.playingItem;if(this.isInterstitial(s)&&!s.event.appendInPlace)return;let r=this.media;!r&&(e=this.bufferingItem)!=null&&(t=e.event)!=null&&t.appendInPlace&&(r=this.primaryMedia);const a=(n=r)==null?void 0:n.currentTime;if(!(a===void 0||!Vt(a)))return a}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const n=this.getAssetPlayer(e);n&&this.transferMediaFromPlayer(n,t)}transferMediaFromPlayer(e,t){const n=e.interstitial.appendInPlace,s=e.media;if(n&&s===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&s){this.detachedData={media:s};return}const r=e.transferMedia();this.log(`transfer MediaSource from ${e} ${xs(r)}`),this.detachedData=r}else t&&s&&(this.shouldPlay||(this.shouldPlay=!s.paused))}transferMediaTo(e,t){var n,s;if(e.media===t)return;let r=null;const a=this.hls,o=e!==a,l=o&&e.interstitial.appendInPlace,c=(n=this.detachedData)==null?void 0:n.mediaSource;let h;if(a.media)l&&(r=a.transferMedia(),this.detachedData=r),h="Primary";else if(c){const y=this.getBufferingPlayer();y?(r=y.transferMedia(),h=`${y}`):h="detached MediaSource"}else h="detached media";if(!r){if(c)r=this.detachedData,this.log(`using detachedData: MediaSource ${xs(r)}`);else if(!this.detachedData||a.media===t){const y=this.playerQueue;y.length>1&&y.forEach(x=>{if(o&&x.interstitial.appendInPlace!==l){const _=x.interstitial;this.clearInterstitial(x.interstitial,null),_.appendInPlace=!1,_.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${_}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const d=r&&"mediaSource"in r&&((s=r.mediaSource)==null?void 0:s.readyState)!=="closed",m=d&&r?r:t;if(this.log(`${d?"transfering MediaSource":"attaching media"} to ${o?e:"Primary"} from ${h}`),m===r){const y=o&&e.assetId===this.schedule.assetIdAtEnd;m.overrides={duration:this.schedule.duration,endOfStream:!o||y,cueRemoval:!o}}e.attachMedia(m)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const n=this.timelinePos,s=this.effectivePlayingItem;if(n===-1){const r=this.hls.startPosition;if(this.timelinePos=r,t.length&&t[0].cue.pre){const a=e.findEventIndex(t[0].identifier);this.setSchedulePosition(a)}else if(r>=0||!this.primaryLive){const a=this.timelinePos=r>0?r:0,o=e.findItemIndexAtTime(a);this.setSchedulePosition(o)}}else if(s&&!this.playingItem){const r=e.findItemIndex(s);this.setSchedulePosition(r)}}advanceAfterAssetEnded(e,t,n){const s=n+1;if(!e.isAssetPastPlayoutLimit(s)&&!e.assetList[s].error)this.setSchedulePosition(t,s);else{const r=this.schedule.items;if(r){const a=t+1,o=r.length;if(a>=o){this.setSchedulePosition(-1);return}const l=e.resumeTime;this.timelinePos<l&&(this.timelinePos=l,this.checkBuffer()),this.setSchedulePosition(a)}}}setScheduleToAssetAtTime(e,t){const n=this.schedule,s=t.parentIdentifier,r=n.getEvent(s);if(r){const a=n.findEventIndex(s),o=n.findAssetIndex(r,e);this.setSchedulePosition(a,o)}}setSchedulePosition(e,t){const n=this.schedule.items;if(!n||this.playbackDisabled)return;this.log(`setSchedulePosition ${e}, ${t}`);const s=e>=0?n[e]:null,r=this.playingItem,a=this.playingLastItem;if(this.isInterstitial(r)){var o;const c=r.event,h=this.playingAsset,d=h==null?void 0:h.identifier,m=d?this.getAssetPlayer(d):null;if(m&&d&&(!this.eventItemsMatch(r,s)||t!==void 0&&d!==((o=c.assetList)==null?void 0:o[t].identifier))){var l;const y=c.findAssetIndex(h);this.log(`INTERSTITIAL_ASSET_ENDED ${y+1}/${c.assetList.length} ${tL(h)}`),this.endedAsset=h,this.playingAsset=null,this.hls.trigger(H.INTERSTITIAL_ASSET_ENDED,{asset:h,assetListIndex:y,event:c,schedule:n.slice(0),scheduleIndex:e,player:m}),this.retreiveMediaSource(d,s),m.media&&!((l=this.detachedData)!=null&&l.mediaSource)&&m.detachMedia()}if(!this.eventItemsMatch(r,s)&&(this.endedItem=r,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${c} ${Ud(r)}`),c.hasPlayed=!0,this.hls.trigger(H.INTERSTITIAL_ENDED,{event:c,schedule:n.slice(0),scheduleIndex:e}),c.cue.once)){this.updateSchedule();const y=this.schedule.items;if(s&&y){const x=this.schedule.findItemIndex(s);this.advanceSchedule(x,y,t,r,a)}return}}this.advanceSchedule(e,n,t,r,a)}advanceSchedule(e,t,n,s,r){const a=e>=0?t[e]:null,o=this.primaryMedia,l=this.playerQueue;if(l.length&&l.forEach(c=>{const h=c.interstitial,d=this.schedule.findEventIndex(h.identifier);(d<e||d>e+1)&&this.clearInterstitial(h,a)}),this.isInterstitial(a)){this.timelinePos=Math.min(Math.max(this.timelinePos,a.start),a.end);const c=a.event;n===void 0&&(n=this.schedule.findAssetIndex(c,this.timelinePos));const h=this.waitingItem;this.assetsBuffered(a,o)||this.setBufferingItem(a);let d=this.preloadAssets(c,n);if(this.eventItemsMatch(a,h||s)||(this.waitingItem=a,this.log(`INTERSTITIAL_STARTED ${Ud(a)} ${c.appendInPlace?"append in place":""}`),this.hls.trigger(H.INTERSTITIAL_STARTED,{event:c,schedule:t.slice(0),scheduleIndex:e})),!c.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${c}`);return}if(c.assetListLoader&&(c.assetListLoader.destroy(),c.assetListLoader=void 0),!o){this.log(`Waiting for attachMedia to start Interstitial ${c}`);return}this.waitingItem=this.endedItem=null,this.playingItem=a;const m=c.assetList[n];if(!m){const y=t[e+1],x=this.media;y&&x&&!this.isInterstitial(y)&&x.currentTime<y.start&&(x.currentTime=this.timelinePos=y.start),this.advanceAfterAssetEnded(c,e,n||0);return}if(d||(d=this.getAssetPlayer(m.identifier)),d===null||d.destroyed){const y=c.assetList.length;this.warn(`asset ${n+1}/${y} player destroyed ${c}`),d=this.createAssetPlayer(c,m,n)}if(!this.eventItemsMatch(a,this.bufferingItem)&&c.appendInPlace&&this.isAssetBuffered(m))return;this.startAssetPlayer(d,n,t,e,o),this.shouldPlay&&iU(d.media)}else a!==null?(this.resumePrimary(a,e,s),this.shouldPlay&&iU(this.hls.media)):r&&this.isInterstitial(s)&&(this.endedItem=null,this.playingItem=s,s.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e,t;return(e=this.mediaSelection)==null||(t=e.main)==null?void 0:t.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,n){var s;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${Ud(e)}`),!((s=this.detachedData)!=null&&s.mediaSource)){let a=this.timelinePos;(a<e.start||a>=e.end)&&(a=this.getPrimaryResumption(e,t),this.timelinePos=a),this.attachPrimary(a,e)}if(!n)return;const r=this.schedule.items;r&&(this.log(`resumed ${Ud(e)}`),this.hls.trigger(H.INTERSTITIALS_PRIMARY_RESUMED,{schedule:r.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const n=e.start;if(this.primaryLive){const s=this.primaryDetails;if(t===0)return this.hls.startPosition;if(s&&(n<s.fragmentStart||n>s.edge))return this.hls.liveSyncPosition||-1}return n}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Hn.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,n){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const s=this.primaryMedia;if(!s)return;const r=this.hls;r.media?this.checkBuffer():(this.transferMediaTo(r,s),n&&this.startLoadingPrimaryAt(e,n)),n||(this.timelinePos=e,this.startLoadingPrimaryAt(e,n))}startLoadingPrimaryAt(e,t){var n;const s=this.hls;!s.loadingEnabled||!s.media||Math.abs((((n=s.mainForwardBufferInfo)==null?void 0:n.start)||s.media.currentTime)-e)>.5?s.startLoad(e,t):s.bufferingEnabled||s.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(H.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(H.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1)return;const n=this.hls.levels[t.level],s=Pi(Pi({},this.mediaSelection||this.altSelection),{},{main:n});this.mediaSelection=s,this.schedule.parseInterstitialDateRanges(s,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const n=this.hls.audioTracks[t.id],s=this.mediaSelection;if(!s){this.altSelection=Pi(Pi({},this.altSelection),{},{audio:n});return}const r=Pi(Pi({},s),{},{audio:n});this.mediaSelection=r}onSubtitleTrackUpdated(e,t){const n=this.hls.subtitleTracks[t.id],s=this.mediaSelection;if(!s){this.altSelection=Pi(Pi({},this.altSelection),{},{subtitles:n});return}const r=Pi(Pi({},s),{},{subtitles:n});this.mediaSelection=r}onAudioTrackSwitching(e,t){const n=mN(t);this.playerQueue.forEach(s=>s.hls.setAudioOption(t)||s.hls.setAudioOption(n))}onSubtitleTrackSwitch(e,t){const n=mN(t);this.playerQueue.forEach(s=>s.hls.setSubtitleOption(t)||t.id!==-1&&s.hls.setSubtitleOption(n))}onBufferCodecs(e,t){const n=t.tracks;n&&(this.requiredTracks=n)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const n=this.playingItem;if(n&&!this.itemsMatch(n,this.bufferingItem)&&!this.isInterstitial(n)){const s=this.timelinePos;this.bufferedPos=s,this.checkBuffer()}}onBufferedToEnd(e){const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let s=0;s<t.length;s++){const r=t[s];if(r.cue.post){var n;const a=this.schedule.findEventIndex(r.identifier),o=(n=this.schedule.items)==null?void 0:n[a];this.isInterstitial(o)&&this.eventItemsMatch(o,this.bufferingItem)&&this.bufferedToItem(o,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const n=this.findItemIndex(t);this.setSchedulePosition(n+1)}else this.shouldPlay=!1}updateItem(e,t){const n=this.schedule.items;if(e&&n){const s=this.findItemIndex(e,t);return n[s]||null}return null}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var n;return!!t&&(e===t||e.event.identifier===((n=t.event)==null?void 0:n.identifier))}findItemIndex(e,t){return e?this.schedule.findItemIndex(e,t):-1}updateSchedule(){const e=this.mediaSelection;e&&this.schedule.updateSchedule(e,[])}checkBuffer(e){const t=this.schedule.items;if(!t)return;const n=Hn.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=n.len<1),this.updateBufferedPos(n.end,t,e)}updateBufferedPos(e,t,n){const s=this.schedule,r=this.bufferingItem;if(this.bufferedPos>e)return;if(t.length===1&&this.itemsMatch(t[0],r)){this.bufferedPos=e;return}const a=this.playingItem,o=this.findItemIndex(a);let l=s.findItemIndexAtTime(e);if(this.bufferedPos<e){var c,h;const d=this.findItemIndex(r),m=Math.min(d+1,t.length-1),y=t[m];if((l===-1&&r&&e>=r.end||(c=y.event)!=null&&c.appendInPlace&&e+.01>=y.start)&&(l=m),m-o>1&&(r==null||(h=r.event)==null?void 0:h.appendInPlace)===!1)return;if(this.bufferedPos=e,l>d&&l>o)this.bufferedToItem(y);else{const x=this.primaryDetails;this.primaryLive&&x&&e>x.edge-x.targetduration&&y.start<x.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(y)&&this.preloadAssets(y.event,0)}}else n&&a&&!this.itemsMatch(a,r)&&(l===o?this.bufferedToItem(a):l===o+1&&this.bufferedToItem(t[l]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(s=>{const r=this.getAssetPlayer(s.identifier);return!(r!=null&&r.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,n=this.schedule;if(this.itemsMatch(e,t))this.bufferingItem!==e&&(this.bufferingItem=e);else{const{items:s,events:r}=n;if(!s||!r)return t;const a=this.isInterstitial(e),o=this.getBufferingPlayer();if(this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos)),!this.playbackDisabled){const l=o?o.remaining:t?t.end-this.timelinePos:0;this.log(`buffered to boundary ${Ud(e)}`+(t?` (${l.toFixed(2)} remaining)`:"")),a?e.event.assetList.forEach(c=>{const h=this.getAssetPlayer(c.identifier);h&&h.resumeBuffering()}):(this.hls.resumeBuffering(),this.playerQueue.forEach(c=>c.pauseBuffering()))}this.hls.trigger(H.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:r.slice(0),schedule:s.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}return t}bufferedToItem(e,t=0){const n=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(n!==null){this.bufferingAsset=null;const s=this.detachedData;s?s.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),n=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(n)}bufferedToEvent(e,t){const n=e.event,s=n.assetList.length===0&&!n.assetListLoader,r=n.cue.once;if(s||!r){const a=this.preloadAssets(n,t);if(a!=null&&a.interstitial.appendInPlace){const o=n.assetList[t],l=this.primaryMedia;o&&l&&this.bufferAssetPlayer(a,l)}}}preloadAssets(e,t){const n=e.assetUrl,s=e.assetList.length,r=s===0&&!e.assetListLoader,a=e.cue.once;if(r){const l=e.timelineStart;if(e.appendInPlace){var o;const m=this.playingItem;!this.isInterstitial(m)&&(m==null||(o=m.nextEvent)==null?void 0:o.identifier)===e.identifier&&this.flushFrontBuffer(l+.25)}let c,h=0;if(!this.playingItem&&this.primaryLive&&(h=this.hls.startPosition,h===-1&&(h=this.hls.liveSyncPosition||0)),h&&!(e.cue.pre||e.cue.post)){const m=h-l;m>0&&(c=Math.round(m*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${n?1:s} ${e}${c?` live-start: ${h} start-offset: ${c}`:""}`),n)return this.createAsset(e,0,0,l,e.duration,n);const d=this.assetListLoader.loadAssetList(e,c);d&&(e.assetListLoader=d)}else if(!a&&s){for(let l=t;l<s;l++){const c=e.assetList[l],h=this.getAssetPlayerQueueIndex(c.identifier);(h===-1||this.playerQueue[h].destroyed)&&!c.error&&this.createAssetPlayer(e,c,l)}return this.getAssetPlayer(e.assetList[t].identifier)}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(s=>{this.hls.trigger(H.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:s})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let n=0;n<t.length;n++)if(e===t[n].assetId)return n;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let n=0;n<e.length;n++)if(e[n].media===t)return e[n]}return null}createAsset(e,t,n,s,r,a){const o={parentIdentifier:e.identifier,identifier:oQ(e,a,t),duration:r,startOffset:n,timelineStart:s,uri:a};return this.createAssetPlayer(e,o,t)}createAssetPlayer(e,t,n){this.log(`create HLSAssetPlayer for ${tL(t)}`);const s=this.hls,r=s.userConfig;let a=r.videoPreference;const o=s.loadLevelObj||s.levels[s.currentLevel];(a||o)&&(a=Yi({},a),o.videoCodec&&(a.videoCodec=o.videoCodec),o.videoRange&&(a.allowedVideoRanges=[o.videoRange]));const l=s.audioTracks[s.audioTrack],c=s.subtitleTracks[s.subtitleTrack];let h=0;if(this.primaryLive||e.appendInPlace){const w=this.timelinePos-t.timelineStart;if(w>1){const R=t.duration;R&&w<R&&(h=w)}}const d=t.identifier,m=Pi(Pi({},r),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:s.sessionId,assetPlayerId:d,abrEwmaDefaultEstimate:s.bandwidthEstimate,interstitialsController:void 0,startPosition:h,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:a,audioPreference:l||r.audioPreference,subtitlePreference:c||r.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(m.timelineOffset=t.timelineStart));const y=m.cmcd;y!=null&&y.sessionId&&y.contentId&&(m.cmcd=Yi({},y,{contentId:lA(t.uri)})),this.getAssetPlayer(d)&&this.warn(`Duplicate date range identifier ${e} and asset ${d}`);const x=new uQ(this.HlsPlayerClass,m,e,t);this.playerQueue.push(x),e.assetList[n]=t;const _=w=>{if(w.live){const N=new Error(`Interstitials MUST be VOD assets ${e}`),U={fatal:!0,type:nn.OTHER_ERROR,details:Pe.INTERSTITIAL_ASSET_ITEM_ERROR,error:N};this.handleAssetItemError(U,e,this.schedule.findEventIndex(e.identifier),n,N.message);return}const R=w.edge-w.fragmentStart,O=t.duration;(O===null||R>O)&&(this.log(`Interstitial asset "${d}" duration change ${O} > ${R}`),t.duration=R,this.updateSchedule())};x.on(H.LEVEL_UPDATED,(w,{details:R})=>_(R)),x.on(H.LEVEL_PTS_UPDATED,(w,{details:R})=>_(R));const b=(w,R)=>{const O=this.getAssetPlayer(d);if(O&&R.tracks){O.off(H.BUFFER_CODECS,b),O.tracks=R.tracks;const N=this.primaryMedia;this.bufferingAsset===O.assetItem&&N&&!O.media&&this.bufferAssetPlayer(O,N)}};x.on(H.BUFFER_CODECS,b);const A=()=>{var w;const R=this.getAssetPlayer(d);if(this.log(`buffered to end of asset ${R}`),!R)return;const O=this.schedule.findEventIndex(e.identifier),N=e.findAssetIndex(t),U=N+1,P=(w=this.schedule.items)==null?void 0:w[O];if(this.isInterstitial(P))if(N!==-1&&!e.isAssetPastPlayoutLimit(U)&&!e.assetList[U].error)this.bufferedToItem(P,U);else{var B;const L=(B=this.schedule.items)==null?void 0:B[O+1];L&&this.bufferedToItem(L)}};x.on(H.BUFFERED_TO_END,A);const T=w=>()=>{if(!this.getAssetPlayer(d))return;this.shouldPlay=!0;const O=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,O,w)};return x.once(H.MEDIA_ENDED,T(n)),x.once(H.PLAYOUT_LIMIT_REACHED,T(1/0)),x.on(H.ERROR,(w,R)=>{const O=this.getAssetPlayer(d);if(R.details===Pe.BUFFER_STALLED_ERROR){if(O!=null&&O.media){const N=O.currentTime,U=O.duration-N;N&&e.appendInPlace&&U/O.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${d} ${e} at ${O.media.currentTime}`),A()):(this.warn(`Stalled at ${N} of ${N+U} in asset ${d} ${e}`),this.onTimeupdate(),this.checkBuffer(!0))}return}this.handleAssetItemError(R,e,this.schedule.findEventIndex(e.identifier),n,`Asset player error ${R.error} ${e}`)}),x.on(H.DESTROYING,()=>{if(!this.getAssetPlayer(d))return;const R=new Error(`Asset player destroyed unexpectedly ${d}`),O={fatal:!0,type:nn.OTHER_ERROR,details:Pe.INTERSTITIAL_ASSET_ITEM_ERROR,error:R};this.handleAssetItemError(O,e,this.schedule.findEventIndex(e.identifier),n,R.message)}),this.hls.trigger(H.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:n,event:e,player:x}),x}clearInterstitial(e,t){e.assetList.forEach(n=>{this.clearAssetPlayer(n.identifier,t)}),e.reset()}clearAssetPlayer(e,t){const n=this.getAssetPlayerQueueIndex(e);if(n!==-1){this.log(`clearAssetPlayer "${e}" toSegment: ${t&&Ud(t)}`);const s=this.playerQueue[n];this.transferMediaFromPlayer(s,t),this.playerQueue.splice(n,1),s.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,n,s,r){const{interstitial:a,assetItem:o,assetId:l}=e,c=a.assetList.length,h=this.playingAsset;this.endedAsset=null,this.playingAsset=o,(!h||h.identifier!==l)&&(h&&(this.clearAssetPlayer(h.identifier,n[s]),delete h.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${c} ${e}`),this.hls.trigger(H.INTERSTITIAL_ASSET_STARTED,{asset:o,assetListIndex:t,event:a,schedule:n.slice(0),scheduleIndex:s,player:e})),this.bufferAssetPlayer(e,r)}bufferAssetPlayer(e,t){var n,s;const{interstitial:r,assetItem:a,assetId:o}=e,l=this.schedule.findEventIndex(r.identifier),c=(n=this.schedule.items)==null?void 0:n[l];if(!c)return;this.setBufferingItem(c),this.bufferingAsset=a;const h=this.getBufferingPlayer();if(h===e)return;const d=r.appendInPlace;if(d&&(h==null?void 0:h.interstitial.appendInPlace)===!1)return;const m=(h==null?void 0:h.tracks)||((s=this.detachedData)==null?void 0:s.tracks)||this.requiredTracks;if(d&&a!==this.playingAsset){if(!e.tracks)return;if(m&&!Y5(m,e.tracks)){const y=new Error(`Asset "${o}" SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(m)}')`),x={fatal:!0,type:nn.OTHER_ERROR,details:Pe.INTERSTITIAL_ASSET_ITEM_ERROR,error:y},_=r.findAssetIndex(a);this.handleAssetItemError(x,r,l,_,y.message);return}}this.transferMediaTo(e,t)}handleAssetItemError(e,t,n,s,r){if(e.details===Pe.BUFFER_STALLED_ERROR)return;const a=t.assetList[s]||null;let o=null;if(a){const d=this.getAssetPlayerQueueIndex(a.identifier);o=this.playerQueue[d]||null}const l=this.schedule.items,c=Yi({},e,{fatal:!1,errorAction:BA(!0),asset:a,assetListIndex:s,event:t,schedule:l,scheduleIndex:n,player:o});if(this.warn(`Asset item error: ${e.error}`),this.hls.trigger(H.INTERSTITIAL_ASSET_ERROR,c),!e.fatal)return;const h=new Error(r);a&&(this.playingAsset!==a&&this.clearAssetPlayer(a.identifier,null),a.error=h),t.assetList.some(d=>!d.error)?t.appendInPlace&&(t.error=h):t.error=h,this.primaryFallback(t)}primaryFallback(e){const t=e.timelineStart,n=this.effectivePlayingItem;if(this.updateSchedule(),n){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${n?Ud(n):"<none>"} error: ${e.error}`),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t));let s=this.timelinePos;s===-1&&(s=this.hls.startPosition);const r=this.updateItem(n,s);if(this.itemsMatch(n,r))this.clearInterstitial(e,null);else{const a=this.schedule.findItemIndexAtTime(s);this.setSchedulePosition(a)}}else this.checkStart()}onAssetListLoaded(e,t){var n;const s=t.event,r=s.identifier,a=t.assetListResponse.ASSETS;if(!this.schedule.hasEvent(r))return;const o=s.timelineStart,l=s.duration;let c=0;a.forEach((x,_)=>{const b=parseFloat(x.DURATION);this.createAsset(s,_,c,o+c,b,x.URI),c+=b}),s.duration=c,this.log(`Loaded asset-list with duration: ${c} (was: ${l}) ${s}`);const h=this.waitingItem,d=(h==null?void 0:h.event.identifier)===r;this.updateSchedule();const m=(n=this.bufferingItem)==null?void 0:n.event;if(d){var y;const x=this.schedule.findEventIndex(r),_=(y=this.schedule.items)==null?void 0:y[x];if(_){if(!this.playingItem&&this.timelinePos>_.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==x){s.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${s}`),this.primaryFallback(s);return}this.setBufferingItem(_)}this.setSchedulePosition(x)}else if((m==null?void 0:m.identifier)===r&&m.appendInPlace){const x=s.assetList[0],_=this.getAssetPlayer(x.identifier),b=this.primaryMedia;x&&_&&b&&this.bufferAssetPlayer(_,b)}}onError(e,t){switch(t.details){case Pe.ASSET_LIST_PARSING_ERROR:case Pe.ASSET_LIST_LOAD_ERROR:case Pe.ASSET_LIST_LOAD_TIMEOUT:{const n=t.interstitial;n&&this.primaryFallback(n);break}case Pe.BUFFER_STALLED_ERROR:{this.onTimeupdate(),this.checkBuffer(!0);break}}}}const sU=500;class pQ extends jI{constructor(e,t,n){super(e,t,n,"subtitle-stream-controller",Zt.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(H.LEVEL_LOADED,this.onLevelLoaded,this),e.on(H.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(H.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(H.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(H.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(H.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(H.LEVEL_LOADED,this.onLevelLoaded,this),e.off(H.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(H.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(H.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(H.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(H.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=ht.IDLE,this.setInterval(sU),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:s}=t;if(zr(n)&&(this.fragPrevious=n),this.state=ht.IDLE,!s)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let a;const o=n.start;for(let c=0;c<r.length;c++)if(o>=r[c].start&&o<=r[c].end){a=r[c];break}const l=n.start+n.duration;a?a.end=l:(a={start:o,end:l},r.push(a)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:n,endOffset:s}=t;if(n===0&&s!==Number.POSITIVE_INFINITY){const r=s-1;if(r<=0)return;t.endOffsetSubtitles=Math.max(0,r),this.tracksBuffered.forEach(a=>{for(let o=0;o<a.length;){if(a[o].end<=r){a.shift();continue}else if(a[o].start<r)a[o].start=r;else break;o++}}),this.fragmentTracker.removeFragmentsInRange(n,r,Zt.SUBTITLE)}}onError(e,t){const n=t.frag;(n==null?void 0:n.type)===Zt.SUBTITLE&&(t.details===Pe.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==ht.STOPPED&&(this.state=ht.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&VH(this.levels,t)){this.levels=t.map(n=>new IA(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const s=new IA(n);return this.tracksBuffered[s.id]=[],s}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Zt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const s=this.levels[this.currentTrackId];s!=null&&s.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,s&&this.state!==ht.STOPPED&&this.setInterval(sU)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:s,levels:r}=this,{details:a,id:o}=t;if(!r){this.warn(`Subtitle tracks were reset while loading level ${o}`);return}const l=r[o];if(o>=r.length||!l)return;this.log(`Subtitle track ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let c=0;if(a.live||(n=l.details)!=null&&n.live){const d=this.mainDetails;if(a.deltaUpdateFailed||!d)return;const m=d.fragments[0];if(!l.details)a.hasProgramDateTime&&d.hasProgramDateTime?(r3(a,d),c=a.fragmentStart):m&&(c=m.start,jD(a,c));else{var h;c=this.alignPlaylists(a,l.details,(h=this.levelLastLoaded)==null?void 0:h.details),c===0&&m&&(c=m.start,jD(a,c))}}l.details=a,this.levelLastLoaded=l,o===s&&(this.hls.trigger(H.SUBTITLE_TRACK_UPDATED,{details:a,id:o,groupId:t.groupId}),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===ht.IDLE&&(ig(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,s=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&s!=null&&s.key&&s.iv&&yy(s.method)){const a=performance.now();this.decrypter.decrypt(new Uint8Array(n),s.key.buffer,s.iv.buffer,WI(s.method)).catch(o=>{throw r.trigger(H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.FRAG_DECRYPT_ERROR,fatal:!1,error:o,reason:o.message,frag:t}),o}).then(o=>{const l=performance.now();r.trigger(H.FRAG_DECRYPTED,{frag:t,payload:o,stats:{tstart:a,tdecrypt:l}})}).catch(o=>{this.warn(`${o.name}: ${o.message}`),this.state=ht.IDLE})}}doTick(){if(!this.media){this.state=ht.IDLE;return}if(this.state===ht.IDLE){const{currentTrackId:e,levels:t}=this,n=t==null?void 0:t[e];if(!n||!t.length||!n.details||this.waitForLive(n))return;const{config:s}=this,r=this.getLoadPosition(),a=Hn.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,s.maxBufferHole),{end:o,len:l}=a,c=n.details,h=this.hls.maxBufferLength+c.levelTargetDuration;if(l>h)return;const d=c.fragments,m=d.length,y=c.edge;let x=null;const _=this.fragPrevious;if(o<y){const T=s.maxFragLookUpTolerance,w=o>y-T?0:T;x=ig(_,d,Math.max(d[0].start,o),w),!x&&_&&_.start<d[0].start&&(x=d[0])}else x=d[m-1];if(x=this.filterReplacedPrimary(x,n.details),!x)return;const b=x.sn-c.startSN,A=d[b-1];if(A&&A.cc===x.cc&&this.fragmentTracker.getState(A)===Tr.NOT_LOADED&&(x=A),this.fragmentTracker.getState(x)===Tr.NOT_LOADED){const T=this.mapToInitFragWhenRequired(x);T&&this.loadFragment(T,n,o)}}}loadFragment(e,t,n){zr(e)?super.loadFragment(e,t,n):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new mQ(this.tracksBuffered[this.currentTrackId]||[])}}class mQ{constructor(e){this.buffered=void 0;const t=(n,s,r)=>{if(s=s>>>0,s>r-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${s}) is greater than the maximum bound (${r})`);return e[s][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}const gQ={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},ZH=i=>String.fromCharCode(gQ[i]||i),wc=15,jh=100,yQ={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},vQ={17:2,18:4,21:6,22:8,23:10,19:13,20:15},xQ={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},bQ={25:2,26:4,29:6,30:8,31:10,27:13,28:15},AQ=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class EQ{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;oi.log(`${this.time} [${e}] ${n}`)}}}const Np=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class eG{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const s=t[n];e.hasOwnProperty(s)&&(this[s]=e[s])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class _Q{constructor(){this.uchar=" ",this.penState=new eG}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class SQ{constructor(e){this.chars=[],this.pos=0,this.currPenState=new eG,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<jh;t++)this.chars.push(new _Q);this.logger=e}equals(e){for(let t=0;t<jh;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<jh;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<jh;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>jh&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=jh)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=ZH(e);if(this.pos>=jh){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<jh;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<jh;n++){const s=this.chars[n].uchar;s!==" "&&(t=!1),e.push(s)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class YC{constructor(e){this.rows=[],this.currRow=wc-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<wc;t++)this.rows.push(new SQ(e));this.logger=e}reset(){for(let e=0;e<wc;e++)this.rows[e].clear();this.currRow=wc-1}equals(e){let t=!0;for(let n=0;n<wc;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<wc;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<wc;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+xs(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let o=0;o<wc;o++)this.rows[o].clear();const r=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){const o=a.rows[r].cueStartTime,l=this.logger.time;if(o!==null&&l!==null&&o<l)for(let c=0;c<this.nrRollUpRows;c++)this.rows[t-this.nrRollUpRows+c+1].copy(a.rows[r+c])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const r=e.indent,a=Math.max(r-1,0);n.setCursor(e.indent),e.color=n.chars[a].penState.foreground}const s={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+xs(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",s=-1;for(let r=0;r<wc;r++){const a=this.rows[r].getTextString();a&&(s=r+1,e?t.push("Row "+s+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class rU{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new YC(n),this.nonDisplayedMemory=new YC(n),this.lastOutputScreen=new YC(n),this.currRollUpRow=this.displayedMemory.rows[wc-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[wc-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=s[n]}this.logger.log(2,"MIDROW: "+xs(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class aU{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=wQ(),this.logger=void 0;const s=this.logger=new EQ;this.channels=[null,new rU(e,t,s),new rU(e+1,n,s)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const s=t[n]&127,r=t[n+1]&127;let a=!1,o=null;if(s===0&&r===0)continue;this.logger.log(3,()=>"["+Np([t[n],t[n+1]])+"] -> ("+Np([s,r])+")");const l=this.cmdHistory;if(s>=16&&s<=31){if(TQ(s,r,l)){Y_(null,null,l),this.logger.log(3,()=>"Repeated command ("+Np([s,r])+") is dropped");continue}Y_(s,r,this.cmdHistory),a=this.parseCmd(s,r),a||(a=this.parseMidrow(s,r)),a||(a=this.parsePAC(s,r)),a||(a=this.parseBackgroundAttributes(s,r))}else Y_(null,null,l);if(!a&&(o=this.parseChars(s,r),o)){const h=this.currentChannel;h&&h>0?this.channels[h].insertChars(o):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!a&&!o&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Np([s,r])+" orig: "+Np([t[n],t[n+1]]))}}parseCmd(e,t){const n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=33&&t<=35;if(!(n||s))return!1;const r=e===20||e===21||e===23?1:2,a=this.channels[r];return e===20||e===21||e===28||e===29?t===32?a.ccRCL():t===33?a.ccBS():t===34?a.ccAOF():t===35?a.ccAON():t===36?a.ccDER():t===37?a.ccRU(2):t===38?a.ccRU(3):t===39?a.ccRU(4):t===40?a.ccFON():t===41?a.ccRDC():t===42?a.ccTR():t===43?a.ccRTD():t===44?a.ccEDM():t===45?a.ccCR():t===46?a.ccENM():t===47&&a.ccEOC():a.ccTO(t-32),this.currentChannel=r,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const s=this.channels[n];return s?(s.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Np([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const s=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,r=(e===16||e===24)&&t>=64&&t<=95;if(!(s||r))return!1;const a=e<=23?1:2;t>=64&&t<=95?n=a===1?yQ[e]:xQ[e]:n=a===1?vQ[e]:bQ[e];const o=this.channels[a];return o?(o.setPAC(this.interpretPAC(n,t)),this.currentChannel=a,!0):!1}interpretPAC(e,t){let n;const s={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,s.underline=(n&1)===1,n<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(s.italics=!0,s.color="white"):s.indent=Math.floor((n-16)/2)*4,s}parseChars(e,t){let n,s=null,r=null;if(e>=25?(n=2,r=e-8):(n=1,r=e),r>=17&&r<=19){let a;r===17?a=t+80:r===18?a=t+112:a=t+144,this.logger.log(2,()=>"Special char '"+ZH(a)+"' in channel "+n),s=[a]}else e>=32&&e<=127&&(s=t===0?[e]:[e,t]);return s&&this.logger.log(3,()=>"Char codes =  "+Np(s).join(",")),s}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=45&&t<=47;if(!(n||s))return!1;let r;const a={};e===16||e===24?(r=Math.floor((t-32)/2),a.background=AQ[r],t%2===1&&(a.background=a.background+"_semi")):t===45?a.background="transparent":(a.foreground="black",t===47&&(a.underline=!0));const o=e<=23?1:2;return this.channels[o].setBkgData(a),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}Y_(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function Y_(i,e,t){t.a=i,t.b=e}function TQ(i,e,t){return t.a===i&&t.b===e}function wQ(){return{a:null,b:null}}var rB=function(){if(s3!=null&&s3.VTTCue)return self.VTTCue;const i=["","lr","rl"],e=["start","middle","end","left","right"];function t(o,l){if(typeof l!="string"||!Array.isArray(o))return!1;const c=l.toLowerCase();return~o.indexOf(c)?c:!1}function n(o){return t(i,o)}function s(o){return t(e,o)}function r(o,...l){let c=1;for(;c<arguments.length;c++){const h=arguments[c];for(const d in h)o[d]=h[d]}return o}function a(o,l,c){const h=this,d={enumerable:!0};h.hasBeenReset=!1;let m="",y=!1,x=o,_=l,b=c,A=null,T="",w=!0,R="auto",O="start",N=50,U="middle",P=50,B="middle";Object.defineProperty(h,"id",r({},d,{get:function(){return m},set:function(L){m=""+L}})),Object.defineProperty(h,"pauseOnExit",r({},d,{get:function(){return y},set:function(L){y=!!L}})),Object.defineProperty(h,"startTime",r({},d,{get:function(){return x},set:function(L){if(typeof L!="number")throw new TypeError("Start time must be set to a number.");x=L,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",r({},d,{get:function(){return _},set:function(L){if(typeof L!="number")throw new TypeError("End time must be set to a number.");_=L,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",r({},d,{get:function(){return b},set:function(L){b=""+L,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",r({},d,{get:function(){return A},set:function(L){A=L,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",r({},d,{get:function(){return T},set:function(L){const F=n(L);if(F===!1)throw new SyntaxError("An invalid or illegal string was specified.");T=F,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",r({},d,{get:function(){return w},set:function(L){w=!!L,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",r({},d,{get:function(){return R},set:function(L){if(typeof L!="number"&&L!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");R=L,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",r({},d,{get:function(){return O},set:function(L){const F=s(L);if(!F)throw new SyntaxError("An invalid or illegal string was specified.");O=F,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",r({},d,{get:function(){return N},set:function(L){if(L<0||L>100)throw new Error("Position must be between 0 and 100.");N=L,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",r({},d,{get:function(){return U},set:function(L){const F=s(L);if(!F)throw new SyntaxError("An invalid or illegal string was specified.");U=F,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",r({},d,{get:function(){return P},set:function(L){if(L<0||L>100)throw new Error("Size must be between 0 and 100.");P=L,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",r({},d,{get:function(){return B},set:function(L){const F=s(L);if(!F)throw new SyntaxError("An invalid or illegal string was specified.");B=F,this.hasBeenReset=!0}})),h.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}();class MQ{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function tG(i){function e(n,s,r,a){return(n|0)*3600+(s|0)*60+(r|0)+parseFloat(a||0)}const t=i.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class CQ{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let s=0;s<n.length;++s)if(t===n[s]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function nG(i,e,t,n){const s=n?i.split(n):[i];for(const r in s){if(typeof s[r]!="string")continue;const a=s[r].split(t);if(a.length!==2)continue;const o=a[0],l=a[1];e(o,l)}}const nL=new rB(0,0,""),K_=nL.align==="middle"?"middle":"center";function RQ(i,e,t){const n=i;function s(){const o=tG(i);if(o===null)throw new Error("Malformed timestamp: "+n);return i=i.replace(/^[^\sa-zA-Z-]+/,""),o}function r(o,l){const c=new CQ;nG(o,function(m,y){let x;switch(m){case"region":for(let _=t.length-1;_>=0;_--)if(t[_].id===y){c.set(m,t[_].region);break}break;case"vertical":c.alt(m,y,["rl","lr"]);break;case"line":x=y.split(","),c.integer(m,x[0]),c.percent(m,x[0])&&c.set("snapToLines",!1),c.alt(m,x[0],["auto"]),x.length===2&&c.alt("lineAlign",x[1],["start",K_,"end"]);break;case"position":x=y.split(","),c.percent(m,x[0]),x.length===2&&c.alt("positionAlign",x[1],["start",K_,"end","line-left","line-right","auto"]);break;case"size":c.percent(m,y);break;case"align":c.alt(m,y,["start",K_,"end","left","right"]);break}},/:/,/\s/),l.region=c.get("region",null),l.vertical=c.get("vertical","");let h=c.get("line","auto");h==="auto"&&nL.line===-1&&(h=-1),l.line=h,l.lineAlign=c.get("lineAlign","start"),l.snapToLines=c.get("snapToLines",!0),l.size=c.get("size",100),l.align=c.get("align",K_);let d=c.get("position","auto");d==="auto"&&nL.position===50&&(d=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=d}function a(){i=i.replace(/^\s+/,"")}if(a(),e.startTime=s(),a(),i.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);i=i.slice(3),a(),e.endTime=s(),a(),r(i,e)}function iG(i){return i.replace(/<br(?: \/)?>/gi,`
`)}class DQ{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new MQ,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let r=t.buffer,a=0;for(r=iG(r);a<r.length&&r[a]!=="\r"&&r[a]!==`
`;)++a;const o=r.slice(0,a);return r[a]==="\r"&&++a,r[a]===`
`&&++a,t.buffer=r.slice(a),o}function s(r){nG(r,function(a,o){},/:/)}try{let r="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;r=n();const o=r.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(o!=null&&o[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let a=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:r=n(),t.state){case"HEADER":/:/.test(r)?s(r):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new rB(0,0,""),t.state="CUE",r.indexOf("-->")===-1){t.cue.id=r;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{RQ(r,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const o=r.indexOf("-->")!==-1;if(!r||o&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=r}continue;case"BADCUE":r||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const LQ=/\r\n|\n\r|\n|\r/g,KC=function(e,t,n=0){return e.slice(n,n+t.length)===t},IQ=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),s=parseInt(e.slice(-9,-7)),r=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!Vt(t)||!Vt(n)||!Vt(s)||!Vt(r))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*s,t+=60*60*1e3*r,t};function aB(i,e,t){return lA(i.toString())+lA(e.toString())+lA(t)}const BQ=function(e,t,n){let s=e[t],r=e[s.prevCC];if(!r||!r.new&&s.new){e.ccOffset=e.presentationOffset=s.start,s.new=!1;return}for(;(a=r)!=null&&a.new;){var a;e.ccOffset+=s.start-r.start,s.new=!1,s=r,r=e[s.prevCC]}e.presentationOffset=n};function OQ(i,e,t,n,s,r,a){const o=new DQ,l=el(new Uint8Array(i)).trim().replace(LQ,`
`).split(`
`),c=[],h=e?Jj(e.baseTime,e.timescale):0;let d="00:00.000",m=0,y=0,x,_=!0;o.oncue=function(b){const A=t[n];let T=t.ccOffset;const w=(m-h)/9e4;if(A!=null&&A.new&&(y!==void 0?T=t.ccOffset=A.start:BQ(t,n,w)),w){if(!e){x=new Error("Missing initPTS for VTT MPEGTS");return}T=w-t.presentationOffset}const R=b.endTime-b.startTime,O=Bl((b.startTime+T-y)*9e4,s*9e4)/9e4;b.startTime=Math.max(O,0),b.endTime=Math.max(O+R,0);const N=b.text.trim();b.text=decodeURIComponent(encodeURIComponent(N)),b.id||(b.id=aB(b.startTime,b.endTime,N)),b.endTime>0&&c.push(b)},o.onparsingerror=function(b){x=b},o.onflush=function(){if(x){a(x);return}r(c)},l.forEach(b=>{if(_)if(KC(b,"X-TIMESTAMP-MAP=")){_=!1,b.slice(16).split(",").forEach(A=>{KC(A,"LOCAL:")?d=A.slice(6):KC(A,"MPEGTS:")&&(m=parseInt(A.slice(7)))});try{y=IQ(d)/1e3}catch(A){x=A}return}else b===""&&(_=!1);o.parse(b+`
`)}),o.flush()}const WC="stpp.ttml.im1t",sG=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,rG=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,PQ={left:"start",center:"center",right:"end",start:"start",end:"end"};function oU(i,e,t,n){const s=Cn(new Uint8Array(i),["mdat"]);if(s.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const r=s.map(o=>el(o)),a=$j(e.baseTime,1,e.timescale);try{r.forEach(o=>t(NQ(o,a)))}catch(o){n(o)}}function NQ(i,e){const s=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");const r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(r).reduce((d,m)=>(d[m]=s.getAttribute(`ttp:${m}`)||r[m],d),{}),o=s.getAttribute("xml:space")!=="preserve",l=lU(XC(s,"styling","style")),c=lU(XC(s,"layout","region")),h=XC(s,"body","[begin]");return[].map.call(h,d=>{const m=aG(d,o);if(!m||!d.hasAttribute("begin"))return null;const y=qC(d.getAttribute("begin"),a),x=qC(d.getAttribute("dur"),a);let _=qC(d.getAttribute("end"),a);if(y===null)throw cU(d);if(_===null){if(x===null)throw cU(d);_=y+x}const b=new rB(y-e,_-e,m);b.id=aB(b.startTime,b.endTime,b.text);const A=c[d.getAttribute("region")],T=l[d.getAttribute("style")],w=UQ(A,T,l),{textAlign:R}=w;if(R){const O=PQ[R];O&&(b.lineAlign=O),b.align=R}return Yi(b,w),b}).filter(d=>d!==null)}function XC(i,e,t){const n=i.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function lU(i){return i.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function aG(i,e){return[].slice.call(i.childNodes).reduce((t,n,s)=>{var r;return n.nodeName==="br"&&s?t+`
`:(r=n.childNodes)!=null&&r.length?aG(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function UQ(i,e,t){const n="http://www.w3.org/ns/ttml#styling";let s=null;const r=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=i!=null&&i.hasAttribute("style")?i.getAttribute("style"):null;return a&&t.hasOwnProperty(a)&&(s=t[a]),r.reduce((o,l)=>{const c=jC(e,n,l)||jC(i,n,l)||jC(s,n,l);return c&&(o[l]=c),o},{})}function jC(i,e,t){return i&&i.hasAttributeNS(e,t)?i.getAttributeNS(e,t):null}function cU(i){return new Error(`Could not parse ttml timestamp ${i}`)}function qC(i,e){if(!i)return null;let t=tG(i);return t===null&&(sG.test(i)?t=kQ(i,e):rG.test(i)&&(t=FQ(i,e))),t}function kQ(i,e){const t=sG.exec(i),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function FQ(i,e){const t=rG.exec(i),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class W_{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class HQ{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=hU(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(H.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(H.FRAG_LOADING,this.onFragLoading,this),e.on(H.FRAG_LOADED,this.onFragLoaded,this),e.on(H.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(H.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(H.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(H.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(H.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(H.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(H.FRAG_LOADING,this.onFragLoading,this),e.off(H.FRAG_LOADED,this.onFragLoaded,this),e.off(H.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(H.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(H.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(H.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(H.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new W_(this,"textTrack1"),t=new W_(this,"textTrack2"),n=new W_(this,"textTrack3"),s=new W_(this,"textTrack4");this.cea608Parser1=new aU(1,e,t),this.cea608Parser2=new aU(3,n,s)}addCues(e,t,n,s,r){let a=!1;for(let o=r.length;o--;){const l=r[o],c=GQ(l[0],l[1],t,n);if(c>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],n),a=!0,c/(n-t)>.5))return}if(a||r.push([t,n]),this.config.renderTextTracksNatively){const o=this.captionsTracks[e];this.Cues.newCue(o,t,n,s)}else{const o=this.Cues.newCue(null,t,n,s);this.hls.trigger(H.CUES_PARSED,{type:"captions",cues:o,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:s,timescale:r}){const{unparsedVttFrags:a}=this;n===Zt.MAIN&&(this.initPTS[t.cc]={baseTime:s,timescale:r}),a.length&&(this.unparsedVttFrags=[],a.forEach(o=>{this.onFragLoaded(H.FRAG_LOADED,o)}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let s=0;s<n.textTracks.length;s++){const r=n.textTracks[s];if(uU(r,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:s}=this,{label:r,languageCode:a}=t[e],o=this.getExistingTrack(r,a);if(o)n[e]=o,ly(n[e]),QH(n[e],s);else{const l=this.createTextTrack("captions",r,a);l&&(l[e]=!0,n[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,s={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=s,this.hls.trigger(H.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}createTextTrack(e,t,n){const s=this.media;if(s)return s.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const n=!!t.transferMedia;if(this.media=null,n)return;const{captionsTracks:s}=this;Object.keys(s).forEach(r=>{ly(s[r]),delete s[r]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=hU(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)ly(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],s=n.some(r=>r.textCodec===WC);if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(VH(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const a=this.media,o=a?CT(a.textTracks):null;if(this.tracks.forEach((l,c)=>{let h;if(o){let d=null;for(let m=0;m<o.length;m++)if(o[m]&&uU(o[m],l)){d=o[m],o[m]=null;break}d&&(h=d)}if(h)ly(h);else{const d=oG(l);h=this.createTextTrack(d,l.name,l.lang),h&&(h.mode="disabled")}h&&this.textTracks.push(h)}),o!=null&&o.length){const l=o.filter(c=>c!==null).map(c=>c.label);l.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const a=this.tracks.map(o=>({label:o.name,kind:o.type.toLowerCase(),default:o.default,subtitleTrack:o}));this.hls.trigger(H.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const s=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!s)return;const r=`textTrack${s[1]}`,a=this.captionsProperties[r];a&&(a.label=n.name,n.lang&&(a.languageCode=n.lang),a.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Zt.MAIN){var n,s;const{cea608Parser1:r,cea608Parser2:a,lastSn:o}=this,{cc:l,sn:c}=t.frag,h=(n=(s=t.part)==null?void 0:s.index)!=null?n:-1;r&&a&&(c!==o+1||c===o&&h!==this.lastPartIndex+1||l!==this.lastCc)&&(r.reset(),a.reset()),this.lastCc=l,this.lastSn=c,this.lastPartIndex=h}}onFragLoaded(e,t){const{frag:n,payload:s}=t;if(n.type===Zt.SUBTITLE)if(s.byteLength){const r=n.decryptdata,a="stats"in t;if(r==null||!r.encrypted||a){const o=this.tracks[n.level],l=this.vttCCs;l[n.cc]||(l[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),o&&o.textCodec===WC?this._parseIMSC1(n,s):this._parseVTTs(t)}}else this.hls.trigger(H.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;oU(t,this.initPTS[e.cc],s=>{this._appendCues(s,e.level),n.trigger(H.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},s=>{n.logger.log(`Failed to parse IMSC1: ${s}`),n.trigger(H.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:s})})}_parseVTTs(e){var t;const{frag:n,payload:s}=e,{initPTS:r,unparsedVttFrags:a}=this,o=r.length-1;if(!r[n.cc]&&o===-1){a.push(e);return}const l=this.hls,c=(t=n.initSegment)!=null&&t.data?Fl(n.initSegment.data,new Uint8Array(s)).buffer:s;OQ(c,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,h=>{this._appendCues(h,n.level),l.trigger(H.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},h=>{const d=h.message==="Missing initPTS for VTT MPEGTS";d?a.push(e):this._fallbackToIMSC1(n,s),l.logger.log(`Failed to parse VTT cue: ${h}`),!(d&&o>n.cc)&&l.trigger(H.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:h})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||oU(t,this.initPTS[e.cc],()=>{n.textCodec=WC,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const s=this.textTracks[t];if(!s||s.mode==="disabled")return;e.forEach(r=>$H(s,r))}else{const s=this.tracks[t];if(!s)return;const r=s.default?"default":"subtitles"+t;n.trigger(H.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===Zt.SUBTITLE&&this.onFragLoaded(H.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:n,samples:s}=t;if(!(n.type===Zt.MAIN&&this.closedCaptionsForLevel(n)==="NONE"))for(let r=0;r<s.length;r++){const a=s[r].bytes;if(a){this.cea608Parser1||this.initCea608Parsers();const o=this.extractCea608Data(a);this.cea608Parser1.addData(s[r].pts,o[0]),this.cea608Parser2.addData(s[r].pts,o[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:s,type:r}){const{media:a}=this;if(!(!a||a.currentTime<n)){if(!r||r==="video"){const{captionsTracks:o}=this;Object.keys(o).forEach(l=>eL(o[l],t,n))}if(this.config.renderTextTracksNatively&&t===0&&s!==void 0){const{textTracks:o}=this;Object.keys(o).forEach(l=>eL(o[l],t,s))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let s=2;for(let r=0;r<n;r++){const a=e[s++],o=127&e[s++],l=127&e[s++];if(o===0&&l===0)continue;if((4&a)!==0){const h=3&a;(h===0||h===1)&&(t[h].push(o),t[h].push(l))}}return t}}function oG(i){return i.characteristics&&/transcribes-spoken-dialog/gi.test(i.characteristics)&&/describes-music-and-sound/gi.test(i.characteristics)?"captions":"subtitles"}function uU(i,e){return!!i&&i.kind===oG(e)&&$D(e,i)}function GQ(i,e,t,n){return Math.min(e,n)-Math.max(i,t)}function hU(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const zQ=/\s/,VQ={newCue(i,e,t,n){const s=[];let r,a,o,l,c;const h=self.VTTCue||self.TextTrackCue;for(let m=0;m<n.rows.length;m++)if(r=n.rows[m],o=!0,l=0,c="",!r.isEmpty()){var d;for(let _=0;_<r.chars.length;_++)zQ.test(r.chars[_].uchar)&&o?l++:(c+=r.chars[_].uchar,o=!1);r.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const y=iG(c.trim()),x=aB(e,t,y);i!=null&&(d=i.cues)!=null&&d.getCueById(x)||(a=new h(e,t,y),a.id=x,a.line=m+1,a.align="left",a.position=10+Math.min(80,Math.floor(l*8/32)*10),s.push(a))}return i&&s.length&&(s.sort((m,y)=>m.line==="auto"||y.line==="auto"?0:m.line>8&&y.line>8?y.line-m.line:m.line-y.line),s.forEach(m=>$H(i,m))),s}};function YQ(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const KQ=/(\d+)-(\d+)\/(\d+)/;class fU{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||qQ,this.controller=new self.AbortController,this.stats=new HI}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();const r=WQ(e,this.controller.signal),a=e.responseType==="arraybuffer",o=a?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:c}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,r),self.clearTimeout(this.requestTimeout),t.timeout=l&&Vt(l)?l:c,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},t.timeout),(UA(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(d=>{var m;this.response=this.loader=d;const y=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=c,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},c-(y-s.loading.start)),!d.ok){const{status:_,statusText:b}=d;throw new QQ(b||"fetch, bad network response",_,d)}s.loading.first=y,s.total=jQ(d.headers)||s.total;const x=(m=this.callbacks)==null?void 0:m.onProgress;return x&&Vt(t.highWaterMark)?this.loadProgressively(d,s,e,t.highWaterMark,x):a?d.arrayBuffer():e.responseType==="json"?d.json():d.text()}).then(d=>{var m,y;const x=this.response;if(!x)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);const _=d[o];_&&(s.loaded=s.total=_);const b={url:x.url,data:d,code:x.status},A=(m=this.callbacks)==null?void 0:m.onProgress;A&&!Vt(t.highWaterMark)&&A(s,e,d,x),(y=this.callbacks)==null||y.onSuccess(b,s,e,x)}).catch(d=>{var m;if(self.clearTimeout(this.requestTimeout),s.aborted)return;const y=d&&d.code||0,x=d?d.message:null;(m=this.callbacks)==null||m.onError({code:y,text:x},e,d?d.details:null,s)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,s=0,r){const a=new EH,o=e.body.getReader(),l=()=>o.read().then(c=>{if(c.done)return a.dataLength&&r(t,n,a.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const h=c.value,d=h.length;return t.loaded+=d,d<s||a.dataLength?(a.push(h),a.dataLength>=s&&r(t,n,a.flush().buffer,e)):r(t,n,h.buffer,e),l()}).catch(()=>Promise.reject());return l()}}function WQ(i,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Yi({},i.headers))};return i.rangeEnd&&t.headers.set("Range","bytes="+i.rangeStart+"-"+String(i.rangeEnd-1)),t}function XQ(i){const e=KQ.exec(i);if(e)return parseInt(e[2])-parseInt(e[1])+1}function jQ(i){const e=i.get("Content-Range");if(e){const n=XQ(e);if(Vt(n))return n}const t=i.get("Content-Length");if(t)return parseInt(t)}function qQ(i,e){return new self.Request(i.url,e)}class QQ extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const $Q=/^age:\s*[\d.]+\s*$/im;class lG{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new HI,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0,s.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return r(n,t.url)}).catch(a=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),r(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(a=>{var o;(o=this.callbacks)==null||o.onError({code:n.status,text:a.message},t,n,s)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const s=t.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:a}=n.loadPolicy;if(s)for(const o in s)e.setRequestHeader(o,s[o]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=r&&Vt(r)?r:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const s=t.readyState,r=this.config;if(!n.aborted&&s>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),s===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const c=t.status,h=t.responseType==="text"?t.responseText:null;if(c>=200&&c<300){const x=h??t.response;if(x!=null){var a,o;n.loading.end=Math.max(self.performance.now(),n.loading.first);const _=t.responseType==="arraybuffer"?x.byteLength:x.length;n.loaded=n.total=_,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first);const b=(a=this.callbacks)==null?void 0:a.onProgress;b&&b(n,e,x,t);const A={url:t.responseURL,data:x,code:c};(o=this.callbacks)==null||o.onSuccess(A,n,e,t);return}}const d=r.loadPolicy.errorRetry,m=n.retry,y={url:e.url,data:void 0,code:c};if(i3(d,m,!1,y))this.retry(d);else{var l;oi.error(`${c} while loading ${e.url}`),(l=this.callbacks)==null||l.onError({code:c,text:t.statusText},e,t,n)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(i3(e,t,!0))this.retry(e);else{var n;oi.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const s=this.callbacks;s&&(this.abortInternal(),s.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=VI(e,n.retry),n.retry++,oi.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&$Q.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const JQ={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},ZQ=Pi(Pi({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:lG,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:AX,bufferController:dq,capLevelController:iB,errorController:MX,fpsController:iQ,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:hH,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,certLoadPolicy:{default:JQ},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},e$()),{},{subtitleStreamController:pQ,subtitleTrackController:aQ,timelineController:HQ,audioStreamController:cq,audioTrackController:uq,emeController:vy,cmcdController:eQ,contentSteeringController:nQ,interstitialsController:dQ});function e$(){return{cueHandler:VQ,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function t$(i,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=iL(i),s=["manifest","level","frag"],r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return s.forEach(a=>{const o=`${a==="level"?"playlist":a}LoadPolicy`,l=e[o]===void 0,c=[];r.forEach(h=>{const d=`${a}Loading${h}`,m=e[d];if(m!==void 0&&l){c.push(d);const y=n[o].default;switch(e[o]={default:y},h){case"TimeOut":y.maxLoadTimeMs=m,y.maxTimeToFirstByteMs=m;break;case"MaxRetry":y.errorRetry.maxNumRetry=m,y.timeoutRetry.maxNumRetry=m;break;case"RetryDelay":y.errorRetry.retryDelayMs=m,y.timeoutRetry.retryDelayMs=m;break;case"MaxRetryTimeout":y.errorRetry.maxRetryDelayMs=m,y.timeoutRetry.maxRetryDelayMs=m;break}}}),c.length&&t.warn(`hls.js config: "${c.join('", "')}" setting(s) are deprecated, use "${o}": ${xs(e[o])}`)}),Pi(Pi({},n),e)}function iL(i){return i&&typeof i=="object"?Array.isArray(i)?i.map(iL):Object.keys(i).reduce((e,t)=>(e[t]=iL(i[t]),e),{}):i}function n$(i,e){const t=i.loader;t!==fU&&t!==lG?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),i.progressive=!1):YQ()&&(i.loader=fU,i.progressive=!0,i.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const RT=2,i$=.1,s$=.05,r$=100;class a$ extends lH{constructor(e,t){super("gap-controller",e.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var n;(n=this.media)!=null&&n.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var n;this.ended=((n=this.media)==null?void 0:n.currentTime)||1,this.hls.trigger(H.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(r$),this.mediaSource=t.mediaSource;const n=this.media=t.media;If(n,"playing",this.onMediaPlaying),If(n,"waiting",this.onMediaWaiting),If(n,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:n}=this;n&&(uh(n,"playing",this.onMediaPlaying),uh(n,"waiting",this.onMediaWaiting),uh(n,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var n,s;const r=(n=this.hls)==null?void 0:n.config;if(!r)return;const{media:a,stalled:o}=this;if(!a)return;const{seeking:l}=a,c=this.seeking&&!l,h=!this.seeking&&l,d=a.paused&&!l||a.ended||a.playbackRate===0;if(this.seeking=l,e!==t){t&&(this.ended=0),this.moved=!0,l||(this.nudgeRetry=0,r.nudgeOnVideoHole&&!d&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(h||c){c&&this.stallResolved(e);return}if(d){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&a.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(H.MEDIA_ENDED,{stalled:!1}));return}if(!Hn.getBuffered(a).length){this.nudgeRetry=0;return}const m=Hn.bufferInfo(a,e,0),y=m.nextStart||0,x=this.fragmentTracker;if(l&&x&&this.hls){const N=dU(this.hls.inFlightFragments,e),U=m.len>RT,P=!y||N||y-e>RT&&!x.getPartialFragment(e);if(U||P)return;this.moved=!1}const _=(s=this.hls)==null?void 0:s.latestLevelDetails;if(!this.moved&&this.stalled!==null&&x){if(!(m.len>0)&&!y)return;const U=Math.max(y,m.start||0)-e,B=!!(_!=null&&_.live)?_.targetduration*2:RT,L=x.getPartialFragment(e);if(U>0&&(U<=B||L)){a.paused||this._trySkipBufferHole(L);return}}const b=r.detectStallWithCurrentTimeMs,A=self.performance.now(),T=this.waiting;if(o===null){T>0&&A-T<b?this.stalled=T:this.stalled=A;return}const w=A-o;if(!l&&(w>=b||T)&&this.hls){var R;if(((R=this.mediaSource)==null?void 0:R.readyState)==="ended"&&!(_!=null&&_.live)&&Math.abs(e-((_==null?void 0:_.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(H.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(m),!this.media||!this.hls)return}const O=Hn.bufferInfo(a,e,r.maxBufferHole);this._tryFixBufferStall(O,w)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const n=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(n)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(H.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var n;const s=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(n=this.buffered.audio)!=null&&n.length&&s&&s.length>1&&e>s.end(0)){const r=Hn.bufferedInfo(Hn.timeRangesToArray(this.buffered.audio),e,0);if(r.len>1&&t>=r.start){const a=Hn.timeRangesToArray(s),o=Hn.bufferedInfo(a,t,0).bufferedIndex;if(o>-1&&o<a.length-1){const l=Hn.bufferedInfo(a,e,0).bufferedIndex,c=a[o].end,h=a[o+1].start;if((l===-1||l>o)&&h-c<1&&e-c<2){const d=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${c} -> ${h} buffered index: ${l}`);this.warn(d.message),this.media.currentTime+=1e-6;const m=this.fragmentTracker.getPartialFragment(e)||void 0,y=Hn.bufferInfo(this.media,e,0);this.hls.trigger(H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:d,reason:d.message,frag:m,buffer:y.len,bufferInfo:y})}}}}}_tryFixBufferStall(e,t){var n,s;const{fragmentTracker:r,media:a}=this,o=(n=this.hls)==null?void 0:n.config;if(!a||!r||!o)return;const l=a.currentTime,c=(s=this.hls)==null?void 0:s.latestLevelDetails,h=r.getPartialFragment(l);if((h||c!=null&&c.live&&l<c.fragmentStart)&&(this._trySkipBufferHole(h)||!this.media))return;const d=e.buffered;(d&&d.length>1&&e.len>o.maxBufferHole||e.nextStart&&e.nextStart-l<o.maxBufferHole)&&(t>o.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}_reportStall(e){const{hls:t,media:n,stallReported:s,stalled:r}=this;if(!s&&r!==null&&n&&t){this.stallReported=!0;const a=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${xs(e)})`);this.warn(a.message),t.trigger(H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.BUFFER_STALLED_ERROR,fatal:!1,error:a,buffer:e.len,bufferInfo:e,stalled:{start:r}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:n,media:s}=this,r=(t=this.hls)==null?void 0:t.config;if(!s||!n||!r)return 0;const a=s.currentTime,o=Hn.bufferInfo(s,a,0),l=a<o.start?o.start:o.nextStart;if(l&&this.hls){const h=o.len<=r.maxBufferHole,d=o.len>0&&o.len<1&&s.readyState<3,m=l-a;if(m>0&&(h||d)){if(m>r.maxBufferHole){let x=!1;if(a===0){const _=n.getAppendedFrag(0,Zt.MAIN);_&&l<_.end&&(x=!0)}if(!x){const _=e||n.getAppendedFrag(a,Zt.MAIN);if(_){var c;if(!((c=this.hls.loadLevelObj)!=null&&c.details)||dU(this.hls.inFlightFragments,l))return 0;let A=!1,T=_.end;for(;T<l;){const w=n.getPartialFragment(T);if(w)T+=w.duration;else{A=!0;break}}if(A)return 0}}}const y=Math.max(l+s$,a+i$);if(this.warn(`skipping hole, adjusting currentTime from ${a} to ${y}`),this.moved=!0,s.currentTime=y,!(e!=null&&e.gap)){const x=new Error(`fragment loaded with buffer holes, seeking from ${a} to ${y}`);this.hls.trigger(H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:x,reason:x.message,frag:e||void 0,buffer:o.len,bufferInfo:o})}return y}}return 0}_tryNudgeBuffer(e){const{hls:t,media:n,nudgeRetry:s}=this,r=t==null?void 0:t.config;if(!n||!r)return 0;const a=n.currentTime;if(this.nudgeRetry++,s<r.nudgeMaxRetry){const o=a+(s+1)*r.nudgeOffset,l=new Error(`Nudging 'currentTime' from ${a} to ${o}`);this.warn(l.message),n.currentTime=o,t.trigger(H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.BUFFER_NUDGE_ON_STALL,error:l,fatal:!1,buffer:e.len,bufferInfo:e})}else{const o=new Error(`Playhead still not moving while enough data buffered @${a} after ${r.nudgeMaxRetry} nudges`);this.error(o.message),t.trigger(H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.BUFFER_STALLED_ERROR,error:o,fatal:!0,buffer:e.len,bufferInfo:e})}}}function dU(i,e){const t=pU(i.main);if(t&&t.start<=e)return t;const n=pU(i.audio);return n&&n.start<=e?n:null}function pU(i){if(!i)return null;switch(i.state){case ht.IDLE:case ht.STOPPED:case ht.ENDED:case ht.ERROR:return null}return i.frag}const o$=.25;function sL(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function mU(i,e,t,n,s){let r=new i(e,t,"");try{r.value=n,s&&(r.type=s)}catch{r=new i(e,t,xs(s?Pi({type:s},n):n))}return r}const X_=(()=>{const i=sL();try{i&&new i(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function l$(i){return Uint8Array.from(i.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class c${constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(H.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e.on(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(H.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(H.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(H.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(H.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(e,t){var n;this.media=t.media,((n=t.overrides)==null?void 0:n.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){const e=this.hls.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&ly(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return QH(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:s}}}=this;if(!n&&!s)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=sL();if(a)for(let o=0;o<r.length;o++){const l=r[o].type;if(l===Zo.emsg&&!n||!s)continue;const c=DH(r[o].data);if(c){const h=r[o].pts;let d=h+r[o].duration;d>X_&&(d=X_),d-h<=0&&(d=h+o$);for(let y=0;y<c.length;y++){const x=c[y];if(!LH(x)){this.updateId3CueEnds(h,l);const _=mU(a,h,d,x,l);_&&this.id3Track.addCue(_)}}}}}updateId3CueEnds(e,t){var n;const s=(n=this.id3Track)==null?void 0:n.cues;if(s)for(let r=s.length;r--;){const a=s[r];a.type===t&&a.startTime<e&&a.endTime===X_&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:s}){const{id3Track:r,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(r&&(o||l)){let c;s==="audio"?c=h=>h.type===Zo.audioId3&&l:s==="video"?c=h=>h.type===Zo.emsg&&o:c=h=>h.type===Zo.audioId3&&l||h.type===Zo.emsg&&o,eL(r,t,n,c)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.media||!e.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{id3Track:n}=this,{dateRanges:s}=e,r=Object.keys(s);let a=this.dateRangeCuesAppended;if(n&&t){var o;if((o=n.cues)!=null&&o.length){const h=Object.keys(a).filter(d=>!r.includes(d));for(let d=h.length;d--;){const m=h[d],y=a[m].cues;delete a[m],Object.keys(y).forEach(x=>{try{const _=y[x];_.removeEventListener("enter",this.onEventCueEnter),n.removeCue(_)}catch{}})}}else a=this.dateRangeCuesAppended={}}const l=e.fragments[e.fragments.length-1];if(r.length===0||!Vt(l==null?void 0:l.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const c=sL();for(let h=0;h<r.length;h++){const d=r[h],m=s[d],y=m.startTime,x=a[d],_=(x==null?void 0:x.cues)||{};let b=(x==null?void 0:x.durationKnown)||!1,A=X_;const{duration:T,endDate:w}=m;if(w&&T!==null)A=y+T,b=!0;else if(m.endOnNext&&!b){const O=r.reduce((N,U)=>{if(U!==m.id){const P=s[U];if(P.class===m.class&&P.startDate>m.startDate&&(!N||m.startDate<N.startDate))return P}return N},null);O&&(A=O.startTime,b=!0)}const R=Object.keys(m.attr);for(let O=0;O<R.length;O++){const N=R[O];if(!HX(N))continue;const U=_[N];if(U)b&&!x.durationKnown?U.endTime=A:Math.abs(U.startTime-y)>.01&&(U.startTime=y,U.endTime=A);else if(c){let P=m.attr[N];GX(N)&&(P=l$(P));const L=mU(c,y,A,{key:N,data:P},Zo.dateRange);L&&(L.id=d,this.id3Track.addCue(L),_[N]=L,this.hls.config.interstitialsController&&(N==="X-ASSET-LIST"||N==="X-ASSET-URL")&&L.addEventListener("enter",this.onEventCueEnter))}}a[d]={cues:_,dateRange:m,durationKnown:b}}}}class u${constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,n=this.levelDetails;if(!t||!n)return;this.currentTime=t.currentTime;const s=this.computeLatency();if(s===null)return;this._latency=s;const{lowLatencyMode:r,maxLiveSyncPlaybackRate:a}=this.config;if(!r||a===1||!n.live)return;const o=this.targetLatency;if(o===null)return;const l=s-o,c=Math.min(this.maxLatency,o+n.targetduration);if(l<c&&l>.05&&this.forwardBufferLength>1){const d=Math.min(2,Math.max(1,a)),m=Math.round(2/(1+Math.exp(-.75*l-this.edgeStalled))*20)/20,y=Math.min(d,Math.max(1,m));this.changeMediaPlaybackRate(t,y)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:n,targetduration:s}=e,{liveSyncDuration:r,liveSyncDurationCount:a,lowLatencyMode:o}=this.config,l=this.hls.userConfig;let c=o&&n||t;(this._targetLatencyUpdated||l.liveSyncDuration||l.liveSyncDurationCount||c===0)&&(c=r!==void 0?r:a*s);const h=s;return c+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,h)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const n=this.levelDetails;if(n===null)return null;const s=n.edge,r=e-t-this.edgeStalled,a=s-n.totalduration,o=s-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(a,r),o)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(H.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(H.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var n;t.details===Pe.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(n=this.levelDetails)!=null&&n.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var n,s;e.playbackRate!==t&&((n=this.hls)==null||n.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(s=this.targetLatency)==null?void 0:s.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class h$ extends nB{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(H.LEVEL_LOADED,this.onLevelLoaded,this),e.on(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(H.FRAG_BUFFERED,this.onFragBuffered,this),e.on(H.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(H.LEVEL_LOADED,this.onLevelLoaded,this),e.off(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(H.FRAG_BUFFERED,this.onFragBuffered,this),e.off(H.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,s=[],r={},a={};let o=!1,l=!1,c=!1;t.levels.forEach(h=>{var d;const m=h.attrs;let{audioCodec:y,videoCodec:x}=h;y&&(h.audioCodec=y=ZT(y,n)||void 0),((d=x)==null?void 0:d.indexOf("avc1"))===0&&(x=h.videoCodec=oX(x));const{width:_,height:b,unknownCodecs:A}=h;let T=A?A.length:0;if(A)for(let F=T;F--;){const j=A[F];this.isAudioSupported(j)?(h.audioCodec=y=y?`${y},${j}`:j,T--,gv.audio[y.substring(0,4)]=2):this.isVideoSupported(j)&&(h.videoCodec=x=x?`${x},${j}`:j,T--,gv.video[x.substring(0,4)]=2)}if(o||(o=!!(_&&b)),l||(l=!!x),c||(c=!!y),T||y&&!this.isAudioSupported(y)||x&&!this.isVideoSupported(x)){this.log(`Some or all CODECS not supported "${m.CODECS}"`);return}const{CODECS:w,"FRAME-RATE":R,"HDCP-LEVEL":O,"PATHWAY-ID":N,RESOLUTION:U,"VIDEO-RANGE":P}=m,L=`${`${N||"."}-`}${h.bitrate}-${U}-${R}-${w}-${P}-${O}`;if(r[L])if(r[L].uri!==h.url&&!h.attrs["PATHWAY-ID"]){const F=a[L]+=1;h.attrs["PATHWAY-ID"]=new Array(F+1).join(".");const j=this.createLevel(h);r[L]=j,s.push(j)}else r[L].addGroupId("audio",m.AUDIO),r[L].addGroupId("text",m.SUBTITLES);else{const F=this.createLevel(h);r[L]=F,a[L]=1,s.push(F)}}),this.filterAndSortMediaOptions(s,t,o,l,c)}createLevel(e){const t=new IA(e),n=e.supplemental;if(n!=null&&n.videoCodec&&!this.isVideoSupported(n.videoCodec)){const s=new Error(`SUPPLEMENTAL-CODECS not supported "${n.videoCodec}"`);this.log(s.message),t.supportedResult=sH(s,[])}return t}isAudioSupported(e){return VD(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return VD(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,n,s,r){let a=[],o=[],l=e;if((n||s)&&r&&(l=l.filter(({videoCodec:b,videoRange:A,width:T,height:w})=>(!!b||!!(T&&w))&&fX(A))),l.length===0){Promise.resolve().then(()=>{if(this.hls){let b="no level with compatible codecs found in manifest",A=b;t.levels.length&&(A=`one or more CODECS in variant not supported: ${xs(t.levels.map(w=>w.attrs.CODECS).filter((w,R,O)=>O.indexOf(w)===R))}`,this.warn(A),b+=` (${A})`);const T=new Error(b);this.hls.trigger(H.ERROR,{type:nn.MEDIA_ERROR,details:Pe.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:T,reason:A})}});return}t.audioTracks&&(a=t.audioTracks.filter(b=>!b.audioCodec||this.isAudioSupported(b.audioCodec)),gU(a)),t.subtitles&&(o=t.subtitles,gU(o));const c=l.slice(0);l.sort((b,A)=>{if(b.attrs["HDCP-LEVEL"]!==A.attrs["HDCP-LEVEL"])return(b.attrs["HDCP-LEVEL"]||"")>(A.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&b.height!==A.height)return b.height-A.height;if(b.frameRate!==A.frameRate)return b.frameRate-A.frameRate;if(b.videoRange!==A.videoRange)return e3.indexOf(b.videoRange)-e3.indexOf(A.videoRange);if(b.videoCodec!==A.videoCodec){const T=cN(b.videoCodec),w=cN(A.videoCodec);if(T!==w)return w-T}if(b.uri===A.uri&&b.codecSet!==A.codecSet){const T=JT(b.codecSet),w=JT(A.codecSet);if(T!==w)return w-T}return b.averageBitrate!==A.averageBitrate?b.averageBitrate-A.averageBitrate:0});let h=c[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==c.length)){for(let b=0;b<c.length;b++)if(c[b].pathwayId===l[0].pathwayId){h=c[b];break}}this._levels=l;for(let b=0;b<l.length;b++)if(l[b]===h){var d;this._firstLevel=b;const A=h.bitrate,T=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${A}`),((d=this.hls.userConfig)==null?void 0:d.abrEwmaDefaultEstimate)===void 0){const w=Math.min(A,this.hls.config.abrEwmaDefaultEstimateMax);w>T&&T===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=w)}break}const m=r&&!s,y=this.hls.config,x=!!(y.audioStreamController&&y.audioTrackController),_={levels:l,audioTracks:a,subtitleTracks:o,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:r,video:s,altAudio:x&&!m&&a.some(b=>!!b.url)};this.hls.trigger(H.MANIFEST_PARSED,_)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const h=new Error("invalid level idx"),d=e<0;if(this.hls.trigger(H.ERROR,{type:nn.OTHER_ERROR,details:Pe.LEVEL_SWITCH_ERROR,level:e,fatal:d,error:h,reason:h.message}),d)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,s=this.currentLevel,r=s?s.attrs["PATHWAY-ID"]:void 0,a=t[e],o=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,n===e&&s&&r===o)return;this.log(`Switching to level ${e} (${a.height?a.height+"p ":""}${a.videoRange?a.videoRange+" ":""}${a.codecSet?a.codecSet+" ":""}@${a.bitrate})${o?" with Pathway "+o:""} from level ${n}${r?" with Pathway "+r:""}`);const l={level:e,attrs:a.attrs,details:a.details,bitrate:a.bitrate,averageBitrate:a.averageBitrate,maxBitrate:a.maxBitrate,realBitrate:a.realBitrate,width:a.width,height:a.height,codecSet:a.codecSet,audioCodec:a.audioCodec,videoCodec:a.videoCodec,audioGroups:a.audioGroups,subtitleGroups:a.subtitleGroups,loaded:a.loaded,loadError:a.loadError,fragmentError:a.fragmentError,name:a.name,id:a.id,uri:a.uri,url:a.url,urlId:0,audioGroupIds:a.audioGroupIds,textGroupIds:a.textGroupIds};this.hls.trigger(H.LEVEL_SWITCHING,l);const c=a.details;if(!c||c.live){const h=this.switchParams(a.uri,s==null?void 0:s.details,c);this.loadPlaylist(h)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),n=e.filter(s=>t.indexOf(s)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=n}}onError(e,t){t.fatal||!t.context||t.context.type===$n.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===Zt.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(r=>!!n[r]))return;const s=this._levels[t.level];s!=null&&s.loadError&&(this.log(`Resetting level error count of ${s.loadError} on frag buffered`),s.loadError=0)}}onLevelLoaded(e,t){var n;const{level:s,details:r}=t,a=t.levelInfo;if(!a){var o;this.warn(`Invalid level index ${s}`),(o=t.deliveryDirectives)!=null&&o.skip&&(r.deltaUpdateFailed=!0);return}if(a===this.currentLevel||t.withoutMultiVariant){a.fragmentError===0&&(a.loadError=0);let l=a.details;l===t.details&&l.advanced&&(l=void 0),this.playlistLoaded(s,t,l)}else(n=t.deliveryDirectives)!=null&&n.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=this.getUrlWithDirectives(e.uri,t),s=this.currentLevelIndex,r=e.attrs["PATHWAY-ID"],a=e.details,o=a==null?void 0:a.age;this.log(`Loading level index ${s}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${r?" Pathway "+r:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${n}`),this.hls.trigger(H.LEVEL_LOADING,{url:n,level:s,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const n=this._levels.filter((r,a)=>a!==e?!0:(this.steering&&this.steering.removeLevel(r),r===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,r.details&&r.details.fragments.forEach(o=>o.level=-1)),!1));xH(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const s=n.length-1;this._firstLevel=Math.min(this._firstLevel,s),this._startLevel&&(this._startLevel=Math.min(this._startLevel,s)),this.hls.trigger(H.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(H.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function gU(i){const e={};i.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}function cG(){return self.SourceBuffer||self.WebKitSourceBuffer}function uG(){if(!L0())return!1;const e=cG();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function f$(){if(!uG())return!1;const i=L0();return typeof(i==null?void 0:i.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>i.isTypeSupported(LA(e,"video")))||["mp4a.40.2","fLaC"].some(e=>i.isTypeSupported(LA(e,"audio"))))}function d$(){var i;const e=cG();return typeof(e==null||(i=e.prototype)==null?void 0:i.changeType)=="function"}const p$=100;class m$ extends jI{constructor(e,t,n){super(e,t,n,"stream-controller",Zt.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const s=this.media,r=s?s.currentTime:null;if(r===null||!Vt(r)||(this.log(`Media seeked to ${r.toFixed(3)}`),!this.getBufferedFrag(r)))return;const a=this.getFwdBufferInfoAtPos(s,r,Zt.MAIN,0);if(a===null||a.len===0){this.warn(`Main forward buffer length at ${r} on "seeked" event ${a?a.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(H.MANIFEST_PARSED,this.onManifestParsed,this),e.on(H.LEVEL_LOADING,this.onLevelLoading,this),e.on(H.LEVEL_LOADED,this.onLevelLoaded,this),e.on(H.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(H.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(H.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(H.BUFFER_CREATED,this.onBufferCreated,this),e.on(H.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(H.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(H.MANIFEST_PARSED,this.onManifestParsed,this),e.off(H.LEVEL_LOADED,this.onLevelLoaded,this),e.off(H.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(H.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(H.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(H.BUFFER_CREATED,this.onBufferCreated,this),e.off(H.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(H.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:n,hls:s}=this;if(this.stopLoad(),this.setInterval(p$),this.level=-1,!this.startFragRequested){let r=s.startLevel;r===-1&&(s.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=s.firstAutoLevel),s.nextLoadLevel=r,this.level=s.loadLevel,this._hasEnoughToStart=!!t}n>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n),this.state=ht.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=ht.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case ht.WAITING_LEVEL:{const{levels:t,level:n}=this,s=t==null?void 0:t[n],r=s==null?void 0:s.details;if(r&&(!r.live||this.levelLastLoaded===s&&!this.waitForLive(s))){if(this.waitForCdnTuneIn(r))break;this.state=ht.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=ht.IDLE;break}break}case ht.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||(e=this.media)!=null&&e.seeking){const{levels:s,level:r}=this,a=s==null?void 0:s[r];this.resetStartWhenNotLoaded(a||null),this.state=ht.IDLE}}break}this.state===ht.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:s}=this;if(t===null||!s&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const r=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(n!=null&&n[r]))return;const a=n[r],o=this.getMainFwdBufferInfo();if(o===null)return;const l=this.getLevelDetails();if(l&&this._streamEnded(o,l)){const _={};this.altAudio===2&&(_.type="video"),this.hls.trigger(H.BUFFER_EOS,_),this.state=ht.ENDED;return}if(!this.buffering)return;e.loadLevel!==r&&e.manualLevel===-1&&this.log(`Adapting to level ${r} from level ${this.level}`),this.level=e.nextLoadLevel=r;const c=a.details;if(!c||this.state===ht.WAITING_LEVEL||this.waitForLive(a)){this.level=r,this.state=ht.WAITING_LEVEL,this.startFragRequested=!1;return}const h=o.len,d=this.getMaxBufferLength(a.maxBitrate);if(h>=d)return;this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);const m=this.backtrackFragment?this.backtrackFragment.start:o.end;let y=this.getNextFragment(m,c);if(this.couldBacktrack&&!this.fragPrevious&&y&&zr(y)&&this.fragmentTracker.getState(y)!==Tr.OK){var x;const b=((x=this.backtrackFragment)!=null?x:y).sn-c.startSN,A=c.fragments[b-1];A&&y.cc===A.cc&&(y=A,this.fragmentTracker.removeFragment(A))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(y&&this.isLoopLoading(y,m)){if(!y.gap){const b=this.audioOnly&&!this.altAudio?Vi.AUDIO:Vi.VIDEO,A=(b===Vi.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;A&&this.afterBufferFlushed(A,b,Zt.MAIN)}y=this.getNextFragmentLoopLoading(y,c,o,Zt.MAIN,d)}y&&(y.initSegment&&!y.initSegment.data&&!this.bitrateTest&&(y=y.initSegment),this.loadFragment(y,a,m))}loadFragment(e,t,n){const s=this.fragmentTracker.getState(e);s===Tr.NOT_LOADED||s===Tr.PARTIAL?zr(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,n):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Zt.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const s=this.getAppendedFrag(t.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);const r=this.getLevelDetails();if(r!=null&&r.live){const o=this.getMainFwdBufferInfo();if(!o||o.len<r.targetduration*2)return}if(!t.paused&&e){const o=this.hls.nextLoadLevel,l=e[o],c=this.fragLastKbps;c&&this.fragCurrent?n=this.fragCurrent.duration*l.maxBitrate/(1e3*c)+1:n=0}else n=0;const a=this.getBufferedFrag(t.currentTime+n);if(a){const o=this.followingBufferedFrag(a);if(o){this.abortCurrentFrag();const l=o.maxStartPTS?o.maxStartPTS:o.start,c=o.duration,h=Math.max(a.end,l+Math.min(Math.max(c-this.config.maxFragLookUpTolerance,c*(this.couldBacktrack?.5:.125)),c*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(h,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case ht.KEY_LOADING:case ht.FRAG_LOADING:case ht.FRAG_LOADING_WAITING_RETRY:case ht.PARSING:case ht.PARSED:this.state=ht.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;If(n,"playing",this.onMediaPlaying),If(n,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:n}=this;n&&(uh(n,"playing",this.onMediaPlaying),uh(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(H.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let n=!1,s=!1;t.levels.forEach(r=>{const a=r.audioCodec;a&&(n=n||a.indexOf("mp4a.40.2")!==-1,s=s||a.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=n&&s&&!d$(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==ht.IDLE)return;const s=t.levelInfo;(!s.details||s.details.live&&(this.levelLastLoaded!==s||s.details.expired)||this.waitForCdnTuneIn(s.details))&&(this.state=ht.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:s,startFragRequested:r}=this,a=t.level,o=t.details,l=o.totalduration;if(!s){this.warn(`Levels were reset while loading level ${a}`);return}this.log(`Level ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${l}`);const c=t.levelInfo,h=this.fragCurrent;h&&(this.state===ht.FRAG_LOADING||this.state===ht.FRAG_LOADING_WAITING_RETRY)&&h.level!==t.level&&h.loader&&this.abortCurrentFrag();let d=0;if(o.live||(n=c.details)!=null&&n.live){var m;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;d=this.alignPlaylists(o,c.details,(m=this.levelLastLoaded)==null?void 0:m.details)}if(c.details=o,this.levelLastLoaded=c,r||this.setStartPosition(o,d),this.hls.trigger(H.LEVEL_UPDATED,{details:o,level:a}),this.state===ht.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=ht.IDLE}r&&o.live&&this.synchronizeToLiveEdge(o),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const s=this.hls.liveSyncPosition,r=this.getLoadPosition(),a=e.fragmentStart,o=e.edge,l=r>=a-t.maxFragLookUpTolerance&&r<=o;if(s!==null&&n.duration>s&&(r<s||!l)){const c=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!l&&n.readyState<4||r<o-c)&&(this._hasEnoughToStart||(this.nextLoadPosition=s),n.readyState&&(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${s.toFixed(3)}`),n.currentTime=s))}}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:s,payload:r}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const o=a[n.level];if(!o){this.warn(`Level ${n.level} not found on progress`);return}const l=o.details;if(!l){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const c=o.videoCodec,h=l.PTSKnown||!l.live,d=(t=n.initSegment)==null?void 0:t.data,m=this._getAudioCodec(o),y=this.transmuxer=this.transmuxer||new zH(this.hls,Zt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),x=s?s.index:-1,_=x!==-1,b=new KI(n.level,n.sn,n.stats.chunkCount,r.byteLength,x,_),A=this.initPTS[n.cc];y.push(r,d,m,c,n,s,l.totalduration,h,b,A)}onAudioTrackSwitching(e,t){const n=this.hls,s=this.altAudio===2;if(t3(t.url,n))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(s){this.fragmentTracker.removeAllFragments(),n.once(H.BUFFER_FLUSHED,()=>{var a;(a=this.hls)==null||a.trigger(H.AUDIO_TRACK_SWITCHED,t)}),n.trigger(H.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}n.trigger(H.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t3(t.url,this.hls);if(n){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=n?2:0,this.tick()}onBufferCreated(e,t){const n=t.tracks;let s,r,a=!1;for(const o in n){const l=n[o];if(l.id==="main"){if(r=o,s=l,o==="video"){const c=n[o];c&&(this.videoBuffer=c.buffer)}}else a=!0}a&&s?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:s}=t,r=n.type===Zt.MAIN;if(r){if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${s?" p: "+s.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===ht.PARSED&&(this.state=ht.IDLE);return}const o=s?s.stats:n.stats;this.fragLastKbps=Math.round(8*o.total/(o.buffering.end-o.loading.first)),zr(n)&&(this.fragPrevious=n),this.fragBufferedComplete(n,s)}const a=this.media;a&&(!this._hasEnoughToStart&&Hn.getBuffered(a).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),r&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var n;if(t.fatal){this.state=ht.ERROR;return}switch(t.details){case Pe.FRAG_GAP:case Pe.FRAG_PARSING_ERROR:case Pe.FRAG_DECRYPT_ERROR:case Pe.FRAG_LOAD_ERROR:case Pe.FRAG_LOAD_TIMEOUT:case Pe.KEY_LOAD_ERROR:case Pe.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Zt.MAIN,t);break;case Pe.LEVEL_LOAD_ERROR:case Pe.LEVEL_LOAD_TIMEOUT:case Pe.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ht.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===$n.LEVEL&&(this.state=ht.IDLE);break;case Pe.BUFFER_ADD_CODEC_ERROR:case Pe.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.resetLoadingState();break;case Pe.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case Pe.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=ht.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==Vi.AUDIO||!this.altAudio){const n=(t===Vi.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;n&&(this.afterBufferFlushed(n,t,Zt.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const s=this.timelineOffset;s&&n&&(n+=s);const r=this.getLevelDetails(),a=Hn.getBuffered(e),o=a.length?a.start(0):0,l=o-n,c=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);l>0&&(l<c||this.loadingParts&&l<2*((r==null?void 0:r.partTarget)||0))&&(this.log(`adjusting start position by ${l} to match buffer start`),n+=l,this.startPosition=n),t<n&&(this.log(`seek to target start position ${n} from current time ${t} buffer start ${o}`),e.currentTime=n)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:s}=this,r=n==null?void 0:n.frag;if(!r||this.fragContextChanged(r))return;t.fragmentError=0,this.state=ht.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const a=r.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),s.trigger(H.FRAG_LOADED,n),r.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n=this.playlistType,{hls:s}=this,{remuxResult:r,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:c,level:h}=o,{video:d,text:m,id3:y,initSegment:x}=r,{details:_}=h,b=this.altAudio?void 0:r.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=ht.PARSING,x){if(x!=null&&x.tracks){const w=l.initSegment||l;this._bufferInitSegment(h,x.tracks,w,a),s.trigger(H.FRAG_PARSING_INIT_SEGMENT,{frag:w,id:n,tracks:x.tracks})}const A=x.initPTS,T=x.timescale;Vt(A)&&(this.initPTS[l.cc]={baseTime:A,timescale:T},s.trigger(H.INIT_PTS_FOUND,{frag:l,id:n,initPTS:A,timescale:T}))}if(d&&_){b&&d.type==="audiovideo"&&this.logMuxedErr(l);const A=_.fragments[l.sn-1-_.startSN],T=l.sn===_.startSN,w=!A||l.cc>A.cc;if(r.independent!==!1){const{startPTS:R,endPTS:O,startDTS:N,endDTS:U}=d;if(c)c.elementaryStreams[d.type]={startPTS:R,endPTS:O,startDTS:N,endDTS:U};else if(d.firstKeyFrame&&d.independent&&a.id===1&&!w&&(this.couldBacktrack=!0),d.dropped&&d.independent){const P=this.getMainFwdBufferInfo(),B=(P?P.end:this.getLoadPosition())+this.config.maxBufferHole,L=d.firstKeyFramePTS?d.firstKeyFramePTS:R;if(!T&&B<L-this.config.maxBufferHole&&!w){this.backtrack(l);return}else w&&(l.gap=!0);l.setElementaryStreamInfo(d.type,l.start,O,l.start,U,!0)}else T&&R-(_.appliedTimelineOffset||0)>RT&&(l.gap=!0);l.setElementaryStreamInfo(d.type,R,O,N,U),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(d,l,c,a,T||w)}else if(T||w)l.gap=!0;else{this.backtrack(l);return}}if(b){const{startPTS:A,endPTS:T,startDTS:w,endDTS:R}=b;c&&(c.elementaryStreams[Vi.AUDIO]={startPTS:A,endPTS:T,startDTS:w,endDTS:R}),l.setElementaryStreamInfo(Vi.AUDIO,A,T,w,R),this.bufferFragmentData(b,l,c,a)}if(_&&y!=null&&(t=y.samples)!=null&&t.length){const A={id:n,frag:l,details:_,samples:y.samples};s.trigger(H.FRAG_PARSING_METADATA,A)}if(_&&m){const A={id:n,frag:l,details:_,samples:m.samples};s.trigger(H.FRAG_PARSING_USERDATA,A)}}logMuxedErr(e){this.warn(`${zr(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,n,s){if(this.state!==ht.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(n));const{audio:r,video:a,audiovideo:o}=t;if(r){let c=_T(r.codec,e.audioCodec);c==="mp4a"&&(c="mp4a.40.5");const h=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){c&&(c.indexOf("mp4a.40.5")!==-1?c="mp4a.40.2":c="mp4a.40.5");const d=r.metadata;d&&"channelCount"in d&&(d.channelCount||1)!==1&&h.indexOf("firefox")===-1&&(c="mp4a.40.5")}c&&c.indexOf("mp4a.40.5")!==-1&&h.indexOf("android")!==-1&&r.container!=="audio/mpeg"&&(c="mp4a.40.2",this.log(`Android: force audio codec to ${c}`)),e.audioCodec&&e.audioCodec!==c&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${c}"`),r.levelCodec=c,r.id=Zt.MAIN,this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${c||""}/${e.audioCodec||""}/${r.codec}]`),delete t.audiovideo}if(a){a.levelCodec=e.videoCodec,a.id=Zt.MAIN;const c=a.codec;if((c==null?void 0:c.length)===4)switch(c){case"hvc1":case"hev1":a.codec="hvc1.1.6.L120.90";break;case"av01":a.codec="av01.0.04M.08";break;case"avc1":a.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${c}]${a.codec!==c?" parsed-corrected="+a.codec:""}${a.supplemental?" supplemental="+a.supplemental:""}`),delete t.audiovideo}o&&(this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.codecs}/${o.codec}]`),delete t.video,delete t.audio);const l=Object.keys(t);if(l.length){if(this.hls.trigger(H.BUFFER_CODECS,t),!this.hls)return;l.forEach(c=>{const d=t[c].initSegment;d!=null&&d.byteLength&&this.hls.trigger(H.BUFFER_APPENDING,{type:c,data:d,frag:n,part:null,chunkMeta:s,parent:n.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,Zt.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,n=e==null?void 0:e[t];return n?this.getMaxBufferLength(n.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=ht.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(Hn.isBuffered(e,n)?t=this.getAppendedFrag(n):Hn.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const s=this.fragPlaying,r=t.level;(!s||t.sn!==s.sn||s.level!==r)&&(this.fragPlaying=t,this.hls.trigger(H.FRAG_CHANGED,{frag:t}),(!s||s.level!==r)&&this.hls.trigger(H.LEVEL_SWITCHED,{level:r}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return Vt(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(Vt(t)){const n=this.getLevelDetails(),s=this.currentFrag||(n?ig(null,n.fragments,t):null);if(s){const r=s.programDateTime;if(r!==null){const a=r+(t-s.start)*1e3;return new Date(a)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class g${constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const s=this.keyUriToKeyInfo[n].loader;if(s){var t;if(e&&e!==((t=s.context)==null?void 0:t.frag.type))return;s.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=Pe.KEY_LOAD_ERROR,n,s,r){return new lf({type:nn.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:n,networkDetails:s})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:s}=e;for(let r=0;r<t.length;r++){const a=t[r];if(s<=a.cc&&(n==="initSegment"||a.sn==="initSegment"||n<a.sn)){this.emeController.selectKeySystemFormat(a).then(o=>{a.setKeyFormat(o)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,s;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const c=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,Pe.KEY_LOAD_ERROR,c))}const a=r.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,Pe.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));let o=this.keyUriToKeyInfo[a];if((n=o)!=null&&n.decryptdata.key)return r.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if((s=o)!=null&&s.keyLoadPromise){var l;switch((l=o.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then(c=>(r.key=c.keyInfo.decryptdata.key,{frag:e,keyInfo:o}))}}switch(o=this.keyUriToKeyInfo[a]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return r.keyFormat==="identity"?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,Pe.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const s=this.emeController.loadKey(n);if(s)return(e.keyLoadPromise=s.then(r=>(e.mediaKeySessionContext=r,n))).catch(r=>{throw e.keyLoadPromise=null,r})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,s=n.loader,r=new s(n);return t.keyLoader=e.loader=r,e.keyLoadPromise=new Promise((a,o)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},c=n.keyLoadPolicy.default,h={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(m,y,x,_)=>{const{frag:b,keyInfo:A,url:T}=x;if(!b.decryptdata||A!==this.keyUriToKeyInfo[T])return o(this.createKeyLoadError(b,Pe.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),_));A.decryptdata.key=b.decryptdata.key=new Uint8Array(m.data),b.keyLoader=null,A.loader=null,a({frag:b,keyInfo:A})},onError:(m,y,x,_)=>{this.resetLoader(y),o(this.createKeyLoadError(t,Pe.KEY_LOAD_ERROR,new Error(`HTTP Error ${m.code} loading key ${m.text}`),x,Pi({url:l.url,data:void 0},m)))},onTimeout:(m,y,x)=>{this.resetLoader(y),o(this.createKeyLoadError(t,Pe.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),x))},onAbort:(m,y,x)=>{this.resetLoader(y),o(this.createKeyLoadError(t,Pe.INTERNAL_ABORTED,new Error("key loading aborted"),x))}};r.load(l,h,d)})}resetLoader(e){const{frag:t,keyInfo:n,url:s}=e,r=n.loader;t.keyLoader===r&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[s],r&&r.destroy()}}function yU(i){const{type:e}=i;switch(e){case $n.AUDIO_TRACK:return Zt.AUDIO;case $n.SUBTITLE_TRACK:return Zt.SUBTITLE;default:return Zt.MAIN}}function QC(i,e){let t=i.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class y${constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.LEVEL_LOADING,this.onLevelLoading,this),e.on(H.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(H.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(H.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.LEVEL_LOADING,this.onLevelLoading,this),e.off(H.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(H.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(H.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,s=t.loader,r=n||s,a=new r(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:$n.MANIFEST,url:n,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:n,level:s,pathwayId:r,url:a,deliveryDirectives:o,levelInfo:l}=t;this.load({id:n,level:s,pathwayId:r,responseType:"text",type:$n.LEVEL,url:a,deliveryDirectives:o,levelOrTrack:l})}onAudioTrackLoading(e,t){const{id:n,groupId:s,url:r,deliveryDirectives:a,track:o}=t;this.load({id:n,groupId:s,level:null,responseType:"text",type:$n.AUDIO_TRACK,url:r,deliveryDirectives:a,levelOrTrack:o})}onSubtitleTrackLoading(e,t){const{id:n,groupId:s,url:r,deliveryDirectives:a,track:o}=t;this.load({id:n,groupId:s,level:null,responseType:"text",type:$n.SUBTITLE_TRACK,url:r,deliveryDirectives:a,levelOrTrack:o})}onLevelsUpdated(e,t){const n=this.loaders[$n.LEVEL];if(n){const s=n.context;s&&!t.levels.some(r=>r===s.levelOrTrack)&&(n.abort(),delete this.loaders[$n.LEVEL])}}load(e){var t;const n=this.hls.config;let s=this.getInternalLoader(e);if(s){const c=this.hls.logger,h=s.context;if(h&&h.levelOrTrack===e.levelOrTrack&&(h.url===e.url||h.deliveryDirectives&&!e.deliveryDirectives)){h.url===e.url?c.log(`[playlist-loader]: ignore ${e.url} ongoing request`):c.log(`[playlist-loader]: ignore ${e.url} in favor of ${h.url}`);return}c.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),s.abort()}let r;if(e.type===$n.MANIFEST?r=n.manifestLoadPolicy.default:r=Yi({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(e),Vt((t=e.deliveryDirectives)==null?void 0:t.part)){let c;if(e.type===$n.LEVEL&&e.level!==null?c=this.hls.levels[e.level].details:e.type===$n.AUDIO_TRACK&&e.id!==null?c=this.hls.audioTracks[e.id].details:e.type===$n.SUBTITLE_TRACK&&e.id!==null&&(c=this.hls.subtitleTracks[e.id].details),c){const h=c.partTarget,d=c.targetduration;if(h&&d){const m=Math.max(h*3,d*.8)*1e3;r=Yi({},r,{maxTimeToFirstByteMs:Math.min(m,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(m,r.maxTimeToFirstByteMs)})}}}const a=r.errorRetry||r.timeoutRetry||{},o={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(c,h,d,m)=>{const y=this.getInternalLoader(d);this.resetInternalLoader(d.type);const x=c.data;if(x.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(c,d,new Error("no EXTM3U delimiter"),m||null,h);return}h.parsing.start=performance.now(),ch.isMediaPlaylist(x)||d.type!==$n.MANIFEST?this.handleTrackOrLevelPlaylist(c,h,d,m||null,y):this.handleMasterPlaylist(c,h,d,m)},onError:(c,h,d,m)=>{this.handleNetworkError(h,d,!1,c,m)},onTimeout:(c,h,d)=>{this.handleNetworkError(h,d,!0,void 0,c)}};s.load(e,o,l)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:n}=this.hls;(e||n)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,n,s){const r=this.hls,a=e.data,o=QC(e,n),l=ch.parseMasterPlaylist(a,o);if(l.playlistParsingError){this.handleManifestParsingError(e,n,l.playlistParsingError,s,t);return}const{contentSteering:c,levels:h,sessionData:d,sessionKeys:m,startTimeOffset:y,variableList:x}=l;this.variableList=x;const{AUDIO:_=[],SUBTITLES:b,"CLOSED-CAPTIONS":A}=ch.parseMasterPlaylistMedia(a,o,l);_.length&&!_.some(w=>!w.url)&&h[0].audioCodec&&!h[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),_.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Cs({}),bitrate:0,url:""})),r.trigger(H.MANIFEST_LOADED,{levels:h,audioTracks:_,subtitles:b,captions:A,contentSteering:c,url:o,stats:t,networkDetails:s,sessionData:d,sessionKeys:m,startTimeOffset:y,variableList:x})}handleTrackOrLevelPlaylist(e,t,n,s,r){const a=this.hls,{id:o,level:l,type:c}=n,h=QC(e,n),d=Vt(l)?l:Vt(o)?o:0,m=yU(n),y=ch.parseLevelPlaylist(e.data,h,d,m,0,this.variableList);if(c===$n.MANIFEST){const x={attrs:new Cs({}),bitrate:0,details:y,name:"",url:h};y.requestScheduled=t.loading.start+gH(y,0),a.trigger(H.MANIFEST_LOADED,{levels:[x],audioTracks:[],url:h,stats:t,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=y,this.handlePlaylistLoaded(y,e,t,n,s,r)}handleManifestParsingError(e,t,n,s,r){this.hls.trigger(H.ERROR,{type:nn.NETWORK_ERROR,details:Pe.MANIFEST_PARSING_ERROR,fatal:t.type===$n.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:s,stats:r})}handleNetworkError(e,t,n=!1,s,r){let a=`A network ${n?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${e.type}`;e.type===$n.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===$n.AUDIO_TRACK||e.type===$n.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);const o=new Error(a);this.hls.logger.warn(`[playlist-loader]: ${a}`);let l=Pe.UNKNOWN,c=!1;const h=this.getInternalLoader(e);switch(e.type){case $n.MANIFEST:l=n?Pe.MANIFEST_LOAD_TIMEOUT:Pe.MANIFEST_LOAD_ERROR,c=!0;break;case $n.LEVEL:l=n?Pe.LEVEL_LOAD_TIMEOUT:Pe.LEVEL_LOAD_ERROR,c=!1;break;case $n.AUDIO_TRACK:l=n?Pe.AUDIO_TRACK_LOAD_TIMEOUT:Pe.AUDIO_TRACK_LOAD_ERROR,c=!1;break;case $n.SUBTITLE_TRACK:l=n?Pe.SUBTITLE_TRACK_LOAD_TIMEOUT:Pe.SUBTITLE_LOAD_ERROR,c=!1;break}h&&this.resetInternalLoader(e.type);const d={type:nn.NETWORK_ERROR,details:l,fatal:c,url:e.url,loader:h,context:e,error:o,networkDetails:t,stats:r};if(s){const m=(t==null?void 0:t.url)||e.url;d.response=Pi({url:m,data:void 0},s)}this.hls.trigger(H.ERROR,d)}handlePlaylistLoaded(e,t,n,s,r,a){const o=this.hls,{type:l,level:c,id:h,groupId:d,deliveryDirectives:m}=s,y=QC(t,s),x=yU(s),_=typeof s.level=="number"&&x===Zt.MAIN?c:void 0;if(!e.fragments.length){const A=e.playlistParsingError=new Error("No Segments found in Playlist");o.trigger(H.ERROR,{type:nn.NETWORK_ERROR,details:Pe.LEVEL_EMPTY_ERROR,fatal:!1,url:y,error:A,reason:A.message,response:t,context:s,level:_,parent:x,networkDetails:r,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const b=e.playlistParsingError;if(b){if(this.hls.logger.warn(b),!o.config.ignorePlaylistParsingErrors){o.trigger(H.ERROR,{type:nn.NETWORK_ERROR,details:Pe.LEVEL_PARSING_ERROR,fatal:!1,url:y,error:b,reason:b.message,response:t,context:s,level:_,parent:x,networkDetails:r,stats:n});return}e.playlistParsingError=null}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case $n.MANIFEST:case $n.LEVEL:o.trigger(H.LEVEL_LOADED,{details:e,levelInfo:s.levelOrTrack||o.levels[0],level:_||0,id:h||0,stats:n,networkDetails:r,deliveryDirectives:m,withoutMultiVariant:l===$n.MANIFEST});break;case $n.AUDIO_TRACK:o.trigger(H.AUDIO_TRACK_LOADED,{details:e,track:s.levelOrTrack,id:h||0,groupId:d||"",stats:n,networkDetails:r,deliveryDirectives:m});break;case $n.SUBTITLE_TRACK:o.trigger(H.SUBTITLE_TRACK_LOADED,{details:e,track:s.levelOrTrack,id:h||0,groupId:d||"",stats:n,networkDetails:r,deliveryDirectives:m});break}}}class Rf{static get version(){return PA}static isMSESupported(){return uG()}static isSupported(){return f$()}static getMediaSource(){return L0()}static get Events(){return H}static get MetadataSchema(){return Zo}static get ErrorTypes(){return nn}static get ErrorDetails(){return Pe}static get DefaultConfig(){return Rf.defaultConfig?Rf.defaultConfig:ZQ}static set DefaultConfig(e){Rf.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new qI,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=NW(e.debug||!1,"Hls instance",e.assetPlayerId),n=this.config=t$(Rf.DefaultConfig,e,t);this.userConfig=e,n.progressive&&n$(n,t);const{abrController:s,bufferController:r,capLevelController:a,errorController:o,fpsController:l}=n,c=new o(this),h=this.abrController=new s(this),d=new CX(this),m=n.interstitialsController,y=m?this.interstitialsController=new m(this,Rf):null,x=this.bufferController=new r(this,d),_=this.capLevelController=new a(this),b=new l(this),A=new y$(this),T=n.contentSteeringController,w=T?new T(this):null,R=this.levelController=new h$(this,w),O=new c$(this),N=new g$(this.config),U=this.streamController=new m$(this,d,N),P=this.gapController=new a$(this,d);_.setStreamController(U),b.setStreamController(U);const B=[A,R,U];y&&B.splice(1,0,y),w&&B.splice(1,0,w),this.networkControllers=B;const L=[h,x,P,_,b,O,d];this.audioTrackController=this.createController(n.audioTrackController,B);const F=n.audioStreamController;F&&B.push(this.audioStreamController=new F(this,d,N)),this.subtitleTrackController=this.createController(n.subtitleTrackController,B);const j=n.subtitleStreamController;j&&B.push(this.subtititleStreamController=new j(this,d,N)),this.createController(n.timelineController,L),N.emeController=this.emeController=this.createController(n.emeController,L),this.cmcdController=this.createController(n.cmcdController,L),this.latencyController=this.createController(u$,L),this.coreComponents=L,B.push(c);const J=c.onErrorOut;typeof J=="function"&&this.on(H.ERROR,J,c),this.on(H.MANIFEST_LOADED,A.onManifestLoaded,A)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,s){this._emitter.off(e,t,n,s)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const s=e===H.ERROR;this.trigger(H.ERROR,{type:nn.OTHER_ERROR,details:Pe.INTERNAL_EXCEPTION,fatal:s,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(H.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const r=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(H.ERROR,{type:nn.OTHER_ERROR,details:Pe.ATTACH_MEDIA_ERROR,fatal:!0,error:r});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,n=t?e.media:e,s=t?e:{media:n};this._media=n,this.trigger(H.MEDIA_ATTACHING,s)}detachMedia(){this.logger.log("detachMedia"),this.trigger(H.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(H.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,n=this._url,s=this._url=FI.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${s}`),t&&n&&(n!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(H.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let n=0;n<this.networkControllers.length&&(this.networkControllers[n].startLoad(e,t),!(!this.started||!this.networkControllers));n++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[Zt.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[Zt.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[Zt.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=wj()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){hX(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let s=0;s<n;s++)if(e[s].maxBitrate>=t)return s;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let s;if(t===-1&&e!=null&&e.length?s=e.length-1:s=t,n)for(let r=s;r--;){const a=e[r].attrs["HDCP-LEVEL"];if(a&&a<=n)return r}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const n=aH(t);return rH(e,n,navigator.mediaCapabilities)}}Rf.defaultConfig=void 0;const v$=()=>{const i=ce.useRef(null);return ce.useEffect(()=>{const e=i.current,t="https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8";if(e)if(e.canPlayType("application/vnd.apple.mpegurl"))e.src=t;else if(Rf.isSupported()){const n=new Rf;n.loadSource(t),n.attachMedia(e)}else console.error("This browser does not support HLS.")},[]),Re.jsxs("div",{className:"min-h-screen bg-black flex flex-col mt-[60px] items-center justify-center px-4 py-10 text-white",children:[Re.jsx("h1",{className:"text-4xl font-bold mb-6 text-neon",children:"Live Stream Demo"}),Re.jsxs("div",{className:"relative w-full max-w-3xl aspect-video bg-gray-900 rounded-3xl shadow-[0_8px_30px_rgba(0,255,255,0.3)] overflow-hidden border-[12px] border-gray-700",children:[Re.jsx("div",{className:"absolute top-4 right-4 w-[20px] h-[20px] bg-gray-800 rounded-full border-2 border-gray-600 shadow-inner"}),Re.jsx("div",{className:"absolute bottom-4 right-4 w-[20px] h-[20px] bg-gray-800 rounded-full border-2 border-gray-600 shadow-inner"}),Re.jsx("div",{className:"absolute inset-4 rounded-2xl bg-black overflow-hidden neon-scan-bg",children:Re.jsx("video",{ref:i,controls:!0,autoPlay:!0,muted:!0,className:"w-full h-full object-cover rounded-2xl"})})]})]})},x$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpattern%20id='backbg'%20viewBox='0,0,2,2'%20x='6.5'%20y='6'%20width='16'%20height='16'%20patternUnits='userSpaceOnUse'%3e%3cpath%20d='M%200%200%20h%201%20l%20-1%201%20z%20m%200%202%20l%202%20-2%20v%201%20l%20-1%201%20z'%20style='fill:%20%2300f'%3e%3c/path%3e%3c/pattern%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3crect%20x='7'%20y='7'%20width='43'%20height='74'%20fill='url(%23backbg)'%3e%3c/rect%3e%3crect%20x='7'%20y='7'%20width='43'%20height='74'%20style='fill:%20none;%20stroke:%20%2300f;%20stroke-width:%202px'%3e%3c/rect%3e%3c/svg%3e",b$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%2010%20h%20-2%20v%20-5%20h%20-4%20v%205%20h%20-2%20v%20-10%20z%20m%200%202%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(20.5,%2034)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",A$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='10'%20height='12'%3e%3crect%20width='2'%20height='12'%3e%3c/rect%3e%3cpath%20d='M%206%200%20h%202%20l%202%202%20v%208%20l%20-2%202%20h%20-2%20l%20-2%20-2%20v%20-8%20z%20m%200%202%20v%208%20h%202%20v%20-8%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",E$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%2010%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20h%202%20v%203%20h%204%20v%20-8%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%204%200%20h%201%20v%202%20l%202%20-2%20l%201%202%20v%203%20l%20-1%202%20l%20-2%20-2%20v%207%20h%20-1%20v%20-8%20h%20-2%20v%20-1%20h%202%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",_$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%206%20l%20-1%201%20l%201%201%20v%202%20h%20-2%20v%20-2%20h%20-4%20l%20-2%20-2%20v%20-6%20z%20m%200%202%20v%206%20h%204%20v%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%200%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%2010%20h%20-8%20z'%3e%3c/path%3e%3crect%20x='1'%20y='11'%20width='8'%20height='1'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",S$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%202%20v%205%20l%204%20-5%20h%202%20l%20-4%205%20l%204%207%20h%20-2%20l%20-3%20-5%20h%20-1%20v%205%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%202%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%207%20h%20-8%20z'%3e%3c/path%3e%3cpath%20id='crown-dot'%20d='M%201%200%20l%201%201%20l%20-1%201%20l%20-1%20-1%20z'%3e%3c/path%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(4,%200)'%3e%3c/use%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(8,%200)'%3e%3c/use%3e%3crect%20x='1'%20y='10'%20width='8'%20height='2'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",T$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20v%202%20h%206%20v%202%20h%20-8%20v%20-4%20l%202%20-2%20h%204%20v%20-4%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",w$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%208%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-2%20v%20-2%20h%202%20v%20-3%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",M$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%205%200%20h%202%20v%206%20h%201%20v%202%20h%20-1%20v%204%20h%20-2%20v%20-4%20h%20-5%20v%20-2%20z%20m%200%203%20l%20-3%203%20h%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",C$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%202%20h%20-6%20v%202%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-4%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",R$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%202%20h%20-2%20v%20-2%20h%20-4%20v%203%20h%204%20l%202%202%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-8%20z%20m%200%207%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",D$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%204%20l%20-3%203%20v%205%20h%20-2%20v%20-6%20l%203%20-3%20v%20-1%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",L$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%203%20l%20-1%201%20l%201%201%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20l%201%20-1%20l%20-1%20-1%20v%20-3%20z%20m%200%202%20v%202%20l%201%201%20h%202%20l%201%20-1%20v%20-2%20z%20m%200%206%20v%202%20h%204%20v%20-2%20l%20-1%20-1%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",I$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%203%200%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%202%20l%201%201%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20l%201%20-1%20h%202%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%206%2012%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-4%20l%20-2%20-2%20v%20-3%20l%202%20-2%20h%204%20l%202%202%20v%208%20z%20m%200%20-7%20v%20-3%20h%20-4%20v%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2039.5)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",B$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%2010%20h%20-2%20v%20-5%20h%20-4%20v%205%20h%20-2%20v%20-10%20z%20m%200%202%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(20.5,%2034)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",O$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='10'%20height='12'%3e%3crect%20width='2'%20height='12'%3e%3c/rect%3e%3cpath%20d='M%206%200%20h%202%20l%202%202%20v%208%20l%20-2%202%20h%20-2%20l%20-2%20-2%20v%20-8%20z%20m%200%202%20v%208%20h%202%20v%20-8%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",P$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%2010%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20h%202%20v%203%20h%204%20v%20-8%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%204%200%20h%201%20v%202%20l%202%20-2%20l%201%202%20v%203%20l%20-1%202%20l%20-2%20-2%20v%207%20h%20-1%20v%20-8%20h%20-2%20v%20-1%20h%202%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",N$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%206%20l%20-1%201%20l%201%201%20v%202%20h%20-2%20v%20-2%20h%20-4%20l%20-2%20-2%20v%20-6%20z%20m%200%202%20v%206%20h%204%20v%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%200%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%2010%20h%20-8%20z'%3e%3c/path%3e%3crect%20x='1'%20y='11'%20width='8'%20height='1'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",U$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%202%20v%205%20l%204%20-5%20h%202%20l%20-4%205%20l%204%207%20h%20-2%20l%20-3%20-5%20h%20-1%20v%205%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%202%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%207%20h%20-8%20z'%3e%3c/path%3e%3cpath%20id='crown-dot'%20d='M%201%200%20l%201%201%20l%20-1%201%20l%20-1%20-1%20z'%3e%3c/path%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(4,%200)'%3e%3c/use%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(8,%200)'%3e%3c/use%3e%3crect%20x='1'%20y='10'%20width='8'%20height='2'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",k$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20v%202%20h%206%20v%202%20h%20-8%20v%20-4%20l%202%20-2%20h%204%20v%20-4%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",F$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%208%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-2%20v%20-2%20h%202%20v%20-3%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",H$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%205%200%20h%202%20v%206%20h%201%20v%202%20h%20-1%20v%204%20h%20-2%20v%20-4%20h%20-5%20v%20-2%20z%20m%200%203%20l%20-3%203%20h%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",G$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%202%20h%20-6%20v%202%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-4%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",z$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%202%20h%20-2%20v%20-2%20h%20-4%20v%203%20h%204%20l%202%202%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-8%20z%20m%200%207%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",V$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%204%20l%20-3%203%20v%205%20h%20-2%20v%20-6%20l%203%20-3%20v%20-1%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",Y$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%203%20l%20-1%201%20l%201%201%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20l%201%20-1%20l%20-1%20-1%20v%20-3%20z%20m%200%202%20v%202%20l%201%201%20h%202%20l%201%20-1%20v%20-2%20z%20m%200%206%20v%202%20h%204%20v%20-2%20l%20-1%20-1%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",K$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20l%20-4%205%20l%20-4%20-5%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%206%2012%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-4%20l%20-2%20-2%20v%20-3%20l%202%20-2%20h%204%20l%202%202%20v%208%20z%20m%200%20-7%20v%20-3%20h%20-4%20v%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2039.5)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",W$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%2010%20h%20-2%20v%20-5%20h%20-4%20v%205%20h%20-2%20v%20-10%20z%20m%200%202%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(20.5,%2034)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",X$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='10'%20height='12'%3e%3crect%20width='2'%20height='12'%3e%3c/rect%3e%3cpath%20d='M%206%200%20h%202%20l%202%202%20v%208%20l%20-2%202%20h%20-2%20l%20-2%20-2%20v%20-8%20z%20m%200%202%20v%208%20h%202%20v%20-8%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",j$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%2010%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20h%202%20v%203%20h%204%20v%20-8%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%204%200%20h%201%20v%202%20l%202%20-2%20l%201%202%20v%203%20l%20-1%202%20l%20-2%20-2%20v%207%20h%20-1%20v%20-8%20h%20-2%20v%20-1%20h%202%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",q$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%206%20l%20-1%201%20l%201%201%20v%202%20h%20-2%20v%20-2%20h%20-4%20l%20-2%20-2%20v%20-6%20z%20m%200%202%20v%206%20h%204%20v%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%200%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%2010%20h%20-8%20z'%3e%3c/path%3e%3crect%20x='1'%20y='11'%20width='8'%20height='1'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",Q$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%202%20v%205%20l%204%20-5%20h%202%20l%20-4%205%20l%204%207%20h%20-2%20l%20-3%20-5%20h%20-1%20v%205%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%202%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%207%20h%20-8%20z'%3e%3c/path%3e%3cpath%20id='crown-dot'%20d='M%201%200%20l%201%201%20l%20-1%201%20l%20-1%20-1%20z'%3e%3c/path%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(4,%200)'%3e%3c/use%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(8,%200)'%3e%3c/use%3e%3crect%20x='1'%20y='10'%20width='8'%20height='2'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",$$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20v%202%20h%206%20v%202%20h%20-8%20v%20-4%20l%202%20-2%20h%204%20v%20-4%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",J$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%208%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-2%20v%20-2%20h%202%20v%20-3%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",Z$="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%205%200%20h%202%20v%206%20h%201%20v%202%20h%20-1%20v%204%20h%20-2%20v%20-4%20h%20-5%20v%20-2%20z%20m%200%203%20l%20-3%203%20h%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",eJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%202%20h%20-6%20v%202%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-4%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",tJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%202%20h%20-2%20v%20-2%20h%20-4%20v%203%20h%204%20l%202%202%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-8%20z%20m%200%207%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",nJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%204%20l%20-3%203%20v%205%20h%20-2%20v%20-6%20l%203%20-3%20v%20-1%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",iJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%203%20l%20-1%201%20l%201%201%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20l%201%20-1%20l%20-1%20-1%20v%20-3%20z%20m%200%202%20v%202%20l%201%201%20h%202%20l%201%20-1%20v%20-2%20z%20m%200%206%20v%202%20h%204%20v%20-2%20l%20-1%20-1%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",sJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%202%200%20l%202%202%20l%202%20-2%20l%202%202%20v%203%20l%20-4%205%20l%20-4%20-5%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%206%2012%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-4%20l%20-2%20-2%20v%20-3%20l%202%20-2%20h%204%20l%202%202%20v%208%20z%20m%200%20-7%20v%20-3%20h%20-4%20v%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23f00;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2039.5)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",rJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%2010%20h%20-2%20v%20-5%20h%20-4%20v%205%20h%20-2%20v%20-10%20z%20m%200%202%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(20.5,%2034)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",aJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='10'%20height='12'%3e%3crect%20width='2'%20height='12'%3e%3c/rect%3e%3cpath%20d='M%206%200%20h%202%20l%202%202%20v%208%20l%20-2%202%20h%20-2%20l%20-2%20-2%20v%20-8%20z%20m%200%202%20v%208%20h%202%20v%20-8%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2020.5)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",oJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%2010%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20h%202%20v%203%20h%204%20v%20-8%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%204%200%20h%201%20v%202%20l%202%20-2%20l%201%202%20v%203%20l%20-1%202%20l%20-2%20-2%20v%207%20h%20-1%20v%20-8%20h%20-2%20v%20-1%20h%202%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",lJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%206%20l%20-1%201%20l%201%201%20v%202%20h%20-2%20v%20-2%20h%20-4%20l%20-2%20-2%20v%20-6%20z%20m%200%202%20v%206%20h%204%20v%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%200%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%2010%20h%20-8%20z'%3e%3c/path%3e%3crect%20x='1'%20y='11'%20width='8'%20height='1'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",cJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%202%20v%205%20l%204%20-5%20h%202%20l%20-4%205%20l%204%207%20h%20-2%20l%20-3%20-5%20h%20-1%20v%205%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='special'%20width='10'%20height='12'%3e%3cpath%20d='M%201%202%20l%202%203%20l%202%20-3%20l%202%203%20l%202%20-3%20v%207%20h%20-8%20z'%3e%3c/path%3e%3cpath%20id='crown-dot'%20d='M%201%200%20l%201%201%20l%20-1%201%20l%20-1%20-1%20z'%3e%3c/path%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(4,%200)'%3e%3c/use%3e%3cuse%20xlink:href='%23crown-dot'%20transform='translate(8,%200)'%3e%3c/use%3e%3crect%20x='1'%20y='10'%20width='8'%20height='2'%3e%3c/rect%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23special'%20transform='translate(18.5,%2032)%20scale(2)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",uJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20v%202%20h%206%20v%202%20h%20-8%20v%20-4%20l%202%20-2%20h%204%20v%20-4%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",hJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%208%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-2%20v%20-2%20h%202%20v%20-3%20h%20-4%20v%202%20h%20-2%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='rotate(180,%2028.5,%2044)%20translate(22.5,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",fJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%205%200%20h%202%20v%206%20h%201%20v%202%20h%20-1%20v%204%20h%20-2%20v%20-4%20h%20-5%20v%20-2%20z%20m%200%203%20l%20-3%203%20h%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",dJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%202%20h%20-6%20v%202%20h%204%20l%202%202%20v%204%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-4%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(22.5,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",pJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%202%20h%20-2%20v%20-2%20h%20-4%20v%203%20h%204%20l%202%202%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-8%20z%20m%200%207%20v%203%20h%204%20v%20-3%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2036.5)%20scale(1.5)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.5)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(29,%2011)%20scale(1.5)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",mJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%200%200%20h%208%20v%204%20l%20-3%203%20v%205%20h%20-2%20v%20-6%20l%203%20-3%20v%20-1%20h%20-6%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",gJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%202%200%20h%204%20l%202%202%20v%203%20l%20-1%201%20l%201%201%20v%203%20l%20-2%202%20h%20-4%20l%20-2%20-2%20v%20-3%20l%201%20-1%20l%20-1%20-1%20v%20-3%20z%20m%200%202%20v%202%20l%201%201%20h%202%20l%201%20-1%20v%20-2%20z%20m%200%206%20v%202%20h%204%20v%20-2%20l%20-1%20-1%20h%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2038)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2038)%20scale(1.2)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(16,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(31.4,%2011)%20scale(1.2)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(23.7,%2024.5)%20scale(1.2)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",yJ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='57'%20height='88'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3csymbol%20id='suit'%20width='8'%20height='10'%3e%3cpath%20d='M%204%200%20l%204%205%20v%202%20l%20-1%201%20h%20-1%20l%20-1%20-1%20l%201%203%20h%20-4%20l%201%20-3%20l%20-1%201%20h%20-1%20l%20-1%20-1%20v%20-2%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='rank'%20width='8'%20height='12'%3e%3cpath%20d='M%206%2012%20h%20-4%20l%20-2%20-2%20v%20-2%20h%202%20v%202%20h%204%20v%20-3%20h%20-4%20l%20-2%20-2%20v%20-3%20l%202%20-2%20h%204%20l%202%202%20v%208%20z%20m%200%20-7%20v%20-3%20h%20-4%20v%203%20z'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='index'%20width='57'%20height='88'%3e%3cuse%20xlink:href='%23rank'%20x='6'%20y='6'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20x='6'%20y='20'%3e%3c/use%3e%3c/symbol%3e%3crect%20x='1.5'%20y='1.5'%20width='54'%20height='85'%20fill='%23fff'%3e%3c/rect%3e%3cpath%20d='M%202%200%20h%2053%20l%202%202%20v%2084%20l%20-2%202%20h%20-53%20l%20-2%20-2%20v%20-84%20z%20m%200%202%20v%2084%20h%2053%20v%20-84%20z'%3e%3c/path%3e%3cg%20style='fill:%20%23000;'%3e%3cuse%20xlink:href='%23index'%3e%3c/use%3e%3cuse%20xlink:href='%23index'%20transform='rotate(180,%2028.5,%2044)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(24.9,%2039.5)%20scale(0.9)'%3e%3c/use%3e%3cg%20transform='rotate(180,%2028.5,%2044)'%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2011)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(32.8,%2030)%20scale(0.9)'%3e%3c/use%3e%3cuse%20xlink:href='%23suit'%20transform='translate(17,%2030)%20scale(0.9)'%3e%3c/use%3e%3c/g%3e%3c/g%3e%3c/svg%3e",vJ=Object.assign({"../assets/cards/BACK.svg":x$,"../assets/cards/C_1.svg":b$,"../assets/cards/C_10.svg":A$,"../assets/cards/C_11.svg":E$,"../assets/cards/C_12.svg":_$,"../assets/cards/C_13.svg":S$,"../assets/cards/C_2.svg":T$,"../assets/cards/C_3.svg":w$,"../assets/cards/C_4.svg":M$,"../assets/cards/C_5.svg":C$,"../assets/cards/C_6.svg":R$,"../assets/cards/C_7.svg":D$,"../assets/cards/C_8.svg":L$,"../assets/cards/C_9.svg":I$,"../assets/cards/D_1.svg":B$,"../assets/cards/D_10.svg":O$,"../assets/cards/D_11.svg":P$,"../assets/cards/D_12.svg":N$,"../assets/cards/D_13.svg":U$,"../assets/cards/D_2.svg":k$,"../assets/cards/D_3.svg":F$,"../assets/cards/D_4.svg":H$,"../assets/cards/D_5.svg":G$,"../assets/cards/D_6.svg":z$,"../assets/cards/D_7.svg":V$,"../assets/cards/D_8.svg":Y$,"../assets/cards/D_9.svg":K$,"../assets/cards/H_1.svg":W$,"../assets/cards/H_10.svg":X$,"../assets/cards/H_11.svg":j$,"../assets/cards/H_12.svg":q$,"../assets/cards/H_13.svg":Q$,"../assets/cards/H_2.svg":$$,"../assets/cards/H_3.svg":J$,"../assets/cards/H_4.svg":Z$,"../assets/cards/H_5.svg":eJ,"../assets/cards/H_6.svg":tJ,"../assets/cards/H_7.svg":nJ,"../assets/cards/H_8.svg":iJ,"../assets/cards/H_9.svg":sJ,"../assets/cards/S_1.svg":rJ,"../assets/cards/S_10.svg":aJ,"../assets/cards/S_11.svg":oJ,"../assets/cards/S_12.svg":lJ,"../assets/cards/S_13.svg":cJ,"../assets/cards/S_2.svg":uJ,"../assets/cards/S_3.svg":hJ,"../assets/cards/S_4.svg":fJ,"../assets/cards/S_5.svg":dJ,"../assets/cards/S_6.svg":pJ,"../assets/cards/S_7.svg":mJ,"../assets/cards/S_8.svg":gJ,"../assets/cards/S_9.svg":yJ}),j_=i=>vJ[`../assets/cards/${i}.svg`];function xJ(){const i=Array.from({length:52},(e,t)=>t);for(let e=i.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[i[e],i[t]]=[i[t],i[e]]}return i}function q_(i){if(typeof i=="number")return i;if(typeof i=="string")if(i.includes("/")){const e=i.split("/").map(t=>parseInt(t.trim()));return Math.max(...e)}else return i.includes("Bust"),parseInt(i);return 0}const bJ="6.13.5";function AJ(i,e,t){const n=e.split("|").map(r=>r.trim());for(let r=0;r<n.length;r++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof i===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${t}`,s.value=i,s}async function Xa(i){const e=Object.keys(i);return(await Promise.all(e.map(n=>Promise.resolve(i[n])))).reduce((n,s,r)=>(n[e[r]]=s,n),{})}function yn(i,e,t){for(let n in e){let s=e[n];const r=t?t[n]:null;r&&AJ(s,r,n),Object.defineProperty(i,n,{enumerable:!0,value:s,writable:!1})}}function cy(i){if(i==null)return"null";if(Array.isArray(i))return"[ "+i.map(cy).join(", ")+" ]";if(i instanceof Uint8Array){const e="0123456789abcdef";let t="0x";for(let n=0;n<i.length;n++)t+=e[i[n]>>4],t+=e[i[n]&15];return t}if(typeof i=="object"&&typeof i.toJSON=="function")return cy(i.toJSON());switch(typeof i){case"boolean":case"symbol":return i.toString();case"bigint":return BigInt(i).toString();case"number":return i.toString();case"string":return JSON.stringify(i);case"object":{const e=Object.keys(i);return e.sort(),"{ "+e.map(t=>`${cy(t)}: ${cy(i[t])}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function ra(i,e){return i&&i.code===e}function oB(i){return ra(i,"CALL_EXCEPTION")}function Ys(i,e,t){let n=i;{const r=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${cy(t)}`);for(const a in t){if(a==="shortMessage")continue;const o=t[a];r.push(a+"="+cy(o))}}r.push(`code=${e}`),r.push(`version=${bJ}`),r.length&&(i+=" ("+r.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(i);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(i);break;default:s=new Error(i)}return yn(s,{code:e}),t&&Object.assign(s,t),s.shortMessage==null&&yn(s,{shortMessage:n}),s}function yt(i,e,t,n){if(!i)throw Ys(e,t,n)}function Se(i,e,t,n){yt(i,e,"INVALID_ARGUMENT",{argument:t,value:n})}function hG(i,e,t){t==null&&(t=""),t&&(t=": "+t),yt(i>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:i,expectedCount:e}),yt(i<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:i,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((i,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"é".normalize("NFD")!=="é")throw new Error("broken");i.push(e)}catch{}return i},[]);function RE(i,e,t){if(t==null&&(t=""),i!==e){let n=t,s="new";t&&(n+=".",s+=" "+t),yt(!1,`private constructor; use ${n}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function fG(i,e,t){if(i instanceof Uint8Array)return t?new Uint8Array(i):i;if(typeof i=="string"&&i.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const n=new Uint8Array((i.length-2)/2);let s=2;for(let r=0;r<n.length;r++)n[r]=parseInt(i.substring(s,s+2),16),s+=2;return n}Se(!1,"invalid BytesLike value",e||"value",i)}function mi(i,e){return fG(i,e,!1)}function qa(i,e){return fG(i,e,!0)}function ls(i,e){return!(typeof i!="string"||!i.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&i.length!==2+2*e||e===!0&&i.length%2!==0)}function lB(i){return ls(i,!0)||i instanceof Uint8Array}const vU="0123456789abcdef";function Xt(i){const e=mi(i);let t="0x";for(let n=0;n<e.length;n++){const s=e[n];t+=vU[(s&240)>>4]+vU[s&15]}return t}function cr(i){return"0x"+i.map(e=>Xt(e).substring(2)).join("")}function by(i){return ls(i,!0)?(i.length-2)/2:mi(i).length}function Ks(i,e,t){const n=mi(i);return t!=null&&t>n.length&&yt(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:t}),Xt(n.slice(e??0,t??n.length))}function dG(i,e,t){const n=mi(i);yt(e>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),t?s.set(n,e-n.length):s.set(n,0),Xt(s)}function sg(i,e){return dG(i,e,!0)}function EJ(i,e){return dG(i,e,!1)}const Nw=BigInt(0),kc=BigInt(1),rL=9007199254740991;function l3(i,e){const t=Uw(i,"value"),n=BigInt(Gn(e,"width"));if(yt(t>>n===Nw,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:i}),t>>n-kc){const s=(kc<<n)-kc;return-((~t&s)+kc)}return t}function pG(i,e){let t=en(i,"value");const n=BigInt(Gn(e,"width")),s=kc<<n-kc;if(t<Nw){t=-t,yt(t<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:i});const r=(kc<<n)-kc;return(~t&r)+kc}else yt(t<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:i});return t}function gm(i,e){const t=Uw(i,"value"),n=BigInt(Gn(e,"bits"));return t&(kc<<n)-kc}function en(i,e){switch(typeof i){case"bigint":return i;case"number":return Se(Number.isInteger(i),"underflow",e||"value",i),Se(i>=-9007199254740991&&i<=rL,"overflow",e||"value",i),BigInt(i);case"string":try{if(i==="")throw new Error("empty string");return i[0]==="-"&&i[1]!=="-"?-BigInt(i.substring(1)):BigInt(i)}catch(t){Se(!1,`invalid BigNumberish string: ${t.message}`,e||"value",i)}}Se(!1,"invalid BigNumberish value",e||"value",i)}function Uw(i,e){const t=en(i,e);return yt(t>=Nw,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:i}),t}const xU="0123456789abcdef";function kw(i){if(i instanceof Uint8Array){let e="0x0";for(const t of i)e+=xU[t>>4],e+=xU[t&15];return BigInt(e)}return en(i)}function Gn(i,e){switch(typeof i){case"bigint":return Se(i>=-9007199254740991&&i<=rL,"overflow",e||"value",i),Number(i);case"number":return Se(Number.isInteger(i),"underflow",e||"value",i),Se(i>=-9007199254740991&&i<=rL,"overflow",e||"value",i),i;case"string":try{if(i==="")throw new Error("empty string");return Gn(BigInt(i),e)}catch(t){Se(!1,`invalid numeric string: ${t.message}`,e||"value",i)}}Se(!1,"invalid numeric value",e||"value",i)}function _J(i){return Gn(kw(i))}function B0(i,e){let n=Uw(i,"value").toString(16);if(e==null)n.length%2&&(n="0"+n);else{const s=Gn(e,"width");for(yt(s*2>=n.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:i});n.length<s*2;)n="0"+n}return"0x"+n}function $a(i){const e=Uw(i,"value");if(e===Nw)return new Uint8Array([]);let t=e.toString(16);t.length%2&&(t="0"+t);const n=new Uint8Array(t.length/2);for(let s=0;s<n.length;s++){const r=s*2;n[s]=parseInt(t.substring(r,r+2),16)}return n}function uy(i){let e=Xt(lB(i)?i:$a(i)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const bU="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const AU=BigInt(58);function SJ(i){const e=mi(i);let t=kw(e),n="";for(;t;)n=bU[Number(t%AU)]+n,t/=AU;for(let s=0;s<e.length&&!e[s];s++)n=bU[0]+n;return n}function TJ(i){i=atob(i);const e=new Uint8Array(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return mi(e)}function wJ(i){const e=mi(i);let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}var Dy;class mG{constructor(e,t,n){he(this,"filter");he(this,"emitter");je(this,Dy);fe(this,Dy,t),yn(this,{emitter:e,filter:n})}async removeListener(){K(this,Dy)!=null&&await this.emitter.off(this.filter,K(this,Dy))}}Dy=new WeakMap;function MJ(i,e,t,n,s){Se(!1,`invalid codepoint at offset ${e}; ${i}`,"bytes",t)}function gG(i,e,t,n,s){if(i==="BAD_PREFIX"||i==="UNEXPECTED_CONTINUE"){let r=0;for(let a=e+1;a<t.length&&t[a]>>6===2;a++)r++;return r}return i==="OVERRUN"?t.length-e-1:0}function CJ(i,e,t,n,s){return i==="OVERLONG"?(Se(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),n.push(s),0):(n.push(65533),gG(i,e,t))}const RJ=Object.freeze({error:MJ,ignore:gG,replace:CJ});function DJ(i,e){e==null&&(e=RJ.error);const t=mi(i,"bytes"),n=[];let s=0;for(;s<t.length;){const r=t[s++];if(r>>7===0){n.push(r);continue}let a=null,o=null;if((r&224)===192)a=1,o=127;else if((r&240)===224)a=2,o=2047;else if((r&248)===240)a=3,o=65535;else{(r&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,t,n):s+=e("BAD_PREFIX",s-1,t,n);continue}if(s-1+a>=t.length){s+=e("OVERRUN",s-1,t,n);continue}let l=r&(1<<8-a-1)-1;for(let c=0;c<a;c++){let h=t[s];if((h&192)!=128){s+=e("MISSING_CONTINUE",s,t,n),l=null;break}l=l<<6|h&63,s++}if(l!==null){if(l>1114111){s+=e("OUT_OF_RANGE",s-1-a,t,n,l);continue}if(l>=55296&&l<=57343){s+=e("UTF16_SURROGATE",s-1-a,t,n,l);continue}if(l<=o){s+=e("OVERLONG",s-1-a,t,n,l);continue}n.push(l)}}return n}function Uf(i,e){Se(typeof i=="string","invalid string value","str",i);let t=[];for(let n=0;n<i.length;n++){const s=i.charCodeAt(n);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)==55296){n++;const r=i.charCodeAt(n);Se(n<i.length&&(r&64512)===56320,"invalid surrogate pair","str",i);const a=65536+((s&1023)<<10)+(r&1023);t.push(a>>18|240),t.push(a>>12&63|128),t.push(a>>6&63|128),t.push(a&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return new Uint8Array(t)}function LJ(i){return i.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function c3(i,e){return LJ(DJ(i,e))}function yG(i){async function e(t,n){yt(n==null||!n.cancelled,"request cancelled before sending","CANCELLED");const s=t.url.split(":")[0].toLowerCase();yt(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),yt(s==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let r=null;const a=new AbortController,o=setTimeout(()=>{r=Ys("request timeout","TIMEOUT"),a.abort()},t.timeout);n&&n.addListener(()=>{r=Ys("request cancelled","CANCELLED"),a.abort()});const l={method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:a.signal};let c;try{c=await fetch(t.url,l)}catch(y){throw clearTimeout(o),r||y}clearTimeout(o);const h={};c.headers.forEach((y,x)=>{h[x.toLowerCase()]=y});const d=await c.arrayBuffer(),m=d==null?null:new Uint8Array(d);return{statusCode:c.status,statusMessage:c.statusText,headers:h,body:m}}return e}const IJ=12,BJ=250;let EU=yG();const OJ=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),PJ=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let $C=!1;async function vG(i,e){try{const t=i.match(OJ);if(!t)throw new Error("invalid data");return new M0(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?TJ(t[3]):UJ(t[3]))}catch{return new M0(599,"BAD REQUEST (invalid data: URI)",{},null,new O0(i))}}function xG(i){async function e(t,n){try{const s=t.match(PJ);if(!s)throw new Error("invalid link");return new O0(`${i}${s[2]}`)}catch{return new M0(599,"BAD REQUEST (invalid IPFS URI)",{},null,new O0(t))}}return e}const Q_={data:vG,ipfs:xG("https://gateway.ipfs.io/ipfs/")},bG=new WeakMap;var Rm,a0;class NJ{constructor(e){je(this,Rm);je(this,a0);fe(this,Rm,[]),fe(this,a0,!1),bG.set(e,()=>{if(!K(this,a0)){fe(this,a0,!0);for(const t of K(this,Rm))setTimeout(()=>{t()},0);fe(this,Rm,[])}})}addListener(e){yt(!K(this,a0),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),K(this,Rm).push(e)}get cancelled(){return K(this,a0)}checkSignal(){yt(!this.cancelled,"cancelled","CANCELLED",{})}}Rm=new WeakMap,a0=new WeakMap;function $_(i){if(i==null)throw new Error("missing signal; should not happen");return i.checkSignal(),i}var Ly,Iy,Ic,yf,By,Oy,Hr,qo,vf,Dm,Lm,Im,Xu,Bc,o0,Bm,Xb;const Sw=class Sw{constructor(e){je(this,Bm);je(this,Ly);je(this,Iy);je(this,Ic);je(this,yf);je(this,By);je(this,Oy);je(this,Hr);je(this,qo);je(this,vf);je(this,Dm);je(this,Lm);je(this,Im);je(this,Xu);je(this,Bc);je(this,o0);fe(this,Oy,String(e)),fe(this,Ly,!1),fe(this,Iy,!0),fe(this,Ic,{}),fe(this,yf,""),fe(this,By,3e5),fe(this,Bc,{slotInterval:BJ,maxAttempts:IJ}),fe(this,o0,null)}get url(){return K(this,Oy)}set url(e){fe(this,Oy,String(e))}get body(){return K(this,Hr)==null?null:new Uint8Array(K(this,Hr))}set body(e){if(e==null)fe(this,Hr,void 0),fe(this,qo,void 0);else if(typeof e=="string")fe(this,Hr,Uf(e)),fe(this,qo,"text/plain");else if(e instanceof Uint8Array)fe(this,Hr,e),fe(this,qo,"application/octet-stream");else if(typeof e=="object")fe(this,Hr,Uf(JSON.stringify(e))),fe(this,qo,"application/json");else throw new Error("invalid body")}hasBody(){return K(this,Hr)!=null}get method(){return K(this,yf)?K(this,yf):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),fe(this,yf,String(e).toUpperCase())}get headers(){const e=Object.assign({},K(this,Ic));return K(this,vf)&&(e.authorization=`Basic ${wJ(Uf(K(this,vf)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&K(this,qo)&&(e["content-type"]=K(this,qo)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){K(this,Ic)[String(e).toLowerCase()]=String(t)}clearHeaders(){fe(this,Ic,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return K(this,vf)||null}setCredentials(e,t){Se(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),fe(this,vf,`${e}:${t}`)}get allowGzip(){return K(this,Iy)}set allowGzip(e){fe(this,Iy,!!e)}get allowInsecureAuthentication(){return!!K(this,Ly)}set allowInsecureAuthentication(e){fe(this,Ly,!!e)}get timeout(){return K(this,By)}set timeout(e){Se(e>=0,"timeout must be non-zero","timeout",e),fe(this,By,e)}get preflightFunc(){return K(this,Dm)||null}set preflightFunc(e){fe(this,Dm,e)}get processFunc(){return K(this,Lm)||null}set processFunc(e){fe(this,Lm,e)}get retryFunc(){return K(this,Im)||null}set retryFunc(e){fe(this,Im,e)}get getUrlFunc(){return K(this,o0)||EU}set getUrlFunc(e){fe(this,o0,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${K(this,Hr)?Xt(K(this,Hr)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(K(this,Bc).slotInterval=e.slotInterval),e.maxAttempts!=null&&(K(this,Bc).maxAttempts=e.maxAttempts)}send(){return yt(K(this,Xu)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),fe(this,Xu,new NJ(this)),wt(this,Bm,Xb).call(this,0,_U()+this.timeout,0,this,new M0(0,"",{},null,this))}cancel(){yt(K(this,Xu)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=bG.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),n=e.split(":")[0].toLowerCase();yt(this.method==="GET"&&(t!=="https"||n!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new Sw(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,fe(s,Ic,Object.assign({},K(this,Ic))),K(this,Hr)&&fe(s,Hr,new Uint8Array(K(this,Hr))),fe(s,qo,K(this,qo)),s}clone(){const e=new Sw(this.url);return fe(e,yf,K(this,yf)),K(this,Hr)&&fe(e,Hr,K(this,Hr)),fe(e,qo,K(this,qo)),fe(e,Ic,Object.assign({},K(this,Ic))),fe(e,vf,K(this,vf)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),fe(e,Dm,K(this,Dm)),fe(e,Lm,K(this,Lm)),fe(e,Im,K(this,Im)),fe(e,Bc,Object.assign({},K(this,Bc))),fe(e,o0,K(this,o0)),e}static lockConfig(){$C=!0}static getGateway(e){return Q_[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if($C)throw new Error("gateways locked");Q_[e]=t}static registerGetUrl(e){if($C)throw new Error("gateways locked");EU=e}static createGetUrlFunc(e){return yG()}static createDataGateway(){return vG}static createIpfsGatewayFunc(e){return xG(e)}};Ly=new WeakMap,Iy=new WeakMap,Ic=new WeakMap,yf=new WeakMap,By=new WeakMap,Oy=new WeakMap,Hr=new WeakMap,qo=new WeakMap,vf=new WeakMap,Dm=new WeakMap,Lm=new WeakMap,Im=new WeakMap,Xu=new WeakMap,Bc=new WeakMap,o0=new WeakMap,Bm=new WeakSet,Xb=async function(e,t,n,s,r){var h,d,m;if(e>=K(this,Bc).maxAttempts)return r.makeServerError("exceeded maximum retry limit");yt(_U()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),n>0&&await kJ(n);let a=this.clone();const o=(a.url.split(":")[0]||"").toLowerCase();if(o in Q_){const y=await Q_[o](a.url,$_(K(s,Xu)));if(y instanceof M0){let x=y;if(this.processFunc){$_(K(s,Xu));try{x=await this.processFunc(a,x)}catch(_){(_.throttle==null||typeof _.stall!="number")&&x.makeServerError("error in post-processing function",_).assertOk()}}return x}a=y}this.preflightFunc&&(a=await this.preflightFunc(a));const l=await this.getUrlFunc(a,$_(K(s,Xu)));let c=new M0(l.statusCode,l.statusMessage,l.headers,l.body,s);if(c.statusCode===301||c.statusCode===302){try{const y=c.headers.location||"";return wt(h=a.redirect(y),Bm,Xb).call(h,e+1,t,0,s,c)}catch{}return c}else if(c.statusCode===429&&(this.retryFunc==null||await this.retryFunc(a,c,e))){const y=c.headers["retry-after"];let x=K(this,Bc).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof y=="string"&&y.match(/^[1-9][0-9]*$/)&&(x=parseInt(y)),wt(d=a.clone(),Bm,Xb).call(d,e+1,t,x,s,c)}if(this.processFunc){$_(K(s,Xu));try{c=await this.processFunc(a,c)}catch(y){(y.throttle==null||typeof y.stall!="number")&&c.makeServerError("error in post-processing function",y).assertOk();let x=K(this,Bc).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return y.stall>=0&&(x=y.stall),wt(m=a.clone(),Bm,Xb).call(m,e+1,t,x,s,c)}}return c};let O0=Sw;var pE,mE,gE,Qo,Py,Om;const sP=class sP{constructor(e,t,n,s,r){je(this,pE);je(this,mE);je(this,gE);je(this,Qo);je(this,Py);je(this,Om);fe(this,pE,e),fe(this,mE,t),fe(this,gE,Object.keys(n).reduce((a,o)=>(a[o.toLowerCase()]=String(n[o]),a),{})),fe(this,Qo,s==null?null:new Uint8Array(s)),fe(this,Py,r||null),fe(this,Om,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${K(this,Qo)?Xt(K(this,Qo)):"null"}>`}get statusCode(){return K(this,pE)}get statusMessage(){return K(this,mE)}get headers(){return Object.assign({},K(this,gE))}get body(){return K(this,Qo)==null?null:new Uint8Array(K(this,Qo))}get bodyText(){try{return K(this,Qo)==null?"":c3(K(this,Qo))}catch{yt(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{yt(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let n;e?n=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,n=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new sP(599,n,this.headers,this.body,K(this,Py)||void 0);return fe(s,Om,{message:e,error:t}),s}throwThrottleError(e,t){t==null?t=-1:Se(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const n=new Error(e||"throttling requests");throw yn(n,{stall:t,throttle:!0}),n}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return K(this,Qo)!=null}get request(){return K(this,Py)}ok(){return K(this,Om).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=K(this,Om);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let s=null;try{K(this,Qo)&&(s=c3(K(this,Qo)))}catch{}yt(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:n,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};pE=new WeakMap,mE=new WeakMap,gE=new WeakMap,Qo=new WeakMap,Py=new WeakMap,Om=new WeakMap;let M0=sP;function _U(){return new Date().getTime()}function UJ(i){return Uf(i.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function kJ(i){return new Promise(e=>setTimeout(e,i))}const FJ=BigInt(-1),Mc=BigInt(0),hy=BigInt(1),HJ=BigInt(5),D2={};let Ay="0000";for(;Ay.length<80;)Ay+=Ay;function Up(i){let e=Ay;for(;e.length<i;)e+=e;return BigInt("1"+e.substring(0,i))}function vb(i,e,t){const n=BigInt(e.width);if(e.signed){const s=hy<<n-hy;yt(t==null||i>=-s&&i<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:i}),i>Mc?i=l3(gm(i,n),n):i=-l3(gm(-i,n),n)}else{const s=hy<<n;yt(t==null||i>=0&&i<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:i}),i=(i%s+s)%s&s-hy}return i}function JC(i){typeof i=="number"&&(i=`fixed128x${i}`);let e=!0,t=128,n=18;if(typeof i=="string"){if(i!=="fixed")if(i==="ufixed")e=!1;else{const r=i.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);Se(r,"invalid fixed format","format",i),e=r[1]!=="u",t=parseInt(r[2]),n=parseInt(r[3])}}else if(i){const r=i,a=(o,l,c)=>r[o]==null?c:(Se(typeof r[o]===l,"invalid fixed format ("+o+" not "+l+")","format."+o,r[o]),r[o]);e=a("signed","boolean",e),t=a("width","number",t),n=a("decimals","number",n)}Se(t%8===0,"invalid FixedNumber width (not byte aligned)","format.width",t),Se(n<=80,"invalid FixedNumber decimals (too large)","format.decimals",n);const s=(e?"":"u")+"fixed"+String(t)+"x"+String(n);return{signed:e,width:t,decimals:n,name:s}}function GJ(i,e){let t="";i<Mc&&(t="-",i*=FJ);let n=i.toString();if(e===0)return t+n;for(;n.length<=e;)n=Ay+n;const s=n.length-e;for(n=n.substring(0,s)+"."+n.substring(s);n[0]==="0"&&n[1]!==".";)n=n.substring(1);for(;n[n.length-1]==="0"&&n[n.length-2]!==".";)n=n.substring(0,n.length-1);return t+n}var Oc,qi,Ka,Ui,nm,rf,aL,oL,lL,cL;const s0=class s0{constructor(e,t,n){je(this,Ui);he(this,"format");je(this,Oc);je(this,qi);je(this,Ka);he(this,"_value");RE(e,D2,"FixedNumber"),fe(this,qi,t),fe(this,Oc,n);const s=GJ(t,n.decimals);yn(this,{format:n.name,_value:s}),fe(this,Ka,Up(n.decimals))}get signed(){return K(this,Oc).signed}get width(){return K(this,Oc).width}get decimals(){return K(this,Oc).decimals}get value(){return K(this,qi)}addUnsafe(e){return wt(this,Ui,aL).call(this,e)}add(e){return wt(this,Ui,aL).call(this,e,"add")}subUnsafe(e){return wt(this,Ui,oL).call(this,e)}sub(e){return wt(this,Ui,oL).call(this,e,"sub")}mulUnsafe(e){return wt(this,Ui,lL).call(this,e)}mul(e){return wt(this,Ui,lL).call(this,e,"mul")}mulSignal(e){wt(this,Ui,nm).call(this,e);const t=K(this,qi)*K(e,qi);return yt(t%K(this,Ka)===Mc,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),wt(this,Ui,rf).call(this,t/K(this,Ka),"mulSignal")}divUnsafe(e){return wt(this,Ui,cL).call(this,e)}div(e){return wt(this,Ui,cL).call(this,e,"div")}divSignal(e){yt(K(e,qi)!==Mc,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),wt(this,Ui,nm).call(this,e);const t=K(this,qi)*K(this,Ka);return yt(t%K(e,qi)===Mc,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),wt(this,Ui,rf).call(this,t/K(e,qi),"divSignal")}cmp(e){let t=this.value,n=e.value;const s=this.decimals-e.decimals;return s>0?n*=Up(s):s<0&&(t*=Up(-s)),t<n?-1:t>n?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=K(this,qi);return K(this,qi)<Mc&&(e-=K(this,Ka)-hy),e=K(this,qi)/K(this,Ka)*K(this,Ka),wt(this,Ui,rf).call(this,e,"floor")}ceiling(){let e=K(this,qi);return K(this,qi)>Mc&&(e+=K(this,Ka)-hy),e=K(this,qi)/K(this,Ka)*K(this,Ka),wt(this,Ui,rf).call(this,e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const t=this.decimals-e,n=HJ*Up(t-1);let s=this.value+n;const r=Up(t);return s=s/r*r,vb(s,K(this,Oc),"round"),new s0(D2,s,K(this,Oc))}isZero(){return K(this,qi)===Mc}isNegative(){return K(this,qi)<Mc}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return s0.fromString(this.toString(),e)}static fromValue(e,t,n){const s=t==null?0:Gn(t),r=JC(n);let a=en(e,"value");const o=s-r.decimals;if(o>0){const l=Up(o);yt(a%l===Mc,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),a/=l}else o<0&&(a*=Up(-o));return vb(a,r,"fromValue"),new s0(D2,a,r)}static fromString(e,t){const n=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);Se(n&&n[2].length+n[3].length>0,"invalid FixedNumber string value","value",e);const s=JC(t);let r=n[2]||"0",a=n[3]||"";for(;a.length<s.decimals;)a+=Ay;yt(a.substring(s.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),a=a.substring(0,s.decimals);const o=BigInt(n[1]+r+a);return vb(o,s,"fromString"),new s0(D2,o,s)}static fromBytes(e,t){let n=kw(mi(e,"value"));const s=JC(t);return s.signed&&(n=l3(n,s.width)),vb(n,s,"fromBytes"),new s0(D2,n,s)}};Oc=new WeakMap,qi=new WeakMap,Ka=new WeakMap,Ui=new WeakSet,nm=function(e){Se(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},rf=function(e,t){return e=vb(e,K(this,Oc),t),new s0(D2,e,K(this,Oc))},aL=function(e,t){return wt(this,Ui,nm).call(this,e),wt(this,Ui,rf).call(this,K(this,qi)+K(e,qi),t)},oL=function(e,t){return wt(this,Ui,nm).call(this,e),wt(this,Ui,rf).call(this,K(this,qi)-K(e,qi),t)},lL=function(e,t){return wt(this,Ui,nm).call(this,e),wt(this,Ui,rf).call(this,K(this,qi)*K(e,qi)/K(this,Ka),t)},cL=function(e,t){return yt(K(e,qi)!==Mc,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),wt(this,Ui,nm).call(this,e),wt(this,Ui,rf).call(this,K(this,qi)*K(this,Ka)/K(e,qi),t)};let u3=s0;function zJ(i){let e=i.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function SU(i,e,t){let n=0;for(let s=0;s<t;s++)n=n*256+i[e+s];return n}function TU(i,e,t,n){const s=[];for(;t<e+1+n;){const r=AG(i,t);s.push(r.result),t+=r.consumed,yt(t<=e+1+n,"child data too short","BUFFER_OVERRUN",{buffer:i,length:n,offset:e})}return{consumed:1+n,result:s}}function AG(i,e){yt(i.length!==0,"data too short","BUFFER_OVERRUN",{buffer:i,length:0,offset:1});const t=n=>{yt(n<=i.length,"data short segment too short","BUFFER_OVERRUN",{buffer:i,length:i.length,offset:n})};if(i[e]>=248){const n=i[e]-247;t(e+1+n);const s=SU(i,e+1,n);return t(e+1+n+s),TU(i,e,e+1+n,n+s)}else if(i[e]>=192){const n=i[e]-192;return t(e+1+n),TU(i,e,e+1,n)}else if(i[e]>=184){const n=i[e]-183;t(e+1+n);const s=SU(i,e+1,n);t(e+1+n+s);const r=Xt(i.slice(e+1+n,e+1+n+s));return{consumed:1+n+s,result:r}}else if(i[e]>=128){const n=i[e]-128;t(e+1+n);const s=Xt(i.slice(e+1,e+1+n));return{consumed:1+n,result:s}}return{consumed:1,result:zJ(i[e])}}function Fw(i){const e=mi(i,"data"),t=AG(e,0);return Se(t.consumed===e.length,"unexpected junk after rlp payload","data",i),t.result}function wU(i){const e=[];for(;i;)e.unshift(i&255),i>>=8;return e}function EG(i){if(Array.isArray(i)){let n=[];if(i.forEach(function(r){n=n.concat(EG(r))}),n.length<=55)return n.unshift(192+n.length),n;const s=wU(n.length);return s.unshift(247+s.length),s.concat(n)}const e=Array.prototype.slice.call(mi(i,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const t=wU(e.length);return t.unshift(183+t.length),t.concat(e)}const MU="0123456789abcdef";function rg(i){let e="0x";for(const t of EG(i))e+=MU[t>>4],e+=MU[t&15];return e}function VJ(i,e){let t=18;return t=Gn(e,"unit"),u3.fromValue(i,t,{decimals:t,width:512}).toString()}function YJ(i,e){Se(typeof i=="string","value must be a string","value",i);let t=18;return t=Gn(e,"unit"),u3.fromString(i,{decimals:t,width:512}).value}function KJ(i){return VJ(i,18)}function WJ(i){return YJ(i,18)}const Ja=32,uL=new Uint8Array(Ja),XJ=["then"],J_={},_G=new WeakMap;function hm(i){return _G.get(i)}function CU(i,e){_G.set(i,e)}function xb(i,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${i}`);throw t.error=e,t}function hL(i,e,t){return i.indexOf(null)>=0?e.map((n,s)=>n instanceof xv?hL(hm(n),n,t):n):i.reduce((n,s,r)=>{let a=e.getValue(s);return s in n||(t&&a instanceof xv&&(a=hL(hm(a),a,t)),n[s]=a),n},{})}var Ny;const py=class py extends Array{constructor(...t){const n=t[0];let s=t[1],r=(t[2]||[]).slice(),a=!0;n!==J_&&(s=t,r=[],a=!1);super(s.length);je(this,Ny);s.forEach((c,h)=>{this[h]=c});const o=r.reduce((c,h)=>(typeof h=="string"&&c.set(h,(c.get(h)||0)+1),c),new Map);if(CU(this,Object.freeze(s.map((c,h)=>{const d=r[h];return d!=null&&o.get(d)===1?d:null}))),fe(this,Ny,[]),K(this,Ny)==null&&K(this,Ny),!a)return;Object.freeze(this);const l=new Proxy(this,{get:(c,h,d)=>{if(typeof h=="string"){if(h.match(/^[0-9]+$/)){const y=Gn(h,"%index");if(y<0||y>=this.length)throw new RangeError("out of result range");const x=c[y];return x instanceof Error&&xb(`index ${y}`,x),x}if(XJ.indexOf(h)>=0)return Reflect.get(c,h,d);const m=c[h];if(m instanceof Function)return function(...y){return m.apply(this===d?c:this,y)};if(!(h in c))return c.getValue.apply(this===d?c:this,[h])}return Reflect.get(c,h,d)}});return CU(l,hm(this)),l}toArray(t){const n=[];return this.forEach((s,r)=>{s instanceof Error&&xb(`index ${r}`,s),t&&s instanceof py&&(s=s.toArray(t)),n.push(s)}),n}toObject(t){const n=hm(this);return n.reduce((s,r,a)=>(yt(r!=null,`value at index ${a} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),hL(n,this,t)),{})}slice(t,n){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const s=hm(this),r=[],a=[];for(let o=t;o<n;o++)r.push(this[o]),a.push(s[o]);return new py(J_,r,a)}filter(t,n){const s=hm(this),r=[],a=[];for(let o=0;o<this.length;o++){const l=this[o];l instanceof Error&&xb(`index ${o}`,l),t.call(n,l,o,this)&&(r.push(l),a.push(s[o]))}return new py(J_,r,a)}map(t,n){const s=[];for(let r=0;r<this.length;r++){const a=this[r];a instanceof Error&&xb(`index ${r}`,a),s.push(t.call(n,a,r,this))}return s}getValue(t){const n=hm(this).indexOf(t);if(n===-1)return;const s=this[n];return s instanceof Error&&xb(`property ${JSON.stringify(t)}`,s.error),s}static fromItems(t,n){return new py(J_,t,n)}};Ny=new WeakMap;let xv=py;function RU(i){let e=$a(i);return yt(e.length<=Ja,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:Ja,offset:e.length}),e.length!==Ja&&(e=qa(cr([uL.slice(e.length%Ja),e]))),e}class qf{constructor(e,t,n,s){he(this,"name");he(this,"type");he(this,"localName");he(this,"dynamic");yn(this,{name:e,type:t,localName:n,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){Se(!1,e,this.localName,t)}}var xf,Pm,Uy,DT;class fL{constructor(){je(this,Uy);je(this,xf);je(this,Pm);fe(this,xf,[]),fe(this,Pm,0)}get data(){return cr(K(this,xf))}get length(){return K(this,Pm)}appendWriter(e){return wt(this,Uy,DT).call(this,qa(e.data))}writeBytes(e){let t=qa(e);const n=t.length%Ja;return n&&(t=qa(cr([t,uL.slice(n)]))),wt(this,Uy,DT).call(this,t)}writeValue(e){return wt(this,Uy,DT).call(this,RU(e))}writeUpdatableValue(){const e=K(this,xf).length;return K(this,xf).push(uL),fe(this,Pm,K(this,Pm)+Ja),t=>{K(this,xf)[e]=RU(t)}}}xf=new WeakMap,Pm=new WeakMap,Uy=new WeakSet,DT=function(e){return K(this,xf).push(e),fe(this,Pm,K(this,Pm)+e.length),e.length};var Ao,$o,Nm,Um,l0,Ag,pL,SG;const rP=class rP{constructor(e,t,n){je(this,Ag);he(this,"allowLoose");je(this,Ao);je(this,$o);je(this,Nm);je(this,Um);je(this,l0);yn(this,{allowLoose:!!t}),fe(this,Ao,qa(e)),fe(this,Nm,0),fe(this,Um,null),fe(this,l0,n??1024),fe(this,$o,0)}get data(){return Xt(K(this,Ao))}get dataLength(){return K(this,Ao).length}get consumed(){return K(this,$o)}get bytes(){return new Uint8Array(K(this,Ao))}subReader(e){const t=new rP(K(this,Ao).slice(K(this,$o)+e),this.allowLoose,K(this,l0));return fe(t,Um,this),t}readBytes(e,t){let n=wt(this,Ag,SG).call(this,0,e,!!t);return wt(this,Ag,pL).call(this,e),fe(this,$o,K(this,$o)+n.length),n.slice(0,e)}readValue(){return kw(this.readBytes(Ja))}readIndex(){return _J(this.readBytes(Ja))}};Ao=new WeakMap,$o=new WeakMap,Nm=new WeakMap,Um=new WeakMap,l0=new WeakMap,Ag=new WeakSet,pL=function(e){var t;if(K(this,Um))return wt(t=K(this,Um),Ag,pL).call(t,e);fe(this,Nm,K(this,Nm)+e),yt(K(this,l0)<1||K(this,Nm)<=K(this,l0)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${K(this,l0)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:qa(K(this,Ao)),offset:K(this,$o),length:e,info:{bytesRead:K(this,Nm),dataLength:this.dataLength}})},SG=function(e,t,n){let s=Math.ceil(t/Ja)*Ja;return K(this,$o)+s>K(this,Ao).length&&(this.allowLoose&&n&&K(this,$o)+t<=K(this,Ao).length?s=t:yt(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:qa(K(this,Ao)),length:K(this,Ao).length,offset:K(this,$o)+s})),K(this,Ao).slice(K(this,$o),K(this,$o)+s)};let dL=rP;function h3(i){if(!Number.isSafeInteger(i)||i<0)throw new Error(`Wrong positive integer: ${i}`)}function cB(i,...e){if(!(i instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(i.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${i.length}`)}function jJ(i){if(typeof i!="function"||typeof i.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");h3(i.outputLen),h3(i.blockLen)}function bv(i,e=!0){if(i.destroyed)throw new Error("Hash instance has been destroyed");if(e&&i.finished)throw new Error("Hash#digest() has already been called")}function TG(i,e){cB(i);const t=e.outputLen;if(i.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const ZC=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const wG=i=>i instanceof Uint8Array,qJ=i=>new Uint32Array(i.buffer,i.byteOffset,Math.floor(i.byteLength/4)),eR=i=>new DataView(i.buffer,i.byteOffset,i.byteLength),Fu=(i,e)=>i<<32-e|i>>>e,QJ=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!QJ)throw new Error("Non little-endian hardware is not supported");function $J(i){if(typeof i!="string")throw new Error(`utf8ToBytes expected string, got ${typeof i}`);return new Uint8Array(new TextEncoder().encode(i))}function Hw(i){if(typeof i=="string"&&(i=$J(i)),!wG(i))throw new Error(`expected Uint8Array, got ${typeof i}`);return i}function JJ(...i){const e=new Uint8Array(i.reduce((n,s)=>n+s.length,0));let t=0;return i.forEach(n=>{if(!wG(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}let uB=class{clone(){return this._cloneInto()}};function hB(i){const e=n=>i().update(Hw(n)).digest(),t=i();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>i(),e}function ZJ(i=32){if(ZC&&typeof ZC.getRandomValues=="function")return ZC.getRandomValues(new Uint8Array(i));throw new Error("crypto.getRandomValues must be defined")}class MG extends uB{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,jJ(e);const n=Hw(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,r=new Uint8Array(s);r.set(n.length>s?e.create().update(n).digest():n);for(let a=0;a<r.length;a++)r[a]^=54;this.iHash.update(r),this.oHash=e.create();for(let a=0;a<r.length;a++)r[a]^=106;this.oHash.update(r),r.fill(0)}update(e){return bv(this),this.iHash.update(e),this}digestInto(e){bv(this),cB(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:r,blockLen:a,outputLen:o}=this;return e=e,e.finished=s,e.destroyed=r,e.blockLen=a,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const CG=(i,e,t)=>new MG(i,e).update(t).digest();CG.create=(i,e)=>new MG(i,e);function eZ(i,e,t,n){if(typeof i.setBigUint64=="function")return i.setBigUint64(e,t,n);const s=BigInt(32),r=BigInt(4294967295),a=Number(t>>s&r),o=Number(t&r),l=n?4:0,c=n?0:4;i.setUint32(e+l,a,n),i.setUint32(e+c,o,n)}class RG extends uB{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=eR(this.buffer)}update(e){bv(this);const{view:t,buffer:n,blockLen:s}=this;e=Hw(e);const r=e.length;for(let a=0;a<r;){const o=Math.min(s-this.pos,r-a);if(o===s){const l=eR(e);for(;s<=r-a;a+=s)this.process(l,a);continue}n.set(e.subarray(a,a+o),this.pos),this.pos+=o,a+=o,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){bv(this),TG(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:r}=this;let{pos:a}=this;t[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>s-a&&(this.process(n,0),a=0);for(let d=a;d<s;d++)t[d]=0;eZ(n,s-8,BigInt(this.length*8),r),this.process(n,0);const o=eR(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=l/4,h=this.get();if(c>h.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<c;d++)o.setUint32(4*d,h[d],r)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:r,destroyed:a,pos:o}=this;return e.length=s,e.pos=o,e.finished=r,e.destroyed=a,s%t&&e.buffer.set(n),e}}const tZ=(i,e,t)=>i&e^~i&t,nZ=(i,e,t)=>i&e^i&t^e&t,iZ=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),kd=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Fd=new Uint32Array(64);class sZ extends RG{constructor(){super(64,32,8,!1),this.A=kd[0]|0,this.B=kd[1]|0,this.C=kd[2]|0,this.D=kd[3]|0,this.E=kd[4]|0,this.F=kd[5]|0,this.G=kd[6]|0,this.H=kd[7]|0}get(){const{A:e,B:t,C:n,D:s,E:r,F:a,G:o,H:l}=this;return[e,t,n,s,r,a,o,l]}set(e,t,n,s,r,a,o,l){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=r|0,this.F=a|0,this.G=o|0,this.H=l|0}process(e,t){for(let d=0;d<16;d++,t+=4)Fd[d]=e.getUint32(t,!1);for(let d=16;d<64;d++){const m=Fd[d-15],y=Fd[d-2],x=Fu(m,7)^Fu(m,18)^m>>>3,_=Fu(y,17)^Fu(y,19)^y>>>10;Fd[d]=_+Fd[d-7]+x+Fd[d-16]|0}let{A:n,B:s,C:r,D:a,E:o,F:l,G:c,H:h}=this;for(let d=0;d<64;d++){const m=Fu(o,6)^Fu(o,11)^Fu(o,25),y=h+m+tZ(o,l,c)+iZ[d]+Fd[d]|0,_=(Fu(n,2)^Fu(n,13)^Fu(n,22))+nZ(n,s,r)|0;h=c,c=l,l=o,o=a+y|0,a=r,r=s,s=n,n=y+_|0}n=n+this.A|0,s=s+this.B|0,r=r+this.C|0,a=a+this.D|0,o=o+this.E|0,l=l+this.F|0,c=c+this.G|0,h=h+this.H|0,this.set(n,s,r,a,o,l,c,h)}roundClean(){Fd.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const DG=hB(()=>new sZ),Z_=BigInt(2**32-1),mL=BigInt(32);function LG(i,e=!1){return e?{h:Number(i&Z_),l:Number(i>>mL&Z_)}:{h:Number(i>>mL&Z_)|0,l:Number(i&Z_)|0}}function IG(i,e=!1){let t=new Uint32Array(i.length),n=new Uint32Array(i.length);for(let s=0;s<i.length;s++){const{h:r,l:a}=LG(i[s],e);[t[s],n[s]]=[r,a]}return[t,n]}const rZ=(i,e)=>BigInt(i>>>0)<<mL|BigInt(e>>>0),aZ=(i,e,t)=>i>>>t,oZ=(i,e,t)=>i<<32-t|e>>>t,lZ=(i,e,t)=>i>>>t|e<<32-t,cZ=(i,e,t)=>i<<32-t|e>>>t,uZ=(i,e,t)=>i<<64-t|e>>>t-32,hZ=(i,e,t)=>i>>>t-32|e<<64-t,fZ=(i,e)=>e,dZ=(i,e)=>i,BG=(i,e,t)=>i<<t|e>>>32-t,OG=(i,e,t)=>e<<t|i>>>32-t,PG=(i,e,t)=>e<<t-32|i>>>64-t,NG=(i,e,t)=>i<<t-32|e>>>64-t;function pZ(i,e,t,n){const s=(e>>>0)+(n>>>0);return{h:i+t+(s/2**32|0)|0,l:s|0}}const mZ=(i,e,t)=>(i>>>0)+(e>>>0)+(t>>>0),gZ=(i,e,t,n)=>e+t+n+(i/2**32|0)|0,yZ=(i,e,t,n)=>(i>>>0)+(e>>>0)+(t>>>0)+(n>>>0),vZ=(i,e,t,n,s)=>e+t+n+s+(i/2**32|0)|0,xZ=(i,e,t,n,s)=>(i>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),bZ=(i,e,t,n,s,r)=>e+t+n+s+r+(i/2**32|0)|0,Yn={fromBig:LG,split:IG,toBig:rZ,shrSH:aZ,shrSL:oZ,rotrSH:lZ,rotrSL:cZ,rotrBH:uZ,rotrBL:hZ,rotr32H:fZ,rotr32L:dZ,rotlSH:BG,rotlSL:OG,rotlBH:PG,rotlBL:NG,add:pZ,add3L:mZ,add3H:gZ,add4L:yZ,add4H:vZ,add5H:bZ,add5L:xZ},[AZ,EZ]=Yn.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(i=>BigInt(i))),Hd=new Uint32Array(80),Gd=new Uint32Array(80);class _Z extends RG{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:r,Cl:a,Dh:o,Dl:l,Eh:c,El:h,Fh:d,Fl:m,Gh:y,Gl:x,Hh:_,Hl:b}=this;return[e,t,n,s,r,a,o,l,c,h,d,m,y,x,_,b]}set(e,t,n,s,r,a,o,l,c,h,d,m,y,x,_,b){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=r|0,this.Cl=a|0,this.Dh=o|0,this.Dl=l|0,this.Eh=c|0,this.El=h|0,this.Fh=d|0,this.Fl=m|0,this.Gh=y|0,this.Gl=x|0,this.Hh=_|0,this.Hl=b|0}process(e,t){for(let w=0;w<16;w++,t+=4)Hd[w]=e.getUint32(t),Gd[w]=e.getUint32(t+=4);for(let w=16;w<80;w++){const R=Hd[w-15]|0,O=Gd[w-15]|0,N=Yn.rotrSH(R,O,1)^Yn.rotrSH(R,O,8)^Yn.shrSH(R,O,7),U=Yn.rotrSL(R,O,1)^Yn.rotrSL(R,O,8)^Yn.shrSL(R,O,7),P=Hd[w-2]|0,B=Gd[w-2]|0,L=Yn.rotrSH(P,B,19)^Yn.rotrBH(P,B,61)^Yn.shrSH(P,B,6),F=Yn.rotrSL(P,B,19)^Yn.rotrBL(P,B,61)^Yn.shrSL(P,B,6),j=Yn.add4L(U,F,Gd[w-7],Gd[w-16]),J=Yn.add4H(j,N,L,Hd[w-7],Hd[w-16]);Hd[w]=J|0,Gd[w]=j|0}let{Ah:n,Al:s,Bh:r,Bl:a,Ch:o,Cl:l,Dh:c,Dl:h,Eh:d,El:m,Fh:y,Fl:x,Gh:_,Gl:b,Hh:A,Hl:T}=this;for(let w=0;w<80;w++){const R=Yn.rotrSH(d,m,14)^Yn.rotrSH(d,m,18)^Yn.rotrBH(d,m,41),O=Yn.rotrSL(d,m,14)^Yn.rotrSL(d,m,18)^Yn.rotrBL(d,m,41),N=d&y^~d&_,U=m&x^~m&b,P=Yn.add5L(T,O,U,EZ[w],Gd[w]),B=Yn.add5H(P,A,R,N,AZ[w],Hd[w]),L=P|0,F=Yn.rotrSH(n,s,28)^Yn.rotrBH(n,s,34)^Yn.rotrBH(n,s,39),j=Yn.rotrSL(n,s,28)^Yn.rotrBL(n,s,34)^Yn.rotrBL(n,s,39),J=n&r^n&o^r&o,re=s&a^s&l^a&l;A=_|0,T=b|0,_=y|0,b=x|0,y=d|0,x=m|0,{h:d,l:m}=Yn.add(c|0,h|0,B|0,L|0),c=o|0,h=l|0,o=r|0,l=a|0,r=n|0,a=s|0;const q=Yn.add3L(L,j,re);n=Yn.add3H(q,B,F,J),s=q|0}({h:n,l:s}=Yn.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:r,l:a}=Yn.add(this.Bh|0,this.Bl|0,r|0,a|0),{h:o,l}=Yn.add(this.Ch|0,this.Cl|0,o|0,l|0),{h:c,l:h}=Yn.add(this.Dh|0,this.Dl|0,c|0,h|0),{h:d,l:m}=Yn.add(this.Eh|0,this.El|0,d|0,m|0),{h:y,l:x}=Yn.add(this.Fh|0,this.Fl|0,y|0,x|0),{h:_,l:b}=Yn.add(this.Gh|0,this.Gl|0,_|0,b|0),{h:A,l:T}=Yn.add(this.Hh|0,this.Hl|0,A|0,T|0),this.set(n,s,r,a,o,l,c,h,d,m,y,x,_,b,A,T)}roundClean(){Hd.fill(0),Gd.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const SZ=hB(()=>new _Z);function TZ(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const DU=TZ(),LU=DU.crypto||DU.msCrypto;function wZ(i){switch(i){case"sha256":return DG.create();case"sha512":return SZ.create()}Se(!1,"invalid hashing algorithm name","algorithm",i)}function MZ(i){yt(LU!=null,"platform does not support secure random numbers","UNSUPPORTED_OPERATION",{operation:"randomBytes"}),Se(Number.isInteger(i)&&i>0&&i<=1024,"invalid length","length",i);const e=new Uint8Array(i);return LU.getRandomValues(e),e}const[UG,kG,FG]=[[],[],[]],CZ=BigInt(0),bb=BigInt(1),RZ=BigInt(2),DZ=BigInt(7),LZ=BigInt(256),IZ=BigInt(113);for(let i=0,e=bb,t=1,n=0;i<24;i++){[t,n]=[n,(2*t+3*n)%5],UG.push(2*(5*n+t)),kG.push((i+1)*(i+2)/2%64);let s=CZ;for(let r=0;r<7;r++)e=(e<<bb^(e>>DZ)*IZ)%LZ,e&RZ&&(s^=bb<<(bb<<BigInt(r))-bb);FG.push(s)}const[BZ,OZ]=IG(FG,!0),IU=(i,e,t)=>t>32?PG(i,e,t):BG(i,e,t),BU=(i,e,t)=>t>32?NG(i,e,t):OG(i,e,t);function PZ(i,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let a=0;a<10;a++)t[a]=i[a]^i[a+10]^i[a+20]^i[a+30]^i[a+40];for(let a=0;a<10;a+=2){const o=(a+8)%10,l=(a+2)%10,c=t[l],h=t[l+1],d=IU(c,h,1)^t[o],m=BU(c,h,1)^t[o+1];for(let y=0;y<50;y+=10)i[a+y]^=d,i[a+y+1]^=m}let s=i[2],r=i[3];for(let a=0;a<24;a++){const o=kG[a],l=IU(s,r,o),c=BU(s,r,o),h=UG[a];s=i[h],r=i[h+1],i[h]=l,i[h+1]=c}for(let a=0;a<50;a+=10){for(let o=0;o<10;o++)t[o]=i[a+o];for(let o=0;o<10;o++)i[a+o]^=~t[(o+2)%10]&t[(o+4)%10]}i[0]^=BZ[n],i[1]^=OZ[n]}t.fill(0)}let NZ=class HG extends uB{constructor(e,t,n,s=!1,r=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=r,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,h3(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=qJ(this.state)}keccak(){PZ(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){bv(this);const{blockLen:t,state:n}=this;e=Hw(e);const s=e.length;for(let r=0;r<s;){const a=Math.min(t-this.pos,s-r);for(let o=0;o<a;o++)n[this.pos++]^=e[r++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,(t&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){bv(this,!1),cB(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,r=e.length;s<r;){this.posOut>=n&&this.keccak();const a=Math.min(n-this.posOut,r-s);e.set(t.subarray(this.posOut,this.posOut+a),s),this.posOut+=a,s+=a}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return h3(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(TG(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:r,enableXOF:a}=this;return e||(e=new HG(t,n,s,a,r)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=r,e.suffix=n,e.outputLen=s,e.enableXOF=a,e.destroyed=this.destroyed,e}};const UZ=(i,e,t)=>hB(()=>new NZ(e,i,t)),kZ=UZ(1,136,256/8);let GG=!1;const zG=function(i){return kZ(i)};let VG=zG;function ir(i){const e=mi(i,"data");return Xt(VG(e))}ir._=zG;ir.lock=function(){GG=!0};ir.register=function(i){if(GG)throw new TypeError("keccak256 is locked");VG=i};Object.freeze(ir);let YG=!1;const KG=function(i){return new Uint8Array(MZ(i))};let WG=KG;function DE(i){return WG(i)}DE._=KG;DE.lock=function(){YG=!0};DE.register=function(i){if(YG)throw new Error("randomBytes is locked");WG=i};Object.freeze(DE);const XG=function(i){return wZ("sha256").update(i).digest()};let jG=XG,qG=!1;function Kv(i){const e=mi(i,"data");return Xt(jG(e))}Kv._=XG;Kv.lock=function(){qG=!0};Kv.register=function(i){if(qG)throw new Error("sha256 is locked");jG=i};Object.freeze(Kv);Object.freeze(Kv);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const QG=BigInt(0),Gw=BigInt(1),FZ=BigInt(2),zw=i=>i instanceof Uint8Array,HZ=Array.from({length:256},(i,e)=>e.toString(16).padStart(2,"0"));function Av(i){if(!zw(i))throw new Error("Uint8Array expected");let e="";for(let t=0;t<i.length;t++)e+=HZ[i[t]];return e}function $G(i){const e=i.toString(16);return e.length&1?`0${e}`:e}function fB(i){if(typeof i!="string")throw new Error("hex string expected, got "+typeof i);return BigInt(i===""?"0":`0x${i}`)}function Ev(i){if(typeof i!="string")throw new Error("hex string expected, got "+typeof i);const e=i.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let n=0;n<t.length;n++){const s=n*2,r=i.slice(s,s+2),a=Number.parseInt(r,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");t[n]=a}return t}function Qm(i){return fB(Av(i))}function dB(i){if(!zw(i))throw new Error("Uint8Array expected");return fB(Av(Uint8Array.from(i).reverse()))}function _v(i,e){return Ev(i.toString(16).padStart(e*2,"0"))}function pB(i,e){return _v(i,e).reverse()}function GZ(i){return Ev($G(i))}function Dc(i,e,t){let n;if(typeof e=="string")try{n=Ev(e)}catch(r){throw new Error(`${i} must be valid hex string, got "${e}". Cause: ${r}`)}else if(zw(e))n=Uint8Array.from(e);else throw new Error(`${i} must be hex string or Uint8Array`);const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(`${i} expected ${t} bytes, got ${s}`);return n}function FA(...i){const e=new Uint8Array(i.reduce((n,s)=>n+s.length,0));let t=0;return i.forEach(n=>{if(!zw(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}function zZ(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!==e[t])return!1;return!0}function VZ(i){if(typeof i!="string")throw new Error(`utf8ToBytes expected string, got ${typeof i}`);return new Uint8Array(new TextEncoder().encode(i))}function YZ(i){let e;for(e=0;i>QG;i>>=Gw,e+=1);return e}function KZ(i,e){return i>>BigInt(e)&Gw}const WZ=(i,e,t)=>i|(t?Gw:QG)<<BigInt(e),mB=i=>(FZ<<BigInt(i-1))-Gw,tR=i=>new Uint8Array(i),OU=i=>Uint8Array.from(i);function JG(i,e,t){if(typeof i!="number"||i<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=tR(i),s=tR(i),r=0;const a=()=>{n.fill(1),s.fill(0),r=0},o=(...d)=>t(s,n,...d),l=(d=tR())=>{s=o(OU([0]),d),n=o(),d.length!==0&&(s=o(OU([1]),d),n=o())},c=()=>{if(r++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const m=[];for(;d<e;){n=o();const y=n.slice();m.push(y),d+=n.length}return FA(...m)};return(d,m)=>{a(),l(d);let y;for(;!(y=m(c()));)l();return a(),y}}const XZ={bigint:i=>typeof i=="bigint",function:i=>typeof i=="function",boolean:i=>typeof i=="boolean",string:i=>typeof i=="string",stringOrUint8Array:i=>typeof i=="string"||i instanceof Uint8Array,isSafeInteger:i=>Number.isSafeInteger(i),array:i=>Array.isArray(i),field:(i,e)=>e.Fp.isValid(i),hash:i=>typeof i=="function"&&Number.isSafeInteger(i.outputLen)};function LE(i,e,t={}){const n=(s,r,a)=>{const o=XZ[r];if(typeof o!="function")throw new Error(`Invalid validator "${r}", expected function`);const l=i[s];if(!(a&&l===void 0)&&!o(l,i))throw new Error(`Invalid param ${String(s)}=${l} (${typeof l}), expected ${r}`)};for(const[s,r]of Object.entries(e))n(s,r,!1);for(const[s,r]of Object.entries(t))n(s,r,!0);return i}const jZ=Object.freeze(Object.defineProperty({__proto__:null,bitGet:KZ,bitLen:YZ,bitMask:mB,bitSet:WZ,bytesToHex:Av,bytesToNumberBE:Qm,bytesToNumberLE:dB,concatBytes:FA,createHmacDrbg:JG,ensureBytes:Dc,equalBytes:zZ,hexToBytes:Ev,hexToNumber:fB,numberToBytesBE:_v,numberToBytesLE:pB,numberToHexUnpadded:$G,numberToVarBytesBE:GZ,utf8ToBytes:VZ,validateObject:LE},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Vr=BigInt(0),tr=BigInt(1),fm=BigInt(2),qZ=BigInt(3),gL=BigInt(4),PU=BigInt(5),NU=BigInt(8);BigInt(9);BigInt(16);function _o(i,e){const t=i%e;return t>=Vr?t:e+t}function QZ(i,e,t){if(t<=Vr||e<Vr)throw new Error("Expected power/modulo > 0");if(t===tr)return Vr;let n=tr;for(;e>Vr;)e&tr&&(n=n*i%t),i=i*i%t,e>>=tr;return n}function El(i,e,t){let n=i;for(;e-- >Vr;)n*=n,n%=t;return n}function yL(i,e){if(i===Vr||e<=Vr)throw new Error(`invert: expected positive integers, got n=${i} mod=${e}`);let t=_o(i,e),n=e,s=Vr,r=tr;for(;t!==Vr;){const o=n/t,l=n%t,c=s-r*o;n=t,t=l,s=r,r=c}if(n!==tr)throw new Error("invert: does not exist");return _o(s,e)}function $Z(i){const e=(i-tr)/fm;let t,n,s;for(t=i-tr,n=0;t%fm===Vr;t/=fm,n++);for(s=fm;s<i&&QZ(s,e,i)!==i-tr;s++);if(n===1){const a=(i+tr)/gL;return function(l,c){const h=l.pow(c,a);if(!l.eql(l.sqr(h),c))throw new Error("Cannot find square root");return h}}const r=(t+tr)/fm;return function(o,l){if(o.pow(l,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,h=o.pow(o.mul(o.ONE,s),t),d=o.pow(l,r),m=o.pow(l,t);for(;!o.eql(m,o.ONE);){if(o.eql(m,o.ZERO))return o.ZERO;let y=1;for(let _=o.sqr(m);y<c&&!o.eql(_,o.ONE);y++)_=o.sqr(_);const x=o.pow(h,tr<<BigInt(c-y-1));h=o.sqr(x),d=o.mul(d,x),m=o.mul(m,h),c=y}return d}}function JZ(i){if(i%gL===qZ){const e=(i+tr)/gL;return function(n,s){const r=n.pow(s,e);if(!n.eql(n.sqr(r),s))throw new Error("Cannot find square root");return r}}if(i%NU===PU){const e=(i-PU)/NU;return function(n,s){const r=n.mul(s,fm),a=n.pow(r,e),o=n.mul(s,a),l=n.mul(n.mul(o,fm),a),c=n.mul(o,n.sub(l,n.ONE));if(!n.eql(n.sqr(c),s))throw new Error("Cannot find square root");return c}}return $Z(i)}const ZZ=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function eee(i){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=ZZ.reduce((n,s)=>(n[s]="function",n),e);return LE(i,t)}function tee(i,e,t){if(t<Vr)throw new Error("Expected power > 0");if(t===Vr)return i.ONE;if(t===tr)return e;let n=i.ONE,s=e;for(;t>Vr;)t&tr&&(n=i.mul(n,s)),s=i.sqr(s),t>>=tr;return n}function nee(i,e){const t=new Array(e.length),n=e.reduce((r,a,o)=>i.is0(a)?r:(t[o]=r,i.mul(r,a)),i.ONE),s=i.inv(n);return e.reduceRight((r,a,o)=>i.is0(a)?r:(t[o]=i.mul(r,t[o]),i.mul(r,a)),s),t}function ZG(i,e){const t=e!==void 0?e:i.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function iee(i,e,t=!1,n={}){if(i<=Vr)throw new Error(`Expected Field ORDER > 0, got ${i}`);const{nBitLength:s,nByteLength:r}=ZG(i,e);if(r>2048)throw new Error("Field lengths over 2048 bytes are not supported");const a=JZ(i),o=Object.freeze({ORDER:i,BITS:s,BYTES:r,MASK:mB(s),ZERO:Vr,ONE:tr,create:l=>_o(l,i),isValid:l=>{if(typeof l!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof l}`);return Vr<=l&&l<i},is0:l=>l===Vr,isOdd:l=>(l&tr)===tr,neg:l=>_o(-l,i),eql:(l,c)=>l===c,sqr:l=>_o(l*l,i),add:(l,c)=>_o(l+c,i),sub:(l,c)=>_o(l-c,i),mul:(l,c)=>_o(l*c,i),pow:(l,c)=>tee(o,l,c),div:(l,c)=>_o(l*yL(c,i),i),sqrN:l=>l*l,addN:(l,c)=>l+c,subN:(l,c)=>l-c,mulN:(l,c)=>l*c,inv:l=>yL(l,i),sqrt:n.sqrt||(l=>a(o,l)),invertBatch:l=>nee(o,l),cmov:(l,c,h)=>h?c:l,toBytes:l=>t?pB(l,r):_v(l,r),fromBytes:l=>{if(l.length!==r)throw new Error(`Fp.fromBytes: expected ${r}, got ${l.length}`);return t?dB(l):Qm(l)}});return Object.freeze(o)}function ez(i){if(typeof i!="bigint")throw new Error("field order must be bigint");const e=i.toString(2).length;return Math.ceil(e/8)}function tz(i){const e=ez(i);return e+Math.ceil(e/2)}function see(i,e,t=!1){const n=i.length,s=ez(e),r=tz(e);if(n<16||n<r||n>1024)throw new Error(`expected ${r}-1024 bytes of input, got ${n}`);const a=t?Qm(i):dB(i),o=_o(a,e-tr)+tr;return t?pB(o,s):_v(o,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ree=BigInt(0),nR=BigInt(1);function aee(i,e){const t=(s,r)=>{const a=r.negate();return s?a:r},n=s=>{const r=Math.ceil(e/s)+1,a=2**(s-1);return{windows:r,windowSize:a}};return{constTimeNegate:t,unsafeLadder(s,r){let a=i.ZERO,o=s;for(;r>ree;)r&nR&&(a=a.add(o)),o=o.double(),r>>=nR;return a},precomputeWindow(s,r){const{windows:a,windowSize:o}=n(r),l=[];let c=s,h=c;for(let d=0;d<a;d++){h=c,l.push(h);for(let m=1;m<o;m++)h=h.add(c),l.push(h);c=h.double()}return l},wNAF(s,r,a){const{windows:o,windowSize:l}=n(s);let c=i.ZERO,h=i.BASE;const d=BigInt(2**s-1),m=2**s,y=BigInt(s);for(let x=0;x<o;x++){const _=x*l;let b=Number(a&d);a>>=y,b>l&&(b-=m,a+=nR);const A=_,T=_+Math.abs(b)-1,w=x%2!==0,R=b<0;b===0?h=h.add(t(w,r[A])):c=c.add(t(R,r[T]))}return{p:c,f:h}},wNAFCached(s,r,a,o){const l=s._WINDOW_SIZE||1;let c=r.get(s);return c||(c=this.precomputeWindow(s,l),l!==1&&r.set(s,o(c))),this.wNAF(l,c,a)}}}function nz(i){return eee(i.Fp),LE(i,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ZG(i.n,i.nBitLength),...i,p:i.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function oee(i){const e=nz(i);LE(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:lee,hexToBytes:cee}=jZ,ym={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(i){const{Err:e}=ym;if(i.length<2||i[0]!==2)throw new e("Invalid signature integer tag");const t=i[1],n=i.subarray(2,t+2);if(!t||n.length!==t)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:lee(n),l:i.subarray(t+2)}},toSig(i){const{Err:e}=ym,t=typeof i=="string"?cee(i):i;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let n=t.length;if(n<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:s,l:r}=ym._parseInt(t.subarray(2)),{d:a,l:o}=ym._parseInt(r);if(o.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:a}},hexFromSig(i){const e=c=>Number.parseInt(c[0],16)&8?"00"+c:c,t=c=>{const h=c.toString(16);return h.length&1?`0${h}`:h},n=e(t(i.s)),s=e(t(i.r)),r=n.length/2,a=s.length/2,o=t(r),l=t(a);return`30${t(a+r+4)}02${l}${s}02${o}${n}`}},Df=BigInt(0),Ol=BigInt(1);BigInt(2);const UU=BigInt(3);BigInt(4);function uee(i){const e=oee(i),{Fp:t}=e,n=e.toBytes||((x,_,b)=>{const A=_.toAffine();return FA(Uint8Array.from([4]),t.toBytes(A.x),t.toBytes(A.y))}),s=e.fromBytes||(x=>{const _=x.subarray(1),b=t.fromBytes(_.subarray(0,t.BYTES)),A=t.fromBytes(_.subarray(t.BYTES,2*t.BYTES));return{x:b,y:A}});function r(x){const{a:_,b}=e,A=t.sqr(x),T=t.mul(A,x);return t.add(t.add(T,t.mul(x,_)),b)}if(!t.eql(t.sqr(e.Gy),r(e.Gx)))throw new Error("bad generator point: equation left != right");function a(x){return typeof x=="bigint"&&Df<x&&x<e.n}function o(x){if(!a(x))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(x){const{allowedPrivateKeyLengths:_,nByteLength:b,wrapPrivateKey:A,n:T}=e;if(_&&typeof x!="bigint"){if(x instanceof Uint8Array&&(x=Av(x)),typeof x!="string"||!_.includes(x.length))throw new Error("Invalid key");x=x.padStart(b*2,"0")}let w;try{w=typeof x=="bigint"?x:Qm(Dc("private key",x,b))}catch{throw new Error(`private key must be ${b} bytes, hex or bigint, not ${typeof x}`)}return A&&(w=_o(w,T)),o(w),w}const c=new Map;function h(x){if(!(x instanceof d))throw new Error("ProjectivePoint expected")}class d{constructor(_,b,A){if(this.px=_,this.py=b,this.pz=A,_==null||!t.isValid(_))throw new Error("x required");if(b==null||!t.isValid(b))throw new Error("y required");if(A==null||!t.isValid(A))throw new Error("z required")}static fromAffine(_){const{x:b,y:A}=_||{};if(!_||!t.isValid(b)||!t.isValid(A))throw new Error("invalid affine point");if(_ instanceof d)throw new Error("projective point not allowed");const T=w=>t.eql(w,t.ZERO);return T(b)&&T(A)?d.ZERO:new d(b,A,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(_){const b=t.invertBatch(_.map(A=>A.pz));return _.map((A,T)=>A.toAffine(b[T])).map(d.fromAffine)}static fromHex(_){const b=d.fromAffine(s(Dc("pointHex",_)));return b.assertValidity(),b}static fromPrivateKey(_){return d.BASE.multiply(l(_))}_setWindowSize(_){this._WINDOW_SIZE=_,c.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:_,y:b}=this.toAffine();if(!t.isValid(_)||!t.isValid(b))throw new Error("bad point: x or y not FE");const A=t.sqr(b),T=r(_);if(!t.eql(A,T))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:_}=this.toAffine();if(t.isOdd)return!t.isOdd(_);throw new Error("Field doesn't support isOdd")}equals(_){h(_);const{px:b,py:A,pz:T}=this,{px:w,py:R,pz:O}=_,N=t.eql(t.mul(b,O),t.mul(w,T)),U=t.eql(t.mul(A,O),t.mul(R,T));return N&&U}negate(){return new d(this.px,t.neg(this.py),this.pz)}double(){const{a:_,b}=e,A=t.mul(b,UU),{px:T,py:w,pz:R}=this;let O=t.ZERO,N=t.ZERO,U=t.ZERO,P=t.mul(T,T),B=t.mul(w,w),L=t.mul(R,R),F=t.mul(T,w);return F=t.add(F,F),U=t.mul(T,R),U=t.add(U,U),O=t.mul(_,U),N=t.mul(A,L),N=t.add(O,N),O=t.sub(B,N),N=t.add(B,N),N=t.mul(O,N),O=t.mul(F,O),U=t.mul(A,U),L=t.mul(_,L),F=t.sub(P,L),F=t.mul(_,F),F=t.add(F,U),U=t.add(P,P),P=t.add(U,P),P=t.add(P,L),P=t.mul(P,F),N=t.add(N,P),L=t.mul(w,R),L=t.add(L,L),P=t.mul(L,F),O=t.sub(O,P),U=t.mul(L,B),U=t.add(U,U),U=t.add(U,U),new d(O,N,U)}add(_){h(_);const{px:b,py:A,pz:T}=this,{px:w,py:R,pz:O}=_;let N=t.ZERO,U=t.ZERO,P=t.ZERO;const B=e.a,L=t.mul(e.b,UU);let F=t.mul(b,w),j=t.mul(A,R),J=t.mul(T,O),re=t.add(b,A),q=t.add(w,R);re=t.mul(re,q),q=t.add(F,j),re=t.sub(re,q),q=t.add(b,T);let W=t.add(w,O);return q=t.mul(q,W),W=t.add(F,J),q=t.sub(q,W),W=t.add(A,T),N=t.add(R,O),W=t.mul(W,N),N=t.add(j,J),W=t.sub(W,N),P=t.mul(B,q),N=t.mul(L,J),P=t.add(N,P),N=t.sub(j,P),P=t.add(j,P),U=t.mul(N,P),j=t.add(F,F),j=t.add(j,F),J=t.mul(B,J),q=t.mul(L,q),j=t.add(j,J),J=t.sub(F,J),J=t.mul(B,J),q=t.add(q,J),F=t.mul(j,q),U=t.add(U,F),F=t.mul(W,q),N=t.mul(re,N),N=t.sub(N,F),F=t.mul(re,j),P=t.mul(W,P),P=t.add(P,F),new d(N,U,P)}subtract(_){return this.add(_.negate())}is0(){return this.equals(d.ZERO)}wNAF(_){return y.wNAFCached(this,c,_,b=>{const A=t.invertBatch(b.map(T=>T.pz));return b.map((T,w)=>T.toAffine(A[w])).map(d.fromAffine)})}multiplyUnsafe(_){const b=d.ZERO;if(_===Df)return b;if(o(_),_===Ol)return this;const{endo:A}=e;if(!A)return y.unsafeLadder(this,_);let{k1neg:T,k1:w,k2neg:R,k2:O}=A.splitScalar(_),N=b,U=b,P=this;for(;w>Df||O>Df;)w&Ol&&(N=N.add(P)),O&Ol&&(U=U.add(P)),P=P.double(),w>>=Ol,O>>=Ol;return T&&(N=N.negate()),R&&(U=U.negate()),U=new d(t.mul(U.px,A.beta),U.py,U.pz),N.add(U)}multiply(_){o(_);let b=_,A,T;const{endo:w}=e;if(w){const{k1neg:R,k1:O,k2neg:N,k2:U}=w.splitScalar(b);let{p:P,f:B}=this.wNAF(O),{p:L,f:F}=this.wNAF(U);P=y.constTimeNegate(R,P),L=y.constTimeNegate(N,L),L=new d(t.mul(L.px,w.beta),L.py,L.pz),A=P.add(L),T=B.add(F)}else{const{p:R,f:O}=this.wNAF(b);A=R,T=O}return d.normalizeZ([A,T])[0]}multiplyAndAddUnsafe(_,b,A){const T=d.BASE,w=(O,N)=>N===Df||N===Ol||!O.equals(T)?O.multiplyUnsafe(N):O.multiply(N),R=w(this,b).add(w(_,A));return R.is0()?void 0:R}toAffine(_){const{px:b,py:A,pz:T}=this,w=this.is0();_==null&&(_=w?t.ONE:t.inv(T));const R=t.mul(b,_),O=t.mul(A,_),N=t.mul(T,_);if(w)return{x:t.ZERO,y:t.ZERO};if(!t.eql(N,t.ONE))throw new Error("invZ was invalid");return{x:R,y:O}}isTorsionFree(){const{h:_,isTorsionFree:b}=e;if(_===Ol)return!0;if(b)return b(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:_,clearCofactor:b}=e;return _===Ol?this:b?b(d,this):this.multiplyUnsafe(e.h)}toRawBytes(_=!0){return this.assertValidity(),n(d,this,_)}toHex(_=!0){return Av(this.toRawBytes(_))}}d.BASE=new d(e.Gx,e.Gy,t.ONE),d.ZERO=new d(t.ZERO,t.ONE,t.ZERO);const m=e.nBitLength,y=aee(d,e.endo?Math.ceil(m/2):m);return{CURVE:e,ProjectivePoint:d,normPrivateKeyToScalar:l,weierstrassEquation:r,isWithinCurveOrder:a}}function hee(i){const e=nz(i);return LE(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function fee(i){const e=hee(i),{Fp:t,n}=e,s=t.BYTES+1,r=2*t.BYTES+1;function a(q){return Df<q&&q<t.ORDER}function o(q){return _o(q,n)}function l(q){return yL(q,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:h,weierstrassEquation:d,isWithinCurveOrder:m}=uee({...e,toBytes(q,W,ne){const ie=W.toAffine(),ue=t.toBytes(ie.x),z=FA;return ne?z(Uint8Array.from([W.hasEvenY()?2:3]),ue):z(Uint8Array.from([4]),ue,t.toBytes(ie.y))},fromBytes(q){const W=q.length,ne=q[0],ie=q.subarray(1);if(W===s&&(ne===2||ne===3)){const ue=Qm(ie);if(!a(ue))throw new Error("Point is not on curve");const z=d(ue);let ae=t.sqrt(z);const ge=(ae&Ol)===Ol;return(ne&1)===1!==ge&&(ae=t.neg(ae)),{x:ue,y:ae}}else if(W===r&&ne===4){const ue=t.fromBytes(ie.subarray(0,t.BYTES)),z=t.fromBytes(ie.subarray(t.BYTES,2*t.BYTES));return{x:ue,y:z}}else throw new Error(`Point of length ${W} was invalid. Expected ${s} compressed bytes or ${r} uncompressed bytes`)}}),y=q=>Av(_v(q,e.nByteLength));function x(q){const W=n>>Ol;return q>W}function _(q){return x(q)?o(-q):q}const b=(q,W,ne)=>Qm(q.slice(W,ne));class A{constructor(W,ne,ie){this.r=W,this.s=ne,this.recovery=ie,this.assertValidity()}static fromCompact(W){const ne=e.nByteLength;return W=Dc("compactSignature",W,ne*2),new A(b(W,0,ne),b(W,ne,2*ne))}static fromDER(W){const{r:ne,s:ie}=ym.toSig(Dc("DER",W));return new A(ne,ie)}assertValidity(){if(!m(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!m(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(W){return new A(this.r,this.s,W)}recoverPublicKey(W){const{r:ne,s:ie,recovery:ue}=this,z=U(Dc("msgHash",W));if(ue==null||![0,1,2,3].includes(ue))throw new Error("recovery id invalid");const ae=ue===2||ue===3?ne+e.n:ne;if(ae>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const ge=(ue&1)===0?"02":"03",Ee=c.fromHex(ge+y(ae)),le=l(ae),Ce=o(-z*le),Me=o(ie*le),Ze=c.BASE.multiplyAndAddUnsafe(Ee,Ce,Me);if(!Ze)throw new Error("point at infinify");return Ze.assertValidity(),Ze}hasHighS(){return x(this.s)}normalizeS(){return this.hasHighS()?new A(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return Ev(this.toDERHex())}toDERHex(){return ym.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Ev(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}const T={isValidPrivateKey(q){try{return h(q),!0}catch{return!1}},normPrivateKeyToScalar:h,randomPrivateKey:()=>{const q=tz(e.n);return see(e.randomBytes(q),e.n)},precompute(q=8,W=c.BASE){return W._setWindowSize(q),W.multiply(BigInt(3)),W}};function w(q,W=!0){return c.fromPrivateKey(q).toRawBytes(W)}function R(q){const W=q instanceof Uint8Array,ne=typeof q=="string",ie=(W||ne)&&q.length;return W?ie===s||ie===r:ne?ie===2*s||ie===2*r:q instanceof c}function O(q,W,ne=!0){if(R(q))throw new Error("first arg must be private key");if(!R(W))throw new Error("second arg must be public key");return c.fromHex(W).multiply(h(q)).toRawBytes(ne)}const N=e.bits2int||function(q){const W=Qm(q),ne=q.length*8-e.nBitLength;return ne>0?W>>BigInt(ne):W},U=e.bits2int_modN||function(q){return o(N(q))},P=mB(e.nBitLength);function B(q){if(typeof q!="bigint")throw new Error("bigint expected");if(!(Df<=q&&q<P))throw new Error(`bigint expected < 2^${e.nBitLength}`);return _v(q,e.nByteLength)}function L(q,W,ne=F){if(["recovered","canonical"].some(Mt=>Mt in ne))throw new Error("sign() legacy options not supported");const{hash:ie,randomBytes:ue}=e;let{lowS:z,prehash:ae,extraEntropy:ge}=ne;z==null&&(z=!0),q=Dc("msgHash",q),ae&&(q=Dc("prehashed msgHash",ie(q)));const Ee=U(q),le=h(W),Ce=[B(le),B(Ee)];if(ge!=null){const Mt=ge===!0?ue(t.BYTES):ge;Ce.push(Dc("extraEntropy",Mt))}const Me=FA(...Ce),Ze=Ee;function tt(Mt){const bt=N(Mt);if(!m(bt))return;const cn=l(bt),tn=c.BASE.multiply(bt).toAffine(),Ot=o(tn.x);if(Ot===Df)return;const te=o(cn*o(Ze+Ot*le));if(te===Df)return;let At=(tn.x===Ot?0:2)|Number(tn.y&Ol),Ve=te;return z&&x(te)&&(Ve=_(te),At^=1),new A(Ot,Ve,At)}return{seed:Me,k2sig:tt}}const F={lowS:e.lowS,prehash:!1},j={lowS:e.lowS,prehash:!1};function J(q,W,ne=F){const{seed:ie,k2sig:ue}=L(q,W,ne),z=e;return JG(z.hash.outputLen,z.nByteLength,z.hmac)(ie,ue)}c.BASE._setWindowSize(8);function re(q,W,ne,ie=j){var tn;const ue=q;if(W=Dc("msgHash",W),ne=Dc("publicKey",ne),"strict"in ie)throw new Error("options.strict was renamed to lowS");const{lowS:z,prehash:ae}=ie;let ge,Ee;try{if(typeof ue=="string"||ue instanceof Uint8Array)try{ge=A.fromDER(ue)}catch(Ot){if(!(Ot instanceof ym.Err))throw Ot;ge=A.fromCompact(ue)}else if(typeof ue=="object"&&typeof ue.r=="bigint"&&typeof ue.s=="bigint"){const{r:Ot,s:te}=ue;ge=new A(Ot,te)}else throw new Error("PARSE");Ee=c.fromHex(ne)}catch(Ot){if(Ot.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(z&&ge.hasHighS())return!1;ae&&(W=e.hash(W));const{r:le,s:Ce}=ge,Me=U(W),Ze=l(Ce),tt=o(Me*Ze),Mt=o(le*Ze),bt=(tn=c.BASE.multiplyAndAddUnsafe(Ee,tt,Mt))==null?void 0:tn.toAffine();return bt?o(bt.x)===le:!1}return{CURVE:e,getPublicKey:w,getSharedSecret:O,sign:J,verify:re,ProjectivePoint:c,Signature:A,utils:T}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function dee(i){return{hash:i,hmac:(e,...t)=>CG(i,e,JJ(...t)),randomBytes:ZJ}}function pee(i,e){const t=n=>fee({...i,...dee(n)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const iz=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),kU=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),mee=BigInt(1),vL=BigInt(2),FU=(i,e)=>(i+e/vL)/e;function gee(i){const e=iz,t=BigInt(3),n=BigInt(6),s=BigInt(11),r=BigInt(22),a=BigInt(23),o=BigInt(44),l=BigInt(88),c=i*i*i%e,h=c*c*i%e,d=El(h,t,e)*h%e,m=El(d,t,e)*h%e,y=El(m,vL,e)*c%e,x=El(y,s,e)*y%e,_=El(x,r,e)*x%e,b=El(_,o,e)*_%e,A=El(b,l,e)*b%e,T=El(A,o,e)*_%e,w=El(T,t,e)*h%e,R=El(w,a,e)*x%e,O=El(R,n,e)*c%e,N=El(O,vL,e);if(!xL.eql(xL.sqr(N),i))throw new Error("Cannot find square root");return N}const xL=iee(iz,void 0,void 0,{sqrt:gee}),e0=pee({a:BigInt(0),b:BigInt(7),Fp:xL,n:kU,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:i=>{const e=kU,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-mee*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),r=t,a=BigInt("0x100000000000000000000000000000000"),o=FU(r*i,e),l=FU(-n*i,e);let c=_o(i-o*t-l*s,e),h=_o(-o*n-l*r,e);const d=c>a,m=h>a;if(d&&(c=e-c),m&&(h=e-h),c>a||h>a)throw new Error("splitScalar: Endomorphism failed, k="+i);return{k1neg:d,k1:c,k2neg:m,k2:h}}}},DG);BigInt(0);e0.ProjectivePoint;const HA="0x0000000000000000000000000000000000000000",HU="0x0000000000000000000000000000000000000000000000000000000000000000",GU=BigInt(0),zU=BigInt(1),VU=BigInt(2),YU=BigInt(27),KU=BigInt(28),eS=BigInt(35),L2={};function WU(i){return sg($a(i),32)}var ky,Fy,Hy,km;const Cc=class Cc{constructor(e,t,n,s){je(this,ky);je(this,Fy);je(this,Hy);je(this,km);RE(e,L2,"Signature"),fe(this,ky,t),fe(this,Fy,n),fe(this,Hy,s),fe(this,km,null)}get r(){return K(this,ky)}set r(e){Se(by(e)===32,"invalid r","value",e),fe(this,ky,Xt(e))}get s(){return K(this,Fy)}set s(e){Se(by(e)===32,"invalid s","value",e);const t=Xt(e);Se(parseInt(t.substring(0,3))<8,"non-canonical s","value",t),fe(this,Fy,t)}get v(){return K(this,Hy)}set v(e){const t=Gn(e,"value");Se(t===27||t===28,"invalid v","v",e),fe(this,Hy,t)}get networkV(){return K(this,km)}get legacyChainId(){const e=this.networkV;return e==null?null:Cc.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=mi(this.s);return this.yParity&&(e[0]|=128),Xt(e)}get compactSerialized(){return cr([this.r,this.yParityAndS])}get serialized(){return cr([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this.s}", yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new Cc(L2,this.r,this.s,this.v);return this.networkV&&fe(e,km,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this.s,v:this.v}}static getChainId(e){const t=en(e,"v");return t==YU||t==KU?GU:(Se(t>=eS,"invalid EIP-155 v","v",e),(t-eS)/VU)}static getChainIdV(e,t){return en(e)*VU+BigInt(35+t-27)}static getNormalizedV(e){const t=en(e);return t===GU||t===YU?27:t===zU||t===KU?28:(Se(t>=eS,"invalid v","v",e),t&zU?27:28)}static from(e){function t(c,h){Se(c,h,"signature",e)}if(e==null)return new Cc(L2,HU,HU,27);if(typeof e=="string"){const c=mi(e,"signature");if(c.length===64){const h=Xt(c.slice(0,32)),d=c.slice(32,64),m=d[0]&128?28:27;return d[0]&=127,new Cc(L2,h,Xt(d),m)}if(c.length===65){const h=Xt(c.slice(0,32)),d=c.slice(32,64);t((d[0]&128)===0,"non-canonical s");const m=Cc.getNormalizedV(c[64]);return new Cc(L2,h,Xt(d),m)}t(!1,"invalid raw signature length")}if(e instanceof Cc)return e.clone();const n=e.r;t(n!=null,"missing r");const s=WU(n),r=function(c,h){if(c!=null)return WU(c);if(h!=null){t(ls(h,32),"invalid yParityAndS");const d=mi(h);return d[0]&=127,Xt(d)}t(!1,"missing s")}(e.s,e.yParityAndS);t((mi(r)[0]&128)==0,"non-canonical s");const{networkV:a,v:o}=function(c,h,d){if(c!=null){const m=en(c);return{networkV:m>=eS?m:void 0,v:Cc.getNormalizedV(m)}}if(h!=null)return t(ls(h,32),"invalid yParityAndS"),{v:mi(h)[0]&128?28:27};if(d!=null){switch(Gn(d,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),l=new Cc(L2,s,r,o);return a&&fe(l,km,a),t(e.yParity==null||Gn(e.yParity,"sig.yParity")===l.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===l.yParityAndS,"yParityAndS mismatch"),l}};ky=new WeakMap,Fy=new WeakMap,Hy=new WeakMap,km=new WeakMap;let Wc=Cc;var bf;const pm=class pm{constructor(e){je(this,bf);Se(by(e)===32,"invalid private key","privateKey","[REDACTED]"),fe(this,bf,Xt(e))}get privateKey(){return K(this,bf)}get publicKey(){return pm.computePublicKey(K(this,bf))}get compressedPublicKey(){return pm.computePublicKey(K(this,bf),!0)}sign(e){Se(by(e)===32,"invalid digest length","digest",e);const t=e0.sign(qa(e),qa(K(this,bf)),{lowS:!0});return Wc.from({r:B0(t.r,32),s:B0(t.s,32),v:t.recovery?28:27})}computeSharedSecret(e){const t=pm.computePublicKey(e);return Xt(e0.getSharedSecret(qa(K(this,bf)),mi(t),!1))}static computePublicKey(e,t){let n=mi(e,"key");if(n.length===32){const r=e0.getPublicKey(n,!!t);return Xt(r)}if(n.length===64){const r=new Uint8Array(65);r[0]=4,r.set(n,1),n=r}const s=e0.ProjectivePoint.fromHex(n);return Xt(s.toRawBytes(t))}static recoverPublicKey(e,t){Se(by(e)===32,"invalid digest length","digest",e);const n=Wc.from(t);let s=e0.Signature.fromCompact(qa(cr([n.r,n.s])));s=s.addRecoveryBit(n.yParity);const r=s.recoverPublicKey(qa(e));return Se(r!=null,"invalid signautre for digest","signature",t),"0x"+r.toHex(!1)}static addPoints(e,t,n){const s=e0.ProjectivePoint.fromHex(pm.computePublicKey(e).substring(2)),r=e0.ProjectivePoint.fromHex(pm.computePublicKey(t).substring(2));return"0x"+s.add(r).toHex(!!n)}};bf=new WeakMap;let GA=pm;const yee=BigInt(0),vee=BigInt(36);function XU(i){i=i.toLowerCase();const e=i.substring(2).split(""),t=new Uint8Array(40);for(let s=0;s<40;s++)t[s]=e[s].charCodeAt(0);const n=mi(ir(t));for(let s=0;s<40;s+=2)n[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(n[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const gB={};for(let i=0;i<10;i++)gB[String(i)]=String(i);for(let i=0;i<26;i++)gB[String.fromCharCode(65+i)]=String(10+i);const jU=15;function xee(i){i=i.toUpperCase(),i=i.substring(4)+i.substring(0,2)+"00";let e=i.split("").map(n=>gB[n]).join("");for(;e.length>=jU;){let n=e.substring(0,jU);e=parseInt(n,10)%97+e.substring(n.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const bee=function(){const i={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];i[t]=BigInt(e)}return i}();function Aee(i){i=i.toLowerCase();let e=yee;for(let t=0;t<i.length;t++)e=e*vee+bee[i[t]];return e}function Qi(i){if(Se(typeof i=="string","invalid address","address",i),i.match(/^(0x)?[0-9a-fA-F]{40}$/)){i.startsWith("0x")||(i="0x"+i);const e=XU(i);return Se(!i.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===i,"bad address checksum","address",i),e}if(i.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){Se(i.substring(2,4)===xee(i),"bad icap checksum","address",i);let e=Aee(i.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return XU("0x"+e)}Se(!1,"invalid address","address",i)}function Eee(i){const e=Qi(i.from);let n=en(i.nonce,"tx.nonce").toString(16);return n==="0"?n="0x":n.length%2?n="0x0"+n:n="0x"+n,Qi(Ks(ir(rg([e,n])),12))}function sz(i){return i&&typeof i.getAddress=="function"}async function iR(i,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(yt(typeof i!="string","unconfigured name","UNCONFIGURED_NAME",{value:i}),Se(!1,"invalid AddressLike value; did not resolve to a value address","target",i)),Qi(t)}function Za(i,e){if(typeof i=="string")return i.match(/^0x[0-9a-f]{40}$/i)?Qi(i):(yt(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),iR(i,e.resolveName(i)));if(sz(i))return iR(i,i.getAddress());if(i&&typeof i.then=="function")return iR(i,i);Se(!1,"unsupported addressable value","target",i)}const uf={};function Wt(i,e){let t=!1;return e<0&&(t=!0,e*=-1),new Ia(uf,`${t?"":"u"}int${e}`,i,{signed:t,width:e})}function Si(i,e){return new Ia(uf,`bytes${e||""}`,i,{size:e})}const qU=Symbol.for("_ethers_typed");var Fm;const ff=class ff{constructor(e,t,n,s){he(this,"type");he(this,"value");je(this,Fm);he(this,"_typedSymbol");s==null&&(s=null),RE(uf,e,"Typed"),yn(this,{_typedSymbol:qU,type:t,value:n}),fe(this,Fm,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return K(this,Fm)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return K(this,Fm)===!0?-1:K(this,Fm)===!1?this.value.length:null}static from(e,t){return new ff(uf,e,t)}static uint8(e){return Wt(e,8)}static uint16(e){return Wt(e,16)}static uint24(e){return Wt(e,24)}static uint32(e){return Wt(e,32)}static uint40(e){return Wt(e,40)}static uint48(e){return Wt(e,48)}static uint56(e){return Wt(e,56)}static uint64(e){return Wt(e,64)}static uint72(e){return Wt(e,72)}static uint80(e){return Wt(e,80)}static uint88(e){return Wt(e,88)}static uint96(e){return Wt(e,96)}static uint104(e){return Wt(e,104)}static uint112(e){return Wt(e,112)}static uint120(e){return Wt(e,120)}static uint128(e){return Wt(e,128)}static uint136(e){return Wt(e,136)}static uint144(e){return Wt(e,144)}static uint152(e){return Wt(e,152)}static uint160(e){return Wt(e,160)}static uint168(e){return Wt(e,168)}static uint176(e){return Wt(e,176)}static uint184(e){return Wt(e,184)}static uint192(e){return Wt(e,192)}static uint200(e){return Wt(e,200)}static uint208(e){return Wt(e,208)}static uint216(e){return Wt(e,216)}static uint224(e){return Wt(e,224)}static uint232(e){return Wt(e,232)}static uint240(e){return Wt(e,240)}static uint248(e){return Wt(e,248)}static uint256(e){return Wt(e,256)}static uint(e){return Wt(e,256)}static int8(e){return Wt(e,-8)}static int16(e){return Wt(e,-16)}static int24(e){return Wt(e,-24)}static int32(e){return Wt(e,-32)}static int40(e){return Wt(e,-40)}static int48(e){return Wt(e,-48)}static int56(e){return Wt(e,-56)}static int64(e){return Wt(e,-64)}static int72(e){return Wt(e,-72)}static int80(e){return Wt(e,-80)}static int88(e){return Wt(e,-88)}static int96(e){return Wt(e,-96)}static int104(e){return Wt(e,-104)}static int112(e){return Wt(e,-112)}static int120(e){return Wt(e,-120)}static int128(e){return Wt(e,-128)}static int136(e){return Wt(e,-136)}static int144(e){return Wt(e,-144)}static int152(e){return Wt(e,-152)}static int160(e){return Wt(e,-160)}static int168(e){return Wt(e,-168)}static int176(e){return Wt(e,-176)}static int184(e){return Wt(e,-184)}static int192(e){return Wt(e,-192)}static int200(e){return Wt(e,-200)}static int208(e){return Wt(e,-208)}static int216(e){return Wt(e,-216)}static int224(e){return Wt(e,-224)}static int232(e){return Wt(e,-232)}static int240(e){return Wt(e,-240)}static int248(e){return Wt(e,-248)}static int256(e){return Wt(e,-256)}static int(e){return Wt(e,-256)}static bytes1(e){return Si(e,1)}static bytes2(e){return Si(e,2)}static bytes3(e){return Si(e,3)}static bytes4(e){return Si(e,4)}static bytes5(e){return Si(e,5)}static bytes6(e){return Si(e,6)}static bytes7(e){return Si(e,7)}static bytes8(e){return Si(e,8)}static bytes9(e){return Si(e,9)}static bytes10(e){return Si(e,10)}static bytes11(e){return Si(e,11)}static bytes12(e){return Si(e,12)}static bytes13(e){return Si(e,13)}static bytes14(e){return Si(e,14)}static bytes15(e){return Si(e,15)}static bytes16(e){return Si(e,16)}static bytes17(e){return Si(e,17)}static bytes18(e){return Si(e,18)}static bytes19(e){return Si(e,19)}static bytes20(e){return Si(e,20)}static bytes21(e){return Si(e,21)}static bytes22(e){return Si(e,22)}static bytes23(e){return Si(e,23)}static bytes24(e){return Si(e,24)}static bytes25(e){return Si(e,25)}static bytes26(e){return Si(e,26)}static bytes27(e){return Si(e,27)}static bytes28(e){return Si(e,28)}static bytes29(e){return Si(e,29)}static bytes30(e){return Si(e,30)}static bytes31(e){return Si(e,31)}static bytes32(e){return Si(e,32)}static address(e){return new ff(uf,"address",e)}static bool(e){return new ff(uf,"bool",!!e)}static bytes(e){return new ff(uf,"bytes",e)}static string(e){return new ff(uf,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new ff(uf,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===qU}static dereference(e,t){if(ff.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};Fm=new WeakMap;let Ia=ff;class _ee extends qf{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let n=Ia.dereference(t,"string");try{n=Qi(n)}catch(s){return this._throwError(s.message,t)}return e.writeValue(n)}decode(e){return Qi(B0(e.readValue(),20))}}class See extends qf{constructor(t){super(t.name,t.type,"_",t.dynamic);he(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,n){return this.coder.encode(t,n)}decode(t){return this.coder.decode(t)}}function rz(i,e,t){let n=[];if(Array.isArray(t))n=t;else if(t&&typeof t=="object"){let l={};n=e.map(c=>{const h=c.localName;return yt(h,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:c},value:t}),yt(!l[h],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:c},value:t}),l[h]=!0,t[h]})}else Se(!1,"invalid tuple value","tuple",t);Se(e.length===n.length,"types/value length mismatch","tuple",t);let s=new fL,r=new fL,a=[];e.forEach((l,c)=>{let h=n[c];if(l.dynamic){let d=r.length;l.encode(r,h);let m=s.writeUpdatableValue();a.push(y=>{m(y+d)})}else l.encode(s,h)}),a.forEach(l=>{l(s.length)});let o=i.appendWriter(s);return o+=i.appendWriter(r),o}function az(i,e){let t=[],n=[],s=i.subReader(0);return e.forEach(r=>{let a=null;if(r.dynamic){let o=i.readIndex(),l=s.subReader(o);try{a=r.decode(l)}catch(c){if(ra(c,"BUFFER_OVERRUN"))throw c;a=c,a.baseType=r.name,a.name=r.localName,a.type=r.type}}else try{a=r.decode(i)}catch(o){if(ra(o,"BUFFER_OVERRUN"))throw o;a=o,a.baseType=r.name,a.name=r.localName,a.type=r.type}if(a==null)throw new Error("investigate");t.push(a),n.push(r.localName||null)}),xv.fromItems(t,n)}class Tee extends qf{constructor(t,n,s){const r=t.type+"["+(n>=0?n:"")+"]",a=n===-1||t.dynamic;super("array",r,s,a);he(this,"coder");he(this,"length");yn(this,{coder:t,length:n})}defaultValue(){const t=this.coder.defaultValue(),n=[];for(let s=0;s<this.length;s++)n.push(t);return n}encode(t,n){const s=Ia.dereference(n,"array");Array.isArray(s)||this._throwError("expected array value",s);let r=this.length;r===-1&&(r=s.length,t.writeValue(s.length)),hG(s.length,r,"coder array"+(this.localName?" "+this.localName:""));let a=[];for(let o=0;o<s.length;o++)a.push(this.coder);return rz(t,a,s)}decode(t){let n=this.length;n===-1&&(n=t.readIndex(),yt(n*Ja<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:n*Ja,length:t.dataLength}));let s=[];for(let r=0;r<n;r++)s.push(new See(this.coder));return az(t,s)}}class wee extends qf{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const n=Ia.dereference(t,"bool");return e.writeValue(n?1:0)}decode(e){return!!e.readValue()}}class oz extends qf{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=qa(t);let n=e.writeValue(t.length);return n+=e.writeBytes(t),n}decode(e){return e.readBytes(e.readIndex(),!0)}}class Mee extends oz{constructor(e){super("bytes",e)}decode(e){return Xt(super.decode(e))}}class Cee extends qf{constructor(t,n){let s="bytes"+String(t);super(s,s,n,!1);he(this,"size");yn(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,n){let s=qa(Ia.dereference(n,this.type));return s.length!==this.size&&this._throwError("incorrect data length",n),t.writeBytes(s)}decode(t){return Xt(t.readBytes(this.size))}}const Ree=new Uint8Array([]);class Dee extends qf{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(Ree)}decode(e){return e.readBytes(0),null}}const Lee=BigInt(0),Iee=BigInt(1),Bee=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class Oee extends qf{constructor(t,n,s){const r=(n?"int":"uint")+t*8;super(r,r,s,!1);he(this,"size");he(this,"signed");yn(this,{size:t,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,n){let s=en(Ia.dereference(n,this.type)),r=gm(Bee,Ja*8);if(this.signed){let a=gm(r,this.size*8-1);(s>a||s<-(a+Iee))&&this._throwError("value out-of-bounds",n),s=pG(s,8*Ja)}else(s<Lee||s>gm(r,this.size*8))&&this._throwError("value out-of-bounds",n);return t.writeValue(s)}decode(t){let n=gm(t.readValue(),this.size*8);return this.signed&&(n=l3(n,this.size*8)),n}}class Pee extends oz{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,Uf(Ia.dereference(t,"string")))}decode(e){return c3(super.decode(e))}}class tS extends qf{constructor(t,n){let s=!1;const r=[];t.forEach(o=>{o.dynamic&&(s=!0),r.push(o.type)});const a="tuple("+r.join(",")+")";super("tuple",a,n,s);he(this,"coders");yn(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(s=>{t.push(s.defaultValue())});const n=this.coders.reduce((s,r)=>{const a=r.localName;return a&&(s[a]||(s[a]=0),s[a]++),s},{});return this.coders.forEach((s,r)=>{let a=s.localName;!a||n[a]!==1||(a==="length"&&(a="_length"),t[a]==null&&(t[a]=t[r]))}),Object.freeze(t)}encode(t,n){const s=Ia.dereference(n,"tuple");return rz(t,this.coders,s)}decode(t){return az(t,this.coders)}}function ag(i){return ir(Uf(i))}var Nee="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const QU=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),$U=4;function Uee(i){let e=0;function t(){return i[e++]<<8|i[e++]}let n=t(),s=1,r=[0,1];for(let O=1;O<n;O++)r.push(s+=t());let a=t(),o=e;e+=a;let l=0,c=0;function h(){return l==0&&(c=c<<8|i[e++],l=8),c>>--l&1}const d=31,m=2**d,y=m>>>1,x=y>>1,_=m-1;let b=0;for(let O=0;O<d;O++)b=b<<1|h();let A=[],T=0,w=m;for(;;){let O=Math.floor(((b-T+1)*s-1)/w),N=0,U=n;for(;U-N>1;){let L=N+U>>>1;O<r[L]?U=L:N=L}if(N==0)break;A.push(N);let P=T+Math.floor(w*r[N]/s),B=T+Math.floor(w*r[N+1]/s)-1;for(;((P^B)&y)==0;)b=b<<1&_|h(),P=P<<1&_,B=B<<1&_|1;for(;P&~B&x;)b=b&y|b<<1&_>>>1|h(),P=P<<1^y,B=(B^y)<<1|y|1;T=P,w=1+B-P}let R=n-4;return A.map(O=>{switch(O-R){case 3:return R+65792+(i[o++]<<16|i[o++]<<8|i[o++]);case 2:return R+256+(i[o++]<<8|i[o++]);case 1:return R+i[o++];default:return O-1}})}function kee(i){let e=0;return()=>i[e++]}function lz(i){return kee(Uee(Fee(i)))}function Fee(i){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,r)=>e[s.charCodeAt(0)]=r);let t=i.length,n=new Uint8Array(6*t>>3);for(let s=0,r=0,a=0,o=0;s<t;s++)o=o<<6|e[i.charCodeAt(s)],a+=6,a>=8&&(n[r++]=o>>(a-=8));return n}function Hee(i){return i&1?~i>>1:i>>1}function Gee(i,e){let t=Array(i);for(let n=0,s=0;n<i;n++)t[n]=s+=Hee(e());return t}function zA(i,e=0){let t=[];for(;;){let n=i(),s=i();if(!s)break;e+=n;for(let r=0;r<s;r++)t.push(e+r);e+=s+1}return t}function cz(i){return VA(()=>{let e=zA(i);if(e.length)return e})}function uz(i){let e=[];for(;;){let t=i();if(t==0)break;e.push(zee(t,i))}for(;;){let t=i()-1;if(t<0)break;e.push(Vee(t,i))}return e.flat()}function VA(i){let e=[];for(;;){let t=i(e.length);if(!t)break;e.push(t)}return e}function hz(i,e,t){let n=Array(i).fill().map(()=>[]);for(let s=0;s<e;s++)Gee(i,t).forEach((r,a)=>n[a].push(r));return n}function zee(i,e){let t=1+e(),n=e(),s=VA(e);return hz(s.length,1+i,e).flatMap((a,o)=>{let[l,...c]=a;return Array(s[o]).fill().map((h,d)=>{let m=d*n;return[l+d*t,c.map(y=>y+m)]})})}function Vee(i,e){let t=1+e();return hz(t,1+i,e).map(s=>[s[0],s.slice(1)])}function Yee(i){let e=[],t=zA(i);return s(n([]),[]),e;function n(r){let a=i(),o=VA(()=>{let l=zA(i).map(c=>t[c]);if(l.length)return n(l)});return{S:a,B:o,Q:r}}function s({S:r,B:a},o,l){if(!(r&4&&l===o[o.length-1])){r&2&&(l=o[o.length-1]),r&1&&e.push(o);for(let c of a)for(let h of c.Q)s(c,[...o,h],l)}}}function Kee(i){return i.toString(16).toUpperCase().padStart(2,"0")}function fz(i){return`{${Kee(i)}}`}function Wee(i){let e=[];for(let t=0,n=i.length;t<n;){let s=i.codePointAt(t);t+=s<65536?1:2,e.push(s)}return e}function Sv(i){let t=i.length;if(t<4096)return String.fromCodePoint(...i);let n=[];for(let s=0;s<t;)n.push(String.fromCodePoint(...i.slice(s,s+=4096)));return n.join("")}function Xee(i,e){let t=i.length,n=t-e.length;for(let s=0;n==0&&s<t;s++)n=i[s]-e[s];return n}var jee="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const YA=44032,f3=4352,d3=4449,p3=4519,dz=19,pz=21,Tv=28,m3=pz*Tv,qee=dz*m3,Qee=YA+qee,$ee=f3+dz,Jee=d3+pz,Zee=p3+Tv;function jb(i){return i>>24&255}function mz(i){return i&16777215}let bL,JU,AL,LT;function ete(){let i=lz(jee);bL=new Map(cz(i).flatMap((e,t)=>e.map(n=>[n,t+1<<24]))),JU=new Set(zA(i)),AL=new Map,LT=new Map;for(let[e,t]of uz(i)){if(!JU.has(e)&&t.length==2){let[n,s]=t,r=LT.get(n);r||(r=new Map,LT.set(n,r)),r.set(s,e)}AL.set(e,t.reverse())}}function gz(i){return i>=YA&&i<Qee}function tte(i,e){if(i>=f3&&i<$ee&&e>=d3&&e<Jee)return YA+(i-f3)*m3+(e-d3)*Tv;if(gz(i)&&e>p3&&e<Zee&&(i-YA)%Tv==0)return i+(e-p3);{let t=LT.get(i);return t&&(t=t.get(e),t)?t:-1}}function yz(i){bL||ete();let e=[],t=[],n=!1;function s(r){let a=bL.get(r);a&&(n=!0,r|=a),e.push(r)}for(let r of i)for(;;){if(r<128)e.push(r);else if(gz(r)){let a=r-YA,o=a/m3|0,l=a%m3/Tv|0,c=a%Tv;s(f3+o),s(d3+l),c>0&&s(p3+c)}else{let a=AL.get(r);a?t.push(...a):s(r)}if(!t.length)break;r=t.pop()}if(n&&e.length>1){let r=jb(e[0]);for(let a=1;a<e.length;a++){let o=jb(e[a]);if(o==0||r<=o){r=o;continue}let l=a-1;for(;;){let c=e[l+1];if(e[l+1]=e[l],e[l]=c,!l||(r=jb(e[--l]),r<=o))break}r=jb(e[a])}}return e}function nte(i){let e=[],t=[],n=-1,s=0;for(let r of i){let a=jb(r),o=mz(r);if(n==-1)a==0?n=o:e.push(o);else if(s>0&&s>=a)a==0?(e.push(n,...t),t.length=0,n=o):t.push(o),s=a;else{let l=tte(n,o);l>=0?n=l:s==0&&a==0?(e.push(n),n=o):(t.push(o),s=a)}}return n>=0&&e.push(n,...t),e}function vz(i){return yz(i).map(mz)}function ite(i){return nte(yz(i))}const ZU=45,xz=".",bz=65039,Az=1,g3=i=>Array.from(i);function KA(i,e){return i.P.has(e)||i.Q.has(e)}class ste extends Array{get is_emoji(){return!0}}let EL,Ez,vm,_L,_z,Ey,sR,ry,im,ek,SL;function yB(){if(EL)return;let i=lz(Nee);const e=()=>zA(i),t=()=>new Set(e()),n=(h,d)=>d.forEach(m=>h.add(m));EL=new Map(uz(i)),Ez=t(),vm=e(),_L=new Set(e().map(h=>vm[h])),vm=new Set(vm),_z=t(),t();let s=cz(i),r=i();const a=()=>{let h=new Set;return e().forEach(d=>n(h,s[d])),n(h,e()),h};Ey=VA(h=>{let d=VA(i).map(m=>m+96);if(d.length){let m=h>=r;d[0]-=32,d=Sv(d),m&&(d=`Restricted[${d}]`);let y=a(),x=a(),_=!i();return{N:d,P:y,Q:x,M:_,R:m}}}),sR=t(),ry=new Map;let o=e().concat(g3(sR)).sort((h,d)=>h-d);o.forEach((h,d)=>{let m=i(),y=o[d]=m?o[d-m]:{V:[],M:new Map};y.V.push(h),sR.has(h)||ry.set(h,y)});for(let{V:h,M:d}of new Set(ry.values())){let m=[];for(let x of h){let _=Ey.filter(A=>KA(A,x)),b=m.find(({G:A})=>_.some(T=>A.has(T)));b||(b={G:new Set,V:[]},m.push(b)),b.V.push(x),n(b.G,_)}let y=m.flatMap(x=>g3(x.G));for(let{G:x,V:_}of m){let b=new Set(y.filter(A=>!x.has(A)));for(let A of _)d.set(A,b)}}im=new Set;let l=new Set;const c=h=>im.has(h)?l.add(h):im.add(h);for(let h of Ey){for(let d of h.P)c(d);for(let d of h.Q)c(d)}for(let h of im)!ry.has(h)&&!l.has(h)&&ry.set(h,Az);n(im,vz(im)),ek=Yee(i).map(h=>ste.from(h)).sort(Xee),SL=new Map;for(let h of ek){let d=[SL];for(let m of h){let y=d.map(x=>{let _=x.get(m);return _||(_=new Map,x.set(m,_)),_});m===bz?d.push(...y):d=y}for(let m of d)m.V=h}}function vB(i){return(Sz(i)?"":`${xB(Vw([i]))} `)+fz(i)}function xB(i){return`"${i}"‎`}function rte(i){if(i.length>=4&&i[2]==ZU&&i[3]==ZU)throw new Error(`invalid label extension: "${Sv(i.slice(0,4))}"`)}function ate(i){for(let t=i.lastIndexOf(95);t>0;)if(i[--t]!==95)throw new Error("underscore allowed only at start")}function ote(i){let e=i[0],t=QU.get(e);if(t)throw cA(`leading ${t}`);let n=i.length,s=-1;for(let r=1;r<n;r++){e=i[r];let a=QU.get(e);if(a){if(s==r)throw cA(`${t} + ${a}`);s=r+1,t=a}}if(s==n)throw cA(`trailing ${t}`)}function Vw(i,e=1/0,t=fz){let n=[];lte(i[0])&&n.push("◌"),i.length>e&&(e>>=1,i=[...i.slice(0,e),8230,...i.slice(-e)]);let s=0,r=i.length;for(let a=0;a<r;a++){let o=i[a];Sz(o)&&(n.push(Sv(i.slice(s,a))),n.push(t(o)),s=a+1)}return n.push(Sv(i.slice(s,r))),n.join("")}function lte(i){return yB(),vm.has(i)}function Sz(i){return yB(),_z.has(i)}function cte(i){return dte(ute(i,ite,gte))}function ute(i,e,t){if(!i)return[];yB();let n=0;return i.split(xz).map(s=>{let r=Wee(s),a={input:r,offset:n};n+=r.length+1;try{let o=a.tokens=mte(r,e,t),l=o.length,c;if(!l)throw new Error("empty label");let h=a.output=o.flat();if(ate(h),!(a.emoji=l>1||o[0].is_emoji)&&h.every(m=>m<128))rte(h),c="ASCII";else{let m=o.flatMap(y=>y.is_emoji?[]:y);if(!m.length)c="Emoji";else{if(vm.has(h[0]))throw cA("leading combining mark");for(let _=1;_<l;_++){let b=o[_];if(!b.is_emoji&&vm.has(b[0]))throw cA(`emoji + combining mark: "${Sv(o[_-1])} + ${Vw([b[0]])}"`)}ote(h);let y=g3(new Set(m)),[x]=fte(y);pte(x,m),hte(x,y),c=x.N}}a.type=c}catch(o){a.error=o}return a})}function hte(i,e){let t,n=[];for(let s of e){let r=ry.get(s);if(r===Az)return;if(r){let a=r.M.get(s);if(t=t?t.filter(o=>a.has(o)):g3(a),!t.length)return}else n.push(s)}if(t){for(let s of t)if(n.every(r=>KA(s,r)))throw new Error(`whole-script confusable: ${i.N}/${s.N}`)}}function fte(i){let e=Ey;for(let t of i){let n=e.filter(s=>KA(s,t));if(!n.length)throw Ey.some(s=>KA(s,t))?wz(e[0],t):Tz(t);if(e=n,n.length==1)break}return e}function dte(i){return i.map(({input:e,error:t,output:n})=>{if(t){let s=t.message;throw new Error(i.length==1?s:`Invalid label ${xB(Vw(e,63))}: ${s}`)}return Sv(n)}).join(xz)}function Tz(i){return new Error(`disallowed character: ${vB(i)}`)}function wz(i,e){let t=vB(e),n=Ey.find(s=>s.P.has(e));return n&&(t=`${n.N} ${t}`),new Error(`illegal mixture: ${i.N} + ${t}`)}function cA(i){return new Error(`illegal placement: ${i}`)}function pte(i,e){for(let t of e)if(!KA(i,t))throw wz(i,t);if(i.M){let t=vz(e);for(let n=1,s=t.length;n<s;n++)if(_L.has(t[n])){let r=n+1;for(let a;r<s&&_L.has(a=t[r]);r++)for(let o=n;o<r;o++)if(t[o]==a)throw new Error(`duplicate non-spacing marks: ${vB(a)}`);if(r-n>$U)throw new Error(`excessive non-spacing marks: ${xB(Vw(t.slice(n-1,r)))} (${r-n}/${$U})`);n=r}}}function mte(i,e,t){let n=[],s=[];for(i=i.slice().reverse();i.length;){let r=yte(i);if(r)s.length&&(n.push(e(s)),s=[]),n.push(t(r));else{let a=i.pop();if(im.has(a))s.push(a);else{let o=EL.get(a);if(o)s.push(...o);else if(!Ez.has(a))throw Tz(a)}}}return s.length&&n.push(e(s)),n}function gte(i){return i.filter(e=>e!=bz)}function yte(i,e){let t=SL,n,s=i.length;for(;s&&(t=t.get(i[--s]),!!t);){let{V:r}=t;r&&(n=r,i.length=s)}return n}const Mz=new Uint8Array(32);Mz.fill(0);function tk(i){return Se(i.length!==0,"invalid ENS name; empty component","comp",i),i}function Cz(i){const e=Uf(vte(i)),t=[];if(i.length===0)return t;let n=0;for(let s=0;s<e.length;s++)e[s]===46&&(t.push(tk(e.slice(n,s))),n=s+1);return Se(n<e.length,"invalid ENS name; empty component","name",i),t.push(tk(e.slice(n))),t}function vte(i){try{if(i.length===0)throw new Error("empty label");return cte(i)}catch(e){Se(!1,`invalid ENS name (${e.message})`,"name",i)}}function TL(i){Se(typeof i=="string","invalid ENS name; not a string","name",i),Se(i.length,"invalid ENS name (empty label)","name",i);let e=Mz;const t=Cz(i);for(;t.length;)e=ir(cr([e,ir(t.pop())]));return Xt(e)}function xte(i,e){const t=e;return Se(t<=255,"DNS encoded label cannot exceed 255","length",t),Xt(cr(Cz(i).map(n=>{Se(n.length<=t,`label ${JSON.stringify(i)} exceeds ${t} bytes`,"name",i);const s=new Uint8Array(n.length+1);return s.set(n,1),s[0]=s.length-1,s})))+"00"}function rR(i,e){return{address:Qi(i),storageKeys:e.map((t,n)=>(Se(ls(t,32),"invalid slot",`storageKeys[${n}]`,t),t.toLowerCase()))}}function _g(i){if(Array.isArray(i))return i.map((t,n)=>Array.isArray(t)?(Se(t.length===2,"invalid slot set",`value[${n}]`,t),rR(t[0],t[1])):(Se(t!=null&&typeof t=="object","invalid address-slot set","value",i),rR(t.address,t.storageKeys)));Se(i!=null&&typeof i=="object","invalid access list","value",i);const e=Object.keys(i).map(t=>{const n=i[t].reduce((s,r)=>(s[r]=!0,s),{});return rR(t,Object.keys(n).sort())});return e.sort((t,n)=>t.address.localeCompare(n.address)),e}function bte(i){let e;return typeof i=="string"?e=GA.computePublicKey(i,!1):e=i.publicKey,Qi(ir("0x"+e.substring(4)).substring(26))}function Ate(i,e){return bte(GA.recoverPublicKey(i,e))}const Gr=BigInt(0),Ete=BigInt(2),_te=BigInt(27),Ste=BigInt(28),Tte=BigInt(35),wte=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),aR=4096*32;function nk(i,e){let t=i.toString(16);for(;t.length<2;)t="0"+t;return t+=Kv(e).substring(4),"0x"+t}function Yw(i){return i==="0x"?null:Qi(i)}function bB(i,e){try{return _g(i)}catch(t){Se(!1,t.message,e,i)}}function IE(i,e){return i==="0x"?0:Gn(i,e)}function nr(i,e){if(i==="0x")return Gr;const t=en(i,e);return Se(t<=wte,"value exceeds uint size",e,t),t}function fs(i,e){const t=en(i,"value"),n=$a(t);return Se(n.length<=32,"value too large",`tx.${e}`,t),n}function AB(i){return _g(i).map(e=>[e.address,e.storageKeys])}function Mte(i,e){Se(Array.isArray(i),`invalid ${e}`,"value",i);for(let t=0;t<i.length;t++)Se(ls(i[t],32),"invalid ${ param } hash",`value[${t}]`,i[t]);return i}function Cte(i){const e=Fw(i);Se(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",i);const t={type:0,nonce:IE(e[0],"nonce"),gasPrice:nr(e[1],"gasPrice"),gasLimit:nr(e[2],"gasLimit"),to:Yw(e[3]),value:nr(e[4],"value"),data:Xt(e[5]),chainId:Gr};if(e.length===6)return t;const n=nr(e[6],"v"),s=nr(e[7],"r"),r=nr(e[8],"s");if(s===Gr&&r===Gr)t.chainId=n;else{let a=(n-Tte)/Ete;a<Gr&&(a=Gr),t.chainId=a,Se(a!==Gr||n===_te||n===Ste,"non-canonical legacy v","v",e[6]),t.signature=Wc.from({r:sg(e[7],32),s:sg(e[8],32),v:n})}return t}function Rte(i,e){const t=[fs(i.nonce,"nonce"),fs(i.gasPrice||0,"gasPrice"),fs(i.gasLimit,"gasLimit"),i.to||"0x",fs(i.value,"value"),i.data];let n=Gr;if(i.chainId!=Gr)n=en(i.chainId,"tx.chainId"),Se(!e||e.networkV==null||e.legacyChainId===n,"tx.chainId/sig.v mismatch","sig",e);else if(i.signature){const r=i.signature.legacyChainId;r!=null&&(n=r)}if(!e)return n!==Gr&&(t.push($a(n)),t.push("0x"),t.push("0x")),rg(t);let s=BigInt(27+e.yParity);return n!==Gr?s=Wc.getChainIdV(n,e.v):BigInt(e.v)!==s&&Se(!1,"tx.chainId/sig.v mismatch","sig",e),t.push($a(s)),t.push($a(e.r)),t.push($a(e.s)),rg(t)}function EB(i,e){let t;try{if(t=IE(e[0],"yParity"),t!==0&&t!==1)throw new Error("bad yParity")}catch{Se(!1,"invalid yParity","yParity",e[0])}const n=sg(e[1],32),s=sg(e[2],32),r=Wc.from({r:n,s,yParity:t});i.signature=r}function Dte(i){const e=Fw(mi(i).slice(1));Se(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",Xt(i));const t={type:2,chainId:nr(e[0],"chainId"),nonce:IE(e[1],"nonce"),maxPriorityFeePerGas:nr(e[2],"maxPriorityFeePerGas"),maxFeePerGas:nr(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:nr(e[4],"gasLimit"),to:Yw(e[5]),value:nr(e[6],"value"),data:Xt(e[7]),accessList:bB(e[8],"accessList")};return e.length===9||EB(t,e.slice(9)),t}function Lte(i,e){const t=[fs(i.chainId,"chainId"),fs(i.nonce,"nonce"),fs(i.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),fs(i.maxFeePerGas||0,"maxFeePerGas"),fs(i.gasLimit,"gasLimit"),i.to||"0x",fs(i.value,"value"),i.data,AB(i.accessList||[])];return e&&(t.push(fs(e.yParity,"yParity")),t.push($a(e.r)),t.push($a(e.s))),cr(["0x02",rg(t)])}function Ite(i){const e=Fw(mi(i).slice(1));Se(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",Xt(i));const t={type:1,chainId:nr(e[0],"chainId"),nonce:IE(e[1],"nonce"),gasPrice:nr(e[2],"gasPrice"),gasLimit:nr(e[3],"gasLimit"),to:Yw(e[4]),value:nr(e[5],"value"),data:Xt(e[6]),accessList:bB(e[7],"accessList")};return e.length===8||EB(t,e.slice(8)),t}function Bte(i,e){const t=[fs(i.chainId,"chainId"),fs(i.nonce,"nonce"),fs(i.gasPrice||0,"gasPrice"),fs(i.gasLimit,"gasLimit"),i.to||"0x",fs(i.value,"value"),i.data,AB(i.accessList||[])];return e&&(t.push(fs(e.yParity,"recoveryParam")),t.push($a(e.r)),t.push($a(e.s))),cr(["0x01",rg(t)])}function Ote(i){let e=Fw(mi(i).slice(1)),t="3",n=null;if(e.length===4&&Array.isArray(e[0])){t="3 (network format)";const r=e[1],a=e[2],o=e[3];Se(Array.isArray(r),"invalid network format: blobs not an array","fields[1]",r),Se(Array.isArray(a),"invalid network format: commitments not an array","fields[2]",a),Se(Array.isArray(o),"invalid network format: proofs not an array","fields[3]",o),Se(r.length===a.length,"invalid network format: blobs/commitments length mismatch","fields",e),Se(r.length===o.length,"invalid network format: blobs/proofs length mismatch","fields",e),n=[];for(let l=0;l<e[1].length;l++)n.push({data:r[l],commitment:a[l],proof:o[l]});e=e[0]}Se(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${t}`,"data",Xt(i));const s={type:3,chainId:nr(e[0],"chainId"),nonce:IE(e[1],"nonce"),maxPriorityFeePerGas:nr(e[2],"maxPriorityFeePerGas"),maxFeePerGas:nr(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:nr(e[4],"gasLimit"),to:Yw(e[5]),value:nr(e[6],"value"),data:Xt(e[7]),accessList:bB(e[8],"accessList"),maxFeePerBlobGas:nr(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};n&&(s.blobs=n),Se(s.to!=null,`invalid address for transaction type: ${t}`,"data",i),Se(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",i);for(let r=0;r<s.blobVersionedHashes.length;r++)Se(ls(s.blobVersionedHashes[r],32),`invalid blobVersionedHash at index ${r}: must be length 32`,"data",i);return e.length===11||EB(s,e.slice(11)),s}function Pte(i,e,t){const n=[fs(i.chainId,"chainId"),fs(i.nonce,"nonce"),fs(i.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),fs(i.maxFeePerGas||0,"maxFeePerGas"),fs(i.gasLimit,"gasLimit"),i.to||HA,fs(i.value,"value"),i.data,AB(i.accessList||[]),fs(i.maxFeePerBlobGas||0,"maxFeePerBlobGas"),Mte(i.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(n.push(fs(e.yParity,"yParity")),n.push($a(e.r)),n.push($a(e.s)),t)?cr(["0x03",rg([n,t.map(s=>s.data),t.map(s=>s.commitment),t.map(s=>s.proof)])]):cr(["0x03",rg(n)])}var ju,Gy,zy,Vy,Yy,Ky,Wy,Xy,jy,qy,Qy,$y,Hm,c0,Af,u0,Jy,IT;const df=class df{constructor(){je(this,Jy);je(this,ju);je(this,Gy);je(this,zy);je(this,Vy);je(this,Yy);je(this,Ky);je(this,Wy);je(this,Xy);je(this,jy);je(this,qy);je(this,Qy);je(this,$y);je(this,Hm);je(this,c0);je(this,Af);je(this,u0);fe(this,ju,null),fe(this,Gy,null),fe(this,Vy,0),fe(this,Yy,Gr),fe(this,Ky,null),fe(this,Wy,null),fe(this,Xy,null),fe(this,zy,"0x"),fe(this,jy,Gr),fe(this,qy,Gr),fe(this,Qy,null),fe(this,$y,null),fe(this,Hm,null),fe(this,c0,null),fe(this,u0,null),fe(this,Af,null)}get type(){return K(this,ju)}set type(e){switch(e){case null:fe(this,ju,null);break;case 0:case"legacy":fe(this,ju,0);break;case 1:case"berlin":case"eip-2930":fe(this,ju,1);break;case 2:case"london":case"eip-1559":fe(this,ju,2);break;case 3:case"cancun":case"eip-4844":fe(this,ju,3);break;default:Se(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844"}return null}get to(){const e=K(this,Gy);return e==null&&this.type===3?HA:e}set to(e){fe(this,Gy,e==null?null:Qi(e))}get nonce(){return K(this,Vy)}set nonce(e){fe(this,Vy,Gn(e,"value"))}get gasLimit(){return K(this,Yy)}set gasLimit(e){fe(this,Yy,en(e))}get gasPrice(){const e=K(this,Ky);return e==null&&(this.type===0||this.type===1)?Gr:e}set gasPrice(e){fe(this,Ky,e==null?null:en(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=K(this,Wy);return e??(this.type===2||this.type===3?Gr:null)}set maxPriorityFeePerGas(e){fe(this,Wy,e==null?null:en(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=K(this,Xy);return e??(this.type===2||this.type===3?Gr:null)}set maxFeePerGas(e){fe(this,Xy,e==null?null:en(e,"maxFeePerGas"))}get data(){return K(this,zy)}set data(e){fe(this,zy,Xt(e))}get value(){return K(this,jy)}set value(e){fe(this,jy,en(e,"value"))}get chainId(){return K(this,qy)}set chainId(e){fe(this,qy,en(e))}get signature(){return K(this,Qy)||null}set signature(e){fe(this,Qy,e==null?null:Wc.from(e))}get accessList(){const e=K(this,$y)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){fe(this,$y,e==null?null:_g(e))}get maxFeePerBlobGas(){const e=K(this,Hm);return e==null&&this.type===3?Gr:e}set maxFeePerBlobGas(e){fe(this,Hm,e==null?null:en(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=K(this,c0);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){Se(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)Se(ls(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}fe(this,c0,e)}get blobs(){return K(this,u0)==null?null:K(this,u0).map(e=>Object.assign({},e))}set blobs(e){if(e==null){fe(this,u0,null);return}const t=[],n=[];for(let s=0;s<e.length;s++){const r=e[s];if(lB(r)){yt(K(this,Af),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let a=mi(r);if(Se(a.length<=aR,"blob is too large",`blobs[${s}]`,r),a.length!==aR){const c=new Uint8Array(aR);c.set(a),a=c}const o=K(this,Af).blobToKzgCommitment(a),l=Xt(K(this,Af).computeBlobKzgProof(a,o));t.push({data:Xt(a),commitment:Xt(o),proof:l}),n.push(nk(1,o))}else{const a=Xt(r.commitment);t.push({data:Xt(r.data),commitment:a,proof:Xt(r.proof)}),n.push(nk(1,a))}}fe(this,u0,t),fe(this,c0,n)}get kzg(){return K(this,Af)}set kzg(e){fe(this,Af,e)}get hash(){return this.signature==null?null:ir(wt(this,Jy,IT).call(this,!0,!1))}get unsignedHash(){return ir(this.unsignedSerialized)}get from(){return this.signature==null?null:Ate(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:GA.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}get serialized(){return wt(this,Jy,IT).call(this,!0,!0)}get unsignedSerialized(){return wt(this,Jy,IT).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,t=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,n=this.accessList!=null,s=K(this,Hm)!=null||K(this,c0);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&yt(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),yt(!t||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),yt(this.type!==0||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const r=[];return this.type!=null?r.push(this.type):t?r.push(2):e?(r.push(1),n||r.push(0)):n?(r.push(1),r.push(2)):(s&&this.to||(r.push(0),r.push(1),r.push(2)),r.push(3)),r.sort(),r}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return df.from(this)}toJSON(){const e=t=>t==null?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new df;if(typeof e=="string"){const n=mi(e);if(n[0]>=127)return df.from(Cte(n));switch(n[0]){case 1:return df.from(Ite(n));case 2:return df.from(Dte(n));case 3:return df.from(Ote(n))}yt(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const t=new df;return e.type!=null&&(t.type=e.type),e.to!=null&&(t.to=e.to),e.nonce!=null&&(t.nonce=e.nonce),e.gasLimit!=null&&(t.gasLimit=e.gasLimit),e.gasPrice!=null&&(t.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(t.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(t.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(t.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(t.data=e.data),e.value!=null&&(t.value=e.value),e.chainId!=null&&(t.chainId=e.chainId),e.signature!=null&&(t.signature=Wc.from(e.signature)),e.accessList!=null&&(t.accessList=e.accessList),e.blobVersionedHashes!=null&&(t.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(t.kzg=e.kzg),e.blobs!=null&&(t.blobs=e.blobs),e.hash!=null&&(Se(t.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),Se(t.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(Se(t.isSigned(),"unsigned transaction cannot define '.from'","tx",e),Se(t.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),t}};ju=new WeakMap,Gy=new WeakMap,zy=new WeakMap,Vy=new WeakMap,Yy=new WeakMap,Ky=new WeakMap,Wy=new WeakMap,Xy=new WeakMap,jy=new WeakMap,qy=new WeakMap,Qy=new WeakMap,$y=new WeakMap,Hm=new WeakMap,c0=new WeakMap,Af=new WeakMap,u0=new WeakMap,Jy=new WeakSet,IT=function(e,t){yt(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=e?this.signature:null;switch(this.inferType()){case 0:return Rte(this,n);case 1:return Bte(this,n);case 2:return Lte(this,n);case 3:return Pte(this,n,t?this.blobs:null)}yt(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let y3=df;const Rz=new Uint8Array(32);Rz.fill(0);const Nte=BigInt(-1),Dz=BigInt(0),Lz=BigInt(1),Ute=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function kte(i){const e=mi(i),t=e.length%32;return t?cr([e,Rz.slice(t)]):Xt(e)}const Fte=B0(Lz,32),Hte=B0(Dz,32),ik={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},oR=["name","version","chainId","verifyingContract","salt"];function sk(i){return function(e){return Se(typeof e=="string",`invalid domain value for ${JSON.stringify(i)}`,`domain.${i}`,e),e}}const Gte={name:sk("name"),version:sk("version"),chainId:function(i){const e=en(i,"domain.chainId");return Se(e>=0,"invalid chain ID","domain.chainId",i),Number.isSafeInteger(e)?Number(e):uy(e)},verifyingContract:function(i){try{return Qi(i).toLowerCase()}catch{}Se(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",i)},salt:function(i){const e=mi(i,"domain.salt");return Se(e.length===32,'invalid domain value "salt"',"domain.salt",i),Xt(e)}};function lR(i){{const e=i.match(/^(u?)int(\d+)$/);if(e){const t=e[1]==="",n=parseInt(e[2]);Se(n%8===0&&n!==0&&n<=256&&e[2]===String(n),"invalid numeric width","type",i);const s=gm(Ute,t?n-1:n),r=t?(s+Lz)*Nte:Dz;return function(a){const o=en(a,"value");return Se(o>=r&&o<=s,`value out-of-bounds for ${i}`,"value",o),B0(t?pG(o,256):o,32)}}}{const e=i.match(/^bytes(\d+)$/);if(e){const t=parseInt(e[1]);return Se(t!==0&&t<=32&&e[1]===String(t),"invalid bytes width","type",i),function(n){const s=mi(n);return Se(s.length===t,`invalid length for ${i}`,"value",n),kte(n)}}}switch(i){case"address":return function(e){return sg(Qi(e),32)};case"bool":return function(e){return e?Fte:Hte};case"bytes":return function(e){return ir(e)};case"string":return function(e){return ag(e)}}return null}function rk(i,e){return`${i}(${e.map(({name:t,type:n})=>n+" "+t).join(",")})`}function nS(i){const e=i.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:i}}var yE,Ef,Zy,Tw,Iz;const wl=class wl{constructor(e){je(this,Tw);he(this,"primaryType");je(this,yE);je(this,Ef);je(this,Zy);fe(this,Ef,new Map),fe(this,Zy,new Map);const t=new Map,n=new Map,s=new Map,r={};Object.keys(e).forEach(l=>{r[l]=e[l].map(({name:c,type:h})=>{let{base:d,index:m}=nS(h);return d==="int"&&!e.int&&(d="int256"),d==="uint"&&!e.uint&&(d="uint256"),{name:c,type:d+(m||"")}}),t.set(l,new Set),n.set(l,[]),s.set(l,new Set)}),fe(this,yE,JSON.stringify(r));for(const l in r){const c=new Set;for(const h of r[l]){Se(!c.has(h.name),`duplicate variable name ${JSON.stringify(h.name)} in ${JSON.stringify(l)}`,"types",e),c.add(h.name);const d=nS(h.type).base;Se(d!==l,`circular type reference to ${JSON.stringify(d)}`,"types",e),!lR(d)&&(Se(n.has(d),`unknown type ${JSON.stringify(d)}`,"types",e),n.get(d).push(l),t.get(l).add(d))}}const a=Array.from(n.keys()).filter(l=>n.get(l).length===0);Se(a.length!==0,"missing primary type","types",e),Se(a.length===1,`ambiguous primary types or unused types: ${a.map(l=>JSON.stringify(l)).join(", ")}`,"types",e),yn(this,{primaryType:a[0]});function o(l,c){Se(!c.has(l),`circular type reference to ${JSON.stringify(l)}`,"types",e),c.add(l);for(const h of t.get(l))if(n.has(h)){o(h,c);for(const d of c)s.get(d).add(h)}c.delete(l)}o(this.primaryType,new Set);for(const[l,c]of s){const h=Array.from(c);h.sort(),K(this,Ef).set(l,rk(l,r[l])+h.map(d=>rk(d,r[d])).join(""))}}get types(){return JSON.parse(K(this,yE))}getEncoder(e){let t=K(this,Zy).get(e);return t||(t=wt(this,Tw,Iz).call(this,e),K(this,Zy).set(e,t)),t}encodeType(e){const t=K(this,Ef).get(e);return Se(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return ir(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,n){if(lR(e))return n(e,t);const s=nS(e).array;if(s)return Se(s.count===-1||s.count===t.length,`array length mismatch; expected length ${s.count}`,"value",t),t.map(a=>this._visit(s.prefix,a,n));const r=this.types[e];if(r)return r.reduce((a,{name:o,type:l})=>(a[o]=this._visit(l,t[o],n),a),{});Se(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new wl(e)}static getPrimaryType(e){return wl.from(e).primaryType}static hashStruct(e,t,n){return wl.from(t).hashStruct(e,n)}static hashDomain(e){const t=[];for(const n in e){if(e[n]==null)continue;const s=ik[n];Se(s,`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",e),t.push({name:n,type:s})}return t.sort((n,s)=>oR.indexOf(n.name)-oR.indexOf(s.name)),wl.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,n){return cr(["0x1901",wl.hashDomain(e),wl.from(t).hash(n)])}static hash(e,t,n){return ir(wl.encode(e,t,n))}static async resolveNames(e,t,n,s){e=Object.assign({},e);for(const o in e)e[o]==null&&delete e[o];const r={};e.verifyingContract&&!ls(e.verifyingContract,20)&&(r[e.verifyingContract]="0x");const a=wl.from(t);a.visit(n,(o,l)=>(o==="address"&&!ls(l,20)&&(r[l]="0x"),l));for(const o in r)r[o]=await s(o);return e.verifyingContract&&r[e.verifyingContract]&&(e.verifyingContract=r[e.verifyingContract]),n=a.visit(n,(o,l)=>o==="address"&&r[l]?r[l]:l),{domain:e,value:n}}static getPayload(e,t,n){wl.hashDomain(e);const s={},r=[];oR.forEach(l=>{const c=e[l];c!=null&&(s[l]=Gte[l](c),r.push({name:l,type:ik[l]}))});const a=wl.from(t);t=a.types;const o=Object.assign({},t);return Se(o.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",t),o.EIP712Domain=r,a.encode(n),{types:o,domain:s,primaryType:a.primaryType,message:a.visit(n,(l,c)=>{if(l.match(/^bytes(\d*)/))return Xt(mi(c));if(l.match(/^u?int/))return en(c).toString();switch(l){case"address":return c.toLowerCase();case"bool":return!!c;case"string":return Se(typeof c=="string","invalid string","value",c),c}Se(!1,"unsupported type","type",l)})}}};yE=new WeakMap,Ef=new WeakMap,Zy=new WeakMap,Tw=new WeakSet,Iz=function(e){{const s=lR(e);if(s)return s}const t=nS(e).array;if(t){const s=t.prefix,r=this.getEncoder(s);return a=>{Se(t.count===-1||t.count===a.length,`array length mismatch; expected length ${t.count}`,"value",a);let o=a.map(r);return K(this,Ef).has(s)&&(o=o.map(ir)),ir(cr(o))}}const n=this.types[e];if(n){const s=ag(K(this,Ef).get(e));return r=>{const a=n.map(({name:o,type:l})=>{const c=this.getEncoder(l)(r[o]);return K(this,Ef).has(l)?ir(c):c});return a.unshift(s),cr(a)}}Se(!1,`unknown type: ${e}`,"type",e)};let v3=wl;function eo(i){const e=new Set;return i.forEach(t=>e.add(t)),Object.freeze(e)}const zte="external public payable override",Vte=eo(zte.split(" ")),Bz="constant external internal payable private public pure view override",Yte=eo(Bz.split(" ")),Oz="constructor error event fallback function receive struct",Pz=eo(Oz.split(" ")),Nz="calldata memory storage payable indexed",Kte=eo(Nz.split(" ")),Wte="tuple returns",Xte=[Oz,Nz,Wte,Bz].join(" "),jte=eo(Xte.split(" ")),qte={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},Qte=new RegExp("^(\\s*)"),$te=new RegExp("^([0-9]+)"),Jte=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),Uz=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),kz=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var ia,Pc,vE,wL;const ww=class ww{constructor(e){je(this,vE);je(this,ia);je(this,Pc);fe(this,ia,0),fe(this,Pc,e.slice())}get offset(){return K(this,ia)}get length(){return K(this,Pc).length-K(this,ia)}clone(){return new ww(K(this,Pc))}reset(){fe(this,ia,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=wt(this,vE,wL).call(this,K(this,ia)+1,e.match+1);return fe(this,ia,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;K(this,ia)<e.match-1;){const n=this.peek().linkNext;t.push(wt(this,vE,wL).call(this,K(this,ia)+1,n)),fe(this,ia,n)}return fe(this,ia,e.match+1),t}peek(){if(K(this,ia)>=K(this,Pc).length)throw new Error("out-of-bounds");return K(this,Pc)[K(this,ia)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return fb(this,ia)._++,e}toString(){const e=[];for(let t=K(this,ia);t<K(this,Pc).length;t++){const n=K(this,Pc)[t];e.push(`${n.type}:${n.text}`)}return`<TokenString ${e.join(" ")}>`}};ia=new WeakMap,Pc=new WeakMap,vE=new WeakSet,wL=function(e=0,t=0){return new ww(K(this,Pc).slice(e,t).map(n=>Object.freeze(Object.assign({},n,{match:n.match-e,linkBack:n.linkBack-e,linkNext:n.linkNext-e}))))};let Xc=ww;function z0(i){const e=[],t=a=>{const o=r<i.length?JSON.stringify(i[r]):"$EOI";throw new Error(`invalid token ${o} at ${r}: ${a}`)};let n=[],s=[],r=0;for(;r<i.length;){let a=i.substring(r),o=a.match(Qte);o&&(r+=o[1].length,a=i.substring(r));const l={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:r,value:-1};e.push(l);let c=qte[a[0]]||"";if(c){if(l.type=c,l.text=a[0],r++,c==="OPEN_PAREN")n.push(e.length-1),s.push(e.length-1);else if(c=="CLOSE_PAREN")n.length===0&&t("no matching open bracket"),l.match=n.pop(),e[l.match].match=e.length-1,l.depth--,l.linkBack=s.pop(),e[l.linkBack].linkNext=e.length-1;else if(c==="COMMA")l.linkBack=s.pop(),e[l.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(c==="OPEN_BRACKET")l.type="BRACKET";else if(c==="CLOSE_BRACKET"){let h=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const d=e.pop().text;h=d+h,e[e.length-1].value=Gn(d)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=h}continue}if(o=a.match(Jte),o){if(l.text=o[1],r+=l.text.length,jte.has(l.text)){l.type="KEYWORD";continue}if(l.text.match(kz)){l.type="TYPE";continue}l.type="ID";continue}if(o=a.match($te),o){l.text=o[1],l.type="NUMBER",r+=l.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(a[0])} at position ${r}`)}return new Xc(e.map(a=>Object.freeze(a)))}function ak(i,e){let t=[];for(const n in e.keys())i.has(n)&&t.push(n);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function Kw(i,e){if(e.peekKeyword(Pz)){const t=e.pop().text;if(t!==i)throw new Error(`expected ${i}, got ${t}`)}return e.popType("ID")}function Vf(i,e){const t=new Set;for(;;){const n=i.peekType("KEYWORD");if(n==null||e&&!e.has(n))break;if(i.pop(),t.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);t.add(n)}return Object.freeze(t)}function Fz(i){let e=Vf(i,Yte);return ak(e,eo("constant payable nonpayable".split(" "))),ak(e,eo("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function kf(i,e){return i.popParams().map(t=>oa.from(t,e))}function Hz(i){if(i.peekType("AT")){if(i.pop(),i.peekType("NUMBER"))return en(i.pop().text);throw new Error("invalid gas")}return null}function og(i){if(i.length)throw new Error(`unexpected tokens at offset ${i.offset}: ${i.toString()}`)}const Zte=new RegExp(/^(.*)\[([0-9]*)\]$/);function ok(i){const e=i.match(kz);if(Se(e,"invalid type","type",i),i==="uint")return"uint256";if(i==="int")return"int256";if(e[2]){const t=parseInt(e[2]);Se(t!==0&&t<=32,"invalid bytes length","type",i)}else if(e[3]){const t=parseInt(e[3]);Se(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",i)}return i}const Rs={},Do=Symbol.for("_ethers_internal"),lk="_ParamTypeInternal",ck="_ErrorInternal",uk="_EventInternal",hk="_ConstructorInternal",fk="_FallbackInternal",dk="_FunctionInternal",pk="_StructInternal";var ev,BT;const Ml=class Ml{constructor(e,t,n,s,r,a,o,l){je(this,ev);he(this,"name");he(this,"type");he(this,"baseType");he(this,"indexed");he(this,"components");he(this,"arrayLength");he(this,"arrayChildren");if(RE(e,Rs,"ParamType"),Object.defineProperty(this,Do,{value:lk}),a&&(a=Object.freeze(a.slice())),s==="array"){if(o==null||l==null)throw new Error("")}else if(o!=null||l!=null)throw new Error("");if(s==="tuple"){if(a==null)throw new Error("")}else if(a!=null)throw new Error("");yn(this,{name:t,type:n,baseType:s,indexed:r,components:a,arrayLength:o,arrayChildren:l})}format(e){if(e==null&&(e="sighash"),e==="json"){const n=this.name||"";if(this.isArray()){const r=JSON.parse(this.arrayChildren.format("json"));return r.name=n,r.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(r)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:n};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(r=>JSON.parse(r.format(e)))),JSON.stringify(s)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(n=>n.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return e.map(s=>n.arrayChildren.walk(s,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const n=this;return e.map((s,r)=>n.components[r].walk(s,t))}return t(this.type,e)}async walkAsync(e,t){const n=[],s=[e];return wt(this,ev,BT).call(this,n,e,t,r=>{s[0]=r}),n.length&&await Promise.all(n),s[0]}static from(e,t){if(Ml.isParamType(e))return e;if(typeof e=="string")try{return Ml.from(z0(e),t)}catch{Se(!1,"invalid param type","obj",e)}else if(e instanceof Xc){let o="",l="",c=null;Vf(e,eo(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(l="tuple",c=e.popParams().map(_=>Ml.from(_)),o=`tuple(${c.map(_=>_.format()).join(",")})`):(o=ok(e.popType("TYPE")),l=o);let h=null,d=null;for(;e.length&&e.peekType("BRACKET");){const _=e.pop();h=new Ml(Rs,"",o,l,null,c,d,h),d=_.value,o+=_.text,l="array",c=null}let m=null;if(Vf(e,Kte).has("indexed")){if(!t)throw new Error("");m=!0}const x=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new Ml(Rs,x,o,l,m,c,d,h)}const n=e.name;Se(!n||typeof n=="string"&&n.match(Uz),"invalid name","obj.name",n);let s=e.indexed;s!=null&&(Se(t,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let r=e.type,a=r.match(Zte);if(a){const o=parseInt(a[2]||"-1"),l=Ml.from({type:a[1],components:e.components});return new Ml(Rs,n||"",r,"array",s,null,o,l)}if(r==="tuple"||r.startsWith("tuple(")||r.startsWith("(")){const o=e.components!=null?e.components.map(c=>Ml.from(c)):null;return new Ml(Rs,n||"",r,"tuple",s,o,null,null)}return r=ok(e.type),new Ml(Rs,n||"",r,r,s,null,null,null)}static isParamType(e){return e&&e[Do]===lk}};ev=new WeakSet,BT=function(e,t,n,s){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const a=this.arrayChildren,o=t.slice();o.forEach((l,c)=>{var h;wt(h=a,ev,BT).call(h,e,l,n,d=>{o[c]=d})}),s(o);return}if(this.isTuple()){const a=this.components;let o;if(Array.isArray(t))o=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");o=a.map(l=>{if(!l.name)throw new Error("cannot use object value with unnamed components");if(!(l.name in t))throw new Error(`missing value for component ${l.name}`);return t[l.name]})}if(o.length!==this.components.length)throw new Error("array is wrong length");o.forEach((l,c)=>{var h;wt(h=a[c],ev,BT).call(h,e,l,n,d=>{o[c]=d})}),s(o);return}const r=n(this.type,t);r.then?e.push(async function(){s(await r)}()):s(r)};let oa=Ml;class lg{constructor(e,t,n){he(this,"type");he(this,"inputs");RE(e,Rs,"Fragment"),n=Object.freeze(n.slice()),yn(this,{type:t,inputs:n})}static from(e){if(typeof e=="string"){try{lg.from(JSON.parse(e))}catch{}return lg.from(z0(e))}if(e instanceof Xc)switch(e.peekKeyword(Pz)){case"constructor":return Bf.from(e);case"error":return To.from(e);case"event":return nh.from(e);case"fallback":case"receive":return pf.from(e);case"function":return ih.from(e);case"struct":return $m.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return Bf.from(e);case"error":return To.from(e);case"event":return nh.from(e);case"fallback":case"receive":return pf.from(e);case"function":return ih.from(e);case"struct":return $m.from(e)}yt(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}Se(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return Bf.isFragment(e)}static isError(e){return To.isFragment(e)}static isEvent(e){return nh.isFragment(e)}static isFunction(e){return ih.isFragment(e)}static isStruct(e){return $m.isFragment(e)}}class Ww extends lg{constructor(t,n,s,r){super(t,n,r);he(this,"name");Se(typeof s=="string"&&s.match(Uz),"invalid identifier","name",s),r=Object.freeze(r.slice()),yn(this,{name:s})}}function WA(i,e){return"("+e.map(t=>t.format(i)).join(i==="full"?", ":",")+")"}class To extends Ww{constructor(e,t,n){super(e,"error",t,n),Object.defineProperty(this,Do,{value:ck})}get selector(){return ag(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+WA(e,this.inputs)),t.join(" ")}static from(e){if(To.isFragment(e))return e;if(typeof e=="string")return To.from(z0(e));if(e instanceof Xc){const t=Kw("error",e),n=kf(e);return og(e),new To(Rs,t,n)}return new To(Rs,e.name,e.inputs?e.inputs.map(oa.from):[])}static isFragment(e){return e&&e[Do]===ck}}class nh extends Ww{constructor(t,n,s,r){super(t,"event",n,s);he(this,"anonymous");Object.defineProperty(this,Do,{value:uk}),yn(this,{anonymous:r})}get topicHash(){return ag(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("event"),n.push(this.name+WA(t,this.inputs)),t!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(t,n){return n=(n||[]).map(r=>oa.from(r)),new nh(Rs,t,n,!1).topicHash}static from(t){if(nh.isFragment(t))return t;if(typeof t=="string")try{return nh.from(z0(t))}catch{Se(!1,"invalid event fragment","obj",t)}else if(t instanceof Xc){const n=Kw("event",t),s=kf(t,!0),r=!!Vf(t,eo(["anonymous"])).has("anonymous");return og(t),new nh(Rs,n,s,r)}return new nh(Rs,t.name,t.inputs?t.inputs.map(n=>oa.from(n,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[Do]===uk}}class Bf extends lg{constructor(t,n,s,r,a){super(t,n,s);he(this,"payable");he(this,"gas");Object.defineProperty(this,Do,{value:hk}),yn(this,{payable:r,gas:a})}format(t){if(yt(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[`constructor${WA(t,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(t){if(Bf.isFragment(t))return t;if(typeof t=="string")try{return Bf.from(z0(t))}catch{Se(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof Xc){Vf(t,eo(["constructor"]));const n=kf(t),s=!!Vf(t,Vte).has("payable"),r=Hz(t);return og(t),new Bf(Rs,"constructor",n,s,r)}return new Bf(Rs,"constructor",t.inputs?t.inputs.map(oa.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Do]===hk}}class pf extends lg{constructor(t,n,s){super(t,"fallback",n);he(this,"payable");Object.defineProperty(this,Do,{value:fk}),yn(this,{payable:s})}format(t){const n=this.inputs.length===0?"receive":"fallback";if(t==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:s})}return`${n}()${this.payable?" payable":""}`}static from(t){if(pf.isFragment(t))return t;if(typeof t=="string")try{return pf.from(z0(t))}catch{Se(!1,"invalid fallback fragment","obj",t)}else if(t instanceof Xc){const n=t.toString(),s=t.peekKeyword(eo(["fallback","receive"]));if(Se(s,"type must be fallback or receive","obj",n),t.popKeyword(eo(["fallback","receive"]))==="receive"){const l=kf(t);return Se(l.length===0,"receive cannot have arguments","obj.inputs",l),Vf(t,eo(["payable"])),og(t),new pf(Rs,[],!0)}let a=kf(t);a.length?Se(a.length===1&&a[0].type==="bytes","invalid fallback inputs","obj.inputs",a.map(l=>l.format("minimal")).join(", ")):a=[oa.from("bytes")];const o=Fz(t);if(Se(o==="nonpayable"||o==="payable","fallback cannot be constants","obj.stateMutability",o),Vf(t,eo(["returns"])).has("returns")){const l=kf(t);Se(l.length===1&&l[0].type==="bytes","invalid fallback outputs","obj.outputs",l.map(c=>c.format("minimal")).join(", "))}return og(t),new pf(Rs,a,o==="payable")}if(t.type==="receive")return new pf(Rs,[],!0);if(t.type==="fallback"){const n=[oa.from("bytes")],s=t.stateMutability==="payable";return new pf(Rs,n,s)}Se(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[Do]===fk}}class ih extends Ww{constructor(t,n,s,r,a,o){super(t,"function",n,r);he(this,"constant");he(this,"outputs");he(this,"stateMutability");he(this,"payable");he(this,"gas");Object.defineProperty(this,Do,{value:dk}),a=Object.freeze(a.slice()),yn(this,{constant:s==="view"||s==="pure",gas:o,outputs:a,payable:s==="payable",stateMutability:s})}get selector(){return ag(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t))),outputs:this.outputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("function"),n.push(this.name+WA(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push(WA(t,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(t,n){return n=(n||[]).map(r=>oa.from(r)),new ih(Rs,t,"view",n,[],null).selector}static from(t){if(ih.isFragment(t))return t;if(typeof t=="string")try{return ih.from(z0(t))}catch{Se(!1,"invalid function fragment","obj",t)}else if(t instanceof Xc){const s=Kw("function",t),r=kf(t),a=Fz(t);let o=[];Vf(t,eo(["returns"])).has("returns")&&(o=kf(t));const l=Hz(t);return og(t),new ih(Rs,s,a,r,o,l)}let n=t.stateMutability;return n==null&&(n="payable",typeof t.constant=="boolean"?(n="view",t.constant||(n="payable",typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable")),new ih(Rs,t.name,n,t.inputs?t.inputs.map(oa.from):[],t.outputs?t.outputs.map(oa.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Do]===dk}}class $m extends Ww{constructor(e,t,n){super(e,"struct",t,n),Object.defineProperty(this,Do,{value:pk})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return $m.from(z0(e))}catch{Se(!1,"invalid struct fragment","obj",e)}else if(e instanceof Xc){const t=Kw("struct",e),n=kf(e);return og(e),new $m(Rs,t,n)}return new $m(Rs,e.name,e.inputs?e.inputs.map(oa.from):[])}static isFragment(e){return e&&e[Do]===pk}}const Jc=new Map;Jc.set(0,"GENERIC_PANIC");Jc.set(1,"ASSERT_FALSE");Jc.set(17,"OVERFLOW");Jc.set(18,"DIVIDE_BY_ZERO");Jc.set(33,"ENUM_RANGE_ERROR");Jc.set(34,"BAD_STORAGE_DATA");Jc.set(49,"STACK_UNDERFLOW");Jc.set(50,"ARRAY_RANGE_ERROR");Jc.set(65,"OUT_OF_MEMORY");Jc.set(81,"UNINITIALIZED_FUNCTION_CALL");const ene=new RegExp(/^bytes([0-9]*)$/),tne=new RegExp(/^(u?int)([0-9]*)$/);let cR=null,mk=1024;function nne(i,e,t,n){let s="missing revert data",r=null;const a=null;let o=null;if(t){s="execution reverted";const c=mi(t);if(t=Xt(t),c.length===0)s+=" (no data present; likely require(false) occurred",r="require(false)";else if(c.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(Xt(c.slice(0,4))==="0x08c379a0")try{r=n.decode(["string"],c.slice(4))[0],o={signature:"Error(string)",name:"Error",args:[r]},s+=`: ${JSON.stringify(r)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(Xt(c.slice(0,4))==="0x4e487b71")try{const h=Number(n.decode(["uint256"],c.slice(4))[0]);o={signature:"Panic(uint256)",name:"Panic",args:[h]},r=`Panic due to ${Jc.get(h)||"UNKNOWN"}(${h})`,s+=`: ${r}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const l={to:e.to?Qi(e.to):null,data:e.data||"0x"};return e.from&&(l.from=Qi(e.from)),Ys(s,"CALL_EXCEPTION",{action:i,data:t,reason:r,transaction:l,invocation:a,revert:o})}var h0,ay;const Mw=class Mw{constructor(){je(this,h0)}getDefaultValue(e){const t=e.map(s=>wt(this,h0,ay).call(this,oa.from(s)));return new tS(t,"_").defaultValue()}encode(e,t){hG(t.length,e.length,"types/values length mismatch");const n=e.map(a=>wt(this,h0,ay).call(this,oa.from(a))),s=new tS(n,"_"),r=new fL;return s.encode(r,t),r.data}decode(e,t,n){const s=e.map(a=>wt(this,h0,ay).call(this,oa.from(a)));return new tS(s,"_").decode(new dL(t,n,mk))}static _setDefaultMaxInflation(e){Se(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),mk=e}static defaultAbiCoder(){return cR==null&&(cR=new Mw),cR}static getBuiltinCallException(e,t,n){return nne(e,t,n,Mw.defaultAbiCoder())}};h0=new WeakSet,ay=function(e){if(e.isArray())return new Tee(wt(this,h0,ay).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new tS(e.components.map(n=>wt(this,h0,ay).call(this,n)),e.name);switch(e.baseType){case"address":return new _ee(e.name);case"bool":return new wee(e.name);case"string":return new Pee(e.name);case"bytes":return new Mee(e.name);case"":return new Dee(e.name)}let t=e.type.match(tne);if(t){let n=parseInt(t[2]||"256");return Se(n!==0&&n<=256&&n%8===0,"invalid "+t[1]+" bit length","param",e),new Oee(n/8,t[1]==="int",e.name)}if(t=e.type.match(ene),t){let n=parseInt(t[1]);return Se(n!==0&&n<=32,"invalid bytes length","param",e),new Cee(n,e.name)}Se(!1,"invalid type","type",e.type)};let XA=Mw;class ine{constructor(e,t,n){he(this,"fragment");he(this,"name");he(this,"signature");he(this,"topic");he(this,"args");const s=e.name,r=e.format();yn(this,{fragment:e,name:s,signature:r,topic:t,args:n})}}class sne{constructor(e,t,n,s){he(this,"fragment");he(this,"name");he(this,"args");he(this,"signature");he(this,"selector");he(this,"value");const r=e.name,a=e.format();yn(this,{fragment:e,name:r,args:n,signature:a,selector:t,value:s})}}class rne{constructor(e,t,n){he(this,"fragment");he(this,"name");he(this,"args");he(this,"signature");he(this,"selector");const s=e.name,r=e.format();yn(this,{fragment:e,name:s,args:n,signature:r,selector:t})}}class gk{constructor(e){he(this,"hash");he(this,"_isIndexed");yn(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const yk={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},vk={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:i=>`reverted with reason string ${JSON.stringify(i)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:i=>{let e="unknown panic code";return i>=0&&i<=255&&yk[i.toString()]&&(e=yk[i.toString()]),`reverted with panic code 0x${i.toString(16)} (${e})`}}};var qu,Qu,$u,wa,ph,OT,PT;const mm=class mm{constructor(e){je(this,ph);he(this,"fragments");he(this,"deploy");he(this,"fallback");he(this,"receive");je(this,qu);je(this,Qu);je(this,$u);je(this,wa);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,fe(this,$u,new Map),fe(this,qu,new Map),fe(this,Qu,new Map);const n=[];for(const a of t)try{n.push(lg.from(a))}catch(o){console.log(`[Warning] Invalid Fragment ${JSON.stringify(a)}:`,o.message)}yn(this,{fragments:Object.freeze(n)});let s=null,r=!1;fe(this,wa,this.getAbiCoder()),this.fragments.forEach((a,o)=>{let l;switch(a.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}yn(this,{deploy:a});return;case"fallback":a.inputs.length===0?r=!0:(Se(!s||a.payable!==s.payable,"conflicting fallback fragments",`fragments[${o}]`,a),s=a,r=s.payable);return;case"function":l=K(this,$u);break;case"event":l=K(this,Qu);break;case"error":l=K(this,qu);break;default:return}const c=a.format();l.has(c)||l.set(c,a)}),this.deploy||yn(this,{deploy:Bf.from("constructor()")}),yn(this,{fallback:s,receive:r})}format(e){const t=e?"minimal":"full";return this.fragments.map(s=>s.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return XA.defaultAbiCoder()}getFunctionName(e){const t=wt(this,ph,OT).call(this,e,null,!1);return Se(t,"no matching function","key",e),t.name}hasFunction(e){return!!wt(this,ph,OT).call(this,e,null,!1)}getFunction(e,t){return wt(this,ph,OT).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(K(this,$u).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(K(this,$u).get(s),n)}}getEventName(e){const t=wt(this,ph,PT).call(this,e,null,!1);return Se(t,"no matching event","key",e),t.name}hasEvent(e){return!!wt(this,ph,PT).call(this,e,null,!1)}getEvent(e,t){return wt(this,ph,PT).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(K(this,Qu).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(K(this,Qu).get(s),n)}}getError(e,t){if(ls(e)){const s=e.toLowerCase();if(vk[s])return To.from(vk[s].signature);for(const r of K(this,qu).values())if(s===r.selector)return r;return null}if(e.indexOf("(")===-1){const s=[];for(const[r,a]of K(this,qu))r.split("(")[0]===e&&s.push(a);if(s.length===0)return e==="Error"?To.from("error Error(string)"):e==="Panic"?To.from("error Panic(uint256)"):null;if(s.length>1){const r=s.map(a=>JSON.stringify(a.format())).join(", ");Se(!1,`ambiguous error description (i.e. ${r})`,"name",e)}return s[0]}if(e=To.from(e).format(),e==="Error(string)")return To.from("error Error(string)");if(e==="Panic(uint256)")return To.from("error Panic(uint256)");const n=K(this,qu).get(e);return n||null}forEachError(e){const t=Array.from(K(this,qu).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(K(this,qu).get(s),n)}}_decodeParams(e,t){return K(this,wa).decode(e,t)}_encodeParams(e,t){return K(this,wa).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);Se(n,"unknown error","fragment",e),e=n}return Se(Ks(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,Ks(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);Se(n,"unknown error","fragment",e),e=n}return cr([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);Se(n,"unknown function","fragment",e),e=n}return Se(Ks(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,Ks(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);Se(n,"unknown function","fragment",e),e=n}return cr([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const r=this.getFunction(e);Se(r,"unknown function","fragment",e),e=r}let n="invalid length for result data";const s=qa(t);if(s.length%32===0)try{return K(this,wa).decode(e.outputs,s)}catch{n="could not decode result data"}yt(!1,n,"BAD_DATA",{value:Xt(s),info:{method:e.name,signature:e.format()}})}makeError(e,t){const n=mi(e,"data"),s=XA.getBuiltinCallException("call",t,n);if(s.message.startsWith("execution reverted (unknown custom error)")){const o=Xt(n.slice(0,4)),l=this.getError(o);if(l)try{const c=K(this,wa).decode(l.inputs,n.slice(4));s.revert={name:l.name,signature:l.format(),args:c},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const a=this.parseTransaction(t);return a&&(s.invocation={method:a.name,signature:a.signature,args:a.args}),s}encodeFunctionResult(e,t){if(typeof e=="string"){const n=this.getFunction(e);Se(n,"unknown function","fragment",e),e=n}return Xt(K(this,wa).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const r=this.getEvent(e);Se(r,"unknown event","eventFragment",e),e=r}yt(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const n=[];e.anonymous||n.push(e.topicHash);const s=(r,a)=>r.type==="string"?ag(a):r.type==="bytes"?ir(Xt(a)):(r.type==="bool"&&typeof a=="boolean"?a=a?"0x01":"0x00":r.type.match(/^u?int/)?a=B0(a):r.type.match(/^bytes/)?a=EJ(a,32):r.type==="address"&&K(this,wa).encode(["address"],[a]),sg(Xt(a),32));for(t.forEach((r,a)=>{const o=e.inputs[a];if(!o.indexed){Se(r==null,"cannot filter non-indexed parameters; must be null","contract."+o.name,r);return}r==null?n.push(null):o.baseType==="array"||o.baseType==="tuple"?Se(!1,"filtering with tuples or arrays not supported","contract."+o.name,r):Array.isArray(r)?n.push(r.map(l=>s(o,l))):n.push(s(o,r))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(e,t){if(typeof e=="string"){const a=this.getEvent(e);Se(a,"unknown event","eventFragment",e),e=a}const n=[],s=[],r=[];return e.anonymous||n.push(e.topicHash),Se(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((a,o)=>{const l=t[o];if(a.indexed)if(a.type==="string")n.push(ag(l));else if(a.type==="bytes")n.push(ir(l));else{if(a.baseType==="tuple"||a.baseType==="array")throw new Error("not implemented");n.push(K(this,wa).encode([a.type],[l]))}else s.push(a),r.push(l)}),{data:K(this,wa).encode(s,r),topics:n}}decodeEventLog(e,t,n){if(typeof e=="string"){const y=this.getEvent(e);Se(y,"unknown event","eventFragment",e),e=y}if(n!=null&&!e.anonymous){const y=e.topicHash;Se(ls(n[0],32)&&n[0].toLowerCase()===y,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const s=[],r=[],a=[];e.inputs.forEach((y,x)=>{y.indexed?y.type==="string"||y.type==="bytes"||y.baseType==="tuple"||y.baseType==="array"?(s.push(oa.from({type:"bytes32",name:y.name})),a.push(!0)):(s.push(y),a.push(!1)):(r.push(y),a.push(!1))});const o=n!=null?K(this,wa).decode(s,cr(n)):null,l=K(this,wa).decode(r,t,!0),c=[],h=[];let d=0,m=0;return e.inputs.forEach((y,x)=>{let _=null;if(y.indexed)if(o==null)_=new gk(null);else if(a[x])_=new gk(o[m++]);else try{_=o[m++]}catch(b){_=b}else try{_=l[d++]}catch(b){_=b}c.push(_),h.push(y.name||null)}),xv.fromItems(c,h)}parseTransaction(e){const t=mi(e.data,"tx.data"),n=en(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(Xt(t.slice(0,4)));if(!s)return null;const r=K(this,wa).decode(s.inputs,t.slice(4));return new sne(s,s.selector,r,n)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new ine(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=Xt(e),n=this.getError(Ks(t,0,4));if(!n)return null;const s=K(this,wa).decode(n.inputs,Ks(t,4));return new rne(n,n.selector,s)}static from(e){return e instanceof mm?e:typeof e=="string"?new mm(JSON.parse(e)):typeof e.formatJson=="function"?new mm(e.formatJson()):typeof e.format=="function"?new mm(e.format("json")):new mm(e)}};qu=new WeakMap,Qu=new WeakMap,$u=new WeakMap,wa=new WeakMap,ph=new WeakSet,OT=function(e,t,n){if(ls(e)){const r=e.toLowerCase();for(const a of K(this,$u).values())if(r===a.selector)return a;return null}if(e.indexOf("(")===-1){const r=[];for(const[a,o]of K(this,$u))a.split("(")[0]===e&&r.push(o);if(t){const a=t.length>0?t[t.length-1]:null;let o=t.length,l=!0;Ia.isTyped(a)&&a.type==="overrides"&&(l=!1,o--);for(let c=r.length-1;c>=0;c--){const h=r[c].inputs.length;h!==o&&(!l||h!==o-1)&&r.splice(c,1)}for(let c=r.length-1;c>=0;c--){const h=r[c].inputs;for(let d=0;d<t.length;d++)if(Ia.isTyped(t[d])){if(d>=h.length){if(t[d].type==="overrides")continue;r.splice(c,1);break}if(t[d].type!==h[d].baseType){r.splice(c,1);break}}}}if(r.length===1&&t&&t.length!==r[0].inputs.length){const a=t[t.length-1];(a==null||Array.isArray(a)||typeof a!="object")&&r.splice(0,1)}if(r.length===0)return null;if(r.length>1&&n){const a=r.map(o=>JSON.stringify(o.format())).join(", ");Se(!1,`ambiguous function description (i.e. matches ${a})`,"key",e)}return r[0]}const s=K(this,$u).get(ih.from(e).format());return s||null},PT=function(e,t,n){if(ls(e)){const r=e.toLowerCase();for(const a of K(this,Qu).values())if(r===a.topicHash)return a;return null}if(e.indexOf("(")===-1){const r=[];for(const[a,o]of K(this,Qu))a.split("(")[0]===e&&r.push(o);if(t){for(let a=r.length-1;a>=0;a--)r[a].inputs.length<t.length&&r.splice(a,1);for(let a=r.length-1;a>=0;a--){const o=r[a].inputs;for(let l=0;l<t.length;l++)if(Ia.isTyped(t[l])&&t[l].type!==o[l].baseType){r.splice(a,1);break}}}if(r.length===0)return null;if(r.length>1&&n){const a=r.map(o=>JSON.stringify(o.format())).join(", ");Se(!1,`ambiguous event description (i.e. matches ${a})`,"key",e)}return r[0]}const s=K(this,Qu).get(nh.from(e).format());return s||null};let ML=mm;const Gz=BigInt(0);function _y(i){return i??null}function er(i){return i==null?null:i.toString()}class xk{constructor(e,t,n){he(this,"gasPrice");he(this,"maxFeePerGas");he(this,"maxPriorityFeePerGas");yn(this,{gasPrice:_y(e),maxFeePerGas:_y(t),maxPriorityFeePerGas:_y(n)})}toJSON(){const{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:n}=this;return{_type:"FeeData",gasPrice:er(e),maxFeePerGas:er(t),maxPriorityFeePerGas:er(n)}}}function x3(i){const e={};i.to&&(e.to=i.to),i.from&&(e.from=i.from),i.data&&(e.data=Xt(i.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of t)!(s in i)||i[s]==null||(e[s]=en(i[s],`request.${s}`));const n="type,nonce".split(/,/);for(const s of n)!(s in i)||i[s]==null||(e[s]=Gn(i[s],`request.${s}`));return i.accessList&&(e.accessList=_g(i.accessList)),"blockTag"in i&&(e.blockTag=i.blockTag),"enableCcipRead"in i&&(e.enableCcipRead=!!i.enableCcipRead),"customData"in i&&(e.customData=i.customData),"blobVersionedHashes"in i&&i.blobVersionedHashes&&(e.blobVersionedHashes=i.blobVersionedHashes.slice()),"kzg"in i&&(e.kzg=i.kzg),"blobs"in i&&i.blobs&&(e.blobs=i.blobs.map(s=>lB(s)?Xt(s):Object.assign({},s))),e}var _f,T5;let ane=(T5=class{constructor(e,t){he(this,"provider");he(this,"number");he(this,"hash");he(this,"timestamp");he(this,"parentHash");he(this,"parentBeaconBlockRoot");he(this,"nonce");he(this,"difficulty");he(this,"gasLimit");he(this,"gasUsed");he(this,"stateRoot");he(this,"receiptsRoot");he(this,"blobGasUsed");he(this,"excessBlobGas");he(this,"miner");he(this,"prevRandao");he(this,"extraData");he(this,"baseFeePerGas");je(this,_f);fe(this,_f,e.transactions.map(n=>typeof n!="string"?new jA(n,t):n)),yn(this,{provider:t,hash:_y(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:_y(e.prevRandao),extraData:e.extraData,baseFeePerGas:_y(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return K(this,_f).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=K(this,_f).slice();return e.length===0?[]:(yt(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:t,extraData:n,gasLimit:s,gasUsed:r,hash:a,miner:o,prevRandao:l,nonce:c,number:h,parentHash:d,parentBeaconBlockRoot:m,stateRoot:y,receiptsRoot:x,timestamp:_,transactions:b}=this;return{_type:"Block",baseFeePerGas:er(e),difficulty:er(t),extraData:n,gasLimit:er(s),gasUsed:er(r),blobGasUsed:er(this.blobGasUsed),excessBlobGas:er(this.excessBlobGas),hash:a,miner:o,prevRandao:l,nonce:c,number:h,parentHash:d,timestamp:_,parentBeaconBlockRoot:m,stateRoot:y,receiptsRoot:x,transactions:b}}[Symbol.iterator](){let e=0;const t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return K(this,_f).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let t;if(typeof e=="number")t=K(this,_f)[e];else{const n=e.toLowerCase();for(const s of K(this,_f))if(typeof s=="string"){if(s!==n)continue;t=s;break}else{if(s.hash!==n)continue;t=s;break}}if(t==null)throw new Error("no such tx");return typeof t=="string"?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){const t=this.prefetchedTransactions;if(typeof e=="number")return t[e];e=e.toLowerCase();for(const n of t)if(n.hash===e)return n;Se(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return one(this)}},_f=new WeakMap,T5);class BE{constructor(e,t){he(this,"provider");he(this,"transactionHash");he(this,"blockHash");he(this,"blockNumber");he(this,"removed");he(this,"address");he(this,"data");he(this,"topics");he(this,"index");he(this,"transactionIndex");this.provider=t;const n=Object.freeze(e.topics.slice());yn(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:n,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:n,data:s,index:r,removed:a,topics:o,transactionHash:l,transactionIndex:c}=this;return{_type:"log",address:e,blockHash:t,blockNumber:n,data:s,index:r,removed:a,topics:o,transactionHash:l,transactionIndex:c}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return yt(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return yt(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return yt(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return lne(this)}}var xE;class zz{constructor(e,t){he(this,"provider");he(this,"to");he(this,"from");he(this,"contractAddress");he(this,"hash");he(this,"index");he(this,"blockHash");he(this,"blockNumber");he(this,"logsBloom");he(this,"gasUsed");he(this,"blobGasUsed");he(this,"cumulativeGasUsed");he(this,"gasPrice");he(this,"blobGasPrice");he(this,"type");he(this,"status");he(this,"root");je(this,xE);fe(this,xE,Object.freeze(e.logs.map(s=>new BE(s,t))));let n=Gz;e.effectiveGasPrice!=null?n=e.effectiveGasPrice:e.gasPrice!=null&&(n=e.gasPrice),yn(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:n,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return K(this,xE)}toJSON(){const{to:e,from:t,contractAddress:n,hash:s,index:r,blockHash:a,blockNumber:o,logsBloom:l,logs:c,status:h,root:d}=this;return{_type:"TransactionReceipt",blockHash:a,blockNumber:o,contractAddress:n,cumulativeGasUsed:er(this.cumulativeGasUsed),from:t,gasPrice:er(this.gasPrice),blobGasUsed:er(this.blobGasUsed),blobGasPrice:er(this.blobGasPrice),gasUsed:er(this.gasUsed),hash:s,index:r,logs:c,logsBloom:l,root:d,status:h,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return Yz(this)}reorderedEvent(e){return yt(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),Vz(this,e)}}xE=new WeakMap;var f0;const aP=class aP{constructor(e,t){he(this,"provider");he(this,"blockNumber");he(this,"blockHash");he(this,"index");he(this,"hash");he(this,"type");he(this,"to");he(this,"from");he(this,"nonce");he(this,"gasLimit");he(this,"gasPrice");he(this,"maxPriorityFeePerGas");he(this,"maxFeePerGas");he(this,"maxFeePerBlobGas");he(this,"data");he(this,"value");he(this,"chainId");he(this,"signature");he(this,"accessList");he(this,"blobVersionedHashes");je(this,f0);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,fe(this,f0,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:n,hash:s,type:r,to:a,from:o,nonce:l,data:c,signature:h,accessList:d,blobVersionedHashes:m}=this;return{_type:"TransactionResponse",accessList:d,blockNumber:e,blockHash:t,blobVersionedHashes:m,chainId:er(this.chainId),data:c,from:o,gasLimit:er(this.gasLimit),gasPrice:er(this.gasPrice),hash:s,maxFeePerGas:er(this.maxFeePerGas),maxPriorityFeePerGas:er(this.maxPriorityFeePerGas),maxFeePerBlobGas:er(this.maxFeePerBlobGas),nonce:l,signature:h,to:a,index:n,type:r,value:er(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const n=await this.getTransaction();n&&(e=n.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:n}=await Xa({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:n-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const n=e??1,s=t??0;let r=K(this,f0),a=-1,o=r===-1;const l=async()=>{if(o)return null;const{blockNumber:m,nonce:y}=await Xa({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(y<this.nonce){r=m;return}if(o)return null;const x=await this.getTransaction();if(!(x&&x.blockNumber!=null))for(a===-1&&(a=r-3,a<K(this,f0)&&(a=K(this,f0)));a<=m;){if(o)return null;const _=await this.provider.getBlock(a,!0);if(_==null)return;for(const b of _)if(b===this.hash)return;for(let b=0;b<_.length;b++){const A=await _.getTransaction(b);if(A.from===this.from&&A.nonce===this.nonce){if(o)return null;const T=await this.provider.getTransactionReceipt(A.hash);if(T==null||m-T.blockNumber+1<n)return;let w="replaced";A.data===this.data&&A.to===this.to&&A.value===this.value?w="repriced":A.data==="0x"&&A.from===A.to&&A.value===Gz&&(w="cancelled"),yt(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:w==="replaced"||w==="cancelled",reason:w,replacement:A.replaceableTransaction(r),hash:A.hash,receipt:T})}}a++}},c=m=>{if(m==null||m.status!==0)return m;yt(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:m.to,from:m.from,data:""},receipt:m})},h=await this.provider.getTransactionReceipt(this.hash);if(n===0)return c(h);if(h){if(await h.confirmations()>=n)return c(h)}else if(await l(),n===0)return null;return await new Promise((m,y)=>{const x=[],_=()=>{x.forEach(A=>A())};if(x.push(()=>{o=!0}),s>0){const A=setTimeout(()=>{_(),y(Ys("wait for transaction timeout","TIMEOUT"))},s);x.push(()=>{clearTimeout(A)})}const b=async A=>{if(await A.confirmations()>=n){_();try{m(c(A))}catch(T){y(T)}}};if(x.push(()=>{this.provider.off(this.hash,b)}),this.provider.on(this.hash,b),r>=0){const A=async()=>{try{await l()}catch(T){if(ra(T,"TRANSACTION_REPLACED")){_(),y(T);return}}o||this.provider.once("block",A)};x.push(()=>{this.provider.off("block",A)}),this.provider.once("block",A)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return yt(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Yz(this)}reorderedEvent(e){return yt(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),yt(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Vz(this,e)}replaceableTransaction(e){Se(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new aP(this,this.provider);return fe(t,f0,e),t}};f0=new WeakMap;let jA=aP;function one(i){return{orphan:"drop-block",hash:i.hash,number:i.number}}function Vz(i,e){return{orphan:"reorder-transaction",tx:i,other:e}}function Yz(i){return{orphan:"drop-transaction",tx:i}}function lne(i){return{orphan:"drop-log",log:{transactionHash:i.transactionHash,blockHash:i.blockHash,blockNumber:i.blockNumber,address:i.address,data:i.data,topics:Object.freeze(i.topics.slice()),index:i.index}}}class _B extends BE{constructor(t,n,s){super(t,t.provider);he(this,"interface");he(this,"fragment");he(this,"args");const r=n.decodeEventLog(s,t.data,t.topics);yn(this,{args:r,fragment:s,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class Kz extends BE{constructor(t,n){super(t,t.provider);he(this,"error");yn(this,{error:n})}}var tv;class cne extends zz{constructor(t,n,s){super(s,n);je(this,tv);fe(this,tv,t)}get logs(){return super.logs.map(t=>{const n=t.topics.length?K(this,tv).getEvent(t.topics[0]):null;if(n)try{return new _B(t,K(this,tv),n)}catch(s){return new Kz(t,s)}return t})}}tv=new WeakMap;var bE;class SB extends jA{constructor(t,n,s){super(s,n);je(this,bE);fe(this,bE,t)}async wait(t,n){const s=await super.wait(t,n);return s==null?null:new cne(K(this,bE),this.provider,s)}}bE=new WeakMap;class Wz extends mG{constructor(t,n,s,r){super(t,n,s);he(this,"log");yn(this,{log:r})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class une extends Wz{constructor(e,t,n,s,r){super(e,t,n,new _B(r,e.interface,s));const a=e.interface.decodeEventLog(s,this.log.data,this.log.topics);yn(this,{args:a,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const bk=BigInt(0);function Xz(i){return i&&typeof i.call=="function"}function jz(i){return i&&typeof i.estimateGas=="function"}function Xw(i){return i&&typeof i.resolveName=="function"}function qz(i){return i&&typeof i.sendTransaction=="function"}function Qz(i){if(i!=null){if(Xw(i))return i;if(i.provider)return i.provider}}var AE;class hne{constructor(e,t,n){je(this,AE);he(this,"fragment");if(yn(this,{fragment:t}),t.inputs.length<n.length)throw new Error("too many arguments");const s=cg(e.runner,"resolveName"),r=Xw(s)?s:null;fe(this,AE,async function(){const a=await Promise.all(t.inputs.map((o,l)=>n[l]==null?null:o.walkAsync(n[l],(h,d)=>h==="address"?Array.isArray(d)?Promise.all(d.map(m=>Za(m,r))):Za(d,r):d)));return e.interface.encodeFilterTopics(t,a)}())}getTopicFilter(){return K(this,AE)}}AE=new WeakMap;function cg(i,e){return i==null?null:typeof i[e]=="function"?i:i.provider&&typeof i.provider[e]=="function"?i.provider:null}function xm(i){return i==null?null:i.provider||null}async function $z(i,e){const t=Ia.dereference(i,"overrides");Se(typeof t=="object","invalid overrides parameter","overrides",i);const n=x3(t);return Se(n.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),Se(n.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}async function fne(i,e,t){const n=cg(i,"resolveName"),s=Xw(n)?n:null;return await Promise.all(e.map((r,a)=>r.walkAsync(t[a],(o,l)=>(l=Ia.dereference(l,o),o==="address"?Za(l,s):l))))}function dne(i){const e=async function(a){const o=await $z(a,["data"]);o.to=await i.getAddress(),o.from&&(o.from=await Za(o.from,Qz(i.runner)));const l=i.interface,c=en(o.value||bk,"overrides.value")===bk,h=(o.data||"0x")==="0x";l.fallback&&!l.fallback.payable&&l.receive&&!h&&!c&&Se(!1,"cannot send data to receive or send value to non-payable fallback","overrides",a),Se(l.fallback||h,"cannot send data to receive-only contract","overrides.data",o.data);const d=l.receive||l.fallback&&l.fallback.payable;return Se(d||c,"cannot send value to non-payable fallback","overrides.value",o.value),Se(l.fallback||h,"cannot send data to receive-only contract","overrides.data",o.data),o},t=async function(a){const o=cg(i.runner,"call");yt(Xz(o),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const l=await e(a);try{return await o.call(l)}catch(c){throw oB(c)&&c.data?i.interface.makeError(c.data,l):c}},n=async function(a){const o=i.runner;yt(qz(o),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const l=await o.sendTransaction(await e(a)),c=xm(i.runner);return new SB(i.interface,c,l)},s=async function(a){const o=cg(i.runner,"estimateGas");return yt(jz(o),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await o.estimateGas(await e(a))},r=async a=>await n(a);return yn(r,{_contract:i,estimateGas:s,populateTransaction:e,send:n,staticCall:t}),r}function pne(i,e){const t=function(...c){const h=i.interface.getFunction(e,c);return yt(h,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:c}}),h},n=async function(...c){const h=t(...c);let d={};if(h.inputs.length+1===c.length&&(d=await $z(c.pop()),d.from&&(d.from=await Za(d.from,Qz(i.runner)))),h.inputs.length!==c.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const m=await fne(i.runner,h.inputs,c);return Object.assign({},d,await Xa({to:i.getAddress(),data:i.interface.encodeFunctionData(h,m)}))},s=async function(...c){const h=await o(...c);return h.length===1?h[0]:h},r=async function(...c){const h=i.runner;yt(qz(h),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const d=await h.sendTransaction(await n(...c)),m=xm(i.runner);return new SB(i.interface,m,d)},a=async function(...c){const h=cg(i.runner,"estimateGas");return yt(jz(h),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await h.estimateGas(await n(...c))},o=async function(...c){const h=cg(i.runner,"call");yt(Xz(h),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const d=await n(...c);let m="0x";try{m=await h.call(d)}catch(x){throw oB(x)&&x.data?i.interface.makeError(x.data,d):x}const y=t(...c);return i.interface.decodeFunctionResult(y,m)},l=async(...c)=>t(...c).constant?await s(...c):await r(...c);return yn(l,{name:i.interface.getFunctionName(e),_contract:i,_key:e,getFragment:t,estimateGas:a,populateTransaction:n,send:r,staticCall:s,staticCallResult:o}),Object.defineProperty(l,"fragment",{configurable:!1,enumerable:!0,get:()=>{const c=i.interface.getFunction(e);return yt(c,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),c}}),l}function mne(i,e){const t=function(...s){const r=i.interface.getEvent(e,s);return yt(r,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),r},n=function(...s){return new hne(i,t(...s),s)};return yn(n,{name:i.interface.getEventName(e),_contract:i,_key:e,getFragment:t}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=i.interface.getEvent(e);return yt(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),n}const b3=Symbol.for("_ethersInternal_contract"),Jz=new WeakMap;function gne(i,e){Jz.set(i[b3],e)}function jo(i){return Jz.get(i[b3])}function yne(i){return i&&typeof i=="object"&&"getTopicFilter"in i&&typeof i.getTopicFilter=="function"&&i.fragment}async function TB(i,e){let t,n=null;if(Array.isArray(e)){const r=function(a){if(ls(a,32))return a;const o=i.interface.getEvent(a);return Se(o,"unknown fragment","name",a),o.topicHash};t=e.map(a=>a==null?null:Array.isArray(a)?a.map(r):r(a))}else e==="*"?t=[null]:typeof e=="string"?ls(e,32)?t=[e]:(n=i.interface.getEvent(e),Se(n,"unknown fragment","event",e),t=[n.topicHash]):yne(e)?t=await e.getTopicFilter():"fragment"in e?(n=e.fragment,t=[n.topicHash]):Se(!1,"unknown event name","event",e);t=t.map(r=>{if(r==null)return null;if(Array.isArray(r)){const a=Array.from(new Set(r.map(o=>o.toLowerCase())).values());return a.length===1?a[0]:(a.sort(),a)}return r.toLowerCase()});const s=t.map(r=>r==null?"null":Array.isArray(r)?r.join("|"):r).join("&");return{fragment:n,tag:s,topics:t}}async function qb(i,e){const{subs:t}=jo(i);return t.get((await TB(i,e)).tag)||null}async function Ak(i,e,t){const n=xm(i.runner);yt(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:r,topics:a}=await TB(i,t),{addr:o,subs:l}=jo(i);let c=l.get(r);if(!c){const d={address:o||i,topics:a},m=b=>{let A=s;if(A==null)try{A=i.interface.getEvent(b.topics[0])}catch{}if(A){const T=A,w=s?i.interface.decodeEventLog(s,b.data,b.topics):[];RL(i,t,w,R=>new une(i,R,t,T,b))}else RL(i,t,[],T=>new Wz(i,T,t,b))};let y=[];c={tag:r,listeners:[],start:()=>{y.length||y.push(n.on(d,m))},stop:async()=>{if(y.length==0)return;let b=y;y=[],await Promise.all(b),n.off(d,m)}},l.set(r,c)}return c}let CL=Promise.resolve();async function vne(i,e,t,n){await CL;const s=await qb(i,e);if(!s)return!1;const r=s.listeners.length;return s.listeners=s.listeners.filter(({listener:a,once:o})=>{const l=Array.from(t);n&&l.push(n(o?null:a));try{a.call(i,...l)}catch{}return!o}),s.listeners.length===0&&(s.stop(),jo(i).subs.delete(s.tag)),r>0}async function RL(i,e,t,n){try{await CL}catch{}const s=vne(i,e,t,n);return CL=s,await s}const iS=["then"];var w5;w5=b3;const RA=class RA{constructor(e,t,n,s){he(this,"target");he(this,"interface");he(this,"runner");he(this,"filters");he(this,w5);he(this,"fallback");Se(typeof e=="string"||sz(e),"invalid value for Contract target","target",e),n==null&&(n=null);const r=ML.from(t);yn(this,{target:e,runner:n,interface:r}),Object.defineProperty(this,b3,{value:{}});let a,o=null,l=null;if(s){const d=xm(n);l=new SB(this.interface,d,s)}let c=new Map;if(typeof e=="string")if(ls(e))o=e,a=Promise.resolve(e);else{const d=cg(n,"resolveName");if(!Xw(d))throw Ys("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});a=d.resolveName(e).then(m=>{if(m==null)throw Ys("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return jo(this).addr=m,m})}else a=e.getAddress().then(d=>{if(d==null)throw new Error("TODO");return jo(this).addr=d,d});gne(this,{addrPromise:a,addr:o,deployTx:l,subs:c});const h=new Proxy({},{get:(d,m,y)=>{if(typeof m=="symbol"||iS.indexOf(m)>=0)return Reflect.get(d,m,y);try{return this.getEvent(m)}catch(x){if(!ra(x,"INVALID_ARGUMENT")||x.argument!=="key")throw x}},has:(d,m)=>iS.indexOf(m)>=0?Reflect.has(d,m):Reflect.has(d,m)||this.interface.hasEvent(String(m))});return yn(this,{filters:h}),yn(this,{fallback:r.receive||r.fallback?dne(this):null}),new Proxy(this,{get:(d,m,y)=>{if(typeof m=="symbol"||m in d||iS.indexOf(m)>=0)return Reflect.get(d,m,y);try{return d.getFunction(m)}catch(x){if(!ra(x,"INVALID_ARGUMENT")||x.argument!=="key")throw x}},has:(d,m)=>typeof m=="symbol"||m in d||iS.indexOf(m)>=0?Reflect.has(d,m):d.interface.hasFunction(m)})}connect(e){return new RA(this.target,this.interface,e)}attach(e){return new RA(e,this.interface,this.runner)}async getAddress(){return await jo(this).addrPromise}async getDeployedCode(){const e=xm(this.runner);yt(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const n=xm(this.runner);return yt(n!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,r)=>{const a=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);n.once("block",a)}catch(o){r(o)}};a()})}deploymentTransaction(){return jo(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),pne(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),mne(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,n){t==null&&(t=0),n==null&&(n="latest");const{addr:s,addrPromise:r}=jo(this),a=s||await r,{fragment:o,topics:l}=await TB(this,e),c={address:a,topics:l,fromBlock:t,toBlock:n},h=xm(this.runner);return yt(h,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await h.getLogs(c)).map(d=>{let m=o;if(m==null)try{m=this.interface.getEvent(d.topics[0])}catch{}if(m)try{return new _B(d,this.interface,m)}catch(y){return new Kz(d,y)}return new BE(d,h)})}async on(e,t){const n=await Ak(this,"on",e);return n.listeners.push({listener:t,once:!1}),n.start(),this}async once(e,t){const n=await Ak(this,"once",e);return n.listeners.push({listener:t,once:!0}),n.start(),this}async emit(e,...t){return await RL(this,e,t,null)}async listenerCount(e){if(e){const s=await qb(this,e);return s?s.listeners.length:0}const{subs:t}=jo(this);let n=0;for(const{listeners:s}of t.values())n+=s.length;return n}async listeners(e){if(e){const s=await qb(this,e);return s?s.listeners.map(({listener:r})=>r):[]}const{subs:t}=jo(this);let n=[];for(const{listeners:s}of t.values())n=n.concat(s.map(({listener:r})=>r));return n}async off(e,t){const n=await qb(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:r})=>r).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(t==null||n.listeners.length===0)&&(n.stop(),jo(this).subs.delete(n.tag)),this}async removeAllListeners(e){if(e){const t=await qb(this,e);if(!t)return this;t.stop(),jo(this).subs.delete(t.tag)}else{const{subs:t}=jo(this);for(const{tag:n,stop:s}of t.values())s(),t.delete(n)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends RA{constructor(s,r=null){super(s,e,r)}}return t}static from(e,t,n){return n==null&&(n=null),new this(e,t,n)}};let DL=RA;function xne(){return DL}class Sy extends xne(){}function uR(i){return i.match(/^ipfs:\/\/ipfs\//i)?i=i.substring(12):i.match(/^ipfs:\/\//i)?i=i.substring(7):Se(!1,"unsupported IPFS format","link",i),`https://gateway.ipfs.io/ipfs/${i}`}class bne{constructor(e){he(this,"name");yn(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const Zz=new RegExp("^(ipfs)://(.*)$","i"),Ek=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),Zz,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var d0,Gm,p0,oy,Cw,e6;const my=class my{constructor(e,t,n){je(this,p0);he(this,"provider");he(this,"address");he(this,"name");je(this,d0);je(this,Gm);yn(this,{provider:e,address:t,name:n}),fe(this,d0,null),fe(this,Gm,new Sy(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return K(this,d0)==null&&fe(this,d0,(async()=>{try{return await K(this,Gm).supportsInterface("0x9061b923")}catch(e){if(ra(e,"CALL_EXCEPTION"))return!1;throw fe(this,d0,null),e}})()),await K(this,d0)}async getAddress(e){if(e==null&&(e=60),e===60)try{const r=await wt(this,p0,oy).call(this,"addr(bytes32)");return r==null||r===HA?null:r}catch(r){if(ra(r,"CALL_EXCEPTION"))return null;throw r}if(e>=0&&e<2147483648){let r=e+2147483648;const a=await wt(this,p0,oy).call(this,"addr(bytes32,uint)",[r]);if(ls(a,20))return Qi(a)}let t=null;for(const r of this.provider.plugins)if(r instanceof bne&&r.supportsCoinType(e)){t=r;break}if(t==null)return null;const n=await wt(this,p0,oy).call(this,"addr(bytes32,uint)",[e]);if(n==null||n==="0x")return null;const s=await t.decodeAddress(e,n);if(s!=null)return s;yt(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:n}})}async getText(e){const t=await wt(this,p0,oy).call(this,"text(bytes32,string)",[e]);return t==null||t==="0x"?null:t}async getContentHash(){const e=await wt(this,p0,oy).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const s=t[1]==="e3010170"?"ipfs":"ipns",r=parseInt(t[4],16);if(t[5].length===r*2)return`${s}://${SJ("0x"+t[2])}`}const n=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&n[1].length===64)return`bzz://${n[1]}`;yt(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const t=await this.getText("avatar");if(t==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let n=0;n<Ek.length;n++){const s=t.match(Ek[n]);if(s==null)continue;const r=s[1].toLowerCase();switch(r){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{const a=uR(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:a}),{linkage:e,url:a}}case"erc721":case"erc1155":{const a=r==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:r,value:t});const o=await this.getAddress();if(o==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const l=(s[2]||"").split("/");if(l.length!==2)return e.push({type:`!${r}caip`,value:s[2]||""}),{url:null,linkage:e};const c=l[1],h=new Sy(l[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(r==="erc721"){const _=await h.ownerOf(c);if(o!==_)return e.push({type:"!owner",value:_}),{url:null,linkage:e};e.push({type:"owner",value:_})}else if(r==="erc1155"){const _=await h.balanceOf(o,c);if(!_)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:_.toString()})}let d=await h[a](c);if(d==null||d==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:d}),r==="erc1155"&&(d=d.replace("{id}",B0(c,32).substring(2)),e.push({type:"metadata-url-expanded",value:d})),d.match(/^ipfs:/i)&&(d=uR(d)),e.push({type:"metadata-url",value:d});let m={};const y=await new O0(d).send();y.assertOk();try{m=y.bodyJson}catch{try{e.push({type:"!metadata",value:y.bodyText})}catch{const A=y.body;return A&&e.push({type:"!metadata",value:Xt(A)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!m)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(m)});let x=m.image;if(typeof x!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!x.match(/^(https:\/\/|data:)/i)){if(x.match(Zz)==null)return e.push({type:"!imageUrl-ipfs",value:x}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:x}),x=uR(x)}return e.push({type:"url",value:x}),{linkage:e,url:x}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),n=t.getPlugin("org.ethers.plugins.network.Ens");return yt(n,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),n.address}static async fromName(e,t){var s;let n=t;for(;;){if(n===""||n==="."||t!=="eth"&&n==="eth")return null;const r=await wt(s=my,Cw,e6).call(s,e,n);if(r!=null){const a=new my(e,r,t);return n!==t&&!await a.supportsWildcard()?null:a}n=n.split(".").slice(1).join(".")}}};d0=new WeakMap,Gm=new WeakMap,p0=new WeakSet,oy=async function(e,t){t=(t||[]).slice();const n=K(this,Gm).interface;t.unshift(TL(this.name));let s=null;await this.supportsWildcard()&&(s=n.getFunction(e),yt(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[xte(this.name,255),n.encodeFunctionData(s,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const r=await K(this,Gm)[e](...t);return s?n.decodeFunctionResult(s,r)[0]:r}catch(r){if(!ra(r,"CALL_EXCEPTION"))throw r}return null},Cw=new WeakSet,e6=async function(e,t){const n=await my.getEnsAddress(e);try{const r=await new Sy(n,["function resolver(bytes32) view returns (address)"],e).resolver(TL(t),{enableCcipRead:!0});return r===HA?null:r}catch(s){throw s}return null},je(my,Cw);let A3=my;const _k=BigInt(0);function fi(i,e){return function(t){return t==null?e:i(t)}}function jw(i,e){return t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(n=>i(n))}}function OE(i,e){return t=>{const n={};for(const s in i){let r=s;if(e&&s in e&&!(r in t)){for(const a of e[s])if(a in t){r=a;break}}try{const a=i[s](t[r]);a!==void 0&&(n[s]=a)}catch(a){const o=a instanceof Error?a.message:"not-an-error";yt(!1,`invalid value for value.${s} (${o})`,"BAD_DATA",{value:t})}}return n}}function Ane(i){switch(i){case!0:case"true":return!0;case!1:case"false":return!1}Se(!1,`invalid boolean; ${JSON.stringify(i)}`,"value",i)}function wv(i){return Se(ls(i,!0),"invalid data","value",i),i}function sa(i){return Se(ls(i,32),"invalid hash","value",i),i}const Ene=OE({address:Qi,blockHash:sa,blockNumber:Gn,data:wv,index:Gn,removed:fi(Ane,!1),topics:jw(sa),transactionHash:sa,transactionIndex:Gn},{index:["logIndex"]});function _ne(i){return Ene(i)}const Sne=OE({hash:fi(sa),parentHash:sa,parentBeaconBlockRoot:fi(sa,null),number:Gn,timestamp:Gn,nonce:fi(wv),difficulty:en,gasLimit:en,gasUsed:en,stateRoot:fi(sa,null),receiptsRoot:fi(sa,null),blobGasUsed:fi(en,null),excessBlobGas:fi(en,null),miner:fi(Qi),prevRandao:fi(sa,null),extraData:wv,baseFeePerGas:fi(en)},{prevRandao:["mixHash"]});function Tne(i){const e=Sne(i);return e.transactions=i.transactions.map(t=>typeof t=="string"?t:t6(t)),e}const wne=OE({transactionIndex:Gn,blockNumber:Gn,transactionHash:sa,address:Qi,topics:jw(sa),data:wv,index:Gn,blockHash:sa},{index:["logIndex"]});function Mne(i){return wne(i)}const Cne=OE({to:fi(Qi,null),from:fi(Qi,null),contractAddress:fi(Qi,null),index:Gn,root:fi(Xt),gasUsed:en,blobGasUsed:fi(en,null),logsBloom:fi(wv),blockHash:sa,hash:sa,logs:jw(Mne),blockNumber:Gn,cumulativeGasUsed:en,effectiveGasPrice:fi(en),blobGasPrice:fi(en,null),status:fi(Gn),type:fi(Gn,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function Rne(i){return Cne(i)}function t6(i){i.to&&en(i.to)===_k&&(i.to="0x0000000000000000000000000000000000000000");const e=OE({hash:sa,index:fi(Gn,void 0),type:t=>t==="0x"||t==null?0:Gn(t),accessList:fi(_g,null),blobVersionedHashes:fi(jw(sa,!0),null),blockHash:fi(sa,null),blockNumber:fi(Gn,null),transactionIndex:fi(Gn,null),from:Qi,gasPrice:fi(en),maxPriorityFeePerGas:fi(en),maxFeePerGas:fi(en),maxFeePerBlobGas:fi(en,null),gasLimit:en,to:fi(Qi,null),value:en,nonce:Gn,data:wv,creates:fi(Qi,null),chainId:fi(en,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(i);if(e.to==null&&e.creates==null&&(e.creates=Eee(e)),(i.type===1||i.type===2)&&i.accessList==null&&(e.accessList=[]),i.signature?e.signature=Wc.from(i.signature):e.signature=Wc.from(i),e.chainId==null){const t=e.signature.legacyChainId;t!=null&&(e.chainId=t)}return e.blockHash&&en(e.blockHash)===_k&&(e.blockHash=null),e}const Dne="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class PE{constructor(e){he(this,"name");yn(this,{name:e})}clone(){return new PE(this.name)}}class qw extends PE{constructor(t,n){t==null&&(t=0);super(`org.ethers.network.plugins.GasCost#${t||0}`);he(this,"effectiveBlock");he(this,"txBase");he(this,"txCreate");he(this,"txDataZero");he(this,"txDataNonzero");he(this,"txAccessListStorageKey");he(this,"txAccessListAddress");const s={effectiveBlock:t};function r(a,o){let l=(n||{})[a];l==null&&(l=o),Se(typeof l=="number",`invalud value for ${a}`,"costs",n),s[a]=l}r("txBase",21e3),r("txCreate",32e3),r("txDataZero",4),r("txDataNonzero",16),r("txAccessListStorageKey",1900),r("txAccessListAddress",2400),yn(this,s)}clone(){return new qw(this.effectiveBlock,this)}}class Qw extends PE{constructor(t,n){super("org.ethers.plugins.network.Ens");he(this,"address");he(this,"targetNetwork");yn(this,{address:t||Dne,targetNetwork:n??1})}clone(){return new Qw(this.address,this.targetNetwork)}}var EE,_E;class Lne extends PE{constructor(t,n){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");je(this,EE);je(this,_E);fe(this,EE,t),fe(this,_E,n)}get url(){return K(this,EE)}get processFunc(){return K(this,_E)}clone(){return this}}EE=new WeakMap,_E=new WeakMap;const hR=new Map;var nv,iv,m0;const gy=class gy{constructor(e,t){je(this,nv);je(this,iv);je(this,m0);fe(this,nv,e),fe(this,iv,en(t)),fe(this,m0,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return K(this,nv)}set name(e){fe(this,nv,e)}get chainId(){return K(this,iv)}set chainId(e){fe(this,iv,en(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===en(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===en(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===en(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(K(this,m0).values())}attachPlugin(e){if(K(this,m0).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return K(this,m0).set(e.name,e.clone()),this}getPlugin(e){return K(this,m0).get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){const e=new gy(this.name,this.chainId);return this.plugins.forEach(t=>{e.attachPlugin(t.clone())}),e}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new qw;let n=t.txBase;if(e.to==null&&(n+=t.txCreate),e.data)for(let s=2;s<e.data.length;s+=2)e.data.substring(s,s+2)==="00"?n+=t.txDataZero:n+=t.txDataNonzero;if(e.accessList){const s=_g(e.accessList);for(const r in s)n+=t.txAccessListAddress+t.txAccessListStorageKey*s[r].storageKeys.length}return n}static from(e){if(Ine(),e==null)return gy.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const t=hR.get(e);if(t)return t();if(typeof e=="bigint")return new gy("unknown",e);Se(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){Se(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const t=new gy(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&t.attachPlugin(new Qw(e.ensAddress,e.ensNetwork)),t}Se(!1,"invalid network","network",e)}static register(e,t){typeof e=="number"&&(e=BigInt(e));const n=hR.get(e);n&&Se(!1,`conflicting network for ${JSON.stringify(n.name)}`,"nameOrChainId",e),hR.set(e,t)}};nv=new WeakMap,iv=new WeakMap,m0=new WeakMap;let hh=gy;function Sk(i,e){const t=String(i);if(!t.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${i}`);const n=t.split(".");if(n.length===1&&n.push(""),n.length!==2)throw new Error(`invalid gwei value: ${i}`);for(;n[1].length<e;)n[1]+="0";if(n[1].length>9){let s=BigInt(n[1].substring(0,9));n[1].substring(9).match(/^0+$/)||s++,n[1]=s.toString()}return BigInt(n[0]+n[1])}function Tk(i){return new Lne(i,async(e,t,n)=>{n.setHeader("User-Agent","ethers");let s;try{const[r,a]=await Promise.all([n.send(),e()]);s=r;const o=s.bodyJson.standard;return{gasPrice:a.gasPrice,maxFeePerGas:Sk(o.maxFee,9),maxPriorityFeePerGas:Sk(o.maxPriorityFee,9)}}catch(r){yt(!1,`error encountered with polygon gas station (${JSON.stringify(n.url)})`,"SERVER_ERROR",{request:n,response:s,error:r})}})}let wk=!1;function Ine(){if(wk)return;wk=!0;function i(e,t,n){const s=function(){const r=new hh(e,t);return n.ensNetwork!=null&&r.attachPlugin(new Qw(null,n.ensNetwork)),r.attachPlugin(new qw),(n.plugins||[]).forEach(a=>{r.attachPlugin(a)}),r};hh.register(e,s),hh.register(t,s),n.altNames&&n.altNames.forEach(r=>{hh.register(r,s)})}i("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),i("ropsten",3,{ensNetwork:3}),i("rinkeby",4,{ensNetwork:4}),i("goerli",5,{ensNetwork:5}),i("kovan",42,{ensNetwork:42}),i("sepolia",11155111,{ensNetwork:11155111}),i("holesky",17e3,{ensNetwork:17e3}),i("classic",61,{}),i("classicKotti",6,{}),i("arbitrum",42161,{ensNetwork:1}),i("arbitrum-goerli",421613,{}),i("arbitrum-sepolia",421614,{}),i("base",8453,{ensNetwork:1}),i("base-goerli",84531,{}),i("base-sepolia",84532,{}),i("bnb",56,{ensNetwork:1}),i("bnbt",97,{}),i("linea",59144,{ensNetwork:1}),i("linea-goerli",59140,{}),i("linea-sepolia",59141,{}),i("matic",137,{ensNetwork:1,plugins:[Tk("https://gasstation.polygon.technology/v2")]}),i("matic-amoy",80002,{}),i("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[Tk("https://gasstation-testnet.polygon.technology/v2")]}),i("optimism",10,{ensNetwork:1,plugins:[]}),i("optimism-goerli",420,{}),i("optimism-sepolia",11155420,{}),i("xdai",100,{ensNetwork:1})}function LL(i){return JSON.parse(JSON.stringify(i))}var Sf,Rl,g0,Ju,sv,NT;class Bne{constructor(e){je(this,sv);je(this,Sf);je(this,Rl);je(this,g0);je(this,Ju);fe(this,Sf,e),fe(this,Rl,null),fe(this,g0,4e3),fe(this,Ju,-2)}get pollingInterval(){return K(this,g0)}set pollingInterval(e){fe(this,g0,e)}start(){K(this,Rl)||(fe(this,Rl,K(this,Sf)._setTimeout(wt(this,sv,NT).bind(this),K(this,g0))),wt(this,sv,NT).call(this))}stop(){K(this,Rl)&&(K(this,Sf)._clearTimeout(K(this,Rl)),fe(this,Rl,null))}pause(e){this.stop(),e&&fe(this,Ju,-2)}resume(){this.start()}}Sf=new WeakMap,Rl=new WeakMap,g0=new WeakMap,Ju=new WeakMap,sv=new WeakSet,NT=async function(){try{const e=await K(this,Sf).getBlockNumber();if(K(this,Ju)===-2){fe(this,Ju,e);return}if(e!==K(this,Ju)){for(let t=K(this,Ju)+1;t<=e;t++){if(K(this,Rl)==null)return;await K(this,Sf).emit("block",t)}fe(this,Ju,e)}}catch{}K(this,Rl)!=null&&fe(this,Rl,K(this,Sf)._setTimeout(wt(this,sv,NT).bind(this),K(this,g0)))};var zm,Vm,y0;class wB{constructor(e){je(this,zm);je(this,Vm);je(this,y0);fe(this,zm,e),fe(this,y0,!1),fe(this,Vm,t=>{this._poll(t,K(this,zm))})}async _poll(e,t){throw new Error("sub-classes must override this")}start(){K(this,y0)||(fe(this,y0,!0),K(this,Vm).call(this,-2),K(this,zm).on("block",K(this,Vm)))}stop(){K(this,y0)&&(fe(this,y0,!1),K(this,zm).off("block",K(this,Vm)))}pause(e){this.stop()}resume(){this.start()}}zm=new WeakMap,Vm=new WeakMap,y0=new WeakMap;var rv,Tf;class One extends wB{constructor(t,n){super(t);je(this,rv);je(this,Tf);fe(this,rv,n),fe(this,Tf,-2)}pause(t){t&&fe(this,Tf,-2),super.pause(t)}async _poll(t,n){const s=await n.getBlock(K(this,rv));s!=null&&(K(this,Tf)===-2?fe(this,Tf,s.number):s.number>K(this,Tf)&&(n.emit(K(this,rv),s.number),fe(this,Tf,s.number)))}}rv=new WeakMap,Tf=new WeakMap;var Rw;class Pne extends wB{constructor(t,n){super(t);je(this,Rw);fe(this,Rw,LL(n))}async _poll(t,n){throw new Error("@TODO")}}Rw=new WeakMap;var av;class Nne extends wB{constructor(t,n){super(t);je(this,av);fe(this,av,n)}async _poll(t,n){const s=await n.getTransactionReceipt(K(this,av));s&&n.emit(K(this,av),s)}}av=new WeakMap;var wf,ov,lv,v0,Dl,Dw,n6;class MB{constructor(e,t){je(this,Dw);je(this,wf);je(this,ov);je(this,lv);je(this,v0);je(this,Dl);fe(this,wf,e),fe(this,ov,LL(t)),fe(this,lv,wt(this,Dw,n6).bind(this)),fe(this,v0,!1),fe(this,Dl,-2)}start(){K(this,v0)||(fe(this,v0,!0),K(this,Dl)===-2&&K(this,wf).getBlockNumber().then(e=>{fe(this,Dl,e)}),K(this,wf).on("block",K(this,lv)))}stop(){K(this,v0)&&(fe(this,v0,!1),K(this,wf).off("block",K(this,lv)))}pause(e){this.stop(),e&&fe(this,Dl,-2)}resume(){this.start()}}wf=new WeakMap,ov=new WeakMap,lv=new WeakMap,v0=new WeakMap,Dl=new WeakMap,Dw=new WeakSet,n6=async function(e){if(K(this,Dl)===-2)return;const t=LL(K(this,ov));t.fromBlock=K(this,Dl)+1,t.toBlock=e;const n=await K(this,wf).getLogs(t);if(n.length===0){K(this,Dl)<e-60&&fe(this,Dl,e-60);return}for(const s of n)K(this,wf).emit(K(this,ov),s),fe(this,Dl,s.blockNumber)};const Une=BigInt(2),kne=10;function sS(i){return i&&typeof i.then=="function"}function UT(i,e){return i+":"+JSON.stringify(e,(t,n)=>{if(n==null)return"null";if(typeof n=="bigint")return`bigint:${n.toString()}`;if(typeof n=="string")return n.toLowerCase();if(typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n);return s.sort(),s.reduce((r,a)=>(r[a]=n[a],r),{})}return n})}class i6{constructor(e){he(this,"name");yn(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function Fne(i){return JSON.parse(JSON.stringify(i))}function IL(i){return i=Array.from(new Set(i).values()),i.sort(),i}async function fR(i,e){if(i==null)throw new Error("invalid event");if(Array.isArray(i)&&(i={topics:i}),typeof i=="string")switch(i){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:i,tag:i}}if(ls(i,32)){const t=i.toLowerCase();return{type:"transaction",tag:UT("tx",{hash:t}),hash:t}}if(i.orphan){const t=i;return{type:"orphan",tag:UT("orphan",t),filter:Fne(t)}}if(i.address||i.topics){const t=i,n={topics:(t.topics||[]).map(s=>s==null?null:Array.isArray(s)?IL(s.map(r=>r.toLowerCase())):s.toLowerCase())};if(t.address){const s=[],r=[],a=o=>{ls(o)?s.push(o):r.push((async()=>{s.push(await Za(o,e))})())};Array.isArray(t.address)?t.address.forEach(a):a(t.address),r.length&&await Promise.all(r),n.address=IL(s.map(o=>o.toLowerCase()))}return{filter:n,tag:UT("event",n),type:"event"}}Se(!1,"unknown ProviderEvent","event",i)}function dR(){return new Date().getTime()}const Hne={cacheTimeout:250,pollingInterval:4e3};var Ma,x0,Ca,cv,Jo,Ym,b0,Mf,SE,Ll,uv,hv,Jn,Wo,BL,OL,Qb,PL,$b,kT;class Gne{constructor(e,t){je(this,Jn);je(this,Ma);je(this,x0);je(this,Ca);je(this,cv);je(this,Jo);je(this,Ym);je(this,b0);je(this,Mf);je(this,SE);je(this,Ll);je(this,uv);je(this,hv);if(fe(this,hv,Object.assign({},Hne,t||{})),e==="any")fe(this,Ym,!0),fe(this,Jo,null);else if(e){const n=hh.from(e);fe(this,Ym,!1),fe(this,Jo,Promise.resolve(n)),setTimeout(()=>{this.emit("network",n,null)},0)}else fe(this,Ym,!1),fe(this,Jo,null);fe(this,Mf,-1),fe(this,b0,new Map),fe(this,Ma,new Map),fe(this,x0,new Map),fe(this,Ca,null),fe(this,cv,!1),fe(this,SE,1),fe(this,Ll,new Map),fe(this,uv,!1)}get pollingInterval(){return K(this,hv).pollingInterval}get provider(){return this}get plugins(){return Array.from(K(this,x0).values())}attachPlugin(e){if(K(this,x0).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return K(this,x0).set(e.name,e.connect(this)),this}getPlugin(e){return K(this,x0).get(e)||null}get disableCcipRead(){return K(this,uv)}set disableCcipRead(e){fe(this,uv,!!e)}async ccipReadFetch(e,t,n){if(this.disableCcipRead||n.length===0||e.to==null)return null;const s=e.to.toLowerCase(),r=t.toLowerCase(),a=[];for(let o=0;o<n.length;o++){const l=n[o],c=l.replace("{sender}",s).replace("{data}",r),h=new O0(c);l.indexOf("{data}")===-1&&(h.body={data:r,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:h,index:o,urls:n});let d="unknown error",m;try{m=await h.send()}catch(y){a.push(y.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:h,result:{error:y}});continue}try{const y=m.bodyJson;if(y.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:h,result:y}),y.data;y.message&&(d=y.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:h,result:y})}catch{}yt(m.statusCode<400||m.statusCode>=500,`response not found during CCIP fetch: ${d}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:l,errorMessage:d}}),a.push(d)}yt(!1,`error encountered during CCIP fetch: ${a.map(o=>JSON.stringify(o)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:n,errorMessages:a}})}_wrapBlock(e,t){return new ane(Tne(e),this)}_wrapLog(e,t){return new BE(_ne(e),this)}_wrapTransactionReceipt(e,t){return new zz(Rne(e),this)}_wrapTransactionResponse(e,t){return new jA(t6(e),this)}_detectNetwork(){yt(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){yt(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=Gn(await wt(this,Jn,Wo).call(this,{method:"getBlockNumber"}),"%response");return K(this,Mf)>=0&&fe(this,Mf,e),e}_getAddress(e){return Za(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(ls(e))return ls(e,32)?e:uy(e);if(typeof e=="bigint"&&(e=Gn(e,"blockTag")),typeof e=="number")return e>=0?uy(e):K(this,Mf)>=0?uy(K(this,Mf)+e):this.getBlockNumber().then(t=>uy(t+e));Se(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const t=(e.topics||[]).map(l=>l==null?null:Array.isArray(l)?IL(l.map(c=>c.toLowerCase())):l.toLowerCase()),n="blockHash"in e?e.blockHash:void 0,s=(l,c,h)=>{let d;switch(l.length){case 0:break;case 1:d=l[0];break;default:l.sort(),d=l}if(n&&(c!=null||h!=null))throw new Error("invalid filter");const m={};return d&&(m.address=d),t.length&&(m.topics=t),c&&(m.fromBlock=c),h&&(m.toBlock=h),n&&(m.blockHash=n),m};let r=[];if(e.address)if(Array.isArray(e.address))for(const l of e.address)r.push(this._getAddress(l));else r.push(this._getAddress(e.address));let a;"fromBlock"in e&&(a=this._getBlockTag(e.fromBlock));let o;return"toBlock"in e&&(o=this._getBlockTag(e.toBlock)),r.filter(l=>typeof l!="string").length||a!=null&&typeof a!="string"||o!=null&&typeof o!="string"?Promise.all([Promise.all(r),a,o]).then(l=>s(l[0],l[1],l[2])):s(r,a,o)}_getTransactionRequest(e){const t=x3(e),n=[];if(["to","from"].forEach(s=>{if(t[s]==null)return;const r=Za(t[s],this);sS(r)?n.push(async function(){t[s]=await r}()):t[s]=r}),t.blockTag!=null){const s=this._getBlockTag(t.blockTag);sS(s)?n.push(async function(){t.blockTag=await s}()):t.blockTag=s}return n.length?async function(){return await Promise.all(n),t}():t}async getNetwork(){if(K(this,Jo)==null){const s=(async()=>{try{const r=await this._detectNetwork();return this.emit("network",r,null),r}catch(r){throw K(this,Jo)===s&&fe(this,Jo,null),r}})();return fe(this,Jo,s),(await s).clone()}const e=K(this,Jo),[t,n]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==n.chainId&&(K(this,Ym)?(this.emit("network",n,t),K(this,Jo)===e&&fe(this,Jo,Promise.resolve(n))):yt(!1,`network changed: ${t.chainId} => ${n.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:s,gasPrice:r,priorityFee:a}=await Xa({_block:wt(this,Jn,PL).call(this,"latest",!1),gasPrice:(async()=>{try{const h=await wt(this,Jn,Wo).call(this,{method:"getGasPrice"});return en(h,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const h=await wt(this,Jn,Wo).call(this,{method:"getPriorityFee"});return en(h,"%response")}catch{}return null})()});let o=null,l=null;const c=this._wrapBlock(s,e);return c&&c.baseFeePerGas&&(l=a??BigInt("1000000000"),o=c.baseFeePerGas*Une+l),new xk(r,o,l)},n=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(n){const s=new O0(n.url),r=await n.processFunc(t,this,s);return new xk(r.gasPrice,r.maxFeePerGas,r.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return sS(t)&&(t=await t),en(await wt(this,Jn,Wo).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:n}=await Xa({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await wt(this,Jn,OL).call(this,wt(this,Jn,BL).call(this,t,n,e.enableCcipRead?0:-1))}async getBalance(e,t){return en(await wt(this,Jn,Qb).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return Gn(await wt(this,Jn,Qb).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return Xt(await wt(this,Jn,Qb).call(this,{method:"getCode"},e,t))}async getStorage(e,t,n){const s=en(t,"position");return Xt(await wt(this,Jn,Qb).call(this,{method:"getStorage",position:s},e,n))}async broadcastTransaction(e){const{blockNumber:t,hash:n,network:s}=await Xa({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),r=y3.from(e);if(r.hash!==n)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(r,s).replaceableTransaction(t)}async getBlock(e,t){const{network:n,params:s}=await Xa({network:this.getNetwork(),params:wt(this,Jn,PL).call(this,e,!!t)});return s==null?null:this._wrapBlock(s,n)}async getTransaction(e){const{network:t,params:n}=await Xa({network:this.getNetwork(),params:wt(this,Jn,Wo).call(this,{method:"getTransaction",hash:e})});return n==null?null:this._wrapTransactionResponse(n,t)}async getTransactionReceipt(e){const{network:t,params:n}=await Xa({network:this.getNetwork(),params:wt(this,Jn,Wo).call(this,{method:"getTransactionReceipt",hash:e})});if(n==null)return null;if(n.gasPrice==null&&n.effectiveGasPrice==null){const s=await wt(this,Jn,Wo).call(this,{method:"getTransaction",hash:e});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");n.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(n,t)}async getTransactionResult(e){const{result:t}=await Xa({network:this.getNetwork(),result:wt(this,Jn,Wo).call(this,{method:"getTransactionResult",hash:e})});return t==null?null:Xt(t)}async getLogs(e){let t=this._getFilter(e);sS(t)&&(t=await t);const{network:n,params:s}=await Xa({network:this.getNetwork(),params:wt(this,Jn,Wo).call(this,{method:"getLogs",filter:t})});return s.map(r=>this._wrapLog(r,n))}_getProvider(e){yt(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await A3.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){e=Qi(e);const t=TL(e.substring(2).toLowerCase()+".addr.reverse");try{const n=await A3.getEnsAddress(this),r=await new Sy(n,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(r==null||r===HA)return null;const o=await new Sy(r,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(o)!==e?null:o}catch(n){if(ra(n,"BAD_DATA")&&n.value==="0x"||ra(n,"CALL_EXCEPTION"))return null;throw n}return null}async waitForTransaction(e,t,n){const s=t??1;return s===0?this.getTransactionReceipt(e):new Promise(async(r,a)=>{let o=null;const l=async c=>{try{const h=await this.getTransactionReceipt(e);if(h!=null&&c-h.blockNumber+1>=s){r(h),o&&(clearTimeout(o),o=null);return}}catch(h){console.log("EEE",h)}this.once("block",l)};n!=null&&(o=setTimeout(()=>{o!=null&&(o=null,this.off("block",l),a(Ys("timeout","TIMEOUT",{reason:"timeout"})))},n)),l(await this.getBlockNumber())})}async waitForBlock(e){yt(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=K(this,Ll).get(e);t&&(t.timer&&clearTimeout(t.timer),K(this,Ll).delete(e))}_setTimeout(e,t){t==null&&(t=0);const n=fb(this,SE)._++,s=()=>{K(this,Ll).delete(n),e()};if(this.paused)K(this,Ll).set(n,{timer:null,func:s,time:t});else{const r=setTimeout(s,t);K(this,Ll).set(n,{timer:r,func:s,time:dR()})}return n}_forEachSubscriber(e){for(const t of K(this,Ma).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new i6(e.type);case"block":{const t=new Bne(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new One(this,e.type);case"event":return new MB(this,e.filter);case"transaction":return new Nne(this,e.hash);case"orphan":return new Pne(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const n of K(this,Ma).values())if(n.subscriber===e){n.started&&n.subscriber.stop(),n.subscriber=t,n.started&&t.start(),K(this,Ca)!=null&&t.pause(K(this,Ca));break}}async on(e,t){const n=await wt(this,Jn,kT).call(this,e);return n.listeners.push({listener:t,once:!1}),n.started||(n.subscriber.start(),n.started=!0,K(this,Ca)!=null&&n.subscriber.pause(K(this,Ca))),this}async once(e,t){const n=await wt(this,Jn,kT).call(this,e);return n.listeners.push({listener:t,once:!0}),n.started||(n.subscriber.start(),n.started=!0,K(this,Ca)!=null&&n.subscriber.pause(K(this,Ca))),this}async emit(e,...t){const n=await wt(this,Jn,$b).call(this,e,t);if(!n||n.listeners.length===0)return!1;const s=n.listeners.length;return n.listeners=n.listeners.filter(({listener:r,once:a})=>{const o=new mG(this,a?null:r,e);try{r.call(this,...t,o)}catch{}return!a}),n.listeners.length===0&&(n.started&&n.subscriber.stop(),K(this,Ma).delete(n.tag)),s>0}async listenerCount(e){if(e){const n=await wt(this,Jn,$b).call(this,e);return n?n.listeners.length:0}let t=0;for(const{listeners:n}of K(this,Ma).values())t+=n.length;return t}async listeners(e){if(e){const n=await wt(this,Jn,$b).call(this,e);return n?n.listeners.map(({listener:s})=>s):[]}let t=[];for(const{listeners:n}of K(this,Ma).values())t=t.concat(n.map(({listener:s})=>s));return t}async off(e,t){const n=await wt(this,Jn,$b).call(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:r})=>r).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(!t||n.listeners.length===0)&&(n.started&&n.subscriber.stop(),K(this,Ma).delete(n.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:n,subscriber:s}=await wt(this,Jn,kT).call(this,e);n&&s.stop(),K(this,Ma).delete(t)}else for(const[t,{started:n,subscriber:s}]of K(this,Ma))n&&s.stop(),K(this,Ma).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return K(this,cv)}destroy(){this.removeAllListeners();for(const e of K(this,Ll).keys())this._clearTimeout(e);fe(this,cv,!0)}get paused(){return K(this,Ca)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(fe(this,Mf,-1),K(this,Ca)!=null){if(K(this,Ca)==!!e)return;yt(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),fe(this,Ca,!!e);for(const t of K(this,Ll).values())t.timer&&clearTimeout(t.timer),t.time=dR()-t.time}resume(){if(K(this,Ca)!=null){this._forEachSubscriber(e=>e.resume()),fe(this,Ca,null);for(const e of K(this,Ll).values()){let t=e.time;t<0&&(t=0),e.time=dR(),setTimeout(e.func,t)}}}}Ma=new WeakMap,x0=new WeakMap,Ca=new WeakMap,cv=new WeakMap,Jo=new WeakMap,Ym=new WeakMap,b0=new WeakMap,Mf=new WeakMap,SE=new WeakMap,Ll=new WeakMap,uv=new WeakMap,hv=new WeakMap,Jn=new WeakSet,Wo=async function(e){const t=K(this,hv).cacheTimeout;if(t<0)return await this._perform(e);const n=UT(e.method,e);let s=K(this,b0).get(n);return s||(s=this._perform(e),K(this,b0).set(n,s),setTimeout(()=>{K(this,b0).get(n)===s&&K(this,b0).delete(n)},t)),await s},BL=async function(e,t,n){yt(n<kne,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const s=x3(e);try{return Xt(await this._perform({method:"call",transaction:s,blockTag:t}))}catch(r){if(!this.disableCcipRead&&oB(r)&&r.data&&n>=0&&t==="latest"&&s.to!=null&&Ks(r.data,0,4)==="0x556f1830"){const a=r.data,o=await Za(s.to,this);let l;try{l=Wne(Ks(r.data,4))}catch(d){yt(!1,d.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:a}})}yt(l.sender.toLowerCase()===o.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:a,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:l.errorArgs}});const c=await this.ccipReadFetch(s,l.calldata,l.urls);yt(c!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:r.data,errorArgs:l.errorArgs}});const h={to:o,data:cr([l.selector,Kne([c,l.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:h});try{const d=await wt(this,Jn,BL).call(this,h,t,n+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},h),result:d}),d}catch(d){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},h),error:d}),d}}throw r}},OL=async function(e){const{value:t}=await Xa({network:this.getNetwork(),value:e});return t},Qb=async function(e,t,n){let s=this._getAddress(t),r=this._getBlockTag(n);return(typeof s!="string"||typeof r!="string")&&([s,r]=await Promise.all([s,r])),await wt(this,Jn,OL).call(this,wt(this,Jn,Wo).call(this,Object.assign(e,{address:s,blockTag:r})))},PL=async function(e,t){if(ls(e,32))return await wt(this,Jn,Wo).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let n=this._getBlockTag(e);return typeof n!="string"&&(n=await n),await wt(this,Jn,Wo).call(this,{method:"getBlock",blockTag:n,includeTransactions:t})},$b=async function(e,t){let n=await fR(e,this);return n.type==="event"&&t&&t.length>0&&t[0].removed===!0&&(n=await fR({orphan:"drop-log",log:t[0]},this)),K(this,Ma).get(n.tag)||null},kT=async function(e){const t=await fR(e,this),n=t.tag;let s=K(this,Ma).get(n);return s||(s={subscriber:this._getSubscriber(t),tag:n,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},K(this,Ma).set(n,s)),s};function zne(i,e){try{const t=NL(i,e);if(t)return c3(t)}catch{}return null}function NL(i,e){if(i==="0x")return null;try{const t=Gn(Ks(i,e,e+32)),n=Gn(Ks(i,t,t+32));return Ks(i,t+32,t+32+n)}catch{}return null}function Mk(i){const e=$a(i);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function Vne(i){if(i.length%32===0)return i;const e=new Uint8Array(Math.ceil(i.length/32)*32);return e.set(i),e}const Yne=new Uint8Array([]);function Kne(i){const e=[];let t=0;for(let n=0;n<i.length;n++)e.push(Yne),t+=32;for(let n=0;n<i.length;n++){const s=mi(i[n]);e[n]=Mk(t),e.push(Mk(s.length)),e.push(Vne(s)),t+=32+Math.ceil(s.length/32)*32}return cr(e)}const Ck="0x0000000000000000000000000000000000000000000000000000000000000000";function Wne(i){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};yt(by(i)>=5*32,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const t=Ks(i,0,32);yt(Ks(t,0,12)===Ks(Ck,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=Ks(t,12);try{const n=[],s=Gn(Ks(i,32,64)),r=Gn(Ks(i,s,s+32)),a=Ks(i,s+32);for(let o=0;o<r;o++){const l=zne(a,o*32);if(l==null)throw new Error("abort");n.push(l)}e.urls=n}catch{yt(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const n=NL(i,64);if(n==null)throw new Error("abort");e.calldata=n}catch{yt(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}yt(Ks(i,100,128)===Ks(Ck,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=Ks(i,96,100);try{const n=NL(i,128);if(n==null)throw new Error("abort");e.extraData=n}catch{yt(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(n=>e[n]),e}function I2(i,e){if(i.provider)return i.provider;yt(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function Rk(i,e){let t=x3(e);if(t.to!=null&&(t.to=Za(t.to,i)),t.from!=null){const n=t.from;t.from=Promise.all([i.getAddress(),Za(n,i)]).then(([s,r])=>(Se(s.toLowerCase()===r.toLowerCase(),"transaction from mismatch","tx.from",r),s))}else t.from=i.getAddress();return await Xa(t)}class Xne{constructor(e){he(this,"provider");yn(this,{provider:e||null})}async getNonce(e){return I2(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await Rk(this,e)}async populateTransaction(e){const t=I2(this,"populateTransaction"),n=await Rk(this,e);n.nonce==null&&(n.nonce=await this.getNonce("pending")),n.gasLimit==null&&(n.gasLimit=await this.estimateGas(n));const s=await this.provider.getNetwork();if(n.chainId!=null){const a=en(n.chainId);Se(a===s.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else n.chainId=s.chainId;const r=n.maxFeePerGas!=null||n.maxPriorityFeePerGas!=null;if(n.gasPrice!=null&&(n.type===2||r)?Se(!1,"eip-1559 transaction do not support gasPrice","tx",e):(n.type===0||n.type===1)&&r&&Se(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(n.type===2||n.type==null)&&n.maxFeePerGas!=null&&n.maxPriorityFeePerGas!=null)n.type=2;else if(n.type===0||n.type===1){const a=await t.getFeeData();yt(a.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),n.gasPrice==null&&(n.gasPrice=a.gasPrice)}else{const a=await t.getFeeData();if(n.type==null)if(a.maxFeePerGas!=null&&a.maxPriorityFeePerGas!=null)if(n.type=2,n.gasPrice!=null){const o=n.gasPrice;delete n.gasPrice,n.maxFeePerGas=o,n.maxPriorityFeePerGas=o}else n.maxFeePerGas==null&&(n.maxFeePerGas=a.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=a.maxPriorityFeePerGas);else a.gasPrice!=null?(yt(!r,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),n.gasPrice==null&&(n.gasPrice=a.gasPrice),n.type=0):yt(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(n.type===2||n.type===3)&&(n.maxFeePerGas==null&&(n.maxFeePerGas=a.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=a.maxPriorityFeePerGas))}return await Xa(n)}async estimateGas(e){return I2(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return I2(this,"call").call(await this.populateCall(e))}async resolveName(e){return await I2(this,"resolveName").resolveName(e)}async sendTransaction(e){const t=I2(this,"sendTransaction"),n=await this.populateTransaction(e);delete n.from;const s=y3.from(n);return await t.broadcastTransaction(await this.signTransaction(s))}}function jne(i){return JSON.parse(JSON.stringify(i))}var Wa,Zu,Km,A0,Wm,fv,G0,UL,kL;class s6{constructor(e){je(this,G0);je(this,Wa);je(this,Zu);je(this,Km);je(this,A0);je(this,Wm);je(this,fv);fe(this,Wa,e),fe(this,Zu,null),fe(this,Km,wt(this,G0,UL).bind(this)),fe(this,A0,!1),fe(this,Wm,null),fe(this,fv,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){K(this,A0)||(fe(this,A0,!0),wt(this,G0,UL).call(this,-2))}stop(){K(this,A0)&&(fe(this,A0,!1),fe(this,fv,!0),wt(this,G0,kL).call(this),K(this,Wa).off("block",K(this,Km)))}pause(e){e&&wt(this,G0,kL).call(this),K(this,Wa).off("block",K(this,Km))}resume(){this.start()}}Wa=new WeakMap,Zu=new WeakMap,Km=new WeakMap,A0=new WeakMap,Wm=new WeakMap,fv=new WeakMap,G0=new WeakSet,UL=async function(e){try{K(this,Zu)==null&&fe(this,Zu,this._subscribe(K(this,Wa)));let t=null;try{t=await K(this,Zu)}catch(r){if(!ra(r,"UNSUPPORTED_OPERATION")||r.operation!=="eth_newFilter")throw r}if(t==null){fe(this,Zu,null),K(this,Wa)._recoverSubscriber(this,this._recover(K(this,Wa)));return}const n=await K(this,Wa).getNetwork();if(K(this,Wm)||fe(this,Wm,n),K(this,Wm).chainId!==n.chainId)throw new Error("chaid changed");if(K(this,fv))return;const s=await K(this,Wa).send("eth_getFilterChanges",[t]);await this._emitResults(K(this,Wa),s)}catch(t){console.log("@TODO",t)}K(this,Wa).once("block",K(this,Km))},kL=function(){const e=K(this,Zu);e&&(fe(this,Zu,null),e.then(t=>{K(this,Wa).destroyed||K(this,Wa).send("eth_uninstallFilter",[t])}))};var Xm;class qne extends s6{constructor(t,n){super(t);je(this,Xm);fe(this,Xm,jne(n))}_recover(t){return new MB(t,K(this,Xm))}async _subscribe(t){return await t.send("eth_newFilter",[K(this,Xm)])}async _emitResults(t,n){for(const s of n)t.emit(K(this,Xm),t._wrapLog(s,t._network))}}Xm=new WeakMap;class Qne extends s6{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const n of t)e.emit("pending",n)}}const $ne="bigint,boolean,function,number,string,symbol".split(/,/g);function FT(i){if(i==null||$ne.indexOf(typeof i)>=0||typeof i.getAddress=="function")return i;if(Array.isArray(i))return i.map(FT);if(typeof i=="object")return Object.keys(i).reduce((e,t)=>(e[t]=i[t],e),{});throw new Error(`should not happen: ${i} (${typeof i})`)}function Jne(i){return new Promise(e=>{setTimeout(e,i)})}function B2(i){return i&&i.toLowerCase()}function Dk(i){return i&&typeof i.pollingInterval=="number"}const r6={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class pR extends Xne{constructor(t,n){super(t);he(this,"address");n=Qi(n),yn(this,{address:n})}connect(t){yt(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const n=FT(t),s=[];if(n.from){const a=n.from;s.push((async()=>{const o=await Za(a,this.provider);Se(o!=null&&o.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=o})())}else n.from=this.address;if(n.gasLimit==null&&s.push((async()=>{n.gasLimit=await this.provider.estimateGas({...n,from:this.address})})()),n.to!=null){const a=n.to;s.push((async()=>{n.to=await Za(a,this.provider)})())}s.length&&await Promise.all(s);const r=this.provider.getRpcTransaction(n);return this.provider.send("eth_sendTransaction",[r])}async sendTransaction(t){const n=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(t);return await new Promise((r,a)=>{const o=[1e3,100];let l=0;const c=async()=>{try{const h=await this.provider.getTransaction(s);if(h!=null){r(h.replaceableTransaction(n));return}}catch(h){if(ra(h,"CANCELLED")||ra(h,"BAD_DATA")||ra(h,"NETWORK_ERROR")||ra(h,"UNSUPPORTED_OPERATION")){h.info==null&&(h.info={}),h.info.sendTransactionHash=s,a(h);return}if(ra(h,"INVALID_ARGUMENT")&&(l++,h.info==null&&(h.info={}),h.info.sendTransactionHash=s,l>10)){a(h);return}this.provider.emit("error",Ys("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:h}))}this.provider._setTimeout(()=>{c()},o.pop()||4e3)};c()})}async signTransaction(t){const n=FT(t);if(n.from){const r=await Za(n.from,this.provider);Se(r!=null&&r.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=r}else n.from=this.address;const s=this.provider.getRpcTransaction(n);return await this.provider.send("eth_signTransaction",[s])}async signMessage(t){const n=typeof t=="string"?Uf(t):t;return await this.provider.send("personal_sign",[Xt(n),this.address.toLowerCase()])}async signTypedData(t,n,s){const r=FT(s),a=await v3.resolveNames(t,n,r,async o=>{const l=await Za(o);return Se(l!=null,"TypedData does not support null address","value",o),l});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(v3.getPayload(a.domain,n,a.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const n=typeof t=="string"?Uf(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),Xt(n)])}}var jm,dv,Cf,eh,Nc,Il,Eo,TE,FL;class Zne extends Gne{constructor(t,n){super(t,n);je(this,TE);je(this,jm);je(this,dv);je(this,Cf);je(this,eh);je(this,Nc);je(this,Il);je(this,Eo);fe(this,dv,1),fe(this,jm,Object.assign({},r6,n||{})),fe(this,Cf,[]),fe(this,eh,null),fe(this,Il,null),fe(this,Eo,null);{let r=null;const a=new Promise(o=>{r=o});fe(this,Nc,{promise:a,resolve:r})}const s=this._getOption("staticNetwork");typeof s=="boolean"?(Se(!s||t!=="any","staticNetwork cannot be used on special network 'any'","options",n),s&&t!=null&&fe(this,Il,hh.from(t))):s&&(Se(t==null||s.matches(t),"staticNetwork MUST match network object","options",n),fe(this,Il,s))}_getOption(t){return K(this,jm)[t]}get _network(){return yt(K(this,Il),"network is not available yet","NETWORK_ERROR"),K(this,Il)}async _perform(t){if(t.method==="call"||t.method==="estimateGas"){let s=t.transaction;if(s&&s.type!=null&&en(s.type)&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const r=await this.getFeeData();r.maxFeePerGas==null&&r.maxPriorityFeePerGas==null&&(t=Object.assign({},t,{transaction:Object.assign({},s,{type:void 0})}))}}const n=this.getRpcRequest(t);return n!=null?await this.send(n.method,n.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t)if(t===!0){if(K(this,Il))return K(this,Il)}else return t;return K(this,Eo)?await K(this,Eo):this.ready?(fe(this,Eo,(async()=>{try{const n=hh.from(en(await this.send("eth_chainId",[])));return fe(this,Eo,null),n}catch(n){throw fe(this,Eo,null),n}})()),await K(this,Eo)):(fe(this,Eo,(async()=>{const n={id:fb(this,dv)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:n});let s;try{s=(await this._send(n))[0],fe(this,Eo,null)}catch(r){throw fe(this,Eo,null),this.emit("debug",{action:"receiveRpcError",error:r}),r}if(this.emit("debug",{action:"receiveRpcResult",result:s}),"result"in s)return hh.from(en(s.result));throw this.getRpcError(n,s)})()),await K(this,Eo))}_start(){K(this,Nc)==null||K(this,Nc).resolve==null||(K(this,Nc).resolve(),fe(this,Nc,null),(async()=>{for(;K(this,Il)==null&&!this.destroyed;)try{fe(this,Il,await this._detectNetwork())}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",Ys("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await Jne(1e3)}wt(this,TE,FL).call(this)})())}async _waitUntilReady(){if(K(this,Nc)!=null)return await K(this,Nc).promise}_getSubscriber(t){return t.type==="pending"?new Qne(this):t.type==="event"?this._getOption("polling")?new MB(this,t.filter):new qne(this,t.filter):t.type==="orphan"&&t.filter.orphan==="drop-log"?new i6("orphan"):super._getSubscriber(t)}get ready(){return K(this,Nc)==null}getRpcTransaction(t){const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(s=>{if(t[s]==null)return;let r=s;s==="gasLimit"&&(r="gas"),n[r]=uy(en(t[s],`tx.${s}`))}),["from","to","data"].forEach(s=>{t[s]!=null&&(n[s]=Xt(t[s]))}),t.accessList&&(n.accessList=_g(t.accessList)),t.blobVersionedHashes&&(n.blobVersionedHashes=t.blobVersionedHashes.map(s=>s.toLowerCase())),n}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[B2(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[B2(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[B2(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[B2(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&t.filter.address!=null&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(B2):t.filter.address=B2(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,n){const{method:s}=t,{error:r}=n;if(s==="eth_estimateGas"&&r.message){const l=r.message;if(!l.match(/revert/i)&&l.match(/insufficient funds/i))return Ys("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:r}})}if(s==="eth_call"||s==="eth_estimateGas"){const l=HL(r),c=XA.getBuiltinCallException(s==="eth_call"?"call":"estimateGas",t.params[0],l?l.data:null);return c.info={error:r,payload:t},c}const a=JSON.stringify(tie(r));if(typeof r.message=="string"&&r.message.match(/user denied|ethers-user-denied/i))return Ys("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:t,error:r}});if(s==="eth_sendRawTransaction"||s==="eth_sendTransaction"){const l=t.params[0];if(a.match(/insufficient funds|base fee exceeds gas limit/i))return Ys("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:l,info:{error:r}});if(a.match(/nonce/i)&&a.match(/too low/i))return Ys("nonce has already been used","NONCE_EXPIRED",{transaction:l,info:{error:r}});if(a.match(/replacement transaction/i)&&a.match(/underpriced/i))return Ys("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:l,info:{error:r}});if(a.match(/only replay-protected/i))return Ys("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:l,info:{error:r}}})}let o=!!a.match(/the method .* does not exist/i);return o||r&&r.details&&r.details.startsWith("Unauthorized method:")&&(o=!0),o?Ys("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:r,payload:t}}):Ys("could not coalesce error","UNKNOWN_ERROR",{error:r,payload:t})}send(t,n){if(this.destroyed)return Promise.reject(Ys("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const s=fb(this,dv)._++,r=new Promise((a,o)=>{K(this,Cf).push({resolve:a,reject:o,payload:{method:t,params:n,id:s,jsonrpc:"2.0"}})});return wt(this,TE,FL).call(this),r}async getSigner(t){t==null&&(t=0);const n=this.send("eth_accounts",[]);if(typeof t=="number"){const r=await n;if(t>=r.length)throw new Error("no such account");return new pR(this,r[t])}const{accounts:s}=await Xa({network:this.getNetwork(),accounts:n});t=Qi(t);for(const r of s)if(Qi(r)===t)return new pR(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(n=>new pR(this,n))}destroy(){K(this,eh)&&(clearTimeout(K(this,eh)),fe(this,eh,null));for(const{payload:t,reject:n}of K(this,Cf))n(Ys("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));fe(this,Cf,[]),super.destroy()}}jm=new WeakMap,dv=new WeakMap,Cf=new WeakMap,eh=new WeakMap,Nc=new WeakMap,Il=new WeakMap,Eo=new WeakMap,TE=new WeakSet,FL=function(){if(K(this,eh))return;const t=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");fe(this,eh,setTimeout(()=>{fe(this,eh,null);const n=K(this,Cf);for(fe(this,Cf,[]);n.length;){const s=[n.shift()];for(;n.length&&s.length!==K(this,jm).batchMaxCount;)if(s.push(n.shift()),JSON.stringify(s.map(a=>a.payload)).length>K(this,jm).batchMaxSize){n.unshift(s.pop());break}(async()=>{const r=s.length===1?s[0].payload:s.map(a=>a.payload);this.emit("debug",{action:"sendRpcPayload",payload:r});try{const a=await this._send(r);this.emit("debug",{action:"receiveRpcResult",result:a});for(const{resolve:o,reject:l,payload:c}of s){if(this.destroyed){l(Ys("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:c.method}));continue}const h=a.filter(d=>d.id===c.id)[0];if(h==null){const d=Ys("missing response for request","BAD_DATA",{value:a,info:{payload:c}});this.emit("error",d),l(d);continue}if("error"in h){l(this.getRpcError(c,h));continue}o(h.result)}}catch(a){this.emit("debug",{action:"receiveRpcError",error:a});for(const{reject:o}of s)o(a)}})()}},t))};var E0;class eie extends Zne{constructor(t,n){super(t,n);je(this,E0);let s=this._getOption("pollingInterval");s==null&&(s=r6.pollingInterval),fe(this,E0,s)}_getSubscriber(t){const n=super._getSubscriber(t);return Dk(n)&&(n.pollingInterval=K(this,E0)),n}get pollingInterval(){return K(this,E0)}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");fe(this,E0,t),this._forEachSubscriber(n=>{Dk(n)&&(n.pollingInterval=K(this,E0))})}}E0=new WeakMap;function HL(i){if(i==null)return null;if(typeof i.message=="string"&&i.message.match(/revert/i)&&ls(i.data))return{message:i.message,data:i.data};if(typeof i=="object"){for(const e in i){const t=HL(i[e]);if(t)return t}return null}if(typeof i=="string")try{return HL(JSON.parse(i))}catch{}return null}function GL(i,e){if(i!=null){if(typeof i.message=="string"&&e.push(i.message),typeof i=="object")for(const t in i)GL(i[t],e);if(typeof i=="string")try{return GL(JSON.parse(i),e)}catch{}}}function tie(i){const e=[];return GL(i,e),e}var pv;class a6 extends eie{constructor(t,n,s){const r=Object.assign({},s??{},{batchMaxCount:1});Se(t&&t.request,"invalid EIP-1193 provider","ethereum",t);super(n,r);je(this,pv);fe(this,pv,async(a,o)=>{const l={method:a,params:o};this.emit("debug",{action:"sendEip1193Request",payload:l});try{const c=await t.request(l);return this.emit("debug",{action:"receiveEip1193Result",result:c}),c}catch(c){const h=new Error(c.message);throw h.code=c.code,h.data=c.data,h.payload=l,this.emit("debug",{action:"receiveEip1193Error",error:h}),h}})}async send(t,n){return await this._start(),await super.send(t,n)}async _send(t){Se(!Array.isArray(t),"EIP-1193 does not support batch request","payload",t);try{const n=await K(this,pv).call(this,t.method,t.params||[]);return[{id:t.id,result:n}]}catch(n){return[{id:t.id,error:{code:n.code,data:n.data,message:n.message}}]}}getRpcError(t,n){switch(n=JSON.parse(JSON.stringify(n)),n.error.code||-1){case 4001:n.error.message=`ethers-user-denied: ${n.error.message}`;break;case 4200:n.error.message=`ethers-unsupported: ${n.error.message}`;break}return super.getRpcError(t,n)}async hasSigner(t){t==null&&(t=0);const n=await this.send("eth_accounts",[]);return typeof t=="number"?n.length>t:(t=t.toLowerCase(),n.filter(s=>s.toLowerCase()===t).length!==0)}async getSigner(t){if(t==null&&(t=0),!await this.hasSigner(t))try{await K(this,pv).call(this,"eth_requestAccounts",[])}catch(n){const s=n.payload;throw this.getRpcError(s,{id:s.id,error:n})}return await super.getSigner(t)}}pv=new WeakMap;const nie=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"score",type:"uint8"}],name:"DealerScore",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"label",type:"string"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"DebugUint",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"label",type:"string"},{indexed:!1,internalType:"uint8[]",name:"values",type:"uint8[]"}],name:"DebugUintArray",type:"event"},{inputs:[{internalType:"uint256",name:"gameId",type:"uint256"},{internalType:"bytes32",name:"seed",type:"bytes32"},{internalType:"uint8[]",name:"revealedCards",type:"uint8[]"},{internalType:"uint8",name:"playerCardCount",type:"uint8"}],name:"endGame",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"gameId",type:"uint256"},{indexed:!0,internalType:"address",name:"player",type:"address"},{indexed:!1,internalType:"uint256",name:"bet",type:"uint256"},{indexed:!1,internalType:"bytes32",name:"deckHash",type:"bytes32"}],name:"GameCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"gameId",type:"uint256"},{indexed:!1,internalType:"bool",name:"playerWon",type:"bool"},{indexed:!1,internalType:"string",name:"message",type:"string"}],name:"GameEnded",type:"event"},{inputs:[{internalType:"bytes32",name:"deckHash",type:"bytes32"}],name:"newGame",outputs:[],stateMutability:"payable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"score",type:"uint8"}],name:"PlayerScore",type:"event"},{inputs:[{internalType:"address payable",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Withdraw",type:"event"},{stateMutability:"payable",type:"receive"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"games",outputs:[{internalType:"address",name:"player",type:"address"},{internalType:"uint256",name:"bet",type:"uint256"},{internalType:"bytes32",name:"deckHash",type:"bytes32"},{internalType:"bool",name:"isActive",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_gameId",type:"uint256"}],name:"getGameInfo",outputs:[{internalType:"address",name:"player",type:"address"},{internalType:"uint256",name:"bet",type:"uint256"},{internalType:"bytes32",name:"deckSeed",type:"bytes32"},{internalType:"bool",name:"isActive",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextGameId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"seed",type:"bytes32"}],name:"testShuffle",outputs:[{internalType:"uint8[52]",name:"",type:"uint8[52]"}],stateMutability:"pure",type:"function"}],iie="0xb957db5e482cd63d2e42244594eec09bea22fa0c",Lk=async()=>{if(!window.ethereum)throw new Error("請安裝 MetaMask");const e=await new a6(window.ethereum).getSigner();return new Sy(iie,nie,e)},sie=(i,e,t,n)=>{const[s,r]=ce.useState({canHit:!1,canStand:!1,canDouble:!1,canSplit:!1,canSurrender:!1,canInsurance:!1});return ce.useEffect(()=>{if(!t){r({canHit:!1,canStand:!1,canDouble:!1,canSplit:!1,canSurrender:!1,canInsurance:!1});return}if(n){r(()=>({canHit:!1,canStand:!1,canDouble:!1,canSplit:!1,canSurrender:!1,canInsurance:!1}));return}const a=rie(i),o=typeof a=="string"&&a.includes("Bust"),l=i.length===2&&a==="21! Blackjack!";r({canHit:!o&&!l,canStand:!o&&t,canDouble:i.length===2&&!o,canSplit:i.length===2&&aie(i),canSurrender:i.length===2,canInsurance:e.length>0&&oie(e[1])&&i.length===2})},[i,e,t,n]),s};function rie(i){let e=0,t=0;for(const s of i){const r=s%13+1;r===1?(t++,e+=11):r>=10?e+=10:e+=r}let n=e;for(;n>21&&t>0;)n-=10,t--;return n>21?`${n} Bust🧨`:n===21&&i.length===2?"21! Blackjack!":n}function aie(i){const e=i[0]%13+1,t=i[1]%13+1;return i.length===2&&e===t}function oie(i){return i%13+1===1}function lie({onConnect:i,onClose:e}){return Re.jsx("div",{className:"fixed inset-0 bg-[#000000c8] flex items-center justify-center z-40",children:Re.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 w-[90%] max-w-md",children:[Re.jsx("h2",{className:"text-xl font-semibold mb-4 text-center text-[#000000]",children:"Connect To wallet"}),Re.jsxs("div",{className:"flex flex-col gap-3",children:[Re.jsx("button",{onClick:i,className:"px-6 py-2 rounded-md bg-black text-white hover:bg-blue-500 cursor-pointer transition-colors duration-200",children:"MetaMask"}),Re.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700  hover:underline text-sm text-center",children:"Cancel (Test Mode)"})]})]})})}function CB(i,{strict:e=!0}={}){return!i||typeof i!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(i):i.startsWith("0x")}function Ik(i){return CB(i,{strict:!1})?Math.ceil((i.length-2)/2):i.length}const o6="2.29.0";let Ab={getDocsUrl:({docsBaseUrl:i,docsPath:e="",docsSlug:t})=>e?`${i??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${o6}`};class jc extends Error{constructor(e,t={}){var o;const n=(()=>{var l;return t.cause instanceof jc?t.cause.details:(l=t.cause)!=null&&l.message?t.cause.message:t.details})(),s=t.cause instanceof jc&&t.cause.docsPath||t.docsPath,r=(o=Ab.getDocsUrl)==null?void 0:o.call(Ab,{...t,docsPath:s}),a=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...r?[`Docs: ${r}`]:[],...n?[`Details: ${n}`]:[],...Ab.version?[`Version: ${Ab.version}`]:[]].join(`
`);super(a,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=o6}walk(e){return l6(this,e)}}function l6(i,e){return e!=null&&e(i)?i:i&&typeof i=="object"&&"cause"in i&&i.cause!==void 0?l6(i.cause,e):e?null:i}class cie extends jc{constructor({expectedLength:e,givenLength:t}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${e}`,`Given length (values): ${t}`].join(`
`),{name:"AbiEncodingLengthMismatchError"})}}class uie extends jc{constructor({expectedSize:e,givenSize:t}){super(`Expected bytes${e}, got bytes${t}.`,{name:"BytesSizeMismatchError"})}}class hie extends jc{constructor(e){super(`Type "${e}" is not supported for packed encoding.`,{name:"UnsupportedPackedAbiType"})}}class c6 extends jc{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function Ff(i,{dir:e,size:t=32}={}){return typeof i=="string"?fie(i,{dir:e,size:t}):die(i,{dir:e,size:t})}function fie(i,{dir:e,size:t=32}={}){if(t===null)return i;const n=i.replace("0x","");if(n.length>t*2)throw new c6({size:Math.ceil(n.length/2),targetSize:t,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function die(i,{dir:e,size:t=32}={}){if(t===null)return i;if(i.length>t)throw new c6({size:i.length,targetSize:t,type:"bytes"});const n=new Uint8Array(t);for(let s=0;s<t;s++){const r=e==="right";n[r?s:t-s-1]=i[r?s:i.length-s-1]}return n}class pie extends jc{constructor({max:e,min:t,signed:n,size:s,value:r}){super(`Number "${r}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class mie extends jc{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function NE(i,{size:e}){if(Ik(i)>e)throw new mie({givenSize:Ik(i),maxSize:e})}const gie=Array.from({length:256},(i,e)=>e.toString(16).padStart(2,"0"));function yie(i,e={}){return typeof i=="number"||typeof i=="bigint"?RB(i,e):typeof i=="string"?f6(i,e):typeof i=="boolean"?u6(i,e):h6(i,e)}function u6(i,e={}){const t=`0x${Number(i)}`;return typeof e.size=="number"?(NE(t,{size:e.size}),Ff(t,{size:e.size})):t}function h6(i,e={}){let t="";for(let s=0;s<i.length;s++)t+=gie[i[s]];const n=`0x${t}`;return typeof e.size=="number"?(NE(n,{size:e.size}),Ff(n,{dir:"right",size:e.size})):n}function RB(i,e={}){const{signed:t,size:n}=e,s=BigInt(i);let r;n?t?r=(1n<<BigInt(n)*8n-1n)-1n:r=2n**(BigInt(n)*8n)-1n:typeof i=="number"&&(r=BigInt(Number.MAX_SAFE_INTEGER));const a=typeof r=="bigint"&&t?-r-1n:0;if(r&&s>r||s<a){const l=typeof i=="bigint"?"n":"";throw new pie({max:r?`${r}${l}`:void 0,min:`${a}${l}`,signed:t,size:n,value:`${i}${l}`})}const o=`0x${(t&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?Ff(o,{size:n}):o}const vie=new TextEncoder;function f6(i,e={}){const t=vie.encode(i);return h6(t,e)}const xie=new TextEncoder;function bie(i,e={}){return typeof i=="number"||typeof i=="bigint"?Eie(i,e):typeof i=="boolean"?Aie(i,e):CB(i)?d6(i,e):p6(i,e)}function Aie(i,e={}){const t=new Uint8Array(1);return t[0]=Number(i),typeof e.size=="number"?(NE(t,{size:e.size}),Ff(t,{size:e.size})):t}const qh={zero:48,nine:57,A:65,F:70,a:97,f:102};function Bk(i){if(i>=qh.zero&&i<=qh.nine)return i-qh.zero;if(i>=qh.A&&i<=qh.F)return i-(qh.A-10);if(i>=qh.a&&i<=qh.f)return i-(qh.a-10)}function d6(i,e={}){let t=i;e.size&&(NE(t,{size:e.size}),t=Ff(t,{dir:"right",size:e.size}));let n=t.slice(2);n.length%2&&(n=`0${n}`);const s=n.length/2,r=new Uint8Array(s);for(let a=0,o=0;a<s;a++){const l=Bk(n.charCodeAt(o++)),c=Bk(n.charCodeAt(o++));if(l===void 0||c===void 0)throw new jc(`Invalid byte sequence ("${n[o-2]}${n[o-1]}" in "${n}").`);r[a]=l*16+c}return r}function Eie(i,e){const t=RB(i,e);return d6(t)}function p6(i,e={}){const t=xie.encode(i);return typeof e.size=="number"?(NE(t,{size:e.size}),Ff(t,{dir:"right",size:e.size})):t}function Ok(i){if(!Number.isSafeInteger(i)||i<0)throw new Error("positive integer expected, got "+i)}function _ie(i){return i instanceof Uint8Array||ArrayBuffer.isView(i)&&i.constructor.name==="Uint8Array"}function DB(i,...e){if(!_ie(i))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(i.length))throw new Error("Uint8Array expected of length "+e+", got length="+i.length)}function Pk(i,e=!0){if(i.destroyed)throw new Error("Hash instance has been destroyed");if(e&&i.finished)throw new Error("Hash#digest() has already been called")}function Sie(i,e){DB(i);const t=e.outputLen;if(i.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const rS=BigInt(2**32-1),Nk=BigInt(32);function Tie(i,e=!1){return e?{h:Number(i&rS),l:Number(i>>Nk&rS)}:{h:Number(i>>Nk&rS)|0,l:Number(i&rS)|0}}function wie(i,e=!1){let t=new Uint32Array(i.length),n=new Uint32Array(i.length);for(let s=0;s<i.length;s++){const{h:r,l:a}=Tie(i[s],e);[t[s],n[s]]=[r,a]}return[t,n]}const Mie=(i,e,t)=>i<<t|e>>>32-t,Cie=(i,e,t)=>e<<t|i>>>32-t,Rie=(i,e,t)=>e<<t-32|i>>>64-t,Die=(i,e,t)=>i<<t-32|e>>>64-t;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Lie(i){return new Uint32Array(i.buffer,i.byteOffset,Math.floor(i.byteLength/4))}const Uk=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Iie(i){return i<<24&4278190080|i<<8&16711680|i>>>8&65280|i>>>24&255}function kk(i){for(let e=0;e<i.length;e++)i[e]=Iie(i[e])}typeof Uint8Array.from([]).toHex=="function"&&Uint8Array.fromHex;function Bie(i){if(typeof i!="string")throw new Error("utf8ToBytes expected string, got "+typeof i);return new Uint8Array(new TextEncoder().encode(i))}function m6(i){return typeof i=="string"&&(i=Bie(i)),DB(i),i}class Oie{clone(){return this._cloneInto()}}function Pie(i){const e=n=>i().update(m6(n)).digest(),t=i();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>i(),e}const g6=[],y6=[],v6=[],Nie=BigInt(0),Eb=BigInt(1),Uie=BigInt(2),kie=BigInt(7),Fie=BigInt(256),Hie=BigInt(113);for(let i=0,e=Eb,t=1,n=0;i<24;i++){[t,n]=[n,(2*t+3*n)%5],g6.push(2*(5*n+t)),y6.push((i+1)*(i+2)/2%64);let s=Nie;for(let r=0;r<7;r++)e=(e<<Eb^(e>>kie)*Hie)%Fie,e&Uie&&(s^=Eb<<(Eb<<BigInt(r))-Eb);v6.push(s)}const[Gie,zie]=wie(v6,!0),Fk=(i,e,t)=>t>32?Rie(i,e,t):Mie(i,e,t),Hk=(i,e,t)=>t>32?Die(i,e,t):Cie(i,e,t);function Vie(i,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let a=0;a<10;a++)t[a]=i[a]^i[a+10]^i[a+20]^i[a+30]^i[a+40];for(let a=0;a<10;a+=2){const o=(a+8)%10,l=(a+2)%10,c=t[l],h=t[l+1],d=Fk(c,h,1)^t[o],m=Hk(c,h,1)^t[o+1];for(let y=0;y<50;y+=10)i[a+y]^=d,i[a+y+1]^=m}let s=i[2],r=i[3];for(let a=0;a<24;a++){const o=y6[a],l=Fk(s,r,o),c=Hk(s,r,o),h=g6[a];s=i[h],r=i[h+1],i[h]=l,i[h+1]=c}for(let a=0;a<50;a+=10){for(let o=0;o<10;o++)t[o]=i[a+o];for(let o=0;o<10;o++)i[a+o]^=~t[(o+2)%10]&t[(o+4)%10]}i[0]^=Gie[n],i[1]^=zie[n]}t.fill(0)}class LB extends Oie{constructor(e,t,n,s=!1,r=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=r,Ok(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Lie(this.state)}keccak(){Uk||kk(this.state32),Vie(this.state32,this.rounds),Uk||kk(this.state32),this.posOut=0,this.pos=0}update(e){Pk(this);const{blockLen:t,state:n}=this;e=m6(e);const s=e.length;for(let r=0;r<s;){const a=Math.min(t-this.pos,s-r);for(let o=0;o<a;o++)n[this.pos++]^=e[r++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,(t&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Pk(this,!1),DB(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,r=e.length;s<r;){this.posOut>=n&&this.keccak();const a=Math.min(n-this.posOut,r-s);e.set(t.subarray(this.posOut,this.posOut+a),s),this.posOut+=a,s+=a}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Ok(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Sie(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:r,enableXOF:a}=this;return e||(e=new LB(t,n,s,a,r)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=r,e.suffix=n,e.outputLen=s,e.enableXOF=a,e.destroyed=this.destroyed,e}}const Yie=(i,e,t)=>Pie(()=>new LB(e,i,t)),Kie=Yie(1,136,256/8);function x6(i,e){const t=e||"hex",n=Kie(CB(i,{strict:!1})?bie(i):i);return t==="bytes"?n:yie(n)}class Wie extends jc{constructor({address:e}){super(`Address "${e}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}class b6 extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const mR=new b6(8192);function Xie(i,e){if(mR.has(`${i}.${e}`))return mR.get(`${i}.${e}`);const t=i.substring(2).toLowerCase(),n=x6(p6(t),"bytes"),s=t.split("");for(let a=0;a<40;a+=2)n[a>>1]>>4>=8&&s[a]&&(s[a]=s[a].toUpperCase()),(n[a>>1]&15)>=8&&s[a+1]&&(s[a+1]=s[a+1].toUpperCase());const r=`0x${s.join("")}`;return mR.set(`${i}.${e}`,r),r}const jie=/^0x[a-fA-F0-9]{40}$/,gR=new b6(8192);function qie(i,e){const{strict:t=!0}={},n=`${i}.${t}`;if(gR.has(n))return gR.get(n);const s=jie.test(i)?i.toLowerCase()===i?!0:t?Xie(i)===i:!0:!1;return gR.set(n,s),s}function A6(i){return`0x${i.reduce((e,t)=>e+t.replace("0x",""),"")}`}const Qie=/^(.*)\[([0-9]*)\]$/,$ie=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,Jie=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function Zie(i,e){if(i.length!==e.length)throw new cie({expectedLength:i.length,givenLength:e.length});const t=[];for(let n=0;n<i.length;n++){const s=i[n],r=e[n];t.push(E6(s,r))}return A6(t)}function E6(i,e,t=!1){if(i==="address"){const a=e;if(!qie(a))throw new Wie({address:a});return Ff(a.toLowerCase(),{size:t?32:null})}if(i==="string")return f6(e);if(i==="bytes")return e;if(i==="bool")return Ff(u6(e),{size:t?32:1});const n=i.match(Jie);if(n){const[a,o,l="256"]=n,c=Number.parseInt(l)/8;return RB(e,{size:t?32:c,signed:o==="int"})}const s=i.match($ie);if(s){const[a,o]=s;if(Number.parseInt(o)!==(e.length-2)/2)throw new uie({expectedSize:Number.parseInt(o),givenSize:(e.length-2)/2});return Ff(e,{dir:"right",size:t?32:null})}const r=i.match(Qie);if(r&&Array.isArray(e)){const[a,o]=r,l=[];for(let c=0;c<e.length;c++)l.push(E6(o,e[c],!0));return l.length===0?"0x":A6(l)}throw new hie(i)}const ese=()=>{const[i,e]=ce.useState(!0),[t,n]=ce.useState(!1),[s,r]=ce.useState(""),[a,o]=ce.useState(!1),[l,c]=ce.useState(!1),[h,d]=ce.useState("betting"),[m,y]=ce.useState([]),[x,_]=ce.useState(""),[b,A]=ce.useState(""),[T,w]=ce.useState([]),[R,O]=ce.useState(0),[N,U]=ce.useState(0),[P,B]=ce.useState(0),[L,F]=ce.useState(0),[j,J]=ce.useState([]),[re,q]=ce.useState([]),[W,ne]=ce.useState(""),[ie,ue]=ce.useState(""),[z,ae]=ce.useState([]),[ge,Ee]=ce.useState([]),[le,Ce]=ce.useState(!1),[Me,Ze]=ce.useState(!1),tt=sie(re,j,le,Me);ce.useEffect(()=>()=>{},[m]);const Mt=ot=>{let et=0,pt=0;for(const Ct of ot){const Et=Ct%13+1;Et===1?(pt++,et+=11):Et>=10?et+=10:et+=Et}let vt=et,it=!1;for(console.log(it);vt>21&&pt>0;)vt-=10,pt--,it=!0;if(vt>21)return`${vt} Bust🧨`;if(vt===21&&ot.length===2)return"21! Blackjack!";if(pt>0&&(vt!==et||et===vt)){const Ct=vt-10;if(Ct>0&&vt!==Ct)return`${Ct} / ${vt}`}return vt},bt=ot=>{const et=["C","D","H","S"],pt=Math.floor(ot/13),vt=ot%13+1;return`${et[pt]}_${vt}`},cn=(ot,et=!1)=>ot.length===0?Re.jsxs("div",{className:"flex",children:[Re.jsx("img",{src:j_("BACK"),alt:"empty-card",className:"w-[80px] h-auto mx-1 drop-shadow-md"}),Re.jsx("img",{src:j_("BACK"),alt:"empty-card",className:"w-[80px] h-auto mx-1 drop-shadow-md"})]}):ot.map((pt,vt)=>Re.jsx("img",{src:j_(et&&vt===0?"BACK":pt),alt:`card-${vt}`,className:"w-[80px] h-auto mx-1 drop-shadow-md"},vt)),tn=(ot,et)=>{J(ot.map(pt=>pt)),q(et.map(pt=>pt)),ae(ot.map(pt=>bt(pt))),Ee(et.map(pt=>bt(pt))),ne(Mt(ot.map(pt=>Number(pt))).toString()),console.log(W),ue(Mt(et.map(pt=>Number(pt))).toString())},Ot=ot=>{const et=ot.target.value;isNaN(et)||B(et)},te=async ot=>{const et=ot,pt=[et[0],et[1]],vt=[et[2],et[3]];tn(pt,vt);const it=et.slice(4);w([pt[0],pt[1],vt[0],vt[1]]),O(2),y(it)},At=ot=>{const et=Array.from({length:52},(vt,it)=>it);let pt=BigInt(ot);for(let vt=51;vt>0;vt--){const it=Zie(["uint256","uint256"],[pt,BigInt(vt)]),Ct=x6(it);pt=BigInt(Ct);const Et=Number(pt%BigInt(vt+1));[et[vt],et[Et]]=[et[Et],et[vt]]}return et},Ve=async()=>{try{const ot=await Lk(),et=DE(32),pt=Xt(et),vt=ir(et);_(pt);const Ct=await(await ot.newGame(vt,{value:WJ(P.toString())})).wait(),Et=await ot.queryFilter(ot.filters.GameCreated(),Ct.blockNumber,Ct.blockNumber);if(Et.length>0){const Nt=Et[0].args.gameId;await ot.getGameInfo(Nt),A(Nt.toString());const ve=At(pt);te(ve)}else console.warn("⚠️ Missing GameCreated Event (queryFilter)")}catch(ot){console.error("❌ Error Code:",ot)}},st=async(ot,et)=>{var pt;c(!0);try{const vt=await Lk(),Ct=await(await vt.endGame(b,x,ot,et)).wait();(pt=Ct.events)==null||pt.forEach(Dt=>{console.log("Event:",Dt.event,Dt.args)});const Et=await vt.queryFilter(vt.filters.GameEnded(),Ct.blockNumber,Ct.blockNumber);if(Et.length>0){const Dt=Et[0];console.log("✅ GameEnded Event:",Dt.args)}else console.warn("⚠️ GameEnded event not found in block.")}catch(vt){console.error("❌ handleGameOver error:",vt),r("Failed to submit game result to contract ❌"),n(!0)}},$e=()=>{const ot=m[0],et=[...T,ot];w(et);const pt=[...re,ot];q(pt);const vt=R+1;O(vt),Ee(pt.map(Et=>bt(Number(Et))));const it=Mt(pt.map(Et=>Number(Et))).toString();ue(it);const Ct=m.slice(1);y(Ct),q_(Mt(pt.map(Et=>Number(Et))))>21&&(d("over"),setTimeout(()=>{a&&st(et,vt),d("over"),r("You Bust! 😢"),n(!0)},1e3))},Pt=()=>{Ze(!0),d("dealer");let ot=[...j],et=[...m],pt=[...T];const vt=()=>{const it=Mt(ot);if(q_(it)>=17){J(ot),ae(ot.map(Et=>bt(Number(Et)))),ne(it.toString()),d("over"),setTimeout(async()=>{const Et=q_(ie),Dt=q_(it);d("over"),Et>Dt||Dt>21?(r("You Win! 🎉"),U(N+L*2)):Et<Dt?r("You Lose! 😢"):(r("It's a Tie! 🤝"),U(N+L)),n(!0),a&&(await st(pt,R),c(!1))},1200);return}const Ct=et.shift();Ct!==void 0&&(ot.push(Ct),pt.push(Ct),J([...ot]),ae(ot.map(Et=>bt(Number(Et)))),y([...et]),w([...pt])),setTimeout(vt,800)};setTimeout(vt,1e3)},nt=async()=>{if(P<=0||P>N)return alert("Please enter a valid bet amount!");U(N-P),F(Number(P)),a?(d("waiting"),await Ve()):te(xJ()),d("player"),Ce(!0),B(0)},ee=()=>{_(""),A(""),w([]),O(0),y([]),J([]),q([]),ae([]),Ee([]),ne(""),ue(""),Ze(!1),Ce(!1),d("betting"),r(""),F(0),n(!1)},X=async()=>{try{if(window.ethereum){const ot=await window.ethereum.request({method:"eth_requestAccounts"});if(ot&&ot.length>0){o(!0);const pt=await new a6(window.ethereum).getBalance(ot[0]),vt=KJ(pt);U(Number(vt))}}else alert("Please install MetaMask!")}catch(ot){console.error("MetaMask Error",ot)}finally{e(!1)}},we=()=>{e(!1),U(2e3)},Fe=[{label:"Hit",show:tt.canHit,onclick:$e},{label:"Stand",show:tt.canStand,onclick:Pt},{label:"Double",show:tt.canDouble},{label:"Split",show:tt.canSplit},{label:"Surrender",show:tt.canSurrender},{label:"Insurance",show:tt.canInsurance}],ut=Mt(Me?j:j.slice(1)),We=Mt(re)?Mt(re):Mt(re).toString();return Re.jsx("div",{className:"w-full min-h-screen pt-[50px] bg-gradient-to-b from-green-900 to-green-600 flex flex-col items-center justify-center",children:Re.jsxs("div",{className:"min-h-[80vh] flex flex-col items-center py-10 px-4 text-white font-semibold",children:[Re.jsxs("div",{className:"flex flex-col items-center",children:[Re.jsx("h2",{className:"text-xl mb-2",children:"Dealer"}),Re.jsx("div",{className:"flex",children:cn(z,!Me)}),Re.jsxs("h2",{className:"mt-1",children:["Dealer Score: ",ut]})]}),Re.jsxs("div",{className:"flex flex-col items-center my-3 relative",children:[Re.jsxs("p",{className:"text-white mb-2 text-lg",children:["Your Current Bet Amount: ",N," ETH"]}),Re.jsxs("div",{className:"text-lg",children:[h==="over"&&Re.jsx("p",{className:"text-yellow-500 animate-pulse py-4",children:"Game Over..."}),h==="dealer"&&Re.jsx("p",{className:"text-fuchsia-500 animate-pulse py-4",children:"Dealer Drawing Cards..."}),h==="player"&&Re.jsx("p",{className:"text-red-500 animate-pulse py-4",children:"Player turn..."}),h==="waiting"&&Re.jsx("p",{className:"text-yellow-500 animate-pulse py-4",children:"Waiting for transaction confirmation..."}),h!=="betting"&&Re.jsxs("p",{className:"text-white",children:[" Your Bet Amount: ",L," ETH"]}),h==="betting"&&Re.jsxs("div",{className:"flex flex-col items-center",children:[Re.jsx("label",{className:"text-white mb-2 text-lg",children:"Place Your Bet"}),Re.jsx("input",{value:P,onChange:Ot,className:"px-4 py-2 rounded-lg border-2 border-[#1a1a1a] focus:outline-none w-60 text-white",placeholder:"Enter bet amount"}),Re.jsx("button",{onClick:nt,className:".common_button mt-4 px-6 py-2 rounded-md bg-black text-white hover:bg-blue-500 cursor-pointer transition-colors duration-200",children:"Bet"})]})]})]}),Re.jsxs("div",{className:"flex flex-col items-center",children:[Re.jsx("h2",{className:"text-xl mb-2",children:"You"}),Re.jsx("div",{className:"flex",children:cn(ge)}),Re.jsxs("h2",{className:"mt-1",children:["Your Score: ",We]}),Re.jsx("div",{className:"flex gap-2 mt-4",children:Fe.map(ot=>ot.show&&Re.jsx("button",{className:"px-6 py-2 rounded-md bg-black text-white hover:bg-blue-500 cursor-pointer transition-colors duration-200",onClick:ot.onclick,children:ot.label},ot.label))})]}),i&&Re.jsx(lie,{onConnect:()=>X(),onClose:()=>we()}),t&&Re.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:Re.jsxs("div",{className:"bg-white rounded-lg p-6 text-center shadow-lg w-[300px]",children:[Re.jsx("h2",{className:"text-xl text-black font-bold mb-4",children:s}),l?Re.jsx("p",{className:"text-yellow-500 text-lg animate-pulse mt-4",children:"Waiting for transaction confirmation..."}):Re.jsx("button",{onClick:()=>ee(),className:"mt-4 px-6 py-2 rounded-md bg-black text-white hover:bg-blue-500 cursor-pointer transition-colors duration-200",children:"Confirm"})]})})]})})};function $w(i,e,t,n){return new(t||(t=Promise))(function(s,r){function a(c){try{l(n.next(c))}catch(h){r(h)}}function o(c){try{l(n.throw(c))}catch(h){r(h)}}function l(c){var h;c.done?s(c.value):(h=c.value,h instanceof t?h:new t(function(d){d(h)})).then(a,o)}l((n=n.apply(i,[])).next())})}function C0(i,e){var t,n,s,r,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function o(l){return function(c){return function(h){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(s=2&h[0]?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[2&h[0],s.value]),h[0]){case 0:case 1:s=h;break;case 4:return a.label++,{value:h[1],done:!1};case 5:a.label++,n=h[1],h=[0];continue;case 7:h=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!((s=s.length>0&&s[s.length-1])||h[0]!==6&&h[0]!==2)){a=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){a.label=h[1];break}if(h[0]===6&&a.label<s[1]){a.label=s[1],s=h;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(h);break}s[2]&&a.ops.pop(),a.trys.pop();continue}h=e.call(i,a)}catch(d){h=[6,d],n=0}finally{t=s=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}([l,c])}}}function zL(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Fc(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var n,s,r=t.call(i),a=[];try{for(;(e===void 0||e-- >0)&&!(n=r.next()).done;)a.push(n.value)}catch(o){s={error:o}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(s)throw s.error}}return a}function sh(i,e,t){if(arguments.length===2)for(var n,s=0,r=e.length;s<r;s++)!n&&s in e||(n||(n=Array.prototype.slice.call(e,0,s)),n[s]=e[s]);return i.concat(n||Array.prototype.slice.call(e))}function Gk(i,e,t,n,s){for(var r=[],a=5;a<arguments.length;a++)r[a-5]=arguments[a];return $w(this,void 0,void 0,function(){var o,l,c,h,d,m;return C0(this,function(y){switch(y.label){case 0:y.trys.push([0,12,13,14]),o=zL(r),l=o.next(),y.label=1;case 1:if(l.done)return[3,11];switch(c=l.value,typeof c){case"string":return[3,2];case"number":return[3,4];case"function":return[3,6]}return[3,8];case 2:return[4,tse(i,e,c,t,n,s)];case 3:return y.sent(),[3,10];case 4:return[4,_6(c)];case 5:return y.sent(),[3,10];case 6:return[4,c.apply(void 0,sh([i,e,t,n,s],Fc(r),!1))];case 7:return y.sent(),[3,10];case 8:return[4,c];case 9:y.sent(),y.label=10;case 10:return l=o.next(),[3,1];case 11:return[3,14];case 12:return h=y.sent(),d={error:h},[3,14];case 13:try{l&&!l.done&&(m=o.return)&&m.call(o)}finally{if(d)throw d.error}return[7];case 14:return[2]}})})}function tse(i,e,t,n,s,r){return $w(this,void 0,void 0,function(){var a,o;return C0(this,function(l){switch(l.label){case 0:return a=i.textContent||"",o=function(c,h){var d=Fc(h).slice(0);return sh(sh([],Fc(c),!1),[NaN],!1).findIndex(function(m,y){return d[y]!==m})}(a,t),[4,nse(i,sh(sh([],Fc(sse(a,e,o)),!1),Fc(ise(t,e,o)),!1),n,s,r)];case 1:return l.sent(),[2]}})})}function _6(i){return $w(this,void 0,void 0,function(){return C0(this,function(e){switch(e.label){case 0:return[4,new Promise(function(t){return setTimeout(t,i)})];case 1:return e.sent(),[2]}})})}function nse(i,e,t,n,s){return $w(this,void 0,void 0,function(){var r,a,o,l,c,h,d,m,y,x,_,b,A;return C0(this,function(T){switch(T.label){case 0:if(r=e,s){for(a=0,o=1;o<e.length;o++)if(l=Fc([e[o-1],e[o]],2),c=l[0],(h=l[1]).length>c.length||h===""){a=o;break}r=e.slice(a,e.length)}T.label=1;case 1:T.trys.push([1,6,7,8]),d=zL(function(w){var R,O,N,U,P,B,L;return C0(this,function(F){switch(F.label){case 0:R=function(j){return C0(this,function(J){switch(J.label){case 0:return[4,{op:function(re){return requestAnimationFrame(function(){return re.textContent=j})},opCode:function(re){var q=re.textContent||"";return j===""||q.length>j.length?"DELETE":"WRITING"}}];case 1:return J.sent(),[2]}})},F.label=1;case 1:F.trys.push([1,6,7,8]),O=zL(w),N=O.next(),F.label=2;case 2:return N.done?[3,5]:(U=N.value,[5,R(U)]);case 3:F.sent(),F.label=4;case 4:return N=O.next(),[3,2];case 5:return[3,8];case 6:return P=F.sent(),B={error:P},[3,8];case 7:try{N&&!N.done&&(L=O.return)&&L.call(O)}finally{if(B)throw B.error}return[7];case 8:return[2]}})}(r)),m=d.next(),T.label=2;case 2:return m.done?[3,5]:(y=m.value,x=y.opCode(i)==="WRITING"?t+t*(Math.random()-.5):n+n*(Math.random()-.5),y.op(i),[4,_6(x)]);case 3:T.sent(),T.label=4;case 4:return m=d.next(),[3,2];case 5:return[3,8];case 6:return _=T.sent(),b={error:_},[3,8];case 7:try{m&&!m.done&&(A=d.return)&&A.call(d)}finally{if(b)throw b.error}return[7];case 8:return[2]}})})}function ise(i,e,t){var n,s;return t===void 0&&(t=0),C0(this,function(r){switch(r.label){case 0:n=e(i),s=n.length,r.label=1;case 1:return t<s?[4,n.slice(0,++t).join("")]:[3,3];case 2:return r.sent(),[3,1];case 3:return[2]}})}function sse(i,e,t){var n,s;return t===void 0&&(t=0),C0(this,function(r){switch(r.label){case 0:n=e(i),s=n.length,r.label=1;case 1:return s>t?[4,n.slice(0,--s).join("")]:[3,3];case 2:return r.sent(),[3,1];case 3:return[2]}})}var rse="index-module_type__E-SaG";(function(i,e){e===void 0&&(e={});var t=e.insertAt;if(typeof document<"u"){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",t==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i))}})(`.index-module_type__E-SaG::after {
  content: '|';
  animation: index-module_cursor__PQg0P 1.1s infinite step-start;
}

@keyframes index-module_cursor__PQg0P {
  50% {
    opacity: 0;
  }
}
`);var yR=ce.memo(ce.forwardRef(function(i,e){var t=i.sequence,n=i.repeat,s=i.className,r=i.speed,a=r===void 0?40:r,o=i.deletionSpeed,l=i.omitDeletionAnimation,c=l!==void 0&&l,h=i.preRenderFirstString,d=h!==void 0&&h,m=i.wrapper,y=m===void 0?"span":m,x=i.splitter,_=x===void 0?function(z){return sh([],Fc(z),!1)}:x,b=i.cursor,A=b===void 0||b,T=i.style,w=function(z,ae){var ge={};for(var Ee in z)Object.prototype.hasOwnProperty.call(z,Ee)&&ae.indexOf(Ee)<0&&(ge[Ee]=z[Ee]);if(z!=null&&typeof Object.getOwnPropertySymbols=="function"){var le=0;for(Ee=Object.getOwnPropertySymbols(z);le<Ee.length;le++)ae.indexOf(Ee[le])<0&&Object.prototype.propertyIsEnumerable.call(z,Ee[le])&&(ge[Ee[le]]=z[Ee[le]])}return ge}(i,["sequence","repeat","className","speed","deletionSpeed","omitDeletionAnimation","preRenderFirstString","wrapper","splitter","cursor","style"]),R=w["aria-label"],O=w["aria-hidden"],N=w.role;o||(o=a);var U=new Array(2).fill(40);[a,o].forEach(function(z,ae){switch(typeof z){case"number":U[ae]=Math.abs(z-100);break;case"object":var ge=z.type,Ee=z.value;if(typeof Ee!="number")break;ge==="keyStrokeDelayInMs"&&(U[ae]=Ee)}});var P,B,L,F,j,J,re=U[0],q=U[1],W=function(z,ae){ae===void 0&&(ae=null);var ge=ce.useRef(ae);return ce.useEffect(function(){z&&(typeof z=="function"?z(ge.current):z.current=ge.current)},[z]),ge}(e),ne=rse;P=s?"".concat(A?ne+" ":"").concat(s):A?ne:"",B=ce.useRef(function(){var z,ae=t;n===1/0?z=Gk:typeof n=="number"&&(ae=Array(1+n).fill(t).flat());var ge=z?sh(sh([],Fc(ae),!1),[z],!1):sh([],Fc(ae),!1);return Gk.apply(void 0,sh([W.current,_,re,q,c],Fc(ge),!1)),function(){W.current}}),L=ce.useRef(),F=ce.useRef(!1),j=ce.useRef(!1),J=Fc(ce.useState(0),2)[1],F.current&&(j.current=!0),ce.useEffect(function(){return F.current||(L.current=B.current(),F.current=!0),J(function(z){return z+1}),function(){j.current&&L.current&&L.current()}},[]);var ie=y,ue=d?t.find(function(z){return typeof z=="string"})||"":null;return mv.createElement(ie,{"aria-hidden":O,"aria-label":R,role:N,style:T,className:P,children:R?mv.createElement("span",{"aria-hidden":"true",ref:W,children:ue}):ue,ref:R?void 0:W})}),function(i,e){return!0});const O2=({children:i,onClick:e,className:t="",type:n="button"})=>Re.jsx("button",{type:n,onClick:e,className:`px-8 py-3 border-2 border-cyan-400 rounded-xl text-cyan-300 font-medium text-lg hover:bg-cyan-400 hover:text-black transition text-neon-soft inline-block cursor-pointer ${t}`,children:i}),zk=["(T_T)","(ಥ﹏ಥ)","(；＿；)","(ಥ_ಥ)"],ase=()=>{const[i,e]=ce.useState(0);return ce.useEffect(()=>{const t=setInterval(()=>{e(n=>(n+1)%zk.length)},2e3);return()=>clearInterval(t)},[]),Re.jsx("div",{className:"text-4xl md:text-6xl text-cyan-300 text-neon-soft animate-pulse mt-6",children:zk[i]})},ose=()=>{const[i,e]=ce.useState("intro"),[t,n]=ce.useState(""),[s,r]=ce.useState(""),a=N5();return Re.jsxs("div",{className:"neon-scan-bg min-h-screen relative flex items-center justify-center px-4 text-center",children:[i==="intro"&&Re.jsxs("div",{className:"z-10 space-y-6 animate-fadeIn",children:[Re.jsx("h1",{className:"text-4xl md:text-6xl font-bold text-white text-neon",children:"Welcome to Cyber Park"}),Re.jsx("p",{className:"text-xl text-cyan-200 text-neon-soft",children:"Feel the glow, embrace the night"}),Re.jsx(O2,{onClick:()=>e("name"),children:"Explore"})]}),i==="name"&&Re.jsxs("div",{className:"z-10 space-y-10 animate-fadeIn px-4 text-center",children:[Re.jsx(yR,{sequence:["What's your name, explorer?",800],speed:50,wrapper:"p",className:"text-2xl md:text-4xl text-cyan-300 text-neon-soft"}),Re.jsx("input",{type:"text",value:t,onChange:o=>n(o.target.value),placeholder:"Enter your name",className:"px-4 py-3 w-[280px] md:w-[320px] rounded-lg bg-black border-2 border-cyan-400 text-cyan-300 text-center text-xl focus:outline-none focus:ring-2 focus:ring-cyan-500 mx-auto"}),Re.jsx("div",{className:"flex flex-col items-center space-y-4",children:Re.jsx(O2,{onClick:()=>{r(t||"Explorer"),e("question")},children:"Confirm"})})]}),i==="question"&&Re.jsxs("div",{className:"z-10 animate-fadeIn space-y-8",children:[Re.jsx(yR,{sequence:[`Hello ${s}, which part are you interested in?`,1200],speed:55,wrapper:"div",className:"text-2xl md:text-4xl text-cyan-300 text-neon-soft"}),Re.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-center space-y-4 md:space-y-0 md:space-x-8",children:[Re.jsx(O2,{onClick:()=>e("frontendMessage"),children:"Frontend"}),Re.jsx(O2,{onClick:()=>a("/blackjackTable"),children:"Smart Contract"})]})]}),i==="frontendMessage"&&Re.jsxs("div",{className:"z-10 space-y-10 animate-fadeIn text-center px-4",children:[Re.jsx(yR,{sequence:["Sorry... City is still under construction.",1200],speed:50,wrapper:"div",className:"text-2xl md:text-4xl text-cyan-300 text-neon-soft"}),Re.jsx(ase,{}),Re.jsxs("div",{className:"flex justify-between items-center space-x-4",children:[Re.jsx(O2,{onClick:()=>a("/CyberCity"),children:"Go to See Building City"}),Re.jsx(O2,{onClick:()=>a("/BlackjackTable"),children:"Go to Blackjack instead"})]})]})]})};/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Sg="176",sm={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},rm={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},S6=0,VL=1,T6=2,lse=3,w6=0,Jw=1,uA=2,Lc=3,qc=0,wr=1,Da=2,la=0,Jm=1,YL=2,KL=3,WL=4,M6=5,r0=100,C6=101,R6=102,D6=103,L6=104,I6=200,B6=201,O6=202,P6=203,E3=204,_3=205,N6=206,U6=207,k6=208,F6=209,H6=210,G6=211,z6=212,V6=213,Y6=214,S3=0,T3=1,w3=2,ug=3,M3=4,C3=5,R3=6,D3=7,UE=0,K6=1,W6=2,Vc=0,X6=1,j6=2,q6=3,IB=4,Q6=5,$6=6,J6=7,XL="attached",Z6="detached",P0=300,gh=301,N0=302,Mv=303,qA=304,Wv=306,U0=1e3,sr=1001,Cv=1002,Ws=1003,Zw=1004,cse=1004,bm=1005,use=1005,ei=1006,Ty=1007,hse=1007,Nl=1008,jL=1008,Xs=1009,eM=1010,tM=1011,Rv=1012,kE=1013,Qc=1014,ps=1015,yr=1016,nM=1017,iM=1018,hg=1020,BB=35902,OB=1021,PB=1022,rr=1023,Dv=1026,fg=1027,FE=1028,HE=1029,NB=1030,sM=1031,fse=1032,rM=1033,hA=33776,fA=33777,dA=33778,pA=33779,L3=35840,I3=35841,B3=35842,O3=35843,P3=36196,N3=37492,U3=37496,k3=37808,F3=37809,H3=37810,G3=37811,z3=37812,V3=37813,Y3=37814,K3=37815,W3=37816,X3=37817,j3=37818,q3=37819,Q3=37820,$3=37821,mA=36492,J3=36494,Z3=36495,UB=36283,ew=36284,tw=36285,nw=36286,e9=2200,t9=2201,n9=2202,Lv=2300,Iv=2301,HT=2302,Am=2400,Em=2401,QA=2402,aM=2500,kB=2501,i9=0,FB=1,iw=2,V0=3200,s9=3201,dse=3202,pse=3203,Y0=0,r9=1,Hc="",bi="srgb",nl="srgb-linear",$A="linear",Hi="srgb",mse=0,am=7680,gse=7681,yse=7682,vse=7683,xse=34055,bse=34056,Ase=5386,Ese=512,_se=513,Sse=514,Tse=515,wse=516,Mse=517,Cse=518,qL=519,a9=512,o9=513,l9=514,HB=515,c9=516,u9=517,h9=518,f9=519,JA=35044,Rse=35048,Dse=35040,Lse=35045,Ise=35049,Bse=35041,Ose=35046,Pse=35050,Nse=35042,Use="100",QL="300 es",Ul=2e3,ZA=2001,kse={COMPUTE:"compute",RENDER:"render"},Fse={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},Hse={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FLAT_FIRST:"flat first",FLAT_EITHER:"flat either"};let sl=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const s=n[e];if(s!==void 0){const r=s.indexOf(t);r!==-1&&s.splice(r,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const s=n.slice(0);for(let r=0,a=s.length;r<a;r++)s[r].call(this,e);e.target=null}}};const _a=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Vk=1234567;const Zm=Math.PI/180,Bv=180/Math.PI;function tl(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(_a[i&255]+_a[i>>8&255]+_a[i>>16&255]+_a[i>>24&255]+"-"+_a[e&255]+_a[e>>8&255]+"-"+_a[e>>16&15|64]+_a[e>>24&255]+"-"+_a[t&63|128]+_a[t>>8&255]+"-"+_a[t>>16&255]+_a[t>>24&255]+_a[n&255]+_a[n>>8&255]+_a[n>>16&255]+_a[n>>24&255]).toLowerCase()}function Rn(i,e,t){return Math.max(e,Math.min(t,i))}function GB(i,e){return(i%e+e)%e}function Gse(i,e,t,n,s){return n+(i-e)*(s-n)/(t-e)}function zse(i,e,t){return i!==e?(t-i)/(e-i):0}function gA(i,e,t){return(1-t)*i+t*e}function Vse(i,e,t,n){return gA(i,e,1-Math.exp(-t*n))}function Yse(i,e=1){return e-Math.abs(GB(i,e*2)-e)}function Kse(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function Wse(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function Xse(i,e){return i+Math.floor(Math.random()*(e-i+1))}function jse(i,e){return i+Math.random()*(e-i)}function qse(i){return i*(.5-Math.random())}function Qse(i){i!==void 0&&(Vk=i);let e=Vk+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function $se(i){return i*Zm}function Jse(i){return i*Bv}function Zse(i){return(i&i-1)===0&&i!==0}function ere(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function tre(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function nre(i,e,t,n,s){const r=Math.cos,a=Math.sin,o=r(t/2),l=a(t/2),c=r((e+n)/2),h=a((e+n)/2),d=r((e-n)/2),m=a((e-n)/2),y=r((n-e)/2),x=a((n-e)/2);switch(s){case"XYX":i.set(o*h,l*d,l*m,o*c);break;case"YZY":i.set(l*m,o*h,l*d,o*c);break;case"ZXZ":i.set(l*d,l*m,o*h,o*c);break;case"XZX":i.set(o*h,l*x,l*y,o*c);break;case"YXY":i.set(l*y,o*h,l*x,o*c);break;case"ZYZ":i.set(l*x,l*y,o*h,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function Qa(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function On(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const d9={DEG2RAD:Zm,RAD2DEG:Bv,generateUUID:tl,clamp:Rn,euclideanModulo:GB,mapLinear:Gse,inverseLerp:zse,lerp:gA,damp:Vse,pingpong:Yse,smoothstep:Kse,smootherstep:Wse,randInt:Xse,randFloat:jse,randFloatSpread:qse,seededRandom:Qse,degToRad:$se,radToDeg:Jse,isPowerOfTwo:Zse,ceilPowerOfTwo:ere,floorPowerOfTwo:tre,setQuaternionFromProperEuler:nre,normalize:On,denormalize:Qa};class Qe{constructor(e=0,t=0){Qe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6],this.y=s[1]*t+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Rn(this.x,e.x,t.x),this.y=Rn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Rn(this.x,e,t),this.y=Rn(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Rn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Rn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),s=Math.sin(t),r=this.x-e.x,a=this.y-e.y;return this.x=r*n-a*s+e.x,this.y=r*s+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Bn{constructor(e,t,n,s,r,a,o,l,c){Bn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,s,r,a,o,l,c)}set(e,t,n,s,r,a,o,l,c){const h=this.elements;return h[0]=e,h[1]=s,h[2]=o,h[3]=t,h[4]=r,h[5]=l,h[6]=n,h[7]=a,h[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,r=this.elements,a=n[0],o=n[3],l=n[6],c=n[1],h=n[4],d=n[7],m=n[2],y=n[5],x=n[8],_=s[0],b=s[3],A=s[6],T=s[1],w=s[4],R=s[7],O=s[2],N=s[5],U=s[8];return r[0]=a*_+o*T+l*O,r[3]=a*b+o*w+l*N,r[6]=a*A+o*R+l*U,r[1]=c*_+h*T+d*O,r[4]=c*b+h*w+d*N,r[7]=c*A+h*R+d*U,r[2]=m*_+y*T+x*O,r[5]=m*b+y*w+x*N,r[8]=m*A+y*R+x*U,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8];return t*a*h-t*o*c-n*r*h+n*o*l+s*r*c-s*a*l}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],d=h*a-o*c,m=o*l-h*r,y=c*r-a*l,x=t*d+n*m+s*y;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/x;return e[0]=d*_,e[1]=(s*c-h*n)*_,e[2]=(o*n-s*a)*_,e[3]=m*_,e[4]=(h*t-s*l)*_,e[5]=(s*r-o*t)*_,e[6]=y*_,e[7]=(n*l-c*t)*_,e[8]=(a*t-n*r)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,s,r,a,o){const l=Math.cos(r),c=Math.sin(r);return this.set(n*l,n*c,-n*(l*a+c*o)+a+e,-s*c,s*l,-s*(-c*a+l*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(vR.makeScale(e,t)),this}rotate(e){return this.premultiply(vR.makeRotation(-e)),this}translate(e,t){return this.premultiply(vR.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<9;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const vR=new Bn;function p9(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const ire={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function fy(i,e){return new ire[i](e)}function eE(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function m9(){const i=eE("canvas");return i.style.display="block",i}const Yk={};function GT(i){i in Yk||(Yk[i]=!0,console.warn(i))}function sre(i,e,t){return new Promise(function(n,s){function r(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:s();break;case i.TIMEOUT_EXPIRED:setTimeout(r,t);break;default:n()}}setTimeout(r,t)})}function rre(i){const e=i.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function are(i){const e=i.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const Kk=new Bn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Wk=new Bn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function ore(){const i={enabled:!0,workingColorSpace:nl,spaces:{},convert:function(s,r,a){return this.enabled===!1||r===a||!r||!a||(this.spaces[r].transfer===Hi&&(s.r=Hf(s.r),s.g=Hf(s.g),s.b=Hf(s.b)),this.spaces[r].primaries!==this.spaces[a].primaries&&(s.applyMatrix3(this.spaces[r].toXYZ),s.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Hi&&(s.r=wy(s.r),s.g=wy(s.g),s.b=wy(s.b))),s},fromWorkingColorSpace:function(s,r){return this.convert(s,this.workingColorSpace,r)},toWorkingColorSpace:function(s,r){return this.convert(s,r,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===Hc?$A:this.spaces[s].transfer},getLuminanceCoefficients:function(s,r=this.workingColorSpace){return s.fromArray(this.spaces[r].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,r,a){return s.copy(this.spaces[r].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[nl]:{primaries:e,whitePoint:n,transfer:$A,toXYZ:Kk,fromXYZ:Wk,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:bi},outputColorSpaceConfig:{drawingBufferColorSpace:bi}},[bi]:{primaries:e,whitePoint:n,transfer:Hi,toXYZ:Kk,fromXYZ:Wk,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:bi}}}),i}const ri=ore();function Hf(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function wy(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let P2;class g9{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{P2===void 0&&(P2=eE("canvas")),P2.width=e.width,P2.height=e.height;const s=P2.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),n=P2}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=eE("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const s=n.getImageData(0,0,e.width,e.height),r=s.data;for(let a=0;a<r.length;a++)r[a]=Hf(r[a]/255)*255;return n.putImageData(s,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Hf(t[n]/255)*255):t[n]=Hf(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let lre=0;class _0{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:lre++}),this.uuid=tl(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},s=this.data;if(s!==null){let r;if(Array.isArray(s)){r=[];for(let a=0,o=s.length;a<o;a++)s[a].isDataTexture?r.push(xR(s[a].image)):r.push(xR(s[a]))}else r=xR(s);n.url=r}return t||(e.images[this.uuid]=n),n}}function xR(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?g9.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let cre=0;class wi extends sl{constructor(e=wi.DEFAULT_IMAGE,t=wi.DEFAULT_MAPPING,n=sr,s=sr,r=ei,a=Nl,o=rr,l=Xs,c=wi.DEFAULT_ANISOTROPY,h=Hc){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:cre++}),this.uuid=tl(),this.name="",this.source=new _0(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=s,this.magFilter=r,this.minFilter=a,this.anisotropy=c,this.format=o,this.internalFormat=null,this.type=l,this.offset=new Qe(0,0),this.repeat=new Qe(1,1),this.center=new Qe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Bn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=h,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isTextureArray=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isTextureArray=e.isTextureArray,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==P0)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case U0:e.x=e.x-Math.floor(e.x);break;case sr:e.x=e.x<0?0:1;break;case Cv:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case U0:e.y=e.y-Math.floor(e.y);break;case sr:e.y=e.y<0?0:1;break;case Cv:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}wi.DEFAULT_IMAGE=null;wi.DEFAULT_MAPPING=P0;wi.DEFAULT_ANISOTROPY=1;class ai{constructor(e=0,t=0,n=0,s=1){ai.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,s){return this.x=e,this.y=t,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,r=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*s+a[12]*r,this.y=a[1]*t+a[5]*n+a[9]*s+a[13]*r,this.z=a[2]*t+a[6]*n+a[10]*s+a[14]*r,this.w=a[3]*t+a[7]*n+a[11]*s+a[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,s,r;const l=e.elements,c=l[0],h=l[4],d=l[8],m=l[1],y=l[5],x=l[9],_=l[2],b=l[6],A=l[10];if(Math.abs(h-m)<.01&&Math.abs(d-_)<.01&&Math.abs(x-b)<.01){if(Math.abs(h+m)<.1&&Math.abs(d+_)<.1&&Math.abs(x+b)<.1&&Math.abs(c+y+A-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const w=(c+1)/2,R=(y+1)/2,O=(A+1)/2,N=(h+m)/4,U=(d+_)/4,P=(x+b)/4;return w>R&&w>O?w<.01?(n=0,s=.707106781,r=.707106781):(n=Math.sqrt(w),s=N/n,r=U/n):R>O?R<.01?(n=.707106781,s=0,r=.707106781):(s=Math.sqrt(R),n=N/s,r=P/s):O<.01?(n=.707106781,s=.707106781,r=0):(r=Math.sqrt(O),n=U/r,s=P/r),this.set(n,s,r,t),this}let T=Math.sqrt((b-x)*(b-x)+(d-_)*(d-_)+(m-h)*(m-h));return Math.abs(T)<.001&&(T=1),this.x=(b-x)/T,this.y=(d-_)/T,this.z=(m-h)/T,this.w=Math.acos((c+y+A-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Rn(this.x,e.x,t.x),this.y=Rn(this.y,e.y,t.y),this.z=Rn(this.z,e.z,t.z),this.w=Rn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Rn(this.x,e,t),this.y=Rn(this.y,e,t),this.z=Rn(this.z,e,t),this.w=Rn(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Rn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class oM extends sl{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth?n.depth:1,this.scissor=new ai(0,0,e,t),this.scissorTest=!1,this.viewport=new ai(0,0,e,t);const s={width:e,height:t,depth:this.depth};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:ei,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,multiview:!1},n);const r=new wi(s,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);r.flipY=!1,r.generateMipmaps=n.generateMipmaps,r.internalFormat=n.internalFormat,this.textures=[];const a=n.count;for(let o=0;o<a;o++)this.textures[o]=r.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let s=0,r=this.textures.length;s<r;s++)this.textures[s].image.width=e,this.textures[s].image.height=t,this.textures[s].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const s=Object.assign({},e.textures[t].image);this.textures[t].source=new _0(s)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Os extends oM{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class GE extends wi{constructor(e=null,t=1,n=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=Ws,this.minFilter=Ws,this.wrapR=sr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class ure extends Os{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new GE(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class lM extends wi{constructor(e=null,t=1,n=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=Ws,this.minFilter=Ws,this.wrapR=sr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class hre extends Os{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new lM(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Yr{constructor(e=0,t=0,n=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=s}static slerpFlat(e,t,n,s,r,a,o){let l=n[s+0],c=n[s+1],h=n[s+2],d=n[s+3];const m=r[a+0],y=r[a+1],x=r[a+2],_=r[a+3];if(o===0){e[t+0]=l,e[t+1]=c,e[t+2]=h,e[t+3]=d;return}if(o===1){e[t+0]=m,e[t+1]=y,e[t+2]=x,e[t+3]=_;return}if(d!==_||l!==m||c!==y||h!==x){let b=1-o;const A=l*m+c*y+h*x+d*_,T=A>=0?1:-1,w=1-A*A;if(w>Number.EPSILON){const O=Math.sqrt(w),N=Math.atan2(O,A*T);b=Math.sin(b*N)/O,o=Math.sin(o*N)/O}const R=o*T;if(l=l*b+m*R,c=c*b+y*R,h=h*b+x*R,d=d*b+_*R,b===1-o){const O=1/Math.sqrt(l*l+c*c+h*h+d*d);l*=O,c*=O,h*=O,d*=O}}e[t]=l,e[t+1]=c,e[t+2]=h,e[t+3]=d}static multiplyQuaternionsFlat(e,t,n,s,r,a){const o=n[s],l=n[s+1],c=n[s+2],h=n[s+3],d=r[a],m=r[a+1],y=r[a+2],x=r[a+3];return e[t]=o*x+h*d+l*y-c*m,e[t+1]=l*x+h*m+c*d-o*y,e[t+2]=c*x+h*y+o*m-l*d,e[t+3]=h*x-o*d-l*m-c*y,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,s=e._y,r=e._z,a=e._order,o=Math.cos,l=Math.sin,c=o(n/2),h=o(s/2),d=o(r/2),m=l(n/2),y=l(s/2),x=l(r/2);switch(a){case"XYZ":this._x=m*h*d+c*y*x,this._y=c*y*d-m*h*x,this._z=c*h*x+m*y*d,this._w=c*h*d-m*y*x;break;case"YXZ":this._x=m*h*d+c*y*x,this._y=c*y*d-m*h*x,this._z=c*h*x-m*y*d,this._w=c*h*d+m*y*x;break;case"ZXY":this._x=m*h*d-c*y*x,this._y=c*y*d+m*h*x,this._z=c*h*x+m*y*d,this._w=c*h*d-m*y*x;break;case"ZYX":this._x=m*h*d-c*y*x,this._y=c*y*d+m*h*x,this._z=c*h*x-m*y*d,this._w=c*h*d+m*y*x;break;case"YZX":this._x=m*h*d+c*y*x,this._y=c*y*d+m*h*x,this._z=c*h*x-m*y*d,this._w=c*h*d-m*y*x;break;case"XZY":this._x=m*h*d-c*y*x,this._y=c*y*d-m*h*x,this._z=c*h*x+m*y*d,this._w=c*h*d+m*y*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,s=Math.sin(n);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],s=t[4],r=t[8],a=t[1],o=t[5],l=t[9],c=t[2],h=t[6],d=t[10],m=n+o+d;if(m>0){const y=.5/Math.sqrt(m+1);this._w=.25/y,this._x=(h-l)*y,this._y=(r-c)*y,this._z=(a-s)*y}else if(n>o&&n>d){const y=2*Math.sqrt(1+n-o-d);this._w=(h-l)/y,this._x=.25*y,this._y=(s+a)/y,this._z=(r+c)/y}else if(o>d){const y=2*Math.sqrt(1+o-n-d);this._w=(r-c)/y,this._x=(s+a)/y,this._y=.25*y,this._z=(l+h)/y}else{const y=2*Math.sqrt(1+d-n-o);this._w=(a-s)/y,this._x=(r+c)/y,this._y=(l+h)/y,this._z=.25*y}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Rn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const s=Math.min(1,t/n);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,s=e._y,r=e._z,a=e._w,o=t._x,l=t._y,c=t._z,h=t._w;return this._x=n*h+a*o+s*c-r*l,this._y=s*h+a*l+r*o-n*c,this._z=r*h+a*c+n*l-s*o,this._w=a*h-n*o-s*l-r*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,s=this._y,r=this._z,a=this._w;let o=a*e._w+n*e._x+s*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=s,this._z=r,this;const l=1-o*o;if(l<=Number.EPSILON){const y=1-t;return this._w=y*a+t*this._w,this._x=y*n+t*this._x,this._y=y*s+t*this._y,this._z=y*r+t*this._z,this.normalize(),this}const c=Math.sqrt(l),h=Math.atan2(c,o),d=Math.sin((1-t)*h)/c,m=Math.sin(t*h)/c;return this._w=a*d+this._w*m,this._x=n*d+this._x*m,this._y=s*d+this._y*m,this._z=r*d+this._z*m,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),s=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(s*Math.sin(e),s*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class se{constructor(e=0,t=0,n=0){se.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Xk.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Xk.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,s=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*s,this.y=r[1]*t+r[4]*n+r[7]*s,this.z=r[2]*t+r[5]*n+r[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,r=e.elements,a=1/(r[3]*t+r[7]*n+r[11]*s+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*s+r[12])*a,this.y=(r[1]*t+r[5]*n+r[9]*s+r[13])*a,this.z=(r[2]*t+r[6]*n+r[10]*s+r[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,s=this.z,r=e.x,a=e.y,o=e.z,l=e.w,c=2*(a*s-o*n),h=2*(o*t-r*s),d=2*(r*n-a*t);return this.x=t+l*c+a*d-o*h,this.y=n+l*h+o*c-r*d,this.z=s+l*d+r*h-a*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,s=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*s,this.y=r[1]*t+r[5]*n+r[9]*s,this.z=r[2]*t+r[6]*n+r[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Rn(this.x,e.x,t.x),this.y=Rn(this.y,e.y,t.y),this.z=Rn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Rn(this.x,e,t),this.y=Rn(this.y,e,t),this.z=Rn(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Rn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,s=e.y,r=e.z,a=t.x,o=t.y,l=t.z;return this.x=s*l-r*o,this.y=r*a-n*l,this.z=n*o-s*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return bR.copy(this).projectOnVector(e),this.sub(bR)}reflect(e){return this.sub(bR.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Rn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return t*t+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const s=Math.sin(t)*e;return this.x=s*Math.sin(n),this.y=Math.cos(t)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const bR=new se,Xk=new Yr;class ca{constructor(e=new se(1/0,1/0,1/0),t=new se(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Ec.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Ec.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Ec.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const r=n.getAttribute("position");if(t===!0&&r!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=r.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,Ec):Ec.fromBufferAttribute(r,a),Ec.applyMatrix4(e.matrixWorld),this.expandByPoint(Ec);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),aS.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),aS.copy(n.boundingBox)),aS.applyMatrix4(e.matrixWorld),this.union(aS)}const s=e.children;for(let r=0,a=s.length;r<a;r++)this.expandByObject(s[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Ec),Ec.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(_b),oS.subVectors(this.max,_b),N2.subVectors(e.a,_b),U2.subVectors(e.b,_b),k2.subVectors(e.c,_b),zd.subVectors(U2,N2),Vd.subVectors(k2,U2),kp.subVectors(N2,k2);let t=[0,-zd.z,zd.y,0,-Vd.z,Vd.y,0,-kp.z,kp.y,zd.z,0,-zd.x,Vd.z,0,-Vd.x,kp.z,0,-kp.x,-zd.y,zd.x,0,-Vd.y,Vd.x,0,-kp.y,kp.x,0];return!AR(t,N2,U2,k2,oS)||(t=[1,0,0,0,1,0,0,0,1],!AR(t,N2,U2,k2,oS))?!1:(lS.crossVectors(zd,Vd),t=[lS.x,lS.y,lS.z],AR(t,N2,U2,k2,oS))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ec).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ec).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Qh[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Qh[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Qh[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Qh[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Qh[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Qh[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Qh[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Qh[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Qh),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Qh=[new se,new se,new se,new se,new se,new se,new se,new se],Ec=new se,aS=new ca,N2=new se,U2=new se,k2=new se,zd=new se,Vd=new se,kp=new se,_b=new se,oS=new se,lS=new se,Fp=new se;function AR(i,e,t,n,s){for(let r=0,a=i.length-3;r<=a;r+=3){Fp.fromArray(i,r);const o=s.x*Math.abs(Fp.x)+s.y*Math.abs(Fp.y)+s.z*Math.abs(Fp.z),l=e.dot(Fp),c=t.dot(Fp),h=n.dot(Fp);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>o)return!1}return!0}const fre=new ca,Sb=new se,ER=new se;class Kr{constructor(e=new se,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):fre.setFromPoints(e).getCenter(n);let s=0;for(let r=0,a=e.length;r<a;r++)s=Math.max(s,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Sb.subVectors(e,this.center);const t=Sb.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),s=(n-this.radius)*.5;this.center.addScaledVector(Sb,s/n),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(ER.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Sb.copy(e.center).add(ER)),this.expandByPoint(Sb.copy(e.center).sub(ER))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const $h=new se,_R=new se,cS=new se,Yd=new se,SR=new se,uS=new se,TR=new se;class Tg{constructor(e=new se,t=new se(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,$h)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=$h.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):($h.copy(this.origin).addScaledVector(this.direction,t),$h.distanceToSquared(e))}distanceSqToSegment(e,t,n,s){_R.copy(e).add(t).multiplyScalar(.5),cS.copy(t).sub(e).normalize(),Yd.copy(this.origin).sub(_R);const r=e.distanceTo(t)*.5,a=-this.direction.dot(cS),o=Yd.dot(this.direction),l=-Yd.dot(cS),c=Yd.lengthSq(),h=Math.abs(1-a*a);let d,m,y,x;if(h>0)if(d=a*l-o,m=a*o-l,x=r*h,d>=0)if(m>=-x)if(m<=x){const _=1/h;d*=_,m*=_,y=d*(d+a*m+2*o)+m*(a*d+m+2*l)+c}else m=r,d=Math.max(0,-(a*m+o)),y=-d*d+m*(m+2*l)+c;else m=-r,d=Math.max(0,-(a*m+o)),y=-d*d+m*(m+2*l)+c;else m<=-x?(d=Math.max(0,-(-a*r+o)),m=d>0?-r:Math.min(Math.max(-r,-l),r),y=-d*d+m*(m+2*l)+c):m<=x?(d=0,m=Math.min(Math.max(-r,-l),r),y=m*(m+2*l)+c):(d=Math.max(0,-(a*r+o)),m=d>0?r:Math.min(Math.max(-r,-l),r),y=-d*d+m*(m+2*l)+c);else m=a>0?-r:r,d=Math.max(0,-(a*m+o)),y=-d*d+m*(m+2*l)+c;return n&&n.copy(this.origin).addScaledVector(this.direction,d),s&&s.copy(_R).addScaledVector(cS,m),y}intersectSphere(e,t){$h.subVectors(e.center,this.origin);const n=$h.dot(this.direction),s=$h.dot($h)-n*n,r=e.radius*e.radius;if(s>r)return null;const a=Math.sqrt(r-s),o=n-a,l=n+a;return l<0?null:o<0?this.at(l,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,s,r,a,o,l;const c=1/this.direction.x,h=1/this.direction.y,d=1/this.direction.z,m=this.origin;return c>=0?(n=(e.min.x-m.x)*c,s=(e.max.x-m.x)*c):(n=(e.max.x-m.x)*c,s=(e.min.x-m.x)*c),h>=0?(r=(e.min.y-m.y)*h,a=(e.max.y-m.y)*h):(r=(e.max.y-m.y)*h,a=(e.min.y-m.y)*h),n>a||r>s||((r>n||isNaN(n))&&(n=r),(a<s||isNaN(s))&&(s=a),d>=0?(o=(e.min.z-m.z)*d,l=(e.max.z-m.z)*d):(o=(e.max.z-m.z)*d,l=(e.min.z-m.z)*d),n>l||o>s)||((o>n||n!==n)&&(n=o),(l<s||s!==s)&&(s=l),s<0)?null:this.at(n>=0?n:s,t)}intersectsBox(e){return this.intersectBox(e,$h)!==null}intersectTriangle(e,t,n,s,r){SR.subVectors(t,e),uS.subVectors(n,e),TR.crossVectors(SR,uS);let a=this.direction.dot(TR),o;if(a>0){if(s)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Yd.subVectors(this.origin,e);const l=o*this.direction.dot(uS.crossVectors(Yd,uS));if(l<0)return null;const c=o*this.direction.dot(SR.cross(Yd));if(c<0||l+c>a)return null;const h=-o*Yd.dot(TR);return h<0?null:this.at(h/a,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class hn{constructor(e,t,n,s,r,a,o,l,c,h,d,m,y,x,_,b){hn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,s,r,a,o,l,c,h,d,m,y,x,_,b)}set(e,t,n,s,r,a,o,l,c,h,d,m,y,x,_,b){const A=this.elements;return A[0]=e,A[4]=t,A[8]=n,A[12]=s,A[1]=r,A[5]=a,A[9]=o,A[13]=l,A[2]=c,A[6]=h,A[10]=d,A[14]=m,A[3]=y,A[7]=x,A[11]=_,A[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new hn().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,s=1/F2.setFromMatrixColumn(e,0).length(),r=1/F2.setFromMatrixColumn(e,1).length(),a=1/F2.setFromMatrixColumn(e,2).length();return t[0]=n[0]*s,t[1]=n[1]*s,t[2]=n[2]*s,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,s=e.y,r=e.z,a=Math.cos(n),o=Math.sin(n),l=Math.cos(s),c=Math.sin(s),h=Math.cos(r),d=Math.sin(r);if(e.order==="XYZ"){const m=a*h,y=a*d,x=o*h,_=o*d;t[0]=l*h,t[4]=-l*d,t[8]=c,t[1]=y+x*c,t[5]=m-_*c,t[9]=-o*l,t[2]=_-m*c,t[6]=x+y*c,t[10]=a*l}else if(e.order==="YXZ"){const m=l*h,y=l*d,x=c*h,_=c*d;t[0]=m+_*o,t[4]=x*o-y,t[8]=a*c,t[1]=a*d,t[5]=a*h,t[9]=-o,t[2]=y*o-x,t[6]=_+m*o,t[10]=a*l}else if(e.order==="ZXY"){const m=l*h,y=l*d,x=c*h,_=c*d;t[0]=m-_*o,t[4]=-a*d,t[8]=x+y*o,t[1]=y+x*o,t[5]=a*h,t[9]=_-m*o,t[2]=-a*c,t[6]=o,t[10]=a*l}else if(e.order==="ZYX"){const m=a*h,y=a*d,x=o*h,_=o*d;t[0]=l*h,t[4]=x*c-y,t[8]=m*c+_,t[1]=l*d,t[5]=_*c+m,t[9]=y*c-x,t[2]=-c,t[6]=o*l,t[10]=a*l}else if(e.order==="YZX"){const m=a*l,y=a*c,x=o*l,_=o*c;t[0]=l*h,t[4]=_-m*d,t[8]=x*d+y,t[1]=d,t[5]=a*h,t[9]=-o*h,t[2]=-c*h,t[6]=y*d+x,t[10]=m-_*d}else if(e.order==="XZY"){const m=a*l,y=a*c,x=o*l,_=o*c;t[0]=l*h,t[4]=-d,t[8]=c*h,t[1]=m*d+_,t[5]=a*h,t[9]=y*d-x,t[2]=x*d-y,t[6]=o*h,t[10]=_*d+m}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(dre,e,pre)}lookAt(e,t,n){const s=this.elements;return Yo.subVectors(e,t),Yo.lengthSq()===0&&(Yo.z=1),Yo.normalize(),Kd.crossVectors(n,Yo),Kd.lengthSq()===0&&(Math.abs(n.z)===1?Yo.x+=1e-4:Yo.z+=1e-4,Yo.normalize(),Kd.crossVectors(n,Yo)),Kd.normalize(),hS.crossVectors(Yo,Kd),s[0]=Kd.x,s[4]=hS.x,s[8]=Yo.x,s[1]=Kd.y,s[5]=hS.y,s[9]=Yo.y,s[2]=Kd.z,s[6]=hS.z,s[10]=Yo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,r=this.elements,a=n[0],o=n[4],l=n[8],c=n[12],h=n[1],d=n[5],m=n[9],y=n[13],x=n[2],_=n[6],b=n[10],A=n[14],T=n[3],w=n[7],R=n[11],O=n[15],N=s[0],U=s[4],P=s[8],B=s[12],L=s[1],F=s[5],j=s[9],J=s[13],re=s[2],q=s[6],W=s[10],ne=s[14],ie=s[3],ue=s[7],z=s[11],ae=s[15];return r[0]=a*N+o*L+l*re+c*ie,r[4]=a*U+o*F+l*q+c*ue,r[8]=a*P+o*j+l*W+c*z,r[12]=a*B+o*J+l*ne+c*ae,r[1]=h*N+d*L+m*re+y*ie,r[5]=h*U+d*F+m*q+y*ue,r[9]=h*P+d*j+m*W+y*z,r[13]=h*B+d*J+m*ne+y*ae,r[2]=x*N+_*L+b*re+A*ie,r[6]=x*U+_*F+b*q+A*ue,r[10]=x*P+_*j+b*W+A*z,r[14]=x*B+_*J+b*ne+A*ae,r[3]=T*N+w*L+R*re+O*ie,r[7]=T*U+w*F+R*q+O*ue,r[11]=T*P+w*j+R*W+O*z,r[15]=T*B+w*J+R*ne+O*ae,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],s=e[8],r=e[12],a=e[1],o=e[5],l=e[9],c=e[13],h=e[2],d=e[6],m=e[10],y=e[14],x=e[3],_=e[7],b=e[11],A=e[15];return x*(+r*l*d-s*c*d-r*o*m+n*c*m+s*o*y-n*l*y)+_*(+t*l*y-t*c*m+r*a*m-s*a*y+s*c*h-r*l*h)+b*(+t*c*d-t*o*y-r*a*d+n*a*y+r*o*h-n*c*h)+A*(-s*o*h-t*l*d+t*o*m+s*a*d-n*a*m+n*l*h)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],d=e[9],m=e[10],y=e[11],x=e[12],_=e[13],b=e[14],A=e[15],T=d*b*c-_*m*c+_*l*y-o*b*y-d*l*A+o*m*A,w=x*m*c-h*b*c-x*l*y+a*b*y+h*l*A-a*m*A,R=h*_*c-x*d*c+x*o*y-a*_*y-h*o*A+a*d*A,O=x*d*l-h*_*l-x*o*m+a*_*m+h*o*b-a*d*b,N=t*T+n*w+s*R+r*O;if(N===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const U=1/N;return e[0]=T*U,e[1]=(_*m*r-d*b*r-_*s*y+n*b*y+d*s*A-n*m*A)*U,e[2]=(o*b*r-_*l*r+_*s*c-n*b*c-o*s*A+n*l*A)*U,e[3]=(d*l*r-o*m*r-d*s*c+n*m*c+o*s*y-n*l*y)*U,e[4]=w*U,e[5]=(h*b*r-x*m*r+x*s*y-t*b*y-h*s*A+t*m*A)*U,e[6]=(x*l*r-a*b*r-x*s*c+t*b*c+a*s*A-t*l*A)*U,e[7]=(a*m*r-h*l*r+h*s*c-t*m*c-a*s*y+t*l*y)*U,e[8]=R*U,e[9]=(x*d*r-h*_*r-x*n*y+t*_*y+h*n*A-t*d*A)*U,e[10]=(a*_*r-x*o*r+x*n*c-t*_*c-a*n*A+t*o*A)*U,e[11]=(h*o*r-a*d*r-h*n*c+t*d*c+a*n*y-t*o*y)*U,e[12]=O*U,e[13]=(h*_*s-x*d*s+x*n*m-t*_*m-h*n*b+t*d*b)*U,e[14]=(x*o*s-a*_*s-x*n*l+t*_*l+a*n*b-t*o*b)*U,e[15]=(a*d*s-h*o*s+h*n*l-t*d*l-a*n*m+t*o*m)*U,this}scale(e){const t=this.elements,n=e.x,s=e.y,r=e.z;return t[0]*=n,t[4]*=s,t[8]*=r,t[1]*=n,t[5]*=s,t[9]*=r,t[2]*=n,t[6]*=s,t[10]*=r,t[3]*=n,t[7]*=s,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,s))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),s=Math.sin(t),r=1-n,a=e.x,o=e.y,l=e.z,c=r*a,h=r*o;return this.set(c*a+n,c*o-s*l,c*l+s*o,0,c*o+s*l,h*o+n,h*l-s*a,0,c*l-s*o,h*l+s*a,r*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,s,r,a){return this.set(1,n,r,0,e,1,a,0,t,s,1,0,0,0,0,1),this}compose(e,t,n){const s=this.elements,r=t._x,a=t._y,o=t._z,l=t._w,c=r+r,h=a+a,d=o+o,m=r*c,y=r*h,x=r*d,_=a*h,b=a*d,A=o*d,T=l*c,w=l*h,R=l*d,O=n.x,N=n.y,U=n.z;return s[0]=(1-(_+A))*O,s[1]=(y+R)*O,s[2]=(x-w)*O,s[3]=0,s[4]=(y-R)*N,s[5]=(1-(m+A))*N,s[6]=(b+T)*N,s[7]=0,s[8]=(x+w)*U,s[9]=(b-T)*U,s[10]=(1-(m+_))*U,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,n){const s=this.elements;let r=F2.set(s[0],s[1],s[2]).length();const a=F2.set(s[4],s[5],s[6]).length(),o=F2.set(s[8],s[9],s[10]).length();this.determinant()<0&&(r=-r),e.x=s[12],e.y=s[13],e.z=s[14],_c.copy(this);const c=1/r,h=1/a,d=1/o;return _c.elements[0]*=c,_c.elements[1]*=c,_c.elements[2]*=c,_c.elements[4]*=h,_c.elements[5]*=h,_c.elements[6]*=h,_c.elements[8]*=d,_c.elements[9]*=d,_c.elements[10]*=d,t.setFromRotationMatrix(_c),n.x=r,n.y=a,n.z=o,this}makePerspective(e,t,n,s,r,a,o=Ul){const l=this.elements,c=2*r/(t-e),h=2*r/(n-s),d=(t+e)/(t-e),m=(n+s)/(n-s);let y,x;if(o===Ul)y=-(a+r)/(a-r),x=-2*a*r/(a-r);else if(o===ZA)y=-a/(a-r),x=-a*r/(a-r);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return l[0]=c,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=h,l[9]=m,l[13]=0,l[2]=0,l[6]=0,l[10]=y,l[14]=x,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,s,r,a,o=Ul){const l=this.elements,c=1/(t-e),h=1/(n-s),d=1/(a-r),m=(t+e)*c,y=(n+s)*h;let x,_;if(o===Ul)x=(a+r)*d,_=-2*d;else if(o===ZA)x=r*d,_=-1*d;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-m,l[1]=0,l[5]=2*h,l[9]=0,l[13]=-y,l[2]=0,l[6]=0,l[10]=_,l[14]=-x,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<16;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const F2=new se,_c=new hn,dre=new se(0,0,0),pre=new se(1,1,1),Kd=new se,hS=new se,Yo=new se,jk=new hn,qk=new Yr;class il{constructor(e=0,t=0,n=0,s=il.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,s=this._order){return this._x=e,this._y=t,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const s=e.elements,r=s[0],a=s[4],o=s[8],l=s[1],c=s[5],h=s[9],d=s[2],m=s[6],y=s[10];switch(t){case"XYZ":this._y=Math.asin(Rn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-h,y),this._z=Math.atan2(-a,r)):(this._x=Math.atan2(m,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Rn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(o,y),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,r),this._z=0);break;case"ZXY":this._x=Math.asin(Rn(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-d,y),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,r));break;case"ZYX":this._y=Math.asin(-Rn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(m,y),this._z=Math.atan2(l,r)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(Rn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-d,r)):(this._x=0,this._y=Math.atan2(o,y));break;case"XZY":this._z=Math.asin(-Rn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(m,c),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-h,y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return jk.makeRotationFromQuaternion(e),this.setFromRotationMatrix(jk,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return qk.setFromEuler(this),this.setFromQuaternion(qk,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}il.DEFAULT_ORDER="XYZ";class Ov{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let mre=0;const Qk=new se,H2=new Yr,Jh=new hn,fS=new se,Tb=new se,gre=new se,yre=new Yr,$k=new se(1,0,0),Jk=new se(0,1,0),Zk=new se(0,0,1),eF={type:"added"},vre={type:"removed"},G2={type:"childadded",child:null},wR={type:"childremoved",child:null};class li extends sl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:mre++}),this.uuid=tl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=li.DEFAULT_UP.clone();const e=new se,t=new il,n=new Yr,s=new se(1,1,1);function r(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(r),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new hn},normalMatrix:{value:new Bn}}),this.matrix=new hn,this.matrixWorld=new hn,this.matrixAutoUpdate=li.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=li.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Ov,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return H2.setFromAxisAngle(e,t),this.quaternion.multiply(H2),this}rotateOnWorldAxis(e,t){return H2.setFromAxisAngle(e,t),this.quaternion.premultiply(H2),this}rotateX(e){return this.rotateOnAxis($k,e)}rotateY(e){return this.rotateOnAxis(Jk,e)}rotateZ(e){return this.rotateOnAxis(Zk,e)}translateOnAxis(e,t){return Qk.copy(e).applyQuaternion(this.quaternion),this.position.add(Qk.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis($k,e)}translateY(e){return this.translateOnAxis(Jk,e)}translateZ(e){return this.translateOnAxis(Zk,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Jh.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?fS.copy(e):fS.set(e,t,n);const s=this.parent;this.updateWorldMatrix(!0,!1),Tb.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Jh.lookAt(Tb,fS,this.up):Jh.lookAt(fS,Tb,this.up),this.quaternion.setFromRotationMatrix(Jh),s&&(Jh.extractRotation(s.matrixWorld),H2.setFromRotationMatrix(Jh),this.quaternion.premultiply(H2.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(eF),G2.child=e,this.dispatchEvent(G2),G2.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(vre),wR.child=e,this.dispatchEvent(wR),wR.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Jh.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Jh.multiply(e.parent.matrixWorld)),e.applyMatrix4(Jh),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(eF),G2.child=e,this.dispatchEvent(G2),G2.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,s=this.children.length;n<s;n++){const a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const s=this.children;for(let r=0,a=s.length;r<a;r++)s[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Tb,e,gre),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Tb,yre,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const s=this.children;for(let r=0,a=s.length;r<a;r++)s[r].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?{min:o.boundingBox.min.toArray(),max:o.boundingBox.max.toArray()}:void 0,boundingSphere:o.boundingSphere?{radius:o.boundingSphere.radius,center:o.boundingSphere.center.toArray()}:void 0})),s.instanceInfo=this._instanceInfo.map(o=>({...o})),s.availableInstanceIds=this._availableInstanceIds.slice(),s.availableGeometryIds=this._availableGeometryIds.slice(),s.nextIndexStart=this._nextIndexStart,s.nextVertexStart=this._nextVertexStart,s.geometryCount=this._geometryCount,s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.matricesTexture=this._matricesTexture.toJSON(e),s.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}));function r(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=r(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let c=0,h=l.length;c<h;c++){const d=l[c];r(e.shapes,d)}else r(e.shapes,l)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,c=this.material.length;l<c;l++)o.push(r(e.materials,this.material[l]));s.material=o}else s.material=r(e.materials,this.material);if(this.children.length>0){s.children=[];for(let o=0;o<this.children.length;o++)s.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];s.animations.push(r(e.animations,l))}}if(t){const o=a(e.geometries),l=a(e.materials),c=a(e.textures),h=a(e.images),d=a(e.shapes),m=a(e.skeletons),y=a(e.animations),x=a(e.nodes);o.length>0&&(n.geometries=o),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),h.length>0&&(n.images=h),d.length>0&&(n.shapes=d),m.length>0&&(n.skeletons=m),y.length>0&&(n.animations=y),x.length>0&&(n.nodes=x)}return n.object=s,n;function a(o){const l=[];for(const c in o){const h=o[c];delete h.metadata,l.push(h)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const s=e.children[n];this.add(s.clone())}return this}}li.DEFAULT_UP=new se(0,1,0);li.DEFAULT_MATRIX_AUTO_UPDATE=!0;li.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Sc=new se,Zh=new se,MR=new se,ef=new se,z2=new se,V2=new se,tF=new se,CR=new se,RR=new se,DR=new se,LR=new ai,IR=new ai,BR=new ai;class wo{constructor(e=new se,t=new se,n=new se){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,s){s.subVectors(n,t),Sc.subVectors(e,t),s.cross(Sc);const r=s.lengthSq();return r>0?s.multiplyScalar(1/Math.sqrt(r)):s.set(0,0,0)}static getBarycoord(e,t,n,s,r){Sc.subVectors(s,t),Zh.subVectors(n,t),MR.subVectors(e,t);const a=Sc.dot(Sc),o=Sc.dot(Zh),l=Sc.dot(MR),c=Zh.dot(Zh),h=Zh.dot(MR),d=a*c-o*o;if(d===0)return r.set(0,0,0),null;const m=1/d,y=(c*l-o*h)*m,x=(a*h-o*l)*m;return r.set(1-y-x,x,y)}static containsPoint(e,t,n,s){return this.getBarycoord(e,t,n,s,ef)===null?!1:ef.x>=0&&ef.y>=0&&ef.x+ef.y<=1}static getInterpolation(e,t,n,s,r,a,o,l){return this.getBarycoord(e,t,n,s,ef)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(r,ef.x),l.addScaledVector(a,ef.y),l.addScaledVector(o,ef.z),l)}static getInterpolatedAttribute(e,t,n,s,r,a){return LR.setScalar(0),IR.setScalar(0),BR.setScalar(0),LR.fromBufferAttribute(e,t),IR.fromBufferAttribute(e,n),BR.fromBufferAttribute(e,s),a.setScalar(0),a.addScaledVector(LR,r.x),a.addScaledVector(IR,r.y),a.addScaledVector(BR,r.z),a}static isFrontFacing(e,t,n,s){return Sc.subVectors(n,t),Zh.subVectors(e,t),Sc.cross(Zh).dot(s)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,s){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,n,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Sc.subVectors(this.c,this.b),Zh.subVectors(this.a,this.b),Sc.cross(Zh).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return wo.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return wo.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,s,r){return wo.getInterpolation(e,this.a,this.b,this.c,t,n,s,r)}containsPoint(e){return wo.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return wo.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,s=this.b,r=this.c;let a,o;z2.subVectors(s,n),V2.subVectors(r,n),CR.subVectors(e,n);const l=z2.dot(CR),c=V2.dot(CR);if(l<=0&&c<=0)return t.copy(n);RR.subVectors(e,s);const h=z2.dot(RR),d=V2.dot(RR);if(h>=0&&d<=h)return t.copy(s);const m=l*d-h*c;if(m<=0&&l>=0&&h<=0)return a=l/(l-h),t.copy(n).addScaledVector(z2,a);DR.subVectors(e,r);const y=z2.dot(DR),x=V2.dot(DR);if(x>=0&&y<=x)return t.copy(r);const _=y*c-l*x;if(_<=0&&c>=0&&x<=0)return o=c/(c-x),t.copy(n).addScaledVector(V2,o);const b=h*x-y*d;if(b<=0&&d-h>=0&&y-x>=0)return tF.subVectors(r,s),o=(d-h)/(d-h+(y-x)),t.copy(s).addScaledVector(tF,o);const A=1/(b+_+m);return a=_*A,o=m*A,t.copy(n).addScaledVector(z2,a).addScaledVector(V2,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const y9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Wd={h:0,s:0,l:0},dS={h:0,s:0,l:0};function OR(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}let Ut=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=bi){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ri.toWorkingColorSpace(this,t),this}setRGB(e,t,n,s=ri.workingColorSpace){return this.r=e,this.g=t,this.b=n,ri.toWorkingColorSpace(this,s),this}setHSL(e,t,n,s=ri.workingColorSpace){if(e=GB(e,1),t=Rn(t,0,1),n=Rn(n,0,1),t===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,a=2*n-r;this.r=OR(a,r,e+1/3),this.g=OR(a,r,e),this.b=OR(a,r,e-1/3)}return ri.toWorkingColorSpace(this,s),this}setStyle(e,t=bi){function n(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const a=s[1],o=s[2];switch(a){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=s[1],a=r.length;if(a===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(r,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=bi){const n=y9[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Hf(e.r),this.g=Hf(e.g),this.b=Hf(e.b),this}copyLinearToSRGB(e){return this.r=wy(e.r),this.g=wy(e.g),this.b=wy(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=bi){return ri.fromWorkingColorSpace(Sa.copy(this),e),Math.round(Rn(Sa.r*255,0,255))*65536+Math.round(Rn(Sa.g*255,0,255))*256+Math.round(Rn(Sa.b*255,0,255))}getHexString(e=bi){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=ri.workingColorSpace){ri.fromWorkingColorSpace(Sa.copy(this),t);const n=Sa.r,s=Sa.g,r=Sa.b,a=Math.max(n,s,r),o=Math.min(n,s,r);let l,c;const h=(o+a)/2;if(o===a)l=0,c=0;else{const d=a-o;switch(c=h<=.5?d/(a+o):d/(2-a-o),a){case n:l=(s-r)/d+(s<r?6:0);break;case s:l=(r-n)/d+2;break;case r:l=(n-s)/d+4;break}l/=6}return e.h=l,e.s=c,e.l=h,e}getRGB(e,t=ri.workingColorSpace){return ri.fromWorkingColorSpace(Sa.copy(this),t),e.r=Sa.r,e.g=Sa.g,e.b=Sa.b,e}getStyle(e=bi){ri.fromWorkingColorSpace(Sa.copy(this),e);const t=Sa.r,n=Sa.g,s=Sa.b;return e!==bi?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(s*255)})`}offsetHSL(e,t,n){return this.getHSL(Wd),this.setHSL(Wd.h+e,Wd.s+t,Wd.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Wd),e.getHSL(dS);const n=gA(Wd.h,dS.h,t),s=gA(Wd.s,dS.s,t),r=gA(Wd.l,dS.l,t);return this.setHSL(n,s,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,s=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*s,this.g=r[1]*t+r[4]*n+r[7]*s,this.b=r[2]*t+r[5]*n+r[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Sa=new Ut;Ut.NAMES=y9;let xre=0;class ur extends sl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:xre++}),this.uuid=tl(),this.name="",this.type="Material",this.blending=Jm,this.side=qc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=E3,this.blendDst=_3,this.blendEquation=r0,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ut(0,0,0),this.blendAlpha=0,this.depthFunc=ug,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=qL,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=am,this.stencilZFail=am,this.stencilZPass=am,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(n):s&&s.isVector3&&n&&n.isVector3?s.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Jm&&(n.blending=this.blending),this.side!==qc&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==E3&&(n.blendSrc=this.blendSrc),this.blendDst!==_3&&(n.blendDst=this.blendDst),this.blendEquation!==r0&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==ug&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==qL&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==am&&(n.stencilFail=this.stencilFail),this.stencilZFail!==am&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==am&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function s(r){const a=[];for(const o in r){const l=r[o];delete l.metadata,a.push(l)}return a}if(t){const r=s(e.textures),a=s(e.images);r.length>0&&(n.textures=r),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const s=t.length;n=new Array(s);for(let r=0;r!==s;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Co extends ur{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new il,this.combine=UE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Lf=bre();function bre(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),s=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(n[l]=0,n[l|256]=32768,s[l]=24,s[l|256]=24):c<-14?(n[l]=1024>>-c-14,n[l|256]=1024>>-c-14|32768,s[l]=-c-1,s[l|256]=-c-1):c<=15?(n[l]=c+15<<10,n[l|256]=c+15<<10|32768,s[l]=13,s[l|256]=13):c<128?(n[l]=31744,n[l|256]=64512,s[l]=24,s[l|256]=24):(n[l]=31744,n[l|256]=64512,s[l]=13,s[l|256]=13)}const r=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,h=0;for(;(c&8388608)===0;)c<<=1,h-=8388608;c&=-8388609,h+=947912704,r[l]=c|h}for(let l=1024;l<2048;++l)r[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(o[l]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:s,mantissaTable:r,exponentTable:a,offsetTable:o}}function bo(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=Rn(i,-65504,65504),Lf.floatView[0]=i;const e=Lf.uint32View[0],t=e>>23&511;return Lf.baseTable[t]+((e&8388607)>>Lf.shiftTable[t])}function Jb(i){const e=i>>10;return Lf.uint32View[0]=Lf.mantissaTable[Lf.offsetTable[e]+(i&1023)]+Lf.exponentTable[e],Lf.floatView[0]}class _m{static toHalfFloat(e){return bo(e)}static fromHalfFloat(e){return Jb(e)}}const mr=new se,pS=new Qe;let Are=0;class ci{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Are++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=JA,this.updateRanges=[],this.gpuType=ps,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let s=0,r=this.itemSize;s<r;s++)this.array[e+s]=t.array[n+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)pS.fromBufferAttribute(this,t),pS.applyMatrix3(e),this.setXY(t,pS.x,pS.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)mr.fromBufferAttribute(this,t),mr.applyMatrix3(e),this.setXYZ(t,mr.x,mr.y,mr.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)mr.fromBufferAttribute(this,t),mr.applyMatrix4(e),this.setXYZ(t,mr.x,mr.y,mr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)mr.fromBufferAttribute(this,t),mr.applyNormalMatrix(e),this.setXYZ(t,mr.x,mr.y,mr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)mr.fromBufferAttribute(this,t),mr.transformDirection(e),this.setXYZ(t,mr.x,mr.y,mr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Qa(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=On(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Qa(t,this.array)),t}setX(e,t){return this.normalized&&(t=On(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Qa(t,this.array)),t}setY(e,t){return this.normalized&&(t=On(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Qa(t,this.array)),t}setZ(e,t){return this.normalized&&(t=On(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Qa(t,this.array)),t}setW(e,t){return this.normalized&&(t=On(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=On(t,this.array),n=On(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=On(t,this.array),n=On(n,this.array),s=On(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this}setXYZW(e,t,n,s,r){return e*=this.itemSize,this.normalized&&(t=On(t,this.array),n=On(n,this.array),s=On(s,this.array),r=On(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==JA&&(e.usage=this.usage),e}}class Ere extends ci{constructor(e,t,n){super(new Int8Array(e),t,n)}}class _re extends ci{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class Sre extends ci{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class Tre extends ci{constructor(e,t,n){super(new Int16Array(e),t,n)}}class zB extends ci{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class wre extends ci{constructor(e,t,n){super(new Int32Array(e),t,n)}}class VB extends ci{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Mre extends ci{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=Jb(this.array[e*this.itemSize]);return this.normalized&&(t=Qa(t,this.array)),t}setX(e,t){return this.normalized&&(t=On(t,this.array)),this.array[e*this.itemSize]=bo(t),this}getY(e){let t=Jb(this.array[e*this.itemSize+1]);return this.normalized&&(t=Qa(t,this.array)),t}setY(e,t){return this.normalized&&(t=On(t,this.array)),this.array[e*this.itemSize+1]=bo(t),this}getZ(e){let t=Jb(this.array[e*this.itemSize+2]);return this.normalized&&(t=Qa(t,this.array)),t}setZ(e,t){return this.normalized&&(t=On(t,this.array)),this.array[e*this.itemSize+2]=bo(t),this}getW(e){let t=Jb(this.array[e*this.itemSize+3]);return this.normalized&&(t=Qa(t,this.array)),t}setW(e,t){return this.normalized&&(t=On(t,this.array)),this.array[e*this.itemSize+3]=bo(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=On(t,this.array),n=On(n,this.array)),this.array[e+0]=bo(t),this.array[e+1]=bo(n),this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=On(t,this.array),n=On(n,this.array),s=On(s,this.array)),this.array[e+0]=bo(t),this.array[e+1]=bo(n),this.array[e+2]=bo(s),this}setXYZW(e,t,n,s,r){return e*=this.itemSize,this.normalized&&(t=On(t,this.array),n=On(n,this.array),s=On(s,this.array),r=On(r,this.array)),this.array[e+0]=bo(t),this.array[e+1]=bo(n),this.array[e+2]=bo(s),this.array[e+3]=bo(r),this}}class Qt extends ci{constructor(e,t,n){super(new Float32Array(e),t,n)}}let Cre=0;const _l=new hn,PR=new li,Y2=new se,Ko=new ca,wb=new ca,Fr=new se;class Tn extends sl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Cre++}),this.uuid=tl(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(p9(e)?VB:zB)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const r=new Bn().getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return _l.makeRotationFromQuaternion(e),this.applyMatrix4(_l),this}rotateX(e){return _l.makeRotationX(e),this.applyMatrix4(_l),this}rotateY(e){return _l.makeRotationY(e),this.applyMatrix4(_l),this}rotateZ(e){return _l.makeRotationZ(e),this.applyMatrix4(_l),this}translate(e,t,n){return _l.makeTranslation(e,t,n),this.applyMatrix4(_l),this}scale(e,t,n){return _l.makeScale(e,t,n),this.applyMatrix4(_l),this}lookAt(e){return PR.lookAt(e),PR.updateMatrix(),this.applyMatrix4(PR.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Y2).negate(),this.translate(Y2.x,Y2.y,Y2.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let s=0,r=e.length;s<r;s++){const a=e[s];n.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Qt(n,3))}else{const n=Math.min(e.length,t.count);for(let s=0;s<n;s++){const r=e[s];t.setXYZ(s,r.x,r.y,r.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ca);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new se(-1/0,-1/0,-1/0),new se(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++){const r=t[n];Ko.setFromBufferAttribute(r),this.morphTargetsRelative?(Fr.addVectors(this.boundingBox.min,Ko.min),this.boundingBox.expandByPoint(Fr),Fr.addVectors(this.boundingBox.max,Ko.max),this.boundingBox.expandByPoint(Fr)):(this.boundingBox.expandByPoint(Ko.min),this.boundingBox.expandByPoint(Ko.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Kr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new se,1/0);return}if(e){const n=this.boundingSphere.center;if(Ko.setFromBufferAttribute(e),t)for(let r=0,a=t.length;r<a;r++){const o=t[r];wb.setFromBufferAttribute(o),this.morphTargetsRelative?(Fr.addVectors(Ko.min,wb.min),Ko.expandByPoint(Fr),Fr.addVectors(Ko.max,wb.max),Ko.expandByPoint(Fr)):(Ko.expandByPoint(wb.min),Ko.expandByPoint(wb.max))}Ko.getCenter(n);let s=0;for(let r=0,a=e.count;r<a;r++)Fr.fromBufferAttribute(e,r),s=Math.max(s,n.distanceToSquared(Fr));if(t)for(let r=0,a=t.length;r<a;r++){const o=t[r],l=this.morphTargetsRelative;for(let c=0,h=o.count;c<h;c++)Fr.fromBufferAttribute(o,c),l&&(Y2.fromBufferAttribute(e,c),Fr.add(Y2)),s=Math.max(s,n.distanceToSquared(Fr))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,s=t.normal,r=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ci(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),o=[],l=[];for(let P=0;P<n.count;P++)o[P]=new se,l[P]=new se;const c=new se,h=new se,d=new se,m=new Qe,y=new Qe,x=new Qe,_=new se,b=new se;function A(P,B,L){c.fromBufferAttribute(n,P),h.fromBufferAttribute(n,B),d.fromBufferAttribute(n,L),m.fromBufferAttribute(r,P),y.fromBufferAttribute(r,B),x.fromBufferAttribute(r,L),h.sub(c),d.sub(c),y.sub(m),x.sub(m);const F=1/(y.x*x.y-x.x*y.y);isFinite(F)&&(_.copy(h).multiplyScalar(x.y).addScaledVector(d,-y.y).multiplyScalar(F),b.copy(d).multiplyScalar(y.x).addScaledVector(h,-x.x).multiplyScalar(F),o[P].add(_),o[B].add(_),o[L].add(_),l[P].add(b),l[B].add(b),l[L].add(b))}let T=this.groups;T.length===0&&(T=[{start:0,count:e.count}]);for(let P=0,B=T.length;P<B;++P){const L=T[P],F=L.start,j=L.count;for(let J=F,re=F+j;J<re;J+=3)A(e.getX(J+0),e.getX(J+1),e.getX(J+2))}const w=new se,R=new se,O=new se,N=new se;function U(P){O.fromBufferAttribute(s,P),N.copy(O);const B=o[P];w.copy(B),w.sub(O.multiplyScalar(O.dot(B))).normalize(),R.crossVectors(N,B);const F=R.dot(l[P])<0?-1:1;a.setXYZW(P,w.x,w.y,w.z,F)}for(let P=0,B=T.length;P<B;++P){const L=T[P],F=L.start,j=L.count;for(let J=F,re=F+j;J<re;J+=3)U(e.getX(J+0)),U(e.getX(J+1)),U(e.getX(J+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new ci(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let m=0,y=n.count;m<y;m++)n.setXYZ(m,0,0,0);const s=new se,r=new se,a=new se,o=new se,l=new se,c=new se,h=new se,d=new se;if(e)for(let m=0,y=e.count;m<y;m+=3){const x=e.getX(m+0),_=e.getX(m+1),b=e.getX(m+2);s.fromBufferAttribute(t,x),r.fromBufferAttribute(t,_),a.fromBufferAttribute(t,b),h.subVectors(a,r),d.subVectors(s,r),h.cross(d),o.fromBufferAttribute(n,x),l.fromBufferAttribute(n,_),c.fromBufferAttribute(n,b),o.add(h),l.add(h),c.add(h),n.setXYZ(x,o.x,o.y,o.z),n.setXYZ(_,l.x,l.y,l.z),n.setXYZ(b,c.x,c.y,c.z)}else for(let m=0,y=t.count;m<y;m+=3)s.fromBufferAttribute(t,m+0),r.fromBufferAttribute(t,m+1),a.fromBufferAttribute(t,m+2),h.subVectors(a,r),d.subVectors(s,r),h.cross(d),n.setXYZ(m+0,h.x,h.y,h.z),n.setXYZ(m+1,h.x,h.y,h.z),n.setXYZ(m+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Fr.fromBufferAttribute(e,t),Fr.normalize(),e.setXYZ(t,Fr.x,Fr.y,Fr.z)}toNonIndexed(){function e(o,l){const c=o.array,h=o.itemSize,d=o.normalized,m=new c.constructor(l.length*h);let y=0,x=0;for(let _=0,b=l.length;_<b;_++){o.isInterleavedBufferAttribute?y=l[_]*o.data.stride+o.offset:y=l[_]*h;for(let A=0;A<h;A++)m[x++]=c[y++]}return new ci(m,h,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Tn,n=this.index.array,s=this.attributes;for(const o in s){const l=s[o],c=e(l,n);t.setAttribute(o,c)}const r=this.morphAttributes;for(const o in r){const l=[],c=r[o];for(let h=0,d=c.length;h<d;h++){const m=c[h],y=e(m,n);l.push(y)}t.morphAttributes[o]=l}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const c=a[o];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n){const c=n[l];e.data.attributes[l]=c.toJSON(e.data)}const s={};let r=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],h=[];for(let d=0,m=c.length;d<m;d++){const y=c[d];h.push(y.toJSON(e.data))}h.length>0&&(s[l]=h,r=!0)}r&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const s=e.attributes;for(const c in s){const h=s[c];this.setAttribute(c,h.clone(t))}const r=e.morphAttributes;for(const c in r){const h=[],d=r[c];for(let m=0,y=d.length;m<y;m++)h.push(d[m].clone(t));this.morphAttributes[c]=h}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let c=0,h=a.length;c<h;c++){const d=a[c];this.addGroup(d.start,d.count,d.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const nF=new hn,Hp=new Tg,mS=new Kr,iF=new se,gS=new se,yS=new se,vS=new se,NR=new se,xS=new se,sF=new se,bS=new se;class ms extends li{constructor(e=new Tn,t=new Co){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,a=s.length;r<a;r++){const o=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}getVertexPosition(e,t){const n=this.geometry,s=n.attributes.position,r=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(s,e);const o=this.morphTargetInfluences;if(r&&o){xS.set(0,0,0);for(let l=0,c=r.length;l<c;l++){const h=o[l],d=r[l];h!==0&&(NR.fromBufferAttribute(d,e),a?xS.addScaledVector(NR,h):xS.addScaledVector(NR.sub(t),h))}t.add(xS)}return t}raycast(e,t){const n=this.geometry,s=this.material,r=this.matrixWorld;s!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),mS.copy(n.boundingSphere),mS.applyMatrix4(r),Hp.copy(e.ray).recast(e.near),!(mS.containsPoint(Hp.origin)===!1&&(Hp.intersectSphere(mS,iF)===null||Hp.origin.distanceToSquared(iF)>(e.far-e.near)**2))&&(nF.copy(r).invert(),Hp.copy(e.ray).applyMatrix4(nF),!(n.boundingBox!==null&&Hp.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Hp)))}_computeIntersections(e,t,n){let s;const r=this.geometry,a=this.material,o=r.index,l=r.attributes.position,c=r.attributes.uv,h=r.attributes.uv1,d=r.attributes.normal,m=r.groups,y=r.drawRange;if(o!==null)if(Array.isArray(a))for(let x=0,_=m.length;x<_;x++){const b=m[x],A=a[b.materialIndex],T=Math.max(b.start,y.start),w=Math.min(o.count,Math.min(b.start+b.count,y.start+y.count));for(let R=T,O=w;R<O;R+=3){const N=o.getX(R),U=o.getX(R+1),P=o.getX(R+2);s=AS(this,A,e,n,c,h,d,N,U,P),s&&(s.faceIndex=Math.floor(R/3),s.face.materialIndex=b.materialIndex,t.push(s))}}else{const x=Math.max(0,y.start),_=Math.min(o.count,y.start+y.count);for(let b=x,A=_;b<A;b+=3){const T=o.getX(b),w=o.getX(b+1),R=o.getX(b+2);s=AS(this,a,e,n,c,h,d,T,w,R),s&&(s.faceIndex=Math.floor(b/3),t.push(s))}}else if(l!==void 0)if(Array.isArray(a))for(let x=0,_=m.length;x<_;x++){const b=m[x],A=a[b.materialIndex],T=Math.max(b.start,y.start),w=Math.min(l.count,Math.min(b.start+b.count,y.start+y.count));for(let R=T,O=w;R<O;R+=3){const N=R,U=R+1,P=R+2;s=AS(this,A,e,n,c,h,d,N,U,P),s&&(s.faceIndex=Math.floor(R/3),s.face.materialIndex=b.materialIndex,t.push(s))}}else{const x=Math.max(0,y.start),_=Math.min(l.count,y.start+y.count);for(let b=x,A=_;b<A;b+=3){const T=b,w=b+1,R=b+2;s=AS(this,a,e,n,c,h,d,T,w,R),s&&(s.faceIndex=Math.floor(b/3),t.push(s))}}}}function Rre(i,e,t,n,s,r,a,o){let l;if(e.side===wr?l=n.intersectTriangle(a,r,s,!0,o):l=n.intersectTriangle(s,r,a,e.side===qc,o),l===null)return null;bS.copy(o),bS.applyMatrix4(i.matrixWorld);const c=t.ray.origin.distanceTo(bS);return c<t.near||c>t.far?null:{distance:c,point:bS.clone(),object:i}}function AS(i,e,t,n,s,r,a,o,l,c){i.getVertexPosition(o,gS),i.getVertexPosition(l,yS),i.getVertexPosition(c,vS);const h=Rre(i,e,t,n,gS,yS,vS,sF);if(h){const d=new se;wo.getBarycoord(sF,gS,yS,vS,d),s&&(h.uv=wo.getInterpolatedAttribute(s,o,l,c,d,new Qe)),r&&(h.uv1=wo.getInterpolatedAttribute(r,o,l,c,d,new Qe)),a&&(h.normal=wo.getInterpolatedAttribute(a,o,l,c,d,new se),h.normal.dot(n.direction)>0&&h.normal.multiplyScalar(-1));const m={a:o,b:l,c,normal:new se,materialIndex:0};wo.getNormal(gS,yS,vS,m.normal),h.face=m,h.barycoord=d}return h}class wg extends Tn{constructor(e=1,t=1,n=1,s=1,r=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:s,heightSegments:r,depthSegments:a};const o=this;s=Math.floor(s),r=Math.floor(r),a=Math.floor(a);const l=[],c=[],h=[],d=[];let m=0,y=0;x("z","y","x",-1,-1,n,t,e,a,r,0),x("z","y","x",1,-1,n,t,-e,a,r,1),x("x","z","y",1,1,e,n,t,s,a,2),x("x","z","y",1,-1,e,n,-t,s,a,3),x("x","y","z",1,-1,e,t,n,s,r,4),x("x","y","z",-1,-1,e,t,-n,s,r,5),this.setIndex(l),this.setAttribute("position",new Qt(c,3)),this.setAttribute("normal",new Qt(h,3)),this.setAttribute("uv",new Qt(d,2));function x(_,b,A,T,w,R,O,N,U,P,B){const L=R/U,F=O/P,j=R/2,J=O/2,re=N/2,q=U+1,W=P+1;let ne=0,ie=0;const ue=new se;for(let z=0;z<W;z++){const ae=z*F-J;for(let ge=0;ge<q;ge++){const Ee=ge*L-j;ue[_]=Ee*T,ue[b]=ae*w,ue[A]=re,c.push(ue.x,ue.y,ue.z),ue[_]=0,ue[b]=0,ue[A]=N>0?1:-1,h.push(ue.x,ue.y,ue.z),d.push(ge/U),d.push(1-z/P),ne+=1}}for(let z=0;z<P;z++)for(let ae=0;ae<U;ae++){const ge=m+ae+q*z,Ee=m+ae+q*(z+1),le=m+(ae+1)+q*(z+1),Ce=m+(ae+1)+q*z;l.push(ge,Ee,Ce),l.push(Ee,le,Ce),ie+=6}o.addGroup(y,ie,B),y+=ie,m+=ne}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wg(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Pv(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const s=i[t][n];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=s.clone():Array.isArray(s)?e[t][n]=s.slice():e[t][n]=s}}return e}function Ya(i){const e={};for(let t=0;t<i.length;t++){const n=Pv(i[t]);for(const s in n)e[s]=n[s]}return e}function Dre(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function v9(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:ri.workingColorSpace}const x9={clone:Pv,merge:Ya};var Lre=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Ire=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class js extends ur{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Lre,this.fragmentShader=Ire,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Pv(e.uniforms),this.uniformsGroups=Dre(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const a=this.uniforms[s].value;a&&a.isTexture?t.uniforms[s]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[s]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[s]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[s]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[s]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[s]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[s]={type:"m4",value:a.toArray()}:t.uniforms[s]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const s in this.extensions)this.extensions[s]===!0&&(n[s]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class zE extends li{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new hn,this.projectionMatrix=new hn,this.projectionMatrixInverse=new hn,this.coordinateSystem=Ul}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Xd=new se,rF=new Qe,aF=new Qe;let Ds=class extends zE{constructor(e=50,t=1,n=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Bv*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Zm*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Bv*2*Math.atan(Math.tan(Zm*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Xd.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Xd.x,Xd.y).multiplyScalar(-e/Xd.z),Xd.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Xd.x,Xd.y).multiplyScalar(-e/Xd.z)}getViewSize(e,t){return this.getViewBounds(e,rF,aF),t.subVectors(aF,rF)}setViewOffset(e,t,n,s,r,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Zm*.5*this.fov)/this.zoom,n=2*t,s=this.aspect*n,r=-.5*s;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,c=a.fullHeight;r+=a.offsetX*s/l,t-=a.offsetY*n/c,s*=a.width/l,n*=a.height/c}const o=this.filmOffset;o!==0&&(r+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+s,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const K2=-90,W2=1;class b9 extends li{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new Ds(K2,W2,e,t);s.layers=this.layers,this.add(s);const r=new Ds(K2,W2,e,t);r.layers=this.layers,this.add(r);const a=new Ds(K2,W2,e,t);a.layers=this.layers,this.add(a);const o=new Ds(K2,W2,e,t);o.layers=this.layers,this.add(o);const l=new Ds(K2,W2,e,t);l.layers=this.layers,this.add(l);const c=new Ds(K2,W2,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,s,r,a,o,l]=t;for(const c of t)this.remove(c);if(e===Ul)n.up.set(0,1,0),n.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===ZA)n.up.set(0,-1,0),n.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,a,o,l,c,h]=this.children,d=e.getRenderTarget(),m=e.getActiveCubeFace(),y=e.getActiveMipmapLevel(),x=e.xr.enabled;e.xr.enabled=!1;const _=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,s),e.render(t,r),e.setRenderTarget(n,1,s),e.render(t,a),e.setRenderTarget(n,2,s),e.render(t,o),e.setRenderTarget(n,3,s),e.render(t,l),e.setRenderTarget(n,4,s),e.render(t,c),n.texture.generateMipmaps=_,e.setRenderTarget(n,5,s),e.render(t,h),e.setRenderTarget(d,m,y),e.xr.enabled=x,n.texture.needsPMREMUpdate=!0}}class VE extends wi{constructor(e=[],t=gh,n,s,r,a,o,l,c,h){super(e,t,n,s,r,a,o,l,c,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class YB extends Os{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},s=[n,n,n,n,n,n];this.texture=new VE(s,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:ei}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new wg(5,5,5),r=new js({name:"CubemapFromEquirect",uniforms:Pv(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:wr,blending:la});r.uniforms.tEquirect.value=t;const a=new ms(s,r),o=t.minFilter;return t.minFilter===Nl&&(t.minFilter=ei),new b9(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,n=!0,s=!0){const r=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,s);e.setRenderTarget(r)}}class Of extends li{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Bre={type:"move"};class zT{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Of,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Of,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new se,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new se),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Of,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new se,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new se),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let s=null,r=null,a=null;const o=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){a=!0;for(const _ of e.hand.values()){const b=t.getJointPose(_,n),A=this._getHandJoint(c,_);b!==null&&(A.matrix.fromArray(b.transform.matrix),A.matrix.decompose(A.position,A.rotation,A.scale),A.matrixWorldNeedsUpdate=!0,A.jointRadius=b.radius),A.visible=b!==null}const h=c.joints["index-finger-tip"],d=c.joints["thumb-tip"],m=h.position.distanceTo(d.position),y=.02,x=.005;c.inputState.pinching&&m>y+x?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&m<=y-x&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),r!==null&&(l.matrix.fromArray(r.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,r.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(r.linearVelocity)):l.hasLinearVelocity=!1,r.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(r.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(s=t.getPose(e.targetRaySpace,n),s===null&&r!==null&&(s=r),s!==null&&(o.matrix.fromArray(s.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,s.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(s.linearVelocity)):o.hasLinearVelocity=!1,s.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(s.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Bre)))}return o!==null&&(o.visible=s!==null),l!==null&&(l.visible=r!==null),c!==null&&(c.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Of;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class cM{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ut(e),this.density=t}clone(){return new cM(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class uM{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Ut(e),this.near=t,this.far=n}clone(){return new uM(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class dg extends li{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new il,this.environmentIntensity=1,this.environmentRotation=new il,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class YE{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=JA,this.updateRanges=[],this.version=0,this.uuid=tl()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let s=0,r=this.stride;s<r;s++)this.array[e+s]=t.array[n+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=tl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=tl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Va=new se;class k0{constructor(e,t,n,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Va.fromBufferAttribute(this,t),Va.applyMatrix4(e),this.setXYZ(t,Va.x,Va.y,Va.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Va.fromBufferAttribute(this,t),Va.applyNormalMatrix(e),this.setXYZ(t,Va.x,Va.y,Va.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Va.fromBufferAttribute(this,t),Va.transformDirection(e),this.setXYZ(t,Va.x,Va.y,Va.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=Qa(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=On(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=On(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=On(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=On(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=On(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Qa(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Qa(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Qa(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Qa(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=On(t,this.array),n=On(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=On(t,this.array),n=On(n,this.array),s=On(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this}setXYZW(e,t,n,s,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=On(t,this.array),n=On(n,this.array),s=On(s,this.array),r=On(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this.data.array[e+3]=r,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[s+r])}return new ci(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new k0(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[s+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class KB extends ur{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ut(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let X2;const Mb=new se,j2=new se,q2=new se,Q2=new Qe,Cb=new Qe,A9=new hn,ES=new se,Rb=new se,_S=new se,oF=new Qe,UR=new Qe,lF=new Qe;class E9 extends li{constructor(e=new KB){if(super(),this.isSprite=!0,this.type="Sprite",X2===void 0){X2=new Tn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new YE(t,5);X2.setIndex([0,1,2,0,2,3]),X2.setAttribute("position",new k0(n,3,0,!1)),X2.setAttribute("uv",new k0(n,2,3,!1))}this.geometry=X2,this.material=e,this.center=new Qe(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),j2.setFromMatrixScale(this.matrixWorld),A9.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),q2.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&j2.multiplyScalar(-q2.z);const n=this.material.rotation;let s,r;n!==0&&(r=Math.cos(n),s=Math.sin(n));const a=this.center;SS(ES.set(-.5,-.5,0),q2,a,j2,s,r),SS(Rb.set(.5,-.5,0),q2,a,j2,s,r),SS(_S.set(.5,.5,0),q2,a,j2,s,r),oF.set(0,0),UR.set(1,0),lF.set(1,1);let o=e.ray.intersectTriangle(ES,Rb,_S,!1,Mb);if(o===null&&(SS(Rb.set(-.5,.5,0),q2,a,j2,s,r),UR.set(0,1),o=e.ray.intersectTriangle(ES,_S,Rb,!1,Mb),o===null))return;const l=e.ray.origin.distanceTo(Mb);l<e.near||l>e.far||t.push({distance:l,point:Mb.clone(),uv:wo.getInterpolation(Mb,ES,Rb,_S,oF,UR,lF,new Qe),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function SS(i,e,t,n,s,r){Q2.subVectors(i,t).addScalar(.5).multiply(n),s!==void 0?(Cb.x=r*Q2.x-s*Q2.y,Cb.y=s*Q2.x+r*Q2.y):Cb.copy(Q2),i.copy(e),i.x+=Cb.x,i.y+=Cb.y,i.applyMatrix4(A9)}const TS=new se,cF=new se;class _9 extends li{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,s=t.length;n<s;n++){const r=t[n];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const s=this.levels;let r;for(r=0;r<s.length&&!(t<s[r].distance);r++);return s.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const s=t.splice(n,1);return this.remove(s[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,s;for(n=1,s=t.length;n<s;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){TS.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(TS);this.getObjectForDistance(s).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){TS.setFromMatrixPosition(e.matrixWorld),cF.setFromMatrixPosition(this.matrixWorld);const n=TS.distanceTo(cF)/e.zoom;t[0].object.visible=!0;let s,r;for(s=1,r=t.length;s<r;s++){let a=t[s].distance;if(t[s].object.visible&&(a-=a*t[s].hysteresis),n>=a)t[s-1].object.visible=!1,t[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<r;s++)t[s].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let s=0,r=n.length;s<r;s++){const a=n[s];t.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return t}}const uF=new se,hF=new ai,fF=new ai,Ore=new se,dF=new hn,wS=new se,kR=new Kr,pF=new hn,FR=new Tg;class WB extends ms{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=XL,this.bindMatrix=new hn,this.bindMatrixInverse=new hn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new ca),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,wS),this.boundingBox.expandByPoint(wS)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Kr),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,wS),this.boundingSphere.expandByPoint(wS)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,s=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),kR.copy(this.boundingSphere),kR.applyMatrix4(s),e.ray.intersectsSphere(kR)!==!1&&(pF.copy(s).invert(),FR.copy(e.ray).applyMatrix4(pF),!(this.boundingBox!==null&&FR.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,FR)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new ai,t=this.geometry.attributes.skinWeight;for(let n=0,s=t.count;n<s;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===XL?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Z6?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,s=this.geometry;hF.fromBufferAttribute(s.attributes.skinIndex,e),fF.fromBufferAttribute(s.attributes.skinWeight,e),uF.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const a=fF.getComponent(r);if(a!==0){const o=hF.getComponent(r);dF.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),t.addScaledVector(Ore.copy(uF).applyMatrix4(dF),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class hM extends li{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Yc extends wi{constructor(e=null,t=1,n=1,s,r,a,o,l,c=Ws,h=Ws,d,m){super(null,a,o,l,c,h,s,r,d,m),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const mF=new hn,Pre=new hn;class KE{constructor(e=[],t=[]){this.uuid=tl(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,s=this.bones.length;n<s;n++)this.boneInverses.push(new hn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new hn;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,s=this.boneTexture;for(let r=0,a=e.length;r<a;r++){const o=e[r]?e[r].matrixWorld:Pre;mF.multiplyMatrices(o,t[r]),mF.toArray(n,r*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new KE(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Yc(t,e,e,rr,ps);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const s=this.bones[t];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,s=e.bones.length;n<s;n++){const r=e.bones[n];let a=t[r];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),a=new hM),this.bones.push(a),this.boneInverses.push(new hn().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let s=0,r=t.length;s<r;s++){const a=t[s];e.bones.push(a.uuid);const o=n[s];e.boneInverses.push(o.toArray())}return e}}class pg extends ci{constructor(e,t,n,s=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const $2=new hn,gF=new hn,MS=[],yF=new ca,Nre=new hn,Db=new ms,Lb=new Kr;class XB extends ms{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new pg(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<n;s++)this.setMatrixAt(s,Nre)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new ca),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,$2),yF.copy(e.boundingBox).applyMatrix4($2),this.boundingBox.union(yF)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Kr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,$2),Lb.copy(e.boundingSphere).applyMatrix4($2),this.boundingSphere.union(Lb)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,s=this.morphTexture.source.data.data,r=n.length+1,a=e*r+1;for(let o=0;o<n.length;o++)n[o]=s[a+o]}raycast(e,t){const n=this.matrixWorld,s=this.count;if(Db.geometry=this.geometry,Db.material=this.material,Db.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Lb.copy(this.boundingSphere),Lb.applyMatrix4(n),e.ray.intersectsSphere(Lb)!==!1))for(let r=0;r<s;r++){this.getMatrixAt(r,$2),gF.multiplyMatrices(n,$2),Db.matrixWorld=gF,Db.raycast(e,MS);for(let a=0,o=MS.length;a<o;a++){const l=MS[a];l.instanceId=r,l.object=this,t.push(l)}MS.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new pg(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,s=n.length+1;this.morphTexture===null&&(this.morphTexture=new Yc(new Float32Array(s*this.count),s,this.count,FE,ps));const r=this.morphTexture.source.data.data;let a=0;for(let c=0;c<n.length;c++)a+=n[c];const o=this.geometry.morphTargetsRelative?1:1-a,l=s*e;r[l]=o,r.set(n,l+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const HR=new se,Ure=new se,kre=new Bn;class mf{constructor(e=new se(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,s){return this.normal.set(e,t,n),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const s=HR.subVectors(n,t).cross(Ure.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(HR),s=this.normal.dot(n);if(s===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/s;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||kre.getNormalMatrix(e),s=this.coplanarPoint(HR).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-s.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Gp=new Kr,CS=new se;class Xv{constructor(e=new mf,t=new mf,n=new mf,s=new mf,r=new mf,a=new mf){this.planes=[e,t,n,s,r,a]}set(e,t,n,s,r,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(s),o[4].copy(r),o[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Ul){const n=this.planes,s=e.elements,r=s[0],a=s[1],o=s[2],l=s[3],c=s[4],h=s[5],d=s[6],m=s[7],y=s[8],x=s[9],_=s[10],b=s[11],A=s[12],T=s[13],w=s[14],R=s[15];if(n[0].setComponents(l-r,m-c,b-y,R-A).normalize(),n[1].setComponents(l+r,m+c,b+y,R+A).normalize(),n[2].setComponents(l+a,m+h,b+x,R+T).normalize(),n[3].setComponents(l-a,m-h,b-x,R-T).normalize(),n[4].setComponents(l-o,m-d,b-_,R-w).normalize(),t===Ul)n[5].setComponents(l+o,m+d,b+_,R+w).normalize();else if(t===ZA)n[5].setComponents(o,d,_,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Gp.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Gp.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Gp)}intersectsSprite(e){return Gp.center.set(0,0,0),Gp.radius=.7071067811865476,Gp.applyMatrix4(e.matrixWorld),this.intersectsSphere(Gp)}intersectsSphere(e){const t=this.planes,n=e.center,s=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(n)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const s=t[n];if(CS.x=s.normal.x>0?e.max.x:e.min.x,CS.y=s.normal.y>0?e.max.y:e.min.y,CS.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(CS)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Hu=new hn,Gu=new Xv;class fM{constructor(){this.coordinateSystem=Ul}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(Hu.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Gu.setFromProjectionMatrix(Hu,this.coordinateSystem),Gu.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(Hu.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Gu.setFromProjectionMatrix(Hu,this.coordinateSystem),Gu.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(Hu.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Gu.setFromProjectionMatrix(Hu,this.coordinateSystem),Gu.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(Hu.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Gu.setFromProjectionMatrix(Hu,this.coordinateSystem),Gu.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(Hu.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Gu.setFromProjectionMatrix(Hu,this.coordinateSystem),Gu.containsPoint(e))return!0}return!1}clone(){return new fM}}function GR(i,e){return i-e}function Fre(i,e){return i.z-e.z}function Hre(i,e){return e.z-i.z}class Gre{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,s){const r=this.pool,a=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const o=r[this.index];a.push(o),this.index++,o.start=e,o.count=t,o.z=n,o.index=s}reset(){this.list.length=0,this.index=0}}const vo=new hn,zre=new Ut(1,1,1),vF=new Xv,Vre=new fM,RS=new ca,zp=new Kr,Ib=new se,xF=new se,Yre=new se,zR=new Gre,Ta=new ms,DS=[];function Kre(i,e,t=0){const n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){const s=i.count;for(let r=0;r<s;r++)for(let a=0;a<n;a++)e.setComponent(r+t,a,i.getComponent(r,a))}else e.array.set(i.array,t*n);e.needsUpdate=!0}function Vp(i,e){if(i.constructor!==e.constructor){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{const t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}class S9 extends ms{constructor(e,t,n=t*2,s){super(new Tn,s),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new Yc(t,e,e,rr,ps);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new Yc(t,e,e,HE,Qc);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new Yc(t,e,e,rr,ps);n.colorSpace=ri.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const r in e.attributes){const a=e.getAttribute(r),{array:o,itemSize:l,normalized:c}=a,h=new o.constructor(n*l),d=new ci(h,l,c);t.setAttribute(r,d)}if(e.getIndex()!==null){const r=n>65535?new Uint32Array(s):new Uint16Array(s);t.setIndex(new ci(r,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const s=e.getAttribute(n),r=t.getAttribute(n);if(s.itemSize!==r.itemSize||s.normalized!==r.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ca);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,s=t.length;n<s;n++){if(t[n].active===!1)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,vo),this.getBoundingBoxAt(r,RS).applyMatrix4(vo),e.union(RS)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Kr);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,s=t.length;n<s;n++){if(t[n].active===!1)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,vo),this.getBoundingSphereAt(r,zp).applyMatrix4(vo),e.union(zp)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let s=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(GR),s=this._availableInstanceIds.shift(),this._instanceInfo[s]=n):(s=this._instanceInfo.length,this._instanceInfo.push(n));const r=this._matricesTexture;vo.identity().toArray(r.image.data,s*16),r.needsUpdate=!0;const a=this._colorsTexture;return a&&(zre.toArray(a.image.data,s*4),a.needsUpdate=!0),this._visibilityChanged=!0,s}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const s={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},r=this._geometryInfo;s.vertexStart=this._nextVertexStart,s.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const a=e.getIndex();if(a!==null&&(s.indexStart=this._nextIndexStart,s.reservedIndexCount=n===-1?a.count:n),s.indexStart!==-1&&s.indexStart+s.reservedIndexCount>this._maxIndexCount||s.vertexStart+s.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let l;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(GR),l=this._availableGeometryIds.shift(),r[l]=s):(l=this._geometryCount,this._geometryCount++,r.push(s)),this.setGeometryAt(l,e),this._nextIndexStart=s.indexStart+s.reservedIndexCount,this._nextVertexStart=s.vertexStart+s.reservedVertexCount,l}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,s=n.getIndex()!==null,r=n.getIndex(),a=t.getIndex(),o=this._geometryInfo[e];if(s&&a.count>o.reservedIndexCount||t.attributes.position.count>o.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const l=o.vertexStart,c=o.reservedVertexCount;o.vertexCount=t.getAttribute("position").count;for(const h in n.attributes){const d=t.getAttribute(h),m=n.getAttribute(h);Kre(d,m,l);const y=d.itemSize;for(let x=d.count,_=c;x<_;x++){const b=l+x;for(let A=0;A<y;A++)m.setComponent(b,A,0)}m.needsUpdate=!0,m.addUpdateRange(l*y,c*y)}if(s){const h=o.indexStart,d=o.reservedIndexCount;o.indexCount=t.getIndex().count;for(let m=0;m<a.count;m++)r.setX(h+m,l+a.getX(m));for(let m=a.count,y=d;m<y;m++)r.setX(h+m,l);r.needsUpdate=!0,r.addUpdateRange(h,o.reservedIndexCount)}return o.start=s?o.indexStart:o.vertexStart,o.count=s?o.indexCount:o.vertexCount,o.boundingBox=null,t.boundingBox!==null&&(o.boundingBox=t.boundingBox.clone()),o.boundingSphere=null,t.boundingSphere!==null&&(o.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let s=0,r=n.length;s<r;s++)n[s].active&&n[s].geometryIndex===e&&this.deleteInstance(s);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,s=n.map((a,o)=>o).sort((a,o)=>n[a].vertexStart-n[o].vertexStart),r=this.geometry;for(let a=0,o=n.length;a<o;a++){const l=s[a],c=n[l];if(c.active!==!1){if(r.index!==null){if(c.indexStart!==t){const{indexStart:h,vertexStart:d,reservedIndexCount:m}=c,y=r.index,x=y.array,_=e-d;for(let b=h;b<h+m;b++)x[b]=x[b]+_;y.array.copyWithin(t,h,h+m),y.addUpdateRange(t,m),c.indexStart=t}t+=c.reservedIndexCount}if(c.vertexStart!==e){const{vertexStart:h,reservedVertexCount:d}=c,m=r.attributes;for(const y in m){const x=m[y],{array:_,itemSize:b}=x;_.copyWithin(e*b,h*b,(h+d)*b),x.addUpdateRange(e*b,d*b)}c.vertexStart=e}e+=c.reservedVertexCount,c.start=r.index?c.indexStart:c.vertexStart,this._nextIndexStart=r.index?c.indexStart+c.reservedIndexCount:0,this._nextVertexStart=c.vertexStart+c.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,s=this._geometryInfo[e];if(s.boundingBox===null){const r=new ca,a=n.index,o=n.attributes.position;for(let l=s.start,c=s.start+s.count;l<c;l++){let h=l;a&&(h=a.getX(h)),r.expandByPoint(Ib.fromBufferAttribute(o,h))}s.boundingBox=r}return t.copy(s.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,s=this._geometryInfo[e];if(s.boundingSphere===null){const r=new Kr;this.getBoundingBoxAt(e,RS),RS.getCenter(r.center);const a=n.index,o=n.attributes.position;let l=0;for(let c=s.start,h=s.start+s.count;c<h;c++){let d=c;a&&(d=a.getX(d)),Ib.fromBufferAttribute(o,d),l=Math.max(l,r.center.distanceToSquared(Ib))}r.radius=Math.sqrt(l),s.boundingSphere=r}return t.copy(s.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,s=this._matricesTexture.image.data;return t.toArray(s,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(GR);t[t.length-1]===n.length;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const s=new Int32Array(e),r=new Int32Array(e);Vp(this._multiDrawCounts,s),Vp(this._multiDrawStarts,r),this._multiDrawCounts=s,this._multiDrawStarts=r,this._maxInstanceCount=e;const a=this._indirectTexture,o=this._matricesTexture,l=this._colorsTexture;a.dispose(),this._initIndirectTexture(),Vp(a.image.data,this._indirectTexture.image.data),o.dispose(),this._initMatricesTexture(),Vp(o.image.data,this._matricesTexture.image.data),l&&(l.dispose(),this._initColorsTexture(),Vp(l.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...n.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(l=>l.indexStart+l.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const r=this.geometry;r.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new Tn,this._initializeGeometry(r));const a=this.geometry;r.index&&Vp(r.index.array,a.index.array);for(const o in r.attributes)Vp(r.attributes[o].array,a.attributes[o].array)}raycast(e,t){const n=this._instanceInfo,s=this._geometryInfo,r=this.matrixWorld,a=this.geometry;Ta.material=this.material,Ta.geometry.index=a.index,Ta.geometry.attributes=a.attributes,Ta.geometry.boundingBox===null&&(Ta.geometry.boundingBox=new ca),Ta.geometry.boundingSphere===null&&(Ta.geometry.boundingSphere=new Kr);for(let o=0,l=n.length;o<l;o++){if(!n[o].visible||!n[o].active)continue;const c=n[o].geometryIndex,h=s[c];Ta.geometry.setDrawRange(h.start,h.count),this.getMatrixAt(o,Ta.matrixWorld).premultiply(r),this.getBoundingBoxAt(c,Ta.geometry.boundingBox),this.getBoundingSphereAt(c,Ta.geometry.boundingSphere),Ta.raycast(e,DS);for(let d=0,m=DS.length;d<m;d++){const y=DS[d];y.object=this,y.batchId=o,t.push(y)}DS.length=0}Ta.material=null,Ta.geometry.index=null,Ta.geometry.attributes={},Ta.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,s,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=s.getIndex(),o=a===null?1:a.array.BYTES_PER_ELEMENT,l=this._instanceInfo,c=this._multiDrawStarts,h=this._multiDrawCounts,d=this._geometryInfo,m=this.perObjectFrustumCulled,y=this._indirectTexture,x=y.image.data,_=n.isArrayCamera?Vre:vF;m&&!n.isArrayCamera&&(vo.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),vF.setFromProjectionMatrix(vo,e.coordinateSystem));let b=0;if(this.sortObjects){vo.copy(this.matrixWorld).invert(),Ib.setFromMatrixPosition(n.matrixWorld).applyMatrix4(vo),xF.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(vo);for(let w=0,R=l.length;w<R;w++)if(l[w].visible&&l[w].active){const O=l[w].geometryIndex;this.getMatrixAt(w,vo),this.getBoundingSphereAt(O,zp).applyMatrix4(vo);let N=!1;if(m&&(N=!_.intersectsSphere(zp,n)),!N){const U=d[O],P=Yre.subVectors(zp.center,Ib).dot(xF);zR.push(U.start,U.count,P,w)}}const A=zR.list,T=this.customSort;T===null?A.sort(r.transparent?Hre:Fre):T.call(this,A,n);for(let w=0,R=A.length;w<R;w++){const O=A[w];c[b]=O.start*o,h[b]=O.count,x[b]=O.index,b++}zR.reset()}else for(let A=0,T=l.length;A<T;A++)if(l[A].visible&&l[A].active){const w=l[A].geometryIndex;let R=!1;if(m&&(this.getMatrixAt(A,vo),this.getBoundingSphereAt(w,zp).applyMatrix4(vo),R=!_.intersectsSphere(zp,n)),!R){const O=d[w];c[b]=O.start*o,h[b]=O.count,x[b]=A,b++}}y.needsUpdate=!0,this._multiDrawCount=b,this._visibilityChanged=!1}onBeforeShadow(e,t,n,s,r,a){this.onBeforeRender(e,null,s,r,a)}}class Oa extends ur{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ut(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const sw=new se,rw=new se,bF=new hn,Bb=new Tg,LS=new Kr,VR=new se,AF=new se;let Yf=class extends li{constructor(e=new Tn,t=new Oa){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let s=1,r=t.count;s<r;s++)sw.fromBufferAttribute(t,s-1),rw.fromBufferAttribute(t,s),n[s]=n[s-1],n[s]+=sw.distanceTo(rw);e.setAttribute("lineDistance",new Qt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,r=e.params.Line.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),LS.copy(n.boundingSphere),LS.applyMatrix4(s),LS.radius+=r,e.ray.intersectsSphere(LS)===!1)return;bF.copy(s).invert(),Bb.copy(e.ray).applyMatrix4(bF);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=this.isLineSegments?2:1,h=n.index,m=n.attributes.position;if(h!==null){const y=Math.max(0,a.start),x=Math.min(h.count,a.start+a.count);for(let _=y,b=x-1;_<b;_+=c){const A=h.getX(_),T=h.getX(_+1),w=IS(this,e,Bb,l,A,T,_);w&&t.push(w)}if(this.isLineLoop){const _=h.getX(x-1),b=h.getX(y),A=IS(this,e,Bb,l,_,b,x-1);A&&t.push(A)}}else{const y=Math.max(0,a.start),x=Math.min(m.count,a.start+a.count);for(let _=y,b=x-1;_<b;_+=c){const A=IS(this,e,Bb,l,_,_+1,_);A&&t.push(A)}if(this.isLineLoop){const _=IS(this,e,Bb,l,x-1,y,x-1);_&&t.push(_)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,a=s.length;r<a;r++){const o=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}};function IS(i,e,t,n,s,r,a){const o=i.geometry.attributes.position;if(sw.fromBufferAttribute(o,s),rw.fromBufferAttribute(o,r),t.distanceSqToSegment(sw,rw,VR,AF)>n)return;VR.applyMatrix4(i.matrixWorld);const c=e.ray.origin.distanceTo(VR);if(!(c<e.near||c>e.far))return{distance:c,point:AF.clone().applyMatrix4(i.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:i}}const EF=new se,_F=new se;class Zc extends Yf{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let s=0,r=t.count;s<r;s+=2)EF.fromBufferAttribute(t,s),_F.fromBufferAttribute(t,s+1),n[s]=s===0?0:n[s-1],n[s+1]=n[s]+EF.distanceTo(_F);e.setAttribute("lineDistance",new Qt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class jB extends Yf{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class dM extends ur{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ut(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const SF=new hn,$L=new Tg,BS=new Kr,OS=new se;class qB extends li{constructor(e=new Tn,t=new dM){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,r=e.params.Points.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),BS.copy(n.boundingSphere),BS.applyMatrix4(s),BS.radius+=r,e.ray.intersectsSphere(BS)===!1)return;SF.copy(s).invert(),$L.copy(e.ray).applyMatrix4(SF);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=n.index,d=n.attributes.position;if(c!==null){const m=Math.max(0,a.start),y=Math.min(c.count,a.start+a.count);for(let x=m,_=y;x<_;x++){const b=c.getX(x);OS.fromBufferAttribute(d,b),TF(OS,b,l,s,e,t,this)}}else{const m=Math.max(0,a.start),y=Math.min(d.count,a.start+a.count);for(let x=m,_=y;x<_;x++)OS.fromBufferAttribute(d,x),TF(OS,x,l,s,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,a=s.length;r<a;r++){const o=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}}function TF(i,e,t,n,s,r,a){const o=$L.distanceSqToPoint(i);if(o<t){const l=new se;$L.closestPointToPoint(i,l),l.applyMatrix4(n);const c=s.ray.origin.distanceTo(l);if(c<s.near||c>s.far)return;r.push({distance:c,distanceToRay:Math.sqrt(o),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class T9 extends wi{constructor(e,t,n,s,r=ei,a=ei,o,l,c){super(e,t,n,s,r,a,o,l,c),this.isVideoTexture=!0,this.generateMipmaps=!1;const h=this;function d(){h.needsUpdate=!0,e.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(d)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Wre extends T9{constructor(e,t,n,s,r,a,o,l){super({},e,t,n,s,r,a,o,l),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class Xre extends wi{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Ws,this.minFilter=Ws,this.generateMipmaps=!1,this.needsUpdate=!0}}class pM extends wi{constructor(e,t,n,s,r,a,o,l,c,h,d,m){super(null,a,o,l,c,h,s,r,d,m),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class jre extends pM{constructor(e,t,n,s,r,a){super(e,t,n,r,a),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=sr,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class qre extends pM{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,gh),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class Qre extends wi{constructor(e,t,n,s,r,a,o,l,c){super(e,t,n,s,r,a,o,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class jv extends wi{constructor(e,t,n=Qc,s,r,a,o=Ws,l=Ws,c,h=Dv){if(h!==Dv&&h!==fg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,s,r,a,o,l,h,n,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new _0(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class $re extends jv{constructor(e=1,t=1,n=1){super(e,t),this.isDepthArrayTexture=!0,this.image={width:e,height:t,depth:n},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class mM extends Tn{constructor(e=1,t=1,n=4,s=8,r=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:s,heightSegments:r},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),s=Math.max(3,Math.floor(s)),r=Math.max(1,Math.floor(r));const a=[],o=[],l=[],c=[],h=t/2,d=Math.PI/2*e,m=t,y=2*d+m,x=n*2+r,_=s+1,b=new se,A=new se;for(let T=0;T<=x;T++){let w=0,R=0,O=0,N=0;if(T<=n){const B=T/n,L=B*Math.PI/2;R=-h-e*Math.cos(L),O=e*Math.sin(L),N=-e*Math.cos(L),w=B*d}else if(T<=n+r){const B=(T-n)/r;R=-h+B*t,O=e,N=0,w=d+B*m}else{const B=(T-n-r)/n,L=B*Math.PI/2;R=h+e*Math.sin(L),O=e*Math.cos(L),N=e*Math.sin(L),w=d+m+B*d}const U=Math.max(0,Math.min(1,w/y));let P=0;T===0?P=.5/s:T===x&&(P=-.5/s);for(let B=0;B<=s;B++){const L=B/s,F=L*Math.PI*2,j=Math.sin(F),J=Math.cos(F);A.x=-O*J,A.y=R,A.z=O*j,o.push(A.x,A.y,A.z),b.set(-O*J,N,O*j),b.normalize(),l.push(b.x,b.y,b.z),c.push(L+P,U)}if(T>0){const B=(T-1)*_;for(let L=0;L<s;L++){const F=B+L,j=B+L+1,J=T*_+L,re=T*_+L+1;a.push(F,j,J),a.push(j,re,J)}}}this.setIndex(a),this.setAttribute("position",new Qt(o,3)),this.setAttribute("normal",new Qt(l,3)),this.setAttribute("uv",new Qt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mM(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class gM extends Tn{constructor(e=1,t=32,n=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:s},t=Math.max(3,t);const r=[],a=[],o=[],l=[],c=new se,h=new Qe;a.push(0,0,0),o.push(0,0,1),l.push(.5,.5);for(let d=0,m=3;d<=t;d++,m+=3){const y=n+d/t*s;c.x=e*Math.cos(y),c.y=e*Math.sin(y),a.push(c.x,c.y,c.z),o.push(0,0,1),h.x=(a[m]/e+1)/2,h.y=(a[m+1]/e+1)/2,l.push(h.x,h.y)}for(let d=1;d<=t;d++)r.push(d,d+1,0);this.setIndex(r),this.setAttribute("position",new Qt(a,3)),this.setAttribute("normal",new Qt(o,3)),this.setAttribute("uv",new Qt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gM(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class WE extends Tn{constructor(e=1,t=1,n=1,s=32,r=1,a=!1,o=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:s,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:l};const c=this;s=Math.floor(s),r=Math.floor(r);const h=[],d=[],m=[],y=[];let x=0;const _=[],b=n/2;let A=0;T(),a===!1&&(e>0&&w(!0),t>0&&w(!1)),this.setIndex(h),this.setAttribute("position",new Qt(d,3)),this.setAttribute("normal",new Qt(m,3)),this.setAttribute("uv",new Qt(y,2));function T(){const R=new se,O=new se;let N=0;const U=(t-e)/n;for(let P=0;P<=r;P++){const B=[],L=P/r,F=L*(t-e)+e;for(let j=0;j<=s;j++){const J=j/s,re=J*l+o,q=Math.sin(re),W=Math.cos(re);O.x=F*q,O.y=-L*n+b,O.z=F*W,d.push(O.x,O.y,O.z),R.set(q,U,W).normalize(),m.push(R.x,R.y,R.z),y.push(J,1-L),B.push(x++)}_.push(B)}for(let P=0;P<s;P++)for(let B=0;B<r;B++){const L=_[B][P],F=_[B+1][P],j=_[B+1][P+1],J=_[B][P+1];(e>0||B!==0)&&(h.push(L,F,J),N+=3),(t>0||B!==r-1)&&(h.push(F,j,J),N+=3)}c.addGroup(A,N,0),A+=N}function w(R){const O=x,N=new Qe,U=new se;let P=0;const B=R===!0?e:t,L=R===!0?1:-1;for(let j=1;j<=s;j++)d.push(0,b*L,0),m.push(0,L,0),y.push(.5,.5),x++;const F=x;for(let j=0;j<=s;j++){const re=j/s*l+o,q=Math.cos(re),W=Math.sin(re);U.x=B*W,U.y=b*L,U.z=B*q,d.push(U.x,U.y,U.z),m.push(0,L,0),N.x=q*.5+.5,N.y=W*.5*L+.5,y.push(N.x,N.y),x++}for(let j=0;j<s;j++){const J=O+j,re=F+j;R===!0?h.push(re,re+1,J):h.push(re+1,re,J),P+=3}c.addGroup(A,P,R===!0?1:2),A+=P}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new WE(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class XE extends WE{constructor(e=1,t=1,n=32,s=1,r=!1,a=0,o=Math.PI*2){super(0,e,t,n,s,r,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:s,openEnded:r,thetaStart:a,thetaLength:o}}static fromJSON(e){return new XE(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class K0 extends Tn{constructor(e=[],t=[],n=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:s};const r=[],a=[];o(s),c(n),h(),this.setAttribute("position",new Qt(r,3)),this.setAttribute("normal",new Qt(r.slice(),3)),this.setAttribute("uv",new Qt(a,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function o(T){const w=new se,R=new se,O=new se;for(let N=0;N<t.length;N+=3)y(t[N+0],w),y(t[N+1],R),y(t[N+2],O),l(w,R,O,T)}function l(T,w,R,O){const N=O+1,U=[];for(let P=0;P<=N;P++){U[P]=[];const B=T.clone().lerp(R,P/N),L=w.clone().lerp(R,P/N),F=N-P;for(let j=0;j<=F;j++)j===0&&P===N?U[P][j]=B:U[P][j]=B.clone().lerp(L,j/F)}for(let P=0;P<N;P++)for(let B=0;B<2*(N-P)-1;B++){const L=Math.floor(B/2);B%2===0?(m(U[P][L+1]),m(U[P+1][L]),m(U[P][L])):(m(U[P][L+1]),m(U[P+1][L+1]),m(U[P+1][L]))}}function c(T){const w=new se;for(let R=0;R<r.length;R+=3)w.x=r[R+0],w.y=r[R+1],w.z=r[R+2],w.normalize().multiplyScalar(T),r[R+0]=w.x,r[R+1]=w.y,r[R+2]=w.z}function h(){const T=new se;for(let w=0;w<r.length;w+=3){T.x=r[w+0],T.y=r[w+1],T.z=r[w+2];const R=b(T)/2/Math.PI+.5,O=A(T)/Math.PI+.5;a.push(R,1-O)}x(),d()}function d(){for(let T=0;T<a.length;T+=6){const w=a[T+0],R=a[T+2],O=a[T+4],N=Math.max(w,R,O),U=Math.min(w,R,O);N>.9&&U<.1&&(w<.2&&(a[T+0]+=1),R<.2&&(a[T+2]+=1),O<.2&&(a[T+4]+=1))}}function m(T){r.push(T.x,T.y,T.z)}function y(T,w){const R=T*3;w.x=e[R+0],w.y=e[R+1],w.z=e[R+2]}function x(){const T=new se,w=new se,R=new se,O=new se,N=new Qe,U=new Qe,P=new Qe;for(let B=0,L=0;B<r.length;B+=9,L+=6){T.set(r[B+0],r[B+1],r[B+2]),w.set(r[B+3],r[B+4],r[B+5]),R.set(r[B+6],r[B+7],r[B+8]),N.set(a[L+0],a[L+1]),U.set(a[L+2],a[L+3]),P.set(a[L+4],a[L+5]),O.copy(T).add(w).add(R).divideScalar(3);const F=b(O);_(N,L+0,T,F),_(U,L+2,w,F),_(P,L+4,R,F)}}function _(T,w,R,O){O<0&&T.x===1&&(a[w]=T.x-1),R.x===0&&R.z===0&&(a[w]=O/2/Math.PI+.5)}function b(T){return Math.atan2(T.z,-T.x)}function A(T){return Math.atan2(-T.y,Math.sqrt(T.x*T.x+T.z*T.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new K0(e.vertices,e.indices,e.radius,e.details)}}class yM extends K0{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,s=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-n,0,-s,n,0,s,-n,0,s,n,-s,-n,0,-s,n,0,s,-n,0,s,n,0,-n,0,-s,n,0,-s,-n,0,s,n,0,s],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,a,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new yM(e.radius,e.detail)}}const PS=new se,NS=new se,YR=new se,US=new wo;class w9 extends Tn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const s=Math.pow(10,4),r=Math.cos(Zm*t),a=e.getIndex(),o=e.getAttribute("position"),l=a?a.count:o.count,c=[0,0,0],h=["a","b","c"],d=new Array(3),m={},y=[];for(let x=0;x<l;x+=3){a?(c[0]=a.getX(x),c[1]=a.getX(x+1),c[2]=a.getX(x+2)):(c[0]=x,c[1]=x+1,c[2]=x+2);const{a:_,b,c:A}=US;if(_.fromBufferAttribute(o,c[0]),b.fromBufferAttribute(o,c[1]),A.fromBufferAttribute(o,c[2]),US.getNormal(YR),d[0]=`${Math.round(_.x*s)},${Math.round(_.y*s)},${Math.round(_.z*s)}`,d[1]=`${Math.round(b.x*s)},${Math.round(b.y*s)},${Math.round(b.z*s)}`,d[2]=`${Math.round(A.x*s)},${Math.round(A.y*s)},${Math.round(A.z*s)}`,!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(let T=0;T<3;T++){const w=(T+1)%3,R=d[T],O=d[w],N=US[h[T]],U=US[h[w]],P=`${R}_${O}`,B=`${O}_${R}`;B in m&&m[B]?(YR.dot(m[B].normal)<=r&&(y.push(N.x,N.y,N.z),y.push(U.x,U.y,U.z)),m[B]=null):P in m||(m[P]={index0:c[T],index1:c[w],normal:YR.clone()})}}for(const x in m)if(m[x]){const{index0:_,index1:b}=m[x];PS.fromBufferAttribute(o,_),NS.fromBufferAttribute(o,b),y.push(PS.x,PS.y,PS.z),y.push(NS.x,NS.y,NS.z)}this.setAttribute("position",new Qt(y,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class eu{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,s=this.getPoint(0),r=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),r+=n.distanceTo(s),t.push(r),s=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let s=0;const r=n.length;let a;t?a=t:a=e*n[r-1];let o=0,l=r-1,c;for(;o<=l;)if(s=Math.floor(o+(l-o)/2),c=n[s]-a,c<0)o=s+1;else if(c>0)l=s-1;else{l=s;break}if(s=l,n[s]===a)return s/(r-1);const h=n[s],m=n[s+1]-h,y=(a-h)/m;return(s+y)/(r-1)}getTangent(e,t){let s=e-1e-4,r=e+1e-4;s<0&&(s=0),r>1&&(r=1);const a=this.getPoint(s),o=this.getPoint(r),l=t||(a.isVector2?new Qe:new se);return l.copy(o).sub(a).normalize(),l}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new se,s=[],r=[],a=[],o=new se,l=new hn;for(let y=0;y<=e;y++){const x=y/e;s[y]=this.getTangentAt(x,new se)}r[0]=new se,a[0]=new se;let c=Number.MAX_VALUE;const h=Math.abs(s[0].x),d=Math.abs(s[0].y),m=Math.abs(s[0].z);h<=c&&(c=h,n.set(1,0,0)),d<=c&&(c=d,n.set(0,1,0)),m<=c&&n.set(0,0,1),o.crossVectors(s[0],n).normalize(),r[0].crossVectors(s[0],o),a[0].crossVectors(s[0],r[0]);for(let y=1;y<=e;y++){if(r[y]=r[y-1].clone(),a[y]=a[y-1].clone(),o.crossVectors(s[y-1],s[y]),o.length()>Number.EPSILON){o.normalize();const x=Math.acos(Rn(s[y-1].dot(s[y]),-1,1));r[y].applyMatrix4(l.makeRotationAxis(o,x))}a[y].crossVectors(s[y],r[y])}if(t===!0){let y=Math.acos(Rn(r[0].dot(r[e]),-1,1));y/=e,s[0].dot(o.crossVectors(r[0],r[e]))>0&&(y=-y);for(let x=1;x<=e;x++)r[x].applyMatrix4(l.makeRotationAxis(s[x],y*x)),a[x].crossVectors(s[x],r[x])}return{tangents:s,normals:r,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class vM extends eu{constructor(e=0,t=0,n=1,s=1,r=0,a=Math.PI*2,o=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=s,this.aStartAngle=r,this.aEndAngle=a,this.aClockwise=o,this.aRotation=l}getPoint(e,t=new Qe){const n=t,s=Math.PI*2;let r=this.aEndAngle-this.aStartAngle;const a=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=s;for(;r>s;)r-=s;r<Number.EPSILON&&(a?r=0:r=s),this.aClockwise===!0&&!a&&(r===s?r=-s:r=r-s);const o=this.aStartAngle+e*r;let l=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const h=Math.cos(this.aRotation),d=Math.sin(this.aRotation),m=l-this.aX,y=c-this.aY;l=m*h-y*d+this.aX,c=m*d+y*h+this.aY}return n.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class M9 extends vM{constructor(e,t,n,s,r,a){super(e,t,n,n,s,r,a),this.isArcCurve=!0,this.type="ArcCurve"}}function QB(){let i=0,e=0,t=0,n=0;function s(r,a,o,l){i=r,e=o,t=-3*r+3*a-2*o-l,n=2*r-2*a+o+l}return{initCatmullRom:function(r,a,o,l,c){s(a,o,c*(o-r),c*(l-a))},initNonuniformCatmullRom:function(r,a,o,l,c,h,d){let m=(a-r)/c-(o-r)/(c+h)+(o-a)/h,y=(o-a)/h-(l-a)/(h+d)+(l-o)/d;m*=h,y*=h,s(a,o,m,y)},calc:function(r){const a=r*r,o=a*r;return i+e*r+t*a+n*o}}}const kS=new se,KR=new QB,WR=new QB,XR=new QB;class C9 extends eu{constructor(e=[],t=!1,n="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=s}getPoint(e,t=new se){const n=t,s=this.points,r=s.length,a=(r-(this.closed?0:1))*e;let o=Math.floor(a),l=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/r)+1)*r:l===0&&o===r-1&&(o=r-2,l=1);let c,h;this.closed||o>0?c=s[(o-1)%r]:(kS.subVectors(s[0],s[1]).add(s[0]),c=kS);const d=s[o%r],m=s[(o+1)%r];if(this.closed||o+2<r?h=s[(o+2)%r]:(kS.subVectors(s[r-1],s[r-2]).add(s[r-1]),h=kS),this.curveType==="centripetal"||this.curveType==="chordal"){const y=this.curveType==="chordal"?.5:.25;let x=Math.pow(c.distanceToSquared(d),y),_=Math.pow(d.distanceToSquared(m),y),b=Math.pow(m.distanceToSquared(h),y);_<1e-4&&(_=1),x<1e-4&&(x=_),b<1e-4&&(b=_),KR.initNonuniformCatmullRom(c.x,d.x,m.x,h.x,x,_,b),WR.initNonuniformCatmullRom(c.y,d.y,m.y,h.y,x,_,b),XR.initNonuniformCatmullRom(c.z,d.z,m.z,h.z,x,_,b)}else this.curveType==="catmullrom"&&(KR.initCatmullRom(c.x,d.x,m.x,h.x,this.tension),WR.initCatmullRom(c.y,d.y,m.y,h.y,this.tension),XR.initCatmullRom(c.z,d.z,m.z,h.z,this.tension));return n.set(KR.calc(l),WR.calc(l),XR.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const s=this.points[t];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(new se().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function wF(i,e,t,n,s){const r=(n-e)*.5,a=(s-t)*.5,o=i*i,l=i*o;return(2*t-2*n+r+a)*l+(-3*t+3*n-2*r-a)*o+r*i+t}function Jre(i,e){const t=1-i;return t*t*e}function Zre(i,e){return 2*(1-i)*i*e}function eae(i,e){return i*i*e}function yA(i,e,t,n){return Jre(i,e)+Zre(i,t)+eae(i,n)}function tae(i,e){const t=1-i;return t*t*t*e}function nae(i,e){const t=1-i;return 3*t*t*i*e}function iae(i,e){return 3*(1-i)*i*i*e}function sae(i,e){return i*i*i*e}function vA(i,e,t,n,s){return tae(i,e)+nae(i,t)+iae(i,n)+sae(i,s)}class $B extends eu{constructor(e=new Qe,t=new Qe,n=new Qe,s=new Qe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new Qe){const n=t,s=this.v0,r=this.v1,a=this.v2,o=this.v3;return n.set(vA(e,s.x,r.x,a.x,o.x),vA(e,s.y,r.y,a.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class R9 extends eu{constructor(e=new se,t=new se,n=new se,s=new se){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new se){const n=t,s=this.v0,r=this.v1,a=this.v2,o=this.v3;return n.set(vA(e,s.x,r.x,a.x,o.x),vA(e,s.y,r.y,a.y,o.y),vA(e,s.z,r.z,a.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class JB extends eu{constructor(e=new Qe,t=new Qe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Qe){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Qe){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class D9 extends eu{constructor(e=new se,t=new se){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new se){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new se){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ZB extends eu{constructor(e=new Qe,t=new Qe,n=new Qe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Qe){const n=t,s=this.v0,r=this.v1,a=this.v2;return n.set(yA(e,s.x,r.x,a.x),yA(e,s.y,r.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class eO extends eu{constructor(e=new se,t=new se,n=new se){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new se){const n=t,s=this.v0,r=this.v1,a=this.v2;return n.set(yA(e,s.x,r.x,a.x),yA(e,s.y,r.y,a.y),yA(e,s.z,r.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class tO extends eu{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Qe){const n=t,s=this.points,r=(s.length-1)*e,a=Math.floor(r),o=r-a,l=s[a===0?a:a-1],c=s[a],h=s[a>s.length-2?s.length-1:a+1],d=s[a>s.length-3?s.length-1:a+2];return n.set(wF(o,l.x,c.x,h.x,d.x),wF(o,l.y,c.y,h.y,d.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const s=this.points[t];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(new Qe().fromArray(s))}return this}}var aw=Object.freeze({__proto__:null,ArcCurve:M9,CatmullRomCurve3:C9,CubicBezierCurve:$B,CubicBezierCurve3:R9,EllipseCurve:vM,LineCurve:JB,LineCurve3:D9,QuadraticBezierCurve:ZB,QuadraticBezierCurve3:eO,SplineCurve:tO});class L9 extends eu{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new aw[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),s=this.getCurveLengths();let r=0;for(;r<s.length;){if(s[r]>=n){const a=s[r]-n,o=this.curves[r],l=o.getLength(),c=l===0?0:1-a/l;return o.getPointAt(c,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,s=this.curves.length;n<s;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let s=0,r=this.curves;s<r.length;s++){const a=r[s],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,l=a.getPoints(o);for(let c=0;c<l.length;c++){const h=l[c];n&&n.equals(h)||(t.push(h),n=h)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const s=this.curves[t];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push(new aw[s.type]().fromJSON(s))}return this}}class ow extends L9{constructor(e){super(),this.type="Path",this.currentPoint=new Qe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new JB(this.currentPoint.clone(),new Qe(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,s){const r=new ZB(this.currentPoint.clone(),new Qe(e,t),new Qe(n,s));return this.curves.push(r),this.currentPoint.set(n,s),this}bezierCurveTo(e,t,n,s,r,a){const o=new $B(this.currentPoint.clone(),new Qe(e,t),new Qe(n,s),new Qe(r,a));return this.curves.push(o),this.currentPoint.set(r,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new tO(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,s,r,a){const o=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+o,t+l,n,s,r,a),this}absarc(e,t,n,s,r,a){return this.absellipse(e,t,n,n,s,r,a),this}ellipse(e,t,n,s,r,a,o,l){const c=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+c,t+h,n,s,r,a,o,l),this}absellipse(e,t,n,s,r,a,o,l){const c=new vM(e,t,n,s,r,a,o,l);if(this.curves.length>0){const d=c.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(c);const h=c.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class eg extends ow{constructor(e){super(e),this.uuid=tl(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,s=this.holes.length;n<s;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const s=this.holes[t];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push(new ow().fromJSON(s))}return this}}function rae(i,e,t=2){const n=e&&e.length,s=n?e[0]*t:i.length;let r=I9(i,0,s,t,!0);const a=[];if(!r||r.next===r.prev)return a;let o,l,c;if(n&&(r=uae(i,e,r,t)),i.length>80*t){o=1/0,l=1/0;let h=-1/0,d=-1/0;for(let m=t;m<s;m+=t){const y=i[m],x=i[m+1];y<o&&(o=y),x<l&&(l=x),y>h&&(h=y),x>d&&(d=x)}c=Math.max(h-o,d-l),c=c!==0?32767/c:0}return tE(r,a,t,o,l,c,0),a}function I9(i,e,t,n,s){let r;if(s===Aae(i,e,t,n)>0)for(let a=e;a<t;a+=n)r=MF(a/n|0,i[a],i[a+1],r);else for(let a=t-n;a>=e;a-=n)r=MF(a/n|0,i[a],i[a+1],r);return r&&Nv(r,r.next)&&(iE(r),r=r.next),r}function mg(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(Nv(t,t.next)||Ls(t.prev,t,t.next)===0)){if(iE(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function tE(i,e,t,n,s,r,a){if(!i)return;!a&&r&&mae(i,n,s,r);let o=i;for(;i.prev!==i.next;){const l=i.prev,c=i.next;if(r?oae(i,n,s,r):aae(i)){e.push(l.i,i.i,c.i),iE(i),i=c.next,o=c.next;continue}if(i=c,i===o){a?a===1?(i=lae(mg(i),e),tE(i,e,t,n,s,r,2)):a===2&&cae(i,e,t,n,s,r):tE(mg(i),e,t,n,s,r,1);break}}}function aae(i){const e=i.prev,t=i,n=i.next;if(Ls(e,t,n)>=0)return!1;const s=e.x,r=t.x,a=n.x,o=e.y,l=t.y,c=n.y,h=Math.min(s,r,a),d=Math.min(o,l,c),m=Math.max(s,r,a),y=Math.max(o,l,c);let x=n.next;for(;x!==e;){if(x.x>=h&&x.x<=m&&x.y>=d&&x.y<=y&&Zb(s,o,r,l,a,c,x.x,x.y)&&Ls(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function oae(i,e,t,n){const s=i.prev,r=i,a=i.next;if(Ls(s,r,a)>=0)return!1;const o=s.x,l=r.x,c=a.x,h=s.y,d=r.y,m=a.y,y=Math.min(o,l,c),x=Math.min(h,d,m),_=Math.max(o,l,c),b=Math.max(h,d,m),A=JL(y,x,e,t,n),T=JL(_,b,e,t,n);let w=i.prevZ,R=i.nextZ;for(;w&&w.z>=A&&R&&R.z<=T;){if(w.x>=y&&w.x<=_&&w.y>=x&&w.y<=b&&w!==s&&w!==a&&Zb(o,h,l,d,c,m,w.x,w.y)&&Ls(w.prev,w,w.next)>=0||(w=w.prevZ,R.x>=y&&R.x<=_&&R.y>=x&&R.y<=b&&R!==s&&R!==a&&Zb(o,h,l,d,c,m,R.x,R.y)&&Ls(R.prev,R,R.next)>=0))return!1;R=R.nextZ}for(;w&&w.z>=A;){if(w.x>=y&&w.x<=_&&w.y>=x&&w.y<=b&&w!==s&&w!==a&&Zb(o,h,l,d,c,m,w.x,w.y)&&Ls(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;R&&R.z<=T;){if(R.x>=y&&R.x<=_&&R.y>=x&&R.y<=b&&R!==s&&R!==a&&Zb(o,h,l,d,c,m,R.x,R.y)&&Ls(R.prev,R,R.next)>=0)return!1;R=R.nextZ}return!0}function lae(i,e){let t=i;do{const n=t.prev,s=t.next.next;!Nv(n,s)&&O9(n,t,t.next,s)&&nE(n,s)&&nE(s,n)&&(e.push(n.i,t.i,s.i),iE(t),iE(t.next),t=i=s),t=t.next}while(t!==i);return mg(t)}function cae(i,e,t,n,s,r){let a=i;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&vae(a,o)){let l=P9(a,o);a=mg(a,a.next),l=mg(l,l.next),tE(a,e,t,n,s,r,0),tE(l,e,t,n,s,r,0);return}o=o.next}a=a.next}while(a!==i)}function uae(i,e,t,n){const s=[];for(let r=0,a=e.length;r<a;r++){const o=e[r]*n,l=r<a-1?e[r+1]*n:i.length,c=I9(i,o,l,n,!1);c===c.next&&(c.steiner=!0),s.push(yae(c))}s.sort(hae);for(let r=0;r<s.length;r++)t=fae(s[r],t);return t}function hae(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),s=(e.next.y-e.y)/(e.next.x-e.x);t=n-s}return t}function fae(i,e){const t=dae(i,e);if(!t)return e;const n=P9(t,i);return mg(n,n.next),mg(t,t.next)}function dae(i,e){let t=e;const n=i.x,s=i.y;let r=-1/0,a;if(Nv(i,t))return t;do{if(Nv(i,t.next))return t.next;if(s<=t.y&&s>=t.next.y&&t.next.y!==t.y){const d=t.x+(s-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=n&&d>r&&(r=d,a=t.x<t.next.x?t:t.next,d===n))return a}t=t.next}while(t!==e);if(!a)return null;const o=a,l=a.x,c=a.y;let h=1/0;t=a;do{if(n>=t.x&&t.x>=l&&n!==t.x&&B9(s<c?n:r,s,l,c,s<c?r:n,s,t.x,t.y)){const d=Math.abs(s-t.y)/(n-t.x);nE(t,i)&&(d<h||d===h&&(t.x>a.x||t.x===a.x&&pae(a,t)))&&(a=t,h=d)}t=t.next}while(t!==o);return a}function pae(i,e){return Ls(i.prev,i,e.prev)<0&&Ls(e.next,i,i.next)<0}function mae(i,e,t,n){let s=i;do s.z===0&&(s.z=JL(s.x,s.y,e,t,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==i);s.prevZ.nextZ=null,s.prevZ=null,gae(s)}function gae(i){let e,t=1;do{let n=i,s;i=null;let r=null;for(e=0;n;){e++;let a=n,o=0;for(let c=0;c<t&&(o++,a=a.nextZ,!!a);c++);let l=t;for(;o>0||l>0&&a;)o!==0&&(l===0||!a||n.z<=a.z)?(s=n,n=n.nextZ,o--):(s=a,a=a.nextZ,l--),r?r.nextZ=s:i=s,s.prevZ=r,r=s;n=a}r.nextZ=null,t*=2}while(e>1);return i}function JL(i,e,t,n,s){return i=(i-t)*s|0,e=(e-n)*s|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function yae(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function B9(i,e,t,n,s,r,a,o){return(s-a)*(e-o)>=(i-a)*(r-o)&&(i-a)*(n-o)>=(t-a)*(e-o)&&(t-a)*(r-o)>=(s-a)*(n-o)}function Zb(i,e,t,n,s,r,a,o){return!(i===a&&e===o)&&B9(i,e,t,n,s,r,a,o)}function vae(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!xae(i,e)&&(nE(i,e)&&nE(e,i)&&bae(i,e)&&(Ls(i.prev,i,e.prev)||Ls(i,e.prev,e))||Nv(i,e)&&Ls(i.prev,i,i.next)>0&&Ls(e.prev,e,e.next)>0)}function Ls(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function Nv(i,e){return i.x===e.x&&i.y===e.y}function O9(i,e,t,n){const s=HS(Ls(i,e,t)),r=HS(Ls(i,e,n)),a=HS(Ls(t,n,i)),o=HS(Ls(t,n,e));return!!(s!==r&&a!==o||s===0&&FS(i,t,e)||r===0&&FS(i,n,e)||a===0&&FS(t,i,n)||o===0&&FS(t,e,n))}function FS(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function HS(i){return i>0?1:i<0?-1:0}function xae(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&O9(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function nE(i,e){return Ls(i.prev,i,i.next)<0?Ls(i,e,i.next)>=0&&Ls(i,i.prev,e)>=0:Ls(i,e,i.prev)<0||Ls(i,i.next,e)<0}function bae(i,e){let t=i,n=!1;const s=(i.x+e.x)/2,r=(i.y+e.y)/2;do t.y>r!=t.next.y>r&&t.next.y!==t.y&&s<(t.next.x-t.x)*(r-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function P9(i,e){const t=ZL(i.i,i.x,i.y),n=ZL(e.i,e.x,e.y),s=i.next,r=e.prev;return i.next=e,e.prev=i,t.next=s,s.prev=t,n.next=t,t.prev=n,r.next=n,n.prev=r,n}function MF(i,e,t,n){const s=ZL(i,e,t);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function iE(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function ZL(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Aae(i,e,t,n){let s=0;for(let r=e,a=t-n;r<t;r+=n)s+=(i[a]-i[r])*(i[r+1]+i[a+1]),a=r;return s}class Eae{static triangulate(e,t,n=2){return rae(e,t,n)}}class Gc{static area(e){const t=e.length;let n=0;for(let s=t-1,r=0;r<t;s=r++)n+=e[s].x*e[r].y-e[r].x*e[s].y;return n*.5}static isClockWise(e){return Gc.area(e)<0}static triangulateShape(e,t){const n=[],s=[],r=[];CF(e),RF(n,e);let a=e.length;t.forEach(CF);for(let l=0;l<t.length;l++)s.push(a),a+=t[l].length,RF(n,t[l]);const o=Eae.triangulate(n,s);for(let l=0;l<o.length;l+=3)r.push(o.slice(l,l+3));return r}}function CF(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function RF(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class xM extends Tn{constructor(e=new eg([new Qe(.5,.5),new Qe(-.5,.5),new Qe(-.5,-.5),new Qe(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,s=[],r=[];for(let o=0,l=e.length;o<l;o++){const c=e[o];a(c)}this.setAttribute("position",new Qt(s,3)),this.setAttribute("uv",new Qt(r,2)),this.computeVertexNormals();function a(o){const l=[],c=t.curveSegments!==void 0?t.curveSegments:12,h=t.steps!==void 0?t.steps:1,d=t.depth!==void 0?t.depth:1;let m=t.bevelEnabled!==void 0?t.bevelEnabled:!0,y=t.bevelThickness!==void 0?t.bevelThickness:.2,x=t.bevelSize!==void 0?t.bevelSize:y-.1,_=t.bevelOffset!==void 0?t.bevelOffset:0,b=t.bevelSegments!==void 0?t.bevelSegments:3;const A=t.extrudePath,T=t.UVGenerator!==void 0?t.UVGenerator:_ae;let w,R=!1,O,N,U,P;A&&(w=A.getSpacedPoints(h),R=!0,m=!1,O=A.computeFrenetFrames(h,!1),N=new se,U=new se,P=new se),m||(b=0,y=0,x=0,_=0);const B=o.extractPoints(c);let L=B.shape;const F=B.holes;if(!Gc.isClockWise(L)){L=L.reverse();for(let te=0,At=F.length;te<At;te++){const Ve=F[te];Gc.isClockWise(Ve)&&(F[te]=Ve.reverse())}}function J(te){const Ve=10000000000000001e-36;let st=te[0];for(let $e=1;$e<=te.length;$e++){const Pt=$e%te.length,nt=te[Pt],ee=nt.x-st.x,X=nt.y-st.y,we=ee*ee+X*X,Fe=Math.max(Math.abs(nt.x),Math.abs(nt.y),Math.abs(st.x),Math.abs(st.y)),ut=Ve*Fe*Fe;if(we<=ut){te.splice(Pt,1),$e--;continue}st=nt}}J(L),F.forEach(J);const re=F.length,q=L;for(let te=0;te<re;te++){const At=F[te];L=L.concat(At)}function W(te,At,Ve){return At||console.error("THREE.ExtrudeGeometry: vec does not exist"),te.clone().addScaledVector(At,Ve)}const ne=L.length;function ie(te,At,Ve){let st,$e,Pt;const nt=te.x-At.x,ee=te.y-At.y,X=Ve.x-te.x,we=Ve.y-te.y,Fe=nt*nt+ee*ee,ut=nt*we-ee*X;if(Math.abs(ut)>Number.EPSILON){const We=Math.sqrt(Fe),ot=Math.sqrt(X*X+we*we),et=At.x-ee/We,pt=At.y+nt/We,vt=Ve.x-we/ot,it=Ve.y+X/ot,Ct=((vt-et)*we-(it-pt)*X)/(nt*we-ee*X);st=et+nt*Ct-te.x,$e=pt+ee*Ct-te.y;const Et=st*st+$e*$e;if(Et<=2)return new Qe(st,$e);Pt=Math.sqrt(Et/2)}else{let We=!1;nt>Number.EPSILON?X>Number.EPSILON&&(We=!0):nt<-Number.EPSILON?X<-Number.EPSILON&&(We=!0):Math.sign(ee)===Math.sign(we)&&(We=!0),We?(st=-ee,$e=nt,Pt=Math.sqrt(Fe)):(st=nt,$e=ee,Pt=Math.sqrt(Fe/2))}return new Qe(st/Pt,$e/Pt)}const ue=[];for(let te=0,At=q.length,Ve=At-1,st=te+1;te<At;te++,Ve++,st++)Ve===At&&(Ve=0),st===At&&(st=0),ue[te]=ie(q[te],q[Ve],q[st]);const z=[];let ae,ge=ue.concat();for(let te=0,At=re;te<At;te++){const Ve=F[te];ae=[];for(let st=0,$e=Ve.length,Pt=$e-1,nt=st+1;st<$e;st++,Pt++,nt++)Pt===$e&&(Pt=0),nt===$e&&(nt=0),ae[st]=ie(Ve[st],Ve[Pt],Ve[nt]);z.push(ae),ge=ge.concat(ae)}let Ee;if(b===0)Ee=Gc.triangulateShape(q,F);else{const te=[],At=[];for(let Ve=0;Ve<b;Ve++){const st=Ve/b,$e=y*Math.cos(st*Math.PI/2),Pt=x*Math.sin(st*Math.PI/2)+_;for(let nt=0,ee=q.length;nt<ee;nt++){const X=W(q[nt],ue[nt],Pt);Mt(X.x,X.y,-$e),st===0&&te.push(X)}for(let nt=0,ee=re;nt<ee;nt++){const X=F[nt];ae=z[nt];const we=[];for(let Fe=0,ut=X.length;Fe<ut;Fe++){const We=W(X[Fe],ae[Fe],Pt);Mt(We.x,We.y,-$e),st===0&&we.push(We)}st===0&&At.push(we)}}Ee=Gc.triangulateShape(te,At)}const le=Ee.length,Ce=x+_;for(let te=0;te<ne;te++){const At=m?W(L[te],ge[te],Ce):L[te];R?(U.copy(O.normals[0]).multiplyScalar(At.x),N.copy(O.binormals[0]).multiplyScalar(At.y),P.copy(w[0]).add(U).add(N),Mt(P.x,P.y,P.z)):Mt(At.x,At.y,0)}for(let te=1;te<=h;te++)for(let At=0;At<ne;At++){const Ve=m?W(L[At],ge[At],Ce):L[At];R?(U.copy(O.normals[te]).multiplyScalar(Ve.x),N.copy(O.binormals[te]).multiplyScalar(Ve.y),P.copy(w[te]).add(U).add(N),Mt(P.x,P.y,P.z)):Mt(Ve.x,Ve.y,d/h*te)}for(let te=b-1;te>=0;te--){const At=te/b,Ve=y*Math.cos(At*Math.PI/2),st=x*Math.sin(At*Math.PI/2)+_;for(let $e=0,Pt=q.length;$e<Pt;$e++){const nt=W(q[$e],ue[$e],st);Mt(nt.x,nt.y,d+Ve)}for(let $e=0,Pt=F.length;$e<Pt;$e++){const nt=F[$e];ae=z[$e];for(let ee=0,X=nt.length;ee<X;ee++){const we=W(nt[ee],ae[ee],st);R?Mt(we.x,we.y+w[h-1].y,w[h-1].x+Ve):Mt(we.x,we.y,d+Ve)}}}Me(),Ze();function Me(){const te=s.length/3;if(m){let At=0,Ve=ne*At;for(let st=0;st<le;st++){const $e=Ee[st];bt($e[2]+Ve,$e[1]+Ve,$e[0]+Ve)}At=h+b*2,Ve=ne*At;for(let st=0;st<le;st++){const $e=Ee[st];bt($e[0]+Ve,$e[1]+Ve,$e[2]+Ve)}}else{for(let At=0;At<le;At++){const Ve=Ee[At];bt(Ve[2],Ve[1],Ve[0])}for(let At=0;At<le;At++){const Ve=Ee[At];bt(Ve[0]+ne*h,Ve[1]+ne*h,Ve[2]+ne*h)}}n.addGroup(te,s.length/3-te,0)}function Ze(){const te=s.length/3;let At=0;tt(q,At),At+=q.length;for(let Ve=0,st=F.length;Ve<st;Ve++){const $e=F[Ve];tt($e,At),At+=$e.length}n.addGroup(te,s.length/3-te,1)}function tt(te,At){let Ve=te.length;for(;--Ve>=0;){const st=Ve;let $e=Ve-1;$e<0&&($e=te.length-1);for(let Pt=0,nt=h+b*2;Pt<nt;Pt++){const ee=ne*Pt,X=ne*(Pt+1),we=At+st+ee,Fe=At+$e+ee,ut=At+$e+X,We=At+st+X;cn(we,Fe,ut,We)}}}function Mt(te,At,Ve){l.push(te),l.push(At),l.push(Ve)}function bt(te,At,Ve){tn(te),tn(At),tn(Ve);const st=s.length/3,$e=T.generateTopUV(n,s,st-3,st-2,st-1);Ot($e[0]),Ot($e[1]),Ot($e[2])}function cn(te,At,Ve,st){tn(te),tn(At),tn(st),tn(At),tn(Ve),tn(st);const $e=s.length/3,Pt=T.generateSideWallUV(n,s,$e-6,$e-3,$e-2,$e-1);Ot(Pt[0]),Ot(Pt[1]),Ot(Pt[3]),Ot(Pt[1]),Ot(Pt[2]),Ot(Pt[3])}function tn(te){s.push(l[te*3+0]),s.push(l[te*3+1]),s.push(l[te*3+2])}function Ot(te){r.push(te.x),r.push(te.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return Sae(t,n,e)}static fromJSON(e,t){const n=[];for(let r=0,a=e.shapes.length;r<a;r++){const o=t[e.shapes[r]];n.push(o)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new aw[s.type]().fromJSON(s)),new xM(n,e.options)}}const _ae={generateTopUV:function(i,e,t,n,s){const r=e[t*3],a=e[t*3+1],o=e[n*3],l=e[n*3+1],c=e[s*3],h=e[s*3+1];return[new Qe(r,a),new Qe(o,l),new Qe(c,h)]},generateSideWallUV:function(i,e,t,n,s,r){const a=e[t*3],o=e[t*3+1],l=e[t*3+2],c=e[n*3],h=e[n*3+1],d=e[n*3+2],m=e[s*3],y=e[s*3+1],x=e[s*3+2],_=e[r*3],b=e[r*3+1],A=e[r*3+2];return Math.abs(o-h)<Math.abs(a-c)?[new Qe(a,1-l),new Qe(c,1-d),new Qe(m,1-x),new Qe(_,1-A)]:[new Qe(o,1-l),new Qe(h,1-d),new Qe(y,1-x),new Qe(b,1-A)]}};function Sae(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,s=i.length;n<s;n++){const r=i[n];t.shapes.push(r.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class jE extends K0{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,s=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,r,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new jE(e.radius,e.detail)}}class bM extends Tn{constructor(e=[new Qe(0,-.5),new Qe(.5,0),new Qe(0,.5)],t=12,n=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:s},t=Math.floor(t),s=Rn(s,0,Math.PI*2);const r=[],a=[],o=[],l=[],c=[],h=1/t,d=new se,m=new Qe,y=new se,x=new se,_=new se;let b=0,A=0;for(let T=0;T<=e.length-1;T++)switch(T){case 0:b=e[T+1].x-e[T].x,A=e[T+1].y-e[T].y,y.x=A*1,y.y=-b,y.z=A*0,_.copy(y),y.normalize(),l.push(y.x,y.y,y.z);break;case e.length-1:l.push(_.x,_.y,_.z);break;default:b=e[T+1].x-e[T].x,A=e[T+1].y-e[T].y,y.x=A*1,y.y=-b,y.z=A*0,x.copy(y),y.x+=_.x,y.y+=_.y,y.z+=_.z,y.normalize(),l.push(y.x,y.y,y.z),_.copy(x)}for(let T=0;T<=t;T++){const w=n+T*h*s,R=Math.sin(w),O=Math.cos(w);for(let N=0;N<=e.length-1;N++){d.x=e[N].x*R,d.y=e[N].y,d.z=e[N].x*O,a.push(d.x,d.y,d.z),m.x=T/t,m.y=N/(e.length-1),o.push(m.x,m.y);const U=l[3*N+0]*R,P=l[3*N+1],B=l[3*N+0]*O;c.push(U,P,B)}}for(let T=0;T<t;T++)for(let w=0;w<e.length-1;w++){const R=w+T*e.length,O=R,N=R+e.length,U=R+e.length+1,P=R+1;r.push(O,N,P),r.push(U,P,N)}this.setIndex(r),this.setAttribute("position",new Qt(a,3)),this.setAttribute("uv",new Qt(o,2)),this.setAttribute("normal",new Qt(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bM(e.points,e.segments,e.phiStart,e.phiLength)}}class qE extends K0{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,s,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new qE(e.radius,e.detail)}}class W0 extends Tn{constructor(e=1,t=1,n=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:s};const r=e/2,a=t/2,o=Math.floor(n),l=Math.floor(s),c=o+1,h=l+1,d=e/o,m=t/l,y=[],x=[],_=[],b=[];for(let A=0;A<h;A++){const T=A*m-a;for(let w=0;w<c;w++){const R=w*d-r;x.push(R,-T,0),_.push(0,0,1),b.push(w/o),b.push(1-A/l)}}for(let A=0;A<l;A++)for(let T=0;T<o;T++){const w=T+c*A,R=T+c*(A+1),O=T+1+c*(A+1),N=T+1+c*A;y.push(w,R,N),y.push(R,O,N)}this.setIndex(y),this.setAttribute("position",new Qt(x,3)),this.setAttribute("normal",new Qt(_,3)),this.setAttribute("uv",new Qt(b,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new W0(e.width,e.height,e.widthSegments,e.heightSegments)}}class AM extends Tn{constructor(e=.5,t=1,n=32,s=1,r=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:s,thetaStart:r,thetaLength:a},n=Math.max(3,n),s=Math.max(1,s);const o=[],l=[],c=[],h=[];let d=e;const m=(t-e)/s,y=new se,x=new Qe;for(let _=0;_<=s;_++){for(let b=0;b<=n;b++){const A=r+b/n*a;y.x=d*Math.cos(A),y.y=d*Math.sin(A),l.push(y.x,y.y,y.z),c.push(0,0,1),x.x=(y.x/t+1)/2,x.y=(y.y/t+1)/2,h.push(x.x,x.y)}d+=m}for(let _=0;_<s;_++){const b=_*(n+1);for(let A=0;A<n;A++){const T=A+b,w=T,R=T+n+1,O=T+n+2,N=T+1;o.push(w,R,N),o.push(R,O,N)}}this.setIndex(o),this.setAttribute("position",new Qt(l,3)),this.setAttribute("normal",new Qt(c,3)),this.setAttribute("uv",new Qt(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new AM(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class EM extends Tn{constructor(e=new eg([new Qe(0,.5),new Qe(-.5,-.5),new Qe(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],s=[],r=[],a=[];let o=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let h=0;h<e.length;h++)c(e[h]),this.addGroup(o,l,h),o+=l,l=0;this.setIndex(n),this.setAttribute("position",new Qt(s,3)),this.setAttribute("normal",new Qt(r,3)),this.setAttribute("uv",new Qt(a,2));function c(h){const d=s.length/3,m=h.extractPoints(t);let y=m.shape;const x=m.holes;Gc.isClockWise(y)===!1&&(y=y.reverse());for(let b=0,A=x.length;b<A;b++){const T=x[b];Gc.isClockWise(T)===!0&&(x[b]=T.reverse())}const _=Gc.triangulateShape(y,x);for(let b=0,A=x.length;b<A;b++){const T=x[b];y=y.concat(T)}for(let b=0,A=y.length;b<A;b++){const T=y[b];s.push(T.x,T.y,0),r.push(0,0,1),a.push(T.x,T.y)}for(let b=0,A=_.length;b<A;b++){const T=_[b],w=T[0]+d,R=T[1]+d,O=T[2]+d;n.push(w,R,O),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return Tae(t,e)}static fromJSON(e,t){const n=[];for(let s=0,r=e.shapes.length;s<r;s++){const a=t[e.shapes[s]];n.push(a)}return new EM(n,e.curveSegments)}}function Tae(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const s=i[t];e.shapes.push(s.uuid)}else e.shapes.push(i.uuid);return e}class QE extends Tn{constructor(e=1,t=32,n=16,s=0,r=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:s,phiLength:r,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const l=Math.min(a+o,Math.PI);let c=0;const h=[],d=new se,m=new se,y=[],x=[],_=[],b=[];for(let A=0;A<=n;A++){const T=[],w=A/n;let R=0;A===0&&a===0?R=.5/t:A===n&&l===Math.PI&&(R=-.5/t);for(let O=0;O<=t;O++){const N=O/t;d.x=-e*Math.cos(s+N*r)*Math.sin(a+w*o),d.y=e*Math.cos(a+w*o),d.z=e*Math.sin(s+N*r)*Math.sin(a+w*o),x.push(d.x,d.y,d.z),m.copy(d).normalize(),_.push(m.x,m.y,m.z),b.push(N+R,1-w),T.push(c++)}h.push(T)}for(let A=0;A<n;A++)for(let T=0;T<t;T++){const w=h[A][T+1],R=h[A][T],O=h[A+1][T],N=h[A+1][T+1];(A!==0||a>0)&&y.push(w,R,N),(A!==n-1||l<Math.PI)&&y.push(R,O,N)}this.setIndex(y),this.setAttribute("position",new Qt(x,3)),this.setAttribute("normal",new Qt(_,3)),this.setAttribute("uv",new Qt(b,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new QE(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class _M extends K0{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,s,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new _M(e.radius,e.detail)}}class SM extends Tn{constructor(e=1,t=.4,n=12,s=48,r=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:s,arc:r},n=Math.floor(n),s=Math.floor(s);const a=[],o=[],l=[],c=[],h=new se,d=new se,m=new se;for(let y=0;y<=n;y++)for(let x=0;x<=s;x++){const _=x/s*r,b=y/n*Math.PI*2;d.x=(e+t*Math.cos(b))*Math.cos(_),d.y=(e+t*Math.cos(b))*Math.sin(_),d.z=t*Math.sin(b),o.push(d.x,d.y,d.z),h.x=e*Math.cos(_),h.y=e*Math.sin(_),m.subVectors(d,h).normalize(),l.push(m.x,m.y,m.z),c.push(x/s),c.push(y/n)}for(let y=1;y<=n;y++)for(let x=1;x<=s;x++){const _=(s+1)*y+x-1,b=(s+1)*(y-1)+x-1,A=(s+1)*(y-1)+x,T=(s+1)*y+x;a.push(_,b,T),a.push(b,A,T)}this.setIndex(a),this.setAttribute("position",new Qt(o,3)),this.setAttribute("normal",new Qt(l,3)),this.setAttribute("uv",new Qt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new SM(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class TM extends Tn{constructor(e=1,t=.4,n=64,s=8,r=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:s,p:r,q:a},n=Math.floor(n),s=Math.floor(s);const o=[],l=[],c=[],h=[],d=new se,m=new se,y=new se,x=new se,_=new se,b=new se,A=new se;for(let w=0;w<=n;++w){const R=w/n*r*Math.PI*2;T(R,r,a,e,y),T(R+.01,r,a,e,x),b.subVectors(x,y),A.addVectors(x,y),_.crossVectors(b,A),A.crossVectors(_,b),_.normalize(),A.normalize();for(let O=0;O<=s;++O){const N=O/s*Math.PI*2,U=-t*Math.cos(N),P=t*Math.sin(N);d.x=y.x+(U*A.x+P*_.x),d.y=y.y+(U*A.y+P*_.y),d.z=y.z+(U*A.z+P*_.z),l.push(d.x,d.y,d.z),m.subVectors(d,y).normalize(),c.push(m.x,m.y,m.z),h.push(w/n),h.push(O/s)}}for(let w=1;w<=n;w++)for(let R=1;R<=s;R++){const O=(s+1)*(w-1)+(R-1),N=(s+1)*w+(R-1),U=(s+1)*w+R,P=(s+1)*(w-1)+R;o.push(O,N,P),o.push(N,U,P)}this.setIndex(o),this.setAttribute("position",new Qt(l,3)),this.setAttribute("normal",new Qt(c,3)),this.setAttribute("uv",new Qt(h,2));function T(w,R,O,N,U){const P=Math.cos(w),B=Math.sin(w),L=O/R*w,F=Math.cos(L);U.x=N*(2+F)*.5*P,U.y=N*(2+F)*B*.5,U.z=N*Math.sin(L)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new TM(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class wM extends Tn{constructor(e=new eO(new se(-1,-1,0),new se(-1,1,0),new se(1,1,0)),t=64,n=1,s=8,r=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:s,closed:r};const a=e.computeFrenetFrames(t,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new se,l=new se,c=new Qe;let h=new se;const d=[],m=[],y=[],x=[];_(),this.setIndex(x),this.setAttribute("position",new Qt(d,3)),this.setAttribute("normal",new Qt(m,3)),this.setAttribute("uv",new Qt(y,2));function _(){for(let w=0;w<t;w++)b(w);b(r===!1?t:0),T(),A()}function b(w){h=e.getPointAt(w/t,h);const R=a.normals[w],O=a.binormals[w];for(let N=0;N<=s;N++){const U=N/s*Math.PI*2,P=Math.sin(U),B=-Math.cos(U);l.x=B*R.x+P*O.x,l.y=B*R.y+P*O.y,l.z=B*R.z+P*O.z,l.normalize(),m.push(l.x,l.y,l.z),o.x=h.x+n*l.x,o.y=h.y+n*l.y,o.z=h.z+n*l.z,d.push(o.x,o.y,o.z)}}function A(){for(let w=1;w<=t;w++)for(let R=1;R<=s;R++){const O=(s+1)*(w-1)+(R-1),N=(s+1)*w+(R-1),U=(s+1)*w+R,P=(s+1)*(w-1)+R;x.push(O,N,P),x.push(N,U,P)}}function T(){for(let w=0;w<=t;w++)for(let R=0;R<=s;R++)c.x=w/t,c.y=R/s,y.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new wM(new aw[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class N9 extends Tn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,s=new se,r=new se;if(e.index!==null){const a=e.attributes.position,o=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:o.count,materialIndex:0}]);for(let c=0,h=l.length;c<h;++c){const d=l[c],m=d.start,y=d.count;for(let x=m,_=m+y;x<_;x+=3)for(let b=0;b<3;b++){const A=o.getX(x+b),T=o.getX(x+(b+1)%3);s.fromBufferAttribute(a,A),r.fromBufferAttribute(a,T),DF(s,r,n)===!0&&(t.push(s.x,s.y,s.z),t.push(r.x,r.y,r.z))}}}else{const a=e.attributes.position;for(let o=0,l=a.count/3;o<l;o++)for(let c=0;c<3;c++){const h=3*o+c,d=3*o+(c+1)%3;s.fromBufferAttribute(a,h),r.fromBufferAttribute(a,d),DF(s,r,n)===!0&&(t.push(s.x,s.y,s.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new Qt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function DF(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(s)===!0?!1:(t.add(n),t.add(s),!0)}var LF=Object.freeze({__proto__:null,BoxGeometry:wg,CapsuleGeometry:mM,CircleGeometry:gM,ConeGeometry:XE,CylinderGeometry:WE,DodecahedronGeometry:yM,EdgesGeometry:w9,ExtrudeGeometry:xM,IcosahedronGeometry:jE,LatheGeometry:bM,OctahedronGeometry:qE,PlaneGeometry:W0,PolyhedronGeometry:K0,RingGeometry:AM,ShapeGeometry:EM,SphereGeometry:QE,TetrahedronGeometry:_M,TorusGeometry:SM,TorusKnotGeometry:TM,TubeGeometry:wM,WireframeGeometry:N9});class U9 extends ur{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ut(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class k9 extends js{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class qv extends ur{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Ut(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Y0,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new il,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Gl extends qv{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Qe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Rn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ut(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ut(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ut(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class F9 extends ur{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ut(16777215),this.specular=new Ut(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Y0,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new il,this.combine=UE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class H9 extends ur{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ut(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Y0,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class nO extends ur{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Y0,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class G9 extends ur{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Y0,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new il,this.combine=UE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class iO extends ur{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=V0,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class sO extends ur{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class z9 extends ur{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ut(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Y0,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class V9 extends Oa{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Sm(i,e){return!i||i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function Y9(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function K9(i){function e(s,r){return i[s]-i[r]}const t=i.length,n=new Array(t);for(let s=0;s!==t;++s)n[s]=s;return n.sort(e),n}function eI(i,e,t){const n=i.length,s=new i.constructor(n);for(let r=0,a=0;a!==n;++r){const o=t[r]*e;for(let l=0;l!==e;++l)s[a++]=i[o+l]}return s}function rO(i,e,t,n){let s=1,r=i[0];for(;r!==void 0&&r[n]===void 0;)r=i[s++];if(r===void 0)return;let a=r[n];if(a!==void 0)if(Array.isArray(a))do a=r[n],a!==void 0&&(e.push(r.time),t.push(...a)),r=i[s++];while(r!==void 0);else if(a.toArray!==void 0)do a=r[n],a!==void 0&&(e.push(r.time),a.toArray(t,t.length)),r=i[s++];while(r!==void 0);else do a=r[n],a!==void 0&&(e.push(r.time),t.push(a)),r=i[s++];while(r!==void 0)}function wae(i,e,t,n,s=30){const r=i.clone();r.name=e;const a=[];for(let l=0;l<r.tracks.length;++l){const c=r.tracks[l],h=c.getValueSize(),d=[],m=[];for(let y=0;y<c.times.length;++y){const x=c.times[y]*s;if(!(x<t||x>=n)){d.push(c.times[y]);for(let _=0;_<h;++_)m.push(c.values[y*h+_])}}d.length!==0&&(c.times=Sm(d,c.times.constructor),c.values=Sm(m,c.values.constructor),a.push(c))}r.tracks=a;let o=1/0;for(let l=0;l<r.tracks.length;++l)o>r.tracks[l].times[0]&&(o=r.tracks[l].times[0]);for(let l=0;l<r.tracks.length;++l)r.tracks[l].shift(-1*o);return r.resetDuration(),r}function Mae(i,e=0,t=i,n=30){n<=0&&(n=30);const s=t.tracks.length,r=e/n;for(let a=0;a<s;++a){const o=t.tracks[a],l=o.ValueTypeName;if(l==="bool"||l==="string")continue;const c=i.tracks.find(function(A){return A.name===o.name&&A.ValueTypeName===l});if(c===void 0)continue;let h=0;const d=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=d/3);let m=0;const y=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=y/3);const x=o.times.length-1;let _;if(r<=o.times[0]){const A=h,T=d-h;_=o.values.slice(A,T)}else if(r>=o.times[x]){const A=x*d+h,T=A+d-h;_=o.values.slice(A,T)}else{const A=o.createInterpolant(),T=h,w=d-h;A.evaluate(r),_=A.resultBuffer.slice(T,w)}l==="quaternion"&&new Yr().fromArray(_).normalize().conjugate().toArray(_);const b=c.times.length;for(let A=0;A<b;++A){const T=A*y+m;if(l==="quaternion")Yr.multiplyQuaternionsFlat(c.values,T,_,0,c.values,T);else{const w=y-m*2;for(let R=0;R<w;++R)c.values[T+R]-=_[R]}}}return i.blendMode=kB,i}class Cae{static convertArray(e,t){return Sm(e,t)}static isTypedArray(e){return Y9(e)}static getKeyframeOrder(e){return K9(e)}static sortedArray(e,t,n){return eI(e,t,n)}static flattenJSON(e,t,n,s){rO(e,t,n,s)}static subclip(e,t,n,s,r=30){return wae(e,t,n,s,r)}static makeClipAdditive(e,t=0,n=e,s=30){return Mae(e,t,n,s)}}class Qv{constructor(e,t,n,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,s=t[n],r=t[n-1];e:{t:{let a;n:{i:if(!(e<s)){for(let o=n+2;;){if(s===void 0){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(r=s,s=t[++n],e<s)break t}a=t.length;break n}if(!(e>=r)){const o=t[1];e<o&&(n=2,r=o);for(let l=n-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(s=r,r=t[--n-1],e>=r)break t}a=n,n=0;break n}break e}for(;n<a;){const o=n+a>>>1;e<t[o]?a=o:n=o+1}if(s=t[n],r=t[n-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,s)}return this.interpolate_(n,r,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,r=e*s;for(let a=0;a!==s;++a)t[a]=n[r+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class W9 extends Qv{constructor(e,t,n,s){super(e,t,n,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Am,endingEnd:Am}}intervalChanged_(e,t,n){const s=this.parameterPositions;let r=e-2,a=e+1,o=s[r],l=s[a];if(o===void 0)switch(this.getSettings_().endingStart){case Em:r=e,o=2*t-n;break;case QA:r=s.length-2,o=t+s[r]-s[r+1];break;default:r=e,o=n}if(l===void 0)switch(this.getSettings_().endingEnd){case Em:a=e,l=2*n-t;break;case QA:a=1,l=n+s[1]-s[0];break;default:a=e-1,l=t}const c=(n-t)*.5,h=this.valueSize;this._weightPrev=c/(t-o),this._weightNext=c/(l-n),this._offsetPrev=r*h,this._offsetNext=a*h}interpolate_(e,t,n,s){const r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,h=this._offsetPrev,d=this._offsetNext,m=this._weightPrev,y=this._weightNext,x=(n-t)/(s-t),_=x*x,b=_*x,A=-m*b+2*m*_-m*x,T=(1+m)*b+(-1.5-2*m)*_+(-.5+m)*x+1,w=(-1-y)*b+(1.5+y)*_+.5*x,R=y*b-y*_;for(let O=0;O!==o;++O)r[O]=A*a[h+O]+T*a[c+O]+w*a[l+O]+R*a[d+O];return r}}class aO extends Qv{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,h=(n-t)/(s-t),d=1-h;for(let m=0;m!==o;++m)r[m]=a[c+m]*d+a[l+m]*h;return r}}class X9 extends Qv{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class zl{constructor(e,t,n,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Sm(t,this.TimeBufferType),this.values=Sm(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Sm(e.times,Array),values:Sm(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(n.interpolation=s)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new X9(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new aO(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new W9(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Lv:t=this.InterpolantFactoryMethodDiscrete;break;case Iv:t=this.InterpolantFactoryMethodLinear;break;case HT:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Lv;case this.InterpolantFactoryMethodLinear:return Iv;case this.InterpolantFactoryMethodSmooth:return HT}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]*=e}return this}trim(e,t){const n=this.times,s=n.length;let r=0,a=s-1;for(;r!==s&&n[r]<e;)++r;for(;a!==-1&&n[a]>t;)--a;if(++a,r!==0||a!==s){r>=a&&(a=Math.max(a,1),r=a-1);const o=this.getValueSize();this.times=n.slice(r,a),this.values=this.values.slice(r*o,a*o)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,s=this.values,r=n.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==r;o++){const l=n[o];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,l),e=!1;break}if(a!==null&&a>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,l,a),e=!1;break}a=l}if(s!==void 0&&Y9(s))for(let o=0,l=s.length;o!==l;++o){const c=s[o];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),s=this.getInterpolation()===HT,r=e.length-1;let a=1;for(let o=1;o<r;++o){let l=!1;const c=e[o],h=e[o+1];if(c!==h&&(o!==1||c!==e[0]))if(s)l=!0;else{const d=o*n,m=d-n,y=d+n;for(let x=0;x!==n;++x){const _=t[d+x];if(_!==t[m+x]||_!==t[y+x]){l=!0;break}}}if(l){if(o!==a){e[a]=e[o];const d=o*n,m=a*n;for(let y=0;y!==n;++y)t[m+y]=t[d+y]}++a}}if(r>0){e[a]=e[r];for(let o=r*n,l=a*n,c=0;c!==n;++c)t[l+c]=t[o+c];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,s=new n(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}zl.prototype.ValueTypeName="";zl.prototype.TimeBufferType=Float32Array;zl.prototype.ValueBufferType=Float32Array;zl.prototype.DefaultInterpolation=Iv;class Mg extends zl{constructor(e,t,n){super(e,t,n)}}Mg.prototype.ValueTypeName="bool";Mg.prototype.ValueBufferType=Array;Mg.prototype.DefaultInterpolation=Lv;Mg.prototype.InterpolantFactoryMethodLinear=void 0;Mg.prototype.InterpolantFactoryMethodSmooth=void 0;class oO extends zl{constructor(e,t,n,s){super(e,t,n,s)}}oO.prototype.ValueTypeName="color";class gg extends zl{constructor(e,t,n,s){super(e,t,n,s)}}gg.prototype.ValueTypeName="number";class j9 extends Qv{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=(n-t)/(s-t);let c=e*o;for(let h=c+o;c!==h;c+=4)Yr.slerpFlat(r,0,a,c-o,a,c,l);return r}}class yg extends zl{constructor(e,t,n,s){super(e,t,n,s)}InterpolantFactoryMethodLinear(e){return new j9(this.times,this.values,this.getValueSize(),e)}}yg.prototype.ValueTypeName="quaternion";yg.prototype.InterpolantFactoryMethodSmooth=void 0;class Cg extends zl{constructor(e,t,n){super(e,t,n)}}Cg.prototype.ValueTypeName="string";Cg.prototype.ValueBufferType=Array;Cg.prototype.DefaultInterpolation=Lv;Cg.prototype.InterpolantFactoryMethodLinear=void 0;Cg.prototype.InterpolantFactoryMethodSmooth=void 0;class vg extends zl{constructor(e,t,n,s){super(e,t,n,s)}}vg.prototype.ValueTypeName="vector";class Uv{constructor(e="",t=-1,n=[],s=aM){this.name=e,this.tracks=n,this.duration=t,this.blendMode=s,this.uuid=tl(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,s=1/(e.fps||1);for(let a=0,o=n.length;a!==o;++a)t.push(Dae(n[a]).scale(s));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){const t=[],n=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,a=n.length;r!==a;++r)t.push(zl.toJSON(n[r]));return s}static CreateFromMorphTargetSequence(e,t,n,s){const r=t.length,a=[];for(let o=0;o<r;o++){let l=[],c=[];l.push((o+r-1)%r,o,(o+1)%r),c.push(0,1,0);const h=K9(l);l=eI(l,1,h),c=eI(c,1,h),!s&&l[0]===0&&(l.push(r),c.push(c[0])),a.push(new gg(".morphTargetInfluences["+t[o].name+"]",l,c).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const s=e;n=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<n.length;s++)if(n[s].name===t)return n[s];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const s={},r=/^([\w-]*?)([\d]+)$/;for(let o=0,l=e.length;o<l;o++){const c=e[o],h=c.name.match(r);if(h&&h.length>1){const d=h[1];let m=s[d];m||(s[d]=m=[]),m.push(c)}}const a=[];for(const o in s)a.push(this.CreateFromMorphTargetSequence(o,s[o],t,n));return a}static parseAnimation(e,t){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(d,m,y,x,_){if(y.length!==0){const b=[],A=[];rO(y,b,A,x),b.length!==0&&_.push(new d(m,b,A))}},s=[],r=e.name||"default",a=e.fps||30,o=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const m=c[d].keys;if(!(!m||m.length===0))if(m[0].morphTargets){const y={};let x;for(x=0;x<m.length;x++)if(m[x].morphTargets)for(let _=0;_<m[x].morphTargets.length;_++)y[m[x].morphTargets[_]]=-1;for(const _ in y){const b=[],A=[];for(let T=0;T!==m[x].morphTargets.length;++T){const w=m[x];b.push(w.time),A.push(w.morphTarget===_?1:0)}s.push(new gg(".morphTargetInfluence["+_+"]",b,A))}l=y.length*a}else{const y=".bones["+t[d].name+"]";n(vg,y+".position",m,"pos",s),n(yg,y+".quaternion",m,"rot",s),n(vg,y+".scale",m,"scl",s)}}return s.length===0?null:new this(r,l,s,o)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,s=e.length;n!==s;++n){const r=this.tracks[n];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Rae(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return gg;case"vector":case"vector2":case"vector3":case"vector4":return vg;case"color":return oO;case"quaternion":return yg;case"bool":case"boolean":return Mg;case"string":return Cg}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function Dae(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Rae(i.type);if(i.times===void 0){const t=[],n=[];rO(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const Pf={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class MM{constructor(e,t,n){const s=this;let r=!1,a=0,o=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(h){o++,r===!1&&s.onStart!==void 0&&s.onStart(h,a,o),r=!0},this.itemEnd=function(h){a++,s.onProgress!==void 0&&s.onProgress(h,a,o),a===o&&(r=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(h){s.onError!==void 0&&s.onError(h)},this.resolveURL=function(h){return l?l(h):h},this.setURLModifier=function(h){return l=h,this},this.addHandler=function(h,d){return c.push(h,d),this},this.removeHandler=function(h){const d=c.indexOf(h);return d!==-1&&c.splice(d,2),this},this.getHandler=function(h){for(let d=0,m=c.length;d<m;d+=2){const y=c[d],x=c[d+1];if(y.global&&(y.lastIndex=0),y.test(h))return x}return null}}}const q9=new MM;class ha{constructor(e){this.manager=e!==void 0?e:q9,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(s,r){n.load(e,s,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}ha.DEFAULT_MATERIAL_NAME="__DEFAULT";const tf={};class Lae extends Error{constructor(e,t){super(e),this.response=t}}class ua extends ha{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,t,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=Pf.get(e);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(tf[e]!==void 0){tf[e].push({onLoad:t,onProgress:n,onError:s});return}tf[e]=[],tf[e].push({onLoad:t,onProgress:n,onError:s});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,l=this.responseType;fetch(a).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const h=tf[e],d=c.body.getReader(),m=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),y=m?parseInt(m):0,x=y!==0;let _=0;const b=new ReadableStream({start(A){T();function T(){d.read().then(({done:w,value:R})=>{if(w)A.close();else{_+=R.byteLength;const O=new ProgressEvent("progress",{lengthComputable:x,loaded:_,total:y});for(let N=0,U=h.length;N<U;N++){const P=h[N];P.onProgress&&P.onProgress(O)}A.enqueue(R),T()}},w=>{A.error(w)})}}});return new Response(b)}else throw new Lae(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(h=>new DOMParser().parseFromString(h,o));case"json":return c.json();default:if(o==="")return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(o),m=d&&d[1]?d[1].toLowerCase():void 0,y=new TextDecoder(m);return c.arrayBuffer().then(x=>y.decode(x))}}}).then(c=>{Pf.add(e,c);const h=tf[e];delete tf[e];for(let d=0,m=h.length;d<m;d++){const y=h[d];y.onLoad&&y.onLoad(c)}}).catch(c=>{const h=tf[e];if(h===void 0)throw this.manager.itemError(e),c;delete tf[e];for(let d=0,m=h.length;d<m;d++){const y=h[d];y.onError&&y.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Iae extends ha{constructor(e){super(e)}load(e,t,n,s){const r=this,a=new ua(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{t(r.parse(JSON.parse(o)))}catch(l){s?s(l):console.error(l),r.manager.itemError(e)}},n,s)}parse(e){const t=[];for(let n=0;n<e.length;n++){const s=Uv.parse(e[n]);t.push(s)}return t}}class Bae extends ha{constructor(e){super(e)}load(e,t,n,s){const r=this,a=[],o=new pM,l=new ua(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(r.withCredentials);let c=0;function h(d){l.load(e[d],function(m){const y=r.parse(m,!0);a[d]={width:y.width,height:y.height,format:y.format,mipmaps:y.mipmaps},c+=1,c===6&&(y.mipmapCount===1&&(o.minFilter=ei),o.image=a,o.format=y.format,o.needsUpdate=!0,t&&t(o))},n,s)}if(Array.isArray(e))for(let d=0,m=e.length;d<m;++d)h(d);else l.load(e,function(d){const m=r.parse(d,!0);if(m.isCubemap){const y=m.mipmaps.length/m.mipmapCount;for(let x=0;x<y;x++){a[x]={mipmaps:[]};for(let _=0;_<m.mipmapCount;_++)a[x].mipmaps.push(m.mipmaps[x*m.mipmapCount+_]),a[x].format=m.format,a[x].width=m.width,a[x].height=m.height}o.image=a}else o.image.width=m.width,o.image.height=m.height,o.mipmaps=m.mipmaps;m.mipmapCount===1&&(o.minFilter=ei),o.format=m.format,o.needsUpdate=!0,t&&t(o)},n,s);return o}}class sE extends ha{constructor(e){super(e)}load(e,t,n,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,a=Pf.get(e);if(a!==void 0)return r.manager.itemStart(e),setTimeout(function(){t&&t(a),r.manager.itemEnd(e)},0),a;const o=eE("img");function l(){h(),Pf.add(e,this),t&&t(this),r.manager.itemEnd(e)}function c(d){h(),s&&s(d),r.manager.itemError(e),r.manager.itemEnd(e)}function h(){o.removeEventListener("load",l,!1),o.removeEventListener("error",c,!1)}return o.addEventListener("load",l,!1),o.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(e),o.src=e,o}}class Q9 extends ha{constructor(e){super(e)}load(e,t,n,s){const r=new VE;r.colorSpace=bi;const a=new sE(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function l(c){a.load(e[c],function(h){r.images[c]=h,o++,o===6&&(r.needsUpdate=!0,t&&t(r))},void 0,s)}for(let c=0;c<e.length;++c)l(c);return r}}class lO extends ha{constructor(e){super(e)}load(e,t,n,s){const r=this,a=new Yc,o=new ua(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(r.withCredentials),o.load(e,function(l){let c;try{c=r.parse(l)}catch(h){if(s!==void 0)s(h);else{console.error(h);return}}c.image!==void 0?a.image=c.image:c.data!==void 0&&(a.image.width=c.width,a.image.height=c.height,a.image.data=c.data),a.wrapS=c.wrapS!==void 0?c.wrapS:sr,a.wrapT=c.wrapT!==void 0?c.wrapT:sr,a.magFilter=c.magFilter!==void 0?c.magFilter:ei,a.minFilter=c.minFilter!==void 0?c.minFilter:ei,a.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0&&(a.colorSpace=c.colorSpace),c.flipY!==void 0&&(a.flipY=c.flipY),c.format!==void 0&&(a.format=c.format),c.type!==void 0&&(a.type=c.type),c.mipmaps!==void 0&&(a.mipmaps=c.mipmaps,a.minFilter=Nl),c.mipmapCount===1&&(a.minFilter=ei),c.generateMipmaps!==void 0&&(a.generateMipmaps=c.generateMipmaps),a.needsUpdate=!0,t&&t(a,c)},n,s),a}}class $9 extends ha{constructor(e){super(e)}load(e,t,n,s){const r=new wi,a=new sE(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){r.image=o,r.needsUpdate=!0,t!==void 0&&t(r)},n,s),r}}class X0 extends li{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ut(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class J9 extends X0{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(li.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ut(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const jR=new hn,IF=new se,BF=new se;class cO{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Qe(512,512),this.mapType=Xs,this.map=null,this.mapPass=null,this.matrix=new hn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Xv,this._frameExtents=new Qe(1,1),this._viewportCount=1,this._viewports=[new ai(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;IF.setFromMatrixPosition(e.matrixWorld),t.position.copy(IF),BF.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(BF),t.updateMatrixWorld(),jR.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(jR),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(jR)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Oae extends cO{constructor(){super(new Ds(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=Bv*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(n!==t.fov||s!==t.aspect||r!==t.far)&&(t.fov=n,t.aspect=s,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class uO extends X0{constructor(e,t,n=0,s=Math.PI/3,r=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(li.DEFAULT_UP),this.updateMatrix(),this.target=new li,this.distance=n,this.angle=s,this.penumbra=r,this.decay=a,this.map=null,this.shadow=new Oae}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const OF=new hn,Ob=new se,qR=new se;class Pae extends cO{constructor(){super(new Ds(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Qe(4,2),this._viewportCount=6,this._viewports=[new ai(2,1,1,1),new ai(0,1,1,1),new ai(3,1,1,1),new ai(1,1,1,1),new ai(3,0,1,1),new ai(1,0,1,1)],this._cubeDirections=[new se(1,0,0),new se(-1,0,0),new se(0,0,1),new se(0,0,-1),new se(0,1,0),new se(0,-1,0)],this._cubeUps=[new se(0,1,0),new se(0,1,0),new se(0,1,0),new se(0,1,0),new se(0,0,1),new se(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,s=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),Ob.setFromMatrixPosition(e.matrixWorld),n.position.copy(Ob),qR.copy(n.position),qR.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(qR),n.updateMatrixWorld(),s.makeTranslation(-Ob.x,-Ob.y,-Ob.z),OF.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(OF)}}class hO extends X0{constructor(e,t,n=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=s,this.shadow=new Pae}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class fh extends zE{constructor(e=-1,t=1,n=1,s=-1,r=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=s,this.near=r,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,s,r,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let r=n-e,a=n+e,o=s+t,l=s-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=c*this.view.offsetX,a=r+c*this.view.width,o-=h*this.view.offsetY,l=o-h*this.view.height}this.projectionMatrix.makeOrthographic(r,a,o,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class Nae extends cO{constructor(){super(new fh(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class fO extends X0{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(li.DEFAULT_UP),this.updateMatrix(),this.target=new li,this.shadow=new Nae}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Z9 extends X0{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class eV extends X0{constructor(e,t,n=10,s=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class tV{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new se)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,s=e.y,r=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*s),t.addScaledVector(a[2],.488603*r),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],1.092548*(n*s)),t.addScaledVector(a[5],1.092548*(s*r)),t.addScaledVector(a[6],.315392*(3*r*r-1)),t.addScaledVector(a[7],1.092548*(n*r)),t.addScaledVector(a[8],.546274*(n*n-s*s)),t}getIrradianceAt(e,t){const n=e.x,s=e.y,r=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*s),t.addScaledVector(a[2],2*.511664*r),t.addScaledVector(a[3],2*.511664*n),t.addScaledVector(a[4],2*.429043*n*s),t.addScaledVector(a[5],2*.429043*s*r),t.addScaledVector(a[6],.743125*r*r-.247708),t.addScaledVector(a[7],2*.429043*n*r),t.addScaledVector(a[8],.429043*(n*n-s*s)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].fromArray(e,t+s*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].toArray(e,t+s*3);return e}static getBasisAt(e,t){const n=e.x,s=e.y,r=e.z;t[0]=.282095,t[1]=.488603*s,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*s,t[5]=1.092548*s*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-s*s)}}class nV extends X0{constructor(e=new tV,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class CM extends ha{constructor(e){super(e),this.textures={}}load(e,t,n,s){const r=this,a=new ua(r.manager);a.setPath(r.path),a.setRequestHeader(r.requestHeader),a.setWithCredentials(r.withCredentials),a.load(e,function(o){try{t(r.parse(JSON.parse(o)))}catch(l){s?s(l):console.error(l),r.manager.itemError(e)}},n,s)}parse(e){const t=this.textures;function n(r){return t[r]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",r),t[r]}const s=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new Ut().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(s.dispersion=e.dispersion),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const r in e.uniforms){const a=e.uniforms[r];switch(s.uniforms[r]={},a.type){case"t":s.uniforms[r].value=n(a.value);break;case"c":s.uniforms[r].value=new Ut().setHex(a.value);break;case"v2":s.uniforms[r].value=new Qe().fromArray(a.value);break;case"v3":s.uniforms[r].value=new se().fromArray(a.value);break;case"v4":s.uniforms[r].value=new ai().fromArray(a.value);break;case"m3":s.uniforms[r].value=new Bn().fromArray(a.value);break;case"m4":s.uniforms[r].value=new hn().fromArray(a.value);break;default:s.uniforms[r].value=a.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const r in e.extensions)s.extensions[r]=e.extensions[r];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=n(e.map)),e.matcap!==void 0&&(s.matcap=n(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let r=e.normalScale;Array.isArray(r)===!1&&(r=[r,r]),s.normalScale=new Qe().fromArray(r)}return e.displacementMap!==void 0&&(s.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=n(e.envMap)),e.envMapRotation!==void 0&&s.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new Qe().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=n(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return CM.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:U9,SpriteMaterial:KB,RawShaderMaterial:k9,ShaderMaterial:js,PointsMaterial:dM,MeshPhysicalMaterial:Gl,MeshStandardMaterial:qv,MeshPhongMaterial:F9,MeshToonMaterial:H9,MeshNormalMaterial:nO,MeshLambertMaterial:G9,MeshDepthMaterial:iO,MeshDistanceMaterial:sO,MeshBasicMaterial:Co,MeshMatcapMaterial:z9,LineDashedMaterial:V9,LineBasicMaterial:Oa,Material:ur};return new t[e]}}class R0{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class iV extends Tn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class sV extends ha{constructor(e){super(e)}load(e,t,n,s){const r=this,a=new ua(r.manager);a.setPath(r.path),a.setRequestHeader(r.requestHeader),a.setWithCredentials(r.withCredentials),a.load(e,function(o){try{t(r.parse(JSON.parse(o)))}catch(l){s?s(l):console.error(l),r.manager.itemError(e)}},n,s)}parse(e){const t={},n={};function s(y,x){if(t[x]!==void 0)return t[x];const b=y.interleavedBuffers[x],A=r(y,b.buffer),T=fy(b.type,A),w=new YE(T,b.stride);return w.uuid=b.uuid,t[x]=w,w}function r(y,x){if(n[x]!==void 0)return n[x];const b=y.arrayBuffers[x],A=new Uint32Array(b).buffer;return n[x]=A,A}const a=e.isInstancedBufferGeometry?new iV:new Tn,o=e.data.index;if(o!==void 0){const y=fy(o.type,o.array);a.setIndex(new ci(y,1))}const l=e.data.attributes;for(const y in l){const x=l[y];let _;if(x.isInterleavedBufferAttribute){const b=s(e.data,x.data);_=new k0(b,x.itemSize,x.offset,x.normalized)}else{const b=fy(x.type,x.array),A=x.isInstancedBufferAttribute?pg:ci;_=new A(b,x.itemSize,x.normalized)}x.name!==void 0&&(_.name=x.name),x.usage!==void 0&&_.setUsage(x.usage),a.setAttribute(y,_)}const c=e.data.morphAttributes;if(c)for(const y in c){const x=c[y],_=[];for(let b=0,A=x.length;b<A;b++){const T=x[b];let w;if(T.isInterleavedBufferAttribute){const R=s(e.data,T.data);w=new k0(R,T.itemSize,T.offset,T.normalized)}else{const R=fy(T.type,T.array);w=new ci(R,T.itemSize,T.normalized)}T.name!==void 0&&(w.name=T.name),_.push(w)}a.morphAttributes[y]=_}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const d=e.data.groups||e.data.drawcalls||e.data.offsets;if(d!==void 0)for(let y=0,x=d.length;y!==x;++y){const _=d[y];a.addGroup(_.start,_.count,_.materialIndex)}const m=e.data.boundingSphere;if(m!==void 0){const y=new se;m.center!==void 0&&y.fromArray(m.center),a.boundingSphere=new Kr(y,m.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class Uae extends ha{constructor(e){super(e)}load(e,t,n,s){const r=this,a=this.path===""?R0.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new ua(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(d){s!==void 0&&s(d),console.error("THREE:ObjectLoader: Can't parse "+e+".",d.message);return}const h=c.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}r.parse(c,t)},n,s)}async loadAsync(e,t){const n=this,s=this.path===""?R0.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const r=new ua(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const a=await r.loadAsync(e,t),o=JSON.parse(a),l=o.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(o)}parse(e,t){const n=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,s),a=this.parseImages(e.images,function(){t!==void 0&&t(c)}),o=this.parseTextures(e.textures,a),l=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,r,l,o,n),h=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,h),this.bindLightTargets(c),t!==void 0){let d=!1;for(const m in a)if(a[m].data instanceof HTMLImageElement){d=!0;break}d===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,n),r=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,r),o=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,s,o,a,t),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),this.bindLightTargets(l),l}parseShapes(e){const t={};if(e!==void 0)for(let n=0,s=e.length;n<s;n++){const r=new eg().fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},s={};if(t.traverse(function(r){r.isBone&&(s[r.uuid]=r)}),e!==void 0)for(let r=0,a=e.length;r<a;r++){const o=new KE().fromJSON(e[r],s);n[o.uuid]=o}return n}parseGeometries(e,t){const n={};if(e!==void 0){const s=new sV;for(let r=0,a=e.length;r<a;r++){let o;const l=e[r];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":o=s.parse(l);break;default:l.type in LF?o=LF[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}o.uuid=l.uuid,l.name!==void 0&&(o.name=l.name),l.userData!==void 0&&(o.userData=l.userData),n[l.uuid]=o}}return n}parseMaterials(e,t){const n={},s={};if(e!==void 0){const r=new CM;r.setTextures(t);for(let a=0,o=e.length;a<o;a++){const l=e[a];n[l.uuid]===void 0&&(n[l.uuid]=r.parse(l)),s[l.uuid]=n[l.uuid]}}return s}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const s=e[n],r=Uv.parse(s);t[r.uuid]=r}return t}parseImages(e,t){const n=this,s={};let r;function a(l){return n.manager.itemStart(l),r.load(l,function(){n.manager.itemEnd(l)},void 0,function(){n.manager.itemError(l),n.manager.itemEnd(l)})}function o(l){if(typeof l=="string"){const c=l,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c;return a(h)}else return l.data?{data:fy(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new MM(t);r=new sE(l),r.setCrossOrigin(this.crossOrigin);for(let c=0,h=e.length;c<h;c++){const d=e[c],m=d.url;if(Array.isArray(m)){const y=[];for(let x=0,_=m.length;x<_;x++){const b=m[x],A=o(b);A!==null&&(A instanceof HTMLImageElement?y.push(A):y.push(new Yc(A.data,A.width,A.height)))}s[d.uuid]=new _0(y)}else{const y=o(d.url);s[d.uuid]=new _0(y)}}}return s}async parseImagesAsync(e){const t=this,n={};let s;async function r(a){if(typeof a=="string"){const o=a,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(o)?o:t.resourcePath+o;return await s.loadAsync(l)}else return a.data?{data:fy(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){s=new sE(this.manager),s.setCrossOrigin(this.crossOrigin);for(let a=0,o=e.length;a<o;a++){const l=e[a],c=l.url;if(Array.isArray(c)){const h=[];for(let d=0,m=c.length;d<m;d++){const y=c[d],x=await r(y);x!==null&&(x instanceof HTMLImageElement?h.push(x):h.push(new Yc(x.data,x.width,x.height)))}n[l.uuid]=new _0(h)}else{const h=await r(l.url);n[l.uuid]=new _0(h)}}}return n}parseTextures(e,t){function n(r,a){return typeof r=="number"?r:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",r),a[r])}const s={};if(e!==void 0)for(let r=0,a=e.length;r<a;r++){const o=e[r];o.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),t[o.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const l=t[o.image],c=l.data;let h;Array.isArray(c)?(h=new VE,c.length===6&&(h.needsUpdate=!0)):(c&&c.data?h=new Yc:h=new wi,c&&(h.needsUpdate=!0)),h.source=l,h.uuid=o.uuid,o.name!==void 0&&(h.name=o.name),o.mapping!==void 0&&(h.mapping=n(o.mapping,kae)),o.channel!==void 0&&(h.channel=o.channel),o.offset!==void 0&&h.offset.fromArray(o.offset),o.repeat!==void 0&&h.repeat.fromArray(o.repeat),o.center!==void 0&&h.center.fromArray(o.center),o.rotation!==void 0&&(h.rotation=o.rotation),o.wrap!==void 0&&(h.wrapS=n(o.wrap[0],PF),h.wrapT=n(o.wrap[1],PF)),o.format!==void 0&&(h.format=o.format),o.internalFormat!==void 0&&(h.internalFormat=o.internalFormat),o.type!==void 0&&(h.type=o.type),o.colorSpace!==void 0&&(h.colorSpace=o.colorSpace),o.minFilter!==void 0&&(h.minFilter=n(o.minFilter,NF)),o.magFilter!==void 0&&(h.magFilter=n(o.magFilter,NF)),o.anisotropy!==void 0&&(h.anisotropy=o.anisotropy),o.flipY!==void 0&&(h.flipY=o.flipY),o.generateMipmaps!==void 0&&(h.generateMipmaps=o.generateMipmaps),o.premultiplyAlpha!==void 0&&(h.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(h.unpackAlignment=o.unpackAlignment),o.compareFunction!==void 0&&(h.compareFunction=o.compareFunction),o.userData!==void 0&&(h.userData=o.userData),s[o.uuid]=h}return s}parseObject(e,t,n,s,r){let a;function o(m){return t[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",m),t[m]}function l(m){if(m!==void 0){if(Array.isArray(m)){const y=[];for(let x=0,_=m.length;x<_;x++){const b=m[x];n[b]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",b),y.push(n[b])}return y}return n[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",m),n[m]}}function c(m){return s[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",m),s[m]}let h,d;switch(e.type){case"Scene":a=new dg,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new Ut(e.background):a.background=c(e.background)),e.environment!==void 0&&(a.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new uM(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new cM(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new Ds(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new fh(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new Z9(e.color,e.intensity);break;case"DirectionalLight":a=new fO(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new hO(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new eV(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new uO(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new J9(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new nV().fromJSON(e);break;case"SkinnedMesh":h=o(e.geometry),d=l(e.material),a=new WB(h,d),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":h=o(e.geometry),d=l(e.material),a=new ms(h,d);break;case"InstancedMesh":h=o(e.geometry),d=l(e.material);const m=e.count,y=e.instanceMatrix,x=e.instanceColor;a=new XB(h,d,m),a.instanceMatrix=new pg(new Float32Array(y.array),16),x!==void 0&&(a.instanceColor=new pg(new Float32Array(x.array),x.itemSize));break;case"BatchedMesh":h=o(e.geometry),d=l(e.material),a=new S9(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,d),a.geometry=h,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(_=>{let b=null,A=null;return _.boundingBox!==void 0&&(b=new ca,b.min.fromArray(_.boundingBox.min),b.max.fromArray(_.boundingBox.max)),_.boundingSphere!==void 0&&(A=new Kr,A.radius=_.boundingSphere.radius,A.center.fromArray(_.boundingSphere.center)),{..._,boundingBox:b,boundingSphere:A}}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=c(e.matricesTexture.uuid),a._indirectTexture=c(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(a._colorsTexture=c(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(a.boundingSphere=new Kr,a.boundingSphere.center.fromArray(e.boundingSphere.center),a.boundingSphere.radius=e.boundingSphere.radius),e.boundingBox!==void 0&&(a.boundingBox=new ca,a.boundingBox.min.fromArray(e.boundingBox.min),a.boundingBox.max.fromArray(e.boundingBox.max));break;case"LOD":a=new _9;break;case"Line":a=new Yf(o(e.geometry),l(e.material));break;case"LineLoop":a=new jB(o(e.geometry),l(e.material));break;case"LineSegments":a=new Zc(o(e.geometry),l(e.material));break;case"PointCloud":case"Points":a=new qB(o(e.geometry),l(e.material));break;case"Sprite":a=new E9(l(e.material));break;case"Group":a=new Of;break;case"Bone":a=new hM;break;default:a=new li}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const m=e.children;for(let y=0;y<m.length;y++)a.add(this.parseObject(m[y],t,n,s,r))}if(e.animations!==void 0){const m=e.animations;for(let y=0;y<m.length;y++){const x=m[y];a.animations.push(r[x])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const m=e.levels;for(let y=0;y<m.length;y++){const x=m[y],_=a.getObjectByProperty("uuid",x.object);_!==void 0&&a.addLevel(_,x.distance,x.hysteresis)}}return a}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const s=t[n.skeleton];s===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(s,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,s=e.getObjectByProperty("uuid",n);s!==void 0?t.target=s:t.target=new li}})}}const kae={UVMapping:P0,CubeReflectionMapping:gh,CubeRefractionMapping:N0,EquirectangularReflectionMapping:Mv,EquirectangularRefractionMapping:qA,CubeUVReflectionMapping:Wv},PF={RepeatWrapping:U0,ClampToEdgeWrapping:sr,MirroredRepeatWrapping:Cv},NF={NearestFilter:Ws,NearestMipmapNearestFilter:Zw,NearestMipmapLinearFilter:bm,LinearFilter:ei,LinearMipmapNearestFilter:Ty,LinearMipmapLinearFilter:Nl};class rV extends ha{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,a=Pf.get(e);if(a!==void 0){if(r.manager.itemStart(e),a.then){a.then(c=>{t&&t(c),r.manager.itemEnd(e)}).catch(c=>{s&&s(c)});return}return setTimeout(function(){t&&t(a),r.manager.itemEnd(e)},0),a}const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader;const l=fetch(e,o).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(c){return Pf.add(e,c),t&&t(c),r.manager.itemEnd(e),c}).catch(function(c){s&&s(c),Pf.remove(e),r.manager.itemError(e),r.manager.itemEnd(e)});Pf.add(e,l),r.manager.itemStart(e)}}let GS;class dO{static getContext(){return GS===void 0&&(GS=new(window.AudioContext||window.webkitAudioContext)),GS}static setContext(e){GS=e}}class Fae extends ha{constructor(e){super(e)}load(e,t,n,s){const r=this,a=new ua(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{const c=l.slice(0);dO.getContext().decodeAudioData(c,function(d){t(d)}).catch(o)}catch(c){o(c)}},n,s);function o(l){s?s(l):console.error(l),r.manager.itemError(e)}}}const UF=new hn,kF=new hn,Yp=new hn;class Hae{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ds,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ds,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Yp.copy(e.projectionMatrix);const s=t.eyeSep/2,r=s*t.near/t.focus,a=t.near*Math.tan(Zm*t.fov*.5)/t.zoom;let o,l;kF.elements[12]=-s,UF.elements[12]=s,o=-a*t.aspect+r,l=a*t.aspect+r,Yp.elements[0]=2*t.near/(l-o),Yp.elements[8]=(l+o)/(l-o),this.cameraL.projectionMatrix.copy(Yp),o=-a*t.aspect-r,l=a*t.aspect-r,Yp.elements[0]=2*t.near/(l-o),Yp.elements[8]=(l+o)/(l-o),this.cameraR.projectionMatrix.copy(Yp)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(kF),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(UF)}}class aV extends Ds{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class pO{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=FF(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=FF();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function FF(){return performance.now()}const Kp=new se,HF=new Yr,Gae=new se,Wp=new se;class zae extends li{constructor(){super(),this.type="AudioListener",this.context=dO.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new pO}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Kp,HF,Gae),Wp.set(0,0,-1).applyQuaternion(HF),t.positionX){const s=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Kp.x,s),t.positionY.linearRampToValueAtTime(Kp.y,s),t.positionZ.linearRampToValueAtTime(Kp.z,s),t.forwardX.linearRampToValueAtTime(Wp.x,s),t.forwardY.linearRampToValueAtTime(Wp.y,s),t.forwardZ.linearRampToValueAtTime(Wp.z,s),t.upX.linearRampToValueAtTime(n.x,s),t.upY.linearRampToValueAtTime(n.y,s),t.upZ.linearRampToValueAtTime(n.z,s)}else t.setPosition(Kp.x,Kp.y,Kp.z),t.setOrientation(Wp.x,Wp.y,Wp.z,n.x,n.y,n.z)}}class oV extends li{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Xp=new se,GF=new Yr,Vae=new se,jp=new se;class Yae extends oV{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Xp,GF,Vae),jp.set(0,0,1).applyQuaternion(GF);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Xp.x,n),t.positionY.linearRampToValueAtTime(Xp.y,n),t.positionZ.linearRampToValueAtTime(Xp.z,n),t.orientationX.linearRampToValueAtTime(jp.x,n),t.orientationY.linearRampToValueAtTime(jp.y,n),t.orientationZ.linearRampToValueAtTime(jp.z,n)}else t.setPosition(Xp.x,Xp.y,Xp.z),t.setOrientation(jp.x,jp.y,jp.z)}}class Kae{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class lV{constructor(e,t,n){this.binding=e,this.valueSize=n;let s,r,a;switch(t){case"quaternion":s=this._slerp,r=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":s=this._select,r=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:s=this._lerp,r=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=r,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,s=this.valueSize,r=e*s+s;let a=this.cumulativeWeight;if(a===0){for(let o=0;o!==s;++o)n[r+o]=n[o];a=t}else{a+=t;const o=t/a;this._mixBufferRegion(n,r,0,o,s)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,s=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,s,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,s=e*t+t,r=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const l=t*this._origIndex;this._mixBufferRegion(n,s,l,1-r,t)}a>0&&this._mixBufferRegionAdditive(n,s,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(n[l]!==n[l+t]){o.setValue(n,s);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,s=n*this._origIndex;e.getValue(t,s);for(let r=n,a=s;r!==a;++r)t[r]=t[s+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,s,r){if(s>=.5)for(let a=0;a!==r;++a)e[t+a]=e[n+a]}_slerp(e,t,n,s){Yr.slerpFlat(e,t,e,t,e,n,s)}_slerpAdditive(e,t,n,s,r){const a=this._workIndex*r;Yr.multiplyQuaternionsFlat(e,a,e,t,e,n),Yr.slerpFlat(e,t,e,t,e,a,s)}_lerp(e,t,n,s,r){const a=1-s;for(let o=0;o!==r;++o){const l=t+o;e[l]=e[l]*a+e[n+o]*s}}_lerpAdditive(e,t,n,s,r){for(let a=0;a!==r;++a){const o=t+a;e[o]=e[o]+e[n+a]*s}}}const mO="\\[\\]\\.:\\/",Wae=new RegExp("["+mO+"]","g"),gO="[^"+mO+"]",Xae="[^"+mO.replace("\\.","")+"]",jae=/((?:WC+[\/:])*)/.source.replace("WC",gO),qae=/(WCOD+)?/.source.replace("WCOD",Xae),Qae=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",gO),$ae=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",gO),Jae=new RegExp("^"+jae+qae+Qae+$ae+"$"),Zae=["material","materials","bones","map"];class eoe{constructor(e,t,n){const s=n||di.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,s=this._bindings[n];s!==void 0&&s.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,r=n.length;s!==r;++s)n[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class di{constructor(e,t,n){this.path=t,this.parsedPath=n||di.parseTrackName(t),this.node=di.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new di.Composite(e,t,n):new di(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Wae,"")}static parseTrackName(e){const t=Jae.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},s=n.nodeName&&n.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const r=n.nodeName.substring(s+1);Zae.indexOf(r)!==-1&&(n.nodeName=n.nodeName.substring(0,s),n.objectName=r)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(r){for(let a=0;a<r.length;a++){const o=r[a];if(o.name===t||o.uuid===t)return o;const l=n(o.children);if(l)return l}return null},s=n(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)e[t++]=n[s]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,s=t.propertyName;let r=t.propertyIndex;if(e||(e=di.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let c=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let h=0;h<e.length;h++)if(e[h].name===c){c=h;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const a=e[s];if(a===void 0){const c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+s+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?o=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(r!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=r}else a.fromArray!==void 0&&a.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}di.Composite=eoe;di.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};di.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};di.prototype.GetterByBindingType=[di.prototype._getValue_direct,di.prototype._getValue_array,di.prototype._getValue_arrayElement,di.prototype._getValue_toArray];di.prototype.SetterByBindingTypeAndVersioning=[[di.prototype._setValue_direct,di.prototype._setValue_direct_setNeedsUpdate,di.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[di.prototype._setValue_array,di.prototype._setValue_array_setNeedsUpdate,di.prototype._setValue_array_setMatrixWorldNeedsUpdate],[di.prototype._setValue_arrayElement,di.prototype._setValue_arrayElement_setNeedsUpdate,di.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[di.prototype._setValue_fromArray,di.prototype._setValue_fromArray_setNeedsUpdate,di.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class toe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=tl(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,s=arguments.length;n!==s;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,s=this._parsedPaths,r=this._bindings,a=r.length;let o,l=e.length,c=this.nCachedObjects_;for(let h=0,d=arguments.length;h!==d;++h){const m=arguments[h],y=m.uuid;let x=t[y];if(x===void 0){x=l++,t[y]=x,e.push(m);for(let _=0,b=a;_!==b;++_)r[_].push(new di(m,n[_],s[_]))}else if(x<c){o=e[x];const _=--c,b=e[_];t[b.uuid]=x,e[x]=b,t[y]=_,e[_]=m;for(let A=0,T=a;A!==T;++A){const w=r[A],R=w[_];let O=w[x];w[x]=R,O===void 0&&(O=new di(m,n[A],s[A])),w[_]=O}}else e[x]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,s=n.length;let r=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const l=arguments[a],c=l.uuid,h=t[c];if(h!==void 0&&h>=r){const d=r++,m=e[d];t[m.uuid]=h,e[h]=m,t[c]=d,e[d]=l;for(let y=0,x=s;y!==x;++y){const _=n[y],b=_[d],A=_[h];_[h]=b,_[d]=A}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,s=n.length;let r=this.nCachedObjects_,a=e.length;for(let o=0,l=arguments.length;o!==l;++o){const c=arguments[o],h=c.uuid,d=t[h];if(d!==void 0)if(delete t[h],d<r){const m=--r,y=e[m],x=--a,_=e[x];t[y.uuid]=d,e[d]=y,t[_.uuid]=m,e[m]=_,e.pop();for(let b=0,A=s;b!==A;++b){const T=n[b],w=T[m],R=T[x];T[d]=w,T[m]=R,T.pop()}}else{const m=--a,y=e[m];m>0&&(t[y.uuid]=d),e[d]=y,e.pop();for(let x=0,_=s;x!==_;++x){const b=n[x];b[d]=b[m],b.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const n=this._bindingsIndicesByPath;let s=n[e];const r=this._bindings;if(s!==void 0)return r[s];const a=this._paths,o=this._parsedPaths,l=this._objects,c=l.length,h=this.nCachedObjects_,d=new Array(c);s=r.length,n[e]=s,a.push(e),o.push(t),r.push(d);for(let m=h,y=l.length;m!==y;++m){const x=l[m];d[m]=new di(x,e,t)}return d}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const s=this._paths,r=this._parsedPaths,a=this._bindings,o=a.length-1,l=a[o],c=e[o];t[c]=n,a[n]=l,a.pop(),r[n]=r[o],r.pop(),s[n]=s[o],s.pop()}}}class cV{constructor(e,t,n=null,s=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=s;const r=t.tracks,a=r.length,o=new Array(a),l={endingStart:Am,endingEnd:Am};for(let c=0;c!==a;++c){const h=r[c].createInterpolant(null);o[c]=h,h.settings=l}this._interpolantSettings=l,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=t9,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const s=this._clip.duration,r=e._clip.duration,a=r/s,o=s/r;e.warp(1,a,t),this.warp(o,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const s=this._mixer,r=s.time,a=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=s._lendControlInterpolant(),this._timeScaleInterpolant=o);const l=o.parameterPositions,c=o.sampleValues;return l[0]=r,l[1]=r+n,c[0]=e/a,c[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,s){if(!this.enabled){this._updateWeight(e);return}const r=this._startTime;if(r!==null){const l=(e-r)*n;l<0||n===0?t=0:(this._startTime=null,t=n*l)}t*=this._updateTimeScale(e);const a=this._updateTime(t),o=this._updateWeight(e);if(o>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case kB:for(let h=0,d=l.length;h!==d;++h)l[h].evaluate(a),c[h].accumulateAdditive(o);break;case aM:default:for(let h=0,d=l.length;h!==d;++h)l[h].evaluate(a),c[h].accumulate(s,o)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let s=this.time+e,r=this._loopCount;const a=n===n9;if(e===0)return r===-1?s:a&&(r&1)===1?t-s:s;if(n===e9){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=t)s=t;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),s>=t||s<0){const o=Math.floor(s/t);s-=t*o,r+=Math.abs(o);const l=this.repetitions-r;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?t:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=r,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=s;if(a&&(r&1)===1)return t-s}return s}_setEndings(e,t,n){const s=this._interpolantSettings;n?(s.endingStart=Em,s.endingEnd=Em):(e?s.endingStart=this.zeroSlopeAtStart?Em:Am:s.endingStart=QA,t?s.endingEnd=this.zeroSlopeAtEnd?Em:Am:s.endingEnd=QA)}_scheduleFading(e,t,n){const s=this._mixer,r=s.time;let a=this._weightInterpolant;a===null&&(a=s._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,l=a.sampleValues;return o[0]=r,l[0]=t,o[1]=r+e,l[1]=n,this}}const noe=new Float32Array(1);class ioe extends sl{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,s=e._clip.tracks,r=s.length,a=e._propertyBindings,o=e._interpolants,l=n.uuid,c=this._bindingsByRootAndName;let h=c[l];h===void 0&&(h={},c[l]=h);for(let d=0;d!==r;++d){const m=s[d],y=m.name;let x=h[y];if(x!==void 0)++x.referenceCount,a[d]=x;else{if(x=a[d],x!==void 0){x._cacheIndex===null&&(++x.referenceCount,this._addInactiveBinding(x,l,y));continue}const _=t&&t._propertyBindings[d].binding.parsedPath;x=new lV(di.create(n,y,_),m.ValueTypeName,m.getValueSize()),++x.referenceCount,this._addInactiveBinding(x,l,y),a[d]=x}o[d].resultBuffer=x.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,s=e._clip.uuid,r=this._actionsByClip[s];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,s,n)}const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const s=this._actions,r=this._actionsByClip;let a=r[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=a;else{const o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=s.length,s.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],s=e._cacheIndex;n._cacheIndex=s,t[s]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,a=this._actionsByClip,o=a[r],l=o.knownActions,c=l[l.length-1],h=e._byClipCacheIndex;c._byClipCacheIndex=h,l[h]=c,l.pop(),e._byClipCacheIndex=null;const d=o.actionByRoot,m=(e._localRoot||this._root).uuid;delete d[m],l.length===0&&delete a[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];--r.referenceCount===0&&this._removeInactiveBinding(r)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,s=this._nActiveActions++,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,s=--this._nActiveActions,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){const s=this._bindingsByRootAndName,r=this._bindings;let a=s[t];a===void 0&&(a={},s[t]=a),a[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,s=n.rootNode.uuid,r=n.path,a=this._bindingsByRootAndName,o=a[s],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete o[r],Object.keys(o).length===0&&delete a[s]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,s=this._nActiveBindings++,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,s=--this._nActiveBindings,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new aO(new Float32Array(2),new Float32Array(2),1,noe),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,s=--this._nActiveControlInterpolants,r=t[s];e.__cacheIndex=s,t[s]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){const s=t||this._root,r=s.uuid;let a=typeof e=="string"?Uv.findByName(s,e):e;const o=a!==null?a.uuid:e,l=this._actionsByClip[o];let c=null;if(n===void 0&&(a!==null?n=a.blendMode:n=aM),l!==void 0){const d=l.actionByRoot[r];if(d!==void 0&&d.blendMode===n)return d;c=l.knownActions[0],a===null&&(a=c._clip)}if(a===null)return null;const h=new cV(this,a,t,n);return this._bindAction(h,c),this._addInactiveAction(h,o,r),h}existingAction(e,t){const n=t||this._root,s=n.uuid,r=typeof e=="string"?Uv.findByName(n,e):e,a=r?r.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[s]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,s=this.time+=e,r=Math.sign(e),a=this._accuIndex^=1;for(let c=0;c!==n;++c)t[c]._update(s,e,r,a);const o=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)o[c].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,s=this._actionsByClip,r=s[n];if(r!==void 0){const a=r.knownActions;for(let o=0,l=a.length;o!==l;++o){const c=a[o];this._deactivateAction(c);const h=c._cacheIndex,d=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,d._cacheIndex=h,t[h]=d,t.pop(),this._removeInactiveBindingsForAction(c)}delete s[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const a in n){const o=n[a].actionByRoot,l=o[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const s=this._bindingsByRootAndName,r=s[t];if(r!==void 0)for(const a in r){const o=r[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class soe extends oM{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isRenderTarget3D=!0,this.depth=n,this.texture=new lM(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class roe extends oM{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isRenderTargetArray=!0,this.depth=n,this.texture=new GE(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class xi{constructor(e){this.value=e}clone(){return new xi(this.value.clone===void 0?this.value:this.value.clone())}}let aoe=0;class ooe extends sl{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:aoe++}),this.name="",this.usage=JA,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,s=t.length;n<s;n++){const r=Array.isArray(t[n])?t[n]:[t[n]];for(let a=0;a<r.length;a++)this.uniforms.push(r[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class loe extends YE{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class coe{constructor(e,t,n,s,r){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=s,this.count=r,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const zF=new hn;class yO{constructor(e,t,n=0,s=1/0){this.ray=new Tg(e,t),this.near=n,this.far=s,this.camera=null,this.layers=new Ov,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return zF.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(zF),this}intersectObject(e,t=!0,n=[]){return tI(e,this,n,t),n.sort(VF),n}intersectObjects(e,t=!0,n=[]){for(let s=0,r=e.length;s<r;s++)tI(e[s],this,n,t);return n.sort(VF),n}}function VF(i,e){return i.distance-e.distance}function tI(i,e,t,n){let s=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(s=!1),s===!0&&n===!0){const r=i.children;for(let a=0,o=r.length;a<o;a++)tI(r[a],e,t,!0)}}class nI{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Rn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Rn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class uoe{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class vO{constructor(e,t,n,s){vO.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,s)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,s){const r=this.elements;return r[0]=e,r[2]=t,r[1]=n,r[3]=s,this}}const YF=new Qe;class hoe{constructor(e=new Qe(1/0,1/0),t=new Qe(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=YF.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,YF).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const KF=new se,zS=new se;class foe{constructor(e=new se,t=new se){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){KF.subVectors(e,this.start),zS.subVectors(this.end,this.start);const n=zS.dot(zS);let r=zS.dot(KF)/n;return t&&(r=Rn(r,0,1)),r}closestPointToPoint(e,t,n){const s=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(s).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const WF=new se;class doe extends li{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new Tn,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,l=32;a<l;a++,o++){const c=a/l*Math.PI*2,h=o/l*Math.PI*2;s.push(Math.cos(c),Math.sin(c),1,Math.cos(h),Math.sin(h),1)}n.setAttribute("position",new Qt(s,3));const r=new Oa({fog:!1,toneMapped:!1});this.cone=new Zc(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),WF.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(WF),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const jd=new se,VS=new hn,QR=new hn;class poe extends Zc{constructor(e){const t=uV(e),n=new Tn,s=[],r=[],a=new Ut(0,0,1),o=new Ut(0,1,0);for(let c=0;c<t.length;c++){const h=t[c];h.parent&&h.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),r.push(a.r,a.g,a.b),r.push(o.r,o.g,o.b))}n.setAttribute("position",new Qt(s,3)),n.setAttribute("color",new Qt(r,3));const l=new Oa({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,s=n.getAttribute("position");QR.copy(this.root.matrixWorld).invert();for(let r=0,a=0;r<t.length;r++){const o=t[r];o.parent&&o.parent.isBone&&(VS.multiplyMatrices(QR,o.matrixWorld),jd.setFromMatrixPosition(VS),s.setXYZ(a,jd.x,jd.y,jd.z),VS.multiplyMatrices(QR,o.parent.matrixWorld),jd.setFromMatrixPosition(VS),s.setXYZ(a+1,jd.x,jd.y,jd.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function uV(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push(...uV(i.children[t]));return e}class moe extends ms{constructor(e,t,n){const s=new QE(t,4,2),r=new Co({wireframe:!0,fog:!1,toneMapped:!1});super(s,r),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const goe=new se,XF=new Ut,jF=new Ut;class yoe extends li{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const s=new qE(t);s.rotateY(Math.PI*.5),this.material=new Co({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const r=s.getAttribute("position"),a=new Float32Array(r.count*3);s.setAttribute("color",new ci(a,3)),this.add(new ms(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");XF.copy(this.light.color),jF.copy(this.light.groundColor);for(let n=0,s=t.count;n<s;n++){const r=n<s/2?XF:jF;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(goe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class voe extends Zc{constructor(e=10,t=10,n=4473924,s=8947848){n=new Ut(n),s=new Ut(s);const r=t/2,a=e/t,o=e/2,l=[],c=[];for(let m=0,y=0,x=-o;m<=t;m++,x+=a){l.push(-o,0,x,o,0,x),l.push(x,0,-o,x,0,o);const _=m===r?n:s;_.toArray(c,y),y+=3,_.toArray(c,y),y+=3,_.toArray(c,y),y+=3,_.toArray(c,y),y+=3}const h=new Tn;h.setAttribute("position",new Qt(l,3)),h.setAttribute("color",new Qt(c,3));const d=new Oa({vertexColors:!0,toneMapped:!1});super(h,d),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class xoe extends Zc{constructor(e=10,t=16,n=8,s=64,r=4473924,a=8947848){r=new Ut(r),a=new Ut(a);const o=[],l=[];if(t>1)for(let d=0;d<t;d++){const m=d/t*(Math.PI*2),y=Math.sin(m)*e,x=Math.cos(m)*e;o.push(0,0,0),o.push(y,0,x);const _=d&1?r:a;l.push(_.r,_.g,_.b),l.push(_.r,_.g,_.b)}for(let d=0;d<n;d++){const m=d&1?r:a,y=e-e/n*d;for(let x=0;x<s;x++){let _=x/s*(Math.PI*2),b=Math.sin(_)*y,A=Math.cos(_)*y;o.push(b,0,A),l.push(m.r,m.g,m.b),_=(x+1)/s*(Math.PI*2),b=Math.sin(_)*y,A=Math.cos(_)*y,o.push(b,0,A),l.push(m.r,m.g,m.b)}}const c=new Tn;c.setAttribute("position",new Qt(o,3)),c.setAttribute("color",new Qt(l,3));const h=new Oa({vertexColors:!0,toneMapped:!1});super(c,h),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const qF=new se,YS=new se,QF=new se;class boe extends li{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let s=new Tn;s.setAttribute("position",new Qt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new Oa({fog:!1,toneMapped:!1});this.lightPlane=new Yf(s,r),this.add(this.lightPlane),s=new Tn,s.setAttribute("position",new Qt([0,0,0,0,0,1],3)),this.targetLine=new Yf(s,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),qF.setFromMatrixPosition(this.light.matrixWorld),YS.setFromMatrixPosition(this.light.target.matrixWorld),QF.subVectors(YS,qF),this.lightPlane.lookAt(YS),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(YS),this.targetLine.scale.z=QF.length()}}const KS=new se,Vs=new zE;class Aoe extends Zc{constructor(e){const t=new Tn,n=new Oa({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],r=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(x,_){l(x),l(_)}function l(x){s.push(0,0,0),r.push(0,0,0),a[x]===void 0&&(a[x]=[]),a[x].push(s.length/3-1)}t.setAttribute("position",new Qt(s,3)),t.setAttribute("color",new Qt(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const c=new Ut(16755200),h=new Ut(16711680),d=new Ut(43775),m=new Ut(16777215),y=new Ut(3355443);this.setColors(c,h,d,m,y)}setColors(e,t,n,s,r){const o=this.geometry.getAttribute("color");o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,t.r,t.g,t.b),o.setXYZ(25,t.r,t.g,t.b),o.setXYZ(26,t.r,t.g,t.b),o.setXYZ(27,t.r,t.g,t.b),o.setXYZ(28,t.r,t.g,t.b),o.setXYZ(29,t.r,t.g,t.b),o.setXYZ(30,t.r,t.g,t.b),o.setXYZ(31,t.r,t.g,t.b),o.setXYZ(32,n.r,n.g,n.b),o.setXYZ(33,n.r,n.g,n.b),o.setXYZ(34,n.r,n.g,n.b),o.setXYZ(35,n.r,n.g,n.b),o.setXYZ(36,n.r,n.g,n.b),o.setXYZ(37,n.r,n.g,n.b),o.setXYZ(38,s.r,s.g,s.b),o.setXYZ(39,s.r,s.g,s.b),o.setXYZ(40,r.r,r.g,r.b),o.setXYZ(41,r.r,r.g,r.b),o.setXYZ(42,r.r,r.g,r.b),o.setXYZ(43,r.r,r.g,r.b),o.setXYZ(44,r.r,r.g,r.b),o.setXYZ(45,r.r,r.g,r.b),o.setXYZ(46,r.r,r.g,r.b),o.setXYZ(47,r.r,r.g,r.b),o.setXYZ(48,r.r,r.g,r.b),o.setXYZ(49,r.r,r.g,r.b),o.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,n=1,s=1;Vs.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const r=this.camera.coordinateSystem===Ul?-1:0;Zs("c",t,e,Vs,0,0,r),Zs("t",t,e,Vs,0,0,1),Zs("n1",t,e,Vs,-1,-1,r),Zs("n2",t,e,Vs,n,-1,r),Zs("n3",t,e,Vs,-1,s,r),Zs("n4",t,e,Vs,n,s,r),Zs("f1",t,e,Vs,-1,-1,1),Zs("f2",t,e,Vs,n,-1,1),Zs("f3",t,e,Vs,-1,s,1),Zs("f4",t,e,Vs,n,s,1),Zs("u1",t,e,Vs,n*.7,s*1.1,r),Zs("u2",t,e,Vs,-1*.7,s*1.1,r),Zs("u3",t,e,Vs,0,s*2,r),Zs("cf1",t,e,Vs,-1,0,1),Zs("cf2",t,e,Vs,n,0,1),Zs("cf3",t,e,Vs,0,-1,1),Zs("cf4",t,e,Vs,0,s,1),Zs("cn1",t,e,Vs,-1,0,r),Zs("cn2",t,e,Vs,n,0,r),Zs("cn3",t,e,Vs,0,-1,r),Zs("cn4",t,e,Vs,0,s,r),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Zs(i,e,t,n,s,r,a){KS.set(s,r,a).unproject(n);const o=e[i];if(o!==void 0){const l=t.getAttribute("position");for(let c=0,h=o.length;c<h;c++)l.setXYZ(o[c],KS.x,KS.y,KS.z)}}const WS=new ca;class Eoe extends Zc{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(8*3),r=new Tn;r.setIndex(new ci(n,1)),r.setAttribute("position",new ci(s,3)),super(r,new Oa({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&WS.setFromObject(this.object),WS.isEmpty())return;const e=WS.min,t=WS.max,n=this.geometry.attributes.position,s=n.array;s[0]=t.x,s[1]=t.y,s[2]=t.z,s[3]=e.x,s[4]=t.y,s[5]=t.z,s[6]=e.x,s[7]=e.y,s[8]=t.z,s[9]=t.x,s[10]=e.y,s[11]=t.z,s[12]=t.x,s[13]=t.y,s[14]=e.z,s[15]=e.x,s[16]=t.y,s[17]=e.z,s[18]=e.x,s[19]=e.y,s[20]=e.z,s[21]=t.x,s[22]=e.y,s[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class _oe extends Zc{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new Tn;r.setIndex(new ci(n,1)),r.setAttribute("position",new Qt(s,3)),super(r,new Oa({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class Soe extends Yf{constructor(e,t=1,n=16776960){const s=n,r=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new Tn;a.setAttribute("position",new Qt(r,3)),a.computeBoundingSphere(),super(a,new Oa({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Tn;l.setAttribute("position",new Qt(o,3)),l.computeBoundingSphere(),this.add(new ms(l,new Co({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const $F=new se;let XS,$R;class Toe extends li{constructor(e=new se(0,0,1),t=new se(0,0,0),n=1,s=16776960,r=n*.2,a=r*.2){super(),this.type="ArrowHelper",XS===void 0&&(XS=new Tn,XS.setAttribute("position",new Qt([0,0,0,0,1,0],3)),$R=new XE(.5,1,5,1),$R.translate(0,-.5,0)),this.position.copy(t),this.line=new Yf(XS,new Oa({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ms($R,new Co({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{$F.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle($F,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class woe extends Zc{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new Tn;s.setAttribute("position",new Qt(t,3)),s.setAttribute("color",new Qt(n,3));const r=new Oa({vertexColors:!0,toneMapped:!1});super(s,r),this.type="AxesHelper"}setColors(e,t,n){const s=new Ut,r=this.geometry.attributes.color.array;return s.set(e),s.toArray(r,0),s.toArray(r,3),s.set(t),s.toArray(r,6),s.toArray(r,9),s.set(n),s.toArray(r,12),s.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Moe{constructor(){this.type="ShapePath",this.color=new Ut,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new ow,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,s){return this.currentPath.quadraticCurveTo(e,t,n,s),this}bezierCurveTo(e,t,n,s,r,a){return this.currentPath.bezierCurveTo(e,t,n,s,r,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(A){const T=[];for(let w=0,R=A.length;w<R;w++){const O=A[w],N=new eg;N.curves=O.curves,T.push(N)}return T}function n(A,T){const w=T.length;let R=!1;for(let O=w-1,N=0;N<w;O=N++){let U=T[O],P=T[N],B=P.x-U.x,L=P.y-U.y;if(Math.abs(L)>Number.EPSILON){if(L<0&&(U=T[N],B=-B,P=T[O],L=-L),A.y<U.y||A.y>P.y)continue;if(A.y===U.y){if(A.x===U.x)return!0}else{const F=L*(A.x-U.x)-B*(A.y-U.y);if(F===0)return!0;if(F<0)continue;R=!R}}else{if(A.y!==U.y)continue;if(P.x<=A.x&&A.x<=U.x||U.x<=A.x&&A.x<=P.x)return!0}}return R}const s=Gc.isClockWise,r=this.subPaths;if(r.length===0)return[];let a,o,l;const c=[];if(r.length===1)return o=r[0],l=new eg,l.curves=o.curves,c.push(l),c;let h=!s(r[0].getPoints());h=e?!h:h;const d=[],m=[];let y=[],x=0,_;m[x]=void 0,y[x]=[];for(let A=0,T=r.length;A<T;A++)o=r[A],_=o.getPoints(),a=s(_),a=e?!a:a,a?(!h&&m[x]&&x++,m[x]={s:new eg,p:_},m[x].s.curves=o.curves,h&&x++,y[x]=[]):y[x].push({h:o,p:_[0]});if(!m[0])return t(r);if(m.length>1){let A=!1,T=0;for(let w=0,R=m.length;w<R;w++)d[w]=[];for(let w=0,R=m.length;w<R;w++){const O=y[w];for(let N=0;N<O.length;N++){const U=O[N];let P=!0;for(let B=0;B<m.length;B++)n(U.p,m[B].p)&&(w!==B&&T++,P?(P=!1,d[B].push(U)):A=!0);P&&d[w].push(U)}}T>0&&A===!1&&(y=d)}let b;for(let A=0,T=m.length;A<T;A++){l=m[A].s,c.push(l),b=y[A];for(let w=0,R=b.length;w<R;w++)l.holes.push(b[w].h)}return c}}class Coe extends sl{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function Roe(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function Doe(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function Loe(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function iI(i,e,t,n){const s=Ioe(n);switch(t){case OB:return i*e;case FE:return i*e/s.components*s.byteLength;case HE:return i*e/s.components*s.byteLength;case NB:return i*e*2/s.components*s.byteLength;case sM:return i*e*2/s.components*s.byteLength;case PB:return i*e*3/s.components*s.byteLength;case rr:return i*e*4/s.components*s.byteLength;case rM:return i*e*4/s.components*s.byteLength;case hA:case fA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case dA:case pA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case I3:case O3:return Math.max(i,16)*Math.max(e,8)/4;case L3:case B3:return Math.max(i,8)*Math.max(e,8)/2;case P3:case N3:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case U3:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case k3:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case F3:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case H3:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case G3:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case z3:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case V3:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case Y3:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case K3:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case W3:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case X3:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case j3:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case q3:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case Q3:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case $3:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case mA:case J3:case Z3:return Math.ceil(i/4)*Math.ceil(e/4)*16;case UB:case ew:return Math.ceil(i/4)*Math.ceil(e/4)*8;case tw:case nw:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Ioe(i){switch(i){case Xs:case eM:return{byteLength:1,components:1};case Rv:case tM:case yr:return{byteLength:2,components:1};case nM:case iM:return{byteLength:2,components:4};case Qc:case kE:case ps:return{byteLength:4,components:1};case BB:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}class Boe{static contain(e,t){return Roe(e,t)}static cover(e,t){return Doe(e,t)}static fill(e){return Loe(e)}static getByteLength(e,t,n,s){return iI(e,t,n,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Sg}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Sg);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function hV(){let i=null,e=!1,t=null,n=null;function s(r,a){t(r,a),n=i.requestAnimationFrame(s)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(s),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(r){t=r},setContext:function(r){i=r}}}function Ooe(i){const e=new WeakMap;function t(o,l){const c=o.array,h=o.usage,d=c.byteLength,m=i.createBuffer();i.bindBuffer(l,m),i.bufferData(l,c,h),o.onUploadCallback();let y;if(c instanceof Float32Array)y=i.FLOAT;else if(c instanceof Uint16Array)o.isFloat16BufferAttribute?y=i.HALF_FLOAT:y=i.UNSIGNED_SHORT;else if(c instanceof Int16Array)y=i.SHORT;else if(c instanceof Uint32Array)y=i.UNSIGNED_INT;else if(c instanceof Int32Array)y=i.INT;else if(c instanceof Int8Array)y=i.BYTE;else if(c instanceof Uint8Array)y=i.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)y=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:m,type:y,bytesPerElement:c.BYTES_PER_ELEMENT,version:o.version,size:d}}function n(o,l,c){const h=l.array,d=l.updateRanges;if(i.bindBuffer(c,o),d.length===0)i.bufferSubData(c,0,h);else{d.sort((y,x)=>y.start-x.start);let m=0;for(let y=1;y<d.length;y++){const x=d[m],_=d[y];_.start<=x.start+x.count+1?x.count=Math.max(x.count,_.start+_.count-x.start):(++m,d[m]=_)}d.length=m+1;for(let y=0,x=d.length;y<x;y++){const _=d[y];i.bufferSubData(c,_.start*h.BYTES_PER_ELEMENT,h,_.start,_.count)}l.clearUpdateRanges()}l.onUploadCallback()}function s(o){return o.isInterleavedBufferAttribute&&(o=o.data),e.get(o)}function r(o){o.isInterleavedBufferAttribute&&(o=o.data);const l=e.get(o);l&&(i.deleteBuffer(l.buffer),e.delete(o))}function a(o,l){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const h=e.get(o);(!h||h.version<o.version)&&e.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const c=e.get(o);if(c===void 0)e.set(o,t(o,l));else if(c.version<o.version){if(c.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(c.buffer,o,l),c.version=o.version}}return{get:s,remove:r,update:a}}var Poe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Noe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Uoe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,koe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Foe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,Hoe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Goe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,zoe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Voe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,Yoe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,Koe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Woe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Xoe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,joe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,qoe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Qoe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,$oe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Joe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Zoe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,ele=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,tle=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,nle=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,ile=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,sle=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,rle=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,ale=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,ole=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,lle=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,cle=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,ule=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,hle="gl_FragColor = linearToOutputTexel( gl_FragColor );",fle=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,dle=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,ple=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,mle=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,gle=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,yle=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,vle=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,xle=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,ble=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Ale=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Ele=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,_le=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Sle=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Tle=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,wle=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Mle=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Cle=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Rle=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Dle=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Lle=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Ile=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Ble=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Ole=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Ple=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Nle=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Ule=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,kle=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Fle=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Hle=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,Gle=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,zle=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Vle=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Yle=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Kle=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Wle=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Xle=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,jle=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,qle=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Qle=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,$le=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Jle=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Zle=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,ece=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,tce=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,nce=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,ice=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,sce=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,rce=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,ace=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,oce=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,lce=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,cce=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,uce=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,hce=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,fce=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dce=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,pce=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,mce=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,gce=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,yce=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,vce=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,xce=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,bce=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Ace=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Ece=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,_ce=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Sce=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Tce=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,wce=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Mce=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Cce=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Rce=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Dce=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Lce=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Ice=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Bce=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Oce=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Pce=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Nce=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Uce=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,kce=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Fce=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Hce=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Gce=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,zce=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Vce=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Yce=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Kce=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Wce=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Xce=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,jce=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,qce=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Qce=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$ce=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Jce=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Zce=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,eue=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,tue=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,nue=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,iue=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sue=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,rue=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,aue=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,oue=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lue=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,cue=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,uue=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,hue=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,fue=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,due=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Fn={alphahash_fragment:Poe,alphahash_pars_fragment:Noe,alphamap_fragment:Uoe,alphamap_pars_fragment:koe,alphatest_fragment:Foe,alphatest_pars_fragment:Hoe,aomap_fragment:Goe,aomap_pars_fragment:zoe,batching_pars_vertex:Voe,batching_vertex:Yoe,begin_vertex:Koe,beginnormal_vertex:Woe,bsdfs:Xoe,iridescence_fragment:joe,bumpmap_pars_fragment:qoe,clipping_planes_fragment:Qoe,clipping_planes_pars_fragment:$oe,clipping_planes_pars_vertex:Joe,clipping_planes_vertex:Zoe,color_fragment:ele,color_pars_fragment:tle,color_pars_vertex:nle,color_vertex:ile,common:sle,cube_uv_reflection_fragment:rle,defaultnormal_vertex:ale,displacementmap_pars_vertex:ole,displacementmap_vertex:lle,emissivemap_fragment:cle,emissivemap_pars_fragment:ule,colorspace_fragment:hle,colorspace_pars_fragment:fle,envmap_fragment:dle,envmap_common_pars_fragment:ple,envmap_pars_fragment:mle,envmap_pars_vertex:gle,envmap_physical_pars_fragment:Mle,envmap_vertex:yle,fog_vertex:vle,fog_pars_vertex:xle,fog_fragment:ble,fog_pars_fragment:Ale,gradientmap_pars_fragment:Ele,lightmap_pars_fragment:_le,lights_lambert_fragment:Sle,lights_lambert_pars_fragment:Tle,lights_pars_begin:wle,lights_toon_fragment:Cle,lights_toon_pars_fragment:Rle,lights_phong_fragment:Dle,lights_phong_pars_fragment:Lle,lights_physical_fragment:Ile,lights_physical_pars_fragment:Ble,lights_fragment_begin:Ole,lights_fragment_maps:Ple,lights_fragment_end:Nle,logdepthbuf_fragment:Ule,logdepthbuf_pars_fragment:kle,logdepthbuf_pars_vertex:Fle,logdepthbuf_vertex:Hle,map_fragment:Gle,map_pars_fragment:zle,map_particle_fragment:Vle,map_particle_pars_fragment:Yle,metalnessmap_fragment:Kle,metalnessmap_pars_fragment:Wle,morphinstance_vertex:Xle,morphcolor_vertex:jle,morphnormal_vertex:qle,morphtarget_pars_vertex:Qle,morphtarget_vertex:$le,normal_fragment_begin:Jle,normal_fragment_maps:Zle,normal_pars_fragment:ece,normal_pars_vertex:tce,normal_vertex:nce,normalmap_pars_fragment:ice,clearcoat_normal_fragment_begin:sce,clearcoat_normal_fragment_maps:rce,clearcoat_pars_fragment:ace,iridescence_pars_fragment:oce,opaque_fragment:lce,packing:cce,premultiplied_alpha_fragment:uce,project_vertex:hce,dithering_fragment:fce,dithering_pars_fragment:dce,roughnessmap_fragment:pce,roughnessmap_pars_fragment:mce,shadowmap_pars_fragment:gce,shadowmap_pars_vertex:yce,shadowmap_vertex:vce,shadowmask_pars_fragment:xce,skinbase_vertex:bce,skinning_pars_vertex:Ace,skinning_vertex:Ece,skinnormal_vertex:_ce,specularmap_fragment:Sce,specularmap_pars_fragment:Tce,tonemapping_fragment:wce,tonemapping_pars_fragment:Mce,transmission_fragment:Cce,transmission_pars_fragment:Rce,uv_pars_fragment:Dce,uv_pars_vertex:Lce,uv_vertex:Ice,worldpos_vertex:Bce,background_vert:Oce,background_frag:Pce,backgroundCube_vert:Nce,backgroundCube_frag:Uce,cube_vert:kce,cube_frag:Fce,depth_vert:Hce,depth_frag:Gce,distanceRGBA_vert:zce,distanceRGBA_frag:Vce,equirect_vert:Yce,equirect_frag:Kce,linedashed_vert:Wce,linedashed_frag:Xce,meshbasic_vert:jce,meshbasic_frag:qce,meshlambert_vert:Qce,meshlambert_frag:$ce,meshmatcap_vert:Jce,meshmatcap_frag:Zce,meshnormal_vert:eue,meshnormal_frag:tue,meshphong_vert:nue,meshphong_frag:iue,meshphysical_vert:sue,meshphysical_frag:rue,meshtoon_vert:aue,meshtoon_frag:oue,points_vert:lue,points_frag:cue,shadow_vert:uue,shadow_frag:hue,sprite_vert:fue,sprite_frag:due},zt={common:{diffuse:{value:new Ut(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Bn},alphaMap:{value:null},alphaMapTransform:{value:new Bn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Bn}},envmap:{envMap:{value:null},envMapRotation:{value:new Bn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Bn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Bn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Bn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Bn},normalScale:{value:new Qe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Bn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Bn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Bn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Bn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ut(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ut(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Bn},alphaTest:{value:0},uvTransform:{value:new Bn}},sprite:{diffuse:{value:new Ut(16777215)},opacity:{value:1},center:{value:new Qe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Bn},alphaMap:{value:null},alphaMapTransform:{value:new Bn},alphaTest:{value:0}}},Uc={basic:{uniforms:Ya([zt.common,zt.specularmap,zt.envmap,zt.aomap,zt.lightmap,zt.fog]),vertexShader:Fn.meshbasic_vert,fragmentShader:Fn.meshbasic_frag},lambert:{uniforms:Ya([zt.common,zt.specularmap,zt.envmap,zt.aomap,zt.lightmap,zt.emissivemap,zt.bumpmap,zt.normalmap,zt.displacementmap,zt.fog,zt.lights,{emissive:{value:new Ut(0)}}]),vertexShader:Fn.meshlambert_vert,fragmentShader:Fn.meshlambert_frag},phong:{uniforms:Ya([zt.common,zt.specularmap,zt.envmap,zt.aomap,zt.lightmap,zt.emissivemap,zt.bumpmap,zt.normalmap,zt.displacementmap,zt.fog,zt.lights,{emissive:{value:new Ut(0)},specular:{value:new Ut(1118481)},shininess:{value:30}}]),vertexShader:Fn.meshphong_vert,fragmentShader:Fn.meshphong_frag},standard:{uniforms:Ya([zt.common,zt.envmap,zt.aomap,zt.lightmap,zt.emissivemap,zt.bumpmap,zt.normalmap,zt.displacementmap,zt.roughnessmap,zt.metalnessmap,zt.fog,zt.lights,{emissive:{value:new Ut(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Fn.meshphysical_vert,fragmentShader:Fn.meshphysical_frag},toon:{uniforms:Ya([zt.common,zt.aomap,zt.lightmap,zt.emissivemap,zt.bumpmap,zt.normalmap,zt.displacementmap,zt.gradientmap,zt.fog,zt.lights,{emissive:{value:new Ut(0)}}]),vertexShader:Fn.meshtoon_vert,fragmentShader:Fn.meshtoon_frag},matcap:{uniforms:Ya([zt.common,zt.bumpmap,zt.normalmap,zt.displacementmap,zt.fog,{matcap:{value:null}}]),vertexShader:Fn.meshmatcap_vert,fragmentShader:Fn.meshmatcap_frag},points:{uniforms:Ya([zt.points,zt.fog]),vertexShader:Fn.points_vert,fragmentShader:Fn.points_frag},dashed:{uniforms:Ya([zt.common,zt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Fn.linedashed_vert,fragmentShader:Fn.linedashed_frag},depth:{uniforms:Ya([zt.common,zt.displacementmap]),vertexShader:Fn.depth_vert,fragmentShader:Fn.depth_frag},normal:{uniforms:Ya([zt.common,zt.bumpmap,zt.normalmap,zt.displacementmap,{opacity:{value:1}}]),vertexShader:Fn.meshnormal_vert,fragmentShader:Fn.meshnormal_frag},sprite:{uniforms:Ya([zt.sprite,zt.fog]),vertexShader:Fn.sprite_vert,fragmentShader:Fn.sprite_frag},background:{uniforms:{uvTransform:{value:new Bn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Fn.background_vert,fragmentShader:Fn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Bn}},vertexShader:Fn.backgroundCube_vert,fragmentShader:Fn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Fn.cube_vert,fragmentShader:Fn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Fn.equirect_vert,fragmentShader:Fn.equirect_frag},distanceRGBA:{uniforms:Ya([zt.common,zt.displacementmap,{referencePosition:{value:new se},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Fn.distanceRGBA_vert,fragmentShader:Fn.distanceRGBA_frag},shadow:{uniforms:Ya([zt.lights,zt.fog,{color:{value:new Ut(0)},opacity:{value:1}}]),vertexShader:Fn.shadow_vert,fragmentShader:Fn.shadow_frag}};Uc.physical={uniforms:Ya([Uc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Bn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Bn},clearcoatNormalScale:{value:new Qe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Bn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Bn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Bn},sheen:{value:0},sheenColor:{value:new Ut(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Bn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Bn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Bn},transmissionSamplerSize:{value:new Qe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Bn},attenuationDistance:{value:0},attenuationColor:{value:new Ut(0)},specularColor:{value:new Ut(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Bn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Bn},anisotropyVector:{value:new Qe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Bn}}]),vertexShader:Fn.meshphysical_vert,fragmentShader:Fn.meshphysical_frag};const jS={r:0,b:0,g:0},qp=new il,pue=new hn;function mue(i,e,t,n,s,r,a){const o=new Ut(0);let l=r===!0?0:1,c,h,d=null,m=0,y=null;function x(w){let R=w.isScene===!0?w.background:null;return R&&R.isTexture&&(R=(w.backgroundBlurriness>0?t:e).get(R)),R}function _(w){let R=!1;const O=x(w);O===null?A(o,l):O&&O.isColor&&(A(O,1),R=!0);const N=i.xr.getEnvironmentBlendMode();N==="additive"?n.buffers.color.setClear(0,0,0,1,a):N==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,a),(i.autoClear||R)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function b(w,R){const O=x(R);O&&(O.isCubeTexture||O.mapping===Wv)?(h===void 0&&(h=new ms(new wg(1,1,1),new js({name:"BackgroundCubeMaterial",uniforms:Pv(Uc.backgroundCube.uniforms),vertexShader:Uc.backgroundCube.vertexShader,fragmentShader:Uc.backgroundCube.fragmentShader,side:wr,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(N,U,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(h)),qp.copy(R.backgroundRotation),qp.x*=-1,qp.y*=-1,qp.z*=-1,O.isCubeTexture&&O.isRenderTargetTexture===!1&&(qp.y*=-1,qp.z*=-1),h.material.uniforms.envMap.value=O,h.material.uniforms.flipEnvMap.value=O.isCubeTexture&&O.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=R.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=R.backgroundIntensity,h.material.uniforms.backgroundRotation.value.setFromMatrix4(pue.makeRotationFromEuler(qp)),h.material.toneMapped=ri.getTransfer(O.colorSpace)!==Hi,(d!==O||m!==O.version||y!==i.toneMapping)&&(h.material.needsUpdate=!0,d=O,m=O.version,y=i.toneMapping),h.layers.enableAll(),w.unshift(h,h.geometry,h.material,0,0,null)):O&&O.isTexture&&(c===void 0&&(c=new ms(new W0(2,2),new js({name:"BackgroundMaterial",uniforms:Pv(Uc.background.uniforms),vertexShader:Uc.background.vertexShader,fragmentShader:Uc.background.fragmentShader,side:qc,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(c)),c.material.uniforms.t2D.value=O,c.material.uniforms.backgroundIntensity.value=R.backgroundIntensity,c.material.toneMapped=ri.getTransfer(O.colorSpace)!==Hi,O.matrixAutoUpdate===!0&&O.updateMatrix(),c.material.uniforms.uvTransform.value.copy(O.matrix),(d!==O||m!==O.version||y!==i.toneMapping)&&(c.material.needsUpdate=!0,d=O,m=O.version,y=i.toneMapping),c.layers.enableAll(),w.unshift(c,c.geometry,c.material,0,0,null))}function A(w,R){w.getRGB(jS,v9(i)),n.buffers.color.setClear(jS.r,jS.g,jS.b,R,a)}function T(){h!==void 0&&(h.geometry.dispose(),h.material.dispose(),h=void 0),c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0)}return{getClearColor:function(){return o},setClearColor:function(w,R=1){o.set(w),l=R,A(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(w){l=w,A(o,l)},render:_,addToRenderList:b,dispose:T}}function gue(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},s=m(null);let r=s,a=!1;function o(L,F,j,J,re){let q=!1;const W=d(J,j,F);r!==W&&(r=W,c(r.object)),q=y(L,J,j,re),q&&x(L,J,j,re),re!==null&&e.update(re,i.ELEMENT_ARRAY_BUFFER),(q||a)&&(a=!1,R(L,F,j,J),re!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(re).buffer))}function l(){return i.createVertexArray()}function c(L){return i.bindVertexArray(L)}function h(L){return i.deleteVertexArray(L)}function d(L,F,j){const J=j.wireframe===!0;let re=n[L.id];re===void 0&&(re={},n[L.id]=re);let q=re[F.id];q===void 0&&(q={},re[F.id]=q);let W=q[J];return W===void 0&&(W=m(l()),q[J]=W),W}function m(L){const F=[],j=[],J=[];for(let re=0;re<t;re++)F[re]=0,j[re]=0,J[re]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:F,enabledAttributes:j,attributeDivisors:J,object:L,attributes:{},index:null}}function y(L,F,j,J){const re=r.attributes,q=F.attributes;let W=0;const ne=j.getAttributes();for(const ie in ne)if(ne[ie].location>=0){const z=re[ie];let ae=q[ie];if(ae===void 0&&(ie==="instanceMatrix"&&L.instanceMatrix&&(ae=L.instanceMatrix),ie==="instanceColor"&&L.instanceColor&&(ae=L.instanceColor)),z===void 0||z.attribute!==ae||ae&&z.data!==ae.data)return!0;W++}return r.attributesNum!==W||r.index!==J}function x(L,F,j,J){const re={},q=F.attributes;let W=0;const ne=j.getAttributes();for(const ie in ne)if(ne[ie].location>=0){let z=q[ie];z===void 0&&(ie==="instanceMatrix"&&L.instanceMatrix&&(z=L.instanceMatrix),ie==="instanceColor"&&L.instanceColor&&(z=L.instanceColor));const ae={};ae.attribute=z,z&&z.data&&(ae.data=z.data),re[ie]=ae,W++}r.attributes=re,r.attributesNum=W,r.index=J}function _(){const L=r.newAttributes;for(let F=0,j=L.length;F<j;F++)L[F]=0}function b(L){A(L,0)}function A(L,F){const j=r.newAttributes,J=r.enabledAttributes,re=r.attributeDivisors;j[L]=1,J[L]===0&&(i.enableVertexAttribArray(L),J[L]=1),re[L]!==F&&(i.vertexAttribDivisor(L,F),re[L]=F)}function T(){const L=r.newAttributes,F=r.enabledAttributes;for(let j=0,J=F.length;j<J;j++)F[j]!==L[j]&&(i.disableVertexAttribArray(j),F[j]=0)}function w(L,F,j,J,re,q,W){W===!0?i.vertexAttribIPointer(L,F,j,re,q):i.vertexAttribPointer(L,F,j,J,re,q)}function R(L,F,j,J){_();const re=J.attributes,q=j.getAttributes(),W=F.defaultAttributeValues;for(const ne in q){const ie=q[ne];if(ie.location>=0){let ue=re[ne];if(ue===void 0&&(ne==="instanceMatrix"&&L.instanceMatrix&&(ue=L.instanceMatrix),ne==="instanceColor"&&L.instanceColor&&(ue=L.instanceColor)),ue!==void 0){const z=ue.normalized,ae=ue.itemSize,ge=e.get(ue);if(ge===void 0)continue;const Ee=ge.buffer,le=ge.type,Ce=ge.bytesPerElement,Me=le===i.INT||le===i.UNSIGNED_INT||ue.gpuType===kE;if(ue.isInterleavedBufferAttribute){const Ze=ue.data,tt=Ze.stride,Mt=ue.offset;if(Ze.isInstancedInterleavedBuffer){for(let bt=0;bt<ie.locationSize;bt++)A(ie.location+bt,Ze.meshPerAttribute);L.isInstancedMesh!==!0&&J._maxInstanceCount===void 0&&(J._maxInstanceCount=Ze.meshPerAttribute*Ze.count)}else for(let bt=0;bt<ie.locationSize;bt++)b(ie.location+bt);i.bindBuffer(i.ARRAY_BUFFER,Ee);for(let bt=0;bt<ie.locationSize;bt++)w(ie.location+bt,ae/ie.locationSize,le,z,tt*Ce,(Mt+ae/ie.locationSize*bt)*Ce,Me)}else{if(ue.isInstancedBufferAttribute){for(let Ze=0;Ze<ie.locationSize;Ze++)A(ie.location+Ze,ue.meshPerAttribute);L.isInstancedMesh!==!0&&J._maxInstanceCount===void 0&&(J._maxInstanceCount=ue.meshPerAttribute*ue.count)}else for(let Ze=0;Ze<ie.locationSize;Ze++)b(ie.location+Ze);i.bindBuffer(i.ARRAY_BUFFER,Ee);for(let Ze=0;Ze<ie.locationSize;Ze++)w(ie.location+Ze,ae/ie.locationSize,le,z,ae*Ce,ae/ie.locationSize*Ze*Ce,Me)}}else if(W!==void 0){const z=W[ne];if(z!==void 0)switch(z.length){case 2:i.vertexAttrib2fv(ie.location,z);break;case 3:i.vertexAttrib3fv(ie.location,z);break;case 4:i.vertexAttrib4fv(ie.location,z);break;default:i.vertexAttrib1fv(ie.location,z)}}}}T()}function O(){P();for(const L in n){const F=n[L];for(const j in F){const J=F[j];for(const re in J)h(J[re].object),delete J[re];delete F[j]}delete n[L]}}function N(L){if(n[L.id]===void 0)return;const F=n[L.id];for(const j in F){const J=F[j];for(const re in J)h(J[re].object),delete J[re];delete F[j]}delete n[L.id]}function U(L){for(const F in n){const j=n[F];if(j[L.id]===void 0)continue;const J=j[L.id];for(const re in J)h(J[re].object),delete J[re];delete j[L.id]}}function P(){B(),a=!0,r!==s&&(r=s,c(r.object))}function B(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:o,reset:P,resetDefaultState:B,dispose:O,releaseStatesOfGeometry:N,releaseStatesOfProgram:U,initAttributes:_,enableAttribute:b,disableUnusedAttributes:T}}function yue(i,e,t){let n;function s(c){n=c}function r(c,h){i.drawArrays(n,c,h),t.update(h,n,1)}function a(c,h,d){d!==0&&(i.drawArraysInstanced(n,c,h,d),t.update(h,n,d))}function o(c,h,d){if(d===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,c,0,h,0,d);let y=0;for(let x=0;x<d;x++)y+=h[x];t.update(y,n,1)}function l(c,h,d,m){if(d===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let x=0;x<c.length;x++)a(c[x],h[x],m[x]);else{y.multiDrawArraysInstancedWEBGL(n,c,0,h,0,m,0,d);let x=0;for(let _=0;_<d;_++)x+=h[_]*m[_];t.update(x,n,1)}}this.setMode=s,this.render=r,this.renderInstances=a,this.renderMultiDraw=o,this.renderMultiDrawInstances=l}function vue(i,e,t,n){let s;function r(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const U=e.get("EXT_texture_filter_anisotropic");s=i.getParameter(U.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function a(U){return!(U!==rr&&n.convert(U)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(U){const P=U===yr&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(U!==Xs&&n.convert(U)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&U!==ps&&!P)}function l(U){if(U==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";U="mediump"}return U==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=t.precision!==void 0?t.precision:"highp";const h=l(c);h!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",h,"instead."),c=h);const d=t.logarithmicDepthBuffer===!0,m=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),y=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),x=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),_=i.getParameter(i.MAX_TEXTURE_SIZE),b=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),A=i.getParameter(i.MAX_VERTEX_ATTRIBS),T=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),w=i.getParameter(i.MAX_VARYING_VECTORS),R=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),O=x>0,N=i.getParameter(i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:r,getMaxPrecision:l,textureFormatReadable:a,textureTypeReadable:o,precision:c,logarithmicDepthBuffer:d,reverseDepthBuffer:m,maxTextures:y,maxVertexTextures:x,maxTextureSize:_,maxCubemapSize:b,maxAttributes:A,maxVertexUniforms:T,maxVaryings:w,maxFragmentUniforms:R,vertexTextures:O,maxSamples:N}}function xue(i){const e=this;let t=null,n=0,s=!1,r=!1;const a=new mf,o=new Bn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,m){const y=d.length!==0||m||n!==0||s;return s=m,n=d.length,y},this.beginShadows=function(){r=!0,h(null)},this.endShadows=function(){r=!1},this.setGlobalState=function(d,m){t=h(d,m,0)},this.setState=function(d,m,y){const x=d.clippingPlanes,_=d.clipIntersection,b=d.clipShadows,A=i.get(d);if(!s||x===null||x.length===0||r&&!b)r?h(null):c();else{const T=r?0:n,w=T*4;let R=A.clippingState||null;l.value=R,R=h(x,m,w,y);for(let O=0;O!==w;++O)R[O]=t[O];A.clippingState=R,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=T}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function h(d,m,y,x){const _=d!==null?d.length:0;let b=null;if(_!==0){if(b=l.value,x!==!0||b===null){const A=y+_*4,T=m.matrixWorldInverse;o.getNormalMatrix(T),(b===null||b.length<A)&&(b=new Float32Array(A));for(let w=0,R=y;w!==_;++w,R+=4)a.copy(d[w]).applyMatrix4(T,o),a.normal.toArray(b,R),b[R+3]=a.constant}l.value=b,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,b}}function bue(i){let e=new WeakMap;function t(a,o){return o===Mv?a.mapping=gh:o===qA&&(a.mapping=N0),a}function n(a){if(a&&a.isTexture){const o=a.mapping;if(o===Mv||o===qA)if(e.has(a)){const l=e.get(a).texture;return t(l,a.mapping)}else{const l=a.image;if(l&&l.height>0){const c=new YB(l.height);return c.fromEquirectangularTexture(i,a),e.set(a,c),a.addEventListener("dispose",s),t(c.texture,a.mapping)}else return null}}return a}function s(a){const o=a.target;o.removeEventListener("dispose",s);const l=e.get(o);l!==void 0&&(e.delete(o),l.dispose())}function r(){e=new WeakMap}return{get:n,dispose:r}}const dy=4,JF=[.125,.215,.35,.446,.526,.582],dm=20,JR=new fh,ZF=new Ut;let ZR=null,eD=0,tD=0,nD=!1;const om=(1+Math.sqrt(5))/2,J2=1/om,e4=[new se(-om,J2,0),new se(om,J2,0),new se(-J2,0,om),new se(J2,0,om),new se(0,om,-J2),new se(0,om,J2),new se(-1,1,-1),new se(1,1,-1),new se(-1,1,1),new se(1,1,1)],Aue=new se;class sI{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,s=100,r={}){const{size:a=256,position:o=Aue}=r;ZR=this._renderer.getRenderTarget(),eD=this._renderer.getActiveCubeFace(),tD=this._renderer.getActiveMipmapLevel(),nD=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,n,s,l,o),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=i4(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=n4(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(ZR,eD,tD),this._renderer.xr.enabled=nD,e.scissorTest=!1,qS(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===gh||e.mapping===N0?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),ZR=this._renderer.getRenderTarget(),eD=this._renderer.getActiveCubeFace(),tD=this._renderer.getActiveMipmapLevel(),nD=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:ei,minFilter:ei,generateMipmaps:!1,type:yr,format:rr,colorSpace:nl,depthBuffer:!1},s=t4(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=t4(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Eue(r)),this._blurMaterial=_ue(r,e,t)}return s}_compileMaterial(e){const t=new ms(this._lodPlanes[0],e);this._renderer.compile(t,JR)}_sceneToCubeUV(e,t,n,s,r){const l=new Ds(90,1,t,n),c=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],d=this._renderer,m=d.autoClear,y=d.toneMapping;d.getClearColor(ZF),d.toneMapping=Vc,d.autoClear=!1;const x=new Co({name:"PMREM.Background",side:wr,depthWrite:!1,depthTest:!1}),_=new ms(new wg,x);let b=!1;const A=e.background;A?A.isColor&&(x.color.copy(A),e.background=null,b=!0):(x.color.copy(ZF),b=!0);for(let T=0;T<6;T++){const w=T%3;w===0?(l.up.set(0,c[T],0),l.position.set(r.x,r.y,r.z),l.lookAt(r.x+h[T],r.y,r.z)):w===1?(l.up.set(0,0,c[T]),l.position.set(r.x,r.y,r.z),l.lookAt(r.x,r.y+h[T],r.z)):(l.up.set(0,c[T],0),l.position.set(r.x,r.y,r.z),l.lookAt(r.x,r.y,r.z+h[T]));const R=this._cubeSize;qS(s,w*R,T>2?R:0,R,R),d.setRenderTarget(s),b&&d.render(_,l),d.render(e,l)}_.geometry.dispose(),_.material.dispose(),d.toneMapping=y,d.autoClear=m,e.background=A}_textureToCubeUV(e,t){const n=this._renderer,s=e.mapping===gh||e.mapping===N0;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=i4()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=n4());const r=s?this._cubemapMaterial:this._equirectMaterial,a=new ms(this._lodPlanes[0],r),o=r.uniforms;o.envMap.value=e;const l=this._cubeSize;qS(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(a,JR)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const s=this._lodPlanes.length;for(let r=1;r<s;r++){const a=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=e4[(s-r-1)%e4.length];this._blur(e,r-1,r,a,o)}t.autoClear=n}_blur(e,t,n,s,r){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,s,"latitudinal",r),this._halfBlur(a,e,n,n,s,"longitudinal",r)}_halfBlur(e,t,n,s,r,a,o){const l=this._renderer,c=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,d=new ms(this._lodPlanes[s],c),m=c.uniforms,y=this._sizeLods[n]-1,x=isFinite(r)?Math.PI/(2*y):2*Math.PI/(2*dm-1),_=r/x,b=isFinite(r)?1+Math.floor(h*_):dm;b>dm&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${b} samples when the maximum is set to ${dm}`);const A=[];let T=0;for(let U=0;U<dm;++U){const P=U/_,B=Math.exp(-P*P/2);A.push(B),U===0?T+=B:U<b&&(T+=2*B)}for(let U=0;U<A.length;U++)A[U]=A[U]/T;m.envMap.value=e.texture,m.samples.value=b,m.weights.value=A,m.latitudinal.value=a==="latitudinal",o&&(m.poleAxis.value=o);const{_lodMax:w}=this;m.dTheta.value=x,m.mipInt.value=w-n;const R=this._sizeLods[s],O=3*R*(s>w-dy?s-w+dy:0),N=4*(this._cubeSize-R);qS(t,O,N,3*R,2*R),l.setRenderTarget(t),l.render(d,JR)}}function Eue(i){const e=[],t=[],n=[];let s=i;const r=i-dy+1+JF.length;for(let a=0;a<r;a++){const o=Math.pow(2,s);t.push(o);let l=1/o;a>i-dy?l=JF[a-i+dy-1]:a===0&&(l=0),n.push(l);const c=1/(o-2),h=-c,d=1+c,m=[h,h,d,h,d,d,h,h,d,d,h,d],y=6,x=6,_=3,b=2,A=1,T=new Float32Array(_*x*y),w=new Float32Array(b*x*y),R=new Float32Array(A*x*y);for(let N=0;N<y;N++){const U=N%3*2/3-1,P=N>2?0:-1,B=[U,P,0,U+2/3,P,0,U+2/3,P+1,0,U,P,0,U+2/3,P+1,0,U,P+1,0];T.set(B,_*x*N),w.set(m,b*x*N);const L=[N,N,N,N,N,N];R.set(L,A*x*N)}const O=new Tn;O.setAttribute("position",new ci(T,_)),O.setAttribute("uv",new ci(w,b)),O.setAttribute("faceIndex",new ci(R,A)),e.push(O),s>dy&&s--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function t4(i,e,t){const n=new Os(i,e,t);return n.texture.mapping=Wv,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function qS(i,e,t,n,s){i.viewport.set(e,t,n,s),i.scissor.set(e,t,n,s)}function _ue(i,e,t){const n=new Float32Array(dm),s=new se(0,1,0);return new js({name:"SphericalGaussianBlur",defines:{n:dm,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:xO(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:la,depthTest:!1,depthWrite:!1})}function n4(){return new js({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:xO(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:la,depthTest:!1,depthWrite:!1})}function i4(){return new js({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:xO(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:la,depthTest:!1,depthWrite:!1})}function xO(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Sue(i){let e=new WeakMap,t=null;function n(o){if(o&&o.isTexture){const l=o.mapping,c=l===Mv||l===qA,h=l===gh||l===N0;if(c||h){let d=e.get(o);const m=d!==void 0?d.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==m)return t===null&&(t=new sI(i)),d=c?t.fromEquirectangular(o,d):t.fromCubemap(o,d),d.texture.pmremVersion=o.pmremVersion,e.set(o,d),d.texture;if(d!==void 0)return d.texture;{const y=o.image;return c&&y&&y.height>0||h&&y&&s(y)?(t===null&&(t=new sI(i)),d=c?t.fromEquirectangular(o):t.fromCubemap(o),d.texture.pmremVersion=o.pmremVersion,e.set(o,d),o.addEventListener("dispose",r),d.texture):null}}}return o}function s(o){let l=0;const c=6;for(let h=0;h<c;h++)o[h]!==void 0&&l++;return l===c}function r(o){const l=o.target;l.removeEventListener("dispose",r);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:a}}function Tue(i){const e={};function t(n){if(e[n]!==void 0)return e[n];let s;switch(n){case"WEBGL_depth_texture":s=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=i.getExtension(n)}return e[n]=s,s}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const s=t(n);return s===null&&GT("THREE.WebGLRenderer: "+n+" extension not supported."),s}}}function wue(i,e,t,n){const s={},r=new WeakMap;function a(d){const m=d.target;m.index!==null&&e.remove(m.index);for(const x in m.attributes)e.remove(m.attributes[x]);m.removeEventListener("dispose",a),delete s[m.id];const y=r.get(m);y&&(e.remove(y),r.delete(m)),n.releaseStatesOfGeometry(m),m.isInstancedBufferGeometry===!0&&delete m._maxInstanceCount,t.memory.geometries--}function o(d,m){return s[m.id]===!0||(m.addEventListener("dispose",a),s[m.id]=!0,t.memory.geometries++),m}function l(d){const m=d.attributes;for(const y in m)e.update(m[y],i.ARRAY_BUFFER)}function c(d){const m=[],y=d.index,x=d.attributes.position;let _=0;if(y!==null){const T=y.array;_=y.version;for(let w=0,R=T.length;w<R;w+=3){const O=T[w+0],N=T[w+1],U=T[w+2];m.push(O,N,N,U,U,O)}}else if(x!==void 0){const T=x.array;_=x.version;for(let w=0,R=T.length/3-1;w<R;w+=3){const O=w+0,N=w+1,U=w+2;m.push(O,N,N,U,U,O)}}else return;const b=new(p9(m)?VB:zB)(m,1);b.version=_;const A=r.get(d);A&&e.remove(A),r.set(d,b)}function h(d){const m=r.get(d);if(m){const y=d.index;y!==null&&m.version<y.version&&c(d)}else c(d);return r.get(d)}return{get:o,update:l,getWireframeAttribute:h}}function Mue(i,e,t){let n;function s(m){n=m}let r,a;function o(m){r=m.type,a=m.bytesPerElement}function l(m,y){i.drawElements(n,y,r,m*a),t.update(y,n,1)}function c(m,y,x){x!==0&&(i.drawElementsInstanced(n,y,r,m*a,x),t.update(y,n,x))}function h(m,y,x){if(x===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,y,0,r,m,0,x);let b=0;for(let A=0;A<x;A++)b+=y[A];t.update(b,n,1)}function d(m,y,x,_){if(x===0)return;const b=e.get("WEBGL_multi_draw");if(b===null)for(let A=0;A<m.length;A++)c(m[A]/a,y[A],_[A]);else{b.multiDrawElementsInstancedWEBGL(n,y,0,r,m,0,_,0,x);let A=0;for(let T=0;T<x;T++)A+=y[T]*_[T];t.update(A,n,1)}}this.setMode=s,this.setIndex=o,this.render=l,this.renderInstances=c,this.renderMultiDraw=h,this.renderMultiDrawInstances=d}function Cue(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(r,a,o){switch(t.calls++,a){case i.TRIANGLES:t.triangles+=o*(r/3);break;case i.LINES:t.lines+=o*(r/2);break;case i.LINE_STRIP:t.lines+=o*(r-1);break;case i.LINE_LOOP:t.lines+=o*r;break;case i.POINTS:t.points+=o*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:s,update:n}}function Rue(i,e,t){const n=new WeakMap,s=new ai;function r(a,o,l){const c=a.morphTargetInfluences,h=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,d=h!==void 0?h.length:0;let m=n.get(o);if(m===void 0||m.count!==d){let L=function(){P.dispose(),n.delete(o),o.removeEventListener("dispose",L)};var y=L;m!==void 0&&m.texture.dispose();const x=o.morphAttributes.position!==void 0,_=o.morphAttributes.normal!==void 0,b=o.morphAttributes.color!==void 0,A=o.morphAttributes.position||[],T=o.morphAttributes.normal||[],w=o.morphAttributes.color||[];let R=0;x===!0&&(R=1),_===!0&&(R=2),b===!0&&(R=3);let O=o.attributes.position.count*R,N=1;O>e.maxTextureSize&&(N=Math.ceil(O/e.maxTextureSize),O=e.maxTextureSize);const U=new Float32Array(O*N*4*d),P=new GE(U,O,N,d);P.type=ps,P.needsUpdate=!0;const B=R*4;for(let F=0;F<d;F++){const j=A[F],J=T[F],re=w[F],q=O*N*4*F;for(let W=0;W<j.count;W++){const ne=W*B;x===!0&&(s.fromBufferAttribute(j,W),U[q+ne+0]=s.x,U[q+ne+1]=s.y,U[q+ne+2]=s.z,U[q+ne+3]=0),_===!0&&(s.fromBufferAttribute(J,W),U[q+ne+4]=s.x,U[q+ne+5]=s.y,U[q+ne+6]=s.z,U[q+ne+7]=0),b===!0&&(s.fromBufferAttribute(re,W),U[q+ne+8]=s.x,U[q+ne+9]=s.y,U[q+ne+10]=s.z,U[q+ne+11]=re.itemSize===4?s.w:1)}}m={count:d,texture:P,size:new Qe(O,N)},n.set(o,m),o.addEventListener("dispose",L)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)l.getUniforms().setValue(i,"morphTexture",a.morphTexture,t);else{let x=0;for(let b=0;b<c.length;b++)x+=c[b];const _=o.morphTargetsRelative?1:1-x;l.getUniforms().setValue(i,"morphTargetBaseInfluence",_),l.getUniforms().setValue(i,"morphTargetInfluences",c)}l.getUniforms().setValue(i,"morphTargetsTexture",m.texture,t),l.getUniforms().setValue(i,"morphTargetsTextureSize",m.size)}return{update:r}}function Due(i,e,t,n){let s=new WeakMap;function r(l){const c=n.render.frame,h=l.geometry,d=e.get(l,h);if(s.get(d)!==c&&(e.update(d),s.set(d,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),s.get(l)!==c&&(t.update(l.instanceMatrix,i.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,i.ARRAY_BUFFER),s.set(l,c))),l.isSkinnedMesh){const m=l.skeleton;s.get(m)!==c&&(m.update(),s.set(m,c))}return d}function a(){s=new WeakMap}function o(l){const c=l.target;c.removeEventListener("dispose",o),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:r,dispose:a}}const fV=new wi,s4=new jv(1,1),dV=new GE,pV=new lM,mV=new VE,r4=[],a4=[],o4=new Float32Array(16),l4=new Float32Array(9),c4=new Float32Array(4);function $v(i,e,t){const n=i[0];if(n<=0||n>0)return i;const s=e*t;let r=r4[s];if(r===void 0&&(r=new Float32Array(s),r4[s]=r),e!==0){n.toArray(r,0);for(let a=1,o=0;a!==e;++a)o+=t,i[a].toArray(r,o)}return r}function Mr(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function Cr(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function RM(i,e){let t=a4[e];t===void 0&&(t=new Int32Array(e),a4[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function Lue(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function Iue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Mr(t,e))return;i.uniform2fv(this.addr,e),Cr(t,e)}}function Bue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Mr(t,e))return;i.uniform3fv(this.addr,e),Cr(t,e)}}function Oue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Mr(t,e))return;i.uniform4fv(this.addr,e),Cr(t,e)}}function Pue(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Mr(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Cr(t,e)}else{if(Mr(t,n))return;c4.set(n),i.uniformMatrix2fv(this.addr,!1,c4),Cr(t,n)}}function Nue(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Mr(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Cr(t,e)}else{if(Mr(t,n))return;l4.set(n),i.uniformMatrix3fv(this.addr,!1,l4),Cr(t,n)}}function Uue(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Mr(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Cr(t,e)}else{if(Mr(t,n))return;o4.set(n),i.uniformMatrix4fv(this.addr,!1,o4),Cr(t,n)}}function kue(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function Fue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Mr(t,e))return;i.uniform2iv(this.addr,e),Cr(t,e)}}function Hue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Mr(t,e))return;i.uniform3iv(this.addr,e),Cr(t,e)}}function Gue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Mr(t,e))return;i.uniform4iv(this.addr,e),Cr(t,e)}}function zue(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function Vue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Mr(t,e))return;i.uniform2uiv(this.addr,e),Cr(t,e)}}function Yue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Mr(t,e))return;i.uniform3uiv(this.addr,e),Cr(t,e)}}function Kue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Mr(t,e))return;i.uniform4uiv(this.addr,e),Cr(t,e)}}function Wue(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s);let r;this.type===i.SAMPLER_2D_SHADOW?(s4.compareFunction=HB,r=s4):r=fV,t.setTexture2D(e||r,s)}function Xue(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTexture3D(e||pV,s)}function jue(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTextureCube(e||mV,s)}function que(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTexture2DArray(e||dV,s)}function Que(i){switch(i){case 5126:return Lue;case 35664:return Iue;case 35665:return Bue;case 35666:return Oue;case 35674:return Pue;case 35675:return Nue;case 35676:return Uue;case 5124:case 35670:return kue;case 35667:case 35671:return Fue;case 35668:case 35672:return Hue;case 35669:case 35673:return Gue;case 5125:return zue;case 36294:return Vue;case 36295:return Yue;case 36296:return Kue;case 35678:case 36198:case 36298:case 36306:case 35682:return Wue;case 35679:case 36299:case 36307:return Xue;case 35680:case 36300:case 36308:case 36293:return jue;case 36289:case 36303:case 36311:case 36292:return que}}function $ue(i,e){i.uniform1fv(this.addr,e)}function Jue(i,e){const t=$v(e,this.size,2);i.uniform2fv(this.addr,t)}function Zue(i,e){const t=$v(e,this.size,3);i.uniform3fv(this.addr,t)}function ehe(i,e){const t=$v(e,this.size,4);i.uniform4fv(this.addr,t)}function the(i,e){const t=$v(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function nhe(i,e){const t=$v(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function ihe(i,e){const t=$v(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function she(i,e){i.uniform1iv(this.addr,e)}function rhe(i,e){i.uniform2iv(this.addr,e)}function ahe(i,e){i.uniform3iv(this.addr,e)}function ohe(i,e){i.uniform4iv(this.addr,e)}function lhe(i,e){i.uniform1uiv(this.addr,e)}function che(i,e){i.uniform2uiv(this.addr,e)}function uhe(i,e){i.uniform3uiv(this.addr,e)}function hhe(i,e){i.uniform4uiv(this.addr,e)}function fhe(i,e,t){const n=this.cache,s=e.length,r=RM(t,s);Mr(n,r)||(i.uniform1iv(this.addr,r),Cr(n,r));for(let a=0;a!==s;++a)t.setTexture2D(e[a]||fV,r[a])}function dhe(i,e,t){const n=this.cache,s=e.length,r=RM(t,s);Mr(n,r)||(i.uniform1iv(this.addr,r),Cr(n,r));for(let a=0;a!==s;++a)t.setTexture3D(e[a]||pV,r[a])}function phe(i,e,t){const n=this.cache,s=e.length,r=RM(t,s);Mr(n,r)||(i.uniform1iv(this.addr,r),Cr(n,r));for(let a=0;a!==s;++a)t.setTextureCube(e[a]||mV,r[a])}function mhe(i,e,t){const n=this.cache,s=e.length,r=RM(t,s);Mr(n,r)||(i.uniform1iv(this.addr,r),Cr(n,r));for(let a=0;a!==s;++a)t.setTexture2DArray(e[a]||dV,r[a])}function ghe(i){switch(i){case 5126:return $ue;case 35664:return Jue;case 35665:return Zue;case 35666:return ehe;case 35674:return the;case 35675:return nhe;case 35676:return ihe;case 5124:case 35670:return she;case 35667:case 35671:return rhe;case 35668:case 35672:return ahe;case 35669:case 35673:return ohe;case 5125:return lhe;case 36294:return che;case 36295:return uhe;case 36296:return hhe;case 35678:case 36198:case 36298:case 36306:case 35682:return fhe;case 35679:case 36299:case 36307:return dhe;case 35680:case 36300:case 36308:case 36293:return phe;case 36289:case 36303:case 36311:case 36292:return mhe}}class yhe{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=Que(t.type)}}class vhe{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=ghe(t.type)}}class xhe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const s=this.seq;for(let r=0,a=s.length;r!==a;++r){const o=s[r];o.setValue(e,t[o.id],n)}}}const iD=/(\w+)(\])?(\[|\.)?/g;function u4(i,e){i.seq.push(e),i.map[e.id]=e}function bhe(i,e,t){const n=i.name,s=n.length;for(iD.lastIndex=0;;){const r=iD.exec(n),a=iD.lastIndex;let o=r[1];const l=r[2]==="]",c=r[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===s){u4(t,c===void 0?new yhe(o,i,e):new vhe(o,i,e));break}else{let d=t.map[o];d===void 0&&(d=new xhe(o),u4(t,d)),t=d}}}class VT{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<n;++s){const r=e.getActiveUniform(t,s),a=e.getUniformLocation(t,r.name);bhe(r,a,this)}}setValue(e,t,n,s){const r=this.map[t];r!==void 0&&r.setValue(e,n,s)}setOptional(e,t,n){const s=t[n];s!==void 0&&this.setValue(e,n,s)}static upload(e,t,n,s){for(let r=0,a=t.length;r!==a;++r){const o=t[r],l=n[o.id];l.needsUpdate!==!1&&o.setValue(e,l.value,s)}}static seqWithValue(e,t){const n=[];for(let s=0,r=e.length;s!==r;++s){const a=e[s];a.id in t&&n.push(a)}return n}}function h4(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const Ahe=37297;let Ehe=0;function _he(i,e){const t=i.split(`
`),n=[],s=Math.max(e-6,0),r=Math.min(e+6,t.length);for(let a=s;a<r;a++){const o=a+1;n.push(`${o===e?">":" "} ${o}: ${t[a]}`)}return n.join(`
`)}const f4=new Bn;function She(i){ri._getMatrix(f4,ri.workingColorSpace,i);const e=`mat3( ${f4.elements.map(t=>t.toFixed(4))} )`;switch(ri.getTransfer(i)){case $A:return[e,"LinearTransferOETF"];case Hi:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function d4(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),s=i.getShaderInfoLog(e).trim();if(n&&s==="")return"";const r=/ERROR: 0:(\d+)/.exec(s);if(r){const a=parseInt(r[1]);return t.toUpperCase()+`

`+s+`

`+_he(i.getShaderSource(e),a)}else return s}function The(i,e){const t=She(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function whe(i,e){let t;switch(e){case X6:t="Linear";break;case j6:t="Reinhard";break;case q6:t="Cineon";break;case IB:t="ACESFilmic";break;case $6:t="AgX";break;case J6:t="Neutral";break;case Q6:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const QS=new se;function Mhe(){ri.getLuminanceCoefficients(QS);const i=QS.x.toFixed(4),e=QS.y.toFixed(4),t=QS.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Che(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(eA).join(`
`)}function Rhe(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function Dhe(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let s=0;s<n;s++){const r=i.getActiveAttrib(e,s),a=r.name;let o=1;r.type===i.FLOAT_MAT2&&(o=2),r.type===i.FLOAT_MAT3&&(o=3),r.type===i.FLOAT_MAT4&&(o=4),t[a]={type:r.type,location:i.getAttribLocation(e,a),locationSize:o}}return t}function eA(i){return i!==""}function p4(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function m4(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Lhe=/^[ \t]*#include +<([\w\d./]+)>/gm;function rI(i){return i.replace(Lhe,Bhe)}const Ihe=new Map;function Bhe(i,e){let t=Fn[e];if(t===void 0){const n=Ihe.get(e);if(n!==void 0)t=Fn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return rI(t)}const Ohe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function g4(i){return i.replace(Ohe,Phe)}function Phe(i,e,t,n){let s="";for(let r=parseInt(e);r<parseInt(t);r++)s+=n.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return s}function y4(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Nhe(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===Jw?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===uA?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===Lc&&(e="SHADOWMAP_TYPE_VSM"),e}function Uhe(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case gh:case N0:e="ENVMAP_TYPE_CUBE";break;case Wv:e="ENVMAP_TYPE_CUBE_UV";break}return e}function khe(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case N0:e="ENVMAP_MODE_REFRACTION";break}return e}function Fhe(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case UE:e="ENVMAP_BLENDING_MULTIPLY";break;case K6:e="ENVMAP_BLENDING_MIX";break;case W6:e="ENVMAP_BLENDING_ADD";break}return e}function Hhe(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function Ghe(i,e,t,n){const s=i.getContext(),r=t.defines;let a=t.vertexShader,o=t.fragmentShader;const l=Nhe(t),c=Uhe(t),h=khe(t),d=Fhe(t),m=Hhe(t),y=Che(t),x=Rhe(r),_=s.createProgram();let b,A,T=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(b=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x].filter(eA).join(`
`),b.length>0&&(b+=`
`),A=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x].filter(eA).join(`
`),A.length>0&&(A+=`
`)):(b=[y4(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(eA).join(`
`),A=[y4(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",t.envMap?"#define "+d:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Vc?"#define TONE_MAPPING":"",t.toneMapping!==Vc?Fn.tonemapping_pars_fragment:"",t.toneMapping!==Vc?whe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Fn.colorspace_pars_fragment,The("linearToOutputTexel",t.outputColorSpace),Mhe(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(eA).join(`
`)),a=rI(a),a=p4(a,t),a=m4(a,t),o=rI(o),o=p4(o,t),o=m4(o,t),a=g4(a),o=g4(o),t.isRawShaderMaterial!==!0&&(T=`#version 300 es
`,b=[y,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+b,A=["#define varying in",t.glslVersion===QL?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===QL?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+A);const w=T+b+a,R=T+A+o,O=h4(s,s.VERTEX_SHADER,w),N=h4(s,s.FRAGMENT_SHADER,R);s.attachShader(_,O),s.attachShader(_,N),t.index0AttributeName!==void 0?s.bindAttribLocation(_,0,t.index0AttributeName):t.morphTargets===!0&&s.bindAttribLocation(_,0,"position"),s.linkProgram(_);function U(F){if(i.debug.checkShaderErrors){const j=s.getProgramInfoLog(_).trim(),J=s.getShaderInfoLog(O).trim(),re=s.getShaderInfoLog(N).trim();let q=!0,W=!0;if(s.getProgramParameter(_,s.LINK_STATUS)===!1)if(q=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(s,_,O,N);else{const ne=d4(s,O,"vertex"),ie=d4(s,N,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(_,s.VALIDATE_STATUS)+`

Material Name: `+F.name+`
Material Type: `+F.type+`

Program Info Log: `+j+`
`+ne+`
`+ie)}else j!==""?console.warn("THREE.WebGLProgram: Program Info Log:",j):(J===""||re==="")&&(W=!1);W&&(F.diagnostics={runnable:q,programLog:j,vertexShader:{log:J,prefix:b},fragmentShader:{log:re,prefix:A}})}s.deleteShader(O),s.deleteShader(N),P=new VT(s,_),B=Dhe(s,_)}let P;this.getUniforms=function(){return P===void 0&&U(this),P};let B;this.getAttributes=function(){return B===void 0&&U(this),B};let L=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return L===!1&&(L=s.getProgramParameter(_,Ahe)),L},this.destroy=function(){n.releaseStatesOfProgram(this),s.deleteProgram(_),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Ehe++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=O,this.fragmentShader=N,this}let zhe=0;class Vhe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,s=this._getShaderStage(t),r=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return a.has(s)===!1&&(a.add(s),s.usedTimes++),a.has(r)===!1&&(a.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new Yhe(e),t.set(e,n)),n}}class Yhe{constructor(e){this.id=zhe++,this.code=e,this.usedTimes=0}}function Khe(i,e,t,n,s,r,a){const o=new Ov,l=new Vhe,c=new Set,h=[],d=s.logarithmicDepthBuffer,m=s.vertexTextures;let y=s.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(B){return c.add(B),B===0?"uv":`uv${B}`}function b(B,L,F,j,J){const re=j.fog,q=J.geometry,W=B.isMeshStandardMaterial?j.environment:null,ne=(B.isMeshStandardMaterial?t:e).get(B.envMap||W),ie=ne&&ne.mapping===Wv?ne.image.height:null,ue=x[B.type];B.precision!==null&&(y=s.getMaxPrecision(B.precision),y!==B.precision&&console.warn("THREE.WebGLProgram.getParameters:",B.precision,"not supported, using",y,"instead."));const z=q.morphAttributes.position||q.morphAttributes.normal||q.morphAttributes.color,ae=z!==void 0?z.length:0;let ge=0;q.morphAttributes.position!==void 0&&(ge=1),q.morphAttributes.normal!==void 0&&(ge=2),q.morphAttributes.color!==void 0&&(ge=3);let Ee,le,Ce,Me;if(ue){const _n=Uc[ue];Ee=_n.vertexShader,le=_n.fragmentShader}else Ee=B.vertexShader,le=B.fragmentShader,l.update(B),Ce=l.getVertexShaderID(B),Me=l.getFragmentShaderID(B);const Ze=i.getRenderTarget(),tt=i.state.buffers.depth.getReversed(),Mt=J.isInstancedMesh===!0,bt=J.isBatchedMesh===!0,cn=!!B.map,tn=!!B.matcap,Ot=!!ne,te=!!B.aoMap,At=!!B.lightMap,Ve=!!B.bumpMap,st=!!B.normalMap,$e=!!B.displacementMap,Pt=!!B.emissiveMap,nt=!!B.metalnessMap,ee=!!B.roughnessMap,X=B.anisotropy>0,we=B.clearcoat>0,Fe=B.dispersion>0,ut=B.iridescence>0,We=B.sheen>0,ot=B.transmission>0,et=X&&!!B.anisotropyMap,pt=we&&!!B.clearcoatMap,vt=we&&!!B.clearcoatNormalMap,it=we&&!!B.clearcoatRoughnessMap,Ct=ut&&!!B.iridescenceMap,Et=ut&&!!B.iridescenceThicknessMap,Dt=We&&!!B.sheenColorMap,Nt=We&&!!B.sheenRoughnessMap,ve=!!B.specularMap,He=!!B.specularColorMap,St=!!B.specularIntensityMap,xe=ot&&!!B.transmissionMap,Oe=ot&&!!B.thicknessMap,Ge=!!B.gradientMap,rt=!!B.alphaMap,It=B.alphaTest>0,Bt=!!B.alphaHash,$t=!!B.extensions;let Pn=Vc;B.toneMapped&&(Ze===null||Ze.isXRRenderTarget===!0)&&(Pn=i.toneMapping);const gi={shaderID:ue,shaderType:B.type,shaderName:B.name,vertexShader:Ee,fragmentShader:le,defines:B.defines,customVertexShaderID:Ce,customFragmentShaderID:Me,isRawShaderMaterial:B.isRawShaderMaterial===!0,glslVersion:B.glslVersion,precision:y,batching:bt,batchingColor:bt&&J._colorsTexture!==null,instancing:Mt,instancingColor:Mt&&J.instanceColor!==null,instancingMorph:Mt&&J.morphTexture!==null,supportsVertexTextures:m,outputColorSpace:Ze===null?i.outputColorSpace:Ze.isXRRenderTarget===!0?Ze.texture.colorSpace:nl,alphaToCoverage:!!B.alphaToCoverage,map:cn,matcap:tn,envMap:Ot,envMapMode:Ot&&ne.mapping,envMapCubeUVHeight:ie,aoMap:te,lightMap:At,bumpMap:Ve,normalMap:st,displacementMap:m&&$e,emissiveMap:Pt,normalMapObjectSpace:st&&B.normalMapType===r9,normalMapTangentSpace:st&&B.normalMapType===Y0,metalnessMap:nt,roughnessMap:ee,anisotropy:X,anisotropyMap:et,clearcoat:we,clearcoatMap:pt,clearcoatNormalMap:vt,clearcoatRoughnessMap:it,dispersion:Fe,iridescence:ut,iridescenceMap:Ct,iridescenceThicknessMap:Et,sheen:We,sheenColorMap:Dt,sheenRoughnessMap:Nt,specularMap:ve,specularColorMap:He,specularIntensityMap:St,transmission:ot,transmissionMap:xe,thicknessMap:Oe,gradientMap:Ge,opaque:B.transparent===!1&&B.blending===Jm&&B.alphaToCoverage===!1,alphaMap:rt,alphaTest:It,alphaHash:Bt,combine:B.combine,mapUv:cn&&_(B.map.channel),aoMapUv:te&&_(B.aoMap.channel),lightMapUv:At&&_(B.lightMap.channel),bumpMapUv:Ve&&_(B.bumpMap.channel),normalMapUv:st&&_(B.normalMap.channel),displacementMapUv:$e&&_(B.displacementMap.channel),emissiveMapUv:Pt&&_(B.emissiveMap.channel),metalnessMapUv:nt&&_(B.metalnessMap.channel),roughnessMapUv:ee&&_(B.roughnessMap.channel),anisotropyMapUv:et&&_(B.anisotropyMap.channel),clearcoatMapUv:pt&&_(B.clearcoatMap.channel),clearcoatNormalMapUv:vt&&_(B.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:it&&_(B.clearcoatRoughnessMap.channel),iridescenceMapUv:Ct&&_(B.iridescenceMap.channel),iridescenceThicknessMapUv:Et&&_(B.iridescenceThicknessMap.channel),sheenColorMapUv:Dt&&_(B.sheenColorMap.channel),sheenRoughnessMapUv:Nt&&_(B.sheenRoughnessMap.channel),specularMapUv:ve&&_(B.specularMap.channel),specularColorMapUv:He&&_(B.specularColorMap.channel),specularIntensityMapUv:St&&_(B.specularIntensityMap.channel),transmissionMapUv:xe&&_(B.transmissionMap.channel),thicknessMapUv:Oe&&_(B.thicknessMap.channel),alphaMapUv:rt&&_(B.alphaMap.channel),vertexTangents:!!q.attributes.tangent&&(st||X),vertexColors:B.vertexColors,vertexAlphas:B.vertexColors===!0&&!!q.attributes.color&&q.attributes.color.itemSize===4,pointsUvs:J.isPoints===!0&&!!q.attributes.uv&&(cn||rt),fog:!!re,useFog:B.fog===!0,fogExp2:!!re&&re.isFogExp2,flatShading:B.flatShading===!0,sizeAttenuation:B.sizeAttenuation===!0,logarithmicDepthBuffer:d,reverseDepthBuffer:tt,skinning:J.isSkinnedMesh===!0,morphTargets:q.morphAttributes.position!==void 0,morphNormals:q.morphAttributes.normal!==void 0,morphColors:q.morphAttributes.color!==void 0,morphTargetsCount:ae,morphTextureStride:ge,numDirLights:L.directional.length,numPointLights:L.point.length,numSpotLights:L.spot.length,numSpotLightMaps:L.spotLightMap.length,numRectAreaLights:L.rectArea.length,numHemiLights:L.hemi.length,numDirLightShadows:L.directionalShadowMap.length,numPointLightShadows:L.pointShadowMap.length,numSpotLightShadows:L.spotShadowMap.length,numSpotLightShadowsWithMaps:L.numSpotLightShadowsWithMaps,numLightProbes:L.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:B.dithering,shadowMapEnabled:i.shadowMap.enabled&&F.length>0,shadowMapType:i.shadowMap.type,toneMapping:Pn,decodeVideoTexture:cn&&B.map.isVideoTexture===!0&&ri.getTransfer(B.map.colorSpace)===Hi,decodeVideoTextureEmissive:Pt&&B.emissiveMap.isVideoTexture===!0&&ri.getTransfer(B.emissiveMap.colorSpace)===Hi,premultipliedAlpha:B.premultipliedAlpha,doubleSided:B.side===Da,flipSided:B.side===wr,useDepthPacking:B.depthPacking>=0,depthPacking:B.depthPacking||0,index0AttributeName:B.index0AttributeName,extensionClipCullDistance:$t&&B.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:($t&&B.extensions.multiDraw===!0||bt)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:B.customProgramCacheKey()};return gi.vertexUv1s=c.has(1),gi.vertexUv2s=c.has(2),gi.vertexUv3s=c.has(3),c.clear(),gi}function A(B){const L=[];if(B.shaderID?L.push(B.shaderID):(L.push(B.customVertexShaderID),L.push(B.customFragmentShaderID)),B.defines!==void 0)for(const F in B.defines)L.push(F),L.push(B.defines[F]);return B.isRawShaderMaterial===!1&&(T(L,B),w(L,B),L.push(i.outputColorSpace)),L.push(B.customProgramCacheKey),L.join()}function T(B,L){B.push(L.precision),B.push(L.outputColorSpace),B.push(L.envMapMode),B.push(L.envMapCubeUVHeight),B.push(L.mapUv),B.push(L.alphaMapUv),B.push(L.lightMapUv),B.push(L.aoMapUv),B.push(L.bumpMapUv),B.push(L.normalMapUv),B.push(L.displacementMapUv),B.push(L.emissiveMapUv),B.push(L.metalnessMapUv),B.push(L.roughnessMapUv),B.push(L.anisotropyMapUv),B.push(L.clearcoatMapUv),B.push(L.clearcoatNormalMapUv),B.push(L.clearcoatRoughnessMapUv),B.push(L.iridescenceMapUv),B.push(L.iridescenceThicknessMapUv),B.push(L.sheenColorMapUv),B.push(L.sheenRoughnessMapUv),B.push(L.specularMapUv),B.push(L.specularColorMapUv),B.push(L.specularIntensityMapUv),B.push(L.transmissionMapUv),B.push(L.thicknessMapUv),B.push(L.combine),B.push(L.fogExp2),B.push(L.sizeAttenuation),B.push(L.morphTargetsCount),B.push(L.morphAttributeCount),B.push(L.numDirLights),B.push(L.numPointLights),B.push(L.numSpotLights),B.push(L.numSpotLightMaps),B.push(L.numHemiLights),B.push(L.numRectAreaLights),B.push(L.numDirLightShadows),B.push(L.numPointLightShadows),B.push(L.numSpotLightShadows),B.push(L.numSpotLightShadowsWithMaps),B.push(L.numLightProbes),B.push(L.shadowMapType),B.push(L.toneMapping),B.push(L.numClippingPlanes),B.push(L.numClipIntersection),B.push(L.depthPacking)}function w(B,L){o.disableAll(),L.supportsVertexTextures&&o.enable(0),L.instancing&&o.enable(1),L.instancingColor&&o.enable(2),L.instancingMorph&&o.enable(3),L.matcap&&o.enable(4),L.envMap&&o.enable(5),L.normalMapObjectSpace&&o.enable(6),L.normalMapTangentSpace&&o.enable(7),L.clearcoat&&o.enable(8),L.iridescence&&o.enable(9),L.alphaTest&&o.enable(10),L.vertexColors&&o.enable(11),L.vertexAlphas&&o.enable(12),L.vertexUv1s&&o.enable(13),L.vertexUv2s&&o.enable(14),L.vertexUv3s&&o.enable(15),L.vertexTangents&&o.enable(16),L.anisotropy&&o.enable(17),L.alphaHash&&o.enable(18),L.batching&&o.enable(19),L.dispersion&&o.enable(20),L.batchingColor&&o.enable(21),B.push(o.mask),o.disableAll(),L.fog&&o.enable(0),L.useFog&&o.enable(1),L.flatShading&&o.enable(2),L.logarithmicDepthBuffer&&o.enable(3),L.reverseDepthBuffer&&o.enable(4),L.skinning&&o.enable(5),L.morphTargets&&o.enable(6),L.morphNormals&&o.enable(7),L.morphColors&&o.enable(8),L.premultipliedAlpha&&o.enable(9),L.shadowMapEnabled&&o.enable(10),L.doubleSided&&o.enable(11),L.flipSided&&o.enable(12),L.useDepthPacking&&o.enable(13),L.dithering&&o.enable(14),L.transmission&&o.enable(15),L.sheen&&o.enable(16),L.opaque&&o.enable(17),L.pointsUvs&&o.enable(18),L.decodeVideoTexture&&o.enable(19),L.decodeVideoTextureEmissive&&o.enable(20),L.alphaToCoverage&&o.enable(21),B.push(o.mask)}function R(B){const L=x[B.type];let F;if(L){const j=Uc[L];F=x9.clone(j.uniforms)}else F=B.uniforms;return F}function O(B,L){let F;for(let j=0,J=h.length;j<J;j++){const re=h[j];if(re.cacheKey===L){F=re,++F.usedTimes;break}}return F===void 0&&(F=new Ghe(i,L,B,r),h.push(F)),F}function N(B){if(--B.usedTimes===0){const L=h.indexOf(B);h[L]=h[h.length-1],h.pop(),B.destroy()}}function U(B){l.remove(B)}function P(){l.dispose()}return{getParameters:b,getProgramCacheKey:A,getUniforms:R,acquireProgram:O,releaseProgram:N,releaseShaderCache:U,programs:h,dispose:P}}function Whe(){let i=new WeakMap;function e(a){return i.has(a)}function t(a){let o=i.get(a);return o===void 0&&(o={},i.set(a,o)),o}function n(a){i.delete(a)}function s(a,o,l){i.get(a)[o]=l}function r(){i=new WeakMap}return{has:e,get:t,remove:n,update:s,dispose:r}}function Xhe(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function v4(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function x4(){const i=[];let e=0;const t=[],n=[],s=[];function r(){e=0,t.length=0,n.length=0,s.length=0}function a(d,m,y,x,_,b){let A=i[e];return A===void 0?(A={id:d.id,object:d,geometry:m,material:y,groupOrder:x,renderOrder:d.renderOrder,z:_,group:b},i[e]=A):(A.id=d.id,A.object=d,A.geometry=m,A.material=y,A.groupOrder=x,A.renderOrder=d.renderOrder,A.z=_,A.group=b),e++,A}function o(d,m,y,x,_,b){const A=a(d,m,y,x,_,b);y.transmission>0?n.push(A):y.transparent===!0?s.push(A):t.push(A)}function l(d,m,y,x,_,b){const A=a(d,m,y,x,_,b);y.transmission>0?n.unshift(A):y.transparent===!0?s.unshift(A):t.unshift(A)}function c(d,m){t.length>1&&t.sort(d||Xhe),n.length>1&&n.sort(m||v4),s.length>1&&s.sort(m||v4)}function h(){for(let d=e,m=i.length;d<m;d++){const y=i[d];if(y.id===null)break;y.id=null,y.object=null,y.geometry=null,y.material=null,y.group=null}}return{opaque:t,transmissive:n,transparent:s,init:r,push:o,unshift:l,finish:h,sort:c}}function jhe(){let i=new WeakMap;function e(n,s){const r=i.get(n);let a;return r===void 0?(a=new x4,i.set(n,[a])):s>=r.length?(a=new x4,r.push(a)):a=r[s],a}function t(){i=new WeakMap}return{get:e,dispose:t}}function qhe(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new se,color:new Ut};break;case"SpotLight":t={position:new se,direction:new se,color:new Ut,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new se,color:new Ut,distance:0,decay:0};break;case"HemisphereLight":t={direction:new se,skyColor:new Ut,groundColor:new Ut};break;case"RectAreaLight":t={color:new Ut,position:new se,halfWidth:new se,halfHeight:new se};break}return i[e.id]=t,t}}}function Qhe(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qe};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qe};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qe,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let $he=0;function Jhe(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function Zhe(i){const e=new qhe,t=Qhe(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)n.probe.push(new se);const s=new se,r=new hn,a=new hn;function o(c){let h=0,d=0,m=0;for(let B=0;B<9;B++)n.probe[B].set(0,0,0);let y=0,x=0,_=0,b=0,A=0,T=0,w=0,R=0,O=0,N=0,U=0;c.sort(Jhe);for(let B=0,L=c.length;B<L;B++){const F=c[B],j=F.color,J=F.intensity,re=F.distance,q=F.shadow&&F.shadow.map?F.shadow.map.texture:null;if(F.isAmbientLight)h+=j.r*J,d+=j.g*J,m+=j.b*J;else if(F.isLightProbe){for(let W=0;W<9;W++)n.probe[W].addScaledVector(F.sh.coefficients[W],J);U++}else if(F.isDirectionalLight){const W=e.get(F);if(W.color.copy(F.color).multiplyScalar(F.intensity),F.castShadow){const ne=F.shadow,ie=t.get(F);ie.shadowIntensity=ne.intensity,ie.shadowBias=ne.bias,ie.shadowNormalBias=ne.normalBias,ie.shadowRadius=ne.radius,ie.shadowMapSize=ne.mapSize,n.directionalShadow[y]=ie,n.directionalShadowMap[y]=q,n.directionalShadowMatrix[y]=F.shadow.matrix,T++}n.directional[y]=W,y++}else if(F.isSpotLight){const W=e.get(F);W.position.setFromMatrixPosition(F.matrixWorld),W.color.copy(j).multiplyScalar(J),W.distance=re,W.coneCos=Math.cos(F.angle),W.penumbraCos=Math.cos(F.angle*(1-F.penumbra)),W.decay=F.decay,n.spot[_]=W;const ne=F.shadow;if(F.map&&(n.spotLightMap[O]=F.map,O++,ne.updateMatrices(F),F.castShadow&&N++),n.spotLightMatrix[_]=ne.matrix,F.castShadow){const ie=t.get(F);ie.shadowIntensity=ne.intensity,ie.shadowBias=ne.bias,ie.shadowNormalBias=ne.normalBias,ie.shadowRadius=ne.radius,ie.shadowMapSize=ne.mapSize,n.spotShadow[_]=ie,n.spotShadowMap[_]=q,R++}_++}else if(F.isRectAreaLight){const W=e.get(F);W.color.copy(j).multiplyScalar(J),W.halfWidth.set(F.width*.5,0,0),W.halfHeight.set(0,F.height*.5,0),n.rectArea[b]=W,b++}else if(F.isPointLight){const W=e.get(F);if(W.color.copy(F.color).multiplyScalar(F.intensity),W.distance=F.distance,W.decay=F.decay,F.castShadow){const ne=F.shadow,ie=t.get(F);ie.shadowIntensity=ne.intensity,ie.shadowBias=ne.bias,ie.shadowNormalBias=ne.normalBias,ie.shadowRadius=ne.radius,ie.shadowMapSize=ne.mapSize,ie.shadowCameraNear=ne.camera.near,ie.shadowCameraFar=ne.camera.far,n.pointShadow[x]=ie,n.pointShadowMap[x]=q,n.pointShadowMatrix[x]=F.shadow.matrix,w++}n.point[x]=W,x++}else if(F.isHemisphereLight){const W=e.get(F);W.skyColor.copy(F.color).multiplyScalar(J),W.groundColor.copy(F.groundColor).multiplyScalar(J),n.hemi[A]=W,A++}}b>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=zt.LTC_FLOAT_1,n.rectAreaLTC2=zt.LTC_FLOAT_2):(n.rectAreaLTC1=zt.LTC_HALF_1,n.rectAreaLTC2=zt.LTC_HALF_2)),n.ambient[0]=h,n.ambient[1]=d,n.ambient[2]=m;const P=n.hash;(P.directionalLength!==y||P.pointLength!==x||P.spotLength!==_||P.rectAreaLength!==b||P.hemiLength!==A||P.numDirectionalShadows!==T||P.numPointShadows!==w||P.numSpotShadows!==R||P.numSpotMaps!==O||P.numLightProbes!==U)&&(n.directional.length=y,n.spot.length=_,n.rectArea.length=b,n.point.length=x,n.hemi.length=A,n.directionalShadow.length=T,n.directionalShadowMap.length=T,n.pointShadow.length=w,n.pointShadowMap.length=w,n.spotShadow.length=R,n.spotShadowMap.length=R,n.directionalShadowMatrix.length=T,n.pointShadowMatrix.length=w,n.spotLightMatrix.length=R+O-N,n.spotLightMap.length=O,n.numSpotLightShadowsWithMaps=N,n.numLightProbes=U,P.directionalLength=y,P.pointLength=x,P.spotLength=_,P.rectAreaLength=b,P.hemiLength=A,P.numDirectionalShadows=T,P.numPointShadows=w,P.numSpotShadows=R,P.numSpotMaps=O,P.numLightProbes=U,n.version=$he++)}function l(c,h){let d=0,m=0,y=0,x=0,_=0;const b=h.matrixWorldInverse;for(let A=0,T=c.length;A<T;A++){const w=c[A];if(w.isDirectionalLight){const R=n.directional[d];R.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),R.direction.sub(s),R.direction.transformDirection(b),d++}else if(w.isSpotLight){const R=n.spot[y];R.position.setFromMatrixPosition(w.matrixWorld),R.position.applyMatrix4(b),R.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),R.direction.sub(s),R.direction.transformDirection(b),y++}else if(w.isRectAreaLight){const R=n.rectArea[x];R.position.setFromMatrixPosition(w.matrixWorld),R.position.applyMatrix4(b),a.identity(),r.copy(w.matrixWorld),r.premultiply(b),a.extractRotation(r),R.halfWidth.set(w.width*.5,0,0),R.halfHeight.set(0,w.height*.5,0),R.halfWidth.applyMatrix4(a),R.halfHeight.applyMatrix4(a),x++}else if(w.isPointLight){const R=n.point[m];R.position.setFromMatrixPosition(w.matrixWorld),R.position.applyMatrix4(b),m++}else if(w.isHemisphereLight){const R=n.hemi[_];R.direction.setFromMatrixPosition(w.matrixWorld),R.direction.transformDirection(b),_++}}}return{setup:o,setupView:l,state:n}}function b4(i){const e=new Zhe(i),t=[],n=[];function s(h){c.camera=h,t.length=0,n.length=0}function r(h){t.push(h)}function a(h){n.push(h)}function o(){e.setup(t)}function l(h){e.setupView(t,h)}const c={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:c,setupLights:o,setupLightsView:l,pushLight:r,pushShadow:a}}function efe(i){let e=new WeakMap;function t(s,r=0){const a=e.get(s);let o;return a===void 0?(o=new b4(i),e.set(s,[o])):r>=a.length?(o=new b4(i),a.push(o)):o=a[r],o}function n(){e=new WeakMap}return{get:t,dispose:n}}const tfe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,nfe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function ife(i,e,t){let n=new Xv;const s=new Qe,r=new Qe,a=new ai,o=new iO({depthPacking:s9}),l=new sO,c={},h=t.maxTextureSize,d={[qc]:wr,[wr]:qc,[Da]:Da},m=new js({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Qe},radius:{value:4}},vertexShader:tfe,fragmentShader:nfe}),y=m.clone();y.defines.HORIZONTAL_PASS=1;const x=new Tn;x.setAttribute("position",new ci(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new ms(x,m),b=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Jw;let A=this.type;this.render=function(N,U,P){if(b.enabled===!1||b.autoUpdate===!1&&b.needsUpdate===!1||N.length===0)return;const B=i.getRenderTarget(),L=i.getActiveCubeFace(),F=i.getActiveMipmapLevel(),j=i.state;j.setBlending(la),j.buffers.color.setClear(1,1,1,1),j.buffers.depth.setTest(!0),j.setScissorTest(!1);const J=A!==Lc&&this.type===Lc,re=A===Lc&&this.type!==Lc;for(let q=0,W=N.length;q<W;q++){const ne=N[q],ie=ne.shadow;if(ie===void 0){console.warn("THREE.WebGLShadowMap:",ne,"has no shadow.");continue}if(ie.autoUpdate===!1&&ie.needsUpdate===!1)continue;s.copy(ie.mapSize);const ue=ie.getFrameExtents();if(s.multiply(ue),r.copy(ie.mapSize),(s.x>h||s.y>h)&&(s.x>h&&(r.x=Math.floor(h/ue.x),s.x=r.x*ue.x,ie.mapSize.x=r.x),s.y>h&&(r.y=Math.floor(h/ue.y),s.y=r.y*ue.y,ie.mapSize.y=r.y)),ie.map===null||J===!0||re===!0){const ae=this.type!==Lc?{minFilter:Ws,magFilter:Ws}:{};ie.map!==null&&ie.map.dispose(),ie.map=new Os(s.x,s.y,ae),ie.map.texture.name=ne.name+".shadowMap",ie.camera.updateProjectionMatrix()}i.setRenderTarget(ie.map),i.clear();const z=ie.getViewportCount();for(let ae=0;ae<z;ae++){const ge=ie.getViewport(ae);a.set(r.x*ge.x,r.y*ge.y,r.x*ge.z,r.y*ge.w),j.viewport(a),ie.updateMatrices(ne,ae),n=ie.getFrustum(),R(U,P,ie.camera,ne,this.type)}ie.isPointLightShadow!==!0&&this.type===Lc&&T(ie,P),ie.needsUpdate=!1}A=this.type,b.needsUpdate=!1,i.setRenderTarget(B,L,F)};function T(N,U){const P=e.update(_);m.defines.VSM_SAMPLES!==N.blurSamples&&(m.defines.VSM_SAMPLES=N.blurSamples,y.defines.VSM_SAMPLES=N.blurSamples,m.needsUpdate=!0,y.needsUpdate=!0),N.mapPass===null&&(N.mapPass=new Os(s.x,s.y)),m.uniforms.shadow_pass.value=N.map.texture,m.uniforms.resolution.value=N.mapSize,m.uniforms.radius.value=N.radius,i.setRenderTarget(N.mapPass),i.clear(),i.renderBufferDirect(U,null,P,m,_,null),y.uniforms.shadow_pass.value=N.mapPass.texture,y.uniforms.resolution.value=N.mapSize,y.uniforms.radius.value=N.radius,i.setRenderTarget(N.map),i.clear(),i.renderBufferDirect(U,null,P,y,_,null)}function w(N,U,P,B){let L=null;const F=P.isPointLight===!0?N.customDistanceMaterial:N.customDepthMaterial;if(F!==void 0)L=F;else if(L=P.isPointLight===!0?l:o,i.localClippingEnabled&&U.clipShadows===!0&&Array.isArray(U.clippingPlanes)&&U.clippingPlanes.length!==0||U.displacementMap&&U.displacementScale!==0||U.alphaMap&&U.alphaTest>0||U.map&&U.alphaTest>0||U.alphaToCoverage===!0){const j=L.uuid,J=U.uuid;let re=c[j];re===void 0&&(re={},c[j]=re);let q=re[J];q===void 0&&(q=L.clone(),re[J]=q,U.addEventListener("dispose",O)),L=q}if(L.visible=U.visible,L.wireframe=U.wireframe,B===Lc?L.side=U.shadowSide!==null?U.shadowSide:U.side:L.side=U.shadowSide!==null?U.shadowSide:d[U.side],L.alphaMap=U.alphaMap,L.alphaTest=U.alphaToCoverage===!0?.5:U.alphaTest,L.map=U.map,L.clipShadows=U.clipShadows,L.clippingPlanes=U.clippingPlanes,L.clipIntersection=U.clipIntersection,L.displacementMap=U.displacementMap,L.displacementScale=U.displacementScale,L.displacementBias=U.displacementBias,L.wireframeLinewidth=U.wireframeLinewidth,L.linewidth=U.linewidth,P.isPointLight===!0&&L.isMeshDistanceMaterial===!0){const j=i.properties.get(L);j.light=P}return L}function R(N,U,P,B,L){if(N.visible===!1)return;if(N.layers.test(U.layers)&&(N.isMesh||N.isLine||N.isPoints)&&(N.castShadow||N.receiveShadow&&L===Lc)&&(!N.frustumCulled||n.intersectsObject(N))){N.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,N.matrixWorld);const J=e.update(N),re=N.material;if(Array.isArray(re)){const q=J.groups;for(let W=0,ne=q.length;W<ne;W++){const ie=q[W],ue=re[ie.materialIndex];if(ue&&ue.visible){const z=w(N,ue,B,L);N.onBeforeShadow(i,N,U,P,J,z,ie),i.renderBufferDirect(P,null,J,z,N,ie),N.onAfterShadow(i,N,U,P,J,z,ie)}}}else if(re.visible){const q=w(N,re,B,L);N.onBeforeShadow(i,N,U,P,J,q,null),i.renderBufferDirect(P,null,J,q,N,null),N.onAfterShadow(i,N,U,P,J,q,null)}}const j=N.children;for(let J=0,re=j.length;J<re;J++)R(j[J],U,P,B,L)}function O(N){N.target.removeEventListener("dispose",O);for(const P in c){const B=c[P],L=N.target.uuid;L in B&&(B[L].dispose(),delete B[L])}}}const sfe={[S3]:T3,[w3]:R3,[M3]:D3,[ug]:C3,[T3]:S3,[R3]:w3,[D3]:M3,[C3]:ug};function rfe(i,e){function t(){let xe=!1;const Oe=new ai;let Ge=null;const rt=new ai(0,0,0,0);return{setMask:function(It){Ge!==It&&!xe&&(i.colorMask(It,It,It,It),Ge=It)},setLocked:function(It){xe=It},setClear:function(It,Bt,$t,Pn,gi){gi===!0&&(It*=Pn,Bt*=Pn,$t*=Pn),Oe.set(It,Bt,$t,Pn),rt.equals(Oe)===!1&&(i.clearColor(It,Bt,$t,Pn),rt.copy(Oe))},reset:function(){xe=!1,Ge=null,rt.set(-1,0,0,0)}}}function n(){let xe=!1,Oe=!1,Ge=null,rt=null,It=null;return{setReversed:function(Bt){if(Oe!==Bt){const $t=e.get("EXT_clip_control");Bt?$t.clipControlEXT($t.LOWER_LEFT_EXT,$t.ZERO_TO_ONE_EXT):$t.clipControlEXT($t.LOWER_LEFT_EXT,$t.NEGATIVE_ONE_TO_ONE_EXT),Oe=Bt;const Pn=It;It=null,this.setClear(Pn)}},getReversed:function(){return Oe},setTest:function(Bt){Bt?Ze(i.DEPTH_TEST):tt(i.DEPTH_TEST)},setMask:function(Bt){Ge!==Bt&&!xe&&(i.depthMask(Bt),Ge=Bt)},setFunc:function(Bt){if(Oe&&(Bt=sfe[Bt]),rt!==Bt){switch(Bt){case S3:i.depthFunc(i.NEVER);break;case T3:i.depthFunc(i.ALWAYS);break;case w3:i.depthFunc(i.LESS);break;case ug:i.depthFunc(i.LEQUAL);break;case M3:i.depthFunc(i.EQUAL);break;case C3:i.depthFunc(i.GEQUAL);break;case R3:i.depthFunc(i.GREATER);break;case D3:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}rt=Bt}},setLocked:function(Bt){xe=Bt},setClear:function(Bt){It!==Bt&&(Oe&&(Bt=1-Bt),i.clearDepth(Bt),It=Bt)},reset:function(){xe=!1,Ge=null,rt=null,It=null,Oe=!1}}}function s(){let xe=!1,Oe=null,Ge=null,rt=null,It=null,Bt=null,$t=null,Pn=null,gi=null;return{setTest:function(_n){xe||(_n?Ze(i.STENCIL_TEST):tt(i.STENCIL_TEST))},setMask:function(_n){Oe!==_n&&!xe&&(i.stencilMask(_n),Oe=_n)},setFunc:function(_n,ts,cs){(Ge!==_n||rt!==ts||It!==cs)&&(i.stencilFunc(_n,ts,cs),Ge=_n,rt=ts,It=cs)},setOp:function(_n,ts,cs){(Bt!==_n||$t!==ts||Pn!==cs)&&(i.stencilOp(_n,ts,cs),Bt=_n,$t=ts,Pn=cs)},setLocked:function(_n){xe=_n},setClear:function(_n){gi!==_n&&(i.clearStencil(_n),gi=_n)},reset:function(){xe=!1,Oe=null,Ge=null,rt=null,It=null,Bt=null,$t=null,Pn=null,gi=null}}}const r=new t,a=new n,o=new s,l=new WeakMap,c=new WeakMap;let h={},d={},m=new WeakMap,y=[],x=null,_=!1,b=null,A=null,T=null,w=null,R=null,O=null,N=null,U=new Ut(0,0,0),P=0,B=!1,L=null,F=null,j=null,J=null,re=null;const q=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let W=!1,ne=0;const ie=i.getParameter(i.VERSION);ie.indexOf("WebGL")!==-1?(ne=parseFloat(/^WebGL (\d)/.exec(ie)[1]),W=ne>=1):ie.indexOf("OpenGL ES")!==-1&&(ne=parseFloat(/^OpenGL ES (\d)/.exec(ie)[1]),W=ne>=2);let ue=null,z={};const ae=i.getParameter(i.SCISSOR_BOX),ge=i.getParameter(i.VIEWPORT),Ee=new ai().fromArray(ae),le=new ai().fromArray(ge);function Ce(xe,Oe,Ge,rt){const It=new Uint8Array(4),Bt=i.createTexture();i.bindTexture(xe,Bt),i.texParameteri(xe,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(xe,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let $t=0;$t<Ge;$t++)xe===i.TEXTURE_3D||xe===i.TEXTURE_2D_ARRAY?i.texImage3D(Oe,0,i.RGBA,1,1,rt,0,i.RGBA,i.UNSIGNED_BYTE,It):i.texImage2D(Oe+$t,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,It);return Bt}const Me={};Me[i.TEXTURE_2D]=Ce(i.TEXTURE_2D,i.TEXTURE_2D,1),Me[i.TEXTURE_CUBE_MAP]=Ce(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),Me[i.TEXTURE_2D_ARRAY]=Ce(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),Me[i.TEXTURE_3D]=Ce(i.TEXTURE_3D,i.TEXTURE_3D,1,1),r.setClear(0,0,0,1),a.setClear(1),o.setClear(0),Ze(i.DEPTH_TEST),a.setFunc(ug),Ve(!1),st(VL),Ze(i.CULL_FACE),te(la);function Ze(xe){h[xe]!==!0&&(i.enable(xe),h[xe]=!0)}function tt(xe){h[xe]!==!1&&(i.disable(xe),h[xe]=!1)}function Mt(xe,Oe){return d[xe]!==Oe?(i.bindFramebuffer(xe,Oe),d[xe]=Oe,xe===i.DRAW_FRAMEBUFFER&&(d[i.FRAMEBUFFER]=Oe),xe===i.FRAMEBUFFER&&(d[i.DRAW_FRAMEBUFFER]=Oe),!0):!1}function bt(xe,Oe){let Ge=y,rt=!1;if(xe){Ge=m.get(Oe),Ge===void 0&&(Ge=[],m.set(Oe,Ge));const It=xe.textures;if(Ge.length!==It.length||Ge[0]!==i.COLOR_ATTACHMENT0){for(let Bt=0,$t=It.length;Bt<$t;Bt++)Ge[Bt]=i.COLOR_ATTACHMENT0+Bt;Ge.length=It.length,rt=!0}}else Ge[0]!==i.BACK&&(Ge[0]=i.BACK,rt=!0);rt&&i.drawBuffers(Ge)}function cn(xe){return x!==xe?(i.useProgram(xe),x=xe,!0):!1}const tn={[r0]:i.FUNC_ADD,[C6]:i.FUNC_SUBTRACT,[R6]:i.FUNC_REVERSE_SUBTRACT};tn[D6]=i.MIN,tn[L6]=i.MAX;const Ot={[I6]:i.ZERO,[B6]:i.ONE,[O6]:i.SRC_COLOR,[E3]:i.SRC_ALPHA,[H6]:i.SRC_ALPHA_SATURATE,[k6]:i.DST_COLOR,[N6]:i.DST_ALPHA,[P6]:i.ONE_MINUS_SRC_COLOR,[_3]:i.ONE_MINUS_SRC_ALPHA,[F6]:i.ONE_MINUS_DST_COLOR,[U6]:i.ONE_MINUS_DST_ALPHA,[G6]:i.CONSTANT_COLOR,[z6]:i.ONE_MINUS_CONSTANT_COLOR,[V6]:i.CONSTANT_ALPHA,[Y6]:i.ONE_MINUS_CONSTANT_ALPHA};function te(xe,Oe,Ge,rt,It,Bt,$t,Pn,gi,_n){if(xe===la){_===!0&&(tt(i.BLEND),_=!1);return}if(_===!1&&(Ze(i.BLEND),_=!0),xe!==M6){if(xe!==b||_n!==B){if((A!==r0||R!==r0)&&(i.blendEquation(i.FUNC_ADD),A=r0,R=r0),_n)switch(xe){case Jm:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case YL:i.blendFunc(i.ONE,i.ONE);break;case KL:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case WL:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",xe);break}else switch(xe){case Jm:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case YL:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case KL:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case WL:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",xe);break}T=null,w=null,O=null,N=null,U.set(0,0,0),P=0,b=xe,B=_n}return}It=It||Oe,Bt=Bt||Ge,$t=$t||rt,(Oe!==A||It!==R)&&(i.blendEquationSeparate(tn[Oe],tn[It]),A=Oe,R=It),(Ge!==T||rt!==w||Bt!==O||$t!==N)&&(i.blendFuncSeparate(Ot[Ge],Ot[rt],Ot[Bt],Ot[$t]),T=Ge,w=rt,O=Bt,N=$t),(Pn.equals(U)===!1||gi!==P)&&(i.blendColor(Pn.r,Pn.g,Pn.b,gi),U.copy(Pn),P=gi),b=xe,B=!1}function At(xe,Oe){xe.side===Da?tt(i.CULL_FACE):Ze(i.CULL_FACE);let Ge=xe.side===wr;Oe&&(Ge=!Ge),Ve(Ge),xe.blending===Jm&&xe.transparent===!1?te(la):te(xe.blending,xe.blendEquation,xe.blendSrc,xe.blendDst,xe.blendEquationAlpha,xe.blendSrcAlpha,xe.blendDstAlpha,xe.blendColor,xe.blendAlpha,xe.premultipliedAlpha),a.setFunc(xe.depthFunc),a.setTest(xe.depthTest),a.setMask(xe.depthWrite),r.setMask(xe.colorWrite);const rt=xe.stencilWrite;o.setTest(rt),rt&&(o.setMask(xe.stencilWriteMask),o.setFunc(xe.stencilFunc,xe.stencilRef,xe.stencilFuncMask),o.setOp(xe.stencilFail,xe.stencilZFail,xe.stencilZPass)),Pt(xe.polygonOffset,xe.polygonOffsetFactor,xe.polygonOffsetUnits),xe.alphaToCoverage===!0?Ze(i.SAMPLE_ALPHA_TO_COVERAGE):tt(i.SAMPLE_ALPHA_TO_COVERAGE)}function Ve(xe){L!==xe&&(xe?i.frontFace(i.CW):i.frontFace(i.CCW),L=xe)}function st(xe){xe!==S6?(Ze(i.CULL_FACE),xe!==F&&(xe===VL?i.cullFace(i.BACK):xe===T6?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):tt(i.CULL_FACE),F=xe}function $e(xe){xe!==j&&(W&&i.lineWidth(xe),j=xe)}function Pt(xe,Oe,Ge){xe?(Ze(i.POLYGON_OFFSET_FILL),(J!==Oe||re!==Ge)&&(i.polygonOffset(Oe,Ge),J=Oe,re=Ge)):tt(i.POLYGON_OFFSET_FILL)}function nt(xe){xe?Ze(i.SCISSOR_TEST):tt(i.SCISSOR_TEST)}function ee(xe){xe===void 0&&(xe=i.TEXTURE0+q-1),ue!==xe&&(i.activeTexture(xe),ue=xe)}function X(xe,Oe,Ge){Ge===void 0&&(ue===null?Ge=i.TEXTURE0+q-1:Ge=ue);let rt=z[Ge];rt===void 0&&(rt={type:void 0,texture:void 0},z[Ge]=rt),(rt.type!==xe||rt.texture!==Oe)&&(ue!==Ge&&(i.activeTexture(Ge),ue=Ge),i.bindTexture(xe,Oe||Me[xe]),rt.type=xe,rt.texture=Oe)}function we(){const xe=z[ue];xe!==void 0&&xe.type!==void 0&&(i.bindTexture(xe.type,null),xe.type=void 0,xe.texture=void 0)}function Fe(){try{i.compressedTexImage2D(...arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function ut(){try{i.compressedTexImage3D(...arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function We(){try{i.texSubImage2D(...arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function ot(){try{i.texSubImage3D(...arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function et(){try{i.compressedTexSubImage2D(...arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function pt(){try{i.compressedTexSubImage3D(...arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function vt(){try{i.texStorage2D(...arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function it(){try{i.texStorage3D(...arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function Ct(){try{i.texImage2D(...arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function Et(){try{i.texImage3D(...arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function Dt(xe){Ee.equals(xe)===!1&&(i.scissor(xe.x,xe.y,xe.z,xe.w),Ee.copy(xe))}function Nt(xe){le.equals(xe)===!1&&(i.viewport(xe.x,xe.y,xe.z,xe.w),le.copy(xe))}function ve(xe,Oe){let Ge=c.get(Oe);Ge===void 0&&(Ge=new WeakMap,c.set(Oe,Ge));let rt=Ge.get(xe);rt===void 0&&(rt=i.getUniformBlockIndex(Oe,xe.name),Ge.set(xe,rt))}function He(xe,Oe){const rt=c.get(Oe).get(xe);l.get(Oe)!==rt&&(i.uniformBlockBinding(Oe,rt,xe.__bindingPointIndex),l.set(Oe,rt))}function St(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),a.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),h={},ue=null,z={},d={},m=new WeakMap,y=[],x=null,_=!1,b=null,A=null,T=null,w=null,R=null,O=null,N=null,U=new Ut(0,0,0),P=0,B=!1,L=null,F=null,j=null,J=null,re=null,Ee.set(0,0,i.canvas.width,i.canvas.height),le.set(0,0,i.canvas.width,i.canvas.height),r.reset(),a.reset(),o.reset()}return{buffers:{color:r,depth:a,stencil:o},enable:Ze,disable:tt,bindFramebuffer:Mt,drawBuffers:bt,useProgram:cn,setBlending:te,setMaterial:At,setFlipSided:Ve,setCullFace:st,setLineWidth:$e,setPolygonOffset:Pt,setScissorTest:nt,activeTexture:ee,bindTexture:X,unbindTexture:we,compressedTexImage2D:Fe,compressedTexImage3D:ut,texImage2D:Ct,texImage3D:Et,updateUBOMapping:ve,uniformBlockBinding:He,texStorage2D:vt,texStorage3D:it,texSubImage2D:We,texSubImage3D:ot,compressedTexSubImage2D:et,compressedTexSubImage3D:pt,scissor:Dt,viewport:Nt,reset:St}}function afe(i,e,t,n,s,r,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new Qe,h=new WeakMap;let d;const m=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function x(ee,X){return y?new OffscreenCanvas(ee,X):eE("canvas")}function _(ee,X,we){let Fe=1;const ut=nt(ee);if((ut.width>we||ut.height>we)&&(Fe=we/Math.max(ut.width,ut.height)),Fe<1)if(typeof HTMLImageElement<"u"&&ee instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ee instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ee instanceof ImageBitmap||typeof VideoFrame<"u"&&ee instanceof VideoFrame){const We=Math.floor(Fe*ut.width),ot=Math.floor(Fe*ut.height);d===void 0&&(d=x(We,ot));const et=X?x(We,ot):d;return et.width=We,et.height=ot,et.getContext("2d").drawImage(ee,0,0,We,ot),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ut.width+"x"+ut.height+") to ("+We+"x"+ot+")."),et}else return"data"in ee&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ut.width+"x"+ut.height+")."),ee;return ee}function b(ee){return ee.generateMipmaps}function A(ee){i.generateMipmap(ee)}function T(ee){return ee.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:ee.isWebGL3DRenderTarget?i.TEXTURE_3D:ee.isWebGLArrayRenderTarget||ee.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function w(ee,X,we,Fe,ut=!1){if(ee!==null){if(i[ee]!==void 0)return i[ee];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ee+"'")}let We=X;if(X===i.RED&&(we===i.FLOAT&&(We=i.R32F),we===i.HALF_FLOAT&&(We=i.R16F),we===i.UNSIGNED_BYTE&&(We=i.R8)),X===i.RED_INTEGER&&(we===i.UNSIGNED_BYTE&&(We=i.R8UI),we===i.UNSIGNED_SHORT&&(We=i.R16UI),we===i.UNSIGNED_INT&&(We=i.R32UI),we===i.BYTE&&(We=i.R8I),we===i.SHORT&&(We=i.R16I),we===i.INT&&(We=i.R32I)),X===i.RG&&(we===i.FLOAT&&(We=i.RG32F),we===i.HALF_FLOAT&&(We=i.RG16F),we===i.UNSIGNED_BYTE&&(We=i.RG8)),X===i.RG_INTEGER&&(we===i.UNSIGNED_BYTE&&(We=i.RG8UI),we===i.UNSIGNED_SHORT&&(We=i.RG16UI),we===i.UNSIGNED_INT&&(We=i.RG32UI),we===i.BYTE&&(We=i.RG8I),we===i.SHORT&&(We=i.RG16I),we===i.INT&&(We=i.RG32I)),X===i.RGB_INTEGER&&(we===i.UNSIGNED_BYTE&&(We=i.RGB8UI),we===i.UNSIGNED_SHORT&&(We=i.RGB16UI),we===i.UNSIGNED_INT&&(We=i.RGB32UI),we===i.BYTE&&(We=i.RGB8I),we===i.SHORT&&(We=i.RGB16I),we===i.INT&&(We=i.RGB32I)),X===i.RGBA_INTEGER&&(we===i.UNSIGNED_BYTE&&(We=i.RGBA8UI),we===i.UNSIGNED_SHORT&&(We=i.RGBA16UI),we===i.UNSIGNED_INT&&(We=i.RGBA32UI),we===i.BYTE&&(We=i.RGBA8I),we===i.SHORT&&(We=i.RGBA16I),we===i.INT&&(We=i.RGBA32I)),X===i.RGB&&we===i.UNSIGNED_INT_5_9_9_9_REV&&(We=i.RGB9_E5),X===i.RGBA){const ot=ut?$A:ri.getTransfer(Fe);we===i.FLOAT&&(We=i.RGBA32F),we===i.HALF_FLOAT&&(We=i.RGBA16F),we===i.UNSIGNED_BYTE&&(We=ot===Hi?i.SRGB8_ALPHA8:i.RGBA8),we===i.UNSIGNED_SHORT_4_4_4_4&&(We=i.RGBA4),we===i.UNSIGNED_SHORT_5_5_5_1&&(We=i.RGB5_A1)}return(We===i.R16F||We===i.R32F||We===i.RG16F||We===i.RG32F||We===i.RGBA16F||We===i.RGBA32F)&&e.get("EXT_color_buffer_float"),We}function R(ee,X){let we;return ee?X===null||X===Qc||X===hg?we=i.DEPTH24_STENCIL8:X===ps?we=i.DEPTH32F_STENCIL8:X===Rv&&(we=i.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):X===null||X===Qc||X===hg?we=i.DEPTH_COMPONENT24:X===ps?we=i.DEPTH_COMPONENT32F:X===Rv&&(we=i.DEPTH_COMPONENT16),we}function O(ee,X){return b(ee)===!0||ee.isFramebufferTexture&&ee.minFilter!==Ws&&ee.minFilter!==ei?Math.log2(Math.max(X.width,X.height))+1:ee.mipmaps!==void 0&&ee.mipmaps.length>0?ee.mipmaps.length:ee.isCompressedTexture&&Array.isArray(ee.image)?X.mipmaps.length:1}function N(ee){const X=ee.target;X.removeEventListener("dispose",N),P(X),X.isVideoTexture&&h.delete(X)}function U(ee){const X=ee.target;X.removeEventListener("dispose",U),L(X)}function P(ee){const X=n.get(ee);if(X.__webglInit===void 0)return;const we=ee.source,Fe=m.get(we);if(Fe){const ut=Fe[X.__cacheKey];ut.usedTimes--,ut.usedTimes===0&&B(ee),Object.keys(Fe).length===0&&m.delete(we)}n.remove(ee)}function B(ee){const X=n.get(ee);i.deleteTexture(X.__webglTexture);const we=ee.source,Fe=m.get(we);delete Fe[X.__cacheKey],a.memory.textures--}function L(ee){const X=n.get(ee);if(ee.depthTexture&&(ee.depthTexture.dispose(),n.remove(ee.depthTexture)),ee.isWebGLCubeRenderTarget)for(let Fe=0;Fe<6;Fe++){if(Array.isArray(X.__webglFramebuffer[Fe]))for(let ut=0;ut<X.__webglFramebuffer[Fe].length;ut++)i.deleteFramebuffer(X.__webglFramebuffer[Fe][ut]);else i.deleteFramebuffer(X.__webglFramebuffer[Fe]);X.__webglDepthbuffer&&i.deleteRenderbuffer(X.__webglDepthbuffer[Fe])}else{if(Array.isArray(X.__webglFramebuffer))for(let Fe=0;Fe<X.__webglFramebuffer.length;Fe++)i.deleteFramebuffer(X.__webglFramebuffer[Fe]);else i.deleteFramebuffer(X.__webglFramebuffer);if(X.__webglDepthbuffer&&i.deleteRenderbuffer(X.__webglDepthbuffer),X.__webglMultisampledFramebuffer&&i.deleteFramebuffer(X.__webglMultisampledFramebuffer),X.__webglColorRenderbuffer)for(let Fe=0;Fe<X.__webglColorRenderbuffer.length;Fe++)X.__webglColorRenderbuffer[Fe]&&i.deleteRenderbuffer(X.__webglColorRenderbuffer[Fe]);X.__webglDepthRenderbuffer&&i.deleteRenderbuffer(X.__webglDepthRenderbuffer)}const we=ee.textures;for(let Fe=0,ut=we.length;Fe<ut;Fe++){const We=n.get(we[Fe]);We.__webglTexture&&(i.deleteTexture(We.__webglTexture),a.memory.textures--),n.remove(we[Fe])}n.remove(ee)}let F=0;function j(){F=0}function J(){const ee=F;return ee>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+ee+" texture units while this GPU supports only "+s.maxTextures),F+=1,ee}function re(ee){const X=[];return X.push(ee.wrapS),X.push(ee.wrapT),X.push(ee.wrapR||0),X.push(ee.magFilter),X.push(ee.minFilter),X.push(ee.anisotropy),X.push(ee.internalFormat),X.push(ee.format),X.push(ee.type),X.push(ee.generateMipmaps),X.push(ee.premultiplyAlpha),X.push(ee.flipY),X.push(ee.unpackAlignment),X.push(ee.colorSpace),X.join()}function q(ee,X){const we=n.get(ee);if(ee.isVideoTexture&&$e(ee),ee.isRenderTargetTexture===!1&&ee.version>0&&we.__version!==ee.version){const Fe=ee.image;if(Fe===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Fe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{le(we,ee,X);return}}t.bindTexture(i.TEXTURE_2D,we.__webglTexture,i.TEXTURE0+X)}function W(ee,X){const we=n.get(ee);if(ee.version>0&&we.__version!==ee.version){le(we,ee,X);return}t.bindTexture(i.TEXTURE_2D_ARRAY,we.__webglTexture,i.TEXTURE0+X)}function ne(ee,X){const we=n.get(ee);if(ee.version>0&&we.__version!==ee.version){le(we,ee,X);return}t.bindTexture(i.TEXTURE_3D,we.__webglTexture,i.TEXTURE0+X)}function ie(ee,X){const we=n.get(ee);if(ee.version>0&&we.__version!==ee.version){Ce(we,ee,X);return}t.bindTexture(i.TEXTURE_CUBE_MAP,we.__webglTexture,i.TEXTURE0+X)}const ue={[U0]:i.REPEAT,[sr]:i.CLAMP_TO_EDGE,[Cv]:i.MIRRORED_REPEAT},z={[Ws]:i.NEAREST,[Zw]:i.NEAREST_MIPMAP_NEAREST,[bm]:i.NEAREST_MIPMAP_LINEAR,[ei]:i.LINEAR,[Ty]:i.LINEAR_MIPMAP_NEAREST,[Nl]:i.LINEAR_MIPMAP_LINEAR},ae={[a9]:i.NEVER,[f9]:i.ALWAYS,[o9]:i.LESS,[HB]:i.LEQUAL,[l9]:i.EQUAL,[h9]:i.GEQUAL,[c9]:i.GREATER,[u9]:i.NOTEQUAL};function ge(ee,X){if(X.type===ps&&e.has("OES_texture_float_linear")===!1&&(X.magFilter===ei||X.magFilter===Ty||X.magFilter===bm||X.magFilter===Nl||X.minFilter===ei||X.minFilter===Ty||X.minFilter===bm||X.minFilter===Nl)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(ee,i.TEXTURE_WRAP_S,ue[X.wrapS]),i.texParameteri(ee,i.TEXTURE_WRAP_T,ue[X.wrapT]),(ee===i.TEXTURE_3D||ee===i.TEXTURE_2D_ARRAY)&&i.texParameteri(ee,i.TEXTURE_WRAP_R,ue[X.wrapR]),i.texParameteri(ee,i.TEXTURE_MAG_FILTER,z[X.magFilter]),i.texParameteri(ee,i.TEXTURE_MIN_FILTER,z[X.minFilter]),X.compareFunction&&(i.texParameteri(ee,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(ee,i.TEXTURE_COMPARE_FUNC,ae[X.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(X.magFilter===Ws||X.minFilter!==bm&&X.minFilter!==Nl||X.type===ps&&e.has("OES_texture_float_linear")===!1)return;if(X.anisotropy>1||n.get(X).__currentAnisotropy){const we=e.get("EXT_texture_filter_anisotropic");i.texParameterf(ee,we.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(X.anisotropy,s.getMaxAnisotropy())),n.get(X).__currentAnisotropy=X.anisotropy}}}function Ee(ee,X){let we=!1;ee.__webglInit===void 0&&(ee.__webglInit=!0,X.addEventListener("dispose",N));const Fe=X.source;let ut=m.get(Fe);ut===void 0&&(ut={},m.set(Fe,ut));const We=re(X);if(We!==ee.__cacheKey){ut[We]===void 0&&(ut[We]={texture:i.createTexture(),usedTimes:0},a.memory.textures++,we=!0),ut[We].usedTimes++;const ot=ut[ee.__cacheKey];ot!==void 0&&(ut[ee.__cacheKey].usedTimes--,ot.usedTimes===0&&B(X)),ee.__cacheKey=We,ee.__webglTexture=ut[We].texture}return we}function le(ee,X,we){let Fe=i.TEXTURE_2D;(X.isDataArrayTexture||X.isCompressedArrayTexture)&&(Fe=i.TEXTURE_2D_ARRAY),X.isData3DTexture&&(Fe=i.TEXTURE_3D);const ut=Ee(ee,X),We=X.source;t.bindTexture(Fe,ee.__webglTexture,i.TEXTURE0+we);const ot=n.get(We);if(We.version!==ot.__version||ut===!0){t.activeTexture(i.TEXTURE0+we);const et=ri.getPrimaries(ri.workingColorSpace),pt=X.colorSpace===Hc?null:ri.getPrimaries(X.colorSpace),vt=X.colorSpace===Hc||et===pt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,X.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,X.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,X.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,vt);let it=_(X.image,!1,s.maxTextureSize);it=Pt(X,it);const Ct=r.convert(X.format,X.colorSpace),Et=r.convert(X.type);let Dt=w(X.internalFormat,Ct,Et,X.colorSpace,X.isVideoTexture);ge(Fe,X);let Nt;const ve=X.mipmaps,He=X.isVideoTexture!==!0,St=ot.__version===void 0||ut===!0,xe=We.dataReady,Oe=O(X,it);if(X.isDepthTexture)Dt=R(X.format===fg,X.type),St&&(He?t.texStorage2D(i.TEXTURE_2D,1,Dt,it.width,it.height):t.texImage2D(i.TEXTURE_2D,0,Dt,it.width,it.height,0,Ct,Et,null));else if(X.isDataTexture)if(ve.length>0){He&&St&&t.texStorage2D(i.TEXTURE_2D,Oe,Dt,ve[0].width,ve[0].height);for(let Ge=0,rt=ve.length;Ge<rt;Ge++)Nt=ve[Ge],He?xe&&t.texSubImage2D(i.TEXTURE_2D,Ge,0,0,Nt.width,Nt.height,Ct,Et,Nt.data):t.texImage2D(i.TEXTURE_2D,Ge,Dt,Nt.width,Nt.height,0,Ct,Et,Nt.data);X.generateMipmaps=!1}else He?(St&&t.texStorage2D(i.TEXTURE_2D,Oe,Dt,it.width,it.height),xe&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,it.width,it.height,Ct,Et,it.data)):t.texImage2D(i.TEXTURE_2D,0,Dt,it.width,it.height,0,Ct,Et,it.data);else if(X.isCompressedTexture)if(X.isCompressedArrayTexture){He&&St&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Oe,Dt,ve[0].width,ve[0].height,it.depth);for(let Ge=0,rt=ve.length;Ge<rt;Ge++)if(Nt=ve[Ge],X.format!==rr)if(Ct!==null)if(He){if(xe)if(X.layerUpdates.size>0){const It=iI(Nt.width,Nt.height,X.format,X.type);for(const Bt of X.layerUpdates){const $t=Nt.data.subarray(Bt*It/Nt.data.BYTES_PER_ELEMENT,(Bt+1)*It/Nt.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Ge,0,0,Bt,Nt.width,Nt.height,1,Ct,$t)}X.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Ge,0,0,0,Nt.width,Nt.height,it.depth,Ct,Nt.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,Ge,Dt,Nt.width,Nt.height,it.depth,0,Nt.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else He?xe&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,Ge,0,0,0,Nt.width,Nt.height,it.depth,Ct,Et,Nt.data):t.texImage3D(i.TEXTURE_2D_ARRAY,Ge,Dt,Nt.width,Nt.height,it.depth,0,Ct,Et,Nt.data)}else{He&&St&&t.texStorage2D(i.TEXTURE_2D,Oe,Dt,ve[0].width,ve[0].height);for(let Ge=0,rt=ve.length;Ge<rt;Ge++)Nt=ve[Ge],X.format!==rr?Ct!==null?He?xe&&t.compressedTexSubImage2D(i.TEXTURE_2D,Ge,0,0,Nt.width,Nt.height,Ct,Nt.data):t.compressedTexImage2D(i.TEXTURE_2D,Ge,Dt,Nt.width,Nt.height,0,Nt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):He?xe&&t.texSubImage2D(i.TEXTURE_2D,Ge,0,0,Nt.width,Nt.height,Ct,Et,Nt.data):t.texImage2D(i.TEXTURE_2D,Ge,Dt,Nt.width,Nt.height,0,Ct,Et,Nt.data)}else if(X.isDataArrayTexture)if(He){if(St&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Oe,Dt,it.width,it.height,it.depth),xe)if(X.layerUpdates.size>0){const Ge=iI(it.width,it.height,X.format,X.type);for(const rt of X.layerUpdates){const It=it.data.subarray(rt*Ge/it.data.BYTES_PER_ELEMENT,(rt+1)*Ge/it.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,rt,it.width,it.height,1,Ct,Et,It)}X.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,it.width,it.height,it.depth,Ct,Et,it.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,Dt,it.width,it.height,it.depth,0,Ct,Et,it.data);else if(X.isData3DTexture)He?(St&&t.texStorage3D(i.TEXTURE_3D,Oe,Dt,it.width,it.height,it.depth),xe&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,it.width,it.height,it.depth,Ct,Et,it.data)):t.texImage3D(i.TEXTURE_3D,0,Dt,it.width,it.height,it.depth,0,Ct,Et,it.data);else if(X.isFramebufferTexture){if(St)if(He)t.texStorage2D(i.TEXTURE_2D,Oe,Dt,it.width,it.height);else{let Ge=it.width,rt=it.height;for(let It=0;It<Oe;It++)t.texImage2D(i.TEXTURE_2D,It,Dt,Ge,rt,0,Ct,Et,null),Ge>>=1,rt>>=1}}else if(ve.length>0){if(He&&St){const Ge=nt(ve[0]);t.texStorage2D(i.TEXTURE_2D,Oe,Dt,Ge.width,Ge.height)}for(let Ge=0,rt=ve.length;Ge<rt;Ge++)Nt=ve[Ge],He?xe&&t.texSubImage2D(i.TEXTURE_2D,Ge,0,0,Ct,Et,Nt):t.texImage2D(i.TEXTURE_2D,Ge,Dt,Ct,Et,Nt);X.generateMipmaps=!1}else if(He){if(St){const Ge=nt(it);t.texStorage2D(i.TEXTURE_2D,Oe,Dt,Ge.width,Ge.height)}xe&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,Ct,Et,it)}else t.texImage2D(i.TEXTURE_2D,0,Dt,Ct,Et,it);b(X)&&A(Fe),ot.__version=We.version,X.onUpdate&&X.onUpdate(X)}ee.__version=X.version}function Ce(ee,X,we){if(X.image.length!==6)return;const Fe=Ee(ee,X),ut=X.source;t.bindTexture(i.TEXTURE_CUBE_MAP,ee.__webglTexture,i.TEXTURE0+we);const We=n.get(ut);if(ut.version!==We.__version||Fe===!0){t.activeTexture(i.TEXTURE0+we);const ot=ri.getPrimaries(ri.workingColorSpace),et=X.colorSpace===Hc?null:ri.getPrimaries(X.colorSpace),pt=X.colorSpace===Hc||ot===et?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,X.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,X.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,X.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,pt);const vt=X.isCompressedTexture||X.image[0].isCompressedTexture,it=X.image[0]&&X.image[0].isDataTexture,Ct=[];for(let rt=0;rt<6;rt++)!vt&&!it?Ct[rt]=_(X.image[rt],!0,s.maxCubemapSize):Ct[rt]=it?X.image[rt].image:X.image[rt],Ct[rt]=Pt(X,Ct[rt]);const Et=Ct[0],Dt=r.convert(X.format,X.colorSpace),Nt=r.convert(X.type),ve=w(X.internalFormat,Dt,Nt,X.colorSpace),He=X.isVideoTexture!==!0,St=We.__version===void 0||Fe===!0,xe=ut.dataReady;let Oe=O(X,Et);ge(i.TEXTURE_CUBE_MAP,X);let Ge;if(vt){He&&St&&t.texStorage2D(i.TEXTURE_CUBE_MAP,Oe,ve,Et.width,Et.height);for(let rt=0;rt<6;rt++){Ge=Ct[rt].mipmaps;for(let It=0;It<Ge.length;It++){const Bt=Ge[It];X.format!==rr?Dt!==null?He?xe&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+rt,It,0,0,Bt.width,Bt.height,Dt,Bt.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+rt,It,ve,Bt.width,Bt.height,0,Bt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):He?xe&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+rt,It,0,0,Bt.width,Bt.height,Dt,Nt,Bt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+rt,It,ve,Bt.width,Bt.height,0,Dt,Nt,Bt.data)}}}else{if(Ge=X.mipmaps,He&&St){Ge.length>0&&Oe++;const rt=nt(Ct[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,Oe,ve,rt.width,rt.height)}for(let rt=0;rt<6;rt++)if(it){He?xe&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+rt,0,0,0,Ct[rt].width,Ct[rt].height,Dt,Nt,Ct[rt].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+rt,0,ve,Ct[rt].width,Ct[rt].height,0,Dt,Nt,Ct[rt].data);for(let It=0;It<Ge.length;It++){const $t=Ge[It].image[rt].image;He?xe&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+rt,It+1,0,0,$t.width,$t.height,Dt,Nt,$t.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+rt,It+1,ve,$t.width,$t.height,0,Dt,Nt,$t.data)}}else{He?xe&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+rt,0,0,0,Dt,Nt,Ct[rt]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+rt,0,ve,Dt,Nt,Ct[rt]);for(let It=0;It<Ge.length;It++){const Bt=Ge[It];He?xe&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+rt,It+1,0,0,Dt,Nt,Bt.image[rt]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+rt,It+1,ve,Dt,Nt,Bt.image[rt])}}}b(X)&&A(i.TEXTURE_CUBE_MAP),We.__version=ut.version,X.onUpdate&&X.onUpdate(X)}ee.__version=X.version}function Me(ee,X,we,Fe,ut,We){const ot=r.convert(we.format,we.colorSpace),et=r.convert(we.type),pt=w(we.internalFormat,ot,et,we.colorSpace),vt=n.get(X),it=n.get(we);if(it.__renderTarget=X,!vt.__hasExternalTextures){const Ct=Math.max(1,X.width>>We),Et=Math.max(1,X.height>>We);ut===i.TEXTURE_3D||ut===i.TEXTURE_2D_ARRAY?t.texImage3D(ut,We,pt,Ct,Et,X.depth,0,ot,et,null):t.texImage2D(ut,We,pt,Ct,Et,0,ot,et,null)}t.bindFramebuffer(i.FRAMEBUFFER,ee),st(X)?o.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Fe,ut,it.__webglTexture,0,Ve(X)):(ut===i.TEXTURE_2D||ut>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&ut<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,Fe,ut,it.__webglTexture,We),t.bindFramebuffer(i.FRAMEBUFFER,null)}function Ze(ee,X,we){if(i.bindRenderbuffer(i.RENDERBUFFER,ee),X.depthBuffer){const Fe=X.depthTexture,ut=Fe&&Fe.isDepthTexture?Fe.type:null,We=R(X.stencilBuffer,ut),ot=X.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,et=Ve(X);st(X)?o.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,et,We,X.width,X.height):we?i.renderbufferStorageMultisample(i.RENDERBUFFER,et,We,X.width,X.height):i.renderbufferStorage(i.RENDERBUFFER,We,X.width,X.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,ot,i.RENDERBUFFER,ee)}else{const Fe=X.textures;for(let ut=0;ut<Fe.length;ut++){const We=Fe[ut],ot=r.convert(We.format,We.colorSpace),et=r.convert(We.type),pt=w(We.internalFormat,ot,et,We.colorSpace),vt=Ve(X);we&&st(X)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,vt,pt,X.width,X.height):st(X)?o.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,vt,pt,X.width,X.height):i.renderbufferStorage(i.RENDERBUFFER,pt,X.width,X.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function tt(ee,X){if(X&&X.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,ee),!(X.depthTexture&&X.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Fe=n.get(X.depthTexture);Fe.__renderTarget=X,(!Fe.__webglTexture||X.depthTexture.image.width!==X.width||X.depthTexture.image.height!==X.height)&&(X.depthTexture.image.width=X.width,X.depthTexture.image.height=X.height,X.depthTexture.needsUpdate=!0),q(X.depthTexture,0);const ut=Fe.__webglTexture,We=Ve(X);if(X.depthTexture.format===Dv)st(X)?o.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,ut,0,We):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,ut,0);else if(X.depthTexture.format===fg)st(X)?o.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,ut,0,We):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,ut,0);else throw new Error("Unknown depthTexture format")}function Mt(ee){const X=n.get(ee),we=ee.isWebGLCubeRenderTarget===!0;if(X.__boundDepthTexture!==ee.depthTexture){const Fe=ee.depthTexture;if(X.__depthDisposeCallback&&X.__depthDisposeCallback(),Fe){const ut=()=>{delete X.__boundDepthTexture,delete X.__depthDisposeCallback,Fe.removeEventListener("dispose",ut)};Fe.addEventListener("dispose",ut),X.__depthDisposeCallback=ut}X.__boundDepthTexture=Fe}if(ee.depthTexture&&!X.__autoAllocateDepthBuffer){if(we)throw new Error("target.depthTexture not supported in Cube render targets");const Fe=ee.texture.mipmaps;Fe&&Fe.length>0?tt(X.__webglFramebuffer[0],ee):tt(X.__webglFramebuffer,ee)}else if(we){X.__webglDepthbuffer=[];for(let Fe=0;Fe<6;Fe++)if(t.bindFramebuffer(i.FRAMEBUFFER,X.__webglFramebuffer[Fe]),X.__webglDepthbuffer[Fe]===void 0)X.__webglDepthbuffer[Fe]=i.createRenderbuffer(),Ze(X.__webglDepthbuffer[Fe],ee,!1);else{const ut=ee.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,We=X.__webglDepthbuffer[Fe];i.bindRenderbuffer(i.RENDERBUFFER,We),i.framebufferRenderbuffer(i.FRAMEBUFFER,ut,i.RENDERBUFFER,We)}}else{const Fe=ee.texture.mipmaps;if(Fe&&Fe.length>0?t.bindFramebuffer(i.FRAMEBUFFER,X.__webglFramebuffer[0]):t.bindFramebuffer(i.FRAMEBUFFER,X.__webglFramebuffer),X.__webglDepthbuffer===void 0)X.__webglDepthbuffer=i.createRenderbuffer(),Ze(X.__webglDepthbuffer,ee,!1);else{const ut=ee.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,We=X.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,We),i.framebufferRenderbuffer(i.FRAMEBUFFER,ut,i.RENDERBUFFER,We)}}t.bindFramebuffer(i.FRAMEBUFFER,null)}function bt(ee,X,we){const Fe=n.get(ee);X!==void 0&&Me(Fe.__webglFramebuffer,ee,ee.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),we!==void 0&&Mt(ee)}function cn(ee){const X=ee.texture,we=n.get(ee),Fe=n.get(X);ee.addEventListener("dispose",U);const ut=ee.textures,We=ee.isWebGLCubeRenderTarget===!0,ot=ut.length>1;if(ot||(Fe.__webglTexture===void 0&&(Fe.__webglTexture=i.createTexture()),Fe.__version=X.version,a.memory.textures++),We){we.__webglFramebuffer=[];for(let et=0;et<6;et++)if(X.mipmaps&&X.mipmaps.length>0){we.__webglFramebuffer[et]=[];for(let pt=0;pt<X.mipmaps.length;pt++)we.__webglFramebuffer[et][pt]=i.createFramebuffer()}else we.__webglFramebuffer[et]=i.createFramebuffer()}else{if(X.mipmaps&&X.mipmaps.length>0){we.__webglFramebuffer=[];for(let et=0;et<X.mipmaps.length;et++)we.__webglFramebuffer[et]=i.createFramebuffer()}else we.__webglFramebuffer=i.createFramebuffer();if(ot)for(let et=0,pt=ut.length;et<pt;et++){const vt=n.get(ut[et]);vt.__webglTexture===void 0&&(vt.__webglTexture=i.createTexture(),a.memory.textures++)}if(ee.samples>0&&st(ee)===!1){we.__webglMultisampledFramebuffer=i.createFramebuffer(),we.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,we.__webglMultisampledFramebuffer);for(let et=0;et<ut.length;et++){const pt=ut[et];we.__webglColorRenderbuffer[et]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,we.__webglColorRenderbuffer[et]);const vt=r.convert(pt.format,pt.colorSpace),it=r.convert(pt.type),Ct=w(pt.internalFormat,vt,it,pt.colorSpace,ee.isXRRenderTarget===!0),Et=Ve(ee);i.renderbufferStorageMultisample(i.RENDERBUFFER,Et,Ct,ee.width,ee.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+et,i.RENDERBUFFER,we.__webglColorRenderbuffer[et])}i.bindRenderbuffer(i.RENDERBUFFER,null),ee.depthBuffer&&(we.__webglDepthRenderbuffer=i.createRenderbuffer(),Ze(we.__webglDepthRenderbuffer,ee,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(We){t.bindTexture(i.TEXTURE_CUBE_MAP,Fe.__webglTexture),ge(i.TEXTURE_CUBE_MAP,X);for(let et=0;et<6;et++)if(X.mipmaps&&X.mipmaps.length>0)for(let pt=0;pt<X.mipmaps.length;pt++)Me(we.__webglFramebuffer[et][pt],ee,X,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+et,pt);else Me(we.__webglFramebuffer[et],ee,X,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+et,0);b(X)&&A(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ot){for(let et=0,pt=ut.length;et<pt;et++){const vt=ut[et],it=n.get(vt);t.bindTexture(i.TEXTURE_2D,it.__webglTexture),ge(i.TEXTURE_2D,vt),Me(we.__webglFramebuffer,ee,vt,i.COLOR_ATTACHMENT0+et,i.TEXTURE_2D,0),b(vt)&&A(i.TEXTURE_2D)}t.unbindTexture()}else{let et=i.TEXTURE_2D;if((ee.isWebGL3DRenderTarget||ee.isWebGLArrayRenderTarget)&&(et=ee.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(et,Fe.__webglTexture),ge(et,X),X.mipmaps&&X.mipmaps.length>0)for(let pt=0;pt<X.mipmaps.length;pt++)Me(we.__webglFramebuffer[pt],ee,X,i.COLOR_ATTACHMENT0,et,pt);else Me(we.__webglFramebuffer,ee,X,i.COLOR_ATTACHMENT0,et,0);b(X)&&A(et),t.unbindTexture()}ee.depthBuffer&&Mt(ee)}function tn(ee){const X=ee.textures;for(let we=0,Fe=X.length;we<Fe;we++){const ut=X[we];if(b(ut)){const We=T(ee),ot=n.get(ut).__webglTexture;t.bindTexture(We,ot),A(We),t.unbindTexture()}}}const Ot=[],te=[];function At(ee){if(ee.samples>0){if(st(ee)===!1){const X=ee.textures,we=ee.width,Fe=ee.height;let ut=i.COLOR_BUFFER_BIT;const We=ee.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ot=n.get(ee),et=X.length>1;if(et)for(let vt=0;vt<X.length;vt++)t.bindFramebuffer(i.FRAMEBUFFER,ot.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+vt,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,ot.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+vt,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,ot.__webglMultisampledFramebuffer);const pt=ee.texture.mipmaps;pt&&pt.length>0?t.bindFramebuffer(i.DRAW_FRAMEBUFFER,ot.__webglFramebuffer[0]):t.bindFramebuffer(i.DRAW_FRAMEBUFFER,ot.__webglFramebuffer);for(let vt=0;vt<X.length;vt++){if(ee.resolveDepthBuffer&&(ee.depthBuffer&&(ut|=i.DEPTH_BUFFER_BIT),ee.stencilBuffer&&ee.resolveStencilBuffer&&(ut|=i.STENCIL_BUFFER_BIT)),et){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,ot.__webglColorRenderbuffer[vt]);const it=n.get(X[vt]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,it,0)}i.blitFramebuffer(0,0,we,Fe,0,0,we,Fe,ut,i.NEAREST),l===!0&&(Ot.length=0,te.length=0,Ot.push(i.COLOR_ATTACHMENT0+vt),ee.depthBuffer&&ee.resolveDepthBuffer===!1&&(Ot.push(We),te.push(We),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,te)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,Ot))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),et)for(let vt=0;vt<X.length;vt++){t.bindFramebuffer(i.FRAMEBUFFER,ot.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+vt,i.RENDERBUFFER,ot.__webglColorRenderbuffer[vt]);const it=n.get(X[vt]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,ot.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+vt,i.TEXTURE_2D,it,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,ot.__webglMultisampledFramebuffer)}else if(ee.depthBuffer&&ee.resolveDepthBuffer===!1&&l){const X=ee.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[X])}}}function Ve(ee){return Math.min(s.maxSamples,ee.samples)}function st(ee){const X=n.get(ee);return ee.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&X.__useRenderToTexture!==!1}function $e(ee){const X=a.render.frame;h.get(ee)!==X&&(h.set(ee,X),ee.update())}function Pt(ee,X){const we=ee.colorSpace,Fe=ee.format,ut=ee.type;return ee.isCompressedTexture===!0||ee.isVideoTexture===!0||we!==nl&&we!==Hc&&(ri.getTransfer(we)===Hi?(Fe!==rr||ut!==Xs)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",we)),X}function nt(ee){return typeof HTMLImageElement<"u"&&ee instanceof HTMLImageElement?(c.width=ee.naturalWidth||ee.width,c.height=ee.naturalHeight||ee.height):typeof VideoFrame<"u"&&ee instanceof VideoFrame?(c.width=ee.displayWidth,c.height=ee.displayHeight):(c.width=ee.width,c.height=ee.height),c}this.allocateTextureUnit=J,this.resetTextureUnits=j,this.setTexture2D=q,this.setTexture2DArray=W,this.setTexture3D=ne,this.setTextureCube=ie,this.rebindTextures=bt,this.setupRenderTarget=cn,this.updateRenderTargetMipmap=tn,this.updateMultisampleRenderTarget=At,this.setupDepthRenderbuffer=Mt,this.setupFrameBufferTexture=Me,this.useMultisampledRTT=st}function gV(i,e){function t(n,s=Hc){let r;const a=ri.getTransfer(s);if(n===Xs)return i.UNSIGNED_BYTE;if(n===nM)return i.UNSIGNED_SHORT_4_4_4_4;if(n===iM)return i.UNSIGNED_SHORT_5_5_5_1;if(n===BB)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===eM)return i.BYTE;if(n===tM)return i.SHORT;if(n===Rv)return i.UNSIGNED_SHORT;if(n===kE)return i.INT;if(n===Qc)return i.UNSIGNED_INT;if(n===ps)return i.FLOAT;if(n===yr)return i.HALF_FLOAT;if(n===OB)return i.ALPHA;if(n===PB)return i.RGB;if(n===rr)return i.RGBA;if(n===Dv)return i.DEPTH_COMPONENT;if(n===fg)return i.DEPTH_STENCIL;if(n===FE)return i.RED;if(n===HE)return i.RED_INTEGER;if(n===NB)return i.RG;if(n===sM)return i.RG_INTEGER;if(n===rM)return i.RGBA_INTEGER;if(n===hA||n===fA||n===dA||n===pA)if(a===Hi)if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),r!==null){if(n===hA)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===fA)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===dA)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===pA)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(r=e.get("WEBGL_compressed_texture_s3tc"),r!==null){if(n===hA)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===fA)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===dA)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===pA)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===L3||n===I3||n===B3||n===O3)if(r=e.get("WEBGL_compressed_texture_pvrtc"),r!==null){if(n===L3)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===I3)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===B3)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===O3)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===P3||n===N3||n===U3)if(r=e.get("WEBGL_compressed_texture_etc"),r!==null){if(n===P3||n===N3)return a===Hi?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===U3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===k3||n===F3||n===H3||n===G3||n===z3||n===V3||n===Y3||n===K3||n===W3||n===X3||n===j3||n===q3||n===Q3||n===$3)if(r=e.get("WEBGL_compressed_texture_astc"),r!==null){if(n===k3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===F3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===H3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===G3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===z3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===V3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Y3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===K3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===W3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===X3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===j3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===q3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Q3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===$3)return a===Hi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===mA||n===J3||n===Z3)if(r=e.get("EXT_texture_compression_bptc"),r!==null){if(n===mA)return a===Hi?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===J3)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Z3)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===UB||n===ew||n===tw||n===nw)if(r=e.get("EXT_texture_compression_rgtc"),r!==null){if(n===mA)return r.COMPRESSED_RED_RGTC1_EXT;if(n===ew)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===tw)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===nw)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===hg?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}const ofe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,lfe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class cfe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){const s=new wi,r=e.properties.get(s);r.__webglTexture=t.texture,(t.depthNear!==n.depthNear||t.depthFar!==n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=s}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new js({vertexShader:ofe,fragmentShader:lfe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new ms(new W0(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class ufe extends sl{constructor(e,t){super();const n=this;let s=null,r=1,a=null,o="local-floor",l=1,c=null,h=null,d=null,m=null,y=null,x=null;const _=new cfe,b=t.getContextAttributes();let A=null,T=null;const w=[],R=[],O=new Qe;let N=null;const U=new Ds;U.viewport=new ai;const P=new Ds;P.viewport=new ai;const B=[U,P],L=new aV;let F=null,j=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(le){let Ce=w[le];return Ce===void 0&&(Ce=new zT,w[le]=Ce),Ce.getTargetRaySpace()},this.getControllerGrip=function(le){let Ce=w[le];return Ce===void 0&&(Ce=new zT,w[le]=Ce),Ce.getGripSpace()},this.getHand=function(le){let Ce=w[le];return Ce===void 0&&(Ce=new zT,w[le]=Ce),Ce.getHandSpace()};function J(le){const Ce=R.indexOf(le.inputSource);if(Ce===-1)return;const Me=w[Ce];Me!==void 0&&(Me.update(le.inputSource,le.frame,c||a),Me.dispatchEvent({type:le.type,data:le.inputSource}))}function re(){s.removeEventListener("select",J),s.removeEventListener("selectstart",J),s.removeEventListener("selectend",J),s.removeEventListener("squeeze",J),s.removeEventListener("squeezestart",J),s.removeEventListener("squeezeend",J),s.removeEventListener("end",re),s.removeEventListener("inputsourceschange",q);for(let le=0;le<w.length;le++){const Ce=R[le];Ce!==null&&(R[le]=null,w[le].disconnect(Ce))}F=null,j=null,_.reset(),e.setRenderTarget(A),y=null,m=null,d=null,s=null,T=null,Ee.stop(),n.isPresenting=!1,e.setPixelRatio(N),e.setSize(O.width,O.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(le){r=le,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(le){o=le,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||a},this.setReferenceSpace=function(le){c=le},this.getBaseLayer=function(){return m!==null?m:y},this.getBinding=function(){return d},this.getFrame=function(){return x},this.getSession=function(){return s},this.setSession=async function(le){if(s=le,s!==null){if(A=e.getRenderTarget(),s.addEventListener("select",J),s.addEventListener("selectstart",J),s.addEventListener("selectend",J),s.addEventListener("squeeze",J),s.addEventListener("squeezestart",J),s.addEventListener("squeezeend",J),s.addEventListener("end",re),s.addEventListener("inputsourceschange",q),b.xrCompatible!==!0&&await t.makeXRCompatible(),N=e.getPixelRatio(),e.getSize(O),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Me=null,Ze=null,tt=null;b.depth&&(tt=b.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Me=b.stencil?fg:Dv,Ze=b.stencil?hg:Qc);const Mt={colorFormat:t.RGBA8,depthFormat:tt,scaleFactor:r};d=new XRWebGLBinding(s,t),m=d.createProjectionLayer(Mt),s.updateRenderState({layers:[m]}),e.setPixelRatio(1),e.setSize(m.textureWidth,m.textureHeight,!1),T=new Os(m.textureWidth,m.textureHeight,{format:rr,type:Xs,depthTexture:new jv(m.textureWidth,m.textureHeight,Ze,void 0,void 0,void 0,void 0,void 0,void 0,Me),stencilBuffer:b.stencil,colorSpace:e.outputColorSpace,samples:b.antialias?4:0,resolveDepthBuffer:m.ignoreDepthValues===!1,resolveStencilBuffer:m.ignoreDepthValues===!1})}else{const Me={antialias:b.antialias,alpha:!0,depth:b.depth,stencil:b.stencil,framebufferScaleFactor:r};y=new XRWebGLLayer(s,t,Me),s.updateRenderState({baseLayer:y}),e.setPixelRatio(1),e.setSize(y.framebufferWidth,y.framebufferHeight,!1),T=new Os(y.framebufferWidth,y.framebufferHeight,{format:rr,type:Xs,colorSpace:e.outputColorSpace,stencilBuffer:b.stencil,resolveDepthBuffer:y.ignoreDepthValues===!1,resolveStencilBuffer:y.ignoreDepthValues===!1})}T.isXRRenderTarget=!0,this.setFoveation(l),c=null,a=await s.requestReferenceSpace(o),Ee.setContext(s),Ee.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return _.getDepthTexture()};function q(le){for(let Ce=0;Ce<le.removed.length;Ce++){const Me=le.removed[Ce],Ze=R.indexOf(Me);Ze>=0&&(R[Ze]=null,w[Ze].disconnect(Me))}for(let Ce=0;Ce<le.added.length;Ce++){const Me=le.added[Ce];let Ze=R.indexOf(Me);if(Ze===-1){for(let Mt=0;Mt<w.length;Mt++)if(Mt>=R.length){R.push(Me),Ze=Mt;break}else if(R[Mt]===null){R[Mt]=Me,Ze=Mt;break}if(Ze===-1)break}const tt=w[Ze];tt&&tt.connect(Me)}}const W=new se,ne=new se;function ie(le,Ce,Me){W.setFromMatrixPosition(Ce.matrixWorld),ne.setFromMatrixPosition(Me.matrixWorld);const Ze=W.distanceTo(ne),tt=Ce.projectionMatrix.elements,Mt=Me.projectionMatrix.elements,bt=tt[14]/(tt[10]-1),cn=tt[14]/(tt[10]+1),tn=(tt[9]+1)/tt[5],Ot=(tt[9]-1)/tt[5],te=(tt[8]-1)/tt[0],At=(Mt[8]+1)/Mt[0],Ve=bt*te,st=bt*At,$e=Ze/(-te+At),Pt=$e*-te;if(Ce.matrixWorld.decompose(le.position,le.quaternion,le.scale),le.translateX(Pt),le.translateZ($e),le.matrixWorld.compose(le.position,le.quaternion,le.scale),le.matrixWorldInverse.copy(le.matrixWorld).invert(),tt[10]===-1)le.projectionMatrix.copy(Ce.projectionMatrix),le.projectionMatrixInverse.copy(Ce.projectionMatrixInverse);else{const nt=bt+$e,ee=cn+$e,X=Ve-Pt,we=st+(Ze-Pt),Fe=tn*cn/ee*nt,ut=Ot*cn/ee*nt;le.projectionMatrix.makePerspective(X,we,Fe,ut,nt,ee),le.projectionMatrixInverse.copy(le.projectionMatrix).invert()}}function ue(le,Ce){Ce===null?le.matrixWorld.copy(le.matrix):le.matrixWorld.multiplyMatrices(Ce.matrixWorld,le.matrix),le.matrixWorldInverse.copy(le.matrixWorld).invert()}this.updateCamera=function(le){if(s===null)return;let Ce=le.near,Me=le.far;_.texture!==null&&(_.depthNear>0&&(Ce=_.depthNear),_.depthFar>0&&(Me=_.depthFar)),L.near=P.near=U.near=Ce,L.far=P.far=U.far=Me,(F!==L.near||j!==L.far)&&(s.updateRenderState({depthNear:L.near,depthFar:L.far}),F=L.near,j=L.far),U.layers.mask=le.layers.mask|2,P.layers.mask=le.layers.mask|4,L.layers.mask=U.layers.mask|P.layers.mask;const Ze=le.parent,tt=L.cameras;ue(L,Ze);for(let Mt=0;Mt<tt.length;Mt++)ue(tt[Mt],Ze);tt.length===2?ie(L,U,P):L.projectionMatrix.copy(U.projectionMatrix),z(le,L,Ze)};function z(le,Ce,Me){Me===null?le.matrix.copy(Ce.matrixWorld):(le.matrix.copy(Me.matrixWorld),le.matrix.invert(),le.matrix.multiply(Ce.matrixWorld)),le.matrix.decompose(le.position,le.quaternion,le.scale),le.updateMatrixWorld(!0),le.projectionMatrix.copy(Ce.projectionMatrix),le.projectionMatrixInverse.copy(Ce.projectionMatrixInverse),le.isPerspectiveCamera&&(le.fov=Bv*2*Math.atan(1/le.projectionMatrix.elements[5]),le.zoom=1)}this.getCamera=function(){return L},this.getFoveation=function(){if(!(m===null&&y===null))return l},this.setFoveation=function(le){l=le,m!==null&&(m.fixedFoveation=le),y!==null&&y.fixedFoveation!==void 0&&(y.fixedFoveation=le)},this.hasDepthSensing=function(){return _.texture!==null},this.getDepthSensingMesh=function(){return _.getMesh(L)};let ae=null;function ge(le,Ce){if(h=Ce.getViewerPose(c||a),x=Ce,h!==null){const Me=h.views;y!==null&&(e.setRenderTargetFramebuffer(T,y.framebuffer),e.setRenderTarget(T));let Ze=!1;Me.length!==L.cameras.length&&(L.cameras.length=0,Ze=!0);for(let bt=0;bt<Me.length;bt++){const cn=Me[bt];let tn=null;if(y!==null)tn=y.getViewport(cn);else{const te=d.getViewSubImage(m,cn);tn=te.viewport,bt===0&&(e.setRenderTargetTextures(T,te.colorTexture,te.depthStencilTexture),e.setRenderTarget(T))}let Ot=B[bt];Ot===void 0&&(Ot=new Ds,Ot.layers.enable(bt),Ot.viewport=new ai,B[bt]=Ot),Ot.matrix.fromArray(cn.transform.matrix),Ot.matrix.decompose(Ot.position,Ot.quaternion,Ot.scale),Ot.projectionMatrix.fromArray(cn.projectionMatrix),Ot.projectionMatrixInverse.copy(Ot.projectionMatrix).invert(),Ot.viewport.set(tn.x,tn.y,tn.width,tn.height),bt===0&&(L.matrix.copy(Ot.matrix),L.matrix.decompose(L.position,L.quaternion,L.scale)),Ze===!0&&L.cameras.push(Ot)}const tt=s.enabledFeatures;if(tt&&tt.includes("depth-sensing")&&s.depthUsage=="gpu-optimized"&&d){const bt=d.getDepthInformation(Me[0]);bt&&bt.isValid&&bt.texture&&_.init(e,bt,s.renderState)}}for(let Me=0;Me<w.length;Me++){const Ze=R[Me],tt=w[Me];Ze!==null&&tt!==void 0&&tt.update(Ze,Ce,c||a)}ae&&ae(le,Ce),Ce.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Ce}),x=null}const Ee=new hV;Ee.setAnimationLoop(ge),this.setAnimationLoop=function(le){ae=le},this.dispose=function(){}}}const Qp=new il,hfe=new hn;function ffe(i,e){function t(b,A){b.matrixAutoUpdate===!0&&b.updateMatrix(),A.value.copy(b.matrix)}function n(b,A){A.color.getRGB(b.fogColor.value,v9(i)),A.isFog?(b.fogNear.value=A.near,b.fogFar.value=A.far):A.isFogExp2&&(b.fogDensity.value=A.density)}function s(b,A,T,w,R){A.isMeshBasicMaterial||A.isMeshLambertMaterial?r(b,A):A.isMeshToonMaterial?(r(b,A),d(b,A)):A.isMeshPhongMaterial?(r(b,A),h(b,A)):A.isMeshStandardMaterial?(r(b,A),m(b,A),A.isMeshPhysicalMaterial&&y(b,A,R)):A.isMeshMatcapMaterial?(r(b,A),x(b,A)):A.isMeshDepthMaterial?r(b,A):A.isMeshDistanceMaterial?(r(b,A),_(b,A)):A.isMeshNormalMaterial?r(b,A):A.isLineBasicMaterial?(a(b,A),A.isLineDashedMaterial&&o(b,A)):A.isPointsMaterial?l(b,A,T,w):A.isSpriteMaterial?c(b,A):A.isShadowMaterial?(b.color.value.copy(A.color),b.opacity.value=A.opacity):A.isShaderMaterial&&(A.uniformsNeedUpdate=!1)}function r(b,A){b.opacity.value=A.opacity,A.color&&b.diffuse.value.copy(A.color),A.emissive&&b.emissive.value.copy(A.emissive).multiplyScalar(A.emissiveIntensity),A.map&&(b.map.value=A.map,t(A.map,b.mapTransform)),A.alphaMap&&(b.alphaMap.value=A.alphaMap,t(A.alphaMap,b.alphaMapTransform)),A.bumpMap&&(b.bumpMap.value=A.bumpMap,t(A.bumpMap,b.bumpMapTransform),b.bumpScale.value=A.bumpScale,A.side===wr&&(b.bumpScale.value*=-1)),A.normalMap&&(b.normalMap.value=A.normalMap,t(A.normalMap,b.normalMapTransform),b.normalScale.value.copy(A.normalScale),A.side===wr&&b.normalScale.value.negate()),A.displacementMap&&(b.displacementMap.value=A.displacementMap,t(A.displacementMap,b.displacementMapTransform),b.displacementScale.value=A.displacementScale,b.displacementBias.value=A.displacementBias),A.emissiveMap&&(b.emissiveMap.value=A.emissiveMap,t(A.emissiveMap,b.emissiveMapTransform)),A.specularMap&&(b.specularMap.value=A.specularMap,t(A.specularMap,b.specularMapTransform)),A.alphaTest>0&&(b.alphaTest.value=A.alphaTest);const T=e.get(A),w=T.envMap,R=T.envMapRotation;w&&(b.envMap.value=w,Qp.copy(R),Qp.x*=-1,Qp.y*=-1,Qp.z*=-1,w.isCubeTexture&&w.isRenderTargetTexture===!1&&(Qp.y*=-1,Qp.z*=-1),b.envMapRotation.value.setFromMatrix4(hfe.makeRotationFromEuler(Qp)),b.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,b.reflectivity.value=A.reflectivity,b.ior.value=A.ior,b.refractionRatio.value=A.refractionRatio),A.lightMap&&(b.lightMap.value=A.lightMap,b.lightMapIntensity.value=A.lightMapIntensity,t(A.lightMap,b.lightMapTransform)),A.aoMap&&(b.aoMap.value=A.aoMap,b.aoMapIntensity.value=A.aoMapIntensity,t(A.aoMap,b.aoMapTransform))}function a(b,A){b.diffuse.value.copy(A.color),b.opacity.value=A.opacity,A.map&&(b.map.value=A.map,t(A.map,b.mapTransform))}function o(b,A){b.dashSize.value=A.dashSize,b.totalSize.value=A.dashSize+A.gapSize,b.scale.value=A.scale}function l(b,A,T,w){b.diffuse.value.copy(A.color),b.opacity.value=A.opacity,b.size.value=A.size*T,b.scale.value=w*.5,A.map&&(b.map.value=A.map,t(A.map,b.uvTransform)),A.alphaMap&&(b.alphaMap.value=A.alphaMap,t(A.alphaMap,b.alphaMapTransform)),A.alphaTest>0&&(b.alphaTest.value=A.alphaTest)}function c(b,A){b.diffuse.value.copy(A.color),b.opacity.value=A.opacity,b.rotation.value=A.rotation,A.map&&(b.map.value=A.map,t(A.map,b.mapTransform)),A.alphaMap&&(b.alphaMap.value=A.alphaMap,t(A.alphaMap,b.alphaMapTransform)),A.alphaTest>0&&(b.alphaTest.value=A.alphaTest)}function h(b,A){b.specular.value.copy(A.specular),b.shininess.value=Math.max(A.shininess,1e-4)}function d(b,A){A.gradientMap&&(b.gradientMap.value=A.gradientMap)}function m(b,A){b.metalness.value=A.metalness,A.metalnessMap&&(b.metalnessMap.value=A.metalnessMap,t(A.metalnessMap,b.metalnessMapTransform)),b.roughness.value=A.roughness,A.roughnessMap&&(b.roughnessMap.value=A.roughnessMap,t(A.roughnessMap,b.roughnessMapTransform)),A.envMap&&(b.envMapIntensity.value=A.envMapIntensity)}function y(b,A,T){b.ior.value=A.ior,A.sheen>0&&(b.sheenColor.value.copy(A.sheenColor).multiplyScalar(A.sheen),b.sheenRoughness.value=A.sheenRoughness,A.sheenColorMap&&(b.sheenColorMap.value=A.sheenColorMap,t(A.sheenColorMap,b.sheenColorMapTransform)),A.sheenRoughnessMap&&(b.sheenRoughnessMap.value=A.sheenRoughnessMap,t(A.sheenRoughnessMap,b.sheenRoughnessMapTransform))),A.clearcoat>0&&(b.clearcoat.value=A.clearcoat,b.clearcoatRoughness.value=A.clearcoatRoughness,A.clearcoatMap&&(b.clearcoatMap.value=A.clearcoatMap,t(A.clearcoatMap,b.clearcoatMapTransform)),A.clearcoatRoughnessMap&&(b.clearcoatRoughnessMap.value=A.clearcoatRoughnessMap,t(A.clearcoatRoughnessMap,b.clearcoatRoughnessMapTransform)),A.clearcoatNormalMap&&(b.clearcoatNormalMap.value=A.clearcoatNormalMap,t(A.clearcoatNormalMap,b.clearcoatNormalMapTransform),b.clearcoatNormalScale.value.copy(A.clearcoatNormalScale),A.side===wr&&b.clearcoatNormalScale.value.negate())),A.dispersion>0&&(b.dispersion.value=A.dispersion),A.iridescence>0&&(b.iridescence.value=A.iridescence,b.iridescenceIOR.value=A.iridescenceIOR,b.iridescenceThicknessMinimum.value=A.iridescenceThicknessRange[0],b.iridescenceThicknessMaximum.value=A.iridescenceThicknessRange[1],A.iridescenceMap&&(b.iridescenceMap.value=A.iridescenceMap,t(A.iridescenceMap,b.iridescenceMapTransform)),A.iridescenceThicknessMap&&(b.iridescenceThicknessMap.value=A.iridescenceThicknessMap,t(A.iridescenceThicknessMap,b.iridescenceThicknessMapTransform))),A.transmission>0&&(b.transmission.value=A.transmission,b.transmissionSamplerMap.value=T.texture,b.transmissionSamplerSize.value.set(T.width,T.height),A.transmissionMap&&(b.transmissionMap.value=A.transmissionMap,t(A.transmissionMap,b.transmissionMapTransform)),b.thickness.value=A.thickness,A.thicknessMap&&(b.thicknessMap.value=A.thicknessMap,t(A.thicknessMap,b.thicknessMapTransform)),b.attenuationDistance.value=A.attenuationDistance,b.attenuationColor.value.copy(A.attenuationColor)),A.anisotropy>0&&(b.anisotropyVector.value.set(A.anisotropy*Math.cos(A.anisotropyRotation),A.anisotropy*Math.sin(A.anisotropyRotation)),A.anisotropyMap&&(b.anisotropyMap.value=A.anisotropyMap,t(A.anisotropyMap,b.anisotropyMapTransform))),b.specularIntensity.value=A.specularIntensity,b.specularColor.value.copy(A.specularColor),A.specularColorMap&&(b.specularColorMap.value=A.specularColorMap,t(A.specularColorMap,b.specularColorMapTransform)),A.specularIntensityMap&&(b.specularIntensityMap.value=A.specularIntensityMap,t(A.specularIntensityMap,b.specularIntensityMapTransform))}function x(b,A){A.matcap&&(b.matcap.value=A.matcap)}function _(b,A){const T=e.get(A).light;b.referencePosition.value.setFromMatrixPosition(T.matrixWorld),b.nearDistance.value=T.shadow.camera.near,b.farDistance.value=T.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:s}}function dfe(i,e,t,n){let s={},r={},a=[];const o=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function l(T,w){const R=w.program;n.uniformBlockBinding(T,R)}function c(T,w){let R=s[T.id];R===void 0&&(x(T),R=h(T),s[T.id]=R,T.addEventListener("dispose",b));const O=w.program;n.updateUBOMapping(T,O);const N=e.render.frame;r[T.id]!==N&&(m(T),r[T.id]=N)}function h(T){const w=d();T.__bindingPointIndex=w;const R=i.createBuffer(),O=T.__size,N=T.usage;return i.bindBuffer(i.UNIFORM_BUFFER,R),i.bufferData(i.UNIFORM_BUFFER,O,N),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,w,R),R}function d(){for(let T=0;T<o;T++)if(a.indexOf(T)===-1)return a.push(T),T;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function m(T){const w=s[T.id],R=T.uniforms,O=T.__cache;i.bindBuffer(i.UNIFORM_BUFFER,w);for(let N=0,U=R.length;N<U;N++){const P=Array.isArray(R[N])?R[N]:[R[N]];for(let B=0,L=P.length;B<L;B++){const F=P[B];if(y(F,N,B,O)===!0){const j=F.__offset,J=Array.isArray(F.value)?F.value:[F.value];let re=0;for(let q=0;q<J.length;q++){const W=J[q],ne=_(W);typeof W=="number"||typeof W=="boolean"?(F.__data[0]=W,i.bufferSubData(i.UNIFORM_BUFFER,j+re,F.__data)):W.isMatrix3?(F.__data[0]=W.elements[0],F.__data[1]=W.elements[1],F.__data[2]=W.elements[2],F.__data[3]=0,F.__data[4]=W.elements[3],F.__data[5]=W.elements[4],F.__data[6]=W.elements[5],F.__data[7]=0,F.__data[8]=W.elements[6],F.__data[9]=W.elements[7],F.__data[10]=W.elements[8],F.__data[11]=0):(W.toArray(F.__data,re),re+=ne.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,j,F.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function y(T,w,R,O){const N=T.value,U=w+"_"+R;if(O[U]===void 0)return typeof N=="number"||typeof N=="boolean"?O[U]=N:O[U]=N.clone(),!0;{const P=O[U];if(typeof N=="number"||typeof N=="boolean"){if(P!==N)return O[U]=N,!0}else if(P.equals(N)===!1)return P.copy(N),!0}return!1}function x(T){const w=T.uniforms;let R=0;const O=16;for(let U=0,P=w.length;U<P;U++){const B=Array.isArray(w[U])?w[U]:[w[U]];for(let L=0,F=B.length;L<F;L++){const j=B[L],J=Array.isArray(j.value)?j.value:[j.value];for(let re=0,q=J.length;re<q;re++){const W=J[re],ne=_(W),ie=R%O,ue=ie%ne.boundary,z=ie+ue;R+=ue,z!==0&&O-z<ne.storage&&(R+=O-z),j.__data=new Float32Array(ne.storage/Float32Array.BYTES_PER_ELEMENT),j.__offset=R,R+=ne.storage}}}const N=R%O;return N>0&&(R+=O-N),T.__size=R,T.__cache={},this}function _(T){const w={boundary:0,storage:0};return typeof T=="number"||typeof T=="boolean"?(w.boundary=4,w.storage=4):T.isVector2?(w.boundary=8,w.storage=8):T.isVector3||T.isColor?(w.boundary=16,w.storage=12):T.isVector4?(w.boundary=16,w.storage=16):T.isMatrix3?(w.boundary=48,w.storage=48):T.isMatrix4?(w.boundary=64,w.storage=64):T.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",T),w}function b(T){const w=T.target;w.removeEventListener("dispose",b);const R=a.indexOf(w.__bindingPointIndex);a.splice(R,1),i.deleteBuffer(s[w.id]),delete s[w.id],delete r[w.id]}function A(){for(const T in s)i.deleteBuffer(s[T]);a=[],s={},r={}}return{bind:l,update:c,dispose:A}}class bO{constructor(e={}){const{canvas:t=m9(),context:n=null,depth:s=!0,stencil:r=!1,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:d=!1,reverseDepthBuffer:m=!1}=e;this.isWebGLRenderer=!0;let y;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");y=n.getContextAttributes().alpha}else y=a;const x=new Uint32Array(4),_=new Int32Array(4);let b=null,A=null;const T=[],w=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Vc,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const R=this;let O=!1;this._outputColorSpace=bi;let N=0,U=0,P=null,B=-1,L=null;const F=new ai,j=new ai;let J=null;const re=new Ut(0);let q=0,W=t.width,ne=t.height,ie=1,ue=null,z=null;const ae=new ai(0,0,W,ne),ge=new ai(0,0,W,ne);let Ee=!1;const le=new Xv;let Ce=!1,Me=!1;const Ze=new hn,tt=new hn,Mt=new se,bt=new ai,cn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let tn=!1;function Ot(){return P===null?ie:1}let te=n;function At(Y,oe){return t.getContext(Y,oe)}try{const Y={alpha:!0,depth:s,stencil:r,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:h,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Sg}`),t.addEventListener("webglcontextlost",rt,!1),t.addEventListener("webglcontextrestored",It,!1),t.addEventListener("webglcontextcreationerror",Bt,!1),te===null){const oe="webgl2";if(te=At(oe,Y),te===null)throw At(oe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Y){throw console.error("THREE.WebGLRenderer: "+Y.message),Y}let Ve,st,$e,Pt,nt,ee,X,we,Fe,ut,We,ot,et,pt,vt,it,Ct,Et,Dt,Nt,ve,He,St,xe;function Oe(){Ve=new Tue(te),Ve.init(),He=new gV(te,Ve),st=new vue(te,Ve,e,He),$e=new rfe(te,Ve),st.reverseDepthBuffer&&m&&$e.buffers.depth.setReversed(!0),Pt=new Cue(te),nt=new Whe,ee=new afe(te,Ve,$e,nt,st,He,Pt),X=new bue(R),we=new Sue(R),Fe=new Ooe(te),St=new gue(te,Fe),ut=new wue(te,Fe,Pt,St),We=new Due(te,ut,Fe,Pt),Dt=new Rue(te,st,ee),it=new xue(nt),ot=new Khe(R,X,we,Ve,st,St,it),et=new ffe(R,nt),pt=new jhe,vt=new efe(Ve),Et=new mue(R,X,we,$e,We,y,l),Ct=new ife(R,We,st),xe=new dfe(te,Pt,st,$e),Nt=new yue(te,Ve,Pt),ve=new Mue(te,Ve,Pt),Pt.programs=ot.programs,R.capabilities=st,R.extensions=Ve,R.properties=nt,R.renderLists=pt,R.shadowMap=Ct,R.state=$e,R.info=Pt}Oe();const Ge=new ufe(R,te);this.xr=Ge,this.getContext=function(){return te},this.getContextAttributes=function(){return te.getContextAttributes()},this.forceContextLoss=function(){const Y=Ve.get("WEBGL_lose_context");Y&&Y.loseContext()},this.forceContextRestore=function(){const Y=Ve.get("WEBGL_lose_context");Y&&Y.restoreContext()},this.getPixelRatio=function(){return ie},this.setPixelRatio=function(Y){Y!==void 0&&(ie=Y,this.setSize(W,ne,!1))},this.getSize=function(Y){return Y.set(W,ne)},this.setSize=function(Y,oe,me=!0){if(Ge.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}W=Y,ne=oe,t.width=Math.floor(Y*ie),t.height=Math.floor(oe*ie),me===!0&&(t.style.width=Y+"px",t.style.height=oe+"px"),this.setViewport(0,0,Y,oe)},this.getDrawingBufferSize=function(Y){return Y.set(W*ie,ne*ie).floor()},this.setDrawingBufferSize=function(Y,oe,me){W=Y,ne=oe,ie=me,t.width=Math.floor(Y*me),t.height=Math.floor(oe*me),this.setViewport(0,0,Y,oe)},this.getCurrentViewport=function(Y){return Y.copy(F)},this.getViewport=function(Y){return Y.copy(ae)},this.setViewport=function(Y,oe,me,de){Y.isVector4?ae.set(Y.x,Y.y,Y.z,Y.w):ae.set(Y,oe,me,de),$e.viewport(F.copy(ae).multiplyScalar(ie).round())},this.getScissor=function(Y){return Y.copy(ge)},this.setScissor=function(Y,oe,me,de){Y.isVector4?ge.set(Y.x,Y.y,Y.z,Y.w):ge.set(Y,oe,me,de),$e.scissor(j.copy(ge).multiplyScalar(ie).round())},this.getScissorTest=function(){return Ee},this.setScissorTest=function(Y){$e.setScissorTest(Ee=Y)},this.setOpaqueSort=function(Y){ue=Y},this.setTransparentSort=function(Y){z=Y},this.getClearColor=function(Y){return Y.copy(Et.getClearColor())},this.setClearColor=function(){Et.setClearColor(...arguments)},this.getClearAlpha=function(){return Et.getClearAlpha()},this.setClearAlpha=function(){Et.setClearAlpha(...arguments)},this.clear=function(Y=!0,oe=!0,me=!0){let de=0;if(Y){let Ae=!1;if(P!==null){const Ne=P.texture.format;Ae=Ne===rM||Ne===sM||Ne===HE}if(Ae){const Ne=P.texture.type,qe=Ne===Xs||Ne===Qc||Ne===Rv||Ne===hg||Ne===nM||Ne===iM,ft=Et.getClearColor(),dt=Et.getClearAlpha(),Ft=ft.r,kt=ft.g,Ht=ft.b;qe?(x[0]=Ft,x[1]=kt,x[2]=Ht,x[3]=dt,te.clearBufferuiv(te.COLOR,0,x)):(_[0]=Ft,_[1]=kt,_[2]=Ht,_[3]=dt,te.clearBufferiv(te.COLOR,0,_))}else de|=te.COLOR_BUFFER_BIT}oe&&(de|=te.DEPTH_BUFFER_BIT),me&&(de|=te.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),te.clear(de)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",rt,!1),t.removeEventListener("webglcontextrestored",It,!1),t.removeEventListener("webglcontextcreationerror",Bt,!1),Et.dispose(),pt.dispose(),vt.dispose(),nt.dispose(),X.dispose(),we.dispose(),We.dispose(),St.dispose(),xe.dispose(),ot.dispose(),Ge.dispose(),Ge.removeEventListener("sessionstart",xh),Ge.removeEventListener("sessionend",Vl),vr.stop()};function rt(Y){Y.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),O=!0}function It(){console.log("THREE.WebGLRenderer: Context Restored."),O=!1;const Y=Pt.autoReset,oe=Ct.enabled,me=Ct.autoUpdate,de=Ct.needsUpdate,Ae=Ct.type;Oe(),Pt.autoReset=Y,Ct.enabled=oe,Ct.autoUpdate=me,Ct.needsUpdate=de,Ct.type=Ae}function Bt(Y){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Y.statusMessage)}function $t(Y){const oe=Y.target;oe.removeEventListener("dispose",$t),Pn(oe)}function Pn(Y){gi(Y),nt.remove(Y)}function gi(Y){const oe=nt.get(Y).programs;oe!==void 0&&(oe.forEach(function(me){ot.releaseProgram(me)}),Y.isShaderMaterial&&ot.releaseShaderCache(Y))}this.renderBufferDirect=function(Y,oe,me,de,Ae,Ne){oe===null&&(oe=cn);const qe=Ae.isMesh&&Ae.matrixWorld.determinant()<0,ft=be(Y,oe,me,de,Ae);$e.setMaterial(de,qe);let dt=me.index,Ft=1;if(de.wireframe===!0){if(dt=ut.getWireframeAttribute(me),dt===void 0)return;Ft=2}const kt=me.drawRange,Ht=me.attributes.position;let ln=kt.start*Ft,jt=(kt.start+kt.count)*Ft;Ne!==null&&(ln=Math.max(ln,Ne.start*Ft),jt=Math.min(jt,(Ne.start+Ne.count)*Ft)),dt!==null?(ln=Math.max(ln,0),jt=Math.min(jt,dt.count)):Ht!=null&&(ln=Math.max(ln,0),jt=Math.min(jt,Ht.count));const Kn=jt-ln;if(Kn<0||Kn===1/0)return;St.setup(Ae,de,ft,me,dt);let Jt,Yt=Nt;if(dt!==null&&(Jt=Fe.get(dt),Yt=ve,Yt.setIndex(Jt)),Ae.isMesh)de.wireframe===!0?($e.setLineWidth(de.wireframeLinewidth*Ot()),Yt.setMode(te.LINES)):Yt.setMode(te.TRIANGLES);else if(Ae.isLine){let Kt=de.linewidth;Kt===void 0&&(Kt=1),$e.setLineWidth(Kt*Ot()),Ae.isLineSegments?Yt.setMode(te.LINES):Ae.isLineLoop?Yt.setMode(te.LINE_LOOP):Yt.setMode(te.LINE_STRIP)}else Ae.isPoints?Yt.setMode(te.POINTS):Ae.isSprite&&Yt.setMode(te.TRIANGLES);if(Ae.isBatchedMesh)if(Ae._multiDrawInstances!==null)GT("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Yt.renderMultiDrawInstances(Ae._multiDrawStarts,Ae._multiDrawCounts,Ae._multiDrawCount,Ae._multiDrawInstances);else if(Ve.get("WEBGL_multi_draw"))Yt.renderMultiDraw(Ae._multiDrawStarts,Ae._multiDrawCounts,Ae._multiDrawCount);else{const Kt=Ae._multiDrawStarts,Ki=Ae._multiDrawCounts,pn=Ae._multiDrawCount,Sn=dt?Fe.get(dt).bytesPerElement:1,Ai=nt.get(de).currentProgram.getUniforms();for(let In=0;In<pn;In++)Ai.setValue(te,"_gl_DrawID",In),Yt.render(Kt[In]/Sn,Ki[In])}else if(Ae.isInstancedMesh)Yt.renderInstances(ln,Kn,Ae.count);else if(me.isInstancedBufferGeometry){const Kt=me._maxInstanceCount!==void 0?me._maxInstanceCount:1/0,Ki=Math.min(me.instanceCount,Kt);Yt.renderInstances(ln,Kn,Ki)}else Yt.render(ln,Kn)};function _n(Y,oe,me){Y.transparent===!0&&Y.side===Da&&Y.forceSinglePass===!1?(Y.side=wr,Y.needsUpdate=!0,Ln(Y,oe,me),Y.side=qc,Y.needsUpdate=!0,Ln(Y,oe,me),Y.side=Da):Ln(Y,oe,me)}this.compile=function(Y,oe,me=null){me===null&&(me=Y),A=vt.get(me),A.init(oe),w.push(A),me.traverseVisible(function(Ae){Ae.isLight&&Ae.layers.test(oe.layers)&&(A.pushLight(Ae),Ae.castShadow&&A.pushShadow(Ae))}),Y!==me&&Y.traverseVisible(function(Ae){Ae.isLight&&Ae.layers.test(oe.layers)&&(A.pushLight(Ae),Ae.castShadow&&A.pushShadow(Ae))}),A.setupLights();const de=new Set;return Y.traverse(function(Ae){if(!(Ae.isMesh||Ae.isPoints||Ae.isLine||Ae.isSprite))return;const Ne=Ae.material;if(Ne)if(Array.isArray(Ne))for(let qe=0;qe<Ne.length;qe++){const ft=Ne[qe];_n(ft,me,Ae),de.add(ft)}else _n(Ne,me,Ae),de.add(Ne)}),A=w.pop(),de},this.compileAsync=function(Y,oe,me=null){const de=this.compile(Y,oe,me);return new Promise(Ae=>{function Ne(){if(de.forEach(function(qe){nt.get(qe).currentProgram.isReady()&&de.delete(qe)}),de.size===0){Ae(Y);return}setTimeout(Ne,10)}Ve.get("KHR_parallel_shader_compile")!==null?Ne():setTimeout(Ne,10)})};let ts=null;function cs(Y){ts&&ts(Y)}function xh(){vr.stop()}function Vl(){vr.start()}const vr=new hV;vr.setAnimationLoop(cs),typeof self<"u"&&vr.setContext(self),this.setAnimationLoop=function(Y){ts=Y,Ge.setAnimationLoop(Y),Y===null?vr.stop():vr.start()},Ge.addEventListener("sessionstart",xh),Ge.addEventListener("sessionend",Vl),this.render=function(Y,oe){if(oe!==void 0&&oe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(O===!0)return;if(Y.matrixWorldAutoUpdate===!0&&Y.updateMatrixWorld(),oe.parent===null&&oe.matrixWorldAutoUpdate===!0&&oe.updateMatrixWorld(),Ge.enabled===!0&&Ge.isPresenting===!0&&(Ge.cameraAutoUpdate===!0&&Ge.updateCamera(oe),oe=Ge.getCamera()),Y.isScene===!0&&Y.onBeforeRender(R,Y,oe,P),A=vt.get(Y,w.length),A.init(oe),w.push(A),tt.multiplyMatrices(oe.projectionMatrix,oe.matrixWorldInverse),le.setFromProjectionMatrix(tt),Me=this.localClippingEnabled,Ce=it.init(this.clippingPlanes,Me),b=pt.get(Y,T.length),b.init(),T.push(b),Ge.enabled===!0&&Ge.isPresenting===!0){const Ne=R.xr.getDepthSensingMesh();Ne!==null&&Wr(Ne,oe,-1/0,R.sortObjects)}Wr(Y,oe,0,R.sortObjects),b.finish(),R.sortObjects===!0&&b.sort(ue,z),tn=Ge.enabled===!1||Ge.isPresenting===!1||Ge.hasDepthSensing()===!1,tn&&Et.addToRenderList(b,Y),this.info.render.frame++,Ce===!0&&it.beginShadows();const me=A.state.shadowsArray;Ct.render(me,Y,oe),Ce===!0&&it.endShadows(),this.info.autoReset===!0&&this.info.reset();const de=b.opaque,Ae=b.transmissive;if(A.setupLights(),oe.isArrayCamera){const Ne=oe.cameras;if(Ae.length>0)for(let qe=0,ft=Ne.length;qe<ft;qe++){const dt=Ne[qe];xr(de,Ae,Y,dt)}tn&&Et.render(Y);for(let qe=0,ft=Ne.length;qe<ft;qe++){const dt=Ne[qe];to(b,Y,dt,dt.viewport)}}else Ae.length>0&&xr(de,Ae,Y,oe),tn&&Et.render(Y),to(b,Y,oe);P!==null&&U===0&&(ee.updateMultisampleRenderTarget(P),ee.updateRenderTargetMipmap(P)),Y.isScene===!0&&Y.onAfterRender(R,Y,oe),St.resetDefaultState(),B=-1,L=null,w.pop(),w.length>0?(A=w[w.length-1],Ce===!0&&it.setGlobalState(R.clippingPlanes,A.state.camera)):A=null,T.pop(),T.length>0?b=T[T.length-1]:b=null};function Wr(Y,oe,me,de){if(Y.visible===!1)return;if(Y.layers.test(oe.layers)){if(Y.isGroup)me=Y.renderOrder;else if(Y.isLOD)Y.autoUpdate===!0&&Y.update(oe);else if(Y.isLight)A.pushLight(Y),Y.castShadow&&A.pushShadow(Y);else if(Y.isSprite){if(!Y.frustumCulled||le.intersectsSprite(Y)){de&&bt.setFromMatrixPosition(Y.matrixWorld).applyMatrix4(tt);const qe=We.update(Y),ft=Y.material;ft.visible&&b.push(Y,qe,ft,me,bt.z,null)}}else if((Y.isMesh||Y.isLine||Y.isPoints)&&(!Y.frustumCulled||le.intersectsObject(Y))){const qe=We.update(Y),ft=Y.material;if(de&&(Y.boundingSphere!==void 0?(Y.boundingSphere===null&&Y.computeBoundingSphere(),bt.copy(Y.boundingSphere.center)):(qe.boundingSphere===null&&qe.computeBoundingSphere(),bt.copy(qe.boundingSphere.center)),bt.applyMatrix4(Y.matrixWorld).applyMatrix4(tt)),Array.isArray(ft)){const dt=qe.groups;for(let Ft=0,kt=dt.length;Ft<kt;Ft++){const Ht=dt[Ft],ln=ft[Ht.materialIndex];ln&&ln.visible&&b.push(Y,qe,ln,me,bt.z,Ht)}}else ft.visible&&b.push(Y,qe,ft,me,bt.z,null)}}const Ne=Y.children;for(let qe=0,ft=Ne.length;qe<ft;qe++)Wr(Ne[qe],oe,me,de)}function to(Y,oe,me,de){const Ae=Y.opaque,Ne=Y.transmissive,qe=Y.transparent;A.setupLightsView(me),Ce===!0&&it.setGlobalState(R.clippingPlanes,me),de&&$e.viewport(F.copy(de)),Ae.length>0&&sn(Ae,oe,me),Ne.length>0&&sn(Ne,oe,me),qe.length>0&&sn(qe,oe,me),$e.buffers.depth.setTest(!0),$e.buffers.depth.setMask(!0),$e.buffers.color.setMask(!0),$e.setPolygonOffset(!1)}function xr(Y,oe,me,de){if((me.isScene===!0?me.overrideMaterial:null)!==null)return;A.state.transmissionRenderTarget[de.id]===void 0&&(A.state.transmissionRenderTarget[de.id]=new Os(1,1,{generateMipmaps:!0,type:Ve.has("EXT_color_buffer_half_float")||Ve.has("EXT_color_buffer_float")?yr:Xs,minFilter:Nl,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:ri.workingColorSpace}));const Ne=A.state.transmissionRenderTarget[de.id],qe=de.viewport||F;Ne.setSize(qe.z*R.transmissionResolutionScale,qe.w*R.transmissionResolutionScale);const ft=R.getRenderTarget();R.setRenderTarget(Ne),R.getClearColor(re),q=R.getClearAlpha(),q<1&&R.setClearColor(16777215,.5),R.clear(),tn&&Et.render(me);const dt=R.toneMapping;R.toneMapping=Vc;const Ft=de.viewport;if(de.viewport!==void 0&&(de.viewport=void 0),A.setupLightsView(de),Ce===!0&&it.setGlobalState(R.clippingPlanes,de),sn(Y,me,de),ee.updateMultisampleRenderTarget(Ne),ee.updateRenderTargetMipmap(Ne),Ve.has("WEBGL_multisampled_render_to_texture")===!1){let kt=!1;for(let Ht=0,ln=oe.length;Ht<ln;Ht++){const jt=oe[Ht],Kn=jt.object,Jt=jt.geometry,Yt=jt.material,Kt=jt.group;if(Yt.side===Da&&Kn.layers.test(de.layers)){const Ki=Yt.side;Yt.side=wr,Yt.needsUpdate=!0,$i(Kn,me,de,Jt,Yt,Kt),Yt.side=Ki,Yt.needsUpdate=!0,kt=!0}}kt===!0&&(ee.updateMultisampleRenderTarget(Ne),ee.updateRenderTargetMipmap(Ne))}R.setRenderTarget(ft),R.setClearColor(re,q),Ft!==void 0&&(de.viewport=Ft),R.toneMapping=dt}function sn(Y,oe,me){const de=oe.isScene===!0?oe.overrideMaterial:null;for(let Ae=0,Ne=Y.length;Ae<Ne;Ae++){const qe=Y[Ae],ft=qe.object,dt=qe.geometry,Ft=qe.group;let kt=qe.material;kt.allowOverride===!0&&de!==null&&(kt=de),ft.layers.test(me.layers)&&$i(ft,oe,me,dt,kt,Ft)}}function $i(Y,oe,me,de,Ae,Ne){Y.onBeforeRender(R,oe,me,de,Ae,Ne),Y.modelViewMatrix.multiplyMatrices(me.matrixWorldInverse,Y.matrixWorld),Y.normalMatrix.getNormalMatrix(Y.modelViewMatrix),Ae.onBeforeRender(R,oe,me,de,Y,Ne),Ae.transparent===!0&&Ae.side===Da&&Ae.forceSinglePass===!1?(Ae.side=wr,Ae.needsUpdate=!0,R.renderBufferDirect(me,oe,de,Ae,Y,Ne),Ae.side=qc,Ae.needsUpdate=!0,R.renderBufferDirect(me,oe,de,Ae,Y,Ne),Ae.side=Da):R.renderBufferDirect(me,oe,de,Ae,Y,Ne),Y.onAfterRender(R,oe,me,de,Ae,Ne)}function Ln(Y,oe,me){oe.isScene!==!0&&(oe=cn);const de=nt.get(Y),Ae=A.state.lights,Ne=A.state.shadowsArray,qe=Ae.state.version,ft=ot.getParameters(Y,Ae.state,Ne,oe,me),dt=ot.getProgramCacheKey(ft);let Ft=de.programs;de.environment=Y.isMeshStandardMaterial?oe.environment:null,de.fog=oe.fog,de.envMap=(Y.isMeshStandardMaterial?we:X).get(Y.envMap||de.environment),de.envMapRotation=de.environment!==null&&Y.envMap===null?oe.environmentRotation:Y.envMapRotation,Ft===void 0&&(Y.addEventListener("dispose",$t),Ft=new Map,de.programs=Ft);let kt=Ft.get(dt);if(kt!==void 0){if(de.currentProgram===kt&&de.lightsStateVersion===qe)return Z(Y,ft),kt}else ft.uniforms=ot.getUniforms(Y),Y.onBeforeCompile(ft,R),kt=ot.acquireProgram(ft,dt),Ft.set(dt,kt),de.uniforms=ft.uniforms;const Ht=de.uniforms;return(!Y.isShaderMaterial&&!Y.isRawShaderMaterial||Y.clipping===!0)&&(Ht.clippingPlanes=it.uniform),Z(Y,ft),de.needsLights=Je(Y),de.lightsStateVersion=qe,de.needsLights&&(Ht.ambientLightColor.value=Ae.state.ambient,Ht.lightProbe.value=Ae.state.probe,Ht.directionalLights.value=Ae.state.directional,Ht.directionalLightShadows.value=Ae.state.directionalShadow,Ht.spotLights.value=Ae.state.spot,Ht.spotLightShadows.value=Ae.state.spotShadow,Ht.rectAreaLights.value=Ae.state.rectArea,Ht.ltc_1.value=Ae.state.rectAreaLTC1,Ht.ltc_2.value=Ae.state.rectAreaLTC2,Ht.pointLights.value=Ae.state.point,Ht.pointLightShadows.value=Ae.state.pointShadow,Ht.hemisphereLights.value=Ae.state.hemi,Ht.directionalShadowMap.value=Ae.state.directionalShadowMap,Ht.directionalShadowMatrix.value=Ae.state.directionalShadowMatrix,Ht.spotShadowMap.value=Ae.state.spotShadowMap,Ht.spotLightMatrix.value=Ae.state.spotLightMatrix,Ht.spotLightMap.value=Ae.state.spotLightMap,Ht.pointShadowMap.value=Ae.state.pointShadowMap,Ht.pointShadowMatrix.value=Ae.state.pointShadowMatrix),de.currentProgram=kt,de.uniformsList=null,kt}function V(Y){if(Y.uniformsList===null){const oe=Y.currentProgram.getUniforms();Y.uniformsList=VT.seqWithValue(oe.seq,Y.uniforms)}return Y.uniformsList}function Z(Y,oe){const me=nt.get(Y);me.outputColorSpace=oe.outputColorSpace,me.batching=oe.batching,me.batchingColor=oe.batchingColor,me.instancing=oe.instancing,me.instancingColor=oe.instancingColor,me.instancingMorph=oe.instancingMorph,me.skinning=oe.skinning,me.morphTargets=oe.morphTargets,me.morphNormals=oe.morphNormals,me.morphColors=oe.morphColors,me.morphTargetsCount=oe.morphTargetsCount,me.numClippingPlanes=oe.numClippingPlanes,me.numIntersection=oe.numClipIntersection,me.vertexAlphas=oe.vertexAlphas,me.vertexTangents=oe.vertexTangents,me.toneMapping=oe.toneMapping}function be(Y,oe,me,de,Ae){oe.isScene!==!0&&(oe=cn),ee.resetTextureUnits();const Ne=oe.fog,qe=de.isMeshStandardMaterial?oe.environment:null,ft=P===null?R.outputColorSpace:P.isXRRenderTarget===!0?P.texture.colorSpace:nl,dt=(de.isMeshStandardMaterial?we:X).get(de.envMap||qe),Ft=de.vertexColors===!0&&!!me.attributes.color&&me.attributes.color.itemSize===4,kt=!!me.attributes.tangent&&(!!de.normalMap||de.anisotropy>0),Ht=!!me.morphAttributes.position,ln=!!me.morphAttributes.normal,jt=!!me.morphAttributes.color;let Kn=Vc;de.toneMapped&&(P===null||P.isXRRenderTarget===!0)&&(Kn=R.toneMapping);const Jt=me.morphAttributes.position||me.morphAttributes.normal||me.morphAttributes.color,Yt=Jt!==void 0?Jt.length:0,Kt=nt.get(de),Ki=A.state.lights;if(Ce===!0&&(Me===!0||Y!==L)){const vi=Y===L&&de.id===B;it.setState(de,Y,vi)}let pn=!1;de.version===Kt.__version?(Kt.needsLights&&Kt.lightsStateVersion!==Ki.state.version||Kt.outputColorSpace!==ft||Ae.isBatchedMesh&&Kt.batching===!1||!Ae.isBatchedMesh&&Kt.batching===!0||Ae.isBatchedMesh&&Kt.batchingColor===!0&&Ae.colorTexture===null||Ae.isBatchedMesh&&Kt.batchingColor===!1&&Ae.colorTexture!==null||Ae.isInstancedMesh&&Kt.instancing===!1||!Ae.isInstancedMesh&&Kt.instancing===!0||Ae.isSkinnedMesh&&Kt.skinning===!1||!Ae.isSkinnedMesh&&Kt.skinning===!0||Ae.isInstancedMesh&&Kt.instancingColor===!0&&Ae.instanceColor===null||Ae.isInstancedMesh&&Kt.instancingColor===!1&&Ae.instanceColor!==null||Ae.isInstancedMesh&&Kt.instancingMorph===!0&&Ae.morphTexture===null||Ae.isInstancedMesh&&Kt.instancingMorph===!1&&Ae.morphTexture!==null||Kt.envMap!==dt||de.fog===!0&&Kt.fog!==Ne||Kt.numClippingPlanes!==void 0&&(Kt.numClippingPlanes!==it.numPlanes||Kt.numIntersection!==it.numIntersection)||Kt.vertexAlphas!==Ft||Kt.vertexTangents!==kt||Kt.morphTargets!==Ht||Kt.morphNormals!==ln||Kt.morphColors!==jt||Kt.toneMapping!==Kn||Kt.morphTargetsCount!==Yt)&&(pn=!0):(pn=!0,Kt.__version=de.version);let Sn=Kt.currentProgram;pn===!0&&(Sn=Ln(de,oe,Ae));let Ai=!1,In=!1,mn=!1;const wn=Sn.getUniforms(),ns=Kt.uniforms;if($e.useProgram(Sn.program)&&(Ai=!0,In=!0,mn=!0),de.id!==B&&(B=de.id,In=!0),Ai||L!==Y){$e.buffers.depth.getReversed()?(Ze.copy(Y.projectionMatrix),rre(Ze),are(Ze),wn.setValue(te,"projectionMatrix",Ze)):wn.setValue(te,"projectionMatrix",Y.projectionMatrix),wn.setValue(te,"viewMatrix",Y.matrixWorldInverse);const hr=wn.map.cameraPosition;hr!==void 0&&hr.setValue(te,Mt.setFromMatrixPosition(Y.matrixWorld)),st.logarithmicDepthBuffer&&wn.setValue(te,"logDepthBufFC",2/(Math.log(Y.far+1)/Math.LN2)),(de.isMeshPhongMaterial||de.isMeshToonMaterial||de.isMeshLambertMaterial||de.isMeshBasicMaterial||de.isMeshStandardMaterial||de.isShaderMaterial)&&wn.setValue(te,"isOrthographic",Y.isOrthographicCamera===!0),L!==Y&&(L=Y,In=!0,mn=!0)}if(Ae.isSkinnedMesh){wn.setOptional(te,Ae,"bindMatrix"),wn.setOptional(te,Ae,"bindMatrixInverse");const vi=Ae.skeleton;vi&&(vi.boneTexture===null&&vi.computeBoneTexture(),wn.setValue(te,"boneTexture",vi.boneTexture,ee))}Ae.isBatchedMesh&&(wn.setOptional(te,Ae,"batchingTexture"),wn.setValue(te,"batchingTexture",Ae._matricesTexture,ee),wn.setOptional(te,Ae,"batchingIdTexture"),wn.setValue(te,"batchingIdTexture",Ae._indirectTexture,ee),wn.setOptional(te,Ae,"batchingColorTexture"),Ae._colorsTexture!==null&&wn.setValue(te,"batchingColorTexture",Ae._colorsTexture,ee));const yi=me.morphAttributes;if((yi.position!==void 0||yi.normal!==void 0||yi.color!==void 0)&&Dt.update(Ae,me,Sn),(In||Kt.receiveShadow!==Ae.receiveShadow)&&(Kt.receiveShadow=Ae.receiveShadow,wn.setValue(te,"receiveShadow",Ae.receiveShadow)),de.isMeshGouraudMaterial&&de.envMap!==null&&(ns.envMap.value=dt,ns.flipEnvMap.value=dt.isCubeTexture&&dt.isRenderTargetTexture===!1?-1:1),de.isMeshStandardMaterial&&de.envMap===null&&oe.environment!==null&&(ns.envMapIntensity.value=oe.environmentIntensity),In&&(wn.setValue(te,"toneMappingExposure",R.toneMappingExposure),Kt.needsLights&&ze(ns,mn),Ne&&de.fog===!0&&et.refreshFogUniforms(ns,Ne),et.refreshMaterialUniforms(ns,de,ie,ne,A.state.transmissionRenderTarget[Y.id]),VT.upload(te,V(Kt),ns,ee)),de.isShaderMaterial&&de.uniformsNeedUpdate===!0&&(VT.upload(te,V(Kt),ns,ee),de.uniformsNeedUpdate=!1),de.isSpriteMaterial&&wn.setValue(te,"center",Ae.center),wn.setValue(te,"modelViewMatrix",Ae.modelViewMatrix),wn.setValue(te,"normalMatrix",Ae.normalMatrix),wn.setValue(te,"modelMatrix",Ae.matrixWorld),de.isShaderMaterial||de.isRawShaderMaterial){const vi=de.uniformsGroups;for(let hr=0,Io=vi.length;hr<Io;hr++){const Xr=vi[hr];xe.update(Xr,Sn),xe.bind(Xr,Sn)}}return Sn}function ze(Y,oe){Y.ambientLightColor.needsUpdate=oe,Y.lightProbe.needsUpdate=oe,Y.directionalLights.needsUpdate=oe,Y.directionalLightShadows.needsUpdate=oe,Y.pointLights.needsUpdate=oe,Y.pointLightShadows.needsUpdate=oe,Y.spotLights.needsUpdate=oe,Y.spotLightShadows.needsUpdate=oe,Y.rectAreaLights.needsUpdate=oe,Y.hemisphereLights.needsUpdate=oe}function Je(Y){return Y.isMeshLambertMaterial||Y.isMeshToonMaterial||Y.isMeshPhongMaterial||Y.isMeshStandardMaterial||Y.isShadowMaterial||Y.isShaderMaterial&&Y.lights===!0}this.getActiveCubeFace=function(){return N},this.getActiveMipmapLevel=function(){return U},this.getRenderTarget=function(){return P},this.setRenderTargetTextures=function(Y,oe,me){const de=nt.get(Y);de.__autoAllocateDepthBuffer=Y.resolveDepthBuffer===!1,de.__autoAllocateDepthBuffer===!1&&(de.__useRenderToTexture=!1),nt.get(Y.texture).__webglTexture=oe,nt.get(Y.depthTexture).__webglTexture=de.__autoAllocateDepthBuffer?void 0:me,de.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(Y,oe){const me=nt.get(Y);me.__webglFramebuffer=oe,me.__useDefaultFramebuffer=oe===void 0};const Xe=te.createFramebuffer();this.setRenderTarget=function(Y,oe=0,me=0){P=Y,N=oe,U=me;let de=!0,Ae=null,Ne=!1,qe=!1;if(Y){const dt=nt.get(Y);if(dt.__useDefaultFramebuffer!==void 0)$e.bindFramebuffer(te.FRAMEBUFFER,null),de=!1;else if(dt.__webglFramebuffer===void 0)ee.setupRenderTarget(Y);else if(dt.__hasExternalTextures)ee.rebindTextures(Y,nt.get(Y.texture).__webglTexture,nt.get(Y.depthTexture).__webglTexture);else if(Y.depthBuffer){const Ht=Y.depthTexture;if(dt.__boundDepthTexture!==Ht){if(Ht!==null&&nt.has(Ht)&&(Y.width!==Ht.image.width||Y.height!==Ht.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ee.setupDepthRenderbuffer(Y)}}const Ft=Y.texture;(Ft.isData3DTexture||Ft.isDataArrayTexture||Ft.isCompressedArrayTexture)&&(qe=!0);const kt=nt.get(Y).__webglFramebuffer;Y.isWebGLCubeRenderTarget?(Array.isArray(kt[oe])?Ae=kt[oe][me]:Ae=kt[oe],Ne=!0):Y.samples>0&&ee.useMultisampledRTT(Y)===!1?Ae=nt.get(Y).__webglMultisampledFramebuffer:Array.isArray(kt)?Ae=kt[me]:Ae=kt,F.copy(Y.viewport),j.copy(Y.scissor),J=Y.scissorTest}else F.copy(ae).multiplyScalar(ie).floor(),j.copy(ge).multiplyScalar(ie).floor(),J=Ee;if(me!==0&&(Ae=Xe),$e.bindFramebuffer(te.FRAMEBUFFER,Ae)&&de&&$e.drawBuffers(Y,Ae),$e.viewport(F),$e.scissor(j),$e.setScissorTest(J),Ne){const dt=nt.get(Y.texture);te.framebufferTexture2D(te.FRAMEBUFFER,te.COLOR_ATTACHMENT0,te.TEXTURE_CUBE_MAP_POSITIVE_X+oe,dt.__webglTexture,me)}else if(qe){const dt=nt.get(Y.texture),Ft=oe;te.framebufferTextureLayer(te.FRAMEBUFFER,te.COLOR_ATTACHMENT0,dt.__webglTexture,me,Ft)}else if(Y!==null&&me!==0){const dt=nt.get(Y.texture);te.framebufferTexture2D(te.FRAMEBUFFER,te.COLOR_ATTACHMENT0,te.TEXTURE_2D,dt.__webglTexture,me)}B=-1},this.readRenderTargetPixels=function(Y,oe,me,de,Ae,Ne,qe){if(!(Y&&Y.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ft=nt.get(Y).__webglFramebuffer;if(Y.isWebGLCubeRenderTarget&&qe!==void 0&&(ft=ft[qe]),ft){$e.bindFramebuffer(te.FRAMEBUFFER,ft);try{const dt=Y.texture,Ft=dt.format,kt=dt.type;if(!st.textureFormatReadable(Ft)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!st.textureTypeReadable(kt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}oe>=0&&oe<=Y.width-de&&me>=0&&me<=Y.height-Ae&&te.readPixels(oe,me,de,Ae,He.convert(Ft),He.convert(kt),Ne)}finally{const dt=P!==null?nt.get(P).__webglFramebuffer:null;$e.bindFramebuffer(te.FRAMEBUFFER,dt)}}},this.readRenderTargetPixelsAsync=async function(Y,oe,me,de,Ae,Ne,qe){if(!(Y&&Y.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ft=nt.get(Y).__webglFramebuffer;if(Y.isWebGLCubeRenderTarget&&qe!==void 0&&(ft=ft[qe]),ft)if(oe>=0&&oe<=Y.width-de&&me>=0&&me<=Y.height-Ae){$e.bindFramebuffer(te.FRAMEBUFFER,ft);const dt=Y.texture,Ft=dt.format,kt=dt.type;if(!st.textureFormatReadable(Ft))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!st.textureTypeReadable(kt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Ht=te.createBuffer();te.bindBuffer(te.PIXEL_PACK_BUFFER,Ht),te.bufferData(te.PIXEL_PACK_BUFFER,Ne.byteLength,te.STREAM_READ),te.readPixels(oe,me,de,Ae,He.convert(Ft),He.convert(kt),0);const ln=P!==null?nt.get(P).__webglFramebuffer:null;$e.bindFramebuffer(te.FRAMEBUFFER,ln);const jt=te.fenceSync(te.SYNC_GPU_COMMANDS_COMPLETE,0);return te.flush(),await sre(te,jt,4),te.bindBuffer(te.PIXEL_PACK_BUFFER,Ht),te.getBufferSubData(te.PIXEL_PACK_BUFFER,0,Ne),te.deleteBuffer(Ht),te.deleteSync(jt),Ne}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(Y,oe=null,me=0){const de=Math.pow(2,-me),Ae=Math.floor(Y.image.width*de),Ne=Math.floor(Y.image.height*de),qe=oe!==null?oe.x:0,ft=oe!==null?oe.y:0;ee.setTexture2D(Y,0),te.copyTexSubImage2D(te.TEXTURE_2D,me,0,0,qe,ft,Ae,Ne),$e.unbindTexture()};const Rt=te.createFramebuffer(),gt=te.createFramebuffer();this.copyTextureToTexture=function(Y,oe,me=null,de=null,Ae=0,Ne=null){Ne===null&&(Ae!==0?(GT("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Ne=Ae,Ae=0):Ne=0);let qe,ft,dt,Ft,kt,Ht,ln,jt,Kn;const Jt=Y.isCompressedTexture?Y.mipmaps[Ne]:Y.image;if(me!==null)qe=me.max.x-me.min.x,ft=me.max.y-me.min.y,dt=me.isBox3?me.max.z-me.min.z:1,Ft=me.min.x,kt=me.min.y,Ht=me.isBox3?me.min.z:0;else{const yi=Math.pow(2,-Ae);qe=Math.floor(Jt.width*yi),ft=Math.floor(Jt.height*yi),Y.isDataArrayTexture?dt=Jt.depth:Y.isData3DTexture?dt=Math.floor(Jt.depth*yi):dt=1,Ft=0,kt=0,Ht=0}de!==null?(ln=de.x,jt=de.y,Kn=de.z):(ln=0,jt=0,Kn=0);const Yt=He.convert(oe.format),Kt=He.convert(oe.type);let Ki;oe.isData3DTexture?(ee.setTexture3D(oe,0),Ki=te.TEXTURE_3D):oe.isDataArrayTexture||oe.isCompressedArrayTexture?(ee.setTexture2DArray(oe,0),Ki=te.TEXTURE_2D_ARRAY):(ee.setTexture2D(oe,0),Ki=te.TEXTURE_2D),te.pixelStorei(te.UNPACK_FLIP_Y_WEBGL,oe.flipY),te.pixelStorei(te.UNPACK_PREMULTIPLY_ALPHA_WEBGL,oe.premultiplyAlpha),te.pixelStorei(te.UNPACK_ALIGNMENT,oe.unpackAlignment);const pn=te.getParameter(te.UNPACK_ROW_LENGTH),Sn=te.getParameter(te.UNPACK_IMAGE_HEIGHT),Ai=te.getParameter(te.UNPACK_SKIP_PIXELS),In=te.getParameter(te.UNPACK_SKIP_ROWS),mn=te.getParameter(te.UNPACK_SKIP_IMAGES);te.pixelStorei(te.UNPACK_ROW_LENGTH,Jt.width),te.pixelStorei(te.UNPACK_IMAGE_HEIGHT,Jt.height),te.pixelStorei(te.UNPACK_SKIP_PIXELS,Ft),te.pixelStorei(te.UNPACK_SKIP_ROWS,kt),te.pixelStorei(te.UNPACK_SKIP_IMAGES,Ht);const wn=Y.isDataArrayTexture||Y.isData3DTexture,ns=oe.isDataArrayTexture||oe.isData3DTexture;if(Y.isDepthTexture){const yi=nt.get(Y),vi=nt.get(oe),hr=nt.get(yi.__renderTarget),Io=nt.get(vi.__renderTarget);$e.bindFramebuffer(te.READ_FRAMEBUFFER,hr.__webglFramebuffer),$e.bindFramebuffer(te.DRAW_FRAMEBUFFER,Io.__webglFramebuffer);for(let Xr=0;Xr<dt;Xr++)wn&&(te.framebufferTextureLayer(te.READ_FRAMEBUFFER,te.COLOR_ATTACHMENT0,nt.get(Y).__webglTexture,Ae,Ht+Xr),te.framebufferTextureLayer(te.DRAW_FRAMEBUFFER,te.COLOR_ATTACHMENT0,nt.get(oe).__webglTexture,Ne,Kn+Xr)),te.blitFramebuffer(Ft,kt,qe,ft,ln,jt,qe,ft,te.DEPTH_BUFFER_BIT,te.NEAREST);$e.bindFramebuffer(te.READ_FRAMEBUFFER,null),$e.bindFramebuffer(te.DRAW_FRAMEBUFFER,null)}else if(Ae!==0||Y.isRenderTargetTexture||nt.has(Y)){const yi=nt.get(Y),vi=nt.get(oe);$e.bindFramebuffer(te.READ_FRAMEBUFFER,Rt),$e.bindFramebuffer(te.DRAW_FRAMEBUFFER,gt);for(let hr=0;hr<dt;hr++)wn?te.framebufferTextureLayer(te.READ_FRAMEBUFFER,te.COLOR_ATTACHMENT0,yi.__webglTexture,Ae,Ht+hr):te.framebufferTexture2D(te.READ_FRAMEBUFFER,te.COLOR_ATTACHMENT0,te.TEXTURE_2D,yi.__webglTexture,Ae),ns?te.framebufferTextureLayer(te.DRAW_FRAMEBUFFER,te.COLOR_ATTACHMENT0,vi.__webglTexture,Ne,Kn+hr):te.framebufferTexture2D(te.DRAW_FRAMEBUFFER,te.COLOR_ATTACHMENT0,te.TEXTURE_2D,vi.__webglTexture,Ne),Ae!==0?te.blitFramebuffer(Ft,kt,qe,ft,ln,jt,qe,ft,te.COLOR_BUFFER_BIT,te.NEAREST):ns?te.copyTexSubImage3D(Ki,Ne,ln,jt,Kn+hr,Ft,kt,qe,ft):te.copyTexSubImage2D(Ki,Ne,ln,jt,Ft,kt,qe,ft);$e.bindFramebuffer(te.READ_FRAMEBUFFER,null),$e.bindFramebuffer(te.DRAW_FRAMEBUFFER,null)}else ns?Y.isDataTexture||Y.isData3DTexture?te.texSubImage3D(Ki,Ne,ln,jt,Kn,qe,ft,dt,Yt,Kt,Jt.data):oe.isCompressedArrayTexture?te.compressedTexSubImage3D(Ki,Ne,ln,jt,Kn,qe,ft,dt,Yt,Jt.data):te.texSubImage3D(Ki,Ne,ln,jt,Kn,qe,ft,dt,Yt,Kt,Jt):Y.isDataTexture?te.texSubImage2D(te.TEXTURE_2D,Ne,ln,jt,qe,ft,Yt,Kt,Jt.data):Y.isCompressedTexture?te.compressedTexSubImage2D(te.TEXTURE_2D,Ne,ln,jt,Jt.width,Jt.height,Yt,Jt.data):te.texSubImage2D(te.TEXTURE_2D,Ne,ln,jt,qe,ft,Yt,Kt,Jt);te.pixelStorei(te.UNPACK_ROW_LENGTH,pn),te.pixelStorei(te.UNPACK_IMAGE_HEIGHT,Sn),te.pixelStorei(te.UNPACK_SKIP_PIXELS,Ai),te.pixelStorei(te.UNPACK_SKIP_ROWS,In),te.pixelStorei(te.UNPACK_SKIP_IMAGES,mn),Ne===0&&oe.generateMipmaps&&te.generateMipmap(Ki),$e.unbindTexture()},this.copyTextureToTexture3D=function(Y,oe,me=null,de=null,Ae=0){return GT('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(Y,oe,me,de,Ae)},this.initRenderTarget=function(Y){nt.get(Y).__webglFramebuffer===void 0&&ee.setupRenderTarget(Y)},this.initTexture=function(Y){Y.isCubeTexture?ee.setTextureCube(Y,0):Y.isData3DTexture?ee.setTexture3D(Y,0):Y.isDataArrayTexture||Y.isCompressedArrayTexture?ee.setTexture2DArray(Y,0):ee.setTexture2D(Y,0),$e.unbindTexture()},this.resetState=function(){N=0,U=0,P=null,$e.reset(),St.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ul}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=ri._getDrawingBufferColorSpace(e),t.unpackColorSpace=ri._getUnpackColorSpace()}}const pfe=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:IB,AddEquation:r0,AddOperation:W6,AdditiveAnimationBlendMode:kB,AdditiveBlending:YL,AgXToneMapping:$6,AlphaFormat:OB,AlwaysCompare:f9,AlwaysDepth:T3,AlwaysStencilFunc:qL,AmbientLight:Z9,AnimationAction:cV,AnimationClip:Uv,AnimationLoader:Iae,AnimationMixer:ioe,AnimationObjectGroup:toe,AnimationUtils:Cae,ArcCurve:M9,ArrayCamera:aV,ArrowHelper:Toe,AttachedBindMode:XL,Audio:oV,AudioAnalyser:Kae,AudioContext:dO,AudioListener:zae,AudioLoader:Fae,AxesHelper:woe,BackSide:wr,BasicDepthPacking:V0,BasicShadowMap:w6,BatchedMesh:S9,Bone:hM,BooleanKeyframeTrack:Mg,Box2:hoe,Box3:ca,Box3Helper:_oe,BoxGeometry:wg,BoxHelper:Eoe,BufferAttribute:ci,BufferGeometry:Tn,BufferGeometryLoader:sV,ByteType:eM,Cache:Pf,Camera:zE,CameraHelper:Aoe,CanvasTexture:Qre,CapsuleGeometry:mM,CatmullRomCurve3:C9,CineonToneMapping:q6,CircleGeometry:gM,ClampToEdgeWrapping:sr,Clock:pO,Color:Ut,ColorKeyframeTrack:oO,ColorManagement:ri,CompressedArrayTexture:jre,CompressedCubeTexture:qre,CompressedTexture:pM,CompressedTextureLoader:Bae,ConeGeometry:XE,ConstantAlphaFactor:V6,ConstantColorFactor:G6,Controls:Coe,CubeCamera:b9,CubeReflectionMapping:gh,CubeRefractionMapping:N0,CubeTexture:VE,CubeTextureLoader:Q9,CubeUVReflectionMapping:Wv,CubicBezierCurve:$B,CubicBezierCurve3:R9,CubicInterpolant:W9,CullFaceBack:VL,CullFaceFront:T6,CullFaceFrontBack:lse,CullFaceNone:S6,Curve:eu,CurvePath:L9,CustomBlending:M6,CustomToneMapping:Q6,CylinderGeometry:WE,Cylindrical:uoe,Data3DTexture:lM,DataArrayTexture:GE,DataTexture:Yc,DataTextureLoader:lO,DataUtils:_m,DecrementStencilOp:vse,DecrementWrapStencilOp:bse,DefaultLoadingManager:q9,DepthArrayTexture:$re,DepthFormat:Dv,DepthStencilFormat:fg,DepthTexture:jv,DetachedBindMode:Z6,DirectionalLight:fO,DirectionalLightHelper:boe,DiscreteInterpolant:X9,DodecahedronGeometry:yM,DoubleSide:Da,DstAlphaFactor:N6,DstColorFactor:k6,DynamicCopyUsage:Pse,DynamicDrawUsage:Rse,DynamicReadUsage:Ise,EdgesGeometry:w9,EllipseCurve:vM,EqualCompare:l9,EqualDepth:M3,EqualStencilFunc:Sse,EquirectangularReflectionMapping:Mv,EquirectangularRefractionMapping:qA,Euler:il,EventDispatcher:sl,ExtrudeGeometry:xM,FileLoader:ua,Float16BufferAttribute:Mre,Float32BufferAttribute:Qt,FloatType:ps,Fog:uM,FogExp2:cM,FramebufferTexture:Xre,FrontSide:qc,Frustum:Xv,FrustumArray:fM,GLBufferAttribute:coe,GLSL1:Use,GLSL3:QL,GreaterCompare:c9,GreaterDepth:R3,GreaterEqualCompare:h9,GreaterEqualDepth:C3,GreaterEqualStencilFunc:Cse,GreaterStencilFunc:wse,GridHelper:voe,Group:Of,HalfFloatType:yr,HemisphereLight:J9,HemisphereLightHelper:yoe,IcosahedronGeometry:jE,ImageBitmapLoader:rV,ImageLoader:sE,ImageUtils:g9,IncrementStencilOp:yse,IncrementWrapStencilOp:xse,InstancedBufferAttribute:pg,InstancedBufferGeometry:iV,InstancedInterleavedBuffer:loe,InstancedMesh:XB,Int16BufferAttribute:Tre,Int32BufferAttribute:wre,Int8BufferAttribute:Ere,IntType:kE,InterleavedBuffer:YE,InterleavedBufferAttribute:k0,Interpolant:Qv,InterpolateDiscrete:Lv,InterpolateLinear:Iv,InterpolateSmooth:HT,InterpolationSamplingMode:Hse,InterpolationSamplingType:Fse,InvertStencilOp:Ase,KeepStencilOp:am,KeyframeTrack:zl,LOD:_9,LatheGeometry:bM,Layers:Ov,LessCompare:o9,LessDepth:w3,LessEqualCompare:HB,LessEqualDepth:ug,LessEqualStencilFunc:Tse,LessStencilFunc:_se,Light:X0,LightProbe:nV,Line:Yf,Line3:foe,LineBasicMaterial:Oa,LineCurve:JB,LineCurve3:D9,LineDashedMaterial:V9,LineLoop:jB,LineSegments:Zc,LinearFilter:ei,LinearInterpolant:aO,LinearMipMapLinearFilter:jL,LinearMipMapNearestFilter:hse,LinearMipmapLinearFilter:Nl,LinearMipmapNearestFilter:Ty,LinearSRGBColorSpace:nl,LinearToneMapping:X6,LinearTransfer:$A,Loader:ha,LoaderUtils:R0,LoadingManager:MM,LoopOnce:e9,LoopPingPong:n9,LoopRepeat:t9,MOUSE:sm,Material:ur,MaterialLoader:CM,MathUtils:d9,Matrix2:vO,Matrix3:Bn,Matrix4:hn,MaxEquation:L6,Mesh:ms,MeshBasicMaterial:Co,MeshDepthMaterial:iO,MeshDistanceMaterial:sO,MeshLambertMaterial:G9,MeshMatcapMaterial:z9,MeshNormalMaterial:nO,MeshPhongMaterial:F9,MeshPhysicalMaterial:Gl,MeshStandardMaterial:qv,MeshToonMaterial:H9,MinEquation:D6,MirroredRepeatWrapping:Cv,MixOperation:K6,MultiplyBlending:WL,MultiplyOperation:UE,NearestFilter:Ws,NearestMipMapLinearFilter:use,NearestMipMapNearestFilter:cse,NearestMipmapLinearFilter:bm,NearestMipmapNearestFilter:Zw,NeutralToneMapping:J6,NeverCompare:a9,NeverDepth:S3,NeverStencilFunc:Ese,NoBlending:la,NoColorSpace:Hc,NoToneMapping:Vc,NormalAnimationBlendMode:aM,NormalBlending:Jm,NotEqualCompare:u9,NotEqualDepth:D3,NotEqualStencilFunc:Mse,NumberKeyframeTrack:gg,Object3D:li,ObjectLoader:Uae,ObjectSpaceNormalMap:r9,OctahedronGeometry:qE,OneFactor:B6,OneMinusConstantAlphaFactor:Y6,OneMinusConstantColorFactor:z6,OneMinusDstAlphaFactor:U6,OneMinusDstColorFactor:F6,OneMinusSrcAlphaFactor:_3,OneMinusSrcColorFactor:P6,OrthographicCamera:fh,PCFShadowMap:Jw,PCFSoftShadowMap:uA,PMREMGenerator:sI,Path:ow,PerspectiveCamera:Ds,Plane:mf,PlaneGeometry:W0,PlaneHelper:Soe,PointLight:hO,PointLightHelper:moe,Points:qB,PointsMaterial:dM,PolarGridHelper:xoe,PolyhedronGeometry:K0,PositionalAudio:Yae,PropertyBinding:di,PropertyMixer:lV,QuadraticBezierCurve:ZB,QuadraticBezierCurve3:eO,Quaternion:Yr,QuaternionKeyframeTrack:yg,QuaternionLinearInterpolant:j9,RED_GREEN_RGTC2_Format:tw,RED_RGTC1_Format:UB,REVISION:Sg,RGBADepthPacking:s9,RGBAFormat:rr,RGBAIntegerFormat:rM,RGBA_ASTC_10x10_Format:q3,RGBA_ASTC_10x5_Format:W3,RGBA_ASTC_10x6_Format:X3,RGBA_ASTC_10x8_Format:j3,RGBA_ASTC_12x10_Format:Q3,RGBA_ASTC_12x12_Format:$3,RGBA_ASTC_4x4_Format:k3,RGBA_ASTC_5x4_Format:F3,RGBA_ASTC_5x5_Format:H3,RGBA_ASTC_6x5_Format:G3,RGBA_ASTC_6x6_Format:z3,RGBA_ASTC_8x5_Format:V3,RGBA_ASTC_8x6_Format:Y3,RGBA_ASTC_8x8_Format:K3,RGBA_BPTC_Format:mA,RGBA_ETC2_EAC_Format:U3,RGBA_PVRTC_2BPPV1_Format:O3,RGBA_PVRTC_4BPPV1_Format:B3,RGBA_S3TC_DXT1_Format:fA,RGBA_S3TC_DXT3_Format:dA,RGBA_S3TC_DXT5_Format:pA,RGBDepthPacking:dse,RGBFormat:PB,RGBIntegerFormat:fse,RGB_BPTC_SIGNED_Format:J3,RGB_BPTC_UNSIGNED_Format:Z3,RGB_ETC1_Format:P3,RGB_ETC2_Format:N3,RGB_PVRTC_2BPPV1_Format:I3,RGB_PVRTC_4BPPV1_Format:L3,RGB_S3TC_DXT1_Format:hA,RGDepthPacking:pse,RGFormat:NB,RGIntegerFormat:sM,RawShaderMaterial:k9,Ray:Tg,Raycaster:yO,RectAreaLight:eV,RedFormat:FE,RedIntegerFormat:HE,ReinhardToneMapping:j6,RenderTarget:oM,RenderTarget3D:soe,RenderTargetArray:roe,RepeatWrapping:U0,ReplaceStencilOp:gse,ReverseSubtractEquation:R6,RingGeometry:AM,SIGNED_RED_GREEN_RGTC2_Format:nw,SIGNED_RED_RGTC1_Format:ew,SRGBColorSpace:bi,SRGBTransfer:Hi,Scene:dg,ShaderChunk:Fn,ShaderLib:Uc,ShaderMaterial:js,ShadowMaterial:U9,Shape:eg,ShapeGeometry:EM,ShapePath:Moe,ShapeUtils:Gc,ShortType:tM,Skeleton:KE,SkeletonHelper:poe,SkinnedMesh:WB,Source:_0,Sphere:Kr,SphereGeometry:QE,Spherical:nI,SphericalHarmonics3:tV,SplineCurve:tO,SpotLight:uO,SpotLightHelper:doe,Sprite:E9,SpriteMaterial:KB,SrcAlphaFactor:E3,SrcAlphaSaturateFactor:H6,SrcColorFactor:O6,StaticCopyUsage:Ose,StaticDrawUsage:JA,StaticReadUsage:Lse,StereoCamera:Hae,StreamCopyUsage:Nse,StreamDrawUsage:Dse,StreamReadUsage:Bse,StringKeyframeTrack:Cg,SubtractEquation:C6,SubtractiveBlending:KL,TOUCH:rm,TangentSpaceNormalMap:Y0,TetrahedronGeometry:_M,Texture:wi,TextureLoader:$9,TextureUtils:Boe,TimestampQuery:kse,TorusGeometry:SM,TorusKnotGeometry:TM,Triangle:wo,TriangleFanDrawMode:iw,TriangleStripDrawMode:FB,TrianglesDrawMode:i9,TubeGeometry:wM,UVMapping:P0,Uint16BufferAttribute:zB,Uint32BufferAttribute:VB,Uint8BufferAttribute:_re,Uint8ClampedBufferAttribute:Sre,Uniform:xi,UniformsGroup:ooe,UniformsLib:zt,UniformsUtils:x9,UnsignedByteType:Xs,UnsignedInt248Type:hg,UnsignedInt5999Type:BB,UnsignedIntType:Qc,UnsignedShort4444Type:nM,UnsignedShort5551Type:iM,UnsignedShortType:Rv,VSMShadowMap:Lc,Vector2:Qe,Vector3:se,Vector4:ai,VectorKeyframeTrack:vg,VideoFrameTexture:Wre,VideoTexture:T9,WebGL3DRenderTarget:hre,WebGLArrayRenderTarget:ure,WebGLCoordinateSystem:Ul,WebGLCubeRenderTarget:YB,WebGLRenderTarget:Os,WebGLRenderer:bO,WebGLUtils:gV,WebGPUCoordinateSystem:ZA,WebXRController:zT,WireframeGeometry:N9,WrapAroundEnding:QA,ZeroCurvatureEnding:Am,ZeroFactor:I6,ZeroSlopeEnding:Em,ZeroStencilOp:mse,createCanvasElement:m9},Symbol.toStringTag,{value:"Module"}));var sD={exports:{}},nf={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A4;function mfe(){return A4||(A4=1,nf.ConcurrentRoot=1,nf.ContinuousEventPriority=8,nf.DefaultEventPriority=32,nf.DiscreteEventPriority=2,nf.IdleEventPriority=268435456,nf.LegacyRoot=0,nf.NoEventPriority=0),nf}var E4;function gfe(){return E4||(E4=1,sD.exports=mfe()),sD.exports}var YT=gfe(),rD={exports:{}},aD={},oD={exports:{}},lD={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _4;function yfe(){if(_4)return lD;_4=1;var i=Vv();function e(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var t=typeof Object.is=="function"?Object.is:e,n=i.useState,s=i.useEffect,r=i.useLayoutEffect,a=i.useDebugValue;function o(d,m){var y=m(),x=n({inst:{value:y,getSnapshot:m}}),_=x[0].inst,b=x[1];return r(function(){_.value=y,_.getSnapshot=m,l(_)&&b({inst:_})},[d,y,m]),s(function(){return l(_)&&b({inst:_}),d(function(){l(_)&&b({inst:_})})},[d]),a(y),y}function l(d){var m=d.getSnapshot;d=d.value;try{var y=m();return!t(d,y)}catch{return!0}}function c(d,m){return m()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return lD.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:h,lD}var S4;function vfe(){return S4||(S4=1,oD.exports=yfe()),oD.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T4;function xfe(){if(T4)return aD;T4=1;var i=Vv(),e=vfe();function t(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var n=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,r=i.useRef,a=i.useEffect,o=i.useMemo,l=i.useDebugValue;return aD.useSyncExternalStoreWithSelector=function(c,h,d,m,y){var x=r(null);if(x.current===null){var _={hasValue:!1,value:null};x.current=_}else _=x.current;x=o(function(){function A(N){if(!T){if(T=!0,w=N,N=m(N),y!==void 0&&_.hasValue){var U=_.value;if(y(U,N))return R=U}return R=N}if(U=R,n(w,N))return U;var P=m(N);return y!==void 0&&y(U,P)?(w=N,U):(w=N,R=P)}var T=!1,w,R,O=d===void 0?null:d;return[function(){return A(h())},O===null?void 0:function(){return A(O())}]},[h,d,m,y]);var b=s(c,x[0],x[1]);return a(function(){_.hasValue=!0,_.value=b},[b]),l(b),b},aD}var w4;function bfe(){return w4||(w4=1,rD.exports=xfe()),rD.exports}var Afe=bfe();const Efe=II(Afe),M4=i=>{let e;const t=new Set,n=(c,h)=>{const d=typeof c=="function"?c(e):c;if(!Object.is(d,e)){const m=e;e=h??(typeof d!="object"||d===null)?d:Object.assign({},e,d),t.forEach(y=>y(e,m))}},s=()=>e,o={setState:n,getState:s,getInitialState:()=>l,subscribe:c=>(t.add(c),()=>t.delete(c))},l=e=i(n,s,o);return o},_fe=i=>i?M4(i):M4,{useSyncExternalStoreWithSelector:Sfe}=Efe,Tfe=i=>i;function wfe(i,e=Tfe,t){const n=Sfe(i.subscribe,i.getState,i.getInitialState,e,t);return mv.useDebugValue(n),n}const C4=(i,e)=>{const t=_fe(i),n=(s,r=e)=>wfe(t,s,r);return Object.assign(n,t),n},yV=(i,e)=>i?C4(i,e):C4;var cD={exports:{}},uD={exports:{}};/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R4;function Mfe(){return R4||(R4=1,function(i){i.exports=function(e){function t(p,g,S,C){return new M1(p,g,S,C)}function n(){}function s(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)g+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(p){return p===null||typeof p!="object"?null:(p=Mi&&p[Mi]||p["@@iterator"],typeof p=="function"?p:null)}function a(p){if(p==null)return null;if(typeof p=="function")return p.$$typeof===Us?null:p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case gu:return"Fragment";case ul:return"Portal";case yu:return"Profiler";case Lh:return"StrictMode";case rc:return"Suspense";case Ep:return"SuspenseList"}if(typeof p=="object")switch(p.$$typeof){case vu:return(p.displayName||"Context")+".Provider";case wx:return(p._context.displayName||"Context")+".Consumer";case Zg:var g=p.render;return p=p.displayName,p||(p=g.displayName||g.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case dd:return g=p.displayName||null,g!==null?g:a(p.type)||"Memo";case ac:g=p._payload,p=p._init;try{return a(p(g))}catch{}}return null}function o(p){if(xu===void 0)try{throw Error()}catch(S){var g=S.stack.trim().match(/\n( *(at )?)/);xu=g&&g[1]||"",bu=-1<S.stack.indexOf(`
    at`)?" (<anonymous>)":-1<S.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xu+p+bu}function l(p,g){if(!p||pd)return"";pd=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var C={DetermineComponentFrameRoot:function(){try{if(g){var Gt=function(){throw Error()};if(Object.defineProperty(Gt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Gt,[])}catch(En){var Tt=En}Reflect.construct(p,[],Gt)}else{try{Gt.call()}catch(En){Tt=En}p.call(Gt.prototype)}}else{try{throw Error()}catch(En){Tt=En}(Gt=p())&&typeof Gt.catch=="function"&&Gt.catch(function(){})}}catch(En){if(En&&Tt&&typeof En.stack=="string")return[En.stack,Tt.stack]}return[null,null]}};C.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var I=Object.getOwnPropertyDescriptor(C.DetermineComponentFrameRoot,"name");I&&I.configurable&&Object.defineProperty(C.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=C.DetermineComponentFrameRoot(),$=k[0],ye=k[1];if($&&ye){var Ie=$.split(`
`),lt=ye.split(`
`);for(I=C=0;C<Ie.length&&!Ie[C].includes("DetermineComponentFrameRoot");)C++;for(;I<lt.length&&!lt[I].includes("DetermineComponentFrameRoot");)I++;if(C===Ie.length||I===lt.length)for(C=Ie.length-1,I=lt.length-1;1<=C&&0<=I&&Ie[C]!==lt[I];)I--;for(;1<=C&&0<=I;C--,I--)if(Ie[C]!==lt[I]){if(C!==1||I!==1)do if(C--,I--,0>I||Ie[C]!==lt[I]){var Lt=`
`+Ie[C].replace(" at new "," at ");return p.displayName&&Lt.includes("<anonymous>")&&(Lt=Lt.replace("<anonymous>",p.displayName)),Lt}while(1<=C&&0<=I);break}}}finally{pd=!1,Error.prepareStackTrace=S}return(S=p?p.displayName||p.name:"")?o(S):""}function c(p){switch(p.tag){case 26:case 27:case 5:return o(p.type);case 16:return o("Lazy");case 13:return o("Suspense");case 19:return o("SuspenseList");case 0:case 15:return p=l(p.type,!1),p;case 11:return p=l(p.type.render,!1),p;case 1:return p=l(p.type,!0),p;default:return""}}function h(p){try{var g="";do g+=c(p),p=p.return;while(p);return g}catch(S){return`
Error generating stack: `+S.message+`
`+S.stack}}function d(p){var g=p,S=p;if(p.alternate)for(;g.return;)g=g.return;else{p=g;do g=p,(g.flags&4098)!==0&&(S=g.return),p=g.return;while(p)}return g.tag===3?S:null}function m(p){if(d(p)!==p)throw Error(s(188))}function y(p){var g=p.alternate;if(!g){if(g=d(p),g===null)throw Error(s(188));return g!==p?null:p}for(var S=p,C=g;;){var I=S.return;if(I===null)break;var k=I.alternate;if(k===null){if(C=I.return,C!==null){S=C;continue}break}if(I.child===k.child){for(k=I.child;k;){if(k===S)return m(I),p;if(k===C)return m(I),g;k=k.sibling}throw Error(s(188))}if(S.return!==C.return)S=I,C=k;else{for(var $=!1,ye=I.child;ye;){if(ye===S){$=!0,S=I,C=k;break}if(ye===C){$=!0,C=I,S=k;break}ye=ye.sibling}if(!$){for(ye=k.child;ye;){if(ye===S){$=!0,S=k,C=I;break}if(ye===C){$=!0,C=k,S=I;break}ye=ye.sibling}if(!$)throw Error(s(189))}}if(S.alternate!==C)throw Error(s(190))}if(S.tag!==3)throw Error(s(188));return S.stateNode.current===S?p:g}function x(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p;for(p=p.child;p!==null;){if(g=x(p),g!==null)return g;p=p.sibling}return null}function _(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p;for(p=p.child;p!==null;){if(p.tag!==4&&(g=_(p),g!==null))return g;p=p.sibling}return null}function b(p){return{current:p}}function A(p){0>Su||(p.current=f2[Su],f2[Su]=null,Su--)}function T(p,g){Su++,f2[Su]=p.current,p.current=g}function w(p){return p>>>=0,p===0?32:31-(Qx(p)/jM|0)|0}function R(p){var g=p&42;if(g!==0)return g;switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return p&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return p}}function O(p,g){var S=p.pendingLanes;if(S===0)return 0;var C=0,I=p.suspendedLanes,k=p.pingedLanes,$=p.warmLanes;p=p.finishedLanes!==0;var ye=S&134217727;return ye!==0?(S=ye&~I,S!==0?C=R(S):(k&=ye,k!==0?C=R(k):p||($=ye&~$,$!==0&&(C=R($))))):(ye=S&~I,ye!==0?C=R(ye):k!==0?C=R(k):p||($=S&~$,$!==0&&(C=R($)))),C===0?0:g!==0&&g!==C&&(g&I)===0&&(I=C&-C,$=g&-g,I>=$||I===32&&($&4194176)!==0)?g:C}function N(p,g){return(p.pendingLanes&~(p.suspendedLanes&~p.pingedLanes)&g)===0}function U(p,g){switch(p){case 1:case 2:case 4:case 8:return g+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function P(){var p=wp;return wp<<=1,(wp&4194176)===0&&(wp=128),p}function B(){var p=xd;return xd<<=1,(xd&62914560)===0&&(xd=4194304),p}function L(p){for(var g=[],S=0;31>S;S++)g.push(p);return g}function F(p,g){p.pendingLanes|=g,g!==268435456&&(p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0)}function j(p,g,S,C,I,k){var $=p.pendingLanes;p.pendingLanes=S,p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0,p.expiredLanes&=S,p.entangledLanes&=S,p.errorRecoveryDisabledLanes&=S,p.shellSuspendCounter=0;var ye=p.entanglements,Ie=p.expirationTimes,lt=p.hiddenUpdates;for(S=$&~S;0<S;){var Lt=31-Es(S),Gt=1<<Lt;ye[Lt]=0,Ie[Lt]=-1;var Tt=lt[Lt];if(Tt!==null)for(lt[Lt]=null,Lt=0;Lt<Tt.length;Lt++){var En=Tt[Lt];En!==null&&(En.lane&=-536870913)}S&=~Gt}C!==0&&J(p,C,0),k!==0&&I===0&&p.tag!==0&&(p.suspendedLanes|=k&~($&~g))}function J(p,g,S){p.pendingLanes|=g,p.suspendedLanes&=~g;var C=31-Es(g);p.entangledLanes|=g,p.entanglements[C]=p.entanglements[C]|1073741824|S&4194218}function re(p,g){var S=p.entangledLanes|=g;for(p=p.entanglements;S;){var C=31-Es(S),I=1<<C;I&g|p[C]&g&&(p[C]|=g),S&=~I}}function q(p){return p&=-p,2<p?8<p?(p&134217727)!==0?32:268435456:8:2}function W(p){if(ks&&typeof ks.onCommitFiberRoot=="function")try{ks.onCommitFiberRoot(Ad,p,void 0,(p.current.flags&128)===128)}catch{}}function ne(p){if(typeof Lr=="function"&&p2(p),ks&&typeof ks.setStrictMode=="function")try{ks.setStrictMode(Ad,p)}catch{}}function ie(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}function ue(p,g){if(typeof p=="object"&&p!==null){var S=m2.get(p);return S!==void 0?S:(g={value:p,source:g,stack:h(g)},m2.set(p,g),g)}return{value:p,source:g,stack:h(g)}}function z(p,g){Fa[Ha++]=Ed,Fa[Ha++]=wu,wu=p,Ed=g}function ae(p,g,S){xa[Ir++]=pl,xa[Ir++]=ml,xa[Ir++]=Uo,Uo=p;var C=pl;p=ml;var I=32-Es(C)-1;C&=~(1<<I),S+=1;var k=32-Es(g)+I;if(30<k){var $=I-I%5;k=(C&(1<<$)-1).toString(32),C>>=$,I-=$,pl=1<<32-Es(g)+I|S<<I|C,ml=k+p}else pl=1<<k|S<<I|C,ml=p}function ge(p){p.return!==null&&(z(p,1),ae(p,1,0))}function Ee(p){for(;p===wu;)wu=Fa[--Ha],Fa[Ha]=null,Ed=Fa[--Ha],Fa[Ha]=null;for(;p===Uo;)Uo=xa[--Ir],xa[Ir]=null,ml=xa[--Ir],xa[Ir]=null,pl=xa[--Ir],xa[Ir]=null}function le(p,g){T(hc,g),T(ao,p),T(_s,null),p=Mx(g),A(_s),T(_s,p)}function Ce(){A(_s),A(ao),A(hc)}function Me(p){p.memoizedState!==null&&T(Cp,p);var g=_s.current,S=C1(g,p.type);g!==S&&(T(ao,p),T(_s,S))}function Ze(p){ao.current===p&&(A(_s),A(ao)),Cp.current===p&&(A(Cp),Oo?lc._currentValue=Bh:lc._currentValue2=Bh)}function tt(p){var g=Error(s(418,""));throw Ot(ue(g,p)),Rp}function Mt(p,g){if(!va)throw Error(s(175));Nh(p.stateNode,p.type,p.memoizedProps,g,p)||tt(p)}function bt(p){for(Ss=p.return;Ss;)switch(Ss.tag){case 3:case 27:ko=!0;return;case 5:case 13:ko=!1;return;default:Ss=Ss.return}}function cn(p){if(!va||p!==Ss)return!1;if(!ii)return bt(p),ii=!0,!1;var g=!1;if(dr?p.tag!==3&&p.tag!==27&&(p.tag!==5||Hx(p.type)&&!_r(p.type,p.memoizedProps))&&(g=!0):p.tag!==3&&(p.tag!==5||Hx(p.type)&&!_r(p.type,p.memoizedProps))&&(g=!0),g&&Li&&tt(p),bt(p),p.tag===13){if(!va)throw Error(s(316));if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(s(317));Li=a_(p)}else Li=Ss?_u(p.stateNode):null;return!0}function tn(){va&&(Li=Ss=null,ii=!1)}function Ot(p){oo===null?oo=[p]:oo.push(p)}function te(){for(var p=fc,g=Fo=fc=0;g<p;){var S=ba[g];ba[g++]=null;var C=ba[g];ba[g++]=null;var I=ba[g];ba[g++]=null;var k=ba[g];if(ba[g++]=null,C!==null&&I!==null){var $=C.pending;$===null?I.next=I:(I.next=$.next,$.next=I),C.pending=I}k!==0&&$e(S,I,k)}}function At(p,g,S,C){ba[fc++]=p,ba[fc++]=g,ba[fc++]=S,ba[fc++]=C,Fo|=C,p.lanes|=C,p=p.alternate,p!==null&&(p.lanes|=C)}function Ve(p,g,S,C){return At(p,g,S,C),Pt(p)}function st(p,g){return At(p,null,null,g),Pt(p)}function $e(p,g,S){p.lanes|=S;var C=p.alternate;C!==null&&(C.lanes|=S);for(var I=!1,k=p.return;k!==null;)k.childLanes|=S,C=k.alternate,C!==null&&(C.childLanes|=S),k.tag===22&&(p=k.stateNode,p===null||p._visibility&1||(I=!0)),p=k,k=k.return;I&&g!==null&&p.tag===3&&(k=p.stateNode,I=31-Es(S),k=k.hiddenUpdates,p=k[I],p===null?k[I]=[g]:p.push(g),g.lane=S|536870912)}function Pt(p){if(50<Yh)throw Yh=0,tb=null,Error(s(185));for(var g=p.return;g!==null;)p=g,g=p.return;return p.tag===3?p.stateNode:null}function nt(p){p!==Mu&&p.next===null&&(Mu===null?Ji=Mu=p:Mu=Mu.next=p),Ts=!0,g2||(g2=!0,We(X))}function ee(p,g){if(!y2&&Ts){y2=!0;do for(var S=!1,C=Ji;C!==null;){if(p!==0){var I=C.pendingLanes;if(I===0)var k=0;else{var $=C.suspendedLanes,ye=C.pingedLanes;k=(1<<31-Es(42|p)+1)-1,k&=I&~($&~ye),k=k&201326677?k&201326677|1:k?k|2:0}k!==0&&(S=!0,ut(C,k))}else k=jn,k=O(C,C===Bi?k:0),(k&3)===0||N(C,k)||(S=!0,ut(C,k));C=C.next}while(S);y2=!1}}function X(){Ts=g2=!1;var p=0;_d!==0&&(I1()&&(p=_d),_d=0);for(var g=ka(),S=null,C=Ji;C!==null;){var I=C.next,k=we(C,g);k===0?(C.next=null,S===null?Ji=I:S.next=I,I===null&&(Mu=S)):(S=C,(p!==0||(k&3)!==0)&&(Ts=!0)),C=I}ee(p)}function we(p,g){for(var S=p.suspendedLanes,C=p.pingedLanes,I=p.expirationTimes,k=p.pendingLanes&-62914561;0<k;){var $=31-Es(k),ye=1<<$,Ie=I[$];Ie===-1?((ye&S)===0||(ye&C)!==0)&&(I[$]=U(ye,g)):Ie<=g&&(p.expiredLanes|=ye),k&=~ye}if(g=Bi,S=jn,S=O(p,p===g?S:0),C=p.callbackNode,S===0||p===g&&Ci===2||p.cancelPendingCommit!==null)return C!==null&&C!==null&&No(C),p.callbackNode=null,p.callbackPriority=0;if((S&3)===0||N(p,S)){if(g=S&-S,g===p.callbackPriority)return g;switch(C!==null&&No(C),q(S)){case 2:case 8:S=Mp;break;case 32:S=bd;break;case 268435456:S=kh;break;default:S=bd}return C=Fe.bind(null,p),S=dl(S,C),p.callbackPriority=g,p.callbackNode=S,g}return C!==null&&C!==null&&No(C),p.callbackPriority=2,p.callbackNode=null,2}function Fe(p,g){var S=p.callbackNode;if(fu()&&p.callbackNode!==S)return null;var C=jn;return C=O(p,p===Bi?C:0),C===0?null:(Pa(p,C,g),we(p,ka()),p.callbackNode!=null&&p.callbackNode===S?Fe.bind(null,p):null)}function ut(p,g){if(fu())return null;Pa(p,g,!0)}function We(p){N1?U1(function(){(Xn&6)!==0?dl(d2,p):p()}):dl(d2,p)}function ot(){return _d===0&&(_d=P()),_d}function et(p,g){if(Sd===null){var S=Sd=[];v2=0,Zi=ot(),pr={status:"pending",value:void 0,then:function(C){S.push(C)}}}return v2++,g.then(pt,pt),g}function pt(){if(--v2===0&&Sd!==null){pr!==null&&(pr.status="fulfilled");var p=Sd;Sd=null,Zi=0,pr=null;for(var g=0;g<p.length;g++)(0,p[g])()}}function vt(p,g){var S=[],C={status:"pending",value:null,reason:null,then:function(I){S.push(I)}};return p.then(function(){C.status="fulfilled",C.value=g;for(var I=0;I<S.length;I++)(0,S[I])(g)},function(I){for(C.status="rejected",C.reason=I,I=0;I<S.length;I++)(0,S[I])(void 0)}),C}function it(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ct(p,g){p=p.updateQueue,g.updateQueue===p&&(g.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,callbacks:null})}function Et(p){return{lane:p,tag:0,payload:null,callback:null,next:null}}function Dt(p,g,S){var C=p.updateQueue;if(C===null)return null;if(C=C.shared,(Xn&2)!==0){var I=C.pending;return I===null?g.next=g:(g.next=I.next,I.next=g),C.pending=g,g=Pt(p),$e(p,null,S),g}return At(p,C,g,S),Pt(p)}function Nt(p,g,S){if(g=g.updateQueue,g!==null&&(g=g.shared,(S&4194176)!==0)){var C=g.lanes;C&=p.pendingLanes,S|=C,g.lanes=S,re(p,S)}}function ve(p,g){var S=p.updateQueue,C=p.alternate;if(C!==null&&(C=C.updateQueue,S===C)){var I=null,k=null;if(S=S.firstBaseUpdate,S!==null){do{var $={lane:S.lane,tag:S.tag,payload:S.payload,callback:null,next:null};k===null?I=k=$:k=k.next=$,S=S.next}while(S!==null);k===null?I=k=g:k=k.next=g}else I=k=g;S={baseState:C.baseState,firstBaseUpdate:I,lastBaseUpdate:k,shared:C.shared,callbacks:C.callbacks},p.updateQueue=S;return}p=S.lastBaseUpdate,p===null?S.firstBaseUpdate=g:p.next=g,S.lastBaseUpdate=g}function He(){if(x2){var p=pr;if(p!==null)throw p}}function St(p,g,S,C){x2=!1;var I=p.updateQueue;Br=!1;var k=I.firstBaseUpdate,$=I.lastBaseUpdate,ye=I.shared.pending;if(ye!==null){I.shared.pending=null;var Ie=ye,lt=Ie.next;Ie.next=null,$===null?k=lt:$.next=lt,$=Ie;var Lt=p.alternate;Lt!==null&&(Lt=Lt.updateQueue,ye=Lt.lastBaseUpdate,ye!==$&&(ye===null?Lt.firstBaseUpdate=lt:ye.next=lt,Lt.lastBaseUpdate=Ie))}if(k!==null){var Gt=I.baseState;$=0,Lt=lt=Ie=null,ye=k;do{var Tt=ye.lane&-536870913,En=Tt!==ye.lane;if(En?(jn&Tt)===Tt:(C&Tt)===Tt){Tt!==0&&Tt===Zi&&(x2=!0),Lt!==null&&(Lt=Lt.next={lane:0,tag:ye.tag,payload:ye.payload,callback:null,next:null});e:{var go=p,Dd=ye;Tt=g;var Kh=S;switch(Dd.tag){case 1:if(go=Dd.payload,typeof go=="function"){Gt=go.call(Kh,Gt,Tt);break e}Gt=go;break e;case 3:go.flags=go.flags&-65537|128;case 0:if(go=Dd.payload,Tt=typeof go=="function"?go.call(Kh,Gt,Tt):go,Tt==null)break e;Gt=bs({},Gt,Tt);break e;case 2:Br=!0}}Tt=ye.callback,Tt!==null&&(p.flags|=64,En&&(p.flags|=8192),En=I.callbacks,En===null?I.callbacks=[Tt]:En.push(Tt))}else En={lane:Tt,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null},Lt===null?(lt=Lt=En,Ie=Gt):Lt=Lt.next=En,$|=Tt;if(ye=ye.next,ye===null){if(ye=I.shared.pending,ye===null)break;En=ye,ye=En.next,En.next=null,I.lastBaseUpdate=En,I.shared.pending=null}}while(!0);Lt===null&&(Ie=Gt),I.baseState=Ie,I.firstBaseUpdate=lt,I.lastBaseUpdate=Lt,k===null&&(I.shared.lanes=0),po|=$,p.lanes=$,p.memoizedState=Gt}}function xe(p,g){if(typeof p!="function")throw Error(s(191,p));p.call(g)}function Oe(p,g){var S=p.callbacks;if(S!==null)for(p.callbacks=null,p=0;p<S.length;p++)xe(S[p],g)}function Ge(p,g){if($r(p,g))return!0;if(typeof p!="object"||p===null||typeof g!="object"||g===null)return!1;var S=Object.keys(p),C=Object.keys(g);if(S.length!==C.length)return!1;for(C=0;C<S.length;C++){var I=S[C];if(!p_.call(g,I)||!$r(p[I],g[I]))return!1}return!0}function rt(p){return p=p.status,p==="fulfilled"||p==="rejected"}function It(){}function Bt(p,g,S){switch(S=p[S],S===void 0?p.push(g):S!==g&&(g.then(It,It),g=S),g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,p===Dp?Error(s(483)):p;default:if(typeof g.status=="string")g.then(It,It);else{if(p=Bi,p!==null&&100<p.shellSuspendCounter)throw Error(s(482));p=g,p.status="pending",p.then(function(C){if(g.status==="pending"){var I=g;I.status="fulfilled",I.value=C}},function(C){if(g.status==="pending"){var I=g;I.status="rejected",I.reason=C}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,p===Dp?Error(s(483)):p}throw Or=g,Dp}}function $t(){if(Or===null)throw Error(s(459));var p=Or;return Or=null,p}function Pn(p){var g=Pr;return Pr+=1,Fh===null&&(Fh=[]),Bt(Fh,p,g)}function gi(p,g){g=g.props.ref,p.ref=g!==void 0?g:null}function _n(p,g){throw g.$$typeof===Tx?Error(s(525)):(p=Object.prototype.toString.call(g),Error(s(31,p==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":p)))}function ts(p){var g=p._init;return g(p._payload)}function cs(p){function g(ke,De){if(p){var Ke=ke.deletions;Ke===null?(ke.deletions=[De],ke.flags|=16):Ke.push(De)}}function S(ke,De){if(!p)return null;for(;De!==null;)g(ke,De),De=De.sibling;return null}function C(ke){for(var De=new Map;ke!==null;)ke.key!==null?De.set(ke.key,ke):De.set(ke.index,ke),ke=ke.sibling;return De}function I(ke,De){return ke=nc(ke,De),ke.index=0,ke.sibling=null,ke}function k(ke,De,Ke){return ke.index=Ke,p?(Ke=ke.alternate,Ke!==null?(Ke=Ke.index,Ke<De?(ke.flags|=33554434,De):Ke):(ke.flags|=33554434,De)):(ke.flags|=1048576,De)}function $(ke){return p&&ke.alternate===null&&(ke.flags|=33554434),ke}function ye(ke,De,Ke,_t){return De===null||De.tag!==6?(De=Ap(Ke,ke.mode,_t),De.return=ke,De):(De=I(De,Ke),De.return=ke,De)}function Ie(ke,De,Ke,_t){var rn=Ke.type;return rn===gu?Lt(ke,De,Ke.props.children,_t,Ke.key):De!==null&&(De.elementType===rn||typeof rn=="object"&&rn!==null&&rn.$$typeof===ac&&ts(rn)===De.type)?(De=I(De,Ke.props),gi(De,Ke),De.return=ke,De):(De=Dh(Ke.type,Ke.key,Ke.props,null,ke.mode,_t),gi(De,Ke),De.return=ke,De)}function lt(ke,De,Ke,_t){return De===null||De.tag!==4||De.stateNode.containerInfo!==Ke.containerInfo||De.stateNode.implementation!==Ke.implementation?(De=ya(Ke,ke.mode,_t),De.return=ke,De):(De=I(De,Ke.children||[]),De.return=ke,De)}function Lt(ke,De,Ke,_t,rn){return De===null||De.tag!==7?(De=pu(Ke,ke.mode,_t,rn),De.return=ke,De):(De=I(De,Ke),De.return=ke,De)}function Gt(ke,De,Ke){if(typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint")return De=Ap(""+De,ke.mode,Ke),De.return=ke,De;if(typeof De=="object"&&De!==null){switch(De.$$typeof){case mu:return Ke=Dh(De.type,De.key,De.props,null,ke.mode,Ke),gi(Ke,De),Ke.return=ke,Ke;case ul:return De=ya(De,ke.mode,Ke),De.return=ke,De;case ac:var _t=De._init;return De=_t(De._payload),Gt(ke,De,Ke)}if(Au(De)||r(De))return De=pu(De,ke.mode,Ke,null),De.return=ke,De;if(typeof De.then=="function")return Gt(ke,Pn(De),Ke);if(De.$$typeof===vu)return Gt(ke,rp(ke,De),Ke);_n(ke,De)}return null}function Tt(ke,De,Ke,_t){var rn=De!==null?De.key:null;if(typeof Ke=="string"&&Ke!==""||typeof Ke=="number"||typeof Ke=="bigint")return rn!==null?null:ye(ke,De,""+Ke,_t);if(typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case mu:return Ke.key===rn?Ie(ke,De,Ke,_t):null;case ul:return Ke.key===rn?lt(ke,De,Ke,_t):null;case ac:return rn=Ke._init,Ke=rn(Ke._payload),Tt(ke,De,Ke,_t)}if(Au(Ke)||r(Ke))return rn!==null?null:Lt(ke,De,Ke,_t,null);if(typeof Ke.then=="function")return Tt(ke,De,Pn(Ke),_t);if(Ke.$$typeof===vu)return Tt(ke,De,rp(ke,Ke),_t);_n(ke,Ke)}return null}function En(ke,De,Ke,_t,rn){if(typeof _t=="string"&&_t!==""||typeof _t=="number"||typeof _t=="bigint")return ke=ke.get(Ke)||null,ye(De,ke,""+_t,rn);if(typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case mu:return ke=ke.get(_t.key===null?Ke:_t.key)||null,Ie(De,ke,_t,rn);case ul:return ke=ke.get(_t.key===null?Ke:_t.key)||null,lt(De,ke,_t,rn);case ac:var Oi=_t._init;return _t=Oi(_t._payload),En(ke,De,Ke,_t,rn)}if(Au(_t)||r(_t))return ke=ke.get(Ke)||null,Lt(De,ke,_t,rn,null);if(typeof _t.then=="function")return En(ke,De,Ke,Pn(_t),rn);if(_t.$$typeof===vu)return En(ke,De,Ke,rp(De,_t),rn);_n(De,_t)}return null}function go(ke,De,Ke,_t){for(var rn=null,Oi=null,gn=De,Vn=De=0,Fi=null;gn!==null&&Vn<Ke.length;Vn++){gn.index>Vn?(Fi=gn,gn=null):Fi=gn.sibling;var qn=Tt(ke,gn,Ke[Vn],_t);if(qn===null){gn===null&&(gn=Fi);break}p&&gn&&qn.alternate===null&&g(ke,gn),De=k(qn,De,Vn),Oi===null?rn=qn:Oi.sibling=qn,Oi=qn,gn=Fi}if(Vn===Ke.length)return S(ke,gn),ii&&z(ke,Vn),rn;if(gn===null){for(;Vn<Ke.length;Vn++)gn=Gt(ke,Ke[Vn],_t),gn!==null&&(De=k(gn,De,Vn),Oi===null?rn=gn:Oi.sibling=gn,Oi=gn);return ii&&z(ke,Vn),rn}for(gn=C(gn);Vn<Ke.length;Vn++)Fi=En(gn,ke,Vn,Ke[Vn],_t),Fi!==null&&(p&&Fi.alternate!==null&&gn.delete(Fi.key===null?Vn:Fi.key),De=k(Fi,De,Vn),Oi===null?rn=Fi:Oi.sibling=Fi,Oi=Fi);return p&&gn.forEach(function(Nu){return g(ke,Nu)}),ii&&z(ke,Vn),rn}function Dd(ke,De,Ke,_t){if(Ke==null)throw Error(s(151));for(var rn=null,Oi=null,gn=De,Vn=De=0,Fi=null,qn=Ke.next();gn!==null&&!qn.done;Vn++,qn=Ke.next()){gn.index>Vn?(Fi=gn,gn=null):Fi=gn.sibling;var Nu=Tt(ke,gn,qn.value,_t);if(Nu===null){gn===null&&(gn=Fi);break}p&&gn&&Nu.alternate===null&&g(ke,gn),De=k(Nu,De,Vn),Oi===null?rn=Nu:Oi.sibling=Nu,Oi=Nu,gn=Fi}if(qn.done)return S(ke,gn),ii&&z(ke,Vn),rn;if(gn===null){for(;!qn.done;Vn++,qn=Ke.next())qn=Gt(ke,qn.value,_t),qn!==null&&(De=k(qn,De,Vn),Oi===null?rn=qn:Oi.sibling=qn,Oi=qn);return ii&&z(ke,Vn),rn}for(gn=C(gn);!qn.done;Vn++,qn=Ke.next())qn=En(gn,ke,Vn,qn.value,_t),qn!==null&&(p&&qn.alternate!==null&&gn.delete(qn.key===null?Vn:qn.key),De=k(qn,De,Vn),Oi===null?rn=qn:Oi.sibling=qn,Oi=qn);return p&&gn.forEach(function(g_){return g(ke,g_)}),ii&&z(ke,Vn),rn}function Kh(ke,De,Ke,_t){if(typeof Ke=="object"&&Ke!==null&&Ke.type===gu&&Ke.key===null&&(Ke=Ke.props.children),typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case mu:e:{for(var rn=Ke.key;De!==null;){if(De.key===rn){if(rn=Ke.type,rn===gu){if(De.tag===7){S(ke,De.sibling),_t=I(De,Ke.props.children),_t.return=ke,ke=_t;break e}}else if(De.elementType===rn||typeof rn=="object"&&rn!==null&&rn.$$typeof===ac&&ts(rn)===De.type){S(ke,De.sibling),_t=I(De,Ke.props),gi(_t,Ke),_t.return=ke,ke=_t;break e}S(ke,De);break}else g(ke,De);De=De.sibling}Ke.type===gu?(_t=pu(Ke.props.children,ke.mode,_t,Ke.key),_t.return=ke,ke=_t):(_t=Dh(Ke.type,Ke.key,Ke.props,null,ke.mode,_t),gi(_t,Ke),_t.return=ke,ke=_t)}return $(ke);case ul:e:{for(rn=Ke.key;De!==null;){if(De.key===rn)if(De.tag===4&&De.stateNode.containerInfo===Ke.containerInfo&&De.stateNode.implementation===Ke.implementation){S(ke,De.sibling),_t=I(De,Ke.children||[]),_t.return=ke,ke=_t;break e}else{S(ke,De);break}else g(ke,De);De=De.sibling}_t=ya(Ke,ke.mode,_t),_t.return=ke,ke=_t}return $(ke);case ac:return rn=Ke._init,Ke=rn(Ke._payload),Kh(ke,De,Ke,_t)}if(Au(Ke))return go(ke,De,Ke,_t);if(r(Ke)){if(rn=r(Ke),typeof rn!="function")throw Error(s(150));return Ke=rn.call(Ke),Dd(ke,De,Ke,_t)}if(typeof Ke.then=="function")return Kh(ke,De,Pn(Ke),_t);if(Ke.$$typeof===vu)return Kh(ke,De,rp(ke,Ke),_t);_n(ke,Ke)}return typeof Ke=="string"&&Ke!==""||typeof Ke=="number"||typeof Ke=="bigint"?(Ke=""+Ke,De!==null&&De.tag===6?(S(ke,De.sibling),_t=I(De,Ke),_t.return=ke,ke=_t):(S(ke,De),_t=Ap(Ke,ke.mode,_t),_t.return=ke,ke=_t),$(ke)):S(ke,De)}return function(ke,De,Ke,_t){try{Pr=0;var rn=Kh(ke,De,Ke,_t);return Fh=null,rn}catch(gn){if(gn===Dp)throw gn;var Oi=t(29,gn,null,ke.mode);return Oi.lanes=_t,Oi.return=ke,Oi}finally{}}}function xh(p,g){p=Vo,T(Go,p),T(Ho,g),Vo=p|g.baseLanes}function Vl(){T(Go,Vo),T(Ho,Ho.current)}function vr(){Vo=Go.current,A(Ho),A(Go)}function Wr(p){var g=p.alternate;T(Xi,Xi.current&1),T(Aa,p),lo===null&&(g===null||Ho.current!==null||g.memoizedState!==null)&&(lo=p)}function to(p){if(p.tag===22){if(T(Xi,Xi.current),T(Aa,p),lo===null){var g=p.alternate;g!==null&&g.memoizedState!==null&&(lo=p)}}else xr()}function xr(){T(Xi,Xi.current),T(Aa,Aa.current)}function sn(p){A(Aa),lo===p&&(lo=null),A(Xi)}function $i(p){for(var g=p;g!==null;){if(g.tag===13){var S=g.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||Oh(S)||Tp(S)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}function Ln(){throw Error(s(321))}function V(p,g){if(g===null)return!1;for(var S=0;S<g.length&&S<p.length;S++)if(!$r(p[S],g[S]))return!1;return!0}function Z(p,g,S,C,I,k){return dc=k,bn=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,vn.H=p===null||p.memoizedState===null?gc:Zr,Ru=!1,k=S(C,I),Ru=!1,Hh&&(k=ze(g,S,C,I)),be(p),k}function be(p){vn.H=ws;var g=ui!==null&&ui.next!==null;if(dc=0,rs=ui=bn=null,pc=!1,Td=0,mc=null,g)throw Error(s(300));p===null||Fs||(p=p.dependencies,p!==null&&sp(p)&&(Fs=!0))}function ze(p,g,S,C){bn=p;var I=0;do{if(Hh&&(mc=null),Td=0,Hh=!1,25<=I)throw Error(s(301));if(I+=1,rs=ui=null,p.updateQueue!=null){var k=p.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}vn.H=Lu,k=g(S,C)}while(Hh);return k}function Je(){var p=vn.H,g=p.useState()[0];return g=typeof g.then=="function"?me(g):g,p=p.useState()[0],(ui!==null?ui.memoizedState:null)!==p&&(bn.flags|=1024),g}function Xe(){var p=Du!==0;return Du=0,p}function Rt(p,g,S){g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~S}function gt(p){if(pc){for(p=p.memoizedState;p!==null;){var g=p.queue;g!==null&&(g.pending=null),p=p.next}pc=!1}dc=0,rs=ui=bn=null,Hh=!1,Td=Du=0,mc=null}function Y(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rs===null?bn.memoizedState=rs=p:rs=rs.next=p,rs}function oe(){if(ui===null){var p=bn.alternate;p=p!==null?p.memoizedState:null}else p=ui.next;var g=rs===null?bn.memoizedState:rs.next;if(g!==null)rs=g,ui=p;else{if(p===null)throw bn.alternate===null?Error(s(467)):Error(s(310));ui=p,p={memoizedState:ui.memoizedState,baseState:ui.baseState,baseQueue:ui.baseQueue,queue:ui.queue,next:null},rs===null?bn.memoizedState=rs=p:rs=rs.next=p}return rs}function me(p){var g=Td;return Td+=1,mc===null&&(mc=[]),p=Bt(mc,p,g),g=bn,(rs===null?g.memoizedState:rs.next)===null&&(g=g.alternate,vn.H=g===null||g.memoizedState===null?gc:Zr),p}function de(p){if(p!==null&&typeof p=="object"){if(typeof p.then=="function")return me(p);if(p.$$typeof===vu)return Ar(p)}throw Error(s(438,String(p)))}function Ae(p){var g=null,S=bn.updateQueue;if(S!==null&&(g=S.memoCache),g==null){var C=bn.alternate;C!==null&&(C=C.updateQueue,C!==null&&(C=C.memoCache,C!=null&&(g={data:C.data.map(function(I){return I.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),S===null&&(S=$x(),bn.updateQueue=S),S.memoCache=g,S=g.data[g.index],S===void 0)for(S=g.data[g.index]=Array(p),C=0;C<p;C++)S[C]=Nn;return g.index++,S}function Ne(p,g){return typeof g=="function"?g(p):g}function qe(p){var g=oe();return ft(g,ui,p)}function ft(p,g,S){var C=p.queue;if(C===null)throw Error(s(311));C.lastRenderedReducer=S;var I=p.baseQueue,k=C.pending;if(k!==null){if(I!==null){var $=I.next;I.next=k.next,k.next=$}g.baseQueue=I=k,C.pending=null}if(k=p.baseState,I===null)p.memoizedState=k;else{g=I.next;var ye=$=null,Ie=null,lt=g,Lt=!1;do{var Gt=lt.lane&-536870913;if(Gt!==lt.lane?(jn&Gt)===Gt:(dc&Gt)===Gt){var Tt=lt.revertLane;if(Tt===0)Ie!==null&&(Ie=Ie.next={lane:0,revertLane:0,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null}),Gt===Zi&&(Lt=!0);else if((dc&Tt)===Tt){lt=lt.next,Tt===Zi&&(Lt=!0);continue}else Gt={lane:0,revertLane:lt.revertLane,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null},Ie===null?(ye=Ie=Gt,$=k):Ie=Ie.next=Gt,bn.lanes|=Tt,po|=Tt;Gt=lt.action,Ru&&S(k,Gt),k=lt.hasEagerState?lt.eagerState:S(k,Gt)}else Tt={lane:Gt,revertLane:lt.revertLane,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null},Ie===null?(ye=Ie=Tt,$=k):Ie=Ie.next=Tt,bn.lanes|=Gt,po|=Gt;lt=lt.next}while(lt!==null&&lt!==g);if(Ie===null?$=k:Ie.next=ye,!$r(k,p.memoizedState)&&(Fs=!0,Lt&&(S=pr,S!==null)))throw S;p.memoizedState=k,p.baseState=$,p.baseQueue=Ie,C.lastRenderedState=k}return I===null&&(C.lanes=0),[p.memoizedState,C.dispatch]}function dt(p){var g=oe(),S=g.queue;if(S===null)throw Error(s(311));S.lastRenderedReducer=p;var C=S.dispatch,I=S.pending,k=g.memoizedState;if(I!==null){S.pending=null;var $=I=I.next;do k=p(k,$.action),$=$.next;while($!==I);$r(k,g.memoizedState)||(Fs=!0),g.memoizedState=k,g.baseQueue===null&&(g.baseState=k),S.lastRenderedState=k}return[k,C]}function Ft(p,g,S){var C=bn,I=oe(),k=ii;if(k){if(S===void 0)throw Error(s(407));S=S()}else S=g();var $=!$r((ui||I).memoizedState,S);if($&&(I.memoizedState=S,Fs=!0),I=I.queue,q0(ln.bind(null,C,I,p),[p]),I.getSnapshot!==g||$||rs!==null&&rs.memoizedState.tag&1){if(C.flags|=2048,Io(9,Ht.bind(null,C,I,S,g),{destroy:void 0},null),Bi===null)throw Error(s(349));k||(dc&60)!==0||kt(C,g,S)}return S}function kt(p,g,S){p.flags|=16384,p={getSnapshot:g,value:S},g=bn.updateQueue,g===null?(g=$x(),bn.updateQueue=g,g.stores=[p]):(S=g.stores,S===null?g.stores=[p]:S.push(p))}function Ht(p,g,S,C){g.value=S,g.getSnapshot=C,jt(g)&&Kn(p)}function ln(p,g,S){return S(function(){jt(g)&&Kn(p)})}function jt(p){var g=p.getSnapshot;p=p.value;try{var S=g();return!$r(p,S)}catch{return!0}}function Kn(p){var g=st(p,2);g!==null&&Wi(g,p,2)}function Jt(p){var g=Y();if(typeof p=="function"){var S=p;if(p=S(),Ru){ne(!0);try{S()}finally{ne(!1)}}}return g.memoizedState=g.baseState=p,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ne,lastRenderedState:p},g}function Yt(p,g,S,C){return p.baseState=S,ft(p,ui,typeof C=="function"?C:Ne)}function Kt(p,g,S,C,I){if(Z0(p))throw Error(s(485));if(p=g.action,p!==null){var k={payload:I,action:p,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function($){k.listeners.push($)}};vn.T!==null?S(!0):k.isTransition=!1,C(k),S=g.pending,S===null?(k.next=g.pending=k,Ki(g,k)):(k.next=S.next,g.pending=S.next=k)}}function Ki(p,g){var S=g.action,C=g.payload,I=p.state;if(g.isTransition){var k=vn.T,$={};vn.T=$;try{var ye=S(I,C),Ie=vn.S;Ie!==null&&Ie($,ye),pn(p,g,ye)}catch(lt){Ai(p,g,lt)}finally{vn.T=k}}else try{k=S(I,C),pn(p,g,k)}catch(lt){Ai(p,g,lt)}}function pn(p,g,S){S!==null&&typeof S=="object"&&typeof S.then=="function"?S.then(function(C){Sn(p,g,C)},function(C){return Ai(p,g,C)}):Sn(p,g,S)}function Sn(p,g,S){g.status="fulfilled",g.value=S,In(g),p.state=S,g=p.pending,g!==null&&(S=g.next,S===g?p.pending=null:(S=S.next,g.next=S,Ki(p,S)))}function Ai(p,g,S){var C=p.pending;if(p.pending=null,C!==null){C=C.next;do g.status="rejected",g.reason=S,In(g),g=g.next;while(g!==C)}p.action=null}function In(p){p=p.listeners;for(var g=0;g<p.length;g++)(0,p[g])()}function mn(p,g){return g}function wn(p,g){if(ii){var S=Bi.formState;if(S!==null){e:{var C=bn;if(ii){if(Li){var I=n_(Li,ko);if(I){Li=_u(I),C=fl(I);break e}}tt(C)}C=!1}C&&(g=S[0])}}S=Y(),S.memoizedState=S.baseState=g,C={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mn,lastRenderedState:g},S.queue=C,S=sx.bind(null,bn,C),C.dispatch=S,C=Jt(!1);var k=Jf.bind(null,bn,!1,C.queue);return C=Y(),I={state:g,dispatch:null,action:p,pending:null},C.queue=I,S=Kt.bind(null,bn,I,k,S),I.dispatch=S,C.memoizedState=p,[g,S,!1]}function ns(p){var g=oe();return yi(g,ui,p)}function yi(p,g,S){g=ft(p,g,mn)[0],p=qe(Ne)[0],g=typeof g=="object"&&g!==null&&typeof g.then=="function"?me(g):g;var C=oe(),I=C.queue,k=I.dispatch;return S!==C.memoizedState&&(bn.flags|=2048,Io(9,vi.bind(null,I,S),{destroy:void 0},null)),[g,k,p]}function vi(p,g){p.action=g}function hr(p){var g=oe(),S=ui;if(S!==null)return yi(g,S,p);oe(),g=g.memoizedState,S=oe();var C=S.queue.dispatch;return S.memoizedState=p,[g,C,!1]}function Io(p,g,S,C){return p={tag:p,create:g,inst:S,deps:C,next:null},g=bn.updateQueue,g===null&&(g=$x(),bn.updateQueue=g),S=g.lastEffect,S===null?g.lastEffect=p.next=p:(C=S.next,S.next=p,p.next=C,g.lastEffect=p),p}function Xr(){return oe().memoizedState}function Ig(p,g,S,C){var I=Y();bn.flags|=p,I.memoizedState=Io(1|g,S,{destroy:void 0},C===void 0?null:C)}function j0(p,g,S,C){var I=oe();C=C===void 0?null:C;var k=I.memoizedState.inst;ui!==null&&C!==null&&V(C,ui.memoizedState.deps)?I.memoizedState=Io(g,S,k,C):(bn.flags|=p,I.memoizedState=Io(1|g,S,k,C))}function tx(p,g){Ig(8390656,8,p,g)}function q0(p,g){j0(2048,8,p,g)}function s1(p,g){return j0(4,2,p,g)}function r1(p,g){return j0(4,4,p,g)}function Q0(p,g){if(typeof g=="function"){p=p();var S=g(p);return function(){typeof S=="function"?S():g(null)}}if(g!=null)return p=p(),g.current=p,function(){g.current=null}}function Bg(p,g,S){S=S!=null?S.concat([p]):null,j0(4,4,Q0.bind(null,g,p),S)}function $0(){}function bh(p,g){var S=oe();g=g===void 0?null:g;var C=S.memoizedState;return g!==null&&V(g,C[1])?C[0]:(S.memoizedState=[p,g],p)}function Ah(p,g){var S=oe();g=g===void 0?null:g;var C=S.memoizedState;if(g!==null&&V(g,C[1]))return C[0];if(C=p(),Ru){ne(!0);try{p()}finally{ne(!1)}}return S.memoizedState=[C,g],C}function Og(p,g,S){return S===void 0||(dc&1073741824)!==0?p.memoizedState=g:(p.memoizedState=S,p=pp(),bn.lanes|=p,po|=p,S)}function Pg(p,g,S,C){return $r(S,g)?S:Ho.current!==null?(p=Og(p,S,C),$r(p,g)||(Fs=!0),p):(dc&42)===0?(Fs=!0,p.memoizedState=S):(p=pp(),bn.lanes|=p,po|=p,g)}function nx(p,g,S,C,I){var k=Eu();Qr(k!==0&&8>k?k:8);var $=vn.T,ye={};vn.T=ye,Jf(p,!1,g,S);try{var Ie=I(),lt=vn.S;if(lt!==null&&lt(ye,Ie),Ie!==null&&typeof Ie=="object"&&typeof Ie.then=="function"){var Lt=vt(Ie,C);tu(p,g,Lt,Rr(p))}else tu(p,g,C,Rr(p))}catch(Gt){tu(p,g,{then:function(){},status:"rejected",reason:Gt},Rr())}finally{Qr(k),vn.T=$}}function Qf(p){var g=p.memoizedState;if(g!==null)return g;g={memoizedState:Bh,baseState:Bh,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ne,lastRenderedState:Bh},next:null};var S={};return g.next={memoizedState:S,baseState:S,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ne,lastRenderedState:S},next:null},p.memoizedState=g,p=p.alternate,p!==null&&(p.memoizedState=g),g}function J0(){return Ar(lc)}function $f(){return oe().memoizedState}function Yl(){return oe().memoizedState}function ix(p){for(var g=p.return;g!==null;){switch(g.tag){case 24:case 3:var S=Rr();p=Et(S);var C=Dt(g,p,S);C!==null&&(Wi(C,g,S),Nt(C,g,S)),g={cache:ru()},p.payload=g;return}g=g.return}}function Ng(p,g,S){var C=Rr();S={lane:C,revertLane:0,action:S,hasEagerState:!1,eagerState:null,next:null},Z0(p)?jr(g,S):(S=Ve(p,g,S,C),S!==null&&(Wi(S,p,C),nu(S,g,C)))}function sx(p,g,S){var C=Rr();tu(p,g,S,C)}function tu(p,g,S,C){var I={lane:C,revertLane:0,action:S,hasEagerState:!1,eagerState:null,next:null};if(Z0(p))jr(g,I);else{var k=p.alternate;if(p.lanes===0&&(k===null||k.lanes===0)&&(k=g.lastRenderedReducer,k!==null))try{var $=g.lastRenderedState,ye=k($,S);if(I.hasEagerState=!0,I.eagerState=ye,$r(ye,$))return At(p,g,I,0),Bi===null&&te(),!1}catch{}finally{}if(S=Ve(p,g,I,C),S!==null)return Wi(S,p,C),nu(S,g,C),!0}return!1}function Jf(p,g,S,C){if(C={lane:2,revertLane:ot(),action:C,hasEagerState:!1,eagerState:null,next:null},Z0(p)){if(g)throw Error(s(479))}else g=Ve(p,S,C,2),g!==null&&Wi(g,p,2)}function Z0(p){var g=p.alternate;return p===bn||g!==null&&g===bn}function jr(p,g){Hh=pc=!0;var S=p.pending;S===null?g.next=g:(g.next=S.next,S.next=g),p.pending=g}function nu(p,g,S){if((S&4194176)!==0){var C=g.lanes;C&=p.pendingLanes,S|=C,g.lanes=S,re(p,S)}}function Zf(p,g,S,C){g=p.memoizedState,S=S(C,g),S=S==null?g:bs({},g,S),p.memoizedState=S,p.lanes===0&&(p.updateQueue.baseState=S)}function ed(p,g,S,C,I,k,$){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(C,k,$):g.prototype&&g.prototype.isPureReactComponent?!Ge(S,C)||!Ge(I,k):!0}function a1(p,g,S,C){p=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(S,C),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(S,C),g.state!==p&&wd.enqueueReplaceState(g,g.state,null)}function Kl(p,g){var S=g;if("ref"in g){S={};for(var C in g)C!=="ref"&&(S[C]=g[C])}if(p=p.defaultProps){S===g&&(S=bs({},S));for(var I in p)S[I]===void 0&&(S[I]=p[I])}return S}function td(p,g){try{var S=p.onUncaughtError;S(g.value,{componentStack:g.stack})}catch(C){setTimeout(function(){throw C})}}function nd(p,g,S){try{var C=p.onCaughtError;C(S.value,{componentStack:S.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(I){setTimeout(function(){throw I})}}function id(p,g,S){return S=Et(S),S.tag=3,S.payload={element:null},S.callback=function(){td(p,g)},S}function rx(p){return p=Et(p),p.tag=3,p}function o1(p,g,S,C){var I=S.type.getDerivedStateFromError;if(typeof I=="function"){var k=C.value;p.payload=function(){return I(k)},p.callback=function(){nd(g,S,C)}}var $=S.stateNode;$!==null&&typeof $.componentDidCatch=="function"&&(p.callback=function(){nd(g,S,C),typeof I!="function"&&(xl===null?xl=new Set([this]):xl.add(this));var ye=C.stack;this.componentDidCatch(C.value,{componentStack:ye!==null?ye:""})})}function UM(p,g,S,C,I){if(S.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){if(g=S.alternate,g!==null&&ip(g,S,I,!0),S=Aa.current,S!==null){switch(S.tag){case 13:return lo===null?ro():S.alternate===null&&as===0&&(as=3),S.flags&=-257,S.flags|=65536,S.lanes=I,C===Jr?S.flags|=16384:(g=S.updateQueue,g===null?S.updateQueue=new Set([C]):g.add(C),du(p,C,I)),!1;case 22:return S.flags|=65536,C===Jr?S.flags|=16384:(g=S.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([C])},S.updateQueue=g):(S=g.retryQueue,S===null?g.retryQueue=new Set([C]):S.add(C)),du(p,C,I)),!1}throw Error(s(435,S.tag))}return du(p,C,I),ro(),!1}if(ii)return g=Aa.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=I,C!==Rp&&(p=Error(s(422),{cause:C}),Ot(ue(p,S)))):(C!==Rp&&(g=Error(s(423),{cause:C}),Ot(ue(g,S))),p=p.current.alternate,p.flags|=65536,I&=-I,p.lanes|=I,C=ue(C,S),I=id(p.stateNode,C,I),ve(p,I),as!==4&&(as=2)),!1;var k=Error(s(520),{cause:C});if(k=ue(k,S),Cd===null?Cd=[k]:Cd.push(k),as!==4&&(as=2),g===null)return!0;C=ue(C,S),S=g;do{switch(S.tag){case 3:return S.flags|=65536,p=I&-I,S.lanes|=p,p=id(S.stateNode,C,p),ve(S,p),!1;case 1:if(g=S.type,k=S.stateNode,(S.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(xl===null||!xl.has(k))))return S.flags|=65536,I&=-I,S.lanes|=I,I=rx(I),o1(I,p,S,C),ve(S,I),!1}S=S.return}while(S!==null);return!1}function br(p,g,S,C){g.child=p===null?gl(g,null,S,C):Cu(g,p.child,S,C)}function Ug(p,g,S,C,I){S=S.render;var k=g.ref;if("ref"in C){var $={};for(var ye in C)ye!=="ref"&&($[ye]=C[ye])}else $=C;return su(g),C=Z(p,g,S,$,k,I),ye=Xe(),p!==null&&!Fs?(Rt(p,g,I),Wl(p,g,I)):(ii&&ye&&ge(g),g.flags|=1,br(p,g,C,I),g.child)}function l1(p,g,S,C,I){if(p===null){var k=S.type;return typeof k=="function"&&!tc(k)&&k.defaultProps===void 0&&S.compare===null?(g.tag=15,g.type=k,c1(p,g,k,C,I)):(p=Dh(S.type,null,C,g,g.mode,I),p.ref=g.ref,p.return=g,g.child=p)}if(k=p.child,!ux(p,I)){var $=k.memoizedProps;if(S=S.compare,S=S!==null?S:Ge,S($,C)&&p.ref===g.ref)return Wl(p,g,I)}return g.flags|=1,p=nc(k,C),p.ref=g.ref,p.return=g,g.child=p}function c1(p,g,S,C,I){if(p!==null){var k=p.memoizedProps;if(Ge(k,C)&&p.ref===g.ref)if(Fs=!1,g.pendingProps=C=k,ux(p,I))(p.flags&131072)!==0&&(Fs=!0);else return g.lanes=p.lanes,Wl(p,g,I)}return kg(p,g,S,C,I)}function u1(p,g,S){var C=g.pendingProps,I=C.children,k=(g.stateNode._pendingVisibility&2)!==0,$=p!==null?p.memoizedState:null;if(ep(p,g),C.mode==="hidden"||k){if((g.flags&128)!==0){if(C=$!==null?$.baseLanes|S:S,p!==null){for(I=g.child=p.child,k=0;I!==null;)k=k|I.lanes|I.childLanes,I=I.sibling;g.childLanes=k&~C}else g.childLanes=0,g.child=null;return h1(p,g,C,S)}if((S&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},p!==null&&Hg(g,$!==null?$.cachePool:null),$!==null?xh(g,$):Vl(),to(g);else return g.lanes=g.childLanes=536870912,h1(p,g,$!==null?$.baseLanes|S:S,S)}else $!==null?(Hg(g,$.cachePool),xh(g,$),xr(),g.memoizedState=null):(p!==null&&Hg(g,null),Vl(),xr());return br(p,g,I,S),g.child}function h1(p,g,S,C){var I=fx();return I=I===null?null:{parent:Oo?ys._currentValue:ys._currentValue2,pool:I},g.memoizedState={baseLanes:S,cachePool:I},p!==null&&Hg(g,null),Vl(),to(g),p!==null&&ip(p,g,C,!0),null}function ep(p,g){var S=g.ref;if(S===null)p!==null&&p.ref!==null&&(g.flags|=2097664);else{if(typeof S!="function"&&typeof S!="object")throw Error(s(284));(p===null||p.ref!==S)&&(g.flags|=2097664)}}function kg(p,g,S,C,I){return su(g),S=Z(p,g,S,C,void 0,I),C=Xe(),p!==null&&!Fs?(Rt(p,g,I),Wl(p,g,I)):(ii&&C&&ge(g),g.flags|=1,br(p,g,S,I),g.child)}function f1(p,g,S,C,I,k){return su(g),g.updateQueue=null,S=ze(g,C,S,I),be(p),C=Xe(),p!==null&&!Fs?(Rt(p,g,k),Wl(p,g,k)):(ii&&C&&ge(g),g.flags|=1,br(p,g,S,k),g.child)}function d1(p,g,S,C,I){if(su(g),g.stateNode===null){var k=Uh,$=S.contextType;typeof $=="object"&&$!==null&&(k=Ar($)),k=new S(C,k),g.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=wd,g.stateNode=k,k._reactInternals=g,k=g.stateNode,k.props=C,k.state=g.memoizedState,k.refs={},it(g),$=S.contextType,k.context=typeof $=="object"&&$!==null?Ar($):Uh,k.state=g.memoizedState,$=S.getDerivedStateFromProps,typeof $=="function"&&(Zf(g,S,$,C),k.state=g.memoizedState),typeof S.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||($=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),$!==k.state&&wd.enqueueReplaceState(k,k.state,null),St(g,C,k,I),He(),k.state=g.memoizedState),typeof k.componentDidMount=="function"&&(g.flags|=4194308),C=!0}else if(p===null){k=g.stateNode;var ye=g.memoizedProps,Ie=Kl(S,ye);k.props=Ie;var lt=k.context,Lt=S.contextType;$=Uh,typeof Lt=="object"&&Lt!==null&&($=Ar(Lt));var Gt=S.getDerivedStateFromProps;Lt=typeof Gt=="function"||typeof k.getSnapshotBeforeUpdate=="function",ye=g.pendingProps!==ye,Lt||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(ye||lt!==$)&&a1(g,k,C,$),Br=!1;var Tt=g.memoizedState;k.state=Tt,St(g,C,k,I),He(),lt=g.memoizedState,ye||Tt!==lt||Br?(typeof Gt=="function"&&(Zf(g,S,Gt,C),lt=g.memoizedState),(Ie=Br||ed(g,S,Ie,C,Tt,lt,$))?(Lt||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(g.flags|=4194308)):(typeof k.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=C,g.memoizedState=lt),k.props=C,k.state=lt,k.context=$,C=Ie):(typeof k.componentDidMount=="function"&&(g.flags|=4194308),C=!1)}else{k=g.stateNode,Ct(p,g),$=g.memoizedProps,Lt=Kl(S,$),k.props=Lt,Gt=g.pendingProps,Tt=k.context,lt=S.contextType,Ie=Uh,typeof lt=="object"&&lt!==null&&(Ie=Ar(lt)),ye=S.getDerivedStateFromProps,(lt=typeof ye=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||($!==Gt||Tt!==Ie)&&a1(g,k,C,Ie),Br=!1,Tt=g.memoizedState,k.state=Tt,St(g,C,k,I),He();var En=g.memoizedState;$!==Gt||Tt!==En||Br||p!==null&&p.dependencies!==null&&sp(p.dependencies)?(typeof ye=="function"&&(Zf(g,S,ye,C),En=g.memoizedState),(Lt=Br||ed(g,S,Lt,C,Tt,En,Ie)||p!==null&&p.dependencies!==null&&sp(p.dependencies))?(lt||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(C,En,Ie),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(C,En,Ie)),typeof k.componentDidUpdate=="function"&&(g.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof k.componentDidUpdate!="function"||$===p.memoizedProps&&Tt===p.memoizedState||(g.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||$===p.memoizedProps&&Tt===p.memoizedState||(g.flags|=1024),g.memoizedProps=C,g.memoizedState=En),k.props=C,k.state=En,k.context=Ie,C=Lt):(typeof k.componentDidUpdate!="function"||$===p.memoizedProps&&Tt===p.memoizedState||(g.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||$===p.memoizedProps&&Tt===p.memoizedState||(g.flags|=1024),C=!1)}return k=C,ep(p,g),C=(g.flags&128)!==0,k||C?(k=g.stateNode,S=C&&typeof S.getDerivedStateFromError!="function"?null:k.render(),g.flags|=1,p!==null&&C?(g.child=Cu(g,p.child,null,I),g.child=Cu(g,null,S,I)):br(p,g,S,I),g.memoizedState=k.state,p=g.child):p=Wl(p,g,I),p}function p1(p,g,S,C){return tn(),g.flags|=256,br(p,g,S,C),g.child}function ax(p){return{baseLanes:p,cachePool:dx()}}function tp(p,g,S){return p=p!==null?p.childLanes&~S:0,g&&(p|=Ga),p}function m1(p,g,S){var C=g.pendingProps,I=!1,k=(g.flags&128)!==0,$;if(($=k)||($=p!==null&&p.memoizedState===null?!1:(Xi.current&2)!==0),$&&(I=!0,g.flags&=-129),$=(g.flags&32)!==0,g.flags&=-33,p===null){if(ii){if(I?Wr(g):xr(),ii){var ye=Li,Ie;(Ie=ye)&&(ye=s_(ye,ko),ye!==null?(g.memoizedState={dehydrated:ye,treeContext:Uo!==null?{id:pl,overflow:ml}:null,retryLane:536870912},Ie=t(18,null,null,0),Ie.stateNode=ye,Ie.return=g,g.child=Ie,Ss=g,Li=null,Ie=!0):Ie=!1),Ie||tt(g)}if(ye=g.memoizedState,ye!==null&&(ye=ye.dehydrated,ye!==null))return Tp(ye)?g.lanes=16:g.lanes=536870912,null;sn(g)}return ye=C.children,C=C.fallback,I?(xr(),I=g.mode,ye=lx({mode:"hidden",children:ye},I),C=pu(C,I,S,null),ye.return=g,C.return=g,ye.sibling=C,g.child=ye,I=g.child,I.memoizedState=ax(S),I.childLanes=tp(p,$,S),g.memoizedState=Ip,C):(Wr(g),ox(g,ye))}if(Ie=p.memoizedState,Ie!==null&&(ye=Ie.dehydrated,ye!==null)){if(k)g.flags&256?(Wr(g),g.flags&=-257,g=Fg(p,g,S)):g.memoizedState!==null?(xr(),g.child=p.child,g.flags|=128,g=null):(xr(),I=C.fallback,ye=g.mode,C=lx({mode:"visible",children:C.children},ye),I=pu(I,ye,S,null),I.flags|=2,C.return=g,I.return=g,C.sibling=I,g.child=C,Cu(g,p.child,null,S),C=g.child,C.memoizedState=ax(S),C.childLanes=tp(p,$,S),g.memoizedState=Ip,g=I);else if(Wr(g),Tp(ye))$=o2(ye).digest,C=Error(s(419)),C.stack="",C.digest=$,Ot({value:C,source:null,stack:null}),g=Fg(p,g,S);else if(Fs||ip(p,g,S,!1),$=(S&p.childLanes)!==0,Fs||$){if($=Bi,$!==null){if(C=S&-S,(C&42)!==0)C=1;else switch(C){case 2:C=1;break;case 8:C=4;break;case 32:C=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:C=64;break;case 268435456:C=134217728;break;default:C=0}if(C=(C&($.suspendedLanes|S))!==0?0:C,C!==0&&C!==Ie.retryLane)throw Ie.retryLane=C,st(p,C),Wi($,p,C),Jx}Oh(ye)||ro(),g=Fg(p,g,S)}else Oh(ye)?(g.flags|=128,g.child=p.child,g=bp.bind(null,p),t_(ye,g),g=null):(p=Ie.treeContext,va&&(Li=Ux(ye),Ss=g,ii=!0,oo=null,ko=!1,p!==null&&(xa[Ir++]=pl,xa[Ir++]=ml,xa[Ir++]=Uo,pl=p.id,ml=p.overflow,Uo=g)),g=ox(g,C.children),g.flags|=4096);return g}return I?(xr(),I=C.fallback,ye=g.mode,Ie=p.child,k=Ie.sibling,C=nc(Ie,{mode:"hidden",children:C.children}),C.subtreeFlags=Ie.subtreeFlags&31457280,k!==null?I=nc(k,I):(I=pu(I,ye,S,null),I.flags|=2),I.return=g,C.return=g,C.sibling=I,g.child=C,C=I,I=g.child,ye=p.child.memoizedState,ye===null?ye=ax(S):(Ie=ye.cachePool,Ie!==null?(k=Oo?ys._currentValue:ys._currentValue2,Ie=Ie.parent!==k?{parent:k,pool:k}:Ie):Ie=dx(),ye={baseLanes:ye.baseLanes|S,cachePool:Ie}),I.memoizedState=ye,I.childLanes=tp(p,$,S),g.memoizedState=Ip,C):(Wr(g),S=p.child,p=S.sibling,S=nc(S,{mode:"visible",children:C.children}),S.return=g,S.sibling=null,p!==null&&($=g.deletions,$===null?(g.deletions=[p],g.flags|=16):$.push(p)),g.child=S,g.memoizedState=null,S)}function ox(p,g){return g=lx({mode:"visible",children:g},p.mode),g.return=p,p.child=g}function lx(p,g){return Jg(p,g,0,null)}function Fg(p,g,S){return Cu(g,p.child,null,S),p=ox(g,g.pendingProps.children),p.flags|=2,g.memoizedState=null,p}function g1(p,g,S){p.lanes|=g;var C=p.alternate;C!==null&&(C.lanes|=g),np(p.return,g,S)}function cx(p,g,S,C,I){var k=p.memoizedState;k===null?p.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:C,tail:S,tailMode:I}:(k.isBackwards=g,k.rendering=null,k.renderingStartTime=0,k.last=C,k.tail=S,k.tailMode=I)}function y1(p,g,S){var C=g.pendingProps,I=C.revealOrder,k=C.tail;if(br(p,g,C.children,S),C=Xi.current,(C&2)!==0)C=C&1|2,g.flags|=128;else{if(p!==null&&(p.flags&128)!==0)e:for(p=g.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&g1(p,S,g);else if(p.tag===19)g1(p,S,g);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===g)break e;for(;p.sibling===null;){if(p.return===null||p.return===g)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}C&=1}switch(T(Xi,C),I){case"forwards":for(S=g.child,I=null;S!==null;)p=S.alternate,p!==null&&$i(p)===null&&(I=S),S=S.sibling;S=I,S===null?(I=g.child,g.child=null):(I=S.sibling,S.sibling=null),cx(g,!1,I,S,k);break;case"backwards":for(S=null,I=g.child,g.child=null;I!==null;){if(p=I.alternate,p!==null&&$i(p)===null){g.child=I;break}p=I.sibling,I.sibling=S,S=I,I=p}cx(g,!0,S,null,k);break;case"together":cx(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function Wl(p,g,S){if(p!==null&&(g.dependencies=p.dependencies),po|=g.lanes,(S&g.childLanes)===0)if(p!==null){if(ip(p,g,S,!1),(S&g.childLanes)===0)return null}else return null;if(p!==null&&g.child!==p.child)throw Error(s(153));if(g.child!==null){for(p=g.child,S=nc(p,p.pendingProps),g.child=S,S.return=g;p.sibling!==null;)p=p.sibling,S=S.sibling=nc(p,p.pendingProps),S.return=g;S.sibling=null}return g.child}function ux(p,g){return(p.lanes&g)!==0?!0:(p=p.dependencies,!!(p!==null&&sp(p)))}function kM(p,g,S){switch(g.tag){case 3:le(g,g.stateNode.containerInfo),iu(g,ys,p.memoizedState.cache),tn();break;case 27:case 5:Me(g);break;case 4:le(g,g.stateNode.containerInfo);break;case 10:iu(g,g.type,g.memoizedProps.value);break;case 13:var C=g.memoizedState;if(C!==null)return C.dehydrated!==null?(Wr(g),g.flags|=128,null):(S&g.child.childLanes)!==0?m1(p,g,S):(Wr(g),p=Wl(p,g,S),p!==null?p.sibling:null);Wr(g);break;case 19:var I=(p.flags&128)!==0;if(C=(S&g.childLanes)!==0,C||(ip(p,g,S,!1),C=(S&g.childLanes)!==0),I){if(C)return y1(p,g,S);g.flags|=128}if(I=g.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),T(Xi,Xi.current),C)break;return null;case 22:case 23:return g.lanes=0,u1(p,g,S);case 24:iu(g,ys,p.memoizedState.cache)}return Wl(p,g,S)}function v1(p,g,S){if(p!==null)if(p.memoizedProps!==g.pendingProps)Fs=!0;else{if(!ux(p,S)&&(g.flags&128)===0)return Fs=!1,kM(p,g,S);Fs=(p.flags&131072)!==0}else Fs=!1,ii&&(g.flags&1048576)!==0&&ae(g,Ed,g.index);switch(g.lanes=0,g.tag){case 16:e:{p=g.pendingProps;var C=g.elementType,I=C._init;if(C=I(C._payload),g.type=C,typeof C=="function")tc(C)?(p=Kl(C,p),g.tag=1,g=d1(null,g,C,p,S)):(g.tag=0,g=kg(null,g,C,p,S));else{if(C!=null){if(I=C.$$typeof,I===Zg){g.tag=11,g=Ug(null,g,C,p,S);break e}else if(I===dd){g.tag=14,g=l1(null,g,C,p,S);break e}}throw g=a(C)||C,Error(s(306,g,""))}}return g;case 0:return kg(p,g,g.type,g.pendingProps,S);case 1:return C=g.type,I=Kl(C,g.pendingProps),d1(p,g,C,I,S);case 3:e:{if(le(g,g.stateNode.containerInfo),p===null)throw Error(s(387));var k=g.pendingProps;I=g.memoizedState,C=I.element,Ct(p,g),St(g,k,null,S);var $=g.memoizedState;if(k=$.cache,iu(g,ys,k),k!==I.cache&&Eh(g,[ys],S,!0),He(),k=$.element,va&&I.isDehydrated)if(I={element:k,isDehydrated:!1,cache:$.cache},g.updateQueue.baseState=I,g.memoizedState=I,g.flags&256){g=p1(p,g,k,S);break e}else if(k!==C){C=ue(Error(s(424)),g),Ot(C),g=p1(p,g,k,S);break e}else for(va&&(Li=Ph(g.stateNode.containerInfo),Ss=g,ii=!0,oo=null,ko=!0),S=gl(g,null,k,S),g.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling;else{if(tn(),k===C){g=Wl(p,g,S);break e}br(p,g,k,S)}g=g.child}return g;case 26:if(Ua)return ep(p,g),p===null?(S=Gx(g.type,null,g.pendingProps,null))?g.memoizedState=S:ii||(g.stateNode=Kx(g.type,g.pendingProps,hc.current,g)):g.memoizedState=Gx(g.type,p.memoizedProps,g.pendingProps,p.memoizedState),null;case 27:if(dr)return Me(g),p===null&&dr&&ii&&(C=g.stateNode=u2(g.type,g.pendingProps,hc.current,_s.current,!1),Ss=g,ko=!0,Li=cc(C)),C=g.pendingProps.children,p!==null||ii?br(p,g,C,S):g.child=Cu(g,null,C,S),ep(p,g),g.child;case 5:return p===null&&ii&&(c_(g.type,g.pendingProps,_s.current),(I=C=Li)&&(C=kx(C,g.type,g.pendingProps,ko),C!==null?(g.stateNode=C,Ss=g,Li=cc(C),ko=!1,I=!0):I=!1),I||tt(g)),Me(g),I=g.type,k=g.pendingProps,$=p!==null?p.memoizedProps:null,C=k.children,_r(I,k)?C=null:$!==null&&_r(I,$)&&(g.flags|=32),g.memoizedState!==null&&(I=Z(p,g,Je,null,null,S),Oo?lc._currentValue=I:lc._currentValue2=I),ep(p,g),br(p,g,C,S),g.child;case 6:return p===null&&ii&&(XM(g.pendingProps,_s.current),(p=S=Li)&&(S=i_(S,g.pendingProps,ko),S!==null?(g.stateNode=S,Ss=g,Li=null,p=!0):p=!1),p||tt(g)),null;case 13:return m1(p,g,S);case 4:return le(g,g.stateNode.containerInfo),C=g.pendingProps,p===null?g.child=Cu(g,null,C,S):br(p,g,C,S),g.child;case 11:return Ug(p,g,g.type,g.pendingProps,S);case 7:return br(p,g,g.pendingProps,S),g.child;case 8:return br(p,g,g.pendingProps.children,S),g.child;case 12:return br(p,g,g.pendingProps.children,S),g.child;case 10:return C=g.pendingProps,iu(g,g.type,C.value),br(p,g,C.children,S),g.child;case 9:return I=g.type._context,C=g.pendingProps.children,su(g),I=Ar(I),C=C(I),g.flags|=1,br(p,g,C,S),g.child;case 14:return l1(p,g,g.type,g.pendingProps,S);case 15:return c1(p,g,g.type,g.pendingProps,S);case 19:return y1(p,g,S);case 22:return u1(p,g,S);case 24:return su(g),C=Ar(ys),p===null?(I=fx(),I===null&&(I=Bi,k=ru(),I.pooledCache=k,k.refCount++,k!==null&&(I.pooledCacheLanes|=S),I=k),g.memoizedState={parent:C,cache:I},it(g),iu(g,ys,I)):((p.lanes&S)!==0&&(Ct(p,g),St(g,null,null,S),He()),I=p.memoizedState,k=g.memoizedState,I.parent!==C?(I={parent:C,cache:C},g.memoizedState=I,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=I),iu(g,ys,C)):(C=k.cache,iu(g,ys,C),C!==I.cache&&Eh(g,[ys],S,!0))),br(p,g,g.pendingProps.children,S),g.child;case 29:throw g.pendingProps}throw Error(s(156,g.tag))}function iu(p,g,S){Oo?(T(co,g._currentValue),g._currentValue=S):(T(co,g._currentValue2),g._currentValue2=S)}function Xl(p){var g=co.current;Oo?p._currentValue=g:p._currentValue2=g,A(co)}function np(p,g,S){for(;p!==null;){var C=p.alternate;if((p.childLanes&g)!==g?(p.childLanes|=g,C!==null&&(C.childLanes|=g)):C!==null&&(C.childLanes&g)!==g&&(C.childLanes|=g),p===S)break;p=p.return}}function Eh(p,g,S,C){var I=p.child;for(I!==null&&(I.return=p);I!==null;){var k=I.dependencies;if(k!==null){var $=I.child;k=k.firstContext;e:for(;k!==null;){var ye=k;k=I;for(var Ie=0;Ie<g.length;Ie++)if(ye.context===g[Ie]){k.lanes|=S,ye=k.alternate,ye!==null&&(ye.lanes|=S),np(k.return,S,p),C||($=null);break e}k=ye.next}}else if(I.tag===18){if($=I.return,$===null)throw Error(s(341));$.lanes|=S,k=$.alternate,k!==null&&(k.lanes|=S),np($,S,p),$=null}else $=I.child;if($!==null)$.return=I;else for($=I;$!==null;){if($===p){$=null;break}if(I=$.sibling,I!==null){I.return=$.return,$=I;break}$=$.return}I=$}}function ip(p,g,S,C){p=null;for(var I=g,k=!1;I!==null;){if(!k){if((I.flags&524288)!==0)k=!0;else if((I.flags&262144)!==0)break}if(I.tag===10){var $=I.alternate;if($===null)throw Error(s(387));if($=$.memoizedProps,$!==null){var ye=I.type;$r(I.pendingProps.value,$.value)||(p!==null?p.push(ye):p=[ye])}}else if(I===Cp.current){if($=I.alternate,$===null)throw Error(s(387));$.memoizedState.memoizedState!==I.memoizedState.memoizedState&&(p!==null?p.push(lc):p=[lc])}I=I.return}p!==null&&Eh(g,p,S,C),g.flags|=262144}function sp(p){for(p=p.firstContext;p!==null;){var g=p.context;if(!$r(Oo?g._currentValue:g._currentValue2,p.memoizedValue))return!0;p=p.next}return!1}function su(p){Bu=p,uo=null,p=p.dependencies,p!==null&&(p.firstContext=null)}function Ar(p){return hx(Bu,p)}function rp(p,g){return Bu===null&&su(p),hx(p,g)}function hx(p,g){var S=Oo?g._currentValue:g._currentValue2;if(g={context:g,memoizedValue:S,next:null},uo===null){if(p===null)throw Error(s(308));uo=g,p.dependencies={lanes:0,firstContext:g},p.flags|=524288}else uo=uo.next=g;return S}function ru(){return{controller:new Bp,data:new Map,refCount:0}}function ap(p){p.refCount--,p.refCount===0&&us(qM,function(){p.controller.abort()})}function fx(){var p=Gh.current;return p!==null?p:Bi.pooledCache}function Hg(p,g){g===null?T(Gh,Gh.current):T(Gh,g.pool)}function dx(){var p=fx();return p===null?null:{parent:Oo?ys._currentValue:ys._currentValue2,pool:p}}function fa(p){p.flags|=4}function sd(p,g){if(p!==null&&p.child===g.child)return!1;if((g.flags&16)!==0)return!0;for(p=g.child;p!==null;){if((p.flags&13878)!==0||(p.subtreeFlags&13878)!==0)return!0;p=p.sibling}return!1}function _h(p,g,S,C){if(ss)for(S=g.child;S!==null;){if(S.tag===5||S.tag===6)_p(p,S.stateNode);else if(!(S.tag===4||dr&&S.tag===27)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===g)break;for(;S.sibling===null;){if(S.return===null||S.return===g)return;S=S.return}S.sibling.return=S.return,S=S.sibling}else if(Po)for(var I=g.child;I!==null;){if(I.tag===5){var k=I.stateNode;S&&C&&(k=e_(k,I.type,I.memoizedProps)),_p(p,k)}else if(I.tag===6)k=I.stateNode,S&&C&&(k=Nx(k,I.memoizedProps)),_p(p,k);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)k=I.child,k!==null&&(k.return=I),_h(p,I,!0,!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===g)break;for(;I.sibling===null;){if(I.return===null||I.return===g)return;I=I.return}I.sibling.return=I.return,I=I.sibling}}function x1(p,g,S,C){if(Po)for(var I=g.child;I!==null;){if(I.tag===5){var k=I.stateNode;S&&C&&(k=e_(k,I.type,I.memoizedProps)),Px(p,k)}else if(I.tag===6)k=I.stateNode,S&&C&&(k=Nx(k,I.memoizedProps)),Px(p,k);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)k=I.child,k!==null&&(k.return=I),x1(p,I,!(I.memoizedProps!==null&&I.memoizedProps.mode==="manual"),!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===g)break;for(;I.sibling===null;){if(I.return===null||I.return===g)return;I=I.return}I.sibling.return=I.return,I=I.sibling}}function op(p,g){if(Po&&sd(p,g)){p=g.stateNode;var S=p.containerInfo,C=a2();x1(C,g,!1,!1),p.pendingChildren=C,fa(g),J1(S,C)}}function Gg(p,g,S,C){if(ss)p.memoizedProps!==C&&fa(g);else if(Po){var I=p.stateNode,k=p.memoizedProps;if((p=sd(p,g))||k!==C){var $=_s.current;k=$1(I,S,k,C,!p,null),k===I?g.stateNode=I:(e2(k,S,C,$)&&fa(g),g.stateNode=k,p?_h(k,g,!1,!1):fa(g))}else g.stateNode=I}}function zg(p,g,S){if(Rx(g,S)){if(p.flags|=16777216,!Dx(g,S))if(fr())p.flags|=8192;else throw Or=Jr,Lp}else p.flags&=-16777217}function Vg(p,g){if(f_(g)){if(p.flags|=16777216,!Wx(g))if(fr())p.flags|=8192;else throw Or=Jr,Lp}else p.flags&=-16777217}function rd(p,g){g!==null&&(p.flags|=4),p.flags&16384&&(g=p.tag!==22?B():536870912,p.lanes|=g,Gs|=g)}function ad(p,g){if(!ii)switch(p.tailMode){case"hidden":g=p.tail;for(var S=null;g!==null;)g.alternate!==null&&(S=g),g=g.sibling;S===null?p.tail=null:S.sibling=null;break;case"collapsed":S=p.tail;for(var C=null;S!==null;)S.alternate!==null&&(C=S),S=S.sibling;C===null?g||p.tail===null?p.tail=null:p.tail.sibling=null:C.sibling=null}}function is(p){var g=p.alternate!==null&&p.alternate.child===p.child,S=0,C=0;if(g)for(var I=p.child;I!==null;)S|=I.lanes|I.childLanes,C|=I.subtreeFlags&31457280,C|=I.flags&31457280,I.return=p,I=I.sibling;else for(I=p.child;I!==null;)S|=I.lanes|I.childLanes,C|=I.subtreeFlags,C|=I.flags,I.return=p,I=I.sibling;return p.subtreeFlags|=C,p.childLanes=S,g}function b1(p,g,S){var C=g.pendingProps;switch(Ee(g),g.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return is(g),null;case 1:return is(g),null;case 3:return S=g.stateNode,C=null,p!==null&&(C=p.memoizedState.cache),g.memoizedState.cache!==C&&(g.flags|=2048),Xl(ys),Ce(),S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(p===null||p.child===null)&&(cn(g)?fa(g):p===null||p.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,oo!==null&&(Zl(oo),oo=null))),op(p,g),is(g),null;case 26:if(Ua){S=g.type;var I=g.memoizedState;return p===null?(fa(g),I!==null?(is(g),Vg(g,I)):(is(g),zg(g,S,C))):I?I!==p.memoizedState?(fa(g),is(g),Vg(g,I)):(is(g),g.flags&=-16777217):(ss?p.memoizedProps!==C&&fa(g):Gg(p,g,S,C),is(g),zg(g,S,C)),null}case 27:if(dr){if(Ze(g),S=hc.current,I=g.type,p!==null&&g.stateNode!=null)ss?p.memoizedProps!==C&&fa(g):Gg(p,g,I,C);else{if(!C){if(g.stateNode===null)throw Error(s(166));return is(g),null}p=_s.current,cn(g)?Mt(g,p):(p=u2(I,C,S,p,!0),g.stateNode=p,fa(g))}return is(g),null}case 5:if(Ze(g),S=g.type,p!==null&&g.stateNode!=null)Gg(p,g,S,C);else{if(!C){if(g.stateNode===null)throw Error(s(166));return is(g),null}p=_s.current,cn(g)?Mt(g,p):(I=Cx(S,C,hc.current,p,g),_h(I,g,!1,!1),g.stateNode=I,e2(I,S,C,p)&&fa(g))}return is(g),zg(g,g.type,g.pendingProps),null;case 6:if(p&&g.stateNode!=null)S=p.memoizedProps,ss?S!==C&&fa(g):Po&&(S!==C?(g.stateNode=As(C,hc.current,_s.current,g),fa(g)):g.stateNode=p.stateNode);else{if(typeof C!="string"&&g.stateNode===null)throw Error(s(166));if(p=hc.current,S=_s.current,cn(g)){if(!va)throw Error(s(176));if(p=g.stateNode,S=g.memoizedProps,C=null,I=Ss,I!==null)switch(I.tag){case 27:case 5:C=I.memoizedProps}l2(p,S,g,C)||tt(g)}else g.stateNode=As(C,p,S,g)}return is(g),null;case 13:if(C=g.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(I=cn(g),C!==null&&C.dehydrated!==null){if(p===null){if(!I)throw Error(s(318));if(!va)throw Error(s(344));if(I=g.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(s(317));r_(I,g)}else tn(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;is(g),I=!1}else oo!==null&&(Zl(oo),oo=null),I=!0;if(!I)return g.flags&256?(sn(g),g):(sn(g),null)}if(sn(g),(g.flags&128)!==0)return g.lanes=S,g;if(S=C!==null,p=p!==null&&p.memoizedState!==null,S){C=g.child,I=null,C.alternate!==null&&C.alternate.memoizedState!==null&&C.alternate.memoizedState.cachePool!==null&&(I=C.alternate.memoizedState.cachePool.pool);var k=null;C.memoizedState!==null&&C.memoizedState.cachePool!==null&&(k=C.memoizedState.cachePool.pool),k!==I&&(C.flags|=2048)}return S!==p&&S&&(g.child.flags|=8192),rd(g,g.updateQueue),is(g),null;case 4:return Ce(),op(p,g),p===null&&D1(g.stateNode.containerInfo),is(g),null;case 10:return Xl(g.type),is(g),null;case 19:if(A(Xi),I=g.memoizedState,I===null)return is(g),null;if(C=(g.flags&128)!==0,k=I.rendering,k===null)if(C)ad(I,!1);else{if(as!==0||p!==null&&(p.flags&128)!==0)for(p=g.child;p!==null;){if(k=$i(p),k!==null){for(g.flags|=128,ad(I,!1),p=k.updateQueue,g.updateQueue=p,rd(g,p),g.subtreeFlags=0,p=S,S=g.child;S!==null;)Rh(S,p),S=S.sibling;return T(Xi,Xi.current&1|2),g.child}p=p.sibling}I.tail!==null&&ka()>za&&(g.flags|=128,C=!0,ad(I,!1),g.lanes=4194304)}else{if(!C)if(p=$i(k),p!==null){if(g.flags|=128,C=!0,p=p.updateQueue,g.updateQueue=p,rd(g,p),ad(I,!0),I.tail===null&&I.tailMode==="hidden"&&!k.alternate&&!ii)return is(g),null}else 2*ka()-I.renderingStartTime>za&&S!==536870912&&(g.flags|=128,C=!0,ad(I,!1),g.lanes=4194304);I.isBackwards?(k.sibling=g.child,g.child=k):(p=I.last,p!==null?p.sibling=k:g.child=k,I.last=k)}return I.tail!==null?(g=I.tail,I.rendering=g,I.tail=g.sibling,I.renderingStartTime=ka(),g.sibling=null,p=Xi.current,T(Xi,C?p&1|2:p&1),g):(is(g),null);case 22:case 23:return sn(g),vr(),C=g.memoizedState!==null,p!==null?p.memoizedState!==null!==C&&(g.flags|=8192):C&&(g.flags|=8192),C?(S&536870912)!==0&&(g.flags&128)===0&&(is(g),g.subtreeFlags&6&&(g.flags|=8192)):is(g),S=g.updateQueue,S!==null&&rd(g,S.retryQueue),S=null,p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(S=p.memoizedState.cachePool.pool),C=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(C=g.memoizedState.cachePool.pool),C!==S&&(g.flags|=2048),p!==null&&A(Gh),null;case 24:return S=null,p!==null&&(S=p.memoizedState.cache),g.memoizedState.cache!==S&&(g.flags|=2048),Xl(ys),is(g),null;case 25:return null}throw Error(s(156,g.tag))}function FM(p,g){switch(Ee(g),g.tag){case 1:return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 3:return Xl(ys),Ce(),p=g.flags,(p&65536)!==0&&(p&128)===0?(g.flags=p&-65537|128,g):null;case 26:case 27:case 5:return Ze(g),null;case 13:if(sn(g),p=g.memoizedState,p!==null&&p.dehydrated!==null){if(g.alternate===null)throw Error(s(340));tn()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 19:return A(Xi),null;case 4:return Ce(),null;case 10:return Xl(g.type),null;case 22:case 23:return sn(g),vr(),p!==null&&A(Gh),p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 24:return Xl(ys),null;case 25:return null;default:return null}}function A1(p,g){switch(Ee(g),g.tag){case 3:Xl(ys),Ce();break;case 26:case 27:case 5:Ze(g);break;case 4:Ce();break;case 13:sn(g);break;case 19:A(Xi);break;case 10:Xl(g.type);break;case 22:case 23:sn(g),vr(),p!==null&&A(Gh);break;case 24:Xl(ys)}}function lp(p,g){try{var S=g.updateQueue,C=S!==null?S.lastEffect:null;if(C!==null){var I=C.next;S=I;do{if((S.tag&p)===p){C=void 0;var k=S.create,$=S.inst;C=k(),$.destroy=C}S=S.next}while(S!==I)}}catch(ye){Ei(g,g.return,ye)}}function au(p,g,S){try{var C=g.updateQueue,I=C!==null?C.lastEffect:null;if(I!==null){var k=I.next;C=k;do{if((C.tag&p)===p){var $=C.inst,ye=$.destroy;if(ye!==void 0){$.destroy=void 0,I=g;var Ie=S;try{ye()}catch(lt){Ei(I,Ie,lt)}}}C=C.next}while(C!==k)}}catch(lt){Ei(g,g.return,lt)}}function E1(p){var g=p.updateQueue;if(g!==null){var S=p.stateNode;try{Oe(g,S)}catch(C){Ei(p,p.return,C)}}}function da(p,g,S){S.props=Kl(p.type,p.memoizedProps),S.state=p.memoizedState;try{S.componentWillUnmount()}catch(C){Ei(p,g,C)}}function Bo(p,g){try{var S=p.ref;if(S!==null){var C=p.stateNode;switch(p.tag){case 26:case 27:case 5:var I=Ih(C);break;default:I=C}typeof S=="function"?p.refCleanup=S(I):S.current=I}}catch(k){Ei(p,g,k)}}function pa(p,g){var S=p.ref,C=p.refCleanup;if(S!==null)if(typeof C=="function")try{C()}catch(I){Ei(p,g,I)}finally{p.refCleanup=null,p=p.alternate,p!=null&&(p.refCleanup=null)}else if(typeof S=="function")try{S(null)}catch(I){Ei(p,g,I)}else S.current=null}function px(p){var g=p.type,S=p.memoizedProps,C=p.stateNode;try{V1(C,g,S,p)}catch(I){Ei(p,p.return,I)}}function mx(p,g,S){try{Y1(p.stateNode,p.type,S,g,p)}catch(C){Ei(p,p.return,C)}}function gx(p){return p.tag===5||p.tag===3||(Ua?p.tag===26:!1)||(dr?p.tag===27:!1)||p.tag===4}function cp(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||gx(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&(!dr||p.tag!==27)&&p.tag!==18;){if(p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function yx(p,g,S){var C=p.tag;if(C===5||C===6)p=p.stateNode,g?Bx(S,p,g):Ix(S,p);else if(!(C===4||dr&&C===27)&&(p=p.child,p!==null))for(yx(p,g,S),p=p.sibling;p!==null;)yx(p,g,S),p=p.sibling}function Yg(p,g,S){var C=p.tag;if(C===5||C===6)p=p.stateNode,g?K1(S,p,g):G1(S,p);else if(!(C===4||dr&&C===27)&&(p=p.child,p!==null))for(Yg(p,g,S),p=p.sibling;p!==null;)Yg(p,g,S),p=p.sibling}function Sh(p,g,S){p=p.containerInfo;try{Z1(p,S)}catch(C){Ei(g,g.return,C)}}function vx(p,g){for(R1(p.containerInfo),un=g;un!==null;)if(p=un,g=p.child,(p.subtreeFlags&1028)!==0&&g!==null)g.return=p,un=g;else for(;un!==null;){p=un;var S=p.alternate;switch(g=p.flags,p.tag){case 0:break;case 11:case 15:break;case 1:if((g&1024)!==0&&S!==null){g=void 0;var C=p,I=S.memoizedProps;S=S.memoizedState;var k=C.stateNode;try{var $=Kl(C.type,I,C.elementType===C.type);g=k.getSnapshotBeforeUpdate($,S),k.__reactInternalSnapshotBeforeUpdate=g}catch(ye){Ei(C,C.return,ye)}}break;case 3:(g&1024)!==0&&ss&&Q1(p.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((g&1024)!==0)throw Error(s(163))}if(g=p.sibling,g!==null){g.return=p.return,un=g;break}un=p.return}return $=ki,ki=!1,$}function od(p,g,S){var C=S.flags;switch(S.tag){case 0:case 11:case 15:ql(p,S),C&4&&lp(5,S);break;case 1:if(ql(p,S),C&4)if(p=S.stateNode,g===null)try{p.componentDidMount()}catch(ye){Ei(S,S.return,ye)}else{var I=Kl(S.type,g.memoizedProps);g=g.memoizedState;try{p.componentDidUpdate(I,g,p.__reactInternalSnapshotBeforeUpdate)}catch(ye){Ei(S,S.return,ye)}}C&64&&E1(S),C&512&&Bo(S,S.return);break;case 3:if(ql(p,S),C&64&&(C=S.updateQueue,C!==null)){if(p=null,S.child!==null)switch(S.child.tag){case 27:case 5:p=Ih(S.child.stateNode);break;case 1:p=S.child.stateNode}try{Oe(C,p)}catch(ye){Ei(S,S.return,ye)}}break;case 26:if(Ua){ql(p,S),C&512&&Bo(S,S.return);break}case 27:case 5:ql(p,S),g===null&&C&4&&px(S),C&512&&Bo(S,S.return);break;case 12:ql(p,S);break;case 13:ql(p,S),C&4&&Th(p,S);break;case 22:if(I=S.memoizedState!==null||yc,!I){g=g!==null&&g.memoizedState!==null||An;var k=yc,$=An;yc=I,(An=g)&&!$?ou(p,S,(S.subtreeFlags&8772)!==0):ql(p,S),yc=k,An=$}C&512&&(S.memoizedProps.mode==="manual"?Bo(S,S.return):pa(S,S.return));break;default:ql(p,S)}}function Kg(p){var g=p.alternate;g!==null&&(p.alternate=null,Kg(g)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(g=p.stateNode,g!==null&&B1(g)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}function no(p,g,S){for(S=S.child;S!==null;)jl(p,g,S),S=S.sibling}function jl(p,g,S){if(ks&&typeof ks.onCommitFiberUnmount=="function")try{ks.onCommitFiberUnmount(Ad,S)}catch{}switch(S.tag){case 26:if(Ua){An||pa(S,g),no(p,g,S),S.memoizedState?Vx(S.memoizedState):S.stateNode&&vd(S.stateNode);break}case 27:if(dr){An||pa(S,g);var C=hi,I=Ms;hi=S.stateNode,no(p,g,S),qx(S.stateNode),hi=C,Ms=I;break}case 5:An||pa(S,g);case 6:if(ss){if(C=hi,I=Ms,hi=null,no(p,g,S),hi=C,Ms=I,hi!==null)if(Ms)try{X1(hi,S.stateNode)}catch(k){Ei(S,g,k)}else try{W1(hi,S.stateNode)}catch(k){Ei(S,g,k)}}else no(p,g,S);break;case 18:ss&&hi!==null&&(Ms?Fx(hi,S.stateNode):l_(hi,S.stateNode));break;case 4:ss?(C=hi,I=Ms,hi=S.stateNode.containerInfo,Ms=!0,no(p,g,S),hi=C,Ms=I):(Po&&Sh(S.stateNode,S,a2()),no(p,g,S));break;case 0:case 11:case 14:case 15:An||au(2,S,g),An||au(4,S,g),no(p,g,S);break;case 1:An||(pa(S,g),C=S.stateNode,typeof C.componentWillUnmount=="function"&&da(S,g,C)),no(p,g,S);break;case 21:no(p,g,S);break;case 22:An||pa(S,g),An=(C=An)||S.memoizedState!==null,no(p,g,S),An=C;break;default:no(p,g,S)}}function Th(p,g){if(va&&g.memoizedState===null&&(p=g.alternate,p!==null&&(p=p.memoizedState,p!==null&&(p=p.dehydrated,p!==null))))try{c2(p)}catch(S){Ei(g,g.return,S)}}function xx(p){switch(p.tag){case 13:case 19:var g=p.stateNode;return g===null&&(g=p.stateNode=new zn),g;case 22:return p=p.stateNode,g=p._retryCache,g===null&&(g=p._retryCache=new zn),g;default:throw Error(s(435,p.tag))}}function Wg(p,g){var S=xx(p);g.forEach(function(C){var I=$g.bind(null,p,C);S.has(C)||(S.add(C),C.then(I,I))})}function Ps(p,g){var S=g.deletions;if(S!==null)for(var C=0;C<S.length;C++){var I=S[C],k=p,$=g;if(ss){var ye=$;e:for(;ye!==null;){switch(ye.tag){case 27:case 5:hi=ye.stateNode,Ms=!1;break e;case 3:hi=ye.stateNode.containerInfo,Ms=!0;break e;case 4:hi=ye.stateNode.containerInfo,Ms=!0;break e}ye=ye.return}if(hi===null)throw Error(s(160));jl(k,$,I),hi=null,Ms=!1}else jl(k,$,I);k=I.alternate,k!==null&&(k.return=null),I.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)bx(g,p),g=g.sibling}function bx(p,g){var S=p.alternate,C=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:Ps(g,p),ma(p),C&4&&(au(3,p,p.return),lp(3,p),au(5,p,p.return));break;case 1:Ps(g,p),ma(p),C&512&&(An||S===null||pa(S,S.return)),C&64&&yc&&(p=p.updateQueue,p!==null&&(C=p.callbacks,C!==null&&(S=p.shared.hiddenCallbacks,p.shared.hiddenCallbacks=S===null?C:S.concat(C))));break;case 26:if(Ua){var I=Nr;Ps(g,p),ma(p),C&512&&(An||S===null||pa(S,S.return)),C&4&&(C=S!==null?S.memoizedState:null,g=p.memoizedState,S===null?g===null?p.stateNode===null?p.stateNode=u_(I,p.type,p.memoizedProps,p):Yx(I,p.type,p.stateNode):p.stateNode=zx(I,g,p.memoizedProps):C!==g?(C===null?S.stateNode!==null&&vd(S.stateNode):Vx(C),g===null?Yx(I,p.type,p.stateNode):zx(I,g,p.memoizedProps)):g===null&&p.stateNode!==null&&mx(p,p.memoizedProps,S.memoizedProps));break}case 27:if(dr&&C&4&&p.alternate===null){I=p.stateNode;var k=p.memoizedProps;try{d_(I),jx(p.type,k,I,p)}catch(Lt){Ei(p,p.return,Lt)}}case 5:if(Ps(g,p),ma(p),C&512&&(An||S===null||pa(S,S.return)),ss){if(p.flags&32){g=p.stateNode;try{r2(g)}catch(Lt){Ei(p,p.return,Lt)}}C&4&&p.stateNode!=null&&(g=p.memoizedProps,mx(p,g,S!==null?S.memoizedProps:g)),C&1024&&(Ii=!0)}break;case 6:if(Ps(g,p),ma(p),C&4&&ss){if(p.stateNode===null)throw Error(s(162));C=p.memoizedProps,S=S!==null?S.memoizedProps:C,g=p.stateNode;try{z1(g,S,C)}catch(Lt){Ei(p,p.return,Lt)}}break;case 3:if(Ua?(h_(),I=Nr,Nr=Js(g.containerInfo),Ps(g,p),Nr=I):Ps(g,p),ma(p),C&4){if(ss&&va&&S!==null&&S.memoizedState.isDehydrated)try{o_(g.containerInfo)}catch(Lt){Ei(p,p.return,Lt)}if(Po){C=g.containerInfo,S=g.pendingChildren;try{Z1(C,S)}catch(Lt){Ei(p,p.return,Lt)}}}Ii&&(Ii=!1,Ax(p));break;case 4:Ua?(S=Nr,Nr=Js(p.stateNode.containerInfo),Ps(g,p),ma(p),Nr=S):(Ps(g,p),ma(p)),C&4&&Po&&Sh(p.stateNode,p,p.stateNode.pendingChildren);break;case 12:Ps(g,p),ma(p);break;case 13:Ps(g,p),ma(p),p.child.flags&8192&&p.memoizedState!==null!=(S!==null&&S.memoizedState!==null)&&(eb=ka()),C&4&&(C=p.updateQueue,C!==null&&(p.updateQueue=null,Wg(p,C)));break;case 22:C&512&&(An||S===null||pa(S,S.return)),I=p.memoizedState!==null;var $=S!==null&&S.memoizedState!==null,ye=yc,Ie=An;if(yc=ye||I,An=Ie||$,Ps(g,p),An=Ie,yc=ye,ma(p),g=p.stateNode,g._current=p,g._visibility&=-3,g._visibility|=g._pendingVisibility&2,C&8192&&(g._visibility=I?g._visibility&-2:g._visibility|1,I&&(g=yc||An,S===null||$||g||ld(p)),ss&&(p.memoizedProps===null||p.memoizedProps.mode!=="manual"))){e:if(S=null,ss)for(g=p;;){if(g.tag===5||Ua&&g.tag===26||dr&&g.tag===27){if(S===null){$=S=g;try{k=$.stateNode,I?j1(k):WM($.stateNode,$.memoizedProps)}catch(Lt){Ei($,$.return,Lt)}}}else if(g.tag===6){if(S===null){$=g;try{var lt=$.stateNode;I?q1(lt):Ox(lt,$.memoizedProps)}catch(Lt){Ei($,$.return,Lt)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===p)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break e;for(;g.sibling===null;){if(g.return===null||g.return===p)break e;S===g&&(S=null),g=g.return}S===g&&(S=null),g.sibling.return=g.return,g=g.sibling}}C&4&&(C=p.updateQueue,C!==null&&(S=C.retryQueue,S!==null&&(C.retryQueue=null,Wg(p,S))));break;case 19:Ps(g,p),ma(p),C&4&&(C=p.updateQueue,C!==null&&(p.updateQueue=null,Wg(p,C)));break;case 21:break;default:Ps(g,p),ma(p)}}function ma(p){var g=p.flags;if(g&2){try{if(ss&&(!dr||p.tag!==27)){e:{for(var S=p.return;S!==null;){if(gx(S)){var C=S;break e}S=S.return}throw Error(s(160))}switch(C.tag){case 27:if(dr){var I=C.stateNode,k=cp(p);Yg(p,k,I);break}case 5:var $=C.stateNode;C.flags&32&&(r2($),C.flags&=-33);var ye=cp(p);Yg(p,ye,$);break;case 3:case 4:var Ie=C.stateNode.containerInfo,lt=cp(p);yx(p,lt,Ie);break;default:throw Error(s(161))}}}catch(Lt){Ei(p,p.return,Lt)}p.flags&=-3}g&4096&&(p.flags&=-4097)}function Ax(p){if(p.subtreeFlags&1024)for(p=p.child;p!==null;){var g=p;Ax(g),g.tag===5&&g.flags&1024&&P1(g.stateNode),p=p.sibling}}function ql(p,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)od(p,g.alternate,g),g=g.sibling}function ld(p){for(p=p.child;p!==null;){var g=p;switch(g.tag){case 0:case 11:case 14:case 15:au(4,g,g.return),ld(g);break;case 1:pa(g,g.return);var S=g.stateNode;typeof S.componentWillUnmount=="function"&&da(g,g.return,S),ld(g);break;case 26:case 27:case 5:pa(g,g.return),ld(g);break;case 22:pa(g,g.return),g.memoizedState===null&&ld(g);break;default:ld(g)}p=p.sibling}}function ou(p,g,S){for(S=S&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var C=g.alternate,I=p,k=g,$=k.flags;switch(k.tag){case 0:case 11:case 15:ou(I,k,S),lp(4,k);break;case 1:if(ou(I,k,S),C=k,I=C.stateNode,typeof I.componentDidMount=="function")try{I.componentDidMount()}catch(lt){Ei(C,C.return,lt)}if(C=k,I=C.updateQueue,I!==null){var ye=C.stateNode;try{var Ie=I.shared.hiddenCallbacks;if(Ie!==null)for(I.shared.hiddenCallbacks=null,I=0;I<Ie.length;I++)xe(Ie[I],ye)}catch(lt){Ei(C,C.return,lt)}}S&&$&64&&E1(k),Bo(k,k.return);break;case 26:case 27:case 5:ou(I,k,S),S&&C===null&&$&4&&px(k),Bo(k,k.return);break;case 12:ou(I,k,S);break;case 13:ou(I,k,S),S&&$&4&&Th(I,k);break;case 22:k.memoizedState===null&&ou(I,k,S),Bo(k,k.return);break;default:ou(I,k,S)}g=g.sibling}}function Xg(p,g){var S=null;p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(S=p.memoizedState.cachePool.pool),p=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(p=g.memoizedState.cachePool.pool),p!==S&&(p!=null&&p.refCount++,S!=null&&ap(S))}function jg(p,g){p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&ap(p))}function Ql(p,g,S,C){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)io(p,g,S,C),g=g.sibling}function io(p,g,S,C){var I=g.flags;switch(g.tag){case 0:case 11:case 15:Ql(p,g,S,C),I&2048&&lp(9,g);break;case 3:Ql(p,g,S,C),I&2048&&(p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&ap(p)));break;case 12:if(I&2048){Ql(p,g,S,C),p=g.stateNode;try{var k=g.memoizedProps,$=k.id,ye=k.onPostCommit;typeof ye=="function"&&ye($,g.alternate===null?"mount":"update",p.passiveEffectDuration,-0)}catch(Ie){Ei(g,g.return,Ie)}}else Ql(p,g,S,C);break;case 23:break;case 22:k=g.stateNode,g.memoizedState!==null?k._visibility&4?Ql(p,g,S,C):rl(p,g):k._visibility&4?Ql(p,g,S,C):(k._visibility|=4,Er(p,g,S,C,(g.subtreeFlags&10256)!==0)),I&2048&&Xg(g.alternate,g);break;case 24:Ql(p,g,S,C),I&2048&&jg(g.alternate,g);break;default:Ql(p,g,S,C)}}function Er(p,g,S,C,I){for(I=I&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var k=p,$=g,ye=S,Ie=C,lt=$.flags;switch($.tag){case 0:case 11:case 15:Er(k,$,ye,Ie,I),lp(8,$);break;case 23:break;case 22:var Lt=$.stateNode;$.memoizedState!==null?Lt._visibility&4?Er(k,$,ye,Ie,I):rl(k,$):(Lt._visibility|=4,Er(k,$,ye,Ie,I)),I&&lt&2048&&Xg($.alternate,$);break;case 24:Er(k,$,ye,Ie,I),I&&lt&2048&&jg($.alternate,$);break;default:Er(k,$,ye,Ie,I)}g=g.sibling}}function rl(p,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var S=p,C=g,I=C.flags;switch(C.tag){case 22:rl(S,C),I&2048&&Xg(C.alternate,C);break;case 24:rl(S,C),I&2048&&jg(C.alternate,C);break;default:rl(S,C)}g=g.sibling}}function $l(p){if(p.subtreeFlags&Ou)for(p=p.child;p!==null;)up(p),p=p.sibling}function up(p){switch(p.tag){case 26:$l(p),p.flags&Ou&&(p.memoizedState!==null?Xx(Nr,p.memoizedState,p.memoizedProps):Lx(p.type,p.memoizedProps));break;case 5:$l(p),p.flags&Ou&&Lx(p.type,p.memoizedProps);break;case 3:case 4:if(Ua){var g=Nr;Nr=Js(p.stateNode.containerInfo),$l(p),Nr=g}else $l(p);break;case 22:p.memoizedState===null&&(g=p.alternate,g!==null&&g.memoizedState!==null?(g=Ou,Ou=16777216,$l(p),Ou=g):$l(p));break;default:$l(p)}}function hp(p){var g=p.alternate;if(g!==null&&(p=g.child,p!==null)){g.child=null;do g=p.sibling,p.sibling=null,p=g;while(p!==null)}}function wh(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var S=0;S<g.length;S++){var C=g[S];un=C,dp(C,p)}hp(p)}if(p.subtreeFlags&10256)for(p=p.child;p!==null;)Jl(p),p=p.sibling}function Jl(p){switch(p.tag){case 0:case 11:case 15:wh(p),p.flags&2048&&au(9,p,p.return);break;case 3:wh(p);break;case 12:wh(p);break;case 22:var g=p.stateNode;p.memoizedState!==null&&g._visibility&4&&(p.return===null||p.return.tag!==13)?(g._visibility&=-5,fp(p)):wh(p);break;default:wh(p)}}function fp(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var S=0;S<g.length;S++){var C=g[S];un=C,dp(C,p)}hp(p)}for(p=p.child;p!==null;){switch(g=p,g.tag){case 0:case 11:case 15:au(8,g,g.return),fp(g);break;case 22:S=g.stateNode,S._visibility&4&&(S._visibility&=-5,fp(g));break;default:fp(g)}p=p.sibling}}function dp(p,g){for(;un!==null;){var S=un;switch(S.tag){case 0:case 11:case 15:au(8,S,g);break;case 23:case 22:if(S.memoizedState!==null&&S.memoizedState.cachePool!==null){var C=S.memoizedState.cachePool.pool;C!=null&&C.refCount++}break;case 24:ap(S.memoizedState.cache)}if(C=S.child,C!==null)C.return=S,un=C;else e:for(S=p;un!==null;){C=un;var I=C.sibling,k=C.return;if(Kg(C),C===S){un=null;break e}if(I!==null){I.return=k,un=I;break e}un=k}}}function lu(p){var g=n2(p);if(g!=null){if(typeof g.memoizedProps["data-testname"]!="string")throw Error(s(364));return g}if(p=k1(p),p===null)throw Error(s(362));return p.stateNode.current}function qg(p,g){var S=p.tag;switch(g.$$typeof){case es:if(p.type===g.value)return!0;break;case zo:e:{for(g=g.value,p=[p,0],S=0;S<p.length;){var C=p[S++],I=C.tag,k=p[S++],$=g[k];if(I!==5&&I!==26&&I!==27||!hl(C)){for(;$!=null&&qg(C,$);)k++,$=g[k];if(k===g.length){g=!0;break e}else for(C=C.child;C!==null;)p.push(C,k),C=C.sibling}}g=!1}return g;case yl:if((S===5||S===26||S===27)&&H1(p.stateNode,g.value))return!0;break;case ea:if((S===5||S===6||S===26||S===27)&&(p=F1(p),p!==null&&0<=p.indexOf(g.value)))return!0;break;case Md:if((S===5||S===26||S===27)&&(p=p.memoizedProps["data-testname"],typeof p=="string"&&p.toLowerCase()===g.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function ga(p){switch(p.$$typeof){case es:return"<"+(a(p.value)||"Unknown")+">";case zo:return":has("+(ga(p)||"")+")";case yl:return'[role="'+p.value+'"]';case ea:return'"'+p.value+'"';case Md:return'[data-testname="'+p.value+'"]';default:throw Error(s(365))}}function Mh(p,g){var S=[];p=[p,0];for(var C=0;C<p.length;){var I=p[C++],k=I.tag,$=p[C++],ye=g[$];if(k!==5&&k!==26&&k!==27||!hl(I)){for(;ye!=null&&qg(I,ye);)$++,ye=g[$];if($===g.length)S.push(I);else for(I=I.child;I!==null;)p.push(I,$),I=I.sibling}}return S}function cu(p,g){if(!yd)throw Error(s(363));p=lu(p),p=Mh(p,g),g=[],p=Array.from(p);for(var S=0;S<p.length;){var C=p[S++],I=C.tag;if(I===5||I===26||I===27)hl(C)||g.push(C.stateNode);else for(C=C.child;C!==null;)p.push(C),C=C.sibling}return g}function Rr(){if((Xn&2)!==0&&jn!==0)return jn&-jn;if(vn.T!==null){var p=Zi;return p!==0?p:ot()}return L1()}function pp(){Ga===0&&(Ga=(jn&536870912)===0||ii?P():536870912);var p=Aa.current;return p!==null&&(p.flags|=32),Ga}function Wi(p,g,S){(p===Bi&&Ci===2||p.cancelPendingCommit!==null)&&(uu(p,0),qr(p,jn,Ga,!1)),F(p,S),((Xn&2)===0||p!==Bi)&&(p===Bi&&((Xn&2)===0&&(xc|=S),as===4&&qr(p,jn,Ga,!1)),nt(p))}function Pa(p,g,S){if((Xn&6)!==0)throw Error(s(327));var C=!S&&(g&60)===0&&(g&p.expiredLanes)===0||N(p,g),I=C?_1(p,g):gp(p,g,!0),k=C;do{if(I===0){fo&&!C&&qr(p,g,0,!1);break}else if(I===6)qr(p,g,0,!ho);else{if(S=p.current.alternate,k&&!ec(S)){I=gp(p,g,!1),k=!1;continue}if(I===2){if(k=g,p.errorRecoveryDisabledLanes&k)var $=0;else $=p.pendingLanes&-536870913,$=$!==0?$:$&536870912?536870912:0;if($!==0){g=$;e:{var ye=p;I=Cd;var Ie=va&&ye.current.memoizedState.isDehydrated;if(Ie&&(uu(ye,$).flags|=256),$=gp(ye,$,!1),$!==2){if(zh&&!Ie){ye.errorRecoveryDisabledLanes|=k,xc|=k,I=4;break e}k=mo,mo=I,k!==null&&Zl(k)}I=$}if(k=!1,I!==2)continue}}if(I===1){uu(p,0),qr(p,g,0,!0);break}e:{switch(C=p,I){case 0:case 1:throw Error(s(345));case 4:if((g&4194176)===g){qr(C,g,Ga,!ho);break e}break;case 2:mo=null;break;case 3:case 5:break;default:throw Error(s(329))}if(C.finishedWork=S,C.finishedLanes=g,(g&62914560)===g&&(k=eb+300-ka(),10<k)){if(qr(C,g,Ga,!ho),O(C,0)!==0)break e;C.timeoutHandle=t2(al.bind(null,C,S,mo,Vh,b2,g,Ga,xc,Gs,ho,2,-0,0),k);break e}al(C,S,mo,Vh,b2,g,Ga,xc,Gs,ho,0,-0,0)}}break}while(!0);nt(p)}function Zl(p){mo===null?mo=p:mo.push.apply(mo,p)}function al(p,g,S,C,I,k,$,ye,Ie,lt,Lt,Gt,Tt){var En=g.subtreeFlags;if((En&8192||(En&16785408)===16785408)&&(YM(),up(g),g=O1(),g!==null)){p.cancelPendingCommit=g(Qg.bind(null,p,S,C,I,$,ye,Ie,1,Gt,Tt)),qr(p,k,$,!lt);return}Qg(p,S,C,I,$,ye,Ie,Lt,Gt,Tt)}function ec(p){for(var g=p;;){var S=g.tag;if((S===0||S===11||S===15)&&g.flags&16384&&(S=g.updateQueue,S!==null&&(S=S.stores,S!==null)))for(var C=0;C<S.length;C++){var I=S[C],k=I.getSnapshot;I=I.value;try{if(!$r(k(),I))return!1}catch{return!1}}if(S=g.child,g.subtreeFlags&16384&&S!==null)S.return=g,g=S;else{if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function qr(p,g,S,C){g&=~ta,g&=~xc,p.suspendedLanes|=g,p.pingedLanes&=~g,C&&(p.warmLanes|=g),C=p.expirationTimes;for(var I=g;0<I;){var k=31-Es(I),$=1<<k;C[k]=-1,I&=~$}S!==0&&J(p,S,g)}function Ex(){return(Xn&6)===0?(ee(0),!1):!0}function mp(){if(Un!==null){if(Ci===0)var p=Un.return;else p=Un,uo=Bu=null,gt(p),Fh=null,Pr=0,p=Un;for(;p!==null;)A1(p.alternate,p),p=p.return;Un=null}}function uu(p,g){p.finishedWork=null,p.finishedLanes=0;var S=p.timeoutHandle;S!==gd&&(p.timeoutHandle=gd,Sp(S)),S=p.cancelPendingCommit,S!==null&&(p.cancelPendingCommit=null,S()),mp(),Bi=p,Un=S=nc(p.current,null),jn=g,Ci=0,Hs=null,ho=!1,fo=N(p,g),zh=!1,Gs=Ga=ta=xc=po=as=0,mo=Cd=null,b2=!1,(g&8)!==0&&(g|=g&32);var C=p.entangledLanes;if(C!==0)for(p=p.entanglements,C&=g;0<C;){var I=31-Es(C),k=1<<I;g|=p[I],C&=~k}return Vo=g,te(),S}function Dr(p,g){bn=null,vn.H=ws,g===Dp?(g=$t(),Ci=3):g===Lp?(g=$t(),Ci=4):Ci=g===Jx?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,Hs=g,Un===null&&(as=1,td(p,ue(g,p.current)))}function fr(){var p=Aa.current;return p===null?!0:(jn&4194176)===jn?lo===null:(jn&62914560)===jn||(jn&536870912)!==0?p===lo:!1}function ni(){var p=vn.H;return vn.H=ws,p===null?ws:p}function so(){var p=vn.A;return vn.A=vc,p}function ro(){as=4,ho||(jn&4194176)!==jn&&Aa.current!==null||(fo=!0),(po&134217727)===0&&(xc&134217727)===0||Bi===null||qr(Bi,jn,Ga,!1)}function gp(p,g,S){var C=Xn;Xn|=2;var I=ni(),k=so();(Bi!==p||jn!==g)&&(Vh=null,uu(p,g)),g=!1;var $=as;e:do try{if(Ci!==0&&Un!==null){var ye=Un,Ie=Hs;switch(Ci){case 8:mp(),$=6;break e;case 3:case 2:case 6:Aa.current===null&&(g=!0);var lt=Ci;if(Ci=0,Hs=null,ol(p,ye,Ie,lt),S&&fo){$=0;break e}break;default:lt=Ci,Ci=0,Hs=null,ol(p,ye,Ie,lt)}}Ch(),$=as;break}catch(Lt){Dr(p,Lt)}while(!0);return g&&p.shellSuspendCounter++,uo=Bu=null,Xn=C,vn.H=I,vn.A=k,Un===null&&(Bi=null,jn=0,te()),$}function Ch(){for(;Un!==null;)cd(Un)}function _1(p,g){var S=Xn;Xn|=2;var C=ni(),I=so();Bi!==p||jn!==g?(Vh=null,za=ka()+500,uu(p,g)):fo=N(p,g);e:do try{if(Ci!==0&&Un!==null){g=Un;var k=Hs;t:switch(Ci){case 1:Ci=0,Hs=null,ol(p,g,k,1);break;case 2:if(rt(k)){Ci=0,Hs=null,ud(g);break}g=function(){Ci===2&&Bi===p&&(Ci=7),nt(p)},k.then(g,g);break e;case 3:Ci=7;break e;case 4:Ci=5;break e;case 7:rt(k)?(Ci=0,Hs=null,ud(g)):(Ci=0,Hs=null,ol(p,g,k,7));break;case 5:var $=null;switch(Un.tag){case 26:$=Un.memoizedState;case 5:case 27:var ye=Un,Ie=ye.type,lt=ye.pendingProps;if($?Wx($):Dx(Ie,lt)){Ci=0,Hs=null;var Lt=ye.sibling;if(Lt!==null)Un=Lt;else{var Gt=ye.return;Gt!==null?(Un=Gt,hu(Gt)):Un=null}break t}}Ci=0,Hs=null,ol(p,g,k,5);break;case 6:Ci=0,Hs=null,ol(p,g,k,6);break;case 8:mp(),as=6;break e;default:throw Error(s(462))}}S1();break}catch(Tt){Dr(p,Tt)}while(!0);return uo=Bu=null,vn.H=C,vn.A=I,Xn=S,Un!==null?0:(Bi=null,jn=0,te(),as)}function S1(){for(;Un!==null&&!Tu();)cd(Un)}function cd(p){var g=v1(p.alternate,p,Vo);p.memoizedProps=p.pendingProps,g===null?hu(p):Un=g}function ud(p){var g=p,S=g.alternate;switch(g.tag){case 15:case 0:g=f1(S,g,g.pendingProps,g.type,void 0,jn);break;case 11:g=f1(S,g,g.pendingProps,g.type.render,g.ref,jn);break;case 5:gt(g);default:A1(S,g),g=Un=Rh(g,Vo),g=v1(S,g,Vo)}p.memoizedProps=p.pendingProps,g===null?hu(p):Un=g}function ol(p,g,S,C){uo=Bu=null,gt(g),Fh=null,Pr=0;var I=g.return;try{if(UM(p,I,g,S,jn)){as=1,td(p,ue(S,p.current)),Un=null;return}}catch(k){if(I!==null)throw Un=I,k;as=1,td(p,ue(S,p.current)),Un=null;return}g.flags&32768?(ii||C===1?p=!0:fo||(jn&536870912)!==0?p=!1:(ho=p=!0,(C===2||C===3||C===6)&&(C=Aa.current,C!==null&&C.tag===13&&(C.flags|=16384))),_x(g,p)):hu(g)}function hu(p){var g=p;do{if((g.flags&32768)!==0){_x(g,ho);return}p=g.return;var S=b1(g.alternate,g,Vo);if(S!==null){Un=S;return}if(g=g.sibling,g!==null){Un=g;return}Un=g=p}while(g!==null);as===0&&(as=5)}function _x(p,g){do{var S=FM(p.alternate,p);if(S!==null){S.flags&=32767,Un=S;return}if(S=p.return,S!==null&&(S.flags|=32768,S.subtreeFlags=0,S.deletions=null),!g&&(p=p.sibling,p!==null)){Un=p;return}Un=p=S}while(p!==null);as=6,Un=null}function Qg(p,g,S,C,I,k,$,ye,Ie,lt){var Lt=vn.T,Gt=Eu();try{Qr(2),vn.T=null,T1(p,g,S,C,Gt,I,k,$,ye,Ie,lt)}finally{vn.T=Lt,Qr(Gt)}}function T1(p,g,S,C,I,k,$,ye){do fu();while(Pu!==null);if((Xn&6)!==0)throw Error(s(327));var Ie=p.finishedWork;if(C=p.finishedLanes,Ie===null)return null;if(p.finishedWork=null,p.finishedLanes=0,Ie===p.current)throw Error(s(177));p.callbackNode=null,p.callbackPriority=0,p.cancelPendingCommit=null;var lt=Ie.lanes|Ie.childLanes;if(lt|=Fo,j(p,C,lt,k,$,ye),p===Bi&&(Un=Bi=null,jn=0),(Ie.subtreeFlags&10256)===0&&(Ie.flags&10256)===0||bc||(bc=!0,A2=lt,Pp=S,w1(bd,function(){return fu(),null})),S=(Ie.flags&15990)!==0,(Ie.subtreeFlags&15990)!==0||S?(S=vn.T,vn.T=null,k=Eu(),Qr(2),$=Xn,Xn|=4,vx(p,Ie),bx(Ie,p),VM(p.containerInfo),p.current=Ie,od(p,Ie.alternate,Ie),uc(),Xn=$,Qr(k),vn.T=S):p.current=Ie,bc?(bc=!1,Pu=p,Rd=C):yp(p,lt),lt=p.pendingLanes,lt===0&&(xl=null),W(Ie.stateNode),nt(p),g!==null)for(I=p.onRecoverableError,Ie=0;Ie<g.length;Ie++)lt=g[Ie],I(lt.value,{componentStack:lt.stack});return(Rd&3)!==0&&fu(),lt=p.pendingLanes,(C&4194218)!==0&&(lt&42)!==0?p===tb?Yh++:(Yh=0,tb=p):Yh=0,ee(0),null}function yp(p,g){(p.pooledCacheLanes&=g)===0&&(g=p.pooledCache,g!=null&&(p.pooledCache=null,ap(g)))}function fu(){if(Pu!==null){var p=Pu,g=A2;A2=0;var S=q(Rd),C=32>S?32:S;S=vn.T;var I=Eu();try{if(Qr(C),vn.T=null,Pu===null)var k=!1;else{C=Pp,Pp=null;var $=Pu,ye=Rd;if(Pu=null,Rd=0,(Xn&6)!==0)throw Error(s(331));var Ie=Xn;if(Xn|=4,Jl($.current),io($,$.current,ye,C),Xn=Ie,ee(0,!1),ks&&typeof ks.onPostCommitFiberRoot=="function")try{ks.onPostCommitFiberRoot(Ad,$)}catch{}k=!0}return k}finally{Qr(I),vn.T=S,yp(p,g)}}return!1}function hd(p,g,S){g=ue(S,g),g=id(p.stateNode,g,2),p=Dt(p,g,2),p!==null&&(F(p,2),nt(p))}function Ei(p,g,S){if(p.tag===3)hd(p,p,S);else for(;g!==null;){if(g.tag===3){hd(g,p,S);break}else if(g.tag===1){var C=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof C.componentDidCatch=="function"&&(xl===null||!xl.has(C))){p=ue(S,p),S=rx(2),C=Dt(g,S,2),C!==null&&(o1(S,C,g,p),F(C,2),nt(C));break}}g=g.return}}function du(p,g,S){var C=p.pingCache;if(C===null){C=p.pingCache=new Op;var I=new Set;C.set(g,I)}else I=C.get(g),I===void 0&&(I=new Set,C.set(g,I));I.has(S)||(zh=!0,I.add(S),p=vp.bind(null,p,g,S),g.then(p,p))}function vp(p,g,S){var C=p.pingCache;C!==null&&C.delete(g),p.pingedLanes|=p.suspendedLanes&S,p.warmLanes&=~S,Bi===p&&(jn&S)===S&&(as===4||as===3&&(jn&62914560)===jn&&300>ka()-eb?(Xn&2)===0&&uu(p,0):ta|=S,Gs===jn&&(Gs=0)),nt(p)}function xp(p,g){g===0&&(g=B()),p=st(p,g),p!==null&&(F(p,g),nt(p))}function bp(p){var g=p.memoizedState,S=0;g!==null&&(S=g.retryLane),xp(p,S)}function $g(p,g){var S=0;switch(p.tag){case 13:var C=p.stateNode,I=p.memoizedState;I!==null&&(S=I.retryLane);break;case 19:C=p.stateNode;break;case 22:C=p.stateNode._retryCache;break;default:throw Error(s(314))}C!==null&&C.delete(g),xp(p,S)}function w1(p,g){return dl(p,g)}function M1(p,g,S,C){this.tag=p,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=C,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tc(p){return p=p.prototype,!(!p||!p.isReactComponent)}function nc(p,g){var S=p.alternate;return S===null?(S=t(p.tag,g,p.key,p.mode),S.elementType=p.elementType,S.type=p.type,S.stateNode=p.stateNode,S.alternate=p,p.alternate=S):(S.pendingProps=g,S.type=p.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=p.flags&31457280,S.childLanes=p.childLanes,S.lanes=p.lanes,S.child=p.child,S.memoizedProps=p.memoizedProps,S.memoizedState=p.memoizedState,S.updateQueue=p.updateQueue,g=p.dependencies,S.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},S.sibling=p.sibling,S.index=p.index,S.ref=p.ref,S.refCleanup=p.refCleanup,S}function Rh(p,g){p.flags&=31457282;var S=p.alternate;return S===null?(p.childLanes=0,p.lanes=g,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=S.childLanes,p.lanes=S.lanes,p.child=S.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=S.memoizedProps,p.memoizedState=S.memoizedState,p.updateQueue=S.updateQueue,p.type=S.type,g=S.dependencies,p.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),p}function Dh(p,g,S,C,I,k){var $=0;if(C=p,typeof p=="function")tc(p)&&($=1);else if(typeof p=="string")$=Ua&&dr?$s(p,S,_s.current)?26:h2(p)?27:5:Ua?$s(p,S,_s.current)?26:5:dr&&h2(p)?27:5;else e:switch(p){case gu:return pu(S.children,I,k,g);case Lh:$=8,I|=24;break;case yu:return p=t(12,S,g,I|2),p.elementType=yu,p.lanes=k,p;case rc:return p=t(13,S,g,I),p.elementType=rc,p.lanes=k,p;case Ep:return p=t(19,S,g,I),p.elementType=Ep,p.lanes=k,p;case oc:return Jg(S,I,k,g);default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case GM:case vu:$=10;break e;case wx:$=9;break e;case Zg:$=11;break e;case dd:$=14;break e;case ac:$=16,C=null;break e}$=29,S=Error(s(130,p===null?"null":typeof p,"")),C=null}return g=t($,S,g,I),g.elementType=p,g.type=C,g.lanes=k,g}function pu(p,g,S,C){return p=t(7,p,C,g),p.lanes=S,p}function Jg(p,g,S,C){p=t(22,p,C,g),p.elementType=oc,p.lanes=S;var I={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var k=I._current;if(k===null)throw Error(s(456));if((I._pendingVisibility&2)===0){var $=st(k,2);$!==null&&(I._pendingVisibility|=2,Wi($,k,2))}},attach:function(){var k=I._current;if(k===null)throw Error(s(456));if((I._pendingVisibility&2)!==0){var $=st(k,2);$!==null&&(I._pendingVisibility&=-3,Wi($,k,2))}}};return p.stateNode=I,p}function Ap(p,g,S){return p=t(6,p,null,g),p.lanes=S,p}function ya(p,g,S){return g=t(4,p.children!==null?p.children:[],p.key,g),g.lanes=S,g.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},g}function ll(p,g,S,C,I,k,$,ye){this.tag=1,this.containerInfo=p,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=gd,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=L(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=L(0),this.hiddenUpdates=L(null),this.identifierPrefix=C,this.onUncaughtError=I,this.onCaughtError=k,this.onRecoverableError=$,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ye,this.incompleteTransitions=new Map}function ic(p,g,S,C,I,k,$,ye,Ie,lt,Lt,Gt){return p=new ll(p,g,S,$,ye,Ie,lt,Gt),g=1,k===!0&&(g|=24),k=t(3,null,null,g),p.current=k,k.stateNode=p,g=ru(),g.refCount++,p.pooledCache=g,g.refCount++,k.memoizedState={element:C,isDehydrated:S,cache:g},it(k),p}function Sx(p){return p?(p=Uh,p):Uh}function sc(p){var g=p._reactInternals;if(g===void 0)throw typeof p.render=="function"?Error(s(188)):(p=Object.keys(p).join(","),Error(s(268,p)));return p=y(g),p=p!==null?x(p):null,p===null?null:Ih(p.stateNode)}function cl(p,g,S,C,I,k){I=Sx(I),C.context===null?C.context=I:C.pendingContext=I,C=Et(g),C.payload={element:S},k=k===void 0?null:k,k!==null&&(C.callback=k),S=Dt(p,C,g),S!==null&&(Wi(S,p,g),Nt(S,p,g))}function Ns(p,g){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var S=p.retryLane;p.retryLane=S!==0&&S<g?S:g}}function fd(p,g){Ns(p,g),(p=p.alternate)&&Ns(p,g)}var Wn={},HM=Vv(),Na=BI(),bs=Object.assign,Tx=Symbol.for("react.element"),mu=Symbol.for("react.transitional.element"),ul=Symbol.for("react.portal"),gu=Symbol.for("react.fragment"),Lh=Symbol.for("react.strict_mode"),yu=Symbol.for("react.profiler"),GM=Symbol.for("react.provider"),wx=Symbol.for("react.consumer"),vu=Symbol.for("react.context"),Zg=Symbol.for("react.forward_ref"),rc=Symbol.for("react.suspense"),Ep=Symbol.for("react.suspense_list"),dd=Symbol.for("react.memo"),ac=Symbol.for("react.lazy"),oc=Symbol.for("react.offscreen"),Nn=Symbol.for("react.memo_cache_sentinel"),Mi=Symbol.iterator,Us=Symbol.for("react.client.reference"),vn=HM.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xu,bu,pd=!1,Au=Array.isArray,md=e.rendererVersion,zM=e.rendererPackageName,gs=e.extraDevToolsConfig,Ih=e.getPublicInstance,Mx=e.getRootHostContext,C1=e.getChildHostContext,R1=e.prepareForCommit,VM=e.resetAfterCommit,Cx=e.createInstance,_p=e.appendInitialChild,e2=e.finalizeInitialChildren,_r=e.shouldSetTextContent,As=e.createTextInstance,t2=e.scheduleTimeout,Sp=e.cancelTimeout,gd=e.noTimeout,Oo=e.isPrimaryRenderer;e.warnsIfNotActing;var ss=e.supportsMutation,Po=e.supportsPersistence,va=e.supportsHydration,n2=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var D1=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var Qr=e.setCurrentUpdatePriority,Eu=e.getCurrentUpdatePriority,L1=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var I1=e.shouldAttemptEagerTransition,B1=e.detachDeletedInstance;e.requestPostPaintCallback;var Rx=e.maySuspendCommit,Dx=e.preloadInstance,YM=e.startSuspendingCommit,Lx=e.suspendInstance,O1=e.waitForCommitToBeReady,Bh=e.NotPendingTransition,lc=e.HostTransitionContext,P1=e.resetFormInstance;e.bindToConsole;var N1=e.supportsMicrotasks,U1=e.scheduleMicrotask,yd=e.supportsTestSelectors,k1=e.findFiberRoot,KM=e.getBoundingRect,F1=e.getTextContent,hl=e.isHiddenSubtree,H1=e.matchAccessibilityRole,i2=e.setFocusIfFocusable,s2=e.setupIntersectionObserver,G1=e.appendChild,Ix=e.appendChildToContainer,z1=e.commitTextUpdate,V1=e.commitMount,Y1=e.commitUpdate,K1=e.insertBefore,Bx=e.insertInContainerBefore,W1=e.removeChild,X1=e.removeChildFromContainer,r2=e.resetTextContent,j1=e.hideInstance,q1=e.hideTextInstance,WM=e.unhideInstance,Ox=e.unhideTextInstance,Q1=e.clearContainer,$1=e.cloneInstance,a2=e.createContainerChildSet,Px=e.appendChildToContainerChildSet,J1=e.finalizeContainerChildren,Z1=e.replaceContainerChildren,e_=e.cloneHiddenInstance,Nx=e.cloneHiddenTextInstance,Oh=e.isSuspenseInstancePending,Tp=e.isSuspenseInstanceFallback,o2=e.getSuspenseInstanceFallbackErrorDetails,t_=e.registerSuspenseInstanceRetry,n_=e.canHydrateFormStateMarker,fl=e.isFormStateMarkerMatching,_u=e.getNextHydratableSibling,cc=e.getFirstHydratableChild,Ph=e.getFirstHydratableChildWithinContainer,Ux=e.getFirstHydratableChildWithinSuspenseInstance,kx=e.canHydrateInstance,i_=e.canHydrateTextInstance,s_=e.canHydrateSuspenseInstance,Nh=e.hydrateInstance,l2=e.hydrateTextInstance,r_=e.hydrateSuspenseInstance,a_=e.getNextHydratableInstanceAfterSuspenseInstance,o_=e.commitHydratedContainer,c2=e.commitHydratedSuspenseInstance,l_=e.clearSuspenseBoundary,Fx=e.clearSuspenseBoundaryFromContainer,Hx=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var c_=e.validateHydratableInstance,XM=e.validateHydratableTextInstance,Ua=e.supportsResources,$s=e.isHostHoistableType,Js=e.getHoistableRoot,Gx=e.getResource,zx=e.acquireResource,Vx=e.releaseResource,u_=e.hydrateHoistable,Yx=e.mountHoistable,vd=e.unmountHoistable,Kx=e.createHoistableInstance,h_=e.prepareToCommitHoistables,f_=e.mayResourceSuspendCommit,Wx=e.preloadResource,Xx=e.suspendResource,dr=e.supportsSingletons,u2=e.resolveSingletonInstance,d_=e.clearSingleton,jx=e.acquireSingletonInstance,qx=e.releaseSingletonInstance,h2=e.isHostSingletonType,f2=[],Su=-1,Uh={},Es=Math.clz32?Math.clz32:w,Qx=Math.log,jM=Math.LN2,wp=128,xd=4194304,dl=Na.unstable_scheduleCallback,No=Na.unstable_cancelCallback,Tu=Na.unstable_shouldYield,uc=Na.unstable_requestPaint,ka=Na.unstable_now,d2=Na.unstable_ImmediatePriority,Mp=Na.unstable_UserBlockingPriority,bd=Na.unstable_NormalPriority,kh=Na.unstable_IdlePriority,Lr=Na.log,p2=Na.unstable_setDisableYieldValue,Ad=null,ks=null,$r=typeof Object.is=="function"?Object.is:ie,m2=new WeakMap,Fa=[],Ha=0,wu=null,Ed=0,xa=[],Ir=0,Uo=null,pl=1,ml="",_s=b(null),ao=b(null),hc=b(null),Cp=b(null),Ss=null,Li=null,ii=!1,oo=null,ko=!1,Rp=Error(s(519)),ba=[],fc=0,Fo=0,Ji=null,Mu=null,g2=!1,Ts=!1,y2=!1,_d=0,Sd=null,v2=0,Zi=0,pr=null,Br=!1,x2=!1,p_=Object.prototype.hasOwnProperty,Dp=Error(s(460)),Lp=Error(s(474)),Jr={then:function(){}},Or=null,Fh=null,Pr=0,Cu=cs(!0),gl=cs(!1),Ho=b(null),Go=b(0),Aa=b(null),lo=null,Xi=b(0),dc=0,bn=null,ui=null,rs=null,pc=!1,Hh=!1,Ru=!1,Du=0,Td=0,mc=null,m_=0,$x=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},ws={readContext:Ar,use:de,useCallback:Ln,useContext:Ln,useEffect:Ln,useImperativeHandle:Ln,useLayoutEffect:Ln,useInsertionEffect:Ln,useMemo:Ln,useReducer:Ln,useRef:Ln,useState:Ln,useDebugValue:Ln,useDeferredValue:Ln,useTransition:Ln,useSyncExternalStore:Ln,useId:Ln};ws.useCacheRefresh=Ln,ws.useMemoCache=Ln,ws.useHostTransitionStatus=Ln,ws.useFormState=Ln,ws.useActionState=Ln,ws.useOptimistic=Ln;var gc={readContext:Ar,use:de,useCallback:function(p,g){return Y().memoizedState=[p,g===void 0?null:g],p},useContext:Ar,useEffect:tx,useImperativeHandle:function(p,g,S){S=S!=null?S.concat([p]):null,Ig(4194308,4,Q0.bind(null,g,p),S)},useLayoutEffect:function(p,g){return Ig(4194308,4,p,g)},useInsertionEffect:function(p,g){Ig(4,2,p,g)},useMemo:function(p,g){var S=Y();g=g===void 0?null:g;var C=p();if(Ru){ne(!0);try{p()}finally{ne(!1)}}return S.memoizedState=[C,g],C},useReducer:function(p,g,S){var C=Y();if(S!==void 0){var I=S(g);if(Ru){ne(!0);try{S(g)}finally{ne(!1)}}}else I=g;return C.memoizedState=C.baseState=I,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:I},C.queue=p,p=p.dispatch=Ng.bind(null,bn,p),[C.memoizedState,p]},useRef:function(p){var g=Y();return p={current:p},g.memoizedState=p},useState:function(p){p=Jt(p);var g=p.queue,S=sx.bind(null,bn,g);return g.dispatch=S,[p.memoizedState,S]},useDebugValue:$0,useDeferredValue:function(p,g){var S=Y();return Og(S,p,g)},useTransition:function(){var p=Jt(!1);return p=nx.bind(null,bn,p.queue,!0,!1),Y().memoizedState=p,[!1,p]},useSyncExternalStore:function(p,g,S){var C=bn,I=Y();if(ii){if(S===void 0)throw Error(s(407));S=S()}else{if(S=g(),Bi===null)throw Error(s(349));(jn&60)!==0||kt(C,g,S)}I.memoizedState=S;var k={value:S,getSnapshot:g};return I.queue=k,tx(ln.bind(null,C,k,p),[p]),C.flags|=2048,Io(9,Ht.bind(null,C,k,S,g),{destroy:void 0},null),S},useId:function(){var p=Y(),g=Bi.identifierPrefix;if(ii){var S=ml,C=pl;S=(C&~(1<<32-Es(C)-1)).toString(32)+S,g=":"+g+"R"+S,S=Du++,0<S&&(g+="H"+S.toString(32)),g+=":"}else S=m_++,g=":"+g+"r"+S.toString(32)+":";return p.memoizedState=g},useCacheRefresh:function(){return Y().memoizedState=ix.bind(null,bn)}};gc.useMemoCache=Ae,gc.useHostTransitionStatus=J0,gc.useFormState=wn,gc.useActionState=wn,gc.useOptimistic=function(p){var g=Y();g.memoizedState=g.baseState=p;var S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=S,g=Jf.bind(null,bn,!0,S),S.dispatch=g,[p,g]};var Zr={readContext:Ar,use:de,useCallback:bh,useContext:Ar,useEffect:q0,useImperativeHandle:Bg,useInsertionEffect:s1,useLayoutEffect:r1,useMemo:Ah,useReducer:qe,useRef:Xr,useState:function(){return qe(Ne)},useDebugValue:$0,useDeferredValue:function(p,g){var S=oe();return Pg(S,ui.memoizedState,p,g)},useTransition:function(){var p=qe(Ne)[0],g=oe().memoizedState;return[typeof p=="boolean"?p:me(p),g]},useSyncExternalStore:Ft,useId:$f};Zr.useCacheRefresh=Yl,Zr.useMemoCache=Ae,Zr.useHostTransitionStatus=J0,Zr.useFormState=ns,Zr.useActionState=ns,Zr.useOptimistic=function(p,g){var S=oe();return Yt(S,ui,p,g)};var Lu={readContext:Ar,use:de,useCallback:bh,useContext:Ar,useEffect:q0,useImperativeHandle:Bg,useInsertionEffect:s1,useLayoutEffect:r1,useMemo:Ah,useReducer:dt,useRef:Xr,useState:function(){return dt(Ne)},useDebugValue:$0,useDeferredValue:function(p,g){var S=oe();return ui===null?Og(S,p,g):Pg(S,ui.memoizedState,p,g)},useTransition:function(){var p=dt(Ne)[0],g=oe().memoizedState;return[typeof p=="boolean"?p:me(p),g]},useSyncExternalStore:Ft,useId:$f};Lu.useCacheRefresh=Yl,Lu.useMemoCache=Ae,Lu.useHostTransitionStatus=J0,Lu.useFormState=hr,Lu.useActionState=hr,Lu.useOptimistic=function(p,g){var S=oe();return ui!==null?Yt(S,ui,p,g):(S.baseState=p,[p,S.queue.dispatch])};var wd={isMounted:function(p){return(p=p._reactInternals)?d(p)===p:!1},enqueueSetState:function(p,g,S){p=p._reactInternals;var C=Rr(),I=Et(C);I.payload=g,S!=null&&(I.callback=S),g=Dt(p,I,C),g!==null&&(Wi(g,p,C),Nt(g,p,C))},enqueueReplaceState:function(p,g,S){p=p._reactInternals;var C=Rr(),I=Et(C);I.tag=1,I.payload=g,S!=null&&(I.callback=S),g=Dt(p,I,C),g!==null&&(Wi(g,p,C),Nt(g,p,C))},enqueueForceUpdate:function(p,g){p=p._reactInternals;var S=Rr(),C=Et(S);C.tag=2,g!=null&&(C.callback=g),g=Dt(p,C,S),g!==null&&(Wi(g,p,S),Nt(g,p,S))}},Iu=typeof reportError=="function"?reportError:function(p){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof p=="object"&&p!==null&&typeof p.message=="string"?String(p.message):String(p),error:p});if(!window.dispatchEvent(g))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",p);return}console.error(p)},Jx=Error(s(461)),Fs=!1,Ip={dehydrated:null,treeContext:null,retryLane:0},co=b(null),Bu=null,uo=null,Bp=typeof AbortController<"u"?AbortController:function(){var p=[],g=this.signal={aborted:!1,addEventListener:function(S,C){p.push(C)}};this.abort=function(){g.aborted=!0,p.forEach(function(S){return S()})}},us=Na.unstable_scheduleCallback,qM=Na.unstable_NormalPriority,ys={$$typeof:vu,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Zx=vn.S;vn.S=function(p,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&et(p,g),Zx!==null&&Zx(p,g)};var Gh=b(null),yc=!1,An=!1,Ii=!1,zn=typeof WeakSet=="function"?WeakSet:Set,un=null,ki=!1,hi=null,Ms=!1,Nr=null,Ou=8192,vc={getCacheForType:function(p){var g=Ar(ys),S=g.data.get(p);return S===void 0&&(S=p(),g.data.set(p,S)),S}},es=0,zo=1,yl=2,Md=3,ea=4;if(typeof Symbol=="function"&&Symbol.for){var vl=Symbol.for;es=vl("selector.component"),zo=vl("selector.has_pseudo_class"),yl=vl("selector.role"),Md=vl("selector.test_id"),ea=vl("selector.text")}var Op=typeof WeakMap=="function"?WeakMap:Map,Xn=0,Bi=null,Un=null,jn=0,Ci=0,Hs=null,ho=!1,fo=!1,zh=!1,Vo=0,as=0,po=0,xc=0,ta=0,Ga=0,Gs=0,Cd=null,mo=null,b2=!1,eb=0,za=1/0,Vh=null,xl=null,bc=!1,Pu=null,Rd=0,A2=0,Pp=null,Yh=0,tb=null;return Wn.attemptContinuousHydration=function(p){if(p.tag===13){var g=st(p,67108864);g!==null&&Wi(g,p,67108864),fd(p,67108864)}},Wn.attemptHydrationAtCurrentPriority=function(p){if(p.tag===13){var g=Rr(),S=st(p,g);S!==null&&Wi(S,p,g),fd(p,g)}},Wn.attemptSynchronousHydration=function(p){switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var g=R(p.pendingLanes);if(g!==0){for(p.pendingLanes|=2,p.entangledLanes|=2;g;){var S=1<<31-Es(g);p.entanglements[1]|=S,g&=~S}nt(p),(Xn&6)===0&&(za=ka()+500,ee(0))}}break;case 13:g=st(p,2),g!==null&&Wi(g,p,2),Ex(),fd(p,2)}},Wn.batchedUpdates=function(p,g){return p(g)},Wn.createComponentSelector=function(p){return{$$typeof:es,value:p}},Wn.createContainer=function(p,g,S,C,I,k,$,ye,Ie,lt){return ic(p,g,!1,null,S,C,k,$,ye,Ie,lt,null)},Wn.createHasPseudoClassSelector=function(p){return{$$typeof:zo,value:p}},Wn.createHydrationContainer=function(p,g,S,C,I,k,$,ye,Ie,lt,Lt,Gt,Tt){return p=ic(S,C,!0,p,I,k,ye,Ie,lt,Lt,Gt,Tt),p.context=Sx(null),S=p.current,C=Rr(),I=Et(C),I.callback=g??null,Dt(S,I,C),p.current.lanes=C,F(p,C),nt(p),p},Wn.createPortal=function(p,g,S){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ul,key:C==null?null:""+C,children:p,containerInfo:g,implementation:S}},Wn.createRoleSelector=function(p){return{$$typeof:yl,value:p}},Wn.createTestNameSelector=function(p){return{$$typeof:Md,value:p}},Wn.createTextSelector=function(p){return{$$typeof:ea,value:p}},Wn.defaultOnCaughtError=function(p){console.error(p)},Wn.defaultOnRecoverableError=function(p){Iu(p)},Wn.defaultOnUncaughtError=function(p){Iu(p)},Wn.deferredUpdates=function(p){var g=vn.T,S=Eu();try{return Qr(32),vn.T=null,p()}finally{Qr(S),vn.T=g}},Wn.discreteUpdates=function(p,g,S,C,I){var k=vn.T,$=Eu();try{return Qr(2),vn.T=null,p(g,S,C,I)}finally{Qr($),vn.T=k,Xn===0&&(za=ka()+500)}},Wn.findAllNodes=cu,Wn.findBoundingRects=function(p,g){if(!yd)throw Error(s(363));g=cu(p,g),p=[];for(var S=0;S<g.length;S++)p.push(KM(g[S]));for(g=p.length-1;0<g;g--){S=p[g];for(var C=S.x,I=C+S.width,k=S.y,$=k+S.height,ye=g-1;0<=ye;ye--)if(g!==ye){var Ie=p[ye],lt=Ie.x,Lt=lt+Ie.width,Gt=Ie.y,Tt=Gt+Ie.height;if(C>=lt&&k>=Gt&&I<=Lt&&$<=Tt){p.splice(g,1);break}else if(C!==lt||S.width!==Ie.width||Tt<k||Gt>$){if(!(k!==Gt||S.height!==Ie.height||Lt<C||lt>I)){lt>C&&(Ie.width+=lt-C,Ie.x=C),Lt<I&&(Ie.width=I-lt),p.splice(g,1);break}}else{Gt>k&&(Ie.height+=Gt-k,Ie.y=k),Tt<$&&(Ie.height=$-Gt),p.splice(g,1);break}}}return p},Wn.findHostInstance=sc,Wn.findHostInstanceWithNoPortals=function(p){return p=y(p),p=p!==null?_(p):null,p===null?null:Ih(p.stateNode)},Wn.findHostInstanceWithWarning=function(p){return sc(p)},Wn.flushPassiveEffects=fu,Wn.flushSyncFromReconciler=function(p){var g=Xn;Xn|=1;var S=vn.T,C=Eu();try{if(Qr(2),vn.T=null,p)return p()}finally{Qr(C),vn.T=S,Xn=g,(Xn&6)===0&&ee(0)}},Wn.flushSyncWork=Ex,Wn.focusWithin=function(p,g){if(!yd)throw Error(s(363));for(p=lu(p),g=Mh(p,g),g=Array.from(g),p=0;p<g.length;){var S=g[p++],C=S.tag;if(!hl(S)){if((C===5||C===26||C===27)&&i2(S.stateNode))return!0;for(S=S.child;S!==null;)g.push(S),S=S.sibling}}return!1},Wn.getFindAllNodesFailureDescription=function(p,g){if(!yd)throw Error(s(363));var S=0,C=[];p=[lu(p),0];for(var I=0;I<p.length;){var k=p[I++],$=k.tag,ye=p[I++],Ie=g[ye];if(($!==5&&$!==26&&$!==27||!hl(k))&&(qg(k,Ie)&&(C.push(ga(Ie)),ye++,ye>S&&(S=ye)),ye<g.length))for(k=k.child;k!==null;)p.push(k,ye),k=k.sibling}if(S<g.length){for(p=[];S<g.length;S++)p.push(ga(g[S]));return`findAllNodes was able to match part of the selector:
  `+(C.join(" > ")+`

No matching component was found for:
  `)+p.join(" > ")}return null},Wn.getPublicRootInstance=function(p){if(p=p.current,!p.child)return null;switch(p.child.tag){case 27:case 5:return Ih(p.child.stateNode);default:return p.child.stateNode}},Wn.injectIntoDevTools=function(){var p={bundleType:0,version:md,rendererPackageName:zM,currentDispatcherRef:vn,findFiberByHostInstance:n2,reconcilerVersion:"19.0.0"};if(gs!==null&&(p.rendererConfig=gs),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")p=!1;else{var g=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(g.isDisabled||!g.supportsFiber)p=!0;else{try{Ad=g.inject(p),ks=g}catch{}p=!!g.checkDCE}}return p},Wn.isAlreadyRendering=function(){return!1},Wn.observeVisibleRects=function(p,g,S,C){if(!yd)throw Error(s(363));p=cu(p,g);var I=s2(p,S,C).disconnect;return{disconnect:function(){I()}}},Wn.shouldError=function(){return null},Wn.shouldSuspend=function(){return!1},Wn.startHostTransition=function(p,g,S,C){if(p.tag!==5)throw Error(s(476));var I=Qf(p).queue;nx(p,I,g,Bh,S===null?n:function(){var k=Qf(p).next.queue;return tu(p,k,{},Rr()),S(C)})},Wn.updateContainer=function(p,g,S,C){var I=g.current,k=Rr();return cl(I,k,p,g,S,C),k},Wn.updateContainerSync=function(p,g,S,C){return g.tag===0&&fu(),cl(g.current,2,p,g,S,C),2},Wn},i.exports.default=i.exports,Object.defineProperty(i.exports,"__esModule",{value:!0})}(uD)),uD.exports}var D4;function Cfe(){return D4||(D4=1,cD.exports=Mfe()),cD.exports}var Rfe=Cfe();const Dfe=II(Rfe);var L4=BI();const Lfe=i=>typeof i=="object"&&typeof i.then=="function",Tm=[];function vV(i,e,t=(n,s)=>n===s){if(i===e)return!0;if(!i||!e)return!1;const n=i.length;if(e.length!==n)return!1;for(let s=0;s<n;s++)if(!t(i[s],e[s]))return!1;return!0}function xV(i,e=null,t=!1,n={}){e===null&&(e=[i]);for(const r of Tm)if(vV(e,r.keys,r.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(r,"error"))throw r.error;if(Object.prototype.hasOwnProperty.call(r,"response"))return n.lifespan&&n.lifespan>0&&(r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout(r.remove,n.lifespan)),r.response;if(!t)throw r.promise}const s={keys:e,equal:n.equal,remove:()=>{const r=Tm.indexOf(s);r!==-1&&Tm.splice(r,1)},promise:(Lfe(i)?i:i(...e)).then(r=>{s.response=r,n.lifespan&&n.lifespan>0&&(s.timeout=setTimeout(s.remove,n.lifespan))}).catch(r=>s.error=r)};if(Tm.push(s),!t)throw s.promise}const Ife=(i,e,t)=>xV(i,e,!1,t),Bfe=(i,e,t)=>void xV(i,e,!0,t),Ofe=i=>{if(i===void 0||i.length===0)Tm.splice(0,Tm.length);else{const e=Tm.find(t=>vV(i,t.keys,t.equal));e&&e.remove()}};function AO(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=e?i.return:i.child;for(;n;){const s=AO(n,e,t);if(s)return s;n=e?null:n.sibling}}function bV(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const EO=bV(ce.createContext(null));class AV extends ce.Component{render(){return ce.createElement(EO.Provider,{value:this._reactInternals},this.props.children)}}function EV(){const i=ce.useContext(EO);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ce.useId();return ce.useMemo(()=>{for(const t of[i,i==null?void 0:i.alternate]){if(!t)continue;const n=AO(t,!1,s=>{let r=s.memoizedState;for(;r;){if(r.memoizedState===e)return!0;r=r.next}});if(n)return n}},[i,e])}const Pfe=Symbol.for("react.context"),Nfe=i=>i!==null&&typeof i=="object"&&"$$typeof"in i&&i.$$typeof===Pfe;function Ufe(){const i=EV(),[e]=ce.useState(()=>new Map);e.clear();let t=i;for(;t;){const n=t.type;Nfe(n)&&n!==EO&&!e.has(n)&&e.set(n,ce.use(bV(n))),t=t.return}return e}function kfe(){const i=Ufe();return ce.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>ce.createElement(e,null,ce.createElement(t.Provider,{...n,value:i.get(t)})),e=>ce.createElement(AV,{...e})),[i])}function _V(i){let e=i.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const SV=i=>i&&i.isOrthographicCamera,Ffe=i=>i&&i.hasOwnProperty("current"),Hfe=i=>i!=null&&(typeof i=="string"||typeof i=="number"||i.isColor),$E=((i,e)=>typeof window<"u"&&(((i=window.document)==null?void 0:i.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?ce.useLayoutEffect:ce.useEffect;function _O(i){const e=ce.useRef(i);return $E(()=>void(e.current=i),[i]),e}function Gfe(){const i=EV(),e=kfe();return ce.useMemo(()=>({children:t})=>{const s=!!AO(i,!0,r=>r.type===ce.StrictMode)?ce.StrictMode:ce.Fragment;return Re.jsx(s,{children:Re.jsx(e,{children:t})})},[i,e])}function zfe({set:i}){return $E(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}const Vfe=(i=>(i=class extends ce.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},i.getDerivedStateFromError=()=>({error:!0}),i))();function TV(i){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}function Z2(i){var e;return(e=i.__r3f)==null?void 0:e.root.getState()}const vs={obj:i=>i===Object(i)&&!vs.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,nul:i=>i===null,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:s=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(vs.str(i)||vs.num(i)||vs.boo(i))return i===e;const r=vs.obj(i);if(r&&n==="reference")return i===e;const a=vs.arr(i);if(a&&t==="reference")return i===e;if((a||r)&&i===e)return!0;let o;for(o in i)if(!(o in e))return!1;if(r&&t==="shallow"&&n==="shallow"){for(o in s?e:i)if(!vs.equ(i[o],e[o],{strict:s,objects:"reference"}))return!1}else for(o in s?e:i)if(i[o]!==e[o])return!1;if(vs.und(o)){if(a&&i.length===0&&e.length===0||r&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function Yfe(i){const e={nodes:{},materials:{},meshes:{}};return i&&i.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function Kfe(i){i.type!=="Scene"&&(i.dispose==null||i.dispose());for(const e in i){const t=i[e];(t==null?void 0:t.type)!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const wV=["children","key","ref"];function Wfe(i){const e={};for(const t in i)wV.includes(t)||(e[t]=i[t]);return e}function lw(i,e,t,n){const s=i;let r=s==null?void 0:s.__r3f;return r||(r={root:e,type:t,parent:null,children:[],props:Wfe(n),object:s,eventCount:0,handlers:{},isHidden:!1},s&&(s.__r3f=r)),r}function rE(i,e){let t=i[e];if(!e.includes("-"))return{root:i,key:e,target:t};t=i;for(const s of e.split("-")){var n;e=s,i=t,t=(n=t)==null?void 0:n[e]}return{root:i,key:e,target:t}}const I4=/-\d+$/;function cw(i,e){if(vs.str(e.props.attach)){if(I4.test(e.props.attach)){const s=e.props.attach.replace(I4,""),{root:r,key:a}=rE(i.object,s);Array.isArray(r[a])||(r[a]=[])}const{root:t,key:n}=rE(i.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else vs.fun(e.props.attach)&&(e.previousAttach=e.props.attach(i.object,e.object))}function uw(i,e){if(vs.str(e.props.attach)){const{root:t,key:n}=rE(i.object,e.props.attach),s=e.previousAttach;s===void 0?delete t[n]:t[n]=s}else e.previousAttach==null||e.previousAttach(i.object,e.object);delete e.previousAttach}const aI=[...wV,"args","dispose","attach","object","onUpdate","dispose"],B4=new Map;function Xfe(i){let e=B4.get(i.constructor);try{e||(e=new i.constructor,B4.set(i.constructor,e))}catch{}return e}function jfe(i,e){const t={};for(const n in e)if(!aI.includes(n)&&!vs.equ(e[n],i.props[n])){t[n]=e[n];for(const s in e)s.startsWith(`${n}-`)&&(t[s]=e[s])}for(const n in i.props){if(aI.includes(n)||e.hasOwnProperty(n))continue;const{root:s,key:r}=rE(i.object,n);if(s.constructor&&s.constructor.length===0){const a=Xfe(s);vs.und(a)||(t[r]=a[r])}else t[r]=0}return t}const qfe=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],Qfe=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function rh(i,e){var t;const n=i.__r3f,s=n&&_V(n).getState(),r=n==null?void 0:n.eventCount;for(const o in e){let l=e[o];if(aI.includes(o))continue;if(n&&Qfe.test(o)){typeof l=="function"?n.handlers[o]=l:delete n.handlers[o],n.eventCount=Object.keys(n.handlers).length;continue}if(l===void 0)continue;let{root:c,key:h,target:d}=rE(i,o);if(d instanceof Ov&&l instanceof Ov)d.mask=l.mask;else if(d instanceof Ut&&Hfe(l))d.set(l);else if(d!==null&&typeof d=="object"&&typeof d.set=="function"&&typeof d.copy=="function"&&l!=null&&l.constructor&&d.constructor===l.constructor)d.copy(l);else if(d!==null&&typeof d=="object"&&typeof d.set=="function"&&Array.isArray(l))typeof d.fromArray=="function"?d.fromArray(l):d.set(...l);else if(d!==null&&typeof d=="object"&&typeof d.set=="function"&&typeof l=="number")typeof d.setScalar=="function"?d.setScalar(l):d.set(l);else{var a;c[h]=l,s&&!s.linear&&qfe.includes(h)&&(a=c[h])!=null&&a.isTexture&&c[h].format===rr&&c[h].type===Xs&&(c[h].colorSpace=bi)}}if(n!=null&&n.parent&&s!=null&&s.internal&&(t=n.object)!=null&&t.isObject3D&&r!==n.eventCount){const o=n.object,l=s.internal.interaction.indexOf(o);l>-1&&s.internal.interaction.splice(l,1),n.eventCount&&o.raycast!==null&&s.internal.interaction.push(o)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&Jv(n),i}function Jv(i){var e;if(!i.parent)return;i.props.onUpdate==null||i.props.onUpdate(i.object);const t=(e=i.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function MV(i,e){i.manual||(SV(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix())}const ja=i=>i==null?void 0:i.isObject3D;function $S(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function CV(i,e,t,n){const s=t.get(e);s&&(t.delete(e),t.size===0&&(i.delete(n),s.target.releasePointerCapture(n)))}function $fe(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,s)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(s)}),t.capturedMap.forEach((n,s)=>{CV(t.capturedMap,e,n,s)})}function Jfe(i){function e(l){const{internal:c}=i.getState(),h=l.offsetX-c.initialClick[0],d=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(h*h+d*d))}function t(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(h=>{var d;return(d=c.__r3f)==null?void 0:d.handlers["onPointer"+h]}))}function n(l,c){const h=i.getState(),d=new Set,m=[],y=c?c(h.internal.interaction):h.internal.interaction;for(let A=0;A<y.length;A++){const T=Z2(y[A]);T&&(T.raycaster.camera=void 0)}h.previousRoot||h.events.compute==null||h.events.compute(l,h);function x(A){const T=Z2(A);if(!T||!T.events.enabled||T.raycaster.camera===null)return[];if(T.raycaster.camera===void 0){var w;T.events.compute==null||T.events.compute(l,T,(w=T.previousRoot)==null?void 0:w.getState()),T.raycaster.camera===void 0&&(T.raycaster.camera=null)}return T.raycaster.camera?T.raycaster.intersectObject(A,!0):[]}let _=y.flatMap(x).sort((A,T)=>{const w=Z2(A.object),R=Z2(T.object);return!w||!R?A.distance-T.distance:R.events.priority-w.events.priority||A.distance-T.distance}).filter(A=>{const T=$S(A);return d.has(T)?!1:(d.add(T),!0)});h.events.filter&&(_=h.events.filter(_,h));for(const A of _){let T=A.object;for(;T;){var b;(b=T.__r3f)!=null&&b.eventCount&&m.push({...A,eventObject:T}),T=T.parent}}if("pointerId"in l&&h.internal.capturedMap.has(l.pointerId))for(let A of h.internal.capturedMap.get(l.pointerId).values())d.has($S(A.intersection))||m.push(A.intersection);return m}function s(l,c,h,d){if(l.length){const m={stopped:!1};for(const y of l){let x=Z2(y.object);if(x||y.object.traverseAncestors(_=>{const b=Z2(_);if(b)return x=b,!1}),x){const{raycaster:_,pointer:b,camera:A,internal:T}=x,w=new se(b.x,b.y,0).unproject(A),R=B=>{var L,F;return(L=(F=T.capturedMap.get(B))==null?void 0:F.has(y.eventObject))!=null?L:!1},O=B=>{const L={intersection:y,target:c.target};T.capturedMap.has(B)?T.capturedMap.get(B).set(y.eventObject,L):T.capturedMap.set(B,new Map([[y.eventObject,L]])),c.target.setPointerCapture(B)},N=B=>{const L=T.capturedMap.get(B);L&&CV(T.capturedMap,y.eventObject,L,B)};let U={};for(let B in c){let L=c[B];typeof L!="function"&&(U[B]=L)}let P={...y,...U,pointer:b,intersections:l,stopped:m.stopped,delta:h,unprojectedPoint:w,ray:_.ray,camera:A,stopPropagation(){const B="pointerId"in c&&T.capturedMap.get(c.pointerId);if((!B||B.has(y.eventObject))&&(P.stopped=m.stopped=!0,T.hovered.size&&Array.from(T.hovered.values()).find(L=>L.eventObject===y.eventObject))){const L=l.slice(0,l.indexOf(y));r([...L,y])}},target:{hasPointerCapture:R,setPointerCapture:O,releasePointerCapture:N},currentTarget:{hasPointerCapture:R,setPointerCapture:O,releasePointerCapture:N},nativeEvent:c};if(d(P),m.stopped===!0)break}}}return l}function r(l){const{internal:c}=i.getState();for(const h of c.hovered.values())if(!l.length||!l.find(d=>d.object===h.object&&d.index===h.index&&d.instanceId===h.instanceId)){const m=h.eventObject.__r3f;if(c.hovered.delete($S(h)),m!=null&&m.eventCount){const y=m.handlers,x={...h,intersections:l};y.onPointerOut==null||y.onPointerOut(x),y.onPointerLeave==null||y.onPointerLeave(x)}}}function a(l,c){for(let h=0;h<c.length;h++){const d=c[h].__r3f;d==null||d.handlers.onPointerMissed==null||d.handlers.onPointerMissed(l)}}function o(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>r([]);case"onLostPointerCapture":return c=>{const{internal:h}=i.getState();"pointerId"in c&&h.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{h.capturedMap.has(c.pointerId)&&(h.capturedMap.delete(c.pointerId),r([]))})}}return function(h){const{onPointerMissed:d,internal:m}=i.getState();m.lastEvent.current=h;const y=l==="onPointerMove",x=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",b=n(h,y?t:void 0),A=x?e(h):0;l==="onPointerDown"&&(m.initialClick=[h.offsetX,h.offsetY],m.initialHits=b.map(w=>w.eventObject)),x&&!b.length&&A<=2&&(a(h,m.interaction),d&&d(h)),y&&r(b);function T(w){const R=w.eventObject,O=R.__r3f;if(!(O!=null&&O.eventCount))return;const N=O.handlers;if(y){if(N.onPointerOver||N.onPointerEnter||N.onPointerOut||N.onPointerLeave){const U=$S(w),P=m.hovered.get(U);P?P.stopped&&w.stopPropagation():(m.hovered.set(U,w),N.onPointerOver==null||N.onPointerOver(w),N.onPointerEnter==null||N.onPointerEnter(w))}N.onPointerMove==null||N.onPointerMove(w)}else{const U=N[l];U?(!x||m.initialHits.includes(R))&&(a(h,m.interaction.filter(P=>!m.initialHits.includes(P))),U(w)):x&&m.initialHits.includes(R)&&a(h,m.interaction.filter(P=>!m.initialHits.includes(P)))}}s(b,h,A,T)}}return{handlePointer:o}}const O4=i=>!!(i!=null&&i.render),SO=ce.createContext(null),Zfe=(i,e)=>{const t=yV((o,l)=>{const c=new se,h=new se,d=new se;function m(A=l().camera,T=h,w=l().size){const{width:R,height:O,top:N,left:U}=w,P=R/O;T.isVector3?d.copy(T):d.set(...T);const B=A.getWorldPosition(c).distanceTo(d);if(SV(A))return{width:R/A.zoom,height:O/A.zoom,top:N,left:U,factor:1,distance:B,aspect:P};{const L=A.fov*Math.PI/180,F=2*Math.tan(L/2)*B,j=F*(R/O);return{width:j,height:F,top:N,left:U,factor:R/j,distance:B,aspect:P}}}let y;const x=A=>o(T=>({performance:{...T.performance,current:A}})),_=new Qe;return{set:o,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(A=1)=>i(l(),A),advance:(A,T)=>e(A,T,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new pO,pointer:_,mouse:_,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const A=l();y&&clearTimeout(y),A.performance.current!==A.performance.min&&x(A.performance.min),y=setTimeout(()=>x(l().performance.max),A.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:m},setEvents:A=>o(T=>({...T,events:{...T.events,...A}})),setSize:(A,T,w=0,R=0)=>{const O=l().camera,N={width:A,height:T,top:w,left:R};o(U=>({size:N,viewport:{...U.viewport,...m(O,h,N)}}))},setDpr:A=>o(T=>{const w=TV(A);return{viewport:{...T.viewport,dpr:w,initialDpr:T.viewport.initialDpr||w}}}),setFrameloop:(A="always")=>{const T=l().clock;T.stop(),T.elapsedTime=0,A!=="never"&&(T.start(),T.elapsedTime=0),o(()=>({frameloop:A}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:ce.createRef(),active:!1,frames:0,priority:0,subscribe:(A,T,w)=>{const R=l().internal;return R.priority=R.priority+(T>0?1:0),R.subscribers.push({ref:A,priority:T,store:w}),R.subscribers=R.subscribers.sort((O,N)=>O.priority-N.priority),()=>{const O=l().internal;O!=null&&O.subscribers&&(O.priority=O.priority-(T>0?1:0),O.subscribers=O.subscribers.filter(N=>N.ref!==A))}}}}}),n=t.getState();let s=n.size,r=n.viewport.dpr,a=n.camera;return t.subscribe(()=>{const{camera:o,size:l,viewport:c,gl:h,set:d}=t.getState();if(l.width!==s.width||l.height!==s.height||c.dpr!==r){s=l,r=c.dpr,MV(o,l),c.dpr>0&&h.setPixelRatio(c.dpr);const m=typeof HTMLCanvasElement<"u"&&h.domElement instanceof HTMLCanvasElement;h.setSize(l.width,l.height,m)}o!==a&&(a=o,d(m=>({viewport:{...m.viewport,...m.viewport.getCurrentViewport(o)}})))}),t.subscribe(o=>i(o)),t};function TO(){const i=ce.useContext(SO);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function gr(i=t=>t,e){return TO()(i,e)}function Zv(i,e=0){const t=TO(),n=t.getState().internal.subscribe,s=_O(i);return $E(()=>n(s,e,t),[e,n,t]),null}const P4=new WeakMap,ede=i=>{var e;return typeof i=="function"&&(i==null||(e=i.prototype)==null?void 0:e.constructor)===i};function RV(i,e){return function(t,...n){let s;return ede(t)?(s=P4.get(t),s||(s=new t,P4.set(t,s))):s=t,i&&i(s),Promise.all(n.map(r=>new Promise((a,o)=>s.load(r,l=>{ja(l==null?void 0:l.scene)&&Object.assign(l,Yfe(l.scene)),a(l)},e,l=>o(new Error(`Could not load ${r}: ${l==null?void 0:l.message}`))))))}}function Kf(i,e,t,n){const s=Array.isArray(e)?e:[e],r=Ife(RV(t,n),[i,...s],{equal:vs.equ});return Array.isArray(e)?r:r[0]}Kf.preload=function(i,e,t){const n=Array.isArray(e)?e:[e];return Bfe(RV(t),[i,...n])};Kf.clear=function(i,e){const t=Array.isArray(e)?e:[e];return Ofe([i,...t])};function tde(i){const e=Dfe(i);return e.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:ce.version}),e}const DV=0,kv={},nde=/^three(?=[A-Z])/,DM=i=>`${i[0].toUpperCase()}${i.slice(1)}`;let ide=0;const sde=i=>typeof i=="function";function wO(i){if(sde(i)){const e=`${ide++}`;return kv[e]=i,e}else Object.assign(kv,i)}function LV(i,e){const t=DM(i),n=kv[t];if(i!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(i==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function rde(i,e,t){var n;return i=DM(i)in kv?i:i.replace(nde,""),LV(i,e),i==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,lw(e.object,t,i,e)}function ade(i){if(!i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?uw(i.parent,i):ja(i.object)&&(i.object.visible=!1),i.isHidden=!0,Jv(i)}}function IV(i){if(i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?cw(i.parent,i):ja(i.object)&&i.props.visible!==!1&&(i.object.visible=!0),i.isHidden=!1,Jv(i)}}function MO(i,e,t){const n=e.root.getState();if(!(!i.parent&&i.object!==n.scene)){if(!e.object){var s,r;const a=kv[DM(e.type)];e.object=(s=e.props.object)!=null?s:new a(...(r=e.props.args)!=null?r:[]),e.object.__r3f=e}if(rh(e.object,e.props),e.props.attach)cw(i,e);else if(ja(e.object)&&ja(i.object)){const a=i.object.children.indexOf(t==null?void 0:t.object);if(t&&a!==-1){const o=i.object.children.indexOf(e.object);if(o!==-1){i.object.children.splice(o,1);const l=o<a?a-1:a;i.object.children.splice(l,0,e.object)}else e.object.parent=i.object,i.object.children.splice(a,0,e.object),e.object.dispatchEvent({type:"added"}),i.object.dispatchEvent({type:"childadded",child:e.object})}else i.object.add(e.object)}for(const a of e.children)MO(e,a);Jv(e)}}function hD(i,e){e&&(e.parent=i,i.children.push(e),MO(i,e))}function N4(i,e,t){if(!e||!t)return;e.parent=i;const n=i.children.indexOf(t);n!==-1?i.children.splice(n,0,e):i.children.push(e),MO(i,e,t)}function BV(i){if(typeof i.dispose=="function"){const e=()=>{try{i.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():L4.unstable_scheduleCallback(L4.unstable_IdlePriority,e)}}function oI(i,e,t){if(!e)return;e.parent=null;const n=i.children.indexOf(e);n!==-1&&i.children.splice(n,1),e.props.attach?uw(i,e):ja(e.object)&&ja(i.object)&&(i.object.remove(e.object),$fe(_V(e),e.object));const s=e.props.dispose!==null&&t!==!1;for(let r=e.children.length-1;r>=0;r--){const a=e.children[r];oI(e,a,s)}e.children.length=0,delete e.object.__r3f,s&&e.type!=="primitive"&&e.object.type!=="Scene"&&BV(e.object),t===void 0&&Jv(e)}function ode(i,e){for(const t of[i,i.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const KT=[];function lde(){for(const[t]of KT){const n=t.parent;if(n){t.props.attach?uw(n,t):ja(t.object)&&ja(n.object)&&n.object.remove(t.object);for(const s of t.children)s.props.attach?uw(t,s):ja(s.object)&&ja(t.object)&&t.object.remove(s.object)}t.isHidden&&IV(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&BV(t.object)}for(const[t,n,s]of KT){t.props=n;const r=t.parent;if(r){var i,e;const a=kv[DM(t.type)];t.object=(i=t.props.object)!=null?i:new a(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,ode(s,t.object),rh(t.object,t.props),t.props.attach?cw(r,t):ja(t.object)&&ja(r.object)&&r.object.add(t.object);for(const o of t.children)o.props.attach?cw(t,o):ja(o.object)&&ja(t.object)&&t.object.add(o.object);Jv(t)}}KT.length=0}const fD=()=>{},U4={};let JS=DV;const cde=0,ude=4,hw=tde({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:rde,removeChild:oI,appendChild:hD,appendInitialChild:hD,insertBefore:N4,appendChildToContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||hD(t,e)},removeChildFromContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||oI(t,e)},insertInContainerBefore(i,e,t){const n=i.getState().scene.__r3f;!e||!t||!n||N4(n,e,t)},getRootHostContext:()=>U4,getChildHostContext:()=>U4,commitUpdate(i,e,t,n,s){var r,a,o;LV(e,n);let l=!1;if((i.type==="primitive"&&t.object!==n.object||((r=n.args)==null?void 0:r.length)!==((a=t.args)==null?void 0:a.length)||(o=n.args)!=null&&o.some((h,d)=>{var m;return h!==((m=t.args)==null?void 0:m[d])}))&&(l=!0),l)KT.push([i,{...n},s]);else{const h=jfe(i,n);Object.keys(h).length&&(Object.assign(i.props,h),rh(i.object,h))}(s.sibling===null||(s.flags&ude)===cde)&&lde()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:i=>i==null?void 0:i.object,prepareForCommit:()=>null,preparePortalMount:i=>lw(i.getState().scene,i,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:ade,unhideInstance:IV,createTextInstance:fD,hideTextInstance:fD,unhideTextInstance:fD,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:ce.createContext(null),setCurrentUpdatePriority(i){JS=i},getCurrentUpdatePriority(){return JS},resolveUpdatePriority(){var i;if(JS!==DV)return JS;switch(typeof window<"u"&&((i=window.event)==null?void 0:i.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return YT.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return YT.ContinuousEventPriority;default:return YT.DefaultEventPriority}},resetFormInstance(){}}),xg=new Map,ey={objects:"shallow",strict:!1};function hde(i,e){if(!e&&typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:t,height:n,top:s,left:r}=i.parentElement.getBoundingClientRect();return{width:t,height:n,top:s,left:r}}else if(!e&&typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function fde(i){const e=xg.get(i),t=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,r=n||Zfe(uI,F4),a=t||hw.createContainer(r,YT.ConcurrentRoot,null,!1,null,"",s,s,s,null);e||xg.set(i,{fiber:a,store:r});let o,l,c=!1,h=null;return{async configure(d={}){let m;h=new Promise(ae=>m=ae);let{gl:y,size:x,scene:_,events:b,onCreated:A,shadows:T=!1,linear:w=!1,flat:R=!1,legacy:O=!1,orthographic:N=!1,frameloop:U="always",dpr:P=[1,2],performance:B,raycaster:L,camera:F,onPointerMissed:j}=d,J=r.getState(),re=J.gl;if(!J.gl){const ae={canvas:i,powerPreference:"high-performance",antialias:!0,alpha:!0},ge=typeof y=="function"?await y(ae):y;O4(ge)?re=ge:re=new bO({...ae,...y}),J.set({gl:re})}let q=J.raycaster;q||J.set({raycaster:q=new yO});const{params:W,...ne}=L||{};if(vs.equ(ne,q,ey)||rh(q,{...ne}),vs.equ(W,q.params,ey)||rh(q,{params:{...q.params,...W}}),!J.camera||J.camera===l&&!vs.equ(l,F,ey)){l=F;const ae=F==null?void 0:F.isCamera,ge=ae?F:N?new fh(0,0,0,0,.1,1e3):new Ds(75,0,.1,1e3);ae||(ge.position.z=5,F&&(rh(ge,F),ge.manual||("aspect"in F||"left"in F||"right"in F||"bottom"in F||"top"in F)&&(ge.manual=!0,ge.updateProjectionMatrix())),!J.camera&&!(F!=null&&F.rotation)&&ge.lookAt(0,0,0)),J.set({camera:ge}),q.camera=ge}if(!J.scene){let ae;_!=null&&_.isScene?(ae=_,lw(ae,r,"",{})):(ae=new dg,lw(ae,r,"",{}),_&&rh(ae,_)),J.set({scene:ae})}b&&!J.events.handlers&&J.set({events:b(r)});const ie=hde(i,x);if(vs.equ(ie,J.size,ey)||J.setSize(ie.width,ie.height,ie.top,ie.left),P&&J.viewport.dpr!==TV(P)&&J.setDpr(P),J.frameloop!==U&&J.setFrameloop(U),J.onPointerMissed||J.set({onPointerMissed:j}),B&&!vs.equ(B,J.performance,ey)&&J.set(ae=>({performance:{...ae.performance,...B}})),!J.xr){var ue;const ae=(le,Ce)=>{const Me=r.getState();Me.frameloop!=="never"&&F4(le,!0,Me,Ce)},ge=()=>{const le=r.getState();le.gl.xr.enabled=le.gl.xr.isPresenting,le.gl.xr.setAnimationLoop(le.gl.xr.isPresenting?ae:null),le.gl.xr.isPresenting||uI(le)},Ee={connect(){const le=r.getState().gl;le.xr.addEventListener("sessionstart",ge),le.xr.addEventListener("sessionend",ge)},disconnect(){const le=r.getState().gl;le.xr.removeEventListener("sessionstart",ge),le.xr.removeEventListener("sessionend",ge)}};typeof((ue=re.xr)==null?void 0:ue.addEventListener)=="function"&&Ee.connect(),J.set({xr:Ee})}if(re.shadowMap){const ae=re.shadowMap.enabled,ge=re.shadowMap.type;if(re.shadowMap.enabled=!!T,vs.boo(T))re.shadowMap.type=uA;else if(vs.str(T)){var z;const Ee={basic:w6,percentage:Jw,soft:uA,variance:Lc};re.shadowMap.type=(z=Ee[T])!=null?z:uA}else vs.obj(T)&&Object.assign(re.shadowMap,T);(ae!==re.shadowMap.enabled||ge!==re.shadowMap.type)&&(re.shadowMap.needsUpdate=!0)}return ri.enabled=!O,c||(re.outputColorSpace=w?nl:bi,re.toneMapping=R?Vc:IB),J.legacy!==O&&J.set(()=>({legacy:O})),J.linear!==w&&J.set(()=>({linear:w})),J.flat!==R&&J.set(()=>({flat:R})),y&&!vs.fun(y)&&!O4(y)&&!vs.equ(y,re,ey)&&rh(re,y),o=A,c=!0,m(),this},render(d){return!c&&!h&&this.configure(),h.then(()=>{hw.updateContainer(Re.jsx(dde,{store:r,children:d,onCreated:o,rootElement:i}),a,null,()=>{})}),r},unmount(){OV(i)}}}function dde({store:i,children:e,onCreated:t,rootElement:n}){return $E(()=>{const s=i.getState();s.set(r=>({internal:{...r.internal,active:!0}})),t&&t(s),i.getState().events.connected||s.events.connect==null||s.events.connect(n)},[]),Re.jsx(SO.Provider,{value:i,children:e})}function OV(i,e){const t=xg.get(i),n=t==null?void 0:t.fiber;if(n){const s=t==null?void 0:t.store.getState();s&&(s.internal.active=!1),hw.updateContainer(null,n,null,()=>{s&&setTimeout(()=>{try{var r,a,o,l;s.events.disconnect==null||s.events.disconnect(),(r=s.gl)==null||(a=r.renderLists)==null||a.dispose==null||a.dispose(),(o=s.gl)==null||o.forceContextLoss==null||o.forceContextLoss(),(l=s.gl)!=null&&l.xr&&s.xr.disconnect(),Kfe(s.scene),xg.delete(i)}catch{}},500)})}}function pde(i,e,t){return Re.jsx(mde,{children:i,container:e,state:t})}function mde({state:i={},children:e,container:t}){const{events:n,size:s,...r}=i,a=TO(),[o]=ce.useState(()=>new yO),[l]=ce.useState(()=>new Qe),c=_O((d,m)=>{let y;if(m.camera&&s){const x=m.camera;y=d.viewport.getCurrentViewport(x,new se,s),x!==d.camera&&MV(x,s)}return{...d,...m,scene:t,raycaster:o,pointer:l,mouse:l,previousRoot:a,events:{...d.events,...m.events,...n},size:{...d.size,...s},viewport:{...d.viewport,...y},setEvents:x=>m.set(_=>({..._,events:{..._.events,...x}}))}}),h=ce.useMemo(()=>{const d=yV((y,x)=>({...r,set:y,get:x})),m=y=>d.setState(x=>c.current(y,x));return m(a.getState()),a.subscribe(m),d},[a,t]);return Re.jsx(Re.Fragment,{children:hw.createPortal(Re.jsx(SO.Provider,{value:h,children:e}),h,null)})}const gde=new Set,yde=new Set,vde=new Set;function dD(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function xA(i,e){switch(i){case"before":return dD(gde,e);case"after":return dD(yde,e);case"tail":return dD(vde,e)}}let pD,mD;function lI(i,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),pD=e.internal.subscribers;for(let s=0;s<pD.length;s++)mD=pD[s],mD.ref.current(mD.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let fw=!1,cI=!1,gD,k4,ty;function PV(i){k4=requestAnimationFrame(PV),fw=!0,gD=0,xA("before",i),cI=!0;for(const t of xg.values()){var e;ty=t.store.getState(),ty.internal.active&&(ty.frameloop==="always"||ty.internal.frames>0)&&!((e=ty.gl.xr)!=null&&e.isPresenting)&&(gD+=lI(i,ty))}if(cI=!1,xA("after",i),gD===0)return xA("tail",i),fw=!1,cancelAnimationFrame(k4)}function uI(i,e=1){var t;if(!i)return xg.forEach(n=>uI(n.store.getState(),e));(t=i.gl.xr)!=null&&t.isPresenting||!i.internal.active||i.frameloop==="never"||(e>1?i.internal.frames=Math.min(60,i.internal.frames+e):cI?i.internal.frames=2:i.internal.frames=1,fw||(fw=!0,requestAnimationFrame(PV)))}function F4(i,e=!0,t,n){if(e&&xA("before",i),t)lI(i,t,n);else for(const s of xg.values())lI(i,s.store.getState());e&&xA("after",i)}const yD={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function xde(i){const{handlePointer:e}=Jfe(i);return{priority:1,enabled:!0,compute(t,n,s){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(yD).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:s}=i.getState();(t=s.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(s.lastEvent.current)},connect:t=>{const{set:n,events:s}=i.getState();if(s.disconnect==null||s.disconnect(),n(r=>({events:{...r.events,connected:t}})),s.handlers)for(const r in s.handlers){const a=s.handlers[r],[o,l]=yD[r];t.addEventListener(o,a,{passive:l})}},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){if(n.handlers)for(const s in n.handlers){const r=n.handlers[s],[a]=yD[s];n.connected.removeEventListener(a,r)}t(s=>({events:{...s.events,connected:void 0}}))}}}}function H4(i,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>i(...n),e)}}function bde({debounce:i,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const s=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[r,a]=ce.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=ce.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:r,orientationHandler:null}),l=i?typeof i=="number"?i:i.scroll:null,c=i?typeof i=="number"?i:i.resize:null,h=ce.useRef(!1);ce.useEffect(()=>(h.current=!0,()=>void(h.current=!1)));const[d,m,y]=ce.useMemo(()=>{const A=()=>{if(!o.current.element)return;const{left:T,top:w,width:R,height:O,bottom:N,right:U,x:P,y:B}=o.current.element.getBoundingClientRect(),L={left:T,top:w,width:R,height:O,bottom:N,right:U,x:P,y:B};o.current.element instanceof HTMLElement&&n&&(L.height=o.current.element.offsetHeight,L.width=o.current.element.offsetWidth),Object.freeze(L),h.current&&!Sde(o.current.lastBounds,L)&&a(o.current.lastBounds=L)};return[A,c?H4(A,c):A,l?H4(A,l):A]},[a,n,l,c]);function x(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(A=>A.removeEventListener("scroll",y,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null),o.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",o.current.orientationHandler))}function _(){o.current.element&&(o.current.resizeObserver=new s(y),o.current.resizeObserver.observe(o.current.element),e&&o.current.scrollContainers&&o.current.scrollContainers.forEach(A=>A.addEventListener("scroll",y,{capture:!0,passive:!0})),o.current.orientationHandler=()=>{y()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",o.current.orientationHandler))}const b=A=>{!A||A===o.current.element||(x(),o.current.element=A,o.current.scrollContainers=NV(A),_())};return Ede(y,!!e),Ade(m),ce.useEffect(()=>{x(),_()},[e,y,m]),ce.useEffect(()=>x,[]),[b,r,d]}function Ade(i){ce.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[i])}function Ede(i,e){ce.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[i,e])}function NV(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:s}=window.getComputedStyle(i);return[t,n,s].some(r=>r==="auto"||r==="scroll")&&e.push(i),[...e,...NV(i.parentElement)]}const _de=["x","y","top","bottom","left","right","width","height"],Sde=(i,e)=>_de.every(t=>i[t]===e[t]);function Tde({ref:i,children:e,fallback:t,resize:n,style:s,gl:r,events:a=xde,eventSource:o,eventPrefix:l,shadows:c,linear:h,flat:d,legacy:m,orthographic:y,frameloop:x,dpr:_,performance:b,raycaster:A,camera:T,scene:w,onPointerMissed:R,onCreated:O,...N}){ce.useMemo(()=>wO(pfe),[]);const U=Gfe(),[P,B]=bde({scroll:!0,debounce:{scroll:50,resize:0},...n}),L=ce.useRef(null),F=ce.useRef(null);ce.useImperativeHandle(i,()=>L.current);const j=_O(R),[J,re]=ce.useState(!1),[q,W]=ce.useState(!1);if(J)throw J;if(q)throw q;const ne=ce.useRef(null);$E(()=>{const ue=L.current;if(B.width>0&&B.height>0&&ue){ne.current||(ne.current=fde(ue));async function z(){await ne.current.configure({gl:r,scene:w,events:a,shadows:c,linear:h,flat:d,legacy:m,orthographic:y,frameloop:x,dpr:_,performance:b,raycaster:A,camera:T,size:B,onPointerMissed:(...ae)=>j.current==null?void 0:j.current(...ae),onCreated:ae=>{ae.events.connect==null||ae.events.connect(o?Ffe(o)?o.current:o:F.current),l&&ae.setEvents({compute:(ge,Ee)=>{const le=ge[l+"X"],Ce=ge[l+"Y"];Ee.pointer.set(le/Ee.size.width*2-1,-(Ce/Ee.size.height)*2+1),Ee.raycaster.setFromCamera(Ee.pointer,Ee.camera)}}),O==null||O(ae)}}),ne.current.render(Re.jsx(U,{children:Re.jsx(Vfe,{set:W,children:Re.jsx(ce.Suspense,{fallback:Re.jsx(zfe,{set:re}),children:e??null})})}))}z()}}),ce.useEffect(()=>{const ue=L.current;if(ue)return()=>OV(ue)},[]);const ie=o?"none":"auto";return Re.jsx("div",{ref:F,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ie,...s},...N,children:Re.jsx("div",{ref:P,style:{width:"100%",height:"100%"},children:Re.jsx("canvas",{ref:L,style:{display:"block"},children:t})})})}function wde(i){return Re.jsx(AV,{children:Re.jsx(Tde,{...i})})}function aE(){return aE=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},aE.apply(null,arguments)}const CO=parseInt(Sg.replace(/\D+/g,""));function G4(i,e){if(e===i9)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===iw||e===FB){let t=i.getIndex();if(t===null){const a=[],o=i.getAttribute("position");if(o!==void 0){for(let l=0;l<o.count;l++)a.push(l);i.setIndex(a),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}const n=t.count-2,s=[];if(t)if(e===iw)for(let a=1;a<=n;a++)s.push(t.getX(0)),s.push(t.getX(a)),s.push(t.getX(a+1));else for(let a=0;a<n;a++)a%2===0?(s.push(t.getX(a)),s.push(t.getX(a+1)),s.push(t.getX(a+2))):(s.push(t.getX(a+2)),s.push(t.getX(a+1)),s.push(t.getX(a)));s.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=i.clone();return r.setIndex(s),r.clearGroups(),r}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}var Pl=Uint8Array,S0=Uint16Array,hI=Uint32Array,UV=new Pl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),kV=new Pl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Mde=new Pl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),FV=function(i,e){for(var t=new S0(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];for(var s=new hI(t[30]),n=1;n<30;++n)for(var r=t[n];r<t[n+1];++r)s[r]=r-t[n]<<5|n;return[t,s]},HV=FV(UV,2),GV=HV[0],Cde=HV[1];GV[28]=258,Cde[258]=28;var Rde=FV(kV,0),Dde=Rde[0],fI=new S0(32768);for(var ds=0;ds<32768;++ds){var qd=(ds&43690)>>>1|(ds&21845)<<1;qd=(qd&52428)>>>2|(qd&13107)<<2,qd=(qd&61680)>>>4|(qd&3855)<<4,fI[ds]=((qd&65280)>>>8|(qd&255)<<8)>>>1}var bA=function(i,e,t){for(var n=i.length,s=0,r=new S0(e);s<n;++s)++r[i[s]-1];var a=new S0(e);for(s=0;s<e;++s)a[s]=a[s-1]+r[s-1]<<1;var o;if(t){o=new S0(1<<e);var l=15-e;for(s=0;s<n;++s)if(i[s])for(var c=s<<4|i[s],h=e-i[s],d=a[i[s]-1]++<<h,m=d|(1<<h)-1;d<=m;++d)o[fI[d]>>>l]=c}else for(o=new S0(n),s=0;s<n;++s)i[s]&&(o[s]=fI[a[i[s]-1]++]>>>15-i[s]);return o},JE=new Pl(288);for(var ds=0;ds<144;++ds)JE[ds]=8;for(var ds=144;ds<256;++ds)JE[ds]=9;for(var ds=256;ds<280;++ds)JE[ds]=7;for(var ds=280;ds<288;++ds)JE[ds]=8;var zV=new Pl(32);for(var ds=0;ds<32;++ds)zV[ds]=5;var Lde=bA(JE,9,1),Ide=bA(zV,5,1),vD=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},Tc=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(e&7)&t},xD=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(e&7)},Bde=function(i){return(i/8|0)+(i&7&&1)},Ode=function(i,e,t){(t==null||t>i.length)&&(t=i.length);var n=new(i instanceof S0?S0:i instanceof hI?hI:Pl)(t-e);return n.set(i.subarray(e,t)),n},Pde=function(i,e,t){var n=i.length;if(!n||t&&!t.l&&n<5)return e||new Pl(0);var s=!e||t,r=!t||t.i;t||(t={}),e||(e=new Pl(n*3));var a=function(Me){var Ze=e.length;if(Me>Ze){var tt=new Pl(Math.max(Ze*2,Me));tt.set(e),e=tt}},o=t.f||0,l=t.p||0,c=t.b||0,h=t.l,d=t.d,m=t.m,y=t.n,x=n*8;do{if(!h){t.f=o=Tc(i,l,1);var _=Tc(i,l+1,3);if(l+=3,_)if(_==1)h=Lde,d=Ide,m=9,y=5;else if(_==2){var w=Tc(i,l,31)+257,R=Tc(i,l+10,15)+4,O=w+Tc(i,l+5,31)+1;l+=14;for(var N=new Pl(O),U=new Pl(19),P=0;P<R;++P)U[Mde[P]]=Tc(i,l+P*3,7);l+=R*3;for(var B=vD(U),L=(1<<B)-1,F=bA(U,B,1),P=0;P<O;){var j=F[Tc(i,l,L)];l+=j&15;var b=j>>>4;if(b<16)N[P++]=b;else{var J=0,re=0;for(b==16?(re=3+Tc(i,l,3),l+=2,J=N[P-1]):b==17?(re=3+Tc(i,l,7),l+=3):b==18&&(re=11+Tc(i,l,127),l+=7);re--;)N[P++]=J}}var q=N.subarray(0,w),W=N.subarray(w);m=vD(q),y=vD(W),h=bA(q,m,1),d=bA(W,y,1)}else throw"invalid block type";else{var b=Bde(l)+4,A=i[b-4]|i[b-3]<<8,T=b+A;if(T>n){if(r)throw"unexpected EOF";break}s&&a(c+A),e.set(i.subarray(b,T),c),t.b=c+=A,t.p=l=T*8;continue}if(l>x){if(r)throw"unexpected EOF";break}}s&&a(c+131072);for(var ne=(1<<m)-1,ie=(1<<y)-1,ue=l;;ue=l){var J=h[xD(i,l)&ne],z=J>>>4;if(l+=J&15,l>x){if(r)throw"unexpected EOF";break}if(!J)throw"invalid length/literal";if(z<256)e[c++]=z;else if(z==256){ue=l,h=null;break}else{var ae=z-254;if(z>264){var P=z-257,ge=UV[P];ae=Tc(i,l,(1<<ge)-1)+GV[P],l+=ge}var Ee=d[xD(i,l)&ie],le=Ee>>>4;if(!Ee)throw"invalid distance";l+=Ee&15;var W=Dde[le];if(le>3){var ge=kV[le];W+=xD(i,l)&(1<<ge)-1,l+=ge}if(l>x){if(r)throw"unexpected EOF";break}s&&a(c+131072);for(var Ce=c+ae;c<Ce;c+=4)e[c]=e[c-W],e[c+1]=e[c+1-W],e[c+2]=e[c+2-W],e[c+3]=e[c+3-W];c=Ce}}t.l=h,t.p=ue,t.b=c,h&&(o=1,t.m=m,t.d=d,t.n=y)}while(!o);return c==e.length?e:Ode(e,0,c)},Nde=new Pl(0),Ude=function(i){if((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(i[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function ZS(i,e){return Pde((Ude(i),i.subarray(2,-4)),e)}var kde=typeof TextDecoder<"u"&&new TextDecoder,Fde=0;try{kde.decode(Nde,{stream:!0}),Fde=1}catch{}const Hde=i=>i&&i.isCubeTexture;class Gde extends ms{constructor(e,t){var n,s;const r=Hde(e),o=((s=r?(n=e.image[0])==null?void 0:n.width:e.image.width)!=null?s:1024)/4,l=Math.floor(Math.log2(o)),c=Math.pow(2,l),h=3*Math.max(c,16*7),d=4*c,m=[r?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/h}`,`#define CUBEUV_TEXEL_HEIGHT ${1/d}`,`#define CUBEUV_MAX_MIP ${l}.0`],y=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,x=m.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${CO>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,_={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},b=new jE(1,16),A=new js({uniforms:_,fragmentShader:x,vertexShader:y,side:Da});super(b,A)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var zde=Object.defineProperty,Vde=(i,e,t)=>e in i?zde(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Yde=(i,e,t)=>(Vde(i,e+"",t),t);class Kde{constructor(){Yde(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const r=s.indexOf(t);r!==-1&&s.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const s=n.slice(0);for(let r=0,a=s.length;r<a;r++)s[r].call(this,e);e.target=null}}}var Wde=Object.defineProperty,Xde=(i,e,t)=>e in i?Wde(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,fn=(i,e,t)=>(Xde(i,typeof e!="symbol"?e+"":e,t),t);const eT=new Tg,z4=new mf,jde=Math.cos(70*(Math.PI/180)),V4=(i,e)=>(i%e+e)%e;let qde=class extends Kde{constructor(e,t){super(),fn(this,"object"),fn(this,"domElement"),fn(this,"enabled",!0),fn(this,"target",new se),fn(this,"minDistance",0),fn(this,"maxDistance",1/0),fn(this,"minZoom",0),fn(this,"maxZoom",1/0),fn(this,"minPolarAngle",0),fn(this,"maxPolarAngle",Math.PI),fn(this,"minAzimuthAngle",-1/0),fn(this,"maxAzimuthAngle",1/0),fn(this,"enableDamping",!1),fn(this,"dampingFactor",.05),fn(this,"enableZoom",!0),fn(this,"zoomSpeed",1),fn(this,"enableRotate",!0),fn(this,"rotateSpeed",1),fn(this,"enablePan",!0),fn(this,"panSpeed",1),fn(this,"screenSpacePanning",!0),fn(this,"keyPanSpeed",7),fn(this,"zoomToCursor",!1),fn(this,"autoRotate",!1),fn(this,"autoRotateSpeed",2),fn(this,"reverseOrbit",!1),fn(this,"reverseHorizontalOrbit",!1),fn(this,"reverseVerticalOrbit",!1),fn(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),fn(this,"mouseButtons",{LEFT:sm.ROTATE,MIDDLE:sm.DOLLY,RIGHT:sm.PAN}),fn(this,"touches",{ONE:rm.ROTATE,TWO:rm.DOLLY_PAN}),fn(this,"target0"),fn(this,"position0"),fn(this,"zoom0"),fn(this,"_domElementKeyEvents",null),fn(this,"getPolarAngle"),fn(this,"getAzimuthalAngle"),fn(this,"setPolarAngle"),fn(this,"setAzimuthalAngle"),fn(this,"getDistance"),fn(this,"getZoomScale"),fn(this,"listenToKeyEvents"),fn(this,"stopListenToKeyEvents"),fn(this,"saveState"),fn(this,"reset"),fn(this,"update"),fn(this,"connect"),fn(this,"dispose"),fn(this,"dollyIn"),fn(this,"dollyOut"),fn(this,"getScale"),fn(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>h.phi,this.getAzimuthalAngle=()=>h.theta,this.setPolarAngle=ve=>{let He=V4(ve,2*Math.PI),St=h.phi;St<0&&(St+=2*Math.PI),He<0&&(He+=2*Math.PI);let xe=Math.abs(He-St);2*Math.PI-xe<xe&&(He<St?He+=2*Math.PI:St+=2*Math.PI),d.phi=He-St,n.update()},this.setAzimuthalAngle=ve=>{let He=V4(ve,2*Math.PI),St=h.theta;St<0&&(St+=2*Math.PI),He<0&&(He+=2*Math.PI);let xe=Math.abs(He-St);2*Math.PI-xe<xe&&(He<St?He+=2*Math.PI:St+=2*Math.PI),d.theta=He-St,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=ve=>{ve.addEventListener("keydown",et),this._domElementKeyEvents=ve},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",et),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(s),n.update(),l=o.NONE},this.update=(()=>{const ve=new se,He=new se(0,1,0),St=new Yr().setFromUnitVectors(e.up,He),xe=St.clone().invert(),Oe=new se,Ge=new Yr,rt=2*Math.PI;return function(){const Bt=n.object.position;St.setFromUnitVectors(e.up,He),xe.copy(St).invert(),ve.copy(Bt).sub(n.target),ve.applyQuaternion(St),h.setFromVector3(ve),n.autoRotate&&l===o.NONE&&re(j()),n.enableDamping?(h.theta+=d.theta*n.dampingFactor,h.phi+=d.phi*n.dampingFactor):(h.theta+=d.theta,h.phi+=d.phi);let $t=n.minAzimuthAngle,Pn=n.maxAzimuthAngle;isFinite($t)&&isFinite(Pn)&&($t<-Math.PI?$t+=rt:$t>Math.PI&&($t-=rt),Pn<-Math.PI?Pn+=rt:Pn>Math.PI&&(Pn-=rt),$t<=Pn?h.theta=Math.max($t,Math.min(Pn,h.theta)):h.theta=h.theta>($t+Pn)/2?Math.max($t,h.theta):Math.min(Pn,h.theta)),h.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,h.phi)),h.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(y,n.dampingFactor):n.target.add(y),n.zoomToCursor&&B||n.object.isOrthographicCamera?h.radius=Ee(h.radius):h.radius=Ee(h.radius*m),ve.setFromSpherical(h),ve.applyQuaternion(xe),Bt.copy(n.target).add(ve),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(d.theta*=1-n.dampingFactor,d.phi*=1-n.dampingFactor,y.multiplyScalar(1-n.dampingFactor)):(d.set(0,0,0),y.set(0,0,0));let gi=!1;if(n.zoomToCursor&&B){let _n=null;if(n.object instanceof Ds&&n.object.isPerspectiveCamera){const ts=ve.length();_n=Ee(ts*m);const cs=ts-_n;n.object.position.addScaledVector(U,cs),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const ts=new se(P.x,P.y,0);ts.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/m)),n.object.updateProjectionMatrix(),gi=!0;const cs=new se(P.x,P.y,0);cs.unproject(n.object),n.object.position.sub(cs).add(ts),n.object.updateMatrixWorld(),_n=ve.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;_n!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(_n).add(n.object.position):(eT.origin.copy(n.object.position),eT.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(eT.direction))<jde?e.lookAt(n.target):(z4.setFromNormalAndCoplanarPoint(n.object.up,n.target),eT.intersectPlane(z4,n.target))))}else n.object instanceof fh&&n.object.isOrthographicCamera&&(gi=m!==1,gi&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/m)),n.object.updateProjectionMatrix()));return m=1,B=!1,gi||Oe.distanceToSquared(n.object.position)>c||8*(1-Ge.dot(n.object.quaternion))>c?(n.dispatchEvent(s),Oe.copy(n.object.position),Ge.copy(n.object.quaternion),gi=!1,!0):!1}})(),this.connect=ve=>{n.domElement=ve,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",it),n.domElement.addEventListener("pointerdown",X),n.domElement.addEventListener("pointercancel",Fe),n.domElement.addEventListener("wheel",ot)},this.dispose=()=>{var ve,He,St,xe,Oe,Ge;n.domElement&&(n.domElement.style.touchAction="auto"),(ve=n.domElement)==null||ve.removeEventListener("contextmenu",it),(He=n.domElement)==null||He.removeEventListener("pointerdown",X),(St=n.domElement)==null||St.removeEventListener("pointercancel",Fe),(xe=n.domElement)==null||xe.removeEventListener("wheel",ot),(Oe=n.domElement)==null||Oe.ownerDocument.removeEventListener("pointermove",we),(Ge=n.domElement)==null||Ge.ownerDocument.removeEventListener("pointerup",Fe),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",et)};const n=this,s={type:"change"},r={type:"start"},a={type:"end"},o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=o.NONE;const c=1e-6,h=new nI,d=new nI;let m=1;const y=new se,x=new Qe,_=new Qe,b=new Qe,A=new Qe,T=new Qe,w=new Qe,R=new Qe,O=new Qe,N=new Qe,U=new se,P=new Qe;let B=!1;const L=[],F={};function j(){return 2*Math.PI/60/60*n.autoRotateSpeed}function J(){return Math.pow(.95,n.zoomSpeed)}function re(ve){n.reverseOrbit||n.reverseHorizontalOrbit?d.theta+=ve:d.theta-=ve}function q(ve){n.reverseOrbit||n.reverseVerticalOrbit?d.phi+=ve:d.phi-=ve}const W=(()=>{const ve=new se;return function(St,xe){ve.setFromMatrixColumn(xe,0),ve.multiplyScalar(-St),y.add(ve)}})(),ne=(()=>{const ve=new se;return function(St,xe){n.screenSpacePanning===!0?ve.setFromMatrixColumn(xe,1):(ve.setFromMatrixColumn(xe,0),ve.crossVectors(n.object.up,ve)),ve.multiplyScalar(St),y.add(ve)}})(),ie=(()=>{const ve=new se;return function(St,xe){const Oe=n.domElement;if(Oe&&n.object instanceof Ds&&n.object.isPerspectiveCamera){const Ge=n.object.position;ve.copy(Ge).sub(n.target);let rt=ve.length();rt*=Math.tan(n.object.fov/2*Math.PI/180),W(2*St*rt/Oe.clientHeight,n.object.matrix),ne(2*xe*rt/Oe.clientHeight,n.object.matrix)}else Oe&&n.object instanceof fh&&n.object.isOrthographicCamera?(W(St*(n.object.right-n.object.left)/n.object.zoom/Oe.clientWidth,n.object.matrix),ne(xe*(n.object.top-n.object.bottom)/n.object.zoom/Oe.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function ue(ve){n.object instanceof Ds&&n.object.isPerspectiveCamera||n.object instanceof fh&&n.object.isOrthographicCamera?m=ve:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function z(ve){ue(m/ve)}function ae(ve){ue(m*ve)}function ge(ve){if(!n.zoomToCursor||!n.domElement)return;B=!0;const He=n.domElement.getBoundingClientRect(),St=ve.clientX-He.left,xe=ve.clientY-He.top,Oe=He.width,Ge=He.height;P.x=St/Oe*2-1,P.y=-(xe/Ge)*2+1,U.set(P.x,P.y,1).unproject(n.object).sub(n.object.position).normalize()}function Ee(ve){return Math.max(n.minDistance,Math.min(n.maxDistance,ve))}function le(ve){x.set(ve.clientX,ve.clientY)}function Ce(ve){ge(ve),R.set(ve.clientX,ve.clientY)}function Me(ve){A.set(ve.clientX,ve.clientY)}function Ze(ve){_.set(ve.clientX,ve.clientY),b.subVectors(_,x).multiplyScalar(n.rotateSpeed);const He=n.domElement;He&&(re(2*Math.PI*b.x/He.clientHeight),q(2*Math.PI*b.y/He.clientHeight)),x.copy(_),n.update()}function tt(ve){O.set(ve.clientX,ve.clientY),N.subVectors(O,R),N.y>0?z(J()):N.y<0&&ae(J()),R.copy(O),n.update()}function Mt(ve){T.set(ve.clientX,ve.clientY),w.subVectors(T,A).multiplyScalar(n.panSpeed),ie(w.x,w.y),A.copy(T),n.update()}function bt(ve){ge(ve),ve.deltaY<0?ae(J()):ve.deltaY>0&&z(J()),n.update()}function cn(ve){let He=!1;switch(ve.code){case n.keys.UP:ie(0,n.keyPanSpeed),He=!0;break;case n.keys.BOTTOM:ie(0,-n.keyPanSpeed),He=!0;break;case n.keys.LEFT:ie(n.keyPanSpeed,0),He=!0;break;case n.keys.RIGHT:ie(-n.keyPanSpeed,0),He=!0;break}He&&(ve.preventDefault(),n.update())}function tn(){if(L.length==1)x.set(L[0].pageX,L[0].pageY);else{const ve=.5*(L[0].pageX+L[1].pageX),He=.5*(L[0].pageY+L[1].pageY);x.set(ve,He)}}function Ot(){if(L.length==1)A.set(L[0].pageX,L[0].pageY);else{const ve=.5*(L[0].pageX+L[1].pageX),He=.5*(L[0].pageY+L[1].pageY);A.set(ve,He)}}function te(){const ve=L[0].pageX-L[1].pageX,He=L[0].pageY-L[1].pageY,St=Math.sqrt(ve*ve+He*He);R.set(0,St)}function At(){n.enableZoom&&te(),n.enablePan&&Ot()}function Ve(){n.enableZoom&&te(),n.enableRotate&&tn()}function st(ve){if(L.length==1)_.set(ve.pageX,ve.pageY);else{const St=Nt(ve),xe=.5*(ve.pageX+St.x),Oe=.5*(ve.pageY+St.y);_.set(xe,Oe)}b.subVectors(_,x).multiplyScalar(n.rotateSpeed);const He=n.domElement;He&&(re(2*Math.PI*b.x/He.clientHeight),q(2*Math.PI*b.y/He.clientHeight)),x.copy(_)}function $e(ve){if(L.length==1)T.set(ve.pageX,ve.pageY);else{const He=Nt(ve),St=.5*(ve.pageX+He.x),xe=.5*(ve.pageY+He.y);T.set(St,xe)}w.subVectors(T,A).multiplyScalar(n.panSpeed),ie(w.x,w.y),A.copy(T)}function Pt(ve){const He=Nt(ve),St=ve.pageX-He.x,xe=ve.pageY-He.y,Oe=Math.sqrt(St*St+xe*xe);O.set(0,Oe),N.set(0,Math.pow(O.y/R.y,n.zoomSpeed)),z(N.y),R.copy(O)}function nt(ve){n.enableZoom&&Pt(ve),n.enablePan&&$e(ve)}function ee(ve){n.enableZoom&&Pt(ve),n.enableRotate&&st(ve)}function X(ve){var He,St;n.enabled!==!1&&(L.length===0&&((He=n.domElement)==null||He.ownerDocument.addEventListener("pointermove",we),(St=n.domElement)==null||St.ownerDocument.addEventListener("pointerup",Fe)),Ct(ve),ve.pointerType==="touch"?pt(ve):ut(ve))}function we(ve){n.enabled!==!1&&(ve.pointerType==="touch"?vt(ve):We(ve))}function Fe(ve){var He,St,xe;Et(ve),L.length===0&&((He=n.domElement)==null||He.releasePointerCapture(ve.pointerId),(St=n.domElement)==null||St.ownerDocument.removeEventListener("pointermove",we),(xe=n.domElement)==null||xe.ownerDocument.removeEventListener("pointerup",Fe)),n.dispatchEvent(a),l=o.NONE}function ut(ve){let He;switch(ve.button){case 0:He=n.mouseButtons.LEFT;break;case 1:He=n.mouseButtons.MIDDLE;break;case 2:He=n.mouseButtons.RIGHT;break;default:He=-1}switch(He){case sm.DOLLY:if(n.enableZoom===!1)return;Ce(ve),l=o.DOLLY;break;case sm.ROTATE:if(ve.ctrlKey||ve.metaKey||ve.shiftKey){if(n.enablePan===!1)return;Me(ve),l=o.PAN}else{if(n.enableRotate===!1)return;le(ve),l=o.ROTATE}break;case sm.PAN:if(ve.ctrlKey||ve.metaKey||ve.shiftKey){if(n.enableRotate===!1)return;le(ve),l=o.ROTATE}else{if(n.enablePan===!1)return;Me(ve),l=o.PAN}break;default:l=o.NONE}l!==o.NONE&&n.dispatchEvent(r)}function We(ve){if(n.enabled!==!1)switch(l){case o.ROTATE:if(n.enableRotate===!1)return;Ze(ve);break;case o.DOLLY:if(n.enableZoom===!1)return;tt(ve);break;case o.PAN:if(n.enablePan===!1)return;Mt(ve);break}}function ot(ve){n.enabled===!1||n.enableZoom===!1||l!==o.NONE&&l!==o.ROTATE||(ve.preventDefault(),n.dispatchEvent(r),bt(ve),n.dispatchEvent(a))}function et(ve){n.enabled===!1||n.enablePan===!1||cn(ve)}function pt(ve){switch(Dt(ve),L.length){case 1:switch(n.touches.ONE){case rm.ROTATE:if(n.enableRotate===!1)return;tn(),l=o.TOUCH_ROTATE;break;case rm.PAN:if(n.enablePan===!1)return;Ot(),l=o.TOUCH_PAN;break;default:l=o.NONE}break;case 2:switch(n.touches.TWO){case rm.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;At(),l=o.TOUCH_DOLLY_PAN;break;case rm.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Ve(),l=o.TOUCH_DOLLY_ROTATE;break;default:l=o.NONE}break;default:l=o.NONE}l!==o.NONE&&n.dispatchEvent(r)}function vt(ve){switch(Dt(ve),l){case o.TOUCH_ROTATE:if(n.enableRotate===!1)return;st(ve),n.update();break;case o.TOUCH_PAN:if(n.enablePan===!1)return;$e(ve),n.update();break;case o.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;nt(ve),n.update();break;case o.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;ee(ve),n.update();break;default:l=o.NONE}}function it(ve){n.enabled!==!1&&ve.preventDefault()}function Ct(ve){L.push(ve)}function Et(ve){delete F[ve.pointerId];for(let He=0;He<L.length;He++)if(L[He].pointerId==ve.pointerId){L.splice(He,1);return}}function Dt(ve){let He=F[ve.pointerId];He===void 0&&(He=new Qe,F[ve.pointerId]=He),He.set(ve.pageX,ve.pageY)}function Nt(ve){const He=ve.pointerId===L[0].pointerId?L[1]:L[0];return F[He.pointerId]}this.dollyIn=(ve=J())=>{ae(ve),n.update()},this.dollyOut=(ve=J())=>{z(ve),n.update()},this.getScale=()=>m,this.setScale=ve=>{ue(ve),n.update()},this.getZoomScale=()=>J(),t!==void 0&&this.connect(t),this.update()}};function dw(i){if(typeof TextDecoder<"u")return new TextDecoder().decode(i);let e="";for(let t=0,n=i.length;t<n;t++)e+=String.fromCharCode(i[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const wm="srgb",Gf="srgb-linear",Y4=3001,Qde=3e3;class RO extends ha{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new t0e(t)}),this.register(function(t){return new n0e(t)}),this.register(function(t){return new h0e(t)}),this.register(function(t){return new f0e(t)}),this.register(function(t){return new d0e(t)}),this.register(function(t){return new s0e(t)}),this.register(function(t){return new r0e(t)}),this.register(function(t){return new a0e(t)}),this.register(function(t){return new o0e(t)}),this.register(function(t){return new e0e(t)}),this.register(function(t){return new l0e(t)}),this.register(function(t){return new i0e(t)}),this.register(function(t){return new u0e(t)}),this.register(function(t){return new c0e(t)}),this.register(function(t){return new Jde(t)}),this.register(function(t){return new p0e(t)}),this.register(function(t){return new m0e(t)})}load(e,t,n,s){const r=this;let a;if(this.resourcePath!=="")a=this.resourcePath;else if(this.path!==""){const c=R0.extractUrlBase(e);a=R0.resolveURL(c,this.path)}else a=R0.extractUrlBase(e);this.manager.itemStart(e);const o=function(c){s?s(c):console.error(c),r.manager.itemError(e),r.manager.itemEnd(e)},l=new ua(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{r.parse(c,a,function(h){t(h),r.manager.itemEnd(e)},o)}catch(h){o(h)}},n,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,s){let r;const a={},o={};if(typeof e=="string")r=JSON.parse(e);else if(e instanceof ArrayBuffer)if(dw(new Uint8Array(e.slice(0,4)))===VV){try{a[Zn.KHR_BINARY_GLTF]=new g0e(e)}catch(h){s&&s(h);return}r=JSON.parse(a[Zn.KHR_BINARY_GLTF].content)}else r=JSON.parse(dw(new Uint8Array(e)));else r=e;if(r.asset===void 0||r.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new R0e(r,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const h=this.pluginCallbacks[c](l);h.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[h.name]=h,a[h.name]=!0}if(r.extensionsUsed)for(let c=0;c<r.extensionsUsed.length;++c){const h=r.extensionsUsed[c],d=r.extensionsRequired||[];switch(h){case Zn.KHR_MATERIALS_UNLIT:a[h]=new Zde;break;case Zn.KHR_DRACO_MESH_COMPRESSION:a[h]=new y0e(r,this.dracoLoader);break;case Zn.KHR_TEXTURE_TRANSFORM:a[h]=new v0e;break;case Zn.KHR_MESH_QUANTIZATION:a[h]=new x0e;break;default:d.indexOf(h)>=0&&o[h]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}l.setExtensions(a),l.setPlugins(o),l.parse(n,s)}parseAsync(e,t){const n=this;return new Promise(function(s,r){n.parse(e,t,s,r)})}}function $de(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const Zn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Jde{constructor(e){this.parser=e,this.name=Zn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,s=t.length;n<s;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let s=t.cache.get(n);if(s)return s;const r=t.json,l=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let c;const h=new Ut(16777215);l.color!==void 0&&h.setRGB(l.color[0],l.color[1],l.color[2],Gf);const d=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new fO(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new hO(h),c.distance=d;break;case"spot":c=new uO(h),c.distance=d,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,hf(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),s=Promise.resolve(c),t.cache.add(n,s),s}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],o=(r.extensions&&r.extensions[this.name]||{}).light;return o===void 0?null:this._loadLight(o).then(function(l){return n._getNodeRef(t.cache,o,l)})}}class Zde{constructor(){this.name=Zn.KHR_MATERIALS_UNLIT}getMaterialType(){return Co}extendParams(e,t,n){const s=[];e.color=new Ut(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const a=r.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],Gf),e.opacity=a[3]}r.baseColorTexture!==void 0&&s.push(n.assignTexture(e,"map",r.baseColorTexture,wm))}return Promise.all(s)}}class e0e{constructor(e){this.parser=e,this.name=Zn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}}class t0e{constructor(e){this.parser=e,this.name=Zn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Gl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],a=s.extensions[this.name];if(a.clearcoatFactor!==void 0&&(t.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(r.push(n.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const o=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Qe(o,o)}return Promise.all(r)}}class n0e{constructor(e){this.parser=e,this.name=Zn.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Gl}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return t.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}}class i0e{constructor(e){this.parser=e,this.name=Zn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Gl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],a=s.extensions[this.name];return a.iridescenceFactor!==void 0&&(t.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(t.iridescenceIOR=a.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(r)}}class s0e{constructor(e){this.parser=e,this.name=Zn.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Gl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new Ut(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=s.extensions[this.name];if(a.sheenColorFactor!==void 0){const o=a.sheenColorFactor;t.sheenColor.setRGB(o[0],o[1],o[2],Gf)}return a.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&r.push(n.assignTexture(t,"sheenColorMap",a.sheenColorTexture,wm)),a.sheenRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(r)}}class r0e{constructor(e){this.parser=e,this.name=Zn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Gl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],a=s.extensions[this.name];return a.transmissionFactor!==void 0&&(t.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&r.push(n.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(r)}}class a0e{constructor(e){this.parser=e,this.name=Zn.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Gl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],a=s.extensions[this.name];t.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&r.push(n.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const o=a.attenuationColor||[1,1,1];return t.attenuationColor=new Ut().setRGB(o[0],o[1],o[2],Gf),Promise.all(r)}}class o0e{constructor(e){this.parser=e,this.name=Zn.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Gl}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class l0e{constructor(e){this.parser=e,this.name=Zn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Gl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],a=s.extensions[this.name];t.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&r.push(n.assignTexture(t,"specularIntensityMap",a.specularTexture));const o=a.specularColorFactor||[1,1,1];return t.specularColor=new Ut().setRGB(o[0],o[1],o[2],Gf),a.specularColorTexture!==void 0&&r.push(n.assignTexture(t,"specularColorMap",a.specularColorTexture,wm)),Promise.all(r)}}class c0e{constructor(e){this.parser=e,this.name=Zn.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Gl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],a=s.extensions[this.name];return t.bumpScale=a.bumpFactor!==void 0?a.bumpFactor:1,a.bumpTexture!==void 0&&r.push(n.assignTexture(t,"bumpMap",a.bumpTexture)),Promise.all(r)}}class u0e{constructor(e){this.parser=e,this.name=Zn.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Gl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],a=s.extensions[this.name];return a.anisotropyStrength!==void 0&&(t.anisotropy=a.anisotropyStrength),a.anisotropyRotation!==void 0&&(t.anisotropyRotation=a.anisotropyRotation),a.anisotropyTexture!==void 0&&r.push(n.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(r)}}class h0e{constructor(e){this.parser=e,this.name=Zn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,s=n.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const r=s.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,a)}}class f0e{constructor(e){this.parser=e,this.name=Zn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,s=n.json,r=s.textures[e];if(!r.extensions||!r.extensions[t])return null;const a=r.extensions[t],o=s.images[a.source];let l=n.textureLoader;if(o.uri){const c=n.options.manager.getHandler(o.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,a.source,l);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class d0e{constructor(e){this.parser=e,this.name=Zn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,s=n.json,r=s.textures[e];if(!r.extensions||!r.extensions[t])return null;const a=r.extensions[t],o=s.images[a.source];let l=n.textureLoader;if(o.uri){const c=n.options.manager.getHandler(o.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,a.source,l);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class p0e{constructor(e){this.name=Zn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const s=n.extensions[this.name],r=this.parser.getDependency("buffer",s.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(o){const l=s.byteOffset||0,c=s.byteLength||0,h=s.count,d=s.byteStride,m=new Uint8Array(o,l,c);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(h,d,m,s.mode,s.filter).then(function(y){return y.buffer}):a.ready.then(function(){const y=new ArrayBuffer(h*d);return a.decodeGltfBuffer(new Uint8Array(y),h,d,m,s.mode,s.filter),y})})}else return null}}class m0e{constructor(e){this.name=Zn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const s=t.meshes[n.mesh];for(const c of s.primitives)if(c.mode!==Cl.TRIANGLES&&c.mode!==Cl.TRIANGLE_STRIP&&c.mode!==Cl.TRIANGLE_FAN&&c.mode!==void 0)return null;const a=n.extensions[this.name].attributes,o=[],l={};for(const c in a)o.push(this.parser.getDependency("accessor",a[c]).then(h=>(l[c]=h,l[c])));return o.length<1?null:(o.push(this.parser.createNodeMesh(e)),Promise.all(o).then(c=>{const h=c.pop(),d=h.isGroup?h.children:[h],m=c[0].count,y=[];for(const x of d){const _=new hn,b=new se,A=new Yr,T=new se(1,1,1),w=new XB(x.geometry,x.material,m);for(let R=0;R<m;R++)l.TRANSLATION&&b.fromBufferAttribute(l.TRANSLATION,R),l.ROTATION&&A.fromBufferAttribute(l.ROTATION,R),l.SCALE&&T.fromBufferAttribute(l.SCALE,R),w.setMatrixAt(R,_.compose(b,A,T));for(const R in l)if(R==="_COLOR_0"){const O=l[R];w.instanceColor=new pg(O.array,O.itemSize,O.normalized)}else R!=="TRANSLATION"&&R!=="ROTATION"&&R!=="SCALE"&&x.geometry.setAttribute(R,l[R]);li.prototype.copy.call(w,x),this.parser.assignFinalMaterial(w),y.push(w)}return h.isGroup?(h.clear(),h.add(...y),h):y[0]}))}}const VV="glTF",Pb=12,K4={JSON:1313821514,BIN:5130562};class g0e{constructor(e){this.name=Zn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Pb);if(this.header={magic:dw(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==VV)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-Pb,s=new DataView(e,Pb);let r=0;for(;r<n;){const a=s.getUint32(r,!0);r+=4;const o=s.getUint32(r,!0);if(r+=4,o===K4.JSON){const l=new Uint8Array(e,Pb+r,a);this.content=dw(l)}else if(o===K4.BIN){const l=Pb+r;this.body=e.slice(l,l+a)}r+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class y0e{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Zn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,s=this.dracoLoader,r=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},l={},c={};for(const h in a){const d=dI[h]||h.toLowerCase();o[d]=a[h]}for(const h in e.attributes){const d=dI[h]||h.toLowerCase();if(a[h]!==void 0){const m=n.accessors[e.attributes[h]],y=My[m.componentType];c[d]=y.name,l[d]=m.normalized===!0}}return t.getDependency("bufferView",r).then(function(h){return new Promise(function(d,m){s.decodeDracoFile(h,function(y){for(const x in y.attributes){const _=y.attributes[x],b=l[x];b!==void 0&&(_.normalized=b)}d(y)},o,c,Gf,m)})})}}class v0e{constructor(){this.name=Zn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class x0e{constructor(){this.name=Zn.KHR_MESH_QUANTIZATION}}class YV extends Qv{constructor(e,t,n,s){super(e,t,n,s)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,r=e*s*3+s;for(let a=0;a!==s;a++)t[a]=n[r+a];return t}interpolate_(e,t,n,s){const r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=o*2,c=o*3,h=s-t,d=(n-t)/h,m=d*d,y=m*d,x=e*c,_=x-c,b=-2*y+3*m,A=y-m,T=1-b,w=A-m+d;for(let R=0;R!==o;R++){const O=a[_+R+o],N=a[_+R+l]*h,U=a[x+R+o],P=a[x+R]*h;r[R]=T*O+w*N+b*U+A*P}return r}}const b0e=new Yr;class A0e extends YV{interpolate_(e,t,n,s){const r=super.interpolate_(e,t,n,s);return b0e.fromArray(r).normalize().toArray(r),r}}const Cl={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},My={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},W4={9728:Ws,9729:ei,9984:Zw,9985:Ty,9986:bm,9987:Nl},X4={33071:sr,33648:Cv,10497:U0},bD={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},dI={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...CO>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Qd={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},E0e={CUBICSPLINE:void 0,LINEAR:Iv,STEP:Lv},AD={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function _0e(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new qv({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:qc})),i.DefaultMaterial}function $p(i,e,t){for(const n in t.extensions)i[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function hf(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function S0e(i,e,t){let n=!1,s=!1,r=!1;for(let c=0,h=e.length;c<h;c++){const d=e[c];if(d.POSITION!==void 0&&(n=!0),d.NORMAL!==void 0&&(s=!0),d.COLOR_0!==void 0&&(r=!0),n&&s&&r)break}if(!n&&!s&&!r)return Promise.resolve(i);const a=[],o=[],l=[];for(let c=0,h=e.length;c<h;c++){const d=e[c];if(n){const m=d.POSITION!==void 0?t.getDependency("accessor",d.POSITION):i.attributes.position;a.push(m)}if(s){const m=d.NORMAL!==void 0?t.getDependency("accessor",d.NORMAL):i.attributes.normal;o.push(m)}if(r){const m=d.COLOR_0!==void 0?t.getDependency("accessor",d.COLOR_0):i.attributes.color;l.push(m)}}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l)]).then(function(c){const h=c[0],d=c[1],m=c[2];return n&&(i.morphAttributes.position=h),s&&(i.morphAttributes.normal=d),r&&(i.morphAttributes.color=m),i.morphTargetsRelative=!0,i})}function T0e(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,s=t.length;n<s;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function w0e(i){let e;const t=i.extensions&&i.extensions[Zn.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+ED(t.attributes):e=i.indices+":"+ED(i.attributes)+":"+i.mode,i.targets!==void 0)for(let n=0,s=i.targets.length;n<s;n++)e+=":"+ED(i.targets[n]);return e}function ED(i){let e="";const t=Object.keys(i).sort();for(let n=0,s=t.length;n<s;n++)e+=t[n]+":"+i[t[n]]+";";return e}function pI(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function M0e(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const C0e=new hn;class R0e{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new $de,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,s=!1,r=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,s=navigator.userAgent.indexOf("Firefox")>-1,r=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||s&&r<98?this.textureLoader=new $9(this.options.manager):this.textureLoader=new rV(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new ua(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,s=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(a){const o={scene:a[0][s.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:s.asset,parser:n,userData:{}};return $p(r,o,s),hf(o,s),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(o)})).then(function(){for(const l of o.scenes)l.updateMatrixWorld();e(o)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let s=0,r=t.length;s<r;s++){const a=t[s].joints;for(let o=0,l=a.length;o<l;o++)e[a[o]].isBone=!0}for(let s=0,r=e.length;s<r;s++){const a=e[s];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(n[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const s=n.clone(),r=(a,o)=>{const l=this.associations.get(a);l!=null&&this.associations.set(o,l);for(const[c,h]of a.children.entries())r(h,o.children[c])};return r(n,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const s=e(t[n]);if(s)return s}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let s=0;s<t.length;s++){const r=e(t[s]);r&&n.push(r)}return n}getDependency(e,t){const n=e+":"+t;let s=this.cache.get(n);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(r){return r.loadNode&&r.loadNode(t)});break;case"mesh":s=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(n,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(s.map(function(r,a){return n.getDependency(e,a)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Zn.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(r,a){n.load(R0.resolveURL(t.uri,s.path),r,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const s=t.byteLength||0,r=t.byteOffset||0;return n.slice(r,r+s)})}loadAccessor(e){const t=this,n=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const a=bD[s.type],o=My[s.componentType],l=s.normalized===!0,c=new o(s.count*a);return Promise.resolve(new ci(c,a,l))}const r=[];return s.bufferView!==void 0?r.push(this.getDependency("bufferView",s.bufferView)):r.push(null),s.sparse!==void 0&&(r.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(r).then(function(a){const o=a[0],l=bD[s.type],c=My[s.componentType],h=c.BYTES_PER_ELEMENT,d=h*l,m=s.byteOffset||0,y=s.bufferView!==void 0?n.bufferViews[s.bufferView].byteStride:void 0,x=s.normalized===!0;let _,b;if(y&&y!==d){const A=Math.floor(m/y),T="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+A+":"+s.count;let w=t.cache.get(T);w||(_=new c(o,A*y,s.count*y/h),w=new YE(_,y/h),t.cache.add(T,w)),b=new k0(w,l,m%y/h,x)}else o===null?_=new c(s.count*l):_=new c(o,m,s.count*l),b=new ci(_,l,x);if(s.sparse!==void 0){const A=bD.SCALAR,T=My[s.sparse.indices.componentType],w=s.sparse.indices.byteOffset||0,R=s.sparse.values.byteOffset||0,O=new T(a[1],w,s.sparse.count*A),N=new c(a[2],R,s.sparse.count*l);o!==null&&(b=new ci(b.array.slice(),b.itemSize,b.normalized));for(let U=0,P=O.length;U<P;U++){const B=O[U];if(b.setX(B,N[U*l]),l>=2&&b.setY(B,N[U*l+1]),l>=3&&b.setZ(B,N[U*l+2]),l>=4&&b.setW(B,N[U*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return b})}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,a=t.images[r];let o=this.textureLoader;if(a.uri){const l=n.manager.getHandler(a.uri);l!==null&&(o=l)}return this.loadTextureImage(e,r,o)}loadTextureImage(e,t,n){const s=this,r=this.json,a=r.textures[e],o=r.images[t],l=(o.uri||o.bufferView)+":"+a.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,n).then(function(h){h.flipY=!1,h.name=a.name||o.name||"",h.name===""&&typeof o.uri=="string"&&o.uri.startsWith("data:image/")===!1&&(h.name=o.uri);const m=(r.samplers||{})[a.sampler]||{};return h.magFilter=W4[m.magFilter]||ei,h.minFilter=W4[m.minFilter]||Nl,h.wrapS=X4[m.wrapS]||U0,h.wrapT=X4[m.wrapT]||U0,s.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const n=this,s=this.json,r=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(d=>d.clone());const a=s.images[e],o=self.URL||self.webkitURL;let l=a.uri||"",c=!1;if(a.bufferView!==void 0)l=n.getDependency("bufferView",a.bufferView).then(function(d){c=!0;const m=new Blob([d],{type:a.mimeType});return l=o.createObjectURL(m),l});else if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(l).then(function(d){return new Promise(function(m,y){let x=m;t.isImageBitmapLoader===!0&&(x=function(_){const b=new wi(_);b.needsUpdate=!0,m(b)}),t.load(R0.resolveURL(d,r.path),x,void 0,y)})}).then(function(d){return c===!0&&o.revokeObjectURL(l),hf(d,a),d.userData.mimeType=a.mimeType||M0e(a.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),d});return this.sourceCache[e]=h,h}assignTexture(e,t,n,s){const r=this;return this.getDependency("texture",n.index).then(function(a){if(!a)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(a=a.clone(),a.channel=n.texCoord),r.extensions[Zn.KHR_TEXTURE_TRANSFORM]){const o=n.extensions!==void 0?n.extensions[Zn.KHR_TEXTURE_TRANSFORM]:void 0;if(o){const l=r.associations.get(a);a=r.extensions[Zn.KHR_TEXTURE_TRANSFORM].extendTexture(a,o),r.associations.set(a,l)}}return s!==void 0&&(typeof s=="number"&&(s=s===Y4?wm:Gf),"colorSpace"in a?a.colorSpace=s:a.encoding=s===wm?Y4:Qde),e[t]=a,a})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const s=t.attributes.tangent===void 0,r=t.attributes.color!==void 0,a=t.attributes.normal===void 0;if(e.isPoints){const o="PointsMaterial:"+n.uuid;let l=this.cache.get(o);l||(l=new dM,ur.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(o,l)),n=l}else if(e.isLine){const o="LineBasicMaterial:"+n.uuid;let l=this.cache.get(o);l||(l=new Oa,ur.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,this.cache.add(o,l)),n=l}if(s||r||a){let o="ClonedMaterial:"+n.uuid+":";s&&(o+="derivative-tangents:"),r&&(o+="vertex-colors:"),a&&(o+="flat-shading:");let l=this.cache.get(o);l||(l=n.clone(),r&&(l.vertexColors=!0),a&&(l.flatShading=!0),s&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(o,l),this.associations.set(l,this.associations.get(n))),n=l}e.material=n}getMaterialType(){return qv}loadMaterial(e){const t=this,n=this.json,s=this.extensions,r=n.materials[e];let a;const o={},l=r.extensions||{},c=[];if(l[Zn.KHR_MATERIALS_UNLIT]){const d=s[Zn.KHR_MATERIALS_UNLIT];a=d.getMaterialType(),c.push(d.extendParams(o,r,t))}else{const d=r.pbrMetallicRoughness||{};if(o.color=new Ut(1,1,1),o.opacity=1,Array.isArray(d.baseColorFactor)){const m=d.baseColorFactor;o.color.setRGB(m[0],m[1],m[2],Gf),o.opacity=m[3]}d.baseColorTexture!==void 0&&c.push(t.assignTexture(o,"map",d.baseColorTexture,wm)),o.metalness=d.metallicFactor!==void 0?d.metallicFactor:1,o.roughness=d.roughnessFactor!==void 0?d.roughnessFactor:1,d.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(o,"metalnessMap",d.metallicRoughnessTexture)),c.push(t.assignTexture(o,"roughnessMap",d.metallicRoughnessTexture))),a=this._invokeOne(function(m){return m.getMaterialType&&m.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(m){return m.extendMaterialParams&&m.extendMaterialParams(e,o)})))}r.doubleSided===!0&&(o.side=Da);const h=r.alphaMode||AD.OPAQUE;if(h===AD.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,h===AD.MASK&&(o.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&a!==Co&&(c.push(t.assignTexture(o,"normalMap",r.normalTexture)),o.normalScale=new Qe(1,1),r.normalTexture.scale!==void 0)){const d=r.normalTexture.scale;o.normalScale.set(d,d)}if(r.occlusionTexture!==void 0&&a!==Co&&(c.push(t.assignTexture(o,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(o.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&a!==Co){const d=r.emissiveFactor;o.emissive=new Ut().setRGB(d[0],d[1],d[2],Gf)}return r.emissiveTexture!==void 0&&a!==Co&&c.push(t.assignTexture(o,"emissiveMap",r.emissiveTexture,wm)),Promise.all(c).then(function(){const d=new a(o);return r.name&&(d.name=r.name),hf(d,r),t.associations.set(d,{materials:e}),r.extensions&&$p(s,d,r),d})}createUniqueName(e){const t=di.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,s=this.primitiveCache;function r(o){return n[Zn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(o,t).then(function(l){return j4(l,o,t)})}const a=[];for(let o=0,l=e.length;o<l;o++){const c=e[o],h=w0e(c),d=s[h];if(d)a.push(d.promise);else{let m;c.extensions&&c.extensions[Zn.KHR_DRACO_MESH_COMPRESSION]?m=r(c):m=j4(new Tn,c,t),s[h]={primitive:c,promise:m},a.push(m)}}return Promise.all(a)}loadMesh(e){const t=this,n=this.json,s=this.extensions,r=n.meshes[e],a=r.primitives,o=[];for(let l=0,c=a.length;l<c;l++){const h=a[l].material===void 0?_0e(this.cache):this.getDependency("material",a[l].material);o.push(h)}return o.push(t.loadGeometries(a)),Promise.all(o).then(function(l){const c=l.slice(0,l.length-1),h=l[l.length-1],d=[];for(let y=0,x=h.length;y<x;y++){const _=h[y],b=a[y];let A;const T=c[y];if(b.mode===Cl.TRIANGLES||b.mode===Cl.TRIANGLE_STRIP||b.mode===Cl.TRIANGLE_FAN||b.mode===void 0)A=r.isSkinnedMesh===!0?new WB(_,T):new ms(_,T),A.isSkinnedMesh===!0&&A.normalizeSkinWeights(),b.mode===Cl.TRIANGLE_STRIP?A.geometry=G4(A.geometry,FB):b.mode===Cl.TRIANGLE_FAN&&(A.geometry=G4(A.geometry,iw));else if(b.mode===Cl.LINES)A=new Zc(_,T);else if(b.mode===Cl.LINE_STRIP)A=new Yf(_,T);else if(b.mode===Cl.LINE_LOOP)A=new jB(_,T);else if(b.mode===Cl.POINTS)A=new qB(_,T);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+b.mode);Object.keys(A.geometry.morphAttributes).length>0&&T0e(A,r),A.name=t.createUniqueName(r.name||"mesh_"+e),hf(A,r),b.extensions&&$p(s,A,b),t.assignFinalMaterial(A),d.push(A)}for(let y=0,x=d.length;y<x;y++)t.associations.set(d[y],{meshes:e,primitives:y});if(d.length===1)return r.extensions&&$p(s,d[0],r),d[0];const m=new Of;r.extensions&&$p(s,m,r),t.associations.set(m,{meshes:e});for(let y=0,x=d.length;y<x;y++)m.add(d[y]);return m})}loadCamera(e){let t;const n=this.json.cameras[e],s=n[n.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new Ds(d9.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):n.type==="orthographic"&&(t=new fh(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),hf(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let s=0,r=t.joints.length;s<r;s++)n.push(this._loadNodeShallow(t.joints[s]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(s){const r=s.pop(),a=s,o=[],l=[];for(let c=0,h=a.length;c<h;c++){const d=a[c];if(d){o.push(d);const m=new hn;r!==null&&m.fromArray(r.array,c*16),l.push(m)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new KE(o,l)})}loadAnimation(e){const t=this.json,n=this,s=t.animations[e],r=s.name?s.name:"animation_"+e,a=[],o=[],l=[],c=[],h=[];for(let d=0,m=s.channels.length;d<m;d++){const y=s.channels[d],x=s.samplers[y.sampler],_=y.target,b=_.node,A=s.parameters!==void 0?s.parameters[x.input]:x.input,T=s.parameters!==void 0?s.parameters[x.output]:x.output;_.node!==void 0&&(a.push(this.getDependency("node",b)),o.push(this.getDependency("accessor",A)),l.push(this.getDependency("accessor",T)),c.push(x),h.push(_))}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l),Promise.all(c),Promise.all(h)]).then(function(d){const m=d[0],y=d[1],x=d[2],_=d[3],b=d[4],A=[];for(let T=0,w=m.length;T<w;T++){const R=m[T],O=y[T],N=x[T],U=_[T],P=b[T];if(R===void 0)continue;R.updateMatrix&&R.updateMatrix();const B=n._createAnimationTracks(R,O,N,U,P);if(B)for(let L=0;L<B.length;L++)A.push(B[L])}return new Uv(r,void 0,A)})}createNodeMesh(e){const t=this.json,n=this,s=t.nodes[e];return s.mesh===void 0?null:n.getDependency("mesh",s.mesh).then(function(r){const a=n._getNodeRef(n.meshCache,s.mesh,r);return s.weights!==void 0&&a.traverse(function(o){if(o.isMesh)for(let l=0,c=s.weights.length;l<c;l++)o.morphTargetInfluences[l]=s.weights[l]}),a})}loadNode(e){const t=this.json,n=this,s=t.nodes[e],r=n._loadNodeShallow(e),a=[],o=s.children||[];for(let c=0,h=o.length;c<h;c++)a.push(n.getDependency("node",o[c]));const l=s.skin===void 0?Promise.resolve(null):n.getDependency("skin",s.skin);return Promise.all([r,Promise.all(a),l]).then(function(c){const h=c[0],d=c[1],m=c[2];m!==null&&h.traverse(function(y){y.isSkinnedMesh&&y.bind(m,C0e)});for(let y=0,x=d.length;y<x;y++)h.add(d[y]);return h})}_loadNodeShallow(e){const t=this.json,n=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const r=t.nodes[e],a=r.name?s.createUniqueName(r.name):"",o=[],l=s._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&o.push(l),r.camera!==void 0&&o.push(s.getDependency("camera",r.camera).then(function(c){return s._getNodeRef(s.cameraCache,r.camera,c)})),s._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){o.push(c)}),this.nodeCache[e]=Promise.all(o).then(function(c){let h;if(r.isBone===!0?h=new hM:c.length>1?h=new Of:c.length===1?h=c[0]:h=new li,h!==c[0])for(let d=0,m=c.length;d<m;d++)h.add(c[d]);if(r.name&&(h.userData.name=r.name,h.name=a),hf(h,r),r.extensions&&$p(n,h,r),r.matrix!==void 0){const d=new hn;d.fromArray(r.matrix),h.applyMatrix4(d)}else r.translation!==void 0&&h.position.fromArray(r.translation),r.rotation!==void 0&&h.quaternion.fromArray(r.rotation),r.scale!==void 0&&h.scale.fromArray(r.scale);return s.associations.has(h)||s.associations.set(h,{}),s.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],s=this,r=new Of;n.name&&(r.name=s.createUniqueName(n.name)),hf(r,n),n.extensions&&$p(t,r,n);const a=n.nodes||[],o=[];for(let l=0,c=a.length;l<c;l++)o.push(s.getDependency("node",a[l]));return Promise.all(o).then(function(l){for(let h=0,d=l.length;h<d;h++)r.add(l[h]);const c=h=>{const d=new Map;for(const[m,y]of s.associations)(m instanceof ur||m instanceof wi)&&d.set(m,y);return h.traverse(m=>{const y=s.associations.get(m);y!=null&&d.set(m,y)}),d};return s.associations=c(r),r})}_createAnimationTracks(e,t,n,s,r){const a=[],o=e.name?e.name:e.uuid,l=[];Qd[r.path]===Qd.weights?e.traverse(function(m){m.morphTargetInfluences&&l.push(m.name?m.name:m.uuid)}):l.push(o);let c;switch(Qd[r.path]){case Qd.weights:c=gg;break;case Qd.rotation:c=yg;break;case Qd.position:case Qd.scale:c=vg;break;default:switch(n.itemSize){case 1:c=gg;break;case 2:case 3:default:c=vg;break}break}const h=s.interpolation!==void 0?E0e[s.interpolation]:Iv,d=this._getArrayFromAccessor(n);for(let m=0,y=l.length;m<y;m++){const x=new c(l[m]+"."+Qd[r.path],t.array,d,h);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(x),a.push(x)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=pI(t.constructor),s=new Float32Array(t.length);for(let r=0,a=t.length;r<a;r++)s[r]=t[r]*n;t=s}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const s=this instanceof yg?A0e:YV;return new s(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function D0e(i,e,t){const n=e.attributes,s=new ca;if(n.POSITION!==void 0){const o=t.json.accessors[n.POSITION],l=o.min,c=o.max;if(l!==void 0&&c!==void 0){if(s.set(new se(l[0],l[1],l[2]),new se(c[0],c[1],c[2])),o.normalized){const h=pI(My[o.componentType]);s.min.multiplyScalar(h),s.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const r=e.targets;if(r!==void 0){const o=new se,l=new se;for(let c=0,h=r.length;c<h;c++){const d=r[c];if(d.POSITION!==void 0){const m=t.json.accessors[d.POSITION],y=m.min,x=m.max;if(y!==void 0&&x!==void 0){if(l.setX(Math.max(Math.abs(y[0]),Math.abs(x[0]))),l.setY(Math.max(Math.abs(y[1]),Math.abs(x[1]))),l.setZ(Math.max(Math.abs(y[2]),Math.abs(x[2]))),m.normalized){const _=pI(My[m.componentType]);l.multiplyScalar(_)}o.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(o)}i.boundingBox=s;const a=new Kr;s.getCenter(a.center),a.radius=s.min.distanceTo(s.max)/2,i.boundingSphere=a}function j4(i,e,t){const n=e.attributes,s=[];function r(a,o){return t.getDependency("accessor",a).then(function(l){i.setAttribute(o,l)})}for(const a in n){const o=dI[a]||a.toLowerCase();o in i.attributes||s.push(r(n[a],o))}if(e.indices!==void 0&&!i.index){const a=t.getDependency("accessor",e.indices).then(function(o){i.setIndex(o)});s.push(a)}return hf(i,e),D0e(i,e,t),Promise.all(s).then(function(){return e.targets!==void 0?S0e(i,e.targets,t):i})}class L0e extends lO{constructor(e){super(e),this.type=yr}parse(e){const a=function(P,B){switch(P){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(B||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(B||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(B||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(B||""))}},h=`
`,d=function(P,B,L){B=B||1024;let j=P.pos,J=-1,re=0,q="",W=String.fromCharCode.apply(null,new Uint16Array(P.subarray(j,j+128)));for(;0>(J=W.indexOf(h))&&re<B&&j<P.byteLength;)q+=W,re+=W.length,j+=128,W+=String.fromCharCode.apply(null,new Uint16Array(P.subarray(j,j+128)));return-1<J?(P.pos+=re+J+1,q+W.slice(0,J)):!1},m=function(P){const B=/^#\?(\S+)/,L=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,F=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,j=/^\s*FORMAT=(\S+)\s*$/,J=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,re={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let q,W;for((P.pos>=P.byteLength||!(q=d(P)))&&a(1,"no header found"),(W=q.match(B))||a(3,"bad initial token"),re.valid|=1,re.programtype=W[1],re.string+=q+`
`;q=d(P),q!==!1;){if(re.string+=q+`
`,q.charAt(0)==="#"){re.comments+=q+`
`;continue}if((W=q.match(L))&&(re.gamma=parseFloat(W[1])),(W=q.match(F))&&(re.exposure=parseFloat(W[1])),(W=q.match(j))&&(re.valid|=2,re.format=W[1]),(W=q.match(J))&&(re.valid|=4,re.height=parseInt(W[1],10),re.width=parseInt(W[2],10)),re.valid&2&&re.valid&4)break}return re.valid&2||a(3,"missing format specifier"),re.valid&4||a(3,"missing image size specifier"),re},y=function(P,B,L){const F=B;if(F<8||F>32767||P[0]!==2||P[1]!==2||P[2]&128)return new Uint8Array(P);F!==(P[2]<<8|P[3])&&a(3,"wrong scanline width");const j=new Uint8Array(4*B*L);j.length||a(4,"unable to allocate buffer space");let J=0,re=0;const q=4*F,W=new Uint8Array(4),ne=new Uint8Array(q);let ie=L;for(;ie>0&&re<P.byteLength;){re+4>P.byteLength&&a(1),W[0]=P[re++],W[1]=P[re++],W[2]=P[re++],W[3]=P[re++],(W[0]!=2||W[1]!=2||(W[2]<<8|W[3])!=F)&&a(3,"bad rgbe scanline format");let ue=0,z;for(;ue<q&&re<P.byteLength;){z=P[re++];const ge=z>128;if(ge&&(z-=128),(z===0||ue+z>q)&&a(3,"bad scanline data"),ge){const Ee=P[re++];for(let le=0;le<z;le++)ne[ue++]=Ee}else ne.set(P.subarray(re,re+z),ue),ue+=z,re+=z}const ae=F;for(let ge=0;ge<ae;ge++){let Ee=0;j[J]=ne[ge+Ee],Ee+=F,j[J+1]=ne[ge+Ee],Ee+=F,j[J+2]=ne[ge+Ee],Ee+=F,j[J+3]=ne[ge+Ee],J+=4}ie--}return j},x=function(P,B,L,F){const j=P[B+3],J=Math.pow(2,j-128)/255;L[F+0]=P[B+0]*J,L[F+1]=P[B+1]*J,L[F+2]=P[B+2]*J,L[F+3]=1},_=function(P,B,L,F){const j=P[B+3],J=Math.pow(2,j-128)/255;L[F+0]=_m.toHalfFloat(Math.min(P[B+0]*J,65504)),L[F+1]=_m.toHalfFloat(Math.min(P[B+1]*J,65504)),L[F+2]=_m.toHalfFloat(Math.min(P[B+2]*J,65504)),L[F+3]=_m.toHalfFloat(1)},b=new Uint8Array(e);b.pos=0;const A=m(b),T=A.width,w=A.height,R=y(b.subarray(b.pos),T,w);let O,N,U;switch(this.type){case ps:U=R.length/4;const P=new Float32Array(U*4);for(let L=0;L<U;L++)x(R,L*4,P,L*4);O=P,N=ps;break;case yr:U=R.length/4;const B=new Uint16Array(U*4);for(let L=0;L<U;L++)_(R,L*4,B,L*4);O=B,N=yr;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:T,height:w,data:O,header:A.string,gamma:A.gamma,exposure:A.exposure,type:N}}setDataType(e){return this.type=e,this}load(e,t,n,s){function r(a,o){switch(a.type){case ps:case yr:"colorSpace"in a?a.colorSpace="srgb-linear":a.encoding=3e3,a.minFilter=ei,a.magFilter=ei,a.generateMipmaps=!1,a.flipY=!0;break}t&&t(a,o)}return super.load(e,r,n,s)}}const Nb=CO>=152;class I0e extends lO{constructor(e){super(e),this.type=yr}parse(e){const B=Math.pow(2.7182818,2.2);function L(V,Z){for(var be=0,ze=0;ze<65536;++ze)(ze==0||V[ze>>3]&1<<(ze&7))&&(Z[be++]=ze);for(var Je=be-1;be<65536;)Z[be++]=0;return Je}function F(V){for(var Z=0;Z<16384;Z++)V[Z]={},V[Z].len=0,V[Z].lit=0,V[Z].p=null}const j={l:0,c:0,lc:0};function J(V,Z,be,ze,Je){for(;be<V;)Z=Z<<8|Nt(ze,Je),be+=8;be-=V,j.l=Z>>be&(1<<V)-1,j.c=Z,j.lc=be}const re=new Array(59);function q(V){for(var Z=0;Z<=58;++Z)re[Z]=0;for(var Z=0;Z<65537;++Z)re[V[Z]]+=1;for(var be=0,Z=58;Z>0;--Z){var ze=be+re[Z]>>1;re[Z]=be,be=ze}for(var Z=0;Z<65537;++Z){var Je=V[Z];Je>0&&(V[Z]=Je|re[Je]++<<6)}}function W(V,Z,be,ze,Je,Xe,Rt){for(var gt=be,Y=0,oe=0;Je<=Xe;Je++){if(gt.value-be.value>ze)return!1;J(6,Y,oe,V,gt);var me=j.l;if(Y=j.c,oe=j.lc,Rt[Je]=me,me==63){if(gt.value-be.value>ze)throw"Something wrong with hufUnpackEncTable";J(8,Y,oe,V,gt);var de=j.l+6;if(Y=j.c,oe=j.lc,Je+de>Xe+1)throw"Something wrong with hufUnpackEncTable";for(;de--;)Rt[Je++]=0;Je--}else if(me>=59){var de=me-59+2;if(Je+de>Xe+1)throw"Something wrong with hufUnpackEncTable";for(;de--;)Rt[Je++]=0;Je--}}q(Rt)}function ne(V){return V&63}function ie(V){return V>>6}function ue(V,Z,be,ze){for(;Z<=be;Z++){var Je=ie(V[Z]),Xe=ne(V[Z]);if(Je>>Xe)throw"Invalid table entry";if(Xe>14){var Rt=ze[Je>>Xe-14];if(Rt.len)throw"Invalid table entry";if(Rt.lit++,Rt.p){var gt=Rt.p;Rt.p=new Array(Rt.lit);for(var Y=0;Y<Rt.lit-1;++Y)Rt.p[Y]=gt[Y]}else Rt.p=new Array(1);Rt.p[Rt.lit-1]=Z}else if(Xe)for(var oe=0,Y=1<<14-Xe;Y>0;Y--){var Rt=ze[(Je<<14-Xe)+oe];if(Rt.len||Rt.p)throw"Invalid table entry";Rt.len=Xe,Rt.lit=Z,oe++}}return!0}const z={c:0,lc:0};function ae(V,Z,be,ze){V=V<<8|Nt(be,ze),Z+=8,z.c=V,z.lc=Z}const ge={c:0,lc:0};function Ee(V,Z,be,ze,Je,Xe,Rt,gt,Y,oe){if(V==Z){ze<8&&(ae(be,ze,Je,Rt),be=z.c,ze=z.lc),ze-=8;var me=be>>ze,me=new Uint8Array([me])[0];if(Y.value+me>oe)return!1;for(var de=gt[Y.value-1];me-- >0;)gt[Y.value++]=de}else if(Y.value<oe)gt[Y.value++]=V;else return!1;ge.c=be,ge.lc=ze}function le(V){return V&65535}function Ce(V){var Z=le(V);return Z>32767?Z-65536:Z}const Me={a:0,b:0};function Ze(V,Z){var be=Ce(V),ze=Ce(Z),Je=ze,Xe=be+(Je&1)+(Je>>1),Rt=Xe,gt=Xe-Je;Me.a=Rt,Me.b=gt}function tt(V,Z){var be=le(V),ze=le(Z),Je=be-(ze>>1)&65535,Xe=ze+Je-32768&65535;Me.a=Xe,Me.b=Je}function Mt(V,Z,be,ze,Je,Xe,Rt){for(var gt=Rt<16384,Y=be>Je?Je:be,oe=1,me;oe<=Y;)oe<<=1;for(oe>>=1,me=oe,oe>>=1;oe>=1;){for(var de=0,Ae=de+Xe*(Je-me),Ne=Xe*oe,qe=Xe*me,ft=ze*oe,dt=ze*me,Ft,kt,Ht,ln;de<=Ae;de+=qe){for(var jt=de,Kn=de+ze*(be-me);jt<=Kn;jt+=dt){var Jt=jt+ft,Yt=jt+Ne,Kt=Yt+ft;gt?(Ze(V[jt+Z],V[Yt+Z]),Ft=Me.a,Ht=Me.b,Ze(V[Jt+Z],V[Kt+Z]),kt=Me.a,ln=Me.b,Ze(Ft,kt),V[jt+Z]=Me.a,V[Jt+Z]=Me.b,Ze(Ht,ln),V[Yt+Z]=Me.a,V[Kt+Z]=Me.b):(tt(V[jt+Z],V[Yt+Z]),Ft=Me.a,Ht=Me.b,tt(V[Jt+Z],V[Kt+Z]),kt=Me.a,ln=Me.b,tt(Ft,kt),V[jt+Z]=Me.a,V[Jt+Z]=Me.b,tt(Ht,ln),V[Yt+Z]=Me.a,V[Kt+Z]=Me.b)}if(be&oe){var Yt=jt+Ne;gt?Ze(V[jt+Z],V[Yt+Z]):tt(V[jt+Z],V[Yt+Z]),Ft=Me.a,V[Yt+Z]=Me.b,V[jt+Z]=Ft}}if(Je&oe)for(var jt=de,Kn=de+ze*(be-me);jt<=Kn;jt+=dt){var Jt=jt+ft;gt?Ze(V[jt+Z],V[Jt+Z]):tt(V[jt+Z],V[Jt+Z]),Ft=Me.a,V[Jt+Z]=Me.b,V[jt+Z]=Ft}me=oe,oe>>=1}return de}function bt(V,Z,be,ze,Je,Xe,Rt,gt,Y,oe){for(var me=0,de=0,Ae=gt,Ne=Math.trunc(Je.value+(Xe+7)/8);Je.value<Ne;)for(ae(me,de,be,Je),me=z.c,de=z.lc;de>=14;){var qe=me>>de-14&16383,ft=Z[qe];if(ft.len)de-=ft.len,Ee(ft.lit,Rt,me,de,be,ze,Je,Y,oe,Ae),me=ge.c,de=ge.lc;else{if(!ft.p)throw"hufDecode issues";var dt;for(dt=0;dt<ft.lit;dt++){for(var Ft=ne(V[ft.p[dt]]);de<Ft&&Je.value<Ne;)ae(me,de,be,Je),me=z.c,de=z.lc;if(de>=Ft&&ie(V[ft.p[dt]])==(me>>de-Ft&(1<<Ft)-1)){de-=Ft,Ee(ft.p[dt],Rt,me,de,be,ze,Je,Y,oe,Ae),me=ge.c,de=ge.lc;break}}if(dt==ft.lit)throw"hufDecode issues"}}var kt=8-Xe&7;for(me>>=kt,de-=kt;de>0;){var ft=Z[me<<14-de&16383];if(ft.len)de-=ft.len,Ee(ft.lit,Rt,me,de,be,ze,Je,Y,oe,Ae),me=ge.c,de=ge.lc;else throw"hufDecode issues"}return!0}function cn(V,Z,be,ze,Je,Xe){var Rt={value:0},gt=be.value,Y=Dt(Z,be),oe=Dt(Z,be);be.value+=4;var me=Dt(Z,be);if(be.value+=4,Y<0||Y>=65537||oe<0||oe>=65537)throw"Something wrong with HUF_ENCSIZE";var de=new Array(65537),Ae=new Array(16384);F(Ae);var Ne=ze-(be.value-gt);if(W(V,Z,be,Ne,Y,oe,de),me>8*(ze-(be.value-gt)))throw"Something wrong with hufUncompress";ue(de,Y,oe,Ae),bt(de,Ae,V,Z,be,me,oe,Xe,Je,Rt)}function tn(V,Z,be){for(var ze=0;ze<be;++ze)Z[ze]=V[Z[ze]]}function Ot(V){for(var Z=1;Z<V.length;Z++){var be=V[Z-1]+V[Z]-128;V[Z]=be}}function te(V,Z){for(var be=0,ze=Math.floor((V.length+1)/2),Je=0,Xe=V.length-1;!(Je>Xe||(Z[Je++]=V[be++],Je>Xe));)Z[Je++]=V[ze++]}function At(V){for(var Z=V.byteLength,be=new Array,ze=0,Je=new DataView(V);Z>0;){var Xe=Je.getInt8(ze++);if(Xe<0){var Rt=-Xe;Z-=Rt+1;for(var gt=0;gt<Rt;gt++)be.push(Je.getUint8(ze++))}else{var Rt=Xe;Z-=2;for(var Y=Je.getUint8(ze++),gt=0;gt<Rt+1;gt++)be.push(Y)}}return be}function Ve(V,Z,be,ze,Je,Xe){var Jt=new DataView(Xe.buffer),Rt=be[V.idx[0]].width,gt=be[V.idx[0]].height,Y=3,oe=Math.floor(Rt/8),me=Math.ceil(Rt/8),de=Math.ceil(gt/8),Ae=Rt-(me-1)*8,Ne=gt-(de-1)*8,qe={value:0},ft=new Array(Y),dt=new Array(Y),Ft=new Array(Y),kt=new Array(Y),Ht=new Array(Y);for(let Sn=0;Sn<Y;++Sn)Ht[Sn]=Z[V.idx[Sn]],ft[Sn]=Sn<1?0:ft[Sn-1]+me*de,dt[Sn]=new Float32Array(64),Ft[Sn]=new Uint16Array(64),kt[Sn]=new Uint16Array(me*64);for(let Sn=0;Sn<de;++Sn){var ln=8;Sn==de-1&&(ln=Ne);var jt=8;for(let In=0;In<me;++In){In==me-1&&(jt=Ae);for(let mn=0;mn<Y;++mn)Ft[mn].fill(0),Ft[mn][0]=Je[ft[mn]++],st(qe,ze,Ft[mn]),$e(Ft[mn],dt[mn]),Pt(dt[mn]);nt(dt);for(let mn=0;mn<Y;++mn)ee(dt[mn],kt[mn],In*64)}let Ai=0;for(let In=0;In<Y;++In){const mn=be[V.idx[In]].type;for(let wn=8*Sn;wn<8*Sn+ln;++wn){Ai=Ht[In][wn];for(let ns=0;ns<oe;++ns){const yi=ns*64+(wn&7)*8;Jt.setUint16(Ai+0*2*mn,kt[In][yi+0],!0),Jt.setUint16(Ai+1*2*mn,kt[In][yi+1],!0),Jt.setUint16(Ai+2*2*mn,kt[In][yi+2],!0),Jt.setUint16(Ai+3*2*mn,kt[In][yi+3],!0),Jt.setUint16(Ai+4*2*mn,kt[In][yi+4],!0),Jt.setUint16(Ai+5*2*mn,kt[In][yi+5],!0),Jt.setUint16(Ai+6*2*mn,kt[In][yi+6],!0),Jt.setUint16(Ai+7*2*mn,kt[In][yi+7],!0),Ai+=8*2*mn}}if(oe!=me)for(let wn=8*Sn;wn<8*Sn+ln;++wn){const ns=Ht[In][wn]+8*oe*2*mn,yi=oe*64+(wn&7)*8;for(let vi=0;vi<jt;++vi)Jt.setUint16(ns+vi*2*mn,kt[In][yi+vi],!0)}}}for(var Kn=new Uint16Array(Rt),Jt=new DataView(Xe.buffer),Yt=0;Yt<Y;++Yt){be[V.idx[Yt]].decoded=!0;var Kt=be[V.idx[Yt]].type;if(be[Yt].type==2)for(var Ki=0;Ki<gt;++Ki){const Sn=Ht[Yt][Ki];for(var pn=0;pn<Rt;++pn)Kn[pn]=Jt.getUint16(Sn+pn*2*Kt,!0);for(var pn=0;pn<Rt;++pn)Jt.setFloat32(Sn+pn*2*Kt,Oe(Kn[pn]),!0)}}}function st(V,Z,be){for(var ze,Je=1;Je<64;)ze=Z[V.value],ze==65280?Je=64:ze>>8==255?Je+=ze&255:(be[Je]=ze,Je++),V.value++}function $e(V,Z){Z[0]=Oe(V[0]),Z[1]=Oe(V[1]),Z[2]=Oe(V[5]),Z[3]=Oe(V[6]),Z[4]=Oe(V[14]),Z[5]=Oe(V[15]),Z[6]=Oe(V[27]),Z[7]=Oe(V[28]),Z[8]=Oe(V[2]),Z[9]=Oe(V[4]),Z[10]=Oe(V[7]),Z[11]=Oe(V[13]),Z[12]=Oe(V[16]),Z[13]=Oe(V[26]),Z[14]=Oe(V[29]),Z[15]=Oe(V[42]),Z[16]=Oe(V[3]),Z[17]=Oe(V[8]),Z[18]=Oe(V[12]),Z[19]=Oe(V[17]),Z[20]=Oe(V[25]),Z[21]=Oe(V[30]),Z[22]=Oe(V[41]),Z[23]=Oe(V[43]),Z[24]=Oe(V[9]),Z[25]=Oe(V[11]),Z[26]=Oe(V[18]),Z[27]=Oe(V[24]),Z[28]=Oe(V[31]),Z[29]=Oe(V[40]),Z[30]=Oe(V[44]),Z[31]=Oe(V[53]),Z[32]=Oe(V[10]),Z[33]=Oe(V[19]),Z[34]=Oe(V[23]),Z[35]=Oe(V[32]),Z[36]=Oe(V[39]),Z[37]=Oe(V[45]),Z[38]=Oe(V[52]),Z[39]=Oe(V[54]),Z[40]=Oe(V[20]),Z[41]=Oe(V[22]),Z[42]=Oe(V[33]),Z[43]=Oe(V[38]),Z[44]=Oe(V[46]),Z[45]=Oe(V[51]),Z[46]=Oe(V[55]),Z[47]=Oe(V[60]),Z[48]=Oe(V[21]),Z[49]=Oe(V[34]),Z[50]=Oe(V[37]),Z[51]=Oe(V[47]),Z[52]=Oe(V[50]),Z[53]=Oe(V[56]),Z[54]=Oe(V[59]),Z[55]=Oe(V[61]),Z[56]=Oe(V[35]),Z[57]=Oe(V[36]),Z[58]=Oe(V[48]),Z[59]=Oe(V[49]),Z[60]=Oe(V[57]),Z[61]=Oe(V[58]),Z[62]=Oe(V[62]),Z[63]=Oe(V[63])}function Pt(V){const Z=.5*Math.cos(.7853975),be=.5*Math.cos(3.14159/16),ze=.5*Math.cos(3.14159/8),Je=.5*Math.cos(3*3.14159/16),Xe=.5*Math.cos(5*3.14159/16),Rt=.5*Math.cos(3*3.14159/8),gt=.5*Math.cos(7*3.14159/16);for(var Y=new Array(4),oe=new Array(4),me=new Array(4),de=new Array(4),Ae=0;Ae<8;++Ae){var Ne=Ae*8;Y[0]=ze*V[Ne+2],Y[1]=Rt*V[Ne+2],Y[2]=ze*V[Ne+6],Y[3]=Rt*V[Ne+6],oe[0]=be*V[Ne+1]+Je*V[Ne+3]+Xe*V[Ne+5]+gt*V[Ne+7],oe[1]=Je*V[Ne+1]-gt*V[Ne+3]-be*V[Ne+5]-Xe*V[Ne+7],oe[2]=Xe*V[Ne+1]-be*V[Ne+3]+gt*V[Ne+5]+Je*V[Ne+7],oe[3]=gt*V[Ne+1]-Xe*V[Ne+3]+Je*V[Ne+5]-be*V[Ne+7],me[0]=Z*(V[Ne+0]+V[Ne+4]),me[3]=Z*(V[Ne+0]-V[Ne+4]),me[1]=Y[0]+Y[3],me[2]=Y[1]-Y[2],de[0]=me[0]+me[1],de[1]=me[3]+me[2],de[2]=me[3]-me[2],de[3]=me[0]-me[1],V[Ne+0]=de[0]+oe[0],V[Ne+1]=de[1]+oe[1],V[Ne+2]=de[2]+oe[2],V[Ne+3]=de[3]+oe[3],V[Ne+4]=de[3]-oe[3],V[Ne+5]=de[2]-oe[2],V[Ne+6]=de[1]-oe[1],V[Ne+7]=de[0]-oe[0]}for(var qe=0;qe<8;++qe)Y[0]=ze*V[16+qe],Y[1]=Rt*V[16+qe],Y[2]=ze*V[48+qe],Y[3]=Rt*V[48+qe],oe[0]=be*V[8+qe]+Je*V[24+qe]+Xe*V[40+qe]+gt*V[56+qe],oe[1]=Je*V[8+qe]-gt*V[24+qe]-be*V[40+qe]-Xe*V[56+qe],oe[2]=Xe*V[8+qe]-be*V[24+qe]+gt*V[40+qe]+Je*V[56+qe],oe[3]=gt*V[8+qe]-Xe*V[24+qe]+Je*V[40+qe]-be*V[56+qe],me[0]=Z*(V[qe]+V[32+qe]),me[3]=Z*(V[qe]-V[32+qe]),me[1]=Y[0]+Y[3],me[2]=Y[1]-Y[2],de[0]=me[0]+me[1],de[1]=me[3]+me[2],de[2]=me[3]-me[2],de[3]=me[0]-me[1],V[0+qe]=de[0]+oe[0],V[8+qe]=de[1]+oe[1],V[16+qe]=de[2]+oe[2],V[24+qe]=de[3]+oe[3],V[32+qe]=de[3]-oe[3],V[40+qe]=de[2]-oe[2],V[48+qe]=de[1]-oe[1],V[56+qe]=de[0]-oe[0]}function nt(V){for(var Z=0;Z<64;++Z){var be=V[0][Z],ze=V[1][Z],Je=V[2][Z];V[0][Z]=be+1.5747*Je,V[1][Z]=be-.1873*ze-.4682*Je,V[2][Z]=be+1.8556*ze}}function ee(V,Z,be){for(var ze=0;ze<64;++ze)Z[be+ze]=_m.toHalfFloat(X(V[ze]))}function X(V){return V<=1?Math.sign(V)*Math.pow(Math.abs(V),2.2):Math.sign(V)*Math.pow(B,Math.abs(V)-1)}function we(V){return new DataView(V.array.buffer,V.offset.value,V.size)}function Fe(V){var Z=V.viewer.buffer.slice(V.offset.value,V.offset.value+V.size),be=new Uint8Array(At(Z)),ze=new Uint8Array(be.length);return Ot(be),te(be,ze),new DataView(ze.buffer)}function ut(V){var Z=V.array.slice(V.offset.value,V.offset.value+V.size),be=ZS(Z),ze=new Uint8Array(be.length);return Ot(be),te(be,ze),new DataView(ze.buffer)}function We(V){for(var Z=V.viewer,be={value:V.offset.value},ze=new Uint16Array(V.width*V.scanlineBlockSize*(V.channels*V.type)),Je=new Uint8Array(8192),Xe=0,Rt=new Array(V.channels),gt=0;gt<V.channels;gt++)Rt[gt]={},Rt[gt].start=Xe,Rt[gt].end=Rt[gt].start,Rt[gt].nx=V.width,Rt[gt].ny=V.lines,Rt[gt].size=V.type,Xe+=Rt[gt].nx*Rt[gt].ny*Rt[gt].size;var Y=Ge(Z,be),oe=Ge(Z,be);if(oe>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(Y<=oe)for(var gt=0;gt<oe-Y+1;gt++)Je[gt+Y]=ve(Z,be);var me=new Uint16Array(65536),de=L(Je,me),Ae=Dt(Z,be);cn(V.array,Z,be,Ae,ze,Xe);for(var gt=0;gt<V.channels;++gt)for(var Ne=Rt[gt],qe=0;qe<Rt[gt].size;++qe)Mt(ze,Ne.start+qe,Ne.nx,Ne.size,Ne.ny,Ne.nx*Ne.size,de);tn(me,ze,Xe);for(var ft=0,dt=new Uint8Array(ze.buffer.byteLength),Ft=0;Ft<V.lines;Ft++)for(var kt=0;kt<V.channels;kt++){var Ne=Rt[kt],Ht=Ne.nx*Ne.size,ln=new Uint8Array(ze.buffer,Ne.end*2,Ht*2);dt.set(ln,ft),ft+=Ht*2,Ne.end+=Ht}return new DataView(dt.buffer)}function ot(V){var Z=V.array.slice(V.offset.value,V.offset.value+V.size),be=ZS(Z);const ze=V.lines*V.channels*V.width,Je=V.type==1?new Uint16Array(ze):new Uint32Array(ze);let Xe=0,Rt=0;const gt=new Array(4);for(let Y=0;Y<V.lines;Y++)for(let oe=0;oe<V.channels;oe++){let me=0;switch(V.type){case 1:gt[0]=Xe,gt[1]=gt[0]+V.width,Xe=gt[1]+V.width;for(let de=0;de<V.width;++de){const Ae=be[gt[0]++]<<8|be[gt[1]++];me+=Ae,Je[Rt]=me,Rt++}break;case 2:gt[0]=Xe,gt[1]=gt[0]+V.width,gt[2]=gt[1]+V.width,Xe=gt[2]+V.width;for(let de=0;de<V.width;++de){const Ae=be[gt[0]++]<<24|be[gt[1]++]<<16|be[gt[2]++]<<8;me+=Ae,Je[Rt]=me,Rt++}break}}return new DataView(Je.buffer)}function et(V){var Z=V.viewer,be={value:V.offset.value},ze=new Uint8Array(V.width*V.lines*(V.channels*V.type*2)),Je={version:He(Z,be),unknownUncompressedSize:He(Z,be),unknownCompressedSize:He(Z,be),acCompressedSize:He(Z,be),dcCompressedSize:He(Z,be),rleCompressedSize:He(Z,be),rleUncompressedSize:He(Z,be),rleRawSize:He(Z,be),totalAcUncompressedCount:He(Z,be),totalDcUncompressedCount:He(Z,be),acCompression:He(Z,be)};if(Je.version<2)throw"EXRLoader.parse: "+xr.compression+" version "+Je.version+" is unsupported";for(var Xe=new Array,Rt=Ge(Z,be)-2;Rt>0;){var gt=pt(Z.buffer,be),Y=ve(Z,be),oe=Y>>2&3,me=(Y>>4)-1,de=new Int8Array([me])[0],Ae=ve(Z,be);Xe.push({name:gt,index:de,type:Ae,compression:oe}),Rt-=gt.length+3}for(var Ne=xr.channels,qe=new Array(V.channels),ft=0;ft<V.channels;++ft){var dt=qe[ft]={},Ft=Ne[ft];dt.name=Ft.name,dt.compression=0,dt.decoded=!1,dt.type=Ft.pixelType,dt.pLinear=Ft.pLinear,dt.width=V.width,dt.height=V.lines}for(var kt={idx:new Array(3)},Ht=0;Ht<V.channels;++Ht)for(var dt=qe[Ht],ft=0;ft<Xe.length;++ft){var ln=Xe[ft];dt.name==ln.name&&(dt.compression=ln.compression,ln.index>=0&&(kt.idx[ln.index]=Ht),dt.offset=Ht)}if(Je.acCompressedSize>0)switch(Je.acCompression){case 0:var Jt=new Uint16Array(Je.totalAcUncompressedCount);cn(V.array,Z,be,Je.acCompressedSize,Jt,Je.totalAcUncompressedCount);break;case 1:var jt=V.array.slice(be.value,be.value+Je.totalAcUncompressedCount),Kn=ZS(jt),Jt=new Uint16Array(Kn.buffer);be.value+=Je.totalAcUncompressedCount;break}if(Je.dcCompressedSize>0){var Yt={array:V.array,offset:be,size:Je.dcCompressedSize},Kt=new Uint16Array(ut(Yt).buffer);be.value+=Je.dcCompressedSize}if(Je.rleRawSize>0){var jt=V.array.slice(be.value,be.value+Je.rleCompressedSize),Kn=ZS(jt),Ki=At(Kn.buffer);be.value+=Je.rleCompressedSize}for(var pn=0,Sn=new Array(qe.length),ft=0;ft<Sn.length;++ft)Sn[ft]=new Array;for(var Ai=0;Ai<V.lines;++Ai)for(var In=0;In<qe.length;++In)Sn[In].push(pn),pn+=qe[In].width*V.type*2;Ve(kt,Sn,qe,Jt,Kt,ze);for(var ft=0;ft<qe.length;++ft){var dt=qe[ft];if(!dt.decoded)switch(dt.compression){case 2:for(var mn=0,wn=0,Ai=0;Ai<V.lines;++Ai){for(var ns=Sn[ft][mn],yi=0;yi<dt.width;++yi){for(var vi=0;vi<2*dt.type;++vi)ze[ns++]=Ki[wn+vi*dt.width*dt.height];wn++}mn++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(ze.buffer)}function pt(V,Z){for(var be=new Uint8Array(V),ze=0;be[Z.value+ze]!=0;)ze+=1;var Je=new TextDecoder().decode(be.slice(Z.value,Z.value+ze));return Z.value=Z.value+ze+1,Je}function vt(V,Z,be){var ze=new TextDecoder().decode(new Uint8Array(V).slice(Z.value,Z.value+be));return Z.value=Z.value+be,ze}function it(V,Z){var be=Et(V,Z),ze=Dt(V,Z);return[be,ze]}function Ct(V,Z){var be=Dt(V,Z),ze=Dt(V,Z);return[be,ze]}function Et(V,Z){var be=V.getInt32(Z.value,!0);return Z.value=Z.value+4,be}function Dt(V,Z){var be=V.getUint32(Z.value,!0);return Z.value=Z.value+4,be}function Nt(V,Z){var be=V[Z.value];return Z.value=Z.value+1,be}function ve(V,Z){var be=V.getUint8(Z.value);return Z.value=Z.value+1,be}const He=function(V,Z){let be;return"getBigInt64"in DataView.prototype?be=Number(V.getBigInt64(Z.value,!0)):be=V.getUint32(Z.value+4,!0)+Number(V.getUint32(Z.value,!0)<<32),Z.value+=8,be};function St(V,Z){var be=V.getFloat32(Z.value,!0);return Z.value+=4,be}function xe(V,Z){return _m.toHalfFloat(St(V,Z))}function Oe(V){var Z=(V&31744)>>10,be=V&1023;return(V>>15?-1:1)*(Z?Z===31?be?NaN:1/0:Math.pow(2,Z-15)*(1+be/1024):6103515625e-14*(be/1024))}function Ge(V,Z){var be=V.getUint16(Z.value,!0);return Z.value+=2,be}function rt(V,Z){return Oe(Ge(V,Z))}function It(V,Z,be,ze){for(var Je=be.value,Xe=[];be.value<Je+ze-1;){var Rt=pt(Z,be),gt=Et(V,be),Y=ve(V,be);be.value+=3;var oe=Et(V,be),me=Et(V,be);Xe.push({name:Rt,pixelType:gt,pLinear:Y,xSampling:oe,ySampling:me})}return be.value+=1,Xe}function Bt(V,Z){var be=St(V,Z),ze=St(V,Z),Je=St(V,Z),Xe=St(V,Z),Rt=St(V,Z),gt=St(V,Z),Y=St(V,Z),oe=St(V,Z);return{redX:be,redY:ze,greenX:Je,greenY:Xe,blueX:Rt,blueY:gt,whiteX:Y,whiteY:oe}}function $t(V,Z){var be=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],ze=ve(V,Z);return be[ze]}function Pn(V,Z){var be=Dt(V,Z),ze=Dt(V,Z),Je=Dt(V,Z),Xe=Dt(V,Z);return{xMin:be,yMin:ze,xMax:Je,yMax:Xe}}function gi(V,Z){var be=["INCREASING_Y"],ze=ve(V,Z);return be[ze]}function _n(V,Z){var be=St(V,Z),ze=St(V,Z);return[be,ze]}function ts(V,Z){var be=St(V,Z),ze=St(V,Z),Je=St(V,Z);return[be,ze,Je]}function cs(V,Z,be,ze,Je){if(ze==="string"||ze==="stringvector"||ze==="iccProfile")return vt(Z,be,Je);if(ze==="chlist")return It(V,Z,be,Je);if(ze==="chromaticities")return Bt(V,be);if(ze==="compression")return $t(V,be);if(ze==="box2i")return Pn(V,be);if(ze==="lineOrder")return gi(V,be);if(ze==="float")return St(V,be);if(ze==="v2f")return _n(V,be);if(ze==="v3f")return ts(V,be);if(ze==="int")return Et(V,be);if(ze==="rational")return it(V,be);if(ze==="timecode")return Ct(V,be);if(ze==="preview")return be.value+=Je,"skipped";be.value+=Je}function xh(V,Z,be){const ze={};if(V.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";ze.version=V.getUint8(4);const Je=V.getUint8(5);ze.spec={singleTile:!!(Je&2),longName:!!(Je&4),deepFormat:!!(Je&8),multiPart:!!(Je&16)},be.value=8;for(var Xe=!0;Xe;){var Rt=pt(Z,be);if(Rt==0)Xe=!1;else{var gt=pt(Z,be),Y=Dt(V,be),oe=cs(V,Z,be,gt,Y);oe===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${gt}'.`):ze[Rt]=oe}}if((Je&-5)!=0)throw console.error("EXRHeader:",ze),"THREE.EXRLoader: provided file is currently unsupported.";return ze}function Vl(V,Z,be,ze,Je){const Xe={size:0,viewer:Z,array:be,offset:ze,width:V.dataWindow.xMax-V.dataWindow.xMin+1,height:V.dataWindow.yMax-V.dataWindow.yMin+1,channels:V.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:V.channels[0].pixelType,uncompress:null,getter:null,format:null,[Nb?"colorSpace":"encoding"]:null};switch(V.compression){case"NO_COMPRESSION":Xe.lines=1,Xe.uncompress=we;break;case"RLE_COMPRESSION":Xe.lines=1,Xe.uncompress=Fe;break;case"ZIPS_COMPRESSION":Xe.lines=1,Xe.uncompress=ut;break;case"ZIP_COMPRESSION":Xe.lines=16,Xe.uncompress=ut;break;case"PIZ_COMPRESSION":Xe.lines=32,Xe.uncompress=We;break;case"PXR24_COMPRESSION":Xe.lines=16,Xe.uncompress=ot;break;case"DWAA_COMPRESSION":Xe.lines=32,Xe.uncompress=et;break;case"DWAB_COMPRESSION":Xe.lines=256,Xe.uncompress=et;break;default:throw"EXRLoader.parse: "+V.compression+" is unsupported"}if(Xe.scanlineBlockSize=Xe.lines,Xe.type==1)switch(Je){case ps:Xe.getter=rt,Xe.inputSize=2;break;case yr:Xe.getter=Ge,Xe.inputSize=2;break}else if(Xe.type==2)switch(Je){case ps:Xe.getter=St,Xe.inputSize=4;break;case yr:Xe.getter=xe,Xe.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+Xe.type+" for "+V.compression+".";Xe.blockCount=(V.dataWindow.yMax+1)/Xe.scanlineBlockSize;for(var Rt=0;Rt<Xe.blockCount;Rt++)He(Z,ze);Xe.outputChannels=Xe.channels==3?4:Xe.channels;const gt=Xe.width*Xe.height*Xe.outputChannels;switch(Je){case ps:Xe.byteArray=new Float32Array(gt),Xe.channels<Xe.outputChannels&&Xe.byteArray.fill(1,0,gt);break;case yr:Xe.byteArray=new Uint16Array(gt),Xe.channels<Xe.outputChannels&&Xe.byteArray.fill(15360,0,gt);break;default:console.error("THREE.EXRLoader: unsupported type: ",Je);break}return Xe.bytesPerLine=Xe.width*Xe.inputSize*Xe.channels,Xe.outputChannels==4?Xe.format=rr:Xe.format=FE,Nb?Xe.colorSpace="srgb-linear":Xe.encoding=3e3,Xe}const vr=new DataView(e),Wr=new Uint8Array(e),to={value:0},xr=xh(vr,e,to),sn=Vl(xr,vr,Wr,to,this.type),$i={value:0},Ln={R:0,G:1,B:2,A:3,Y:0};for(let V=0;V<sn.height/sn.scanlineBlockSize;V++){const Z=Dt(vr,to);sn.size=Dt(vr,to),sn.lines=Z+sn.scanlineBlockSize>sn.height?sn.height-Z:sn.scanlineBlockSize;const ze=sn.size<sn.lines*sn.bytesPerLine?sn.uncompress(sn):we(sn);to.value+=sn.size;for(let Je=0;Je<sn.scanlineBlockSize;Je++){const Xe=Je+V*sn.scanlineBlockSize;if(Xe>=sn.height)break;for(let Rt=0;Rt<sn.channels;Rt++){const gt=Ln[xr.channels[Rt].name];for(let Y=0;Y<sn.width;Y++){$i.value=(Je*(sn.channels*sn.width)+Rt*sn.width+Y)*sn.inputSize;const oe=(sn.height-1-Xe)*(sn.width*sn.outputChannels)+Y*sn.outputChannels+gt;sn.byteArray[oe]=sn.getter(ze,$i)}}}}return{header:xr,width:sn.width,height:sn.height,data:sn.byteArray,format:sn.format,[Nb?"colorSpace":"encoding"]:sn[Nb?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,s){function r(a,o){Nb?a.colorSpace=o.colorSpace:a.encoding=o.encoding,a.minFilter=ei,a.magFilter=ei,a.generateMipmaps=!1,a.flipY=!1,t&&t(a,o)}return super.load(e,r,n,s)}}const _D=new WeakMap;class B0e extends ha{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,s){const r=new ua(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,a=>{const o={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(a,o).then(t).catch(s)},n,s)}decodeDracoFile(e,t,n,s){const r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){for(const l in t.attributeTypes){const c=t.attributeTypes[l];c.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[l]=c.name)}const n=JSON.stringify(t);if(_D.has(e)){const l=_D.get(e);if(l.key===n)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s;const r=this.workerNextTaskID++,a=e.byteLength,o=this._getWorker(r,a).then(l=>(s=l,new Promise((c,h)=>{s._callbacks[r]={resolve:c,reject:h},s.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return o.catch(()=>!0).then(()=>{s&&r&&this._releaseTask(s,r)}),_D.set(e,{key:n,promise:o}),o}_createGeometry(e){const t=new Tn;e.index&&t.setIndex(new ci(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const s=e.attributes[n],r=s.name,a=s.array,o=s.itemSize;t.setAttribute(r,new ci(a,o))}return t}_loadLibrary(e,t){const n=new ua(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((s,r)=>{n.load(e,s,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const s=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const r=O0e.toString(),a=["/* draco decoder */",s,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const s=new Worker(this.workerSourceURL);s._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(r){const a=r.data;switch(a.type){case"decode":s._callbacks[a.id].resolve(a);break;case"error":s._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(s)}else this.workerPool.sort(function(s,r){return s._taskLoad>r._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function O0e(){let i,e;onmessage=function(a){const o=a.data;switch(o.type){case"init":i=o.decoderConfig,e=new Promise(function(h){i.onModuleLoaded=function(d){h({draco:d})},DracoDecoderModule(i)});break;case"decode":const l=o.buffer,c=o.taskConfig;e.then(h=>{const d=h.draco,m=new d.Decoder,y=new d.DecoderBuffer;y.Init(new Int8Array(l),l.byteLength);try{const x=t(d,m,y,c),_=x.attributes.map(b=>b.array.buffer);x.index&&_.push(x.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:x},_)}catch(x){console.error(x),self.postMessage({type:"error",id:o.id,error:x.message})}finally{d.destroy(y),d.destroy(m)}});break}};function t(a,o,l,c){const h=c.attributeIDs,d=c.attributeTypes;let m,y;const x=o.GetEncodedGeometryType(l);if(x===a.TRIANGULAR_MESH)m=new a.Mesh,y=o.DecodeBufferToMesh(l,m);else if(x===a.POINT_CLOUD)m=new a.PointCloud,y=o.DecodeBufferToPointCloud(l,m);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!y.ok()||m.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+y.error_msg());const _={index:null,attributes:[]};for(const b in h){const A=self[d[b]];let T,w;if(c.useUniqueIDs)w=h[b],T=o.GetAttributeByUniqueId(m,w);else{if(w=o.GetAttributeId(m,a[h[b]]),w===-1)continue;T=o.GetAttribute(m,w)}_.attributes.push(s(a,o,m,b,A,T))}return x===a.TRIANGULAR_MESH&&(_.index=n(a,o,m)),a.destroy(m),_}function n(a,o,l){const h=l.num_faces()*3,d=h*4,m=a._malloc(d);o.GetTrianglesUInt32Array(l,d,m);const y=new Uint32Array(a.HEAPF32.buffer,m,h).slice();return a._free(m),{array:y,itemSize:1}}function s(a,o,l,c,h,d){const m=d.num_components(),x=l.num_points()*m,_=x*h.BYTES_PER_ELEMENT,b=r(a,h),A=a._malloc(_);o.GetAttributeDataArrayForAllPoints(l,d,b,_,A);const T=new h(a.HEAPF32.buffer,A,x).slice();return a._free(A),{name:c,array:T,itemSize:m}}function r(a,o){switch(o){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}let tT;const SD=()=>{if(tT)return tT;const i="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),n=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let s=i;WebAssembly.validate(t)&&(s=e);let r;const a=WebAssembly.instantiate(o(s),{}).then(d=>{r=d.instance,r.exports.__wasm_call_ctors()});function o(d){const m=new Uint8Array(d.length);for(let x=0;x<d.length;++x){const _=d.charCodeAt(x);m[x]=_>96?_-71:_>64?_-65:_>47?_+4:_>46?63:62}let y=0;for(let x=0;x<d.length;++x)m[y++]=m[x]<60?n[m[x]]:(m[x]-60)*64+m[++x];return m.buffer.slice(0,y)}function l(d,m,y,x,_,b){const A=r.exports.sbrk,T=y+3&-4,w=A(T*x),R=A(_.length),O=new Uint8Array(r.exports.memory.buffer);O.set(_,R);const N=d(w,y,x,R,_.length);if(N===0&&b&&b(w,T,x),m.set(O.subarray(w,w+y*x)),A(w-A(0)),N!==0)throw new Error(`Malformed buffer data: ${N}`)}const c={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},h={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return tT={ready:a,supported:!0,decodeVertexBuffer(d,m,y,x,_){l(r.exports.meshopt_decodeVertexBuffer,d,m,y,x,r.exports[c[_]])},decodeIndexBuffer(d,m,y,x){l(r.exports.meshopt_decodeIndexBuffer,d,m,y,x)},decodeIndexSequence(d,m,y,x){l(r.exports.meshopt_decodeIndexSequence,d,m,y,x)},decodeGltfBuffer(d,m,y,x,_,b){l(r.exports[h[_]],d,m,y,x,r.exports[c[b]])}},tT};let nT=null,KV="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function WV(i=!0,e=!0,t){return n=>{t&&t(n),i&&(nT||(nT=new B0e),nT.setDecoderPath(typeof i=="string"?i:KV),n.setDRACOLoader(nT)),e&&n.setMeshoptDecoder(typeof SD=="function"?SD():SD)}}const ZE=(i,e,t,n)=>Kf(RO,i,WV(e,t,n));ZE.preload=(i,e,t,n)=>Kf.preload(RO,i,WV(e,t,n));ZE.clear=i=>Kf.clear(RO,i);ZE.setDecoderPath=i=>{KV=i};function P0e(i,e,t){const n=gr(m=>m.size),s=gr(m=>m.viewport),r=typeof i=="number"?i:n.width*s.dpr,a=n.height*s.dpr,o=(typeof i=="number"?t:i)||{},{samples:l=0,depth:c,...h}=o,d=ce.useMemo(()=>{const m=new Os(r,a,{minFilter:ei,magFilter:ei,type:yr,...h});return c&&(m.depthTexture=new jv(r,a,ps)),m.samples=l,m},[]);return ce.useLayoutEffect(()=>{d.setSize(r,a),l&&(d.samples=l)},[l,d,r,a]),ce.useEffect(()=>()=>d.dispose(),[]),d}const N0e=i=>typeof i=="function",U0e=ce.forwardRef(({envMap:i,resolution:e=256,frames:t=1/0,makeDefault:n,children:s,...r},a)=>{const o=gr(({set:b})=>b),l=gr(({camera:b})=>b),c=gr(({size:b})=>b),h=ce.useRef(null);ce.useImperativeHandle(a,()=>h.current,[]);const d=ce.useRef(null),m=P0e(e);ce.useLayoutEffect(()=>{r.manual||(h.current.aspect=c.width/c.height)},[c,r]),ce.useLayoutEffect(()=>{h.current.updateProjectionMatrix()});let y=0,x=null;const _=N0e(s);return Zv(b=>{_&&(t===1/0||y<t)&&(d.current.visible=!1,b.gl.setRenderTarget(m),x=b.scene.background,i&&(b.scene.background=i),b.gl.render(b.scene,h.current),b.scene.background=x,b.gl.setRenderTarget(null),d.current.visible=!0,y++)}),ce.useLayoutEffect(()=>{if(n){const b=l;return o(()=>({camera:h.current})),()=>o(()=>({camera:b}))}},[h,n,o]),ce.createElement(ce.Fragment,null,ce.createElement("perspectiveCamera",aE({ref:h},r),!_&&s),ce.createElement("group",{ref:d},_&&s(m.texture)))}),k0e=ce.forwardRef(({makeDefault:i,camera:e,regress:t,domElement:n,enableDamping:s=!0,keyEvents:r=!1,onChange:a,onStart:o,onEnd:l,...c},h)=>{const d=gr(N=>N.invalidate),m=gr(N=>N.camera),y=gr(N=>N.gl),x=gr(N=>N.events),_=gr(N=>N.setEvents),b=gr(N=>N.set),A=gr(N=>N.get),T=gr(N=>N.performance),w=e||m,R=n||x.connected||y.domElement,O=ce.useMemo(()=>new qde(w),[w]);return Zv(()=>{O.enabled&&O.update()},-1),ce.useEffect(()=>(r&&O.connect(r===!0?R:r),O.connect(R),()=>void O.dispose()),[r,R,t,O,d]),ce.useEffect(()=>{const N=B=>{d(),t&&T.regress(),a&&a(B)},U=B=>{o&&o(B)},P=B=>{l&&l(B)};return O.addEventListener("change",N),O.addEventListener("start",U),O.addEventListener("end",P),()=>{O.removeEventListener("start",U),O.removeEventListener("end",P),O.removeEventListener("change",N)}},[a,o,l,O,d,_]),ce.useEffect(()=>{if(i){const N=A().controls;return b({controls:O}),()=>b({controls:N})}},[i,O]),ce.createElement("primitive",aE({ref:h,object:O,enableDamping:s},c))}),XV=(i,e,t)=>{let n;switch(i){case Xs:n=new Uint8ClampedArray(e*t*4);break;case yr:n=new Uint16Array(e*t*4);break;case Qc:n=new Uint32Array(e*t*4);break;case eM:n=new Int8Array(e*t*4);break;case tM:n=new Int16Array(e*t*4);break;case kE:n=new Int32Array(e*t*4);break;case ps:n=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return n};let iT;const F0e=(i,e,t,n)=>{if(iT!==void 0)return iT;const s=new Os(1,1,n);e.setRenderTarget(s);const r=new ms(new W0,new Co({color:16777215}));e.render(r,t),e.setRenderTarget(null);const a=XV(i,s.width,s.height);return e.readRenderTargetPixels(s,0,0,s.width,s.height,a),s.dispose(),r.geometry.dispose(),r.material.dispose(),iT=a[0]!==0,iT};class DO{constructor(e){var t,n,s,r,a,o,l,c,h,d,m,y,x,_,b,A;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(w){throw this._renderer.setRenderTarget(null),w}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const T={format:rr,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((t=e.renderTargetOptions)===null||t===void 0?void 0:t.anisotropy)!==void 0?(n=e.renderTargetOptions)===null||n===void 0?void 0:n.anisotropy:1,generateMipmaps:((s=e.renderTargetOptions)===null||s===void 0?void 0:s.generateMipmaps)!==void 0?(r=e.renderTargetOptions)===null||r===void 0?void 0:r.generateMipmaps:!1,magFilter:((a=e.renderTargetOptions)===null||a===void 0?void 0:a.magFilter)!==void 0?(o=e.renderTargetOptions)===null||o===void 0?void 0:o.magFilter:ei,minFilter:((l=e.renderTargetOptions)===null||l===void 0?void 0:l.minFilter)!==void 0?(c=e.renderTargetOptions)===null||c===void 0?void 0:c.minFilter:ei,samples:((h=e.renderTargetOptions)===null||h===void 0?void 0:h.samples)!==void 0?(d=e.renderTargetOptions)===null||d===void 0?void 0:d.samples:void 0,wrapS:((m=e.renderTargetOptions)===null||m===void 0?void 0:m.wrapS)!==void 0?(y=e.renderTargetOptions)===null||y===void 0?void 0:y.wrapS:sr,wrapT:((x=e.renderTargetOptions)===null||x===void 0?void 0:x.wrapT)!==void 0?(_=e.renderTargetOptions)===null||_===void 0?void 0:_.wrapT:sr};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=DO.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new dg,this._camera=new fh,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!F0e(this._type,this._renderer,this._camera,T)){let w;switch(this._type){case yr:w=this._renderer.extensions.has("EXT_color_buffer_float")?ps:void 0;break}w!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${ps}`),this._type=w):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new ms(new W0,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new Os(this.width,this.height,T),this._renderTarget.texture.mapping=((b=e.renderTargetOptions)===null||b===void 0?void 0:b.mapping)!==void 0?(A=e.renderTargetOptions)===null||A===void 0?void 0:A.mapping:P0}static instantiateRenderer(){const e=new bO;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=XV(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new Yc(this.toArray(),this.width,this.height,rr,this._type,(e==null?void 0:e.mapping)||P0,(e==null?void 0:e.wrapS)||sr,(e==null?void 0:e.wrapT)||sr,(e==null?void 0:e.magFilter)||ei,(e==null?void 0:e.minFilter)||ei,(e==null?void 0:e.anisotropy)||1,nl);return t.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof js&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof wi&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof wi&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const H0e=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,G0e=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class z0e extends js{constructor({gamma:e,offsetHdr:t,offsetSdr:n,gainMapMin:s,gainMapMax:r,maxDisplayBoost:a,hdrCapacityMin:o,hdrCapacityMax:l,sdr:c,gainMap:h}){super({name:"GainMapDecoderMaterial",vertexShader:H0e,fragmentShader:G0e,uniforms:{sdr:{value:c},gainMap:{value:h},gamma:{value:new se(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new se().fromArray(t)},offsetSdr:{value:new se().fromArray(n)},gainMapMin:{value:new se().fromArray(s)},gainMapMax:{value:new se().fromArray(r)},weightFactor:{value:(Math.log2(a)-o)/(l-o)}},blending:la,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=a,this._hdrCapacityMin=o,this._hdrCapacityMax=l,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class jV extends Error{}class qV extends Error{}const Ub=(i,e,t)=>{const n=new RegExp(`${e}="([^"]*)"`,"i").exec(i);if(n)return n[1];const s=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(i);if(s){const r=s[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return r&&r.length===3?r.map(a=>a.replace(/<\/?rdf:li>/g,"")):s[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},V0e=i=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(i):e=i.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const n=e.indexOf("x:xmpmeta>",t),s=e.slice(t,n+10);try{const r=Ub(s,"hdrgm:GainMapMin","0"),a=Ub(s,"hdrgm:GainMapMax"),o=Ub(s,"hdrgm:Gamma","1"),l=Ub(s,"hdrgm:OffsetSDR","0.015625"),c=Ub(s,"hdrgm:OffsetHDR","0.015625"),h=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(s),d=h?h[1]:"0",m=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(s);if(!m)throw new Error("Incomplete gainmap metadata");const y=m[1];return{gainMapMin:Array.isArray(r)?r.map(x=>parseFloat(x)):[parseFloat(r),parseFloat(r),parseFloat(r)],gainMapMax:Array.isArray(a)?a.map(x=>parseFloat(x)):[parseFloat(a),parseFloat(a),parseFloat(a)],gamma:Array.isArray(o)?o.map(x=>parseFloat(x)):[parseFloat(o),parseFloat(o),parseFloat(o)],offsetSdr:Array.isArray(l)?l.map(x=>parseFloat(x)):[parseFloat(l),parseFloat(l),parseFloat(l)],offsetHdr:Array.isArray(c)?c.map(x=>parseFloat(x)):[parseFloat(c),parseFloat(c),parseFloat(c)],hdrCapacityMin:parseFloat(d),hdrCapacityMax:parseFloat(y)}}catch{}t=e.indexOf("<x:xmpmeta",n)}};class Y0e{constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,n)=>{const s=this.options.debug,r=new DataView(e.buffer);if(r.getUint16(0)!==65496){n(new Error("Not a valid jpeg"));return}const a=r.byteLength;let o=2,l=0,c;for(;o<a;){if(++l>250){n(new Error(`Found no marker after ${l} loops 😵`));return}if(r.getUint8(o)!==255){n(new Error(`Not a valid marker at offset 0x${o.toString(16)}, found: 0x${r.getUint8(o).toString(16)}`));return}if(c=r.getUint8(o+1),s&&console.log(`Marker: ${c.toString(16)}`),c===226){s&&console.log("Found APP2 marker (0xffe2)");const h=o+4;if(r.getUint32(h)===1297106432){const d=h+4;let m;if(r.getUint16(d)===18761)m=!1;else if(r.getUint16(d)===19789)m=!0;else{n(new Error("No valid endianness marker found in TIFF header"));return}if(r.getUint16(d+2,!m)!==42){n(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const y=r.getUint32(d+4,!m);if(y<8){n(new Error("Not valid TIFF data! (First offset less than 8)"));return}const x=d+y,_=r.getUint16(x,!m),b=x+2;let A=0;for(let O=b;O<b+12*_;O+=12)r.getUint16(O,!m)===45057&&(A=r.getUint32(O+8,!m));const w=x+2+_*12+4,R=[];for(let O=w;O<w+A*16;O+=16){const N={MPType:r.getUint32(O,!m),size:r.getUint32(O+4,!m),dataOffset:r.getUint32(O+8,!m),dependantImages:r.getUint32(O+12,!m),start:-1,end:-1,isFII:!1};N.dataOffset?(N.start=d+N.dataOffset,N.isFII=!1):(N.start=0,N.isFII=!0),N.end=N.start+N.size,R.push(N)}if(this.options.extractNonFII&&R.length){const O=new Blob([r]),N=[];for(const U of R){if(U.isFII&&!this.options.extractFII)continue;const P=O.slice(U.start,U.end+1,"image/jpeg");N.push(P)}t(N)}}}o+=2+r.getUint16(o+2)}})}}const K0e=async i=>{const e=V0e(i);if(!e)throw new qV("Gain map XMP metadata not found");const n=await new Y0e({extractFII:!0,extractNonFII:!0}).extract(i);if(n.length!==2)throw new jV("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:e}},q4=i=>new Promise((e,t)=>{const n=document.createElement("img");n.onload=()=>{e(n)},n.onerror=s=>{t(s)},n.src=URL.createObjectURL(i)});class QV extends ha{constructor(e,t){super(t),e&&(this._renderer=e),this._internalLoadingManager=new MM}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=new z0e({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new wi,sdr:new wi});return new DO({width:16,height:16,type:yr,colorSpace:nl,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,t,n,s){const r=s?new Blob([s],{type:"image/jpeg"}):void 0,a=new Blob([n],{type:"image/jpeg"});let o,l,c=!1;if(typeof createImageBitmap>"u"){const m=await Promise.all([r?q4(r):Promise.resolve(void 0),q4(a)]);l=m[0],o=m[1],c=!0}else{const m=await Promise.all([r?createImageBitmap(r,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(a,{imageOrientation:"flipY"})]);l=m[0],o=m[1]}const h=new wi(l||new ImageData(2,2),P0,sr,sr,ei,jL,rr,Xs,1,nl);h.flipY=c,h.needsUpdate=!0;const d=new wi(o,P0,sr,sr,ei,jL,rr,Xs,1,bi);d.flipY=c,d.needsUpdate=!0,e.width=o.width,e.height=o.height,e.material.gainMap=h,e.material.sdr=d,e.material.gainMapMin=t.gainMapMin,e.material.gainMapMax=t.gainMapMax,e.material.offsetHdr=t.offsetHdr,e.material.offsetSdr=t.offsetSdr,e.material.gamma=t.gamma,e.material.hdrCapacityMin=t.hdrCapacityMin,e.material.hdrCapacityMax=t.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,t.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class W0e extends QV{load([e,t,n],s,r,a){const o=this.prepareQuadRenderer();let l,c,h;const d=async()=>{if(l&&c&&h){try{await this.render(o,h,l,c)}catch(B){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),typeof a=="function"&&a(B),o.disposeOnDemandRenderer();return}typeof s=="function"&&s(o),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),o.disposeOnDemandRenderer()}};let m=!0,y=0,x=0,_=!0,b=0,A=0,T=!0,w=0,R=0;const O=()=>{if(typeof r=="function"){const B=y+b+w,L=x+A+R,F=m&&_&&T;r(new ProgressEvent("progress",{lengthComputable:F,loaded:L,total:B}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const N=new ua(this._internalLoadingManager);N.setResponseType("arraybuffer"),N.setRequestHeader(this.requestHeader),N.setPath(this.path),N.setWithCredentials(this.withCredentials),N.load(e,async B=>{if(typeof B=="string")throw new Error("Invalid sdr buffer");l=B,await d()},B=>{m=B.lengthComputable,x=B.loaded,y=B.total,O()},B=>{this.manager.itemError(e),typeof a=="function"&&a(B)});const U=new ua(this._internalLoadingManager);U.setResponseType("arraybuffer"),U.setRequestHeader(this.requestHeader),U.setPath(this.path),U.setWithCredentials(this.withCredentials),U.load(t,async B=>{if(typeof B=="string")throw new Error("Invalid gainmap buffer");c=B,await d()},B=>{_=B.lengthComputable,A=B.loaded,b=B.total,O()},B=>{this.manager.itemError(t),typeof a=="function"&&a(B)});const P=new ua(this._internalLoadingManager);return P.setRequestHeader(this.requestHeader),P.setPath(this.path),P.setWithCredentials(this.withCredentials),P.load(n,async B=>{if(typeof B!="string")throw new Error("Invalid metadata string");h=JSON.parse(B),await d()},B=>{T=B.lengthComputable,R=B.loaded,w=B.total,O()},B=>{this.manager.itemError(n),typeof a=="function"&&a(B)}),o}}class X0e extends QV{load(e,t,n,s){const r=this.prepareQuadRenderer(),a=new ua(this._internalLoadingManager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(this.withCredentials),this.manager.itemStart(e),a.load(e,async o=>{if(typeof o=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const l=new Uint8Array(o);let c,h,d;try{const m=await K0e(l);c=m.sdr,h=m.gainMap,d=m.metadata}catch(m){if(m instanceof qV||m instanceof jV)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),d={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},c=l;else throw m}try{await this.render(r,d,c,h)}catch(m){this.manager.itemError(e),typeof s=="function"&&s(m),r.disposeOnDemandRenderer();return}typeof t=="function"&&t(r),this.manager.itemEnd(e),r.disposeOnDemandRenderer()},n,o=>{this.manager.itemError(e),typeof s=="function"&&s(o)}),r}}const oE={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},$V="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",Cy=i=>Array.isArray(i),LO=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function LM({files:i=LO,path:e="",preset:t=void 0,colorSpace:n=void 0,extensions:s}={}){t&&(IO(t),i=oE[t],e=$V);const r=Cy(i),{extension:a,isCubemap:o}=BO(i),l=OO(a);if(!l)throw new Error("useEnvironment: Unrecognized file extension: "+i);const c=gr(y=>y.gl);ce.useLayoutEffect(()=>{if(a!=="webp"&&a!=="jpg"&&a!=="jpeg")return;function y(){Kf.clear(l,r?[i]:i)}c.domElement.addEventListener("webglcontextlost",y,{once:!0})},[i,c.domElement]);const h=Kf(l,r?[i]:i,y=>{(a==="webp"||a==="jpg"||a==="jpeg")&&y.setRenderer(c),y.setPath==null||y.setPath(e),s&&s(y)});let d=r?h[0]:h;if(a==="jpg"||a==="jpeg"||a==="webp"){var m;d=(m=d.renderTarget)==null?void 0:m.texture}return d.mapping=o?gh:Mv,d.colorSpace=n??(o?"srgb":"srgb-linear"),d}const j0e={files:LO,path:"",preset:void 0,extensions:void 0};LM.preload=i=>{const e={...j0e,...i};let{files:t,path:n=""}=e;const{preset:s,extensions:r}=e;s&&(IO(s),t=oE[s],n=$V);const{extension:a}=BO(t);if(a==="webp"||a==="jpg"||a==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const o=OO(a);if(!o)throw new Error("useEnvironment: Unrecognized file extension: "+t);Kf.preload(o,Cy(t)?[t]:t,l=>{l.setPath==null||l.setPath(n),r&&r(l)})};const q0e={files:LO,preset:void 0};LM.clear=i=>{const e={...q0e,...i};let{files:t}=e;const{preset:n}=e;n&&(IO(n),t=oE[n]);const{extension:s}=BO(t),r=OO(s);if(!r)throw new Error("useEnvironment: Unrecognized file extension: "+t);Kf.clear(r,Cy(t)?[t]:t)};function IO(i){if(!(i in oE))throw new Error("Preset must be one of: "+Object.keys(oE).join(", "))}function BO(i){var e;const t=Cy(i)&&i.length===6,n=Cy(i)&&i.length===3&&i.some(a=>a.endsWith("json")),s=Cy(i)?i[0]:i;return{extension:t?"cube":n?"webp":s.startsWith("data:application/exr")?"exr":s.startsWith("data:application/hdr")?"hdr":s.startsWith("data:image/jpeg")?"jpg":(e=s.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:n}}function OO(i){return i==="cube"?Q9:i==="hdr"?L0e:i==="exr"?I0e:i==="jpg"||i==="jpeg"?X0e:i==="webp"?W0e:null}const Q0e=i=>i.current&&i.current.isScene,$0e=i=>Q0e(i)?i.current:i;function PO(i,e,t,n,s={}){var r,a,o,l;s={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...s};const c=$0e(e||t),h=c.background,d=c.environment,m={backgroundBlurriness:c.backgroundBlurriness,backgroundIntensity:c.backgroundIntensity,backgroundRotation:(r=(a=c.backgroundRotation)==null||a.clone==null?void 0:a.clone())!==null&&r!==void 0?r:[0,0,0],environmentIntensity:c.environmentIntensity,environmentRotation:(o=(l=c.environmentRotation)==null||l.clone==null?void 0:l.clone())!==null&&o!==void 0?o:[0,0,0]};return i!=="only"&&(c.environment=n),i&&(c.background=n),rh(c,s),()=>{i!=="only"&&(c.environment=d),i&&(c.background=h),rh(c,m)}}function NO({scene:i,background:e=!1,map:t,...n}){const s=gr(r=>r.scene);return ce.useLayoutEffect(()=>{if(t)return PO(e,i,s,t,n)}),null}function JV({background:i=!1,scene:e,blur:t,backgroundBlurriness:n,backgroundIntensity:s,backgroundRotation:r,environmentIntensity:a,environmentRotation:o,...l}){const c=LM(l),h=gr(d=>d.scene);return ce.useLayoutEffect(()=>PO(i,e,h,c,{backgroundBlurriness:t??n,backgroundIntensity:s,backgroundRotation:r,environmentIntensity:a,environmentRotation:o})),ce.useEffect(()=>()=>{c.dispose()},[c]),null}function J0e({children:i,near:e=.1,far:t=1e3,resolution:n=256,frames:s=1,map:r,background:a=!1,blur:o,backgroundBlurriness:l,backgroundIntensity:c,backgroundRotation:h,environmentIntensity:d,environmentRotation:m,scene:y,files:x,path:_,preset:b=void 0,extensions:A}){const T=gr(P=>P.gl),w=gr(P=>P.scene),R=ce.useRef(null),[O]=ce.useState(()=>new dg),N=ce.useMemo(()=>{const P=new YB(n);return P.texture.type=yr,P},[n]);ce.useEffect(()=>()=>{N.dispose()},[N]),ce.useLayoutEffect(()=>{if(s===1){const P=T.autoClear;T.autoClear=!0,R.current.update(T,O),T.autoClear=P}return PO(a,y,w,N.texture,{backgroundBlurriness:o??l,backgroundIntensity:c,backgroundRotation:h,environmentIntensity:d,environmentRotation:m})},[i,O,N.texture,y,w,a,s,T]);let U=1;return Zv(()=>{if(s===1/0||U<s){const P=T.autoClear;T.autoClear=!0,R.current.update(T,O),T.autoClear=P,U++}}),ce.createElement(ce.Fragment,null,pde(ce.createElement(ce.Fragment,null,i,ce.createElement("cubeCamera",{ref:R,args:[e,t,N]}),x||b?ce.createElement(JV,{background:!0,files:x,preset:b,path:_,extensions:A}):r?ce.createElement(NO,{background:!0,map:r,extensions:A}):null),O))}function Z0e(i){var e,t,n,s;const r=LM(i),a=i.map||r;ce.useMemo(()=>wO({GroundProjectedEnvImpl:Gde}),[]),ce.useEffect(()=>()=>{r.dispose()},[r]);const o=ce.useMemo(()=>[a],[a]),l=(e=i.ground)==null?void 0:e.height,c=(t=i.ground)==null?void 0:t.radius,h=(n=(s=i.ground)==null?void 0:s.scale)!==null&&n!==void 0?n:1e3;return ce.createElement(ce.Fragment,null,ce.createElement(NO,aE({},i,{map:a})),ce.createElement("groundProjectedEnvImpl",{args:o,scale:h,height:l,radius:c}))}function epe(i){return i.ground?ce.createElement(Z0e,i):i.map?ce.createElement(NO,i):i.children?ce.createElement(J0e,i):ce.createElement(JV,i)}/**
 * postprocessing v6.37.3 build Sun Apr 27 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rüschen
 * @license Zlib
 */var TD=1/1e3,tpe=1e3,npe=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(i){typeof document<"u"&&document.hidden!==void 0&&(i?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=i)}get delta(){return this._delta*TD}get fixedDelta(){return this._fixedDelta*TD}set fixedDelta(i){this._fixedDelta=i*tpe}get elapsed(){return this._elapsed*TD}update(i){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(i!==void 0?i:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(i){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},ipe=(()=>{const i=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),t=new Tn;return t.setAttribute("position",new ci(i,3)),t.setAttribute("uv",new ci(e,2)),t})(),Lo=class mI{static get fullscreenGeometry(){return ipe}constructor(e="Pass",t=new dg,n=new zE){this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new ms(mI.fullscreenGeometry,e),t.frustumCulled=!1,this.scene===null&&(this.scene=new dg),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=V0){}render(e,t,n,s,r){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof Os||t instanceof ur||t instanceof wi||t instanceof mI)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},spe=class extends Lo{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(i,e,t,n,s){const r=i.state.buffers.stencil;r.setLocked(!1),r.setTest(!1)}},rpe=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,ZV="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",e7=class extends js{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new xi(null),opacity:new xi(1)},blending:la,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:rpe,vertexShader:ZV})}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.uniforms.inputBuffer.value=i}getOpacity(i){return this.uniforms.opacity.value}setOpacity(i){this.uniforms.opacity.value=i}},ape=class extends Lo{constructor(i,e=!0){super("CopyPass"),this.fullscreenMaterial=new e7,this.needsSwap=!1,this.renderTarget=i,i===void 0&&(this.renderTarget=new Os(1,1,{minFilter:ei,magFilter:ei,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(i){this.autoResize=i}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(i){this.autoResize=i}render(i,e,t,n,s){this.fullscreenMaterial.inputBuffer=e.texture,i.setRenderTarget(this.renderToScreen?null:this.renderTarget),i.render(this.scene,this.camera)}setSize(i,e){this.autoResize&&this.renderTarget.setSize(i,e)}initialize(i,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==Xs?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":i!==null&&i.outputColorSpace===bi&&(this.renderTarget.texture.colorSpace=bi))}},Q4=new Ut,t7=class extends Lo{constructor(i=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=i,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(i,e,t){this.color=i,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(i){this.overrideClearColor=i}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(i){this.overrideClearAlpha=i}render(i,e,t,n,s){const r=this.overrideClearColor,a=this.overrideClearAlpha,o=i.getClearAlpha(),l=r!==null,c=a>=0;l?(i.getClearColor(Q4),i.setClearColor(r,c?a:o)):c&&i.setClearAlpha(a),i.setRenderTarget(this.renderToScreen?null:e),i.clear(this.color,this.depth,this.stencil),l?i.setClearColor(Q4,o):c&&i.setClearAlpha(o)}},ope=class extends Lo{constructor(i,e){super("MaskPass",i,e),this.needsSwap=!1,this.clearPass=new t7(!1,!1,!0),this.inverse=!1}set mainScene(i){this.scene=i}set mainCamera(i){this.camera=i}get inverted(){return this.inverse}set inverted(i){this.inverse=i}get clear(){return this.clearPass.enabled}set clear(i){this.clearPass.enabled=i}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(i){this.inverted=i}render(i,e,t,n,s){const r=i.getContext(),a=i.state.buffers,o=this.scene,l=this.camera,c=this.clearPass,h=this.inverted?0:1,d=1-h;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),a.stencil.setFunc(r.ALWAYS,h,4294967295),a.stencil.setClear(d),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(i,null):(c.render(i,e),c.render(i,t))),this.renderToScreen?(i.setRenderTarget(null),i.render(o,l)):(i.setRenderTarget(e),i.render(o,l),i.setRenderTarget(t),i.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(r.EQUAL,1,4294967295),a.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),a.stencil.setLocked(!0)}},lpe=class{constructor(i=null,{depthBuffer:e=!0,stencilBuffer:t=!1,multisampling:n=0,frameBufferType:s}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,t,s,n),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new ape,this.depthTexture=null,this.passes=[],this.timer=new npe,this.autoRenderToScreen=!0,this.setRenderer(i)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(i){const e=this.inputBuffer,t=this.multisampling;t>0&&i>0?(this.inputBuffer.samples=i,this.outputBuffer.samples=i,this.inputBuffer.dispose(),this.outputBuffer.dispose()):t!==i&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,i),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(i){if(this.renderer=i,i!==null){const e=i.getSize(new Qe),t=i.getContext().getContextAttributes().alpha,n=this.inputBuffer.texture.type;n===Xs&&i.outputColorSpace===bi&&(this.inputBuffer.texture.colorSpace=bi,this.outputBuffer.texture.colorSpace=bi,this.inputBuffer.dispose(),this.outputBuffer.dispose()),i.autoClear=!1,this.setSize(e.width,e.height);for(const s of this.passes)s.initialize(i,t,n)}}replaceRenderer(i,e=!0){const t=this.renderer,n=t.domElement.parentNode;return this.setRenderer(i),e&&n!==null&&(n.removeChild(t.domElement),n.appendChild(i.domElement)),t}createDepthTexture(){const i=this.depthTexture=new jv;return this.inputBuffer.depthTexture=i,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(i.format=fg,i.type=hg):i.type=Qc,i}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const i of this.passes)i.setDepthTexture(null)}}createBuffer(i,e,t,n){const s=this.renderer,r=s===null?new Qe:s.getDrawingBufferSize(new Qe),a={minFilter:ei,magFilter:ei,stencilBuffer:e,depthBuffer:i,type:t},o=new Os(r.width,r.height,a);return n>0&&(o.ignoreDepthForMultisampleCopy=!1,o.samples=n),t===Xs&&s!==null&&s.outputColorSpace===bi&&(o.texture.colorSpace=bi),o.texture.name="EffectComposer.Buffer",o.texture.generateMipmaps=!1,o}setMainScene(i){for(const e of this.passes)e.mainScene=i}setMainCamera(i){for(const e of this.passes)e.mainCamera=i}addPass(i,e){const t=this.passes,n=this.renderer,s=n.getDrawingBufferSize(new Qe),r=n.getContext().getContextAttributes().alpha,a=this.inputBuffer.texture.type;if(i.setRenderer(n),i.setSize(s.width,s.height),i.initialize(n,r,a),this.autoRenderToScreen&&(t.length>0&&(t[t.length-1].renderToScreen=!1),i.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?t.splice(e,0,i):t.push(i),this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!0),i.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const o=this.createDepthTexture();for(i of t)i.setDepthTexture(o)}else i.setDepthTexture(this.depthTexture)}removePass(i){const e=this.passes,t=e.indexOf(i);if(t!==-1&&e.splice(t,1).length>0){if(this.depthTexture!==null){const r=(o,l)=>o||l.needsDepthTexture;e.reduce(r,!1)||(i.getDepthTexture()===this.depthTexture&&i.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&t===e.length&&(i.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const i=this.passes;this.deleteDepthTexture(),i.length>0&&(this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!1),this.passes=[])}render(i){const e=this.renderer,t=this.copyPass;let n=this.inputBuffer,s=this.outputBuffer,r=!1,a,o,l;i===void 0&&(this.timer.update(),i=this.timer.getDelta());for(const c of this.passes)c.enabled&&(c.render(e,n,s,i,r),c.needsSwap&&(r&&(t.renderToScreen=c.renderToScreen,a=e.getContext(),o=e.state.buffers.stencil,o.setFunc(a.NOTEQUAL,1,4294967295),t.render(e,n,s,i,r),o.setFunc(a.EQUAL,1,4294967295)),l=n,n=s,s=l),c instanceof ope?r=!0:c instanceof spe&&(r=!1))}setSize(i,e,t){const n=this.renderer,s=n.getSize(new Qe);(i===void 0||e===void 0)&&(i=s.width,e=s.height),(s.width!==i||s.height!==e)&&n.setSize(i,e,t);const r=n.getDrawingBufferSize(new Qe);this.inputBuffer.setSize(r.width,r.height),this.outputBuffer.setSize(r.width,r.height);for(const a of this.passes)a.setSize(r.width,r.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const i of this.passes)i.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Lo.fullscreenGeometry.dispose()}},tg={NONE:0,DEPTH:1,CONVOLUTION:2},Ti={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},cpe=class{constructor(){this.shaderParts=new Map([[Ti.FRAGMENT_HEAD,null],[Ti.FRAGMENT_MAIN_UV,null],[Ti.FRAGMENT_MAIN_IMAGE,null],[Ti.VERTEX_HEAD,null],[Ti.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=tg.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=nl}},wD=!1,$4=class{constructor(i=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(i),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case Da:t=this.materialsFlatShadedDoubleSide;break;case wr:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case Da:t=this.materialsDoubleSide;break;case wr:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(i){if(!(i instanceof js))return i.clone();const e=i.uniforms,t=new Map;for(const s in e){const r=e[s].value;r.isRenderTargetTexture&&(e[s].value=null,t.set(s,r))}const n=i.clone();for(const s of t)e[s[0]].value=s[1],n.uniforms[s[0]].value=s[1];return n}setMaterial(i){if(this.disposeMaterials(),this.material=i,i!==null){const e=this.materials=[this.cloneMaterial(i),this.cloneMaterial(i),this.cloneMaterial(i)];for(const t of e)t.uniforms=Object.assign({},i.uniforms),t.side=qc;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.side=wr,n}),this.materialsDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.side=Da,n}),this.materialsFlatShaded=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.flatShading=!0,n}),this.materialsFlatShadedBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.flatShading=!0,n.side=wr,n}),this.materialsFlatShadedDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.flatShading=!0,n.side=Da,n})}}render(i,e,t){const n=i.shadowMap.enabled;if(i.shadowMap.enabled=!1,wD){const s=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),i.render(e,t);for(const r of s)r[0].material=r[1];this.meshCount!==s.size&&s.clear()}else{const s=e.overrideMaterial;e.overrideMaterial=this.material,i.render(e,t),e.overrideMaterial=s}i.shadowMap.enabled=n}disposeMaterials(){if(this.material!==null){const i=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of i)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return wD}static set workaroundEnabled(i){wD=i}},$d=-1,La=class extends sl{constructor(i,e=$d,t=$d,n=1){super(),this.resizable=i,this.baseSize=new Qe(1,1),this.preferredSize=new Qe(e,t),this.target=this.preferredSize,this.s=n,this.effectiveSize=new Qe,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const i=this.baseSize,e=this.preferredSize,t=this.effectiveSize,n=this.scale;e.width!==$d?t.width=e.width:e.height!==$d?t.width=Math.round(e.height*(i.width/Math.max(i.height,1))):t.width=Math.round(i.width*n),e.height!==$d?t.height=e.height:e.width!==$d?t.height=Math.round(e.width/Math.max(i.width/Math.max(i.height,1),1)):t.height=Math.round(i.height*n)}get width(){return this.effectiveSize.width}set width(i){this.preferredWidth=i}get height(){return this.effectiveSize.height}set height(i){this.preferredHeight=i}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(i){this.s!==i&&(this.s=i,this.preferredSize.setScalar($d),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(i){this.scale=i}get baseWidth(){return this.baseSize.width}set baseWidth(i){this.baseSize.width!==i&&(this.baseSize.width=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(i){this.baseWidth=i}get baseHeight(){return this.baseSize.height}set baseHeight(i){this.baseSize.height!==i&&(this.baseSize.height=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(i){this.baseHeight=i}setBaseSize(i,e){(this.baseSize.width!==i||this.baseSize.height!==e)&&(this.baseSize.set(i,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(i){this.preferredSize.width!==i&&(this.preferredSize.width=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(i){this.preferredWidth=i}get preferredHeight(){return this.preferredSize.height}set preferredHeight(i){this.preferredSize.height!==i&&(this.preferredSize.height=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(i){this.preferredHeight=i}setPreferredSize(i,e){(this.preferredSize.width!==i||this.preferredSize.height!==e)&&(this.preferredSize.set(i,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(i){this.s=i.scale,this.baseSize.set(i.baseWidth,i.baseHeight),this.preferredSize.set(i.preferredWidth,i.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return $d}},ti={ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},upe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}",hpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}",fpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}",dpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",ppe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}",mpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}",gpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}",ype="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}",vpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}",xpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}",bpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}",Ape="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}",Epe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}",_pe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}",Spe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}",Tpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}",wpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}",Mpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}",Cpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}",Rpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",Dpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}",Lpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}",Ipe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",Bpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}",Ope="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}",Ppe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}",Npe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",Upe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}",kpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}",Fpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",Hpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}",Gpe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}",zpe=new Map([[ti.ADD,upe],[ti.ALPHA,hpe],[ti.AVERAGE,fpe],[ti.COLOR,dpe],[ti.COLOR_BURN,ppe],[ti.COLOR_DODGE,mpe],[ti.DARKEN,gpe],[ti.DIFFERENCE,ype],[ti.DIVIDE,vpe],[ti.DST,null],[ti.EXCLUSION,xpe],[ti.HARD_LIGHT,bpe],[ti.HARD_MIX,Ape],[ti.HUE,Epe],[ti.INVERT,_pe],[ti.INVERT_RGB,Spe],[ti.LIGHTEN,Tpe],[ti.LINEAR_BURN,wpe],[ti.LINEAR_DODGE,Mpe],[ti.LINEAR_LIGHT,Cpe],[ti.LUMINOSITY,Rpe],[ti.MULTIPLY,Dpe],[ti.NEGATION,Lpe],[ti.NORMAL,Ipe],[ti.OVERLAY,Bpe],[ti.PIN_LIGHT,Ope],[ti.REFLECT,Ppe],[ti.SATURATION,Npe],[ti.SCREEN,Upe],[ti.SOFT_LIGHT,kpe],[ti.SRC,Fpe],[ti.SUBTRACT,Hpe],[ti.VIVID_LIGHT,Gpe]]),Vpe=class extends sl{constructor(i,e=1){super(),this._blendFunction=i,this.opacity=new xi(e)}getOpacity(){return this.opacity.value}setOpacity(i){this.opacity.value=i}get blendFunction(){return this._blendFunction}set blendFunction(i){this._blendFunction=i,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(i){this.blendFunction=i}getShaderCode(){return zpe.get(this.blendFunction)}},gI=class extends sl{constructor(i,e,{attributes:t=tg.NONE,blendFunction:n=ti.NORMAL,defines:s=new Map,uniforms:r=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=i,this.renderer=null,this.attributes=t,this.fragmentShader=e,this.vertexShader=o,this.defines=s,this.uniforms=r,this.extensions=a,this.blendMode=new Vpe(n),this.blendMode.addEventListener("change",l=>this.setChanged()),this._inputColorSpace=nl,this._outputColorSpace=Hc}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(i){this._inputColorSpace=i,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(i){this._outputColorSpace=i,this.setChanged()}set mainScene(i){}set mainCamera(i){}getName(){return this.name}setRenderer(i){this.renderer=i}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(i){this.attributes=i,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(i){this.fragmentShader=i,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(i){this.vertexShader=i,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(i,e=V0){}update(i,e,t){}setSize(i,e){}initialize(i,e,t){}dispose(){for(const i of Object.keys(this)){const e=this[i];(e instanceof Os||e instanceof ur||e instanceof wi||e instanceof Lo)&&this[i].dispose()}}},UO={MEDIUM:2,LARGE:3},Ype=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,Kpe="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",Wpe=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Xpe=class extends js{constructor(i=new ai){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new xi(null),texelSize:new xi(new ai),scale:new xi(1),kernel:new xi(0)},blending:la,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Ype,vertexShader:Kpe}),this.setTexelSize(i.x,i.y),this.kernelSize=UO.MEDIUM}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.inputBuffer=i}get kernelSequence(){return Wpe[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(i){this.uniforms.scale.value=i}getScale(){return this.uniforms.scale.value}setScale(i){this.uniforms.scale.value=i}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(i){this.uniforms.kernel.value=i}setKernel(i){this.kernel=i}setTexelSize(i,e){this.uniforms.texelSize.value.set(i,e,i*.5,e*.5)}setSize(i,e){const t=1/i,n=1/e;this.uniforms.texelSize.value.set(t,n,t*.5,n*.5)}},jpe=class extends Lo{constructor({kernelSize:i=UO.MEDIUM,resolutionScale:e=.5,width:t=La.AUTO_SIZE,height:n=La.AUTO_SIZE,resolutionX:s=t,resolutionY:r=n}={}){super("KawaseBlurPass"),this.renderTargetA=new Os(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const a=this.resolution=new La(this,s,r,e);a.addEventListener("change",o=>this.setSize(a.baseWidth,a.baseHeight)),this._blurMaterial=new Xpe,this._blurMaterial.kernelSize=i,this.copyMaterial=new e7}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(i){this._blurMaterial=i}get dithering(){return this.copyMaterial.dithering}set dithering(i){this.copyMaterial.dithering=i}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(i){this.blurMaterial.kernelSize=i}get width(){return this.resolution.width}set width(i){this.resolution.preferredWidth=i}get height(){return this.resolution.height}set height(i){this.resolution.preferredHeight=i}get scale(){return this.blurMaterial.scale}set scale(i){this.blurMaterial.scale=i}getScale(){return this.blurMaterial.scale}setScale(i){this.blurMaterial.scale=i}getKernelSize(){return this.kernelSize}setKernelSize(i){this.kernelSize=i}getResolutionScale(){return this.resolution.scale}setResolutionScale(i){this.resolution.scale=i}render(i,e,t,n,s){const r=this.scene,a=this.camera,o=this.renderTargetA,l=this.renderTargetB,c=this.blurMaterial,h=c.kernelSequence;let d=e;this.fullscreenMaterial=c;for(let m=0,y=h.length;m<y;++m){const x=(m&1)===0?o:l;c.kernel=h[m],c.inputBuffer=d.texture,i.setRenderTarget(x),i.render(r,a),d=x}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=d.texture,i.setRenderTarget(this.renderToScreen?null:t),i.render(r,a)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e);const n=t.width,s=t.height;this.renderTargetA.setSize(n,s),this.renderTargetB.setSize(n,s),this.blurMaterial.setSize(i,e)}initialize(i,e,t){t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==Xs?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):i!==null&&i.outputColorSpace===bi&&(this.renderTargetA.texture.colorSpace=bi,this.renderTargetB.texture.colorSpace=bi))}static get AUTO_SIZE(){return La.AUTO_SIZE}},qpe=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l)*l;
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*clamp(l,0.0,1.0),l);
#else
gl_FragColor=vec4(l);
#endif
}`,Qpe=class extends js{constructor(i=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:Sg.replace(/\D+/g,"")},uniforms:{inputBuffer:new xi(null),threshold:new xi(0),smoothing:new xi(1),range:new xi(null)},blending:la,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:qpe,vertexShader:ZV}),this.colorOutput=i,this.luminanceRange=e}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.uniforms.inputBuffer.value=i}get threshold(){return this.uniforms.threshold.value}set threshold(i){this.smoothing>0||i>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=i}getThreshold(){return this.threshold}setThreshold(i){this.threshold=i}get smoothing(){return this.uniforms.smoothing.value}set smoothing(i){this.threshold>0||i>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=i}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(i){this.smoothing=i}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(i){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(i){i?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(i){return this.colorOutput}setColorOutputEnabled(i){this.colorOutput=i}get useRange(){return this.luminanceRange!==null}set useRange(i){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(i){i!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=i,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(i){this.luminanceRange=i}},$pe=class extends Lo{constructor({renderTarget:i,luminanceRange:e,colorOutput:t,resolutionScale:n=1,width:s=La.AUTO_SIZE,height:r=La.AUTO_SIZE,resolutionX:a=s,resolutionY:o=r}={}){super("LuminancePass"),this.fullscreenMaterial=new Qpe(t,e),this.needsSwap=!1,this.renderTarget=i,this.renderTarget===void 0&&(this.renderTarget=new Os(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const l=this.resolution=new La(this,a,o,n);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(i,e,t,n,s){const r=this.fullscreenMaterial;r.inputBuffer=e.texture,i.setRenderTarget(this.renderToScreen?null:this.renderTarget),i.render(this.scene,this.camera)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e),this.renderTarget.setSize(t.width,t.height)}initialize(i,e,t){t!==void 0&&t!==Xs&&(this.renderTarget.texture.type=t,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Jpe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,Zpe="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",eme=class extends js{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new xi(null),texelSize:new xi(new Qe)},blending:la,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Jpe,vertexShader:Zpe})}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setSize(i,e){this.uniforms.texelSize.value.set(1/i,1/e)}},tme=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,nme="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",ime=class extends js{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new xi(null),supportBuffer:new xi(null),texelSize:new xi(new Qe),radius:new xi(.85)},blending:la,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:tme,vertexShader:nme})}set inputBuffer(i){this.uniforms.inputBuffer.value=i}set supportBuffer(i){this.uniforms.supportBuffer.value=i}get radius(){return this.uniforms.radius.value}set radius(i){this.uniforms.radius.value=i}setSize(i,e){this.uniforms.texelSize.value.set(1/i,1/e)}},sme=class extends Lo{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new Os(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new eme,this.upsamplingMaterial=new ime,this.resolution=new Qe}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(i){if(this.levels!==i){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let t=0;t<i;++t){const n=e.clone();n.texture.name="Downsampling.Mipmap"+t,this.downsamplingMipmaps.push(n)}this.upsamplingMipmaps.push(e);for(let t=1,n=i-1;t<n;++t){const s=e.clone();s.texture.name="Upsampling.Mipmap"+t,this.upsamplingMipmaps.push(s)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(i){this.upsamplingMaterial.radius=i}render(i,e,t,n,s){const{scene:r,camera:a}=this,{downsamplingMaterial:o,upsamplingMaterial:l}=this,{downsamplingMipmaps:c,upsamplingMipmaps:h}=this;let d=e;this.fullscreenMaterial=o;for(let m=0,y=c.length;m<y;++m){const x=c[m];o.setSize(d.width,d.height),o.inputBuffer=d.texture,i.setRenderTarget(x),i.render(r,a),d=x}this.fullscreenMaterial=l;for(let m=h.length-1;m>=0;--m){const y=h[m];l.setSize(d.width,d.height),l.inputBuffer=d.texture,l.supportBuffer=c[m].texture,i.setRenderTarget(y),i.render(r,a),d=y}}setSize(i,e){const t=this.resolution;t.set(i,e);let n=t.width,s=t.height;for(let r=0,a=this.downsamplingMipmaps.length;r<a;++r)n=Math.round(n*.5),s=Math.round(s*.5),this.downsamplingMipmaps[r].setSize(n,s),r<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[r].setSize(n,s)}initialize(i,e,t){if(t!==void 0){const n=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const s of n)s.texture.type=t;if(t!==Xs)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(i!==null&&i.outputColorSpace===bi)for(const s of n)s.texture.colorSpace=bi}}dispose(){super.dispose();for(const i of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))i.dispose()}},rme=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,texel.a);}`,ame=class extends gI{constructor({blendFunction:i=ti.SCREEN,luminanceThreshold:e=.9,luminanceSmoothing:t=.025,mipmapBlur:n=!1,intensity:s=1,radius:r=.85,levels:a=8,kernelSize:o=UO.LARGE,resolutionScale:l=.5,width:c=La.AUTO_SIZE,height:h=La.AUTO_SIZE,resolutionX:d=c,resolutionY:m=h}={}){super("BloomEffect",rme,{blendFunction:i,uniforms:new Map([["map",new xi(null)],["intensity",new xi(s)]])}),this.renderTarget=new Os(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new jpe({kernelSize:o}),this.luminancePass=new $pe({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=t,this.mipmapBlurPass=new sme,this.mipmapBlurPass.enabled=n,this.mipmapBlurPass.radius=r,this.mipmapBlurPass.levels=a,this.uniforms.get("map").value=n?this.mipmapBlurPass.texture:this.renderTarget.texture;const y=this.resolution=new La(this,d,m,l);y.addEventListener("change",x=>this.setSize(y.baseWidth,y.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(i){this.resolution.preferredWidth=i}get height(){return this.resolution.height}set height(i){this.resolution.preferredHeight=i}get dithering(){return this.blurPass.dithering}set dithering(i){this.blurPass.dithering=i}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(i){this.blurPass.kernelSize=i}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(i){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(i){this.uniforms.get("intensity").value=i}getIntensity(){return this.intensity}setIntensity(i){this.intensity=i}getResolutionScale(){return this.resolution.scale}setResolutionScale(i){this.resolution.scale=i}update(i,e,t){const n=this.renderTarget,s=this.luminancePass;s.enabled?(s.render(i,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(i,s.renderTarget):this.blurPass.render(i,s.renderTarget,n)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(i,e):this.blurPass.render(i,e,n)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e),this.renderTarget.setSize(t.width,t.height),this.blurPass.resolution.copy(t),this.luminancePass.setSize(i,e),this.mipmapBlurPass.setSize(i,e)}initialize(i,e,t){this.blurPass.initialize(i,e,t),this.luminancePass.initialize(i,e,t),this.mipmapBlurPass.initialize(i,e,t),t!==void 0&&(this.renderTarget.texture.type=t,i!==null&&i.outputColorSpace===bi&&(this.renderTarget.texture.colorSpace=bi))}},n7=class extends Lo{constructor(i,e,t=null){super("RenderPass",i,e),this.needsSwap=!1,this.clearPass=new t7,this.overrideMaterialManager=t===null?null:new $4(t),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(i){this.scene=i}set mainCamera(i){this.camera=i}get renderToScreen(){return super.renderToScreen}set renderToScreen(i){super.renderToScreen=i,this.clearPass.renderToScreen=i}get overrideMaterial(){const i=this.overrideMaterialManager;return i!==null?i.material:null}set overrideMaterial(i){const e=this.overrideMaterialManager;i!==null?e!==null?e.setMaterial(i):this.overrideMaterialManager=new $4(i):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(i){this.overrideMaterial=i}get clear(){return this.clearPass.enabled}set clear(i){this.clearPass.enabled=i}getSelection(){return this.selection}setSelection(i){this.selection=i}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(i){this.ignoreBackground=i}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(i){this.skipShadowMapUpdate=i}getClearPass(){return this.clearPass}render(i,e,t,n,s){const r=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,c=r.background,h=i.shadowMap.autoUpdate,d=this.renderToScreen?null:e;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(i.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(r.background=null),this.clearPass.enabled&&this.clearPass.render(i,e),i.setRenderTarget(d),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(i,r,a):i.render(r,a),a.layers.mask=l,r.background=c,i.shadowMap.autoUpdate=h}},ome=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,lme="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",cme=class extends js{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new xi(null),normalBuffer:new xi(null),texelSize:new xi(new Qe)},blending:la,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:ome,vertexShader:lme})}set depthBuffer(i){this.uniforms.depthBuffer.value=i}set depthPacking(i){this.defines.DEPTH_PACKING=i.toFixed(0),this.needsUpdate=!0}setDepthBuffer(i,e=V0){this.depthBuffer=i,this.depthPacking=e}set normalBuffer(i){this.uniforms.normalBuffer.value=i,i!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(i){this.normalBuffer=i}setTexelSize(i,e){this.uniforms.texelSize.value.set(i,e)}setSize(i,e){this.uniforms.texelSize.value.set(1/i,1/e)}},ume=class extends Lo{constructor({normalBuffer:i=null,resolutionScale:e=.5,width:t=La.AUTO_SIZE,height:n=La.AUTO_SIZE,resolutionX:s=t,resolutionY:r=n}={}){super("DepthDownsamplingPass");const a=new cme;a.normalBuffer=i,this.fullscreenMaterial=a,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new Os(1,1,{minFilter:Ws,magFilter:Ws,depthBuffer:!1,type:ps}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const o=this.resolution=new La(this,s,r,e);o.addEventListener("change",l=>this.setSize(o.baseWidth,o.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(i,e=V0){this.fullscreenMaterial.depthBuffer=i,this.fullscreenMaterial.depthPacking=e}render(i,e,t,n,s){i.setRenderTarget(this.renderToScreen?null:this.renderTarget),i.render(this.scene,this.camera)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e),this.renderTarget.setSize(t.width,t.height),this.fullscreenMaterial.setSize(i,e)}initialize(i,e,t){const n=i.getContext();if(!(n.getExtension("EXT_color_buffer_float")||n.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},hme=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,fme="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",dme=class extends js{constructor(i,e,t,n,s=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Sg.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new xi(null),depthBuffer:new xi(null),resolution:new xi(new Qe),texelSize:new xi(new Qe),cameraNear:new xi(.3),cameraFar:new xi(1e3),aspect:new xi(1),time:new xi(0)},blending:la,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:s}),i&&this.setShaderParts(i),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(n)}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.uniforms.inputBuffer.value=i}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(i){this.uniforms.depthBuffer.value=i}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(i){this.defines.DEPTH_PACKING=i.toFixed(0),this.needsUpdate=!0}setDepthBuffer(i,e=V0){this.depthBuffer=i,this.depthPacking=e}setShaderData(i){this.setShaderParts(i.shaderParts),this.setDefines(i.defines),this.setUniforms(i.uniforms),this.setExtensions(i.extensions)}setShaderParts(i){return this.fragmentShader=hme.replace(Ti.FRAGMENT_HEAD,i.get(Ti.FRAGMENT_HEAD)||"").replace(Ti.FRAGMENT_MAIN_UV,i.get(Ti.FRAGMENT_MAIN_UV)||"").replace(Ti.FRAGMENT_MAIN_IMAGE,i.get(Ti.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=fme.replace(Ti.VERTEX_HEAD,i.get(Ti.VERTEX_HEAD)||"").replace(Ti.VERTEX_MAIN_SUPPORT,i.get(Ti.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(i){for(const e of i.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(i){for(const e of i.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(i){this.extensions={};for(const e of i)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(i){this.encodeOutput!==i&&(i?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(i){return this.encodeOutput}setOutputEncodingEnabled(i){this.encodeOutput=i}get time(){return this.uniforms.time.value}set time(i){this.uniforms.time.value=i}setDeltaTime(i){this.uniforms.time.value+=i}adoptCameraSettings(i){this.copyCameraSettings(i)}copyCameraSettings(i){i&&(this.uniforms.cameraNear.value=i.near,this.uniforms.cameraFar.value=i.far,i instanceof Ds?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(i,e){const t=this.uniforms;t.resolution.value.set(i,e),t.texelSize.value.set(1/i,1/e),t.aspect.value=i/e}static get Section(){return Ti}};function J4(i,e,t){for(const n of e){const s="$1"+i+n.charAt(0).toUpperCase()+n.slice(1),r=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(const a of t.entries())a[1]!==null&&t.set(a[0],a[1].replace(r,s))}}function pme(i,e,t){let n=e.getFragmentShader(),s=e.getVertexShader();const r=n!==void 0&&/mainImage/.test(n),a=n!==void 0&&/mainUv/.test(n);if(t.attributes|=e.getAttributes(),n===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(a&&(t.attributes&tg.CONVOLUTION)!==0)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!r&&!a)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const o=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,l=t.shaderParts;let c=l.get(Ti.FRAGMENT_HEAD)||"",h=l.get(Ti.FRAGMENT_MAIN_UV)||"",d=l.get(Ti.FRAGMENT_MAIN_IMAGE)||"",m=l.get(Ti.VERTEX_HEAD)||"",y=l.get(Ti.VERTEX_MAIN_SUPPORT)||"";const x=new Set,_=new Set;if(a&&(h+=`	${i}MainUv(UV);
`,t.uvTransformation=!0),s!==null&&/mainSupport/.test(s)){const T=/mainSupport *\([\w\s]*?uv\s*?\)/.test(s);y+=`	${i}MainSupport(`,y+=T?`vUv);
`:`);
`;for(const w of s.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const R of w[1].split(/\s*,\s*/))t.varyings.add(R),x.add(R),_.add(R);for(const w of s.matchAll(o))_.add(w[1])}for(const T of n.matchAll(o))_.add(T[1]);for(const T of e.defines.keys())_.add(T.replace(/\([\w\s,]*\)/g,""));for(const T of e.uniforms.keys())_.add(T);_.delete("while"),_.delete("for"),_.delete("if"),e.uniforms.forEach((T,w)=>t.uniforms.set(i+w.charAt(0).toUpperCase()+w.slice(1),T)),e.defines.forEach((T,w)=>t.defines.set(i+w.charAt(0).toUpperCase()+w.slice(1),T));const b=new Map([["fragment",n],["vertex",s]]);J4(i,_,t.defines),J4(i,_,b),n=b.get("fragment"),s=b.get("vertex");const A=e.blendMode;if(t.blendModes.set(A.blendFunction,A),r){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(d+=e.inputColorSpace===bi?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==Hc?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const T=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;d+=`${i}MainImage(color0, UV, `,(t.attributes&tg.DEPTH)!==0&&T.test(n)&&(d+="depth, ",t.readDepth=!0),d+=`color1);
	`;const w=i+"BlendOpacity";t.uniforms.set(w,A.opacity),d+=`color0 = blend${A.blendFunction}(color0, color1, ${w});

	`,c+=`uniform float ${w};

`}if(c+=n+`
`,s!==null&&(m+=s+`
`),l.set(Ti.FRAGMENT_HEAD,c),l.set(Ti.FRAGMENT_MAIN_UV,h),l.set(Ti.FRAGMENT_MAIN_IMAGE,d),l.set(Ti.VERTEX_HEAD,m),l.set(Ti.VERTEX_MAIN_SUPPORT,y),e.extensions!==null)for(const T of e.extensions)t.extensions.add(T)}}var mme=class extends Lo{constructor(i,...e){super("EffectPass"),this.fullscreenMaterial=new dme(null,null,null,i),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(i){for(const e of this.effects)e.mainScene=i}set mainCamera(i){this.fullscreenMaterial.copyCameraSettings(i);for(const e of this.effects)e.mainCamera=i}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(i){this.fullscreenMaterial.encodeOutput=i}get dithering(){return this.fullscreenMaterial.dithering}set dithering(i){const e=this.fullscreenMaterial;e.dithering=i,e.needsUpdate=!0}setEffects(i){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=i.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const i=new cpe;let e=0;for(const a of this.effects)if(a.blendMode.blendFunction===ti.DST)i.attributes|=a.getAttributes()&tg.DEPTH;else{if((i.attributes&a.getAttributes()&tg.CONVOLUTION)!==0)throw new Error(`Convolution effects cannot be merged (${a.name})`);pme("e"+e++,a,i)}let t=i.shaderParts.get(Ti.FRAGMENT_HEAD),n=i.shaderParts.get(Ti.FRAGMENT_MAIN_IMAGE),s=i.shaderParts.get(Ti.FRAGMENT_MAIN_UV);const r=/\bblend\b/g;for(const a of i.blendModes.values())t+=a.getShaderCode().replace(r,`blend${a.blendFunction}`)+`
`;(i.attributes&tg.DEPTH)!==0?(i.readDepth&&(n=`float depth = readDepth(UV);

	`+n),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,i.colorSpace===bi&&(n+=`color0 = sRGBToLinear(color0);
	`),i.uvTransformation?(s=`vec2 transformedUv = vUv;
`+s,i.defines.set("UV","transformedUv")):i.defines.set("UV","vUv"),i.shaderParts.set(Ti.FRAGMENT_HEAD,t),i.shaderParts.set(Ti.FRAGMENT_MAIN_IMAGE,n),i.shaderParts.set(Ti.FRAGMENT_MAIN_UV,s);for(const[a,o]of i.shaderParts)o!==null&&i.shaderParts.set(a,o.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(i)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(i,e=V0){this.fullscreenMaterial.depthBuffer=i,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(i,e)}render(i,e,t,n,s){for(const r of this.effects)r.update(i,e,n);if(!this.skipRendering||this.renderToScreen){const r=this.fullscreenMaterial;r.inputBuffer=e.texture,r.time+=n*this.timeScale,i.setRenderTarget(this.renderToScreen?null:t),i.render(this.scene,this.camera)}}setSize(i,e){this.fullscreenMaterial.setSize(i,e);for(const t of this.effects)t.setSize(i,e)}initialize(i,e,t){this.renderer=i;for(const n of this.effects)n.initialize(i,e,t);this.updateMaterial(),t!==void 0&&t!==Xs&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const i of this.effects)i.removeEventListener("change",this.listener),i.dispose()}handleEvent(i){switch(i.type){case"change":this.recompile();break}}},gme=class extends Lo{constructor(i,e,{renderTarget:t,resolutionScale:n=1,width:s=La.AUTO_SIZE,height:r=La.AUTO_SIZE,resolutionX:a=s,resolutionY:o=r}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new n7(i,e,new nO);const l=this.renderPass;l.ignoreBackground=!0,l.skipShadowMapUpdate=!0;const c=l.getClearPass();c.overrideClearColor=new Ut(7829503),c.overrideClearAlpha=1,this.renderTarget=t,this.renderTarget===void 0&&(this.renderTarget=new Os(1,1,{minFilter:Ws,magFilter:Ws}),this.renderTarget.texture.name="NormalPass.Target");const h=this.resolution=new La(this,a,o,n);h.addEventListener("change",d=>this.setSize(h.baseWidth,h.baseHeight))}set mainScene(i){this.renderPass.mainScene=i}set mainCamera(i){this.renderPass.mainCamera=i}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(i){this.resolution.scale=i}render(i,e,t,n,s){const r=this.renderToScreen?null:this.renderTarget;this.renderPass.render(i,r,r)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e),this.renderTarget.setSize(t.width,t.height)}};function AA(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}new Qe;new Qe;function i7(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}var Sl=function i(e,t,n){var s=this;i7(this,i),AA(this,"dot2",function(r,a){return s.x*r+s.y*a}),AA(this,"dot3",function(r,a,o){return s.x*r+s.y*a+s.z*o}),this.x=e,this.y=t,this.z=n},yme=[new Sl(1,1,0),new Sl(-1,1,0),new Sl(1,-1,0),new Sl(-1,-1,0),new Sl(1,0,1),new Sl(-1,0,1),new Sl(1,0,-1),new Sl(-1,0,-1),new Sl(0,1,1),new Sl(0,-1,1),new Sl(0,1,-1),new Sl(0,-1,-1)],Z4=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],e8=new Array(512),t8=new Array(512),vme=function(e){e>0&&e<1&&(e*=65536),e=Math.floor(e),e<256&&(e|=e<<8);for(var t=0;t<256;t++){var n;t&1?n=Z4[t]^e&255:n=Z4[t]^e>>8&255,e8[t]=e8[t+256]=n,t8[t]=t8[t+256]=yme[n%12]}};vme(0);function xme(i){if(typeof i=="number")i=Math.abs(i);else if(typeof i=="string"){var e=i;i=0;for(var t=0;t<e.length;t++)i=(i+(t+1)*(e.charCodeAt(t)%96))%2147483647}return i===0&&(i=311),i}function n8(i){var e=xme(i);return function(){var t=e*48271%2147483647;return e=t,t/2147483647}}var bme=function i(e){var t=this;i7(this,i),AA(this,"seed",0),AA(this,"init",function(n){t.seed=n,t.value=n8(n)}),AA(this,"value",n8(this.seed)),this.init(e)};new bme(Math.random());const Ame=ce.createContext(null),i8=i=>(i.getAttributes()&2)===2,Eme=ce.memo(ce.forwardRef(({children:i,camera:e,scene:t,resolutionScale:n,enabled:s=!0,renderPriority:r=1,autoClear:a=!0,depthBuffer:o,enableNormalPass:l,stencilBuffer:c,multisampling:h=8,frameBufferType:d=yr},m)=>{const{gl:y,scene:x,camera:_,size:b}=gr(),A=t||x,T=e||_,[w,R,O]=ce.useMemo(()=>{const P=new lpe(y,{depthBuffer:o,stencilBuffer:c,multisampling:h,frameBufferType:d});P.addPass(new n7(A,T));let B=null,L=null;return l&&(L=new gme(A,T),L.enabled=!1,P.addPass(L),n!==void 0&&(B=new ume({normalBuffer:L.texture,resolutionScale:n}),B.enabled=!1,P.addPass(B))),[P,L,B]},[T,y,o,c,h,d,A,l,n]);ce.useEffect(()=>w==null?void 0:w.setSize(b.width,b.height),[w,b]),Zv((P,B)=>{if(s){const L=y.autoClear;y.autoClear=a,c&&!a&&y.clearStencil(),w.render(B),y.autoClear=L}},s?r:0);const N=ce.useRef(null);ce.useLayoutEffect(()=>{var L;const P=[],B=N.current.__r3f;if(B&&w){const F=B.children;for(let j=0;j<F.length;j++){const J=F[j].object;if(J instanceof gI){const re=[J];if(!i8(J)){let W=null;for(;(W=(L=F[j+1])==null?void 0:L.object)instanceof gI&&!i8(W);)re.push(W),j++}const q=new mme(T,...re);P.push(q)}else J instanceof Lo&&P.push(J)}for(const j of P)w==null||w.addPass(j);R&&(R.enabled=!0),O&&(O.enabled=!0)}return()=>{for(const F of P)w==null||w.removePass(F);R&&(R.enabled=!1),O&&(O.enabled=!1)}},[w,i,T,R,O]),ce.useEffect(()=>{const P=y.toneMapping;return y.toneMapping=Vc,()=>{y.toneMapping=P}},[y]);const U=ce.useMemo(()=>({composer:w,normalPass:R,downSamplingPass:O,resolutionScale:n,camera:T,scene:A}),[w,R,O,n,T,A]);return ce.useImperativeHandle(m,()=>w,[w]),Re.jsx(Ame.Provider,{value:U,children:Re.jsx("group",{ref:N,children:i})})}));let _me=0;const s8=new WeakMap,Sme=(i,e)=>function({blendFunction:t=e==null?void 0:e.blendFunction,opacity:n=e==null?void 0:e.opacity,...s}){let r=s8.get(i);if(!r){const l=`@react-three/postprocessing/${i.name}-${_me++}`;wO({[l]:i}),s8.set(i,r=l)}const a=gr(l=>l.camera),o=mv.useMemo(()=>[...(e==null?void 0:e.args)??[],...s.args??[{...e,...s}]],[JSON.stringify(s)]);return Re.jsx(r,{camera:a,"blendMode-blendFunction":t,"blendMode-opacity-value":n,...s,args:o})},Tme=Sme(ame,{blendFunction:0}),wme="/assets/PoliceCar-D5OrTZPX.glb",Mme="/assets/SportsCar-B6y4eZWY.glb",Cme="/assets/ToyotaAE86-CzUHmAf6.glb",MD=({modelPath:i,lane:e=0,offsetZ:t=-20,direction:n="forward",scale:s=1})=>{const r=ce.useRef(null),{scene:a}=ZE(i);return Zv(()=>{if(r.current){const l=n==="forward"?1:-1;r.current.position.z+=.2*l,n==="forward"&&r.current.position.z>35?r.current.position.z=-35:n==="backward"&&r.current.position.z<-35&&(r.current.position.z=35)}}),Re.jsx("group",{ref:r,position:[e,-1.4,t],rotation:[0,n==="backward"?Math.PI:0,0],scale:s,children:Re.jsx("primitive",{object:a})})},Rme=()=>Re.jsxs(Re.Fragment,{children:[Re.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-1.49,0],receiveShadow:!0,children:[Re.jsx("planeGeometry",{args:[10,60]}),Re.jsx("meshStandardMaterial",{color:"#222",emissive:"#222",metalness:0,roughness:1})]}),Re.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[-1,-1.48,0],children:[Re.jsx("planeGeometry",{args:[.05,60]}),Re.jsx("meshStandardMaterial",{color:"#000",emissive:"#0ff",emissiveIntensity:1,metalness:0,roughness:1})]}),Re.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[1,-1.48,0],children:[Re.jsx("planeGeometry",{args:[.05,60]}),Re.jsx("meshStandardMaterial",{color:"#000",emissive:"#0ff",emissiveIntensity:1,metalness:0,roughness:1})]}),Array.from({length:30}).map((s,r)=>Re.jsxs("mesh",{position:[0,-1.47,-30+r*2],rotation:[-Math.PI/2,0,0],children:[Re.jsx("planeGeometry",{args:[.1,1]}),Re.jsx("meshStandardMaterial",{color:"#fff",emissive:"#fff",emissiveIntensity:.5,metalness:0,roughness:1})]},r))]}),Dme="/assets/Troncity-C3udAPBx.glb",Lme=({path:i,scale:e=1,position:t=[0,0,0],rotation:n=[0,0,0]})=>{const s=ce.useRef(new Map),{scene:r}=ZE(i);return ce.useEffect(()=>{r.traverse(a=>{if(a.isMesh){const o=a,l=o.name.toLowerCase(),h={"highrise_12-mesh_0":"#f00","highrise_12-mesh_1":"#00f","highrise_12-mesh_2":"#ff0","highrise_12-mesh_3":"#0f0","highrise_12-mesh_4":"#0ff","highrise_12-mesh_5":"#f0f","highrise_12-mesh_6":"#0f0","highrise_12-mesh_7":"#ff0","highrise_12-mesh_8":"#f80","highrise_12-mesh_9":"#0cf","highrise_12-mesh_10":"#f0c","highrise_12-mesh_11":"#c0f","highrise_12-mesh_12":"#f80","highrise_12-mesh_13":"#f0f0f0","highrise_12-mesh_14":"#0ff"}[l];if(h){const d=Array.isArray(o.material)?o.material:[o.material],m=[];d.forEach(y=>{y instanceof qv&&(y.emissive=new Ut(h),y.emissiveIntensity=2.5,y.color=new Ut("#222"),m.push(y))}),s.current.set(l,m)}}})},[r]),Zv(({clock:a})=>{const o=a.getElapsedTime();s.current.forEach((l,c)=>{const y=1.5+Math.sin(o*1.5+c.length)*1.2;l.forEach(x=>{x.emissiveIntensity=y})})}),Re.jsx("primitive",{object:r,scale:e,position:t,rotation:n,castShadow:!0,receiveShadow:!0})},Ime=()=>Re.jsx("div",{className:"w-full h-screen bg-black",children:Re.jsxs(wde,{shadows:!0,gl:{antialias:!0},camera:{position:[0,.8,1],fov:60},children:[Re.jsx("color",{attach:"background",args:["#050510"]}),Re.jsx("fog",{attach:"fog",args:["#050510",10,30]}),Re.jsx(U0e,{makeDefault:!0,position:[0,2,10]}),Re.jsx(k0e,{enableZoom:!0,maxPolarAngle:Math.PI/2+.04}),Re.jsx(epe,{preset:"night"}),Re.jsx(Rme,{}),Re.jsx(Lme,{path:Dme,scale:.05,position:[0,-1.49,1],rotation:[0,Math.PI,0]}),Re.jsx(MD,{modelPath:wme,lane:.5,offsetZ:-30,direction:"forward",scale:.25}),Re.jsx(MD,{modelPath:Mme,lane:-.5,offsetZ:-15,direction:"backward",scale:.25}),Re.jsx(MD,{modelPath:Cme,lane:.5,offsetZ:-10,direction:"forward",scale:.05}),Re.jsx("ambientLight",{intensity:.3}),Re.jsx("pointLight",{position:[0,5,5],intensity:1.2,color:"#0ff",castShadow:!0}),Re.jsx("spotLight",{position:[-5,10,5],angle:.3,penumbra:.2,intensity:2,castShadow:!0}),Re.jsx(Eme,{children:Re.jsx(Tme,{luminanceThreshold:.2,luminanceSmoothing:.9,intensity:1.5})})]})});var yI=new Map,sT=new WeakMap,r8=0,Bme=void 0;function Ome(i){return i?(sT.has(i)||(r8+=1,sT.set(i,r8.toString())),sT.get(i)):"0"}function Pme(i){return Object.keys(i).sort().filter(e=>i[e]!==void 0).map(e=>`${e}_${e==="root"?Ome(i.root):i[e]}`).toString()}function Nme(i){const e=Pme(i);let t=yI.get(e);if(!t){const n=new Map;let s;const r=new IntersectionObserver(a=>{a.forEach(o=>{var l;const c=o.isIntersecting&&s.some(h=>o.intersectionRatio>=h);i.trackVisibility&&typeof o.isVisible>"u"&&(o.isVisible=c),(l=n.get(o.target))==null||l.forEach(h=>{h(c,o)})})},i);s=r.thresholds||(Array.isArray(i.threshold)?i.threshold:[i.threshold||0]),t={id:e,observer:r,elements:n},yI.set(e,t)}return t}function Ume(i,e,t={},n=Bme){if(typeof window.IntersectionObserver>"u"&&n!==void 0){const l=i.getBoundingClientRect();return e(n,{isIntersecting:n,target:i,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:l,intersectionRect:l,rootBounds:l}),()=>{}}const{id:s,observer:r,elements:a}=Nme(t),o=a.get(i)||[];return a.has(i)||a.set(i,o),o.push(e),r.observe(i),function(){o.splice(o.indexOf(e),1),o.length===0&&(a.delete(i),r.unobserve(i)),a.size===0&&(r.disconnect(),yI.delete(s))}}function kme({threshold:i,delay:e,trackVisibility:t,rootMargin:n,root:s,triggerOnce:r,skip:a,initialInView:o,fallbackInView:l,onChange:c}={}){var h;const[d,m]=ce.useState(null),y=ce.useRef(c),[x,_]=ce.useState({inView:!!o,entry:void 0});y.current=c,ce.useEffect(()=>{if(a||!d)return;let w;return w=Ume(d,(R,O)=>{_({inView:R,entry:O}),y.current&&y.current(R,O),O.isIntersecting&&r&&w&&(w(),w=void 0)},{root:s,rootMargin:n,threshold:i,trackVisibility:t,delay:e},l),()=>{w&&w()}},[Array.isArray(i)?i.toString():i,d,s,n,r,a,t,l,e]);const b=(h=x.entry)==null?void 0:h.target,A=ce.useRef(void 0);!d&&b&&!r&&!a&&A.current!==b&&(A.current=b,_({inView:!!o,entry:void 0}));const T=[m,x.inView,x.entry];return T.ref=T[0],T.inView=T[1],T.entry=T[2],T}const Fme=({children:i})=>Re.jsxs("div",{className:"relative w-full max-w-4xl h-[400px] mx-auto p-4 bg-black rounded-xl border w-full border-cyan-500 shadow-[0_0_20px_#0ff] overflow-hidden",children:[Re.jsx("div",{className:"absolute inset-0 pointer-events-none neon-scan-bg z-10"}),Re.jsx("div",{className:"relative z-20 w-full h-full",children:i})]});/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function e1(i){return i+.5|0}const T0=(i,e,t)=>Math.max(Math.min(i,t),e);function tA(i){return T0(e1(i*2.55),0,255)}function D0(i){return T0(e1(i*255),0,255)}function gf(i){return T0(e1(i/2.55)/100,0,1)}function a8(i){return T0(e1(i*100),0,100)}const Tl={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},vI=[..."0123456789ABCDEF"],Hme=i=>vI[i&15],Gme=i=>vI[(i&240)>>4]+vI[i&15],rT=i=>(i&240)>>4===(i&15),zme=i=>rT(i.r)&&rT(i.g)&&rT(i.b)&&rT(i.a);function Vme(i){var e=i.length,t;return i[0]==="#"&&(e===4||e===5?t={r:255&Tl[i[1]]*17,g:255&Tl[i[2]]*17,b:255&Tl[i[3]]*17,a:e===5?Tl[i[4]]*17:255}:(e===7||e===9)&&(t={r:Tl[i[1]]<<4|Tl[i[2]],g:Tl[i[3]]<<4|Tl[i[4]],b:Tl[i[5]]<<4|Tl[i[6]],a:e===9?Tl[i[7]]<<4|Tl[i[8]]:255})),t}const Yme=(i,e)=>i<255?e(i):"";function Kme(i){var e=zme(i)?Hme:Gme;return i?"#"+e(i.r)+e(i.g)+e(i.b)+Yme(i.a,e):void 0}const Wme=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function s7(i,e,t){const n=e*Math.min(t,1-t),s=(r,a=(r+i/30)%12)=>t-n*Math.max(Math.min(a-3,9-a,1),-1);return[s(0),s(8),s(4)]}function Xme(i,e,t){const n=(s,r=(s+i/60)%6)=>t-t*e*Math.max(Math.min(r,4-r,1),0);return[n(5),n(3),n(1)]}function jme(i,e,t){const n=s7(i,1,.5);let s;for(e+t>1&&(s=1/(e+t),e*=s,t*=s),s=0;s<3;s++)n[s]*=1-e-t,n[s]+=e;return n}function qme(i,e,t,n,s){return i===s?(e-t)/n+(e<t?6:0):e===s?(t-i)/n+2:(i-e)/n+4}function kO(i){const t=i.r/255,n=i.g/255,s=i.b/255,r=Math.max(t,n,s),a=Math.min(t,n,s),o=(r+a)/2;let l,c,h;return r!==a&&(h=r-a,c=o>.5?h/(2-r-a):h/(r+a),l=qme(t,n,s,h,r),l=l*60+.5),[l|0,c||0,o]}function FO(i,e,t,n){return(Array.isArray(e)?i(e[0],e[1],e[2]):i(e,t,n)).map(D0)}function HO(i,e,t){return FO(s7,i,e,t)}function Qme(i,e,t){return FO(jme,i,e,t)}function $me(i,e,t){return FO(Xme,i,e,t)}function r7(i){return(i%360+360)%360}function Jme(i){const e=Wme.exec(i);let t=255,n;if(!e)return;e[5]!==n&&(t=e[6]?tA(+e[5]):D0(+e[5]));const s=r7(+e[2]),r=+e[3]/100,a=+e[4]/100;return e[1]==="hwb"?n=Qme(s,r,a):e[1]==="hsv"?n=$me(s,r,a):n=HO(s,r,a),{r:n[0],g:n[1],b:n[2],a:t}}function Zme(i,e){var t=kO(i);t[0]=r7(t[0]+e),t=HO(t),i.r=t[0],i.g=t[1],i.b=t[2]}function ege(i){if(!i)return;const e=kO(i),t=e[0],n=a8(e[1]),s=a8(e[2]);return i.a<255?`hsla(${t}, ${n}%, ${s}%, ${gf(i.a)})`:`hsl(${t}, ${n}%, ${s}%)`}const o8={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},l8={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function tge(){const i={},e=Object.keys(l8),t=Object.keys(o8);let n,s,r,a,o;for(n=0;n<e.length;n++){for(a=o=e[n],s=0;s<t.length;s++)r=t[s],o=o.replace(r,o8[r]);r=parseInt(l8[a],16),i[o]=[r>>16&255,r>>8&255,r&255]}return i}let aT;function nge(i){aT||(aT=tge(),aT.transparent=[0,0,0,0]);const e=aT[i.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const ige=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function sge(i){const e=ige.exec(i);let t=255,n,s,r;if(e){if(e[7]!==n){const a=+e[7];t=e[8]?tA(a):T0(a*255,0,255)}return n=+e[1],s=+e[3],r=+e[5],n=255&(e[2]?tA(n):T0(n,0,255)),s=255&(e[4]?tA(s):T0(s,0,255)),r=255&(e[6]?tA(r):T0(r,0,255)),{r:n,g:s,b:r,a:t}}}function rge(i){return i&&(i.a<255?`rgba(${i.r}, ${i.g}, ${i.b}, ${gf(i.a)})`:`rgb(${i.r}, ${i.g}, ${i.b})`)}const CD=i=>i<=.0031308?i*12.92:Math.pow(i,1/2.4)*1.055-.055,ny=i=>i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4);function age(i,e,t){const n=ny(gf(i.r)),s=ny(gf(i.g)),r=ny(gf(i.b));return{r:D0(CD(n+t*(ny(gf(e.r))-n))),g:D0(CD(s+t*(ny(gf(e.g))-s))),b:D0(CD(r+t*(ny(gf(e.b))-r))),a:i.a+t*(e.a-i.a)}}function oT(i,e,t){if(i){let n=kO(i);n[e]=Math.max(0,Math.min(n[e]+n[e]*t,e===0?360:1)),n=HO(n),i.r=n[0],i.g=n[1],i.b=n[2]}}function a7(i,e){return i&&Object.assign(e||{},i)}function c8(i){var e={r:0,g:0,b:0,a:255};return Array.isArray(i)?i.length>=3&&(e={r:i[0],g:i[1],b:i[2],a:255},i.length>3&&(e.a=D0(i[3]))):(e=a7(i,{r:0,g:0,b:0,a:1}),e.a=D0(e.a)),e}function oge(i){return i.charAt(0)==="r"?sge(i):Jme(i)}class lE{constructor(e){if(e instanceof lE)return e;const t=typeof e;let n;t==="object"?n=c8(e):t==="string"&&(n=Vme(e)||nge(e)||oge(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=a7(this._rgb);return e&&(e.a=gf(e.a)),e}set rgb(e){this._rgb=c8(e)}rgbString(){return this._valid?rge(this._rgb):void 0}hexString(){return this._valid?Kme(this._rgb):void 0}hslString(){return this._valid?ege(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,s=e.rgb;let r;const a=t===r?.5:t,o=2*a-1,l=n.a-s.a,c=((o*l===-1?o:(o+l)/(1+o*l))+1)/2;r=1-c,n.r=255&c*n.r+r*s.r+.5,n.g=255&c*n.g+r*s.g+.5,n.b=255&c*n.b+r*s.b+.5,n.a=a*n.a+(1-a)*s.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=age(this._rgb,e._rgb,t)),this}clone(){return new lE(this.rgb)}alpha(e){return this._rgb.a=D0(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=e1(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return oT(this._rgb,2,e),this}darken(e){return oT(this._rgb,2,-e),this}saturate(e){return oT(this._rgb,1,e),this}desaturate(e){return oT(this._rgb,1,-e),this}rotate(e){return Zme(this._rgb,e),this}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function sf(){}const lge=(()=>{let i=0;return()=>i++})();function os(i){return i==null}function aa(i){if(Array.isArray&&Array.isArray(i))return!0;const e=Object.prototype.toString.call(i);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Ri(i){return i!==null&&Object.prototype.toString.call(i)==="[object Object]"}function Hl(i){return(typeof i=="number"||i instanceof Number)&&isFinite(+i)}function zu(i,e){return Hl(i)?i:e}function pi(i,e){return typeof i>"u"?e:i}const cge=(i,e)=>typeof i=="string"&&i.endsWith("%")?parseFloat(i)/100*e:+i;function hs(i,e,t){if(i&&typeof i.call=="function")return i.apply(t,e)}function zi(i,e,t,n){let s,r,a;if(aa(i))for(r=i.length,s=0;s<r;s++)e.call(t,i[s],s);else if(Ri(i))for(a=Object.keys(i),r=a.length,s=0;s<r;s++)e.call(t,i[a[s]],a[s])}function pw(i,e){let t,n,s,r;if(!i||!e||i.length!==e.length)return!1;for(t=0,n=i.length;t<n;++t)if(s=i[t],r=e[t],s.datasetIndex!==r.datasetIndex||s.index!==r.index)return!1;return!0}function mw(i){if(aa(i))return i.map(mw);if(Ri(i)){const e=Object.create(null),t=Object.keys(i),n=t.length;let s=0;for(;s<n;++s)e[t[s]]=mw(i[t[s]]);return e}return i}function o7(i){return["__proto__","prototype","constructor"].indexOf(i)===-1}function uge(i,e,t,n){if(!o7(i))return;const s=e[i],r=t[i];Ri(s)&&Ri(r)?cE(s,r,n):e[i]=mw(r)}function cE(i,e,t){const n=aa(e)?e:[e],s=n.length;if(!Ri(i))return i;t=t||{};const r=t.merger||uge;let a;for(let o=0;o<s;++o){if(a=n[o],!Ri(a))continue;const l=Object.keys(a);for(let c=0,h=l.length;c<h;++c)r(l[c],i,a,t)}return i}function EA(i,e){return cE(i,e,{merger:hge})}function hge(i,e,t){if(!o7(i))return;const n=e[i],s=t[i];Ri(n)&&Ri(s)?EA(n,s):Object.prototype.hasOwnProperty.call(e,i)||(e[i]=mw(s))}const u8={"":i=>i,x:i=>i.x,y:i=>i.y};function fge(i){const e=i.split("."),t=[];let n="";for(const s of e)n+=s,n.endsWith("\\")?n=n.slice(0,-1)+".":(t.push(n),n="");return t}function dge(i){const e=fge(i);return t=>{for(const n of e){if(n==="")break;t=t&&t[n]}return t}}function gw(i,e){return(u8[e]||(u8[e]=dge(e)))(i)}function GO(i){return i.charAt(0).toUpperCase()+i.slice(1)}const yw=i=>typeof i<"u",F0=i=>typeof i=="function",h8=(i,e)=>{if(i.size!==e.size)return!1;for(const t of i)if(!e.has(t))return!1;return!0};function pge(i){return i.type==="mouseup"||i.type==="click"||i.type==="contextmenu"}const Ba=Math.PI,dh=2*Ba,mge=dh+Ba,vw=Number.POSITIVE_INFINITY,gge=Ba/180,zc=Ba/2,Jp=Ba/4,f8=Ba*2/3,l7=Math.log10,Fv=Math.sign;function _A(i,e,t){return Math.abs(i-e)<t}function d8(i){const e=Math.round(i);i=_A(i,e,i/1e3)?e:i;const t=Math.pow(10,Math.floor(l7(i))),n=i/t;return(n<=1?1:n<=2?2:n<=5?5:10)*t}function yge(i){const e=[],t=Math.sqrt(i);let n;for(n=1;n<t;n++)i%n===0&&(e.push(n),e.push(i/n));return t===(t|0)&&e.push(t),e.sort((s,r)=>s-r).pop(),e}function vge(i){return typeof i=="symbol"||typeof i=="object"&&i!==null&&!(Symbol.toPrimitive in i||"toString"in i||"valueOf"in i)}function uE(i){return!vge(i)&&!isNaN(parseFloat(i))&&isFinite(i)}function xge(i,e){const t=Math.round(i);return t-e<=i&&t+e>=i}function bge(i,e,t){let n,s,r;for(n=0,s=i.length;n<s;n++)r=i[n][t],isNaN(r)||(e.min=Math.min(e.min,r),e.max=Math.max(e.max,r))}function Mm(i){return i*(Ba/180)}function Age(i){return i*(180/Ba)}function p8(i){if(!Hl(i))return;let e=1,t=0;for(;Math.round(i*e)/e!==i;)e*=10,t++;return t}function Ege(i,e){const t=e.x-i.x,n=e.y-i.y,s=Math.sqrt(t*t+n*n);let r=Math.atan2(n,t);return r<-.5*Ba&&(r+=dh),{angle:r,distance:s}}function xI(i,e){return Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2))}function _ge(i,e){return(i-e+mge)%dh-Ba}function t0(i){return(i%dh+dh)%dh}function c7(i,e,t,n){const s=t0(i),r=t0(e),a=t0(t),o=t0(r-s),l=t0(a-s),c=t0(s-r),h=t0(s-a);return s===r||s===a||n&&r===a||o>l&&c<h}function kl(i,e,t){return Math.max(e,Math.min(t,i))}function Sge(i){return kl(i,-32768,32767)}function nA(i,e,t,n=1e-6){return i>=Math.min(e,t)-n&&i<=Math.max(e,t)+n}function zO(i,e,t){t=t||(a=>i[a]<e);let n=i.length-1,s=0,r;for(;n-s>1;)r=s+n>>1,t(r)?s=r:n=r;return{lo:s,hi:n}}const Cm=(i,e,t,n)=>zO(i,t,n?s=>{const r=i[s][e];return r<t||r===t&&i[s+1][e]===t}:s=>i[s][e]<t),Tge=(i,e,t)=>zO(i,t,n=>i[n][e]>=t);function wge(i,e,t){let n=0,s=i.length;for(;n<s&&i[n]<e;)n++;for(;s>n&&i[s-1]>t;)s--;return n>0||s<i.length?i.slice(n,s):i}const u7=["push","pop","shift","splice","unshift"];function Mge(i,e){if(i._chartjs){i._chartjs.listeners.push(e);return}Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),u7.forEach(t=>{const n="_onData"+GO(t),s=i[t];Object.defineProperty(i,t,{configurable:!0,enumerable:!1,value(...r){const a=s.apply(this,r);return i._chartjs.listeners.forEach(o=>{typeof o[n]=="function"&&o[n](...r)}),a}})})}function m8(i,e){const t=i._chartjs;if(!t)return;const n=t.listeners,s=n.indexOf(e);s!==-1&&n.splice(s,1),!(n.length>0)&&(u7.forEach(r=>{delete i[r]}),delete i._chartjs)}function Cge(i){const e=new Set(i);return e.size===i.length?i:Array.from(e)}const h7=function(){return typeof window>"u"?function(i){return i()}:window.requestAnimationFrame}();function f7(i,e){let t=[],n=!1;return function(...s){t=s,n||(n=!0,h7.call(window,()=>{n=!1,i.apply(e,t)}))}}function Rge(i,e){let t;return function(...n){return e?(clearTimeout(t),t=setTimeout(i,e,n)):i.apply(this,n),e}}const d7=i=>i==="start"?"left":i==="end"?"right":"center",Xo=(i,e,t)=>i==="start"?e:i==="end"?t:(e+t)/2,Dge=(i,e,t,n)=>i===(n?"left":"right")?t:i==="center"?(e+t)/2:e;function Lge(i,e,t){const n=e.length;let s=0,r=n;if(i._sorted){const{iScale:a,vScale:o,_parsed:l}=i,c=i.dataset&&i.dataset.options?i.dataset.options.spanGaps:null,h=a.axis,{min:d,max:m,minDefined:y,maxDefined:x}=a.getUserBounds();if(y){if(s=Math.min(Cm(l,h,d).lo,t?n:Cm(e,h,a.getPixelForValue(d)).lo),c){const _=l.slice(0,s+1).reverse().findIndex(b=>!os(b[o.axis]));s-=Math.max(0,_)}s=kl(s,0,n-1)}if(x){let _=Math.max(Cm(l,a.axis,m,!0).hi+1,t?0:Cm(e,h,a.getPixelForValue(m),!0).hi+1);if(c){const b=l.slice(_-1).findIndex(A=>!os(A[o.axis]));_+=Math.max(0,b)}r=kl(_,s,n)-s}else r=n-s}return{start:s,count:r}}function Ige(i){const{xScale:e,yScale:t,_scaleRanges:n}=i,s={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!n)return i._scaleRanges=s,!0;const r=n.xmin!==e.min||n.xmax!==e.max||n.ymin!==t.min||n.ymax!==t.max;return Object.assign(n,s),r}const lT=i=>i===0||i===1,g8=(i,e,t)=>-(Math.pow(2,10*(i-=1))*Math.sin((i-e)*dh/t)),y8=(i,e,t)=>Math.pow(2,-10*i)*Math.sin((i-e)*dh/t)+1,SA={linear:i=>i,easeInQuad:i=>i*i,easeOutQuad:i=>-i*(i-2),easeInOutQuad:i=>(i/=.5)<1?.5*i*i:-.5*(--i*(i-2)-1),easeInCubic:i=>i*i*i,easeOutCubic:i=>(i-=1)*i*i+1,easeInOutCubic:i=>(i/=.5)<1?.5*i*i*i:.5*((i-=2)*i*i+2),easeInQuart:i=>i*i*i*i,easeOutQuart:i=>-((i-=1)*i*i*i-1),easeInOutQuart:i=>(i/=.5)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2),easeInQuint:i=>i*i*i*i*i,easeOutQuint:i=>(i-=1)*i*i*i*i+1,easeInOutQuint:i=>(i/=.5)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2),easeInSine:i=>-Math.cos(i*zc)+1,easeOutSine:i=>Math.sin(i*zc),easeInOutSine:i=>-.5*(Math.cos(Ba*i)-1),easeInExpo:i=>i===0?0:Math.pow(2,10*(i-1)),easeOutExpo:i=>i===1?1:-Math.pow(2,-10*i)+1,easeInOutExpo:i=>lT(i)?i:i<.5?.5*Math.pow(2,10*(i*2-1)):.5*(-Math.pow(2,-10*(i*2-1))+2),easeInCirc:i=>i>=1?i:-(Math.sqrt(1-i*i)-1),easeOutCirc:i=>Math.sqrt(1-(i-=1)*i),easeInOutCirc:i=>(i/=.5)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1),easeInElastic:i=>lT(i)?i:g8(i,.075,.3),easeOutElastic:i=>lT(i)?i:y8(i,.075,.3),easeInOutElastic(i){return lT(i)?i:i<.5?.5*g8(i*2,.1125,.45):.5+.5*y8(i*2-1,.1125,.45)},easeInBack(i){return i*i*((1.70158+1)*i-1.70158)},easeOutBack(i){return(i-=1)*i*((1.70158+1)*i+1.70158)+1},easeInOutBack(i){let e=1.70158;return(i/=.5)<1?.5*(i*i*(((e*=1.525)+1)*i-e)):.5*((i-=2)*i*(((e*=1.525)+1)*i+e)+2)},easeInBounce:i=>1-SA.easeOutBounce(1-i),easeOutBounce(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},easeInOutBounce:i=>i<.5?SA.easeInBounce(i*2)*.5:SA.easeOutBounce(i*2-1)*.5+.5};function VO(i){if(i&&typeof i=="object"){const e=i.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function v8(i){return VO(i)?i:new lE(i)}function RD(i){return VO(i)?i:new lE(i).saturate(.5).darken(.1).hexString()}const Bge=["x","y","borderWidth","radius","tension"],Oge=["color","borderColor","backgroundColor"];function Pge(i){i.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),i.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),i.set("animations",{colors:{type:"color",properties:Oge},numbers:{type:"number",properties:Bge}}),i.describe("animations",{_fallback:"animation"}),i.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Nge(i){i.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const x8=new Map;function Uge(i,e){e=e||{};const t=i+JSON.stringify(e);let n=x8.get(t);return n||(n=new Intl.NumberFormat(i,e),x8.set(t,n)),n}function p7(i,e,t){return Uge(e,t).format(i)}const kge={values(i){return aa(i)?i:""+i},numeric(i,e,t){if(i===0)return"0";const n=this.chart.options.locale;let s,r=i;if(t.length>1){const c=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(c<1e-4||c>1e15)&&(s="scientific"),r=Fge(i,t)}const a=l7(Math.abs(r)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:s,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),p7(i,n,l)}};function Fge(i,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&i!==Math.floor(i)&&(t=i-Math.floor(i)),t}var m7={formatters:kge};function Hge(i){i.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:m7.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),i.route("scale.ticks","color","","color"),i.route("scale.grid","color","","borderColor"),i.route("scale.border","color","","borderColor"),i.route("scale.title","color","","color"),i.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),i.describe("scales",{_fallback:"scale"}),i.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const bg=Object.create(null),bI=Object.create(null);function TA(i,e){if(!e)return i;const t=e.split(".");for(let n=0,s=t.length;n<s;++n){const r=t[n];i=i[r]||(i[r]=Object.create(null))}return i}function DD(i,e,t){return typeof e=="string"?cE(TA(i,e),t):cE(TA(i,""),e)}class Gge{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,s)=>RD(s.backgroundColor),this.hoverBorderColor=(n,s)=>RD(s.borderColor),this.hoverColor=(n,s)=>RD(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return DD(this,e,t)}get(e){return TA(this,e)}describe(e,t){return DD(bI,e,t)}override(e,t){return DD(bg,e,t)}route(e,t,n,s){const r=TA(this,e),a=TA(this,n),o="_"+t;Object.defineProperties(r,{[o]:{value:r[t],writable:!0},[t]:{enumerable:!0,get(){const l=this[o],c=a[s];return Ri(l)?Object.assign({},c,l):pi(l,c)},set(l){this[o]=l}}})}apply(e){e.forEach(t=>t(this))}}var ar=new Gge({_scriptable:i=>!i.startsWith("on"),_indexable:i=>i!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Pge,Nge,Hge]);function zge(i){return!i||os(i.size)||os(i.family)?null:(i.style?i.style+" ":"")+(i.weight?i.weight+" ":"")+i.size+"px "+i.family}function b8(i,e,t,n,s){let r=e[s];return r||(r=e[s]=i.measureText(s).width,t.push(s)),r>n&&(n=r),n}function Zp(i,e,t){const n=i.currentDevicePixelRatio,s=t!==0?Math.max(t/2,.5):0;return Math.round((e-s)*n)/n+s}function A8(i,e){!e&&!i||(e=e||i.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,i.width,i.height),e.restore())}function AI(i,e,t,n){g7(i,e,t,n,null)}function g7(i,e,t,n,s){let r,a,o,l,c,h,d,m;const y=e.pointStyle,x=e.rotation,_=e.radius;let b=(x||0)*gge;if(y&&typeof y=="object"&&(r=y.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){i.save(),i.translate(t,n),i.rotate(b),i.drawImage(y,-y.width/2,-y.height/2,y.width,y.height),i.restore();return}if(!(isNaN(_)||_<=0)){switch(i.beginPath(),y){default:s?i.ellipse(t,n,s/2,_,0,0,dh):i.arc(t,n,_,0,dh),i.closePath();break;case"triangle":h=s?s/2:_,i.moveTo(t+Math.sin(b)*h,n-Math.cos(b)*_),b+=f8,i.lineTo(t+Math.sin(b)*h,n-Math.cos(b)*_),b+=f8,i.lineTo(t+Math.sin(b)*h,n-Math.cos(b)*_),i.closePath();break;case"rectRounded":c=_*.516,l=_-c,a=Math.cos(b+Jp)*l,d=Math.cos(b+Jp)*(s?s/2-c:l),o=Math.sin(b+Jp)*l,m=Math.sin(b+Jp)*(s?s/2-c:l),i.arc(t-d,n-o,c,b-Ba,b-zc),i.arc(t+m,n-a,c,b-zc,b),i.arc(t+d,n+o,c,b,b+zc),i.arc(t-m,n+a,c,b+zc,b+Ba),i.closePath();break;case"rect":if(!x){l=Math.SQRT1_2*_,h=s?s/2:l,i.rect(t-h,n-l,2*h,2*l);break}b+=Jp;case"rectRot":d=Math.cos(b)*(s?s/2:_),a=Math.cos(b)*_,o=Math.sin(b)*_,m=Math.sin(b)*(s?s/2:_),i.moveTo(t-d,n-o),i.lineTo(t+m,n-a),i.lineTo(t+d,n+o),i.lineTo(t-m,n+a),i.closePath();break;case"crossRot":b+=Jp;case"cross":d=Math.cos(b)*(s?s/2:_),a=Math.cos(b)*_,o=Math.sin(b)*_,m=Math.sin(b)*(s?s/2:_),i.moveTo(t-d,n-o),i.lineTo(t+d,n+o),i.moveTo(t+m,n-a),i.lineTo(t-m,n+a);break;case"star":d=Math.cos(b)*(s?s/2:_),a=Math.cos(b)*_,o=Math.sin(b)*_,m=Math.sin(b)*(s?s/2:_),i.moveTo(t-d,n-o),i.lineTo(t+d,n+o),i.moveTo(t+m,n-a),i.lineTo(t-m,n+a),b+=Jp,d=Math.cos(b)*(s?s/2:_),a=Math.cos(b)*_,o=Math.sin(b)*_,m=Math.sin(b)*(s?s/2:_),i.moveTo(t-d,n-o),i.lineTo(t+d,n+o),i.moveTo(t+m,n-a),i.lineTo(t-m,n+a);break;case"line":a=s?s/2:Math.cos(b)*_,o=Math.sin(b)*_,i.moveTo(t-a,n-o),i.lineTo(t+a,n+o);break;case"dash":i.moveTo(t,n),i.lineTo(t+Math.cos(b)*(s?s/2:_),n+Math.sin(b)*_);break;case!1:i.closePath();break}i.fill(),e.borderWidth>0&&i.stroke()}}function hE(i,e,t){return t=t||.5,!e||i&&i.x>e.left-t&&i.x<e.right+t&&i.y>e.top-t&&i.y<e.bottom+t}function YO(i,e){i.save(),i.beginPath(),i.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),i.clip()}function KO(i){i.restore()}function Vge(i,e,t,n,s){if(!e)return i.lineTo(t.x,t.y);if(s==="middle"){const r=(e.x+t.x)/2;i.lineTo(r,e.y),i.lineTo(r,t.y)}else s==="after"!=!!n?i.lineTo(e.x,t.y):i.lineTo(t.x,e.y);i.lineTo(t.x,t.y)}function Yge(i,e,t,n){if(!e)return i.lineTo(t.x,t.y);i.bezierCurveTo(n?e.cp1x:e.cp2x,n?e.cp1y:e.cp2y,n?t.cp2x:t.cp1x,n?t.cp2y:t.cp1y,t.x,t.y)}function Kge(i,e){e.translation&&i.translate(e.translation[0],e.translation[1]),os(e.rotation)||i.rotate(e.rotation),e.color&&(i.fillStyle=e.color),e.textAlign&&(i.textAlign=e.textAlign),e.textBaseline&&(i.textBaseline=e.textBaseline)}function Wge(i,e,t,n,s){if(s.strikethrough||s.underline){const r=i.measureText(n),a=e-r.actualBoundingBoxLeft,o=e+r.actualBoundingBoxRight,l=t-r.actualBoundingBoxAscent,c=t+r.actualBoundingBoxDescent,h=s.strikethrough?(l+c)/2:c;i.strokeStyle=i.fillStyle,i.beginPath(),i.lineWidth=s.decorationWidth||2,i.moveTo(a,h),i.lineTo(o,h),i.stroke()}}function Xge(i,e){const t=i.fillStyle;i.fillStyle=e.color,i.fillRect(e.left,e.top,e.width,e.height),i.fillStyle=t}function xw(i,e,t,n,s,r={}){const a=aa(e)?e:[e],o=r.strokeWidth>0&&r.strokeColor!=="";let l,c;for(i.save(),i.font=s.string,Kge(i,r),l=0;l<a.length;++l)c=a[l],r.backdrop&&Xge(i,r.backdrop),o&&(r.strokeColor&&(i.strokeStyle=r.strokeColor),os(r.strokeWidth)||(i.lineWidth=r.strokeWidth),i.strokeText(c,t,n,r.maxWidth)),i.fillText(c,t,n,r.maxWidth),Wge(i,t,n,c,r),n+=Number(s.lineHeight);i.restore()}function EI(i,e){const{x:t,y:n,w:s,h:r,radius:a}=e;i.arc(t+a.topLeft,n+a.topLeft,a.topLeft,1.5*Ba,Ba,!0),i.lineTo(t,n+r-a.bottomLeft),i.arc(t+a.bottomLeft,n+r-a.bottomLeft,a.bottomLeft,Ba,zc,!0),i.lineTo(t+s-a.bottomRight,n+r),i.arc(t+s-a.bottomRight,n+r-a.bottomRight,a.bottomRight,zc,0,!0),i.lineTo(t+s,n+a.topRight),i.arc(t+s-a.topRight,n+a.topRight,a.topRight,0,-zc,!0),i.lineTo(t+a.topLeft,n)}const jge=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,qge=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Qge(i,e){const t=(""+i).match(jge);if(!t||t[1]==="normal")return e*1.2;switch(i=+t[2],t[3]){case"px":return i;case"%":i/=100;break}return e*i}const $ge=i=>+i||0;function y7(i,e){const t={},n=Ri(e),s=n?Object.keys(e):e,r=Ri(i)?n?a=>pi(i[a],i[e[a]]):a=>i[a]:()=>i;for(const a of s)t[a]=$ge(r(a));return t}function Jge(i){return y7(i,{top:"y",right:"x",bottom:"y",left:"x"})}function wA(i){return y7(i,["topLeft","topRight","bottomLeft","bottomRight"])}function $c(i){const e=Jge(i);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Ro(i,e){i=i||{},e=e||ar.font;let t=pi(i.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let n=pi(i.style,e.style);n&&!(""+n).match(qge)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const s={family:pi(i.family,e.family),lineHeight:Qge(pi(i.lineHeight,e.lineHeight),t),size:t,style:n,weight:pi(i.weight,e.weight),string:""};return s.string=zge(s),s}function cT(i,e,t,n){let s,r,a;for(s=0,r=i.length;s<r;++s)if(a=i[s],a!==void 0&&a!==void 0)return a}function Zge(i,e,t){const{min:n,max:s}=i,r=cge(e,(s-n)/2),a=(o,l)=>t&&o===0?0:o+l;return{min:a(n,-Math.abs(r)),max:a(s,r)}}function Rg(i,e){return Object.assign(Object.create(i),e)}function WO(i,e=[""],t,n,s=()=>i[0]){const r=t||i;typeof n>"u"&&(n=A7("_fallback",i));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:i,_rootScopes:r,_fallback:n,_getTarget:s,override:o=>WO([o,...i],e,r,n)};return new Proxy(a,{deleteProperty(o,l){return delete o[l],delete o._keys,delete i[0][l],!0},get(o,l){return x7(o,l,()=>o2e(l,e,i,o))},getOwnPropertyDescriptor(o,l){return Reflect.getOwnPropertyDescriptor(o._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(i[0])},has(o,l){return _8(o).includes(l)},ownKeys(o){return _8(o)},set(o,l,c){const h=o._storage||(o._storage=s());return o[l]=h[l]=c,delete o._keys,!0}})}function Hv(i,e,t,n){const s={_cacheable:!1,_proxy:i,_context:e,_subProxy:t,_stack:new Set,_descriptors:v7(i,n),setContext:r=>Hv(i,r,t,n),override:r=>Hv(i.override(r),e,t,n)};return new Proxy(s,{deleteProperty(r,a){return delete r[a],delete i[a],!0},get(r,a,o){return x7(r,a,()=>t2e(r,a,o))},getOwnPropertyDescriptor(r,a){return r._descriptors.allKeys?Reflect.has(i,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(i,a)},getPrototypeOf(){return Reflect.getPrototypeOf(i)},has(r,a){return Reflect.has(i,a)},ownKeys(){return Reflect.ownKeys(i)},set(r,a,o){return i[a]=o,delete r[a],!0}})}function v7(i,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:n=e.indexable,_allKeys:s=e.allKeys}=i;return{allKeys:s,scriptable:t,indexable:n,isScriptable:F0(t)?t:()=>t,isIndexable:F0(n)?n:()=>n}}const e2e=(i,e)=>i?i+GO(e):e,XO=(i,e)=>Ri(e)&&i!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function x7(i,e,t){if(Object.prototype.hasOwnProperty.call(i,e)||e==="constructor")return i[e];const n=t();return i[e]=n,n}function t2e(i,e,t){const{_proxy:n,_context:s,_subProxy:r,_descriptors:a}=i;let o=n[e];return F0(o)&&a.isScriptable(e)&&(o=n2e(e,o,i,t)),aa(o)&&o.length&&(o=i2e(e,o,i,a.isIndexable)),XO(e,o)&&(o=Hv(o,s,r&&r[e],a)),o}function n2e(i,e,t,n){const{_proxy:s,_context:r,_subProxy:a,_stack:o}=t;if(o.has(i))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+i);o.add(i);let l=e(r,a||n);return o.delete(i),XO(i,l)&&(l=jO(s._scopes,s,i,l)),l}function i2e(i,e,t,n){const{_proxy:s,_context:r,_subProxy:a,_descriptors:o}=t;if(typeof r.index<"u"&&n(i))return e[r.index%e.length];if(Ri(e[0])){const l=e,c=s._scopes.filter(h=>h!==l);e=[];for(const h of l){const d=jO(c,s,i,h);e.push(Hv(d,r,a&&a[i],o))}}return e}function b7(i,e,t){return F0(i)?i(e,t):i}const s2e=(i,e)=>i===!0?e:typeof i=="string"?gw(e,i):void 0;function r2e(i,e,t,n,s){for(const r of e){const a=s2e(t,r);if(a){i.add(a);const o=b7(a._fallback,t,s);if(typeof o<"u"&&o!==t&&o!==n)return o}else if(a===!1&&typeof n<"u"&&t!==n)return null}return!1}function jO(i,e,t,n){const s=e._rootScopes,r=b7(e._fallback,t,n),a=[...i,...s],o=new Set;o.add(n);let l=E8(o,a,t,r||t,n);return l===null||typeof r<"u"&&r!==t&&(l=E8(o,a,r,l,n),l===null)?!1:WO(Array.from(o),[""],s,r,()=>a2e(e,t,n))}function E8(i,e,t,n,s){for(;t;)t=r2e(i,e,t,n,s);return t}function a2e(i,e,t){const n=i._getTarget();e in n||(n[e]={});const s=n[e];return aa(s)&&Ri(t)?t:s||{}}function o2e(i,e,t,n){let s;for(const r of e)if(s=A7(e2e(r,i),t),typeof s<"u")return XO(i,s)?jO(t,n,i,s):s}function A7(i,e){for(const t of e){if(!t)continue;const n=t[i];if(typeof n<"u")return n}}function _8(i){let e=i._keys;return e||(e=i._keys=l2e(i._scopes)),e}function l2e(i){const e=new Set;for(const t of i)for(const n of Object.keys(t).filter(s=>!s.startsWith("_")))e.add(n);return Array.from(e)}const c2e=Number.EPSILON||1e-14,Gv=(i,e)=>e<i.length&&!i[e].skip&&i[e],E7=i=>i==="x"?"y":"x";function u2e(i,e,t,n){const s=i.skip?e:i,r=e,a=t.skip?e:t,o=xI(r,s),l=xI(a,r);let c=o/(o+l),h=l/(o+l);c=isNaN(c)?0:c,h=isNaN(h)?0:h;const d=n*c,m=n*h;return{previous:{x:r.x-d*(a.x-s.x),y:r.y-d*(a.y-s.y)},next:{x:r.x+m*(a.x-s.x),y:r.y+m*(a.y-s.y)}}}function h2e(i,e,t){const n=i.length;let s,r,a,o,l,c=Gv(i,0);for(let h=0;h<n-1;++h)if(l=c,c=Gv(i,h+1),!(!l||!c)){if(_A(e[h],0,c2e)){t[h]=t[h+1]=0;continue}s=t[h]/e[h],r=t[h+1]/e[h],o=Math.pow(s,2)+Math.pow(r,2),!(o<=9)&&(a=3/Math.sqrt(o),t[h]=s*a*e[h],t[h+1]=r*a*e[h])}}function f2e(i,e,t="x"){const n=E7(t),s=i.length;let r,a,o,l=Gv(i,0);for(let c=0;c<s;++c){if(a=o,o=l,l=Gv(i,c+1),!o)continue;const h=o[t],d=o[n];a&&(r=(h-a[t])/3,o[`cp1${t}`]=h-r,o[`cp1${n}`]=d-r*e[c]),l&&(r=(l[t]-h)/3,o[`cp2${t}`]=h+r,o[`cp2${n}`]=d+r*e[c])}}function d2e(i,e="x"){const t=E7(e),n=i.length,s=Array(n).fill(0),r=Array(n);let a,o,l,c=Gv(i,0);for(a=0;a<n;++a)if(o=l,l=c,c=Gv(i,a+1),!!l){if(c){const h=c[e]-l[e];s[a]=h!==0?(c[t]-l[t])/h:0}r[a]=o?c?Fv(s[a-1])!==Fv(s[a])?0:(s[a-1]+s[a])/2:s[a-1]:s[a]}h2e(i,s,r),f2e(i,r,e)}function uT(i,e,t){return Math.max(Math.min(i,t),e)}function p2e(i,e){let t,n,s,r,a,o=hE(i[0],e);for(t=0,n=i.length;t<n;++t)a=r,r=o,o=t<n-1&&hE(i[t+1],e),r&&(s=i[t],a&&(s.cp1x=uT(s.cp1x,e.left,e.right),s.cp1y=uT(s.cp1y,e.top,e.bottom)),o&&(s.cp2x=uT(s.cp2x,e.left,e.right),s.cp2y=uT(s.cp2y,e.top,e.bottom)))}function m2e(i,e,t,n,s){let r,a,o,l;if(e.spanGaps&&(i=i.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")d2e(i,s);else{let c=n?i[i.length-1]:i[0];for(r=0,a=i.length;r<a;++r)o=i[r],l=u2e(c,o,i[Math.min(r+1,a-(n?0:1))%a],e.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,c=o}e.capBezierPoints&&p2e(i,t)}function qO(){return typeof window<"u"&&typeof document<"u"}function QO(i){let e=i.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function bw(i,e,t){let n;return typeof i=="string"?(n=parseInt(i,10),i.indexOf("%")!==-1&&(n=n/100*e.parentNode[t])):n=i,n}const IM=i=>i.ownerDocument.defaultView.getComputedStyle(i,null);function g2e(i,e){return IM(i).getPropertyValue(e)}const y2e=["top","right","bottom","left"];function ng(i,e,t){const n={};t=t?"-"+t:"";for(let s=0;s<4;s++){const r=y2e[s];n[r]=parseFloat(i[e+"-"+r+t])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const v2e=(i,e,t)=>(i>0||e>0)&&(!t||!t.shadowRoot);function x2e(i,e){const t=i.touches,n=t&&t.length?t[0]:i,{offsetX:s,offsetY:r}=n;let a=!1,o,l;if(v2e(s,r,i.target))o=s,l=r;else{const c=e.getBoundingClientRect();o=n.clientX-c.left,l=n.clientY-c.top,a=!0}return{x:o,y:l,box:a}}function lm(i,e){if("native"in i)return i;const{canvas:t,currentDevicePixelRatio:n}=e,s=IM(t),r=s.boxSizing==="border-box",a=ng(s,"padding"),o=ng(s,"border","width"),{x:l,y:c,box:h}=x2e(i,t),d=a.left+(h&&o.left),m=a.top+(h&&o.top);let{width:y,height:x}=e;return r&&(y-=a.width+o.width,x-=a.height+o.height),{x:Math.round((l-d)/y*t.width/n),y:Math.round((c-m)/x*t.height/n)}}function b2e(i,e,t){let n,s;if(e===void 0||t===void 0){const r=i&&QO(i);if(!r)e=i.clientWidth,t=i.clientHeight;else{const a=r.getBoundingClientRect(),o=IM(r),l=ng(o,"border","width"),c=ng(o,"padding");e=a.width-c.width-l.width,t=a.height-c.height-l.height,n=bw(o.maxWidth,r,"clientWidth"),s=bw(o.maxHeight,r,"clientHeight")}}return{width:e,height:t,maxWidth:n||vw,maxHeight:s||vw}}const hT=i=>Math.round(i*10)/10;function A2e(i,e,t,n){const s=IM(i),r=ng(s,"margin"),a=bw(s.maxWidth,i,"clientWidth")||vw,o=bw(s.maxHeight,i,"clientHeight")||vw,l=b2e(i,e,t);let{width:c,height:h}=l;if(s.boxSizing==="content-box"){const m=ng(s,"border","width"),y=ng(s,"padding");c-=y.width+m.width,h-=y.height+m.height}return c=Math.max(0,c-r.width),h=Math.max(0,n?c/n:h-r.height),c=hT(Math.min(c,a,l.maxWidth)),h=hT(Math.min(h,o,l.maxHeight)),c&&!h&&(h=hT(c/2)),(e!==void 0||t!==void 0)&&n&&l.height&&h>l.height&&(h=l.height,c=hT(Math.floor(h*n))),{width:c,height:h}}function S8(i,e,t){const n=e||1,s=Math.floor(i.height*n),r=Math.floor(i.width*n);i.height=Math.floor(i.height),i.width=Math.floor(i.width);const a=i.canvas;return a.style&&(t||!a.style.height&&!a.style.width)&&(a.style.height=`${i.height}px`,a.style.width=`${i.width}px`),i.currentDevicePixelRatio!==n||a.height!==s||a.width!==r?(i.currentDevicePixelRatio=n,a.height=s,a.width=r,i.ctx.setTransform(n,0,0,n,0,0),!0):!1}const E2e=function(){let i=!1;try{const e={get passive(){return i=!0,!1}};qO()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return i}();function T8(i,e){const t=g2e(i,e),n=t&&t.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function cm(i,e,t,n){return{x:i.x+t*(e.x-i.x),y:i.y+t*(e.y-i.y)}}function _2e(i,e,t,n){return{x:i.x+t*(e.x-i.x),y:n==="middle"?t<.5?i.y:e.y:n==="after"?t<1?i.y:e.y:t>0?e.y:i.y}}function S2e(i,e,t,n){const s={x:i.cp2x,y:i.cp2y},r={x:e.cp1x,y:e.cp1y},a=cm(i,s,t),o=cm(s,r,t),l=cm(r,e,t),c=cm(a,o,t),h=cm(o,l,t);return cm(c,h,t)}const T2e=function(i,e){return{x(t){return i+i+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,n){return t-n},leftForLtr(t,n){return t-n}}},w2e=function(){return{x(i){return i},setWidth(i){},textAlign(i){return i},xPlus(i,e){return i+e},leftForLtr(i,e){return i}}};function Ry(i,e,t){return i?T2e(e,t):w2e()}function _7(i,e){let t,n;(e==="ltr"||e==="rtl")&&(t=i.canvas.style,n=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),i.prevTextDirection=n)}function S7(i,e){e!==void 0&&(delete i.prevTextDirection,i.canvas.style.setProperty("direction",e[0],e[1]))}function T7(i){return i==="angle"?{between:c7,compare:_ge,normalize:t0}:{between:nA,compare:(e,t)=>e-t,normalize:e=>e}}function w8({start:i,end:e,count:t,loop:n,style:s}){return{start:i%t,end:e%t,loop:n&&(e-i+1)%t===0,style:s}}function M2e(i,e,t){const{property:n,start:s,end:r}=t,{between:a,normalize:o}=T7(n),l=e.length;let{start:c,end:h,loop:d}=i,m,y;if(d){for(c+=l,h+=l,m=0,y=l;m<y&&a(o(e[c%l][n]),s,r);++m)c--,h--;c%=l,h%=l}return h<c&&(h+=l),{start:c,end:h,loop:d,style:i.style}}function C2e(i,e,t){if(!t)return[i];const{property:n,start:s,end:r}=t,a=e.length,{compare:o,between:l,normalize:c}=T7(n),{start:h,end:d,loop:m,style:y}=M2e(i,e,t),x=[];let _=!1,b=null,A,T,w;const R=()=>l(s,w,A)&&o(s,w)!==0,O=()=>o(r,A)===0||l(r,w,A),N=()=>_||R(),U=()=>!_||O();for(let P=h,B=h;P<=d;++P)T=e[P%a],!T.skip&&(A=c(T[n]),A!==w&&(_=l(A,s,r),b===null&&N()&&(b=o(A,s)===0?P:B),b!==null&&U()&&(x.push(w8({start:b,end:P,loop:m,count:a,style:y})),b=null),B=P,w=A));return b!==null&&x.push(w8({start:b,end:d,loop:m,count:a,style:y})),x}function R2e(i,e){const t=[],n=i.segments;for(let s=0;s<n.length;s++){const r=C2e(n[s],i.points,e);r.length&&t.push(...r)}return t}function D2e(i,e,t,n){let s=0,r=e-1;if(t&&!n)for(;s<e&&!i[s].skip;)s++;for(;s<e&&i[s].skip;)s++;for(s%=e,t&&(r+=s);r>s&&i[r%e].skip;)r--;return r%=e,{start:s,end:r}}function L2e(i,e,t,n){const s=i.length,r=[];let a=e,o=i[e],l;for(l=e+1;l<=t;++l){const c=i[l%s];c.skip||c.stop?o.skip||(n=!1,r.push({start:e%s,end:(l-1)%s,loop:n}),e=a=c.stop?l:null):(a=l,o.skip&&(e=l)),o=c}return a!==null&&r.push({start:e%s,end:a%s,loop:n}),r}function I2e(i,e){const t=i.points,n=i.options.spanGaps,s=t.length;if(!s)return[];const r=!!i._loop,{start:a,end:o}=D2e(t,s,r,n);if(n===!0)return M8(i,[{start:a,end:o,loop:r}],t,e);const l=o<a?o+s:o,c=!!i._fullLoop&&a===0&&o===s-1;return M8(i,L2e(t,a,l,c),t,e)}function M8(i,e,t,n){return!n||!n.setContext||!t?e:B2e(i,e,t,n)}function B2e(i,e,t,n){const s=i._chart.getContext(),r=C8(i.options),{_datasetIndex:a,options:{spanGaps:o}}=i,l=t.length,c=[];let h=r,d=e[0].start,m=d;function y(x,_,b,A){const T=o?-1:1;if(x!==_){for(x+=l;t[x%l].skip;)x-=T;for(;t[_%l].skip;)_+=T;x%l!==_%l&&(c.push({start:x%l,end:_%l,loop:b,style:A}),h=A,d=_%l)}}for(const x of e){d=o?d:x.start;let _=t[d%l],b;for(m=d+1;m<=x.end;m++){const A=t[m%l];b=C8(n.setContext(Rg(s,{type:"segment",p0:_,p1:A,p0DataIndex:(m-1)%l,p1DataIndex:m%l,datasetIndex:a}))),O2e(b,h)&&y(d,m-1,x.loop,h),_=A,h=b}d<m-1&&y(d,m-1,x.loop,h)}return c}function C8(i){return{backgroundColor:i.backgroundColor,borderCapStyle:i.borderCapStyle,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderJoinStyle:i.borderJoinStyle,borderWidth:i.borderWidth,borderColor:i.borderColor}}function O2e(i,e){if(!e)return!1;const t=[],n=function(s,r){return VO(r)?(t.includes(r)||t.push(r),t.indexOf(r)):r};return JSON.stringify(i,n)!==JSON.stringify(e,n)}function fT(i,e,t){return i.options.clip?i[t]:e[t]}function P2e(i,e){const{xScale:t,yScale:n}=i;return t&&n?{left:fT(t,e,"left"),right:fT(t,e,"right"),top:fT(n,e,"top"),bottom:fT(n,e,"bottom")}:e}function N2e(i,e){const t=e._clip;if(t.disabled)return!1;const n=P2e(e,i.chartArea);return{left:t.left===!1?0:n.left-(t.left===!0?0:t.left),right:t.right===!1?i.width:n.right+(t.right===!0?0:t.right),top:t.top===!1?0:n.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?i.height:n.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class U2e{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,s){const r=t.listeners[s],a=t.duration;r.forEach(o=>o({chart:e,initial:t.initial,numSteps:a,currentStep:Math.min(n-t.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=h7.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((n,s)=>{if(!n.running||!n.items.length)return;const r=n.items;let a=r.length-1,o=!1,l;for(;a>=0;--a)l=r[a],l._active?(l._total>n.duration&&(n.duration=l._total),l.tick(e),o=!0):(r[a]=r[r.length-1],r.pop());o&&(s.draw(),this._notify(s,n,e,"progress")),r.length||(n.running=!1,this._notify(s,n,e,"complete"),n.initial=!1),t+=r.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((n,s)=>Math.max(n,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let s=n.length-1;for(;s>=0;--s)n[s].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var af=new U2e;const R8="transparent",k2e={boolean(i,e,t){return t>.5?e:i},color(i,e,t){const n=v8(i||R8),s=n.valid&&v8(e||R8);return s&&s.valid?s.mix(n,t).hexString():e},number(i,e,t){return i+(e-i)*t}};class F2e{constructor(e,t,n,s){const r=t[n];s=cT([e.to,s,r,e.from]);const a=cT([e.from,r,s]);this._active=!0,this._fn=e.fn||k2e[e.type||typeof a],this._easing=SA[e.easing]||SA.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=a,this._to=s,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const s=this._target[this._prop],r=n-this._start,a=this._duration-r;this._start=n,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=r,this._loop=!!e.loop,this._to=cT([e.to,t,s,e.from]),this._from=cT([e.from,s,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,s=this._prop,r=this._from,a=this._loop,o=this._to;let l;if(this._active=r!==o&&(a||t<n),!this._active){this._target[s]=o,this._notify(!0);return}if(t<0){this._target[s]=r;return}l=t/n%2,l=a&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[s]=this._fn(r,o,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,n)=>{e.push({res:t,rej:n})})}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let s=0;s<n.length;s++)n[s][t]()}}class w7{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Ri(e))return;const t=Object.keys(ar.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const r=e[s];if(!Ri(r))return;const a={};for(const o of t)a[o]=r[o];(aa(r.properties)&&r.properties||[s]).forEach(o=>{(o===s||!n.has(o))&&n.set(o,a)})})}_animateOptions(e,t){const n=t.options,s=G2e(e,n);if(!s)return[];const r=this._createAnimations(s,n);return n.$shared&&H2e(e.options.$animations,n).then(()=>{e.options=n},()=>{}),r}_createAnimations(e,t){const n=this._properties,s=[],r=e.$animations||(e.$animations={}),a=Object.keys(t),o=Date.now();let l;for(l=a.length-1;l>=0;--l){const c=a[l];if(c.charAt(0)==="$")continue;if(c==="options"){s.push(...this._animateOptions(e,t));continue}const h=t[c];let d=r[c];const m=n.get(c);if(d)if(m&&d.active()){d.update(m,h,o);continue}else d.cancel();if(!m||!m.duration){e[c]=h;continue}r[c]=d=new F2e(m,e,c,h),s.push(d)}return s}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const n=this._createAnimations(e,t);if(n.length)return af.add(this._chart,n),!0}}function H2e(i,e){const t=[],n=Object.keys(e);for(let s=0;s<n.length;s++){const r=i[n[s]];r&&r.active()&&t.push(r.wait())}return Promise.all(t)}function G2e(i,e){if(!e)return;let t=i.options;if(!t){i.options=e;return}return t.$shared&&(i.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function D8(i,e){const t=i&&i.options||{},n=t.reverse,s=t.min===void 0?e:0,r=t.max===void 0?e:0;return{start:n?r:s,end:n?s:r}}function z2e(i,e,t){if(t===!1)return!1;const n=D8(i,t),s=D8(e,t);return{top:s.end,right:n.end,bottom:s.start,left:n.start}}function V2e(i){let e,t,n,s;return Ri(i)?(e=i.top,t=i.right,n=i.bottom,s=i.left):e=t=n=s=i,{top:e,right:t,bottom:n,left:s,disabled:i===!1}}function M7(i,e){const t=[],n=i._getSortedDatasetMetas(e);let s,r;for(s=0,r=n.length;s<r;++s)t.push(n[s].index);return t}function L8(i,e,t,n={}){const s=i.keys,r=n.mode==="single";let a,o,l,c;if(e===null)return;let h=!1;for(a=0,o=s.length;a<o;++a){if(l=+s[a],l===t){if(h=!0,n.all)continue;break}c=i.values[l],Hl(c)&&(r||e===0||Fv(e)===Fv(c))&&(e+=c)}return!h&&!n.all?0:e}function Y2e(i,e){const{iScale:t,vScale:n}=e,s=t.axis==="x"?"x":"y",r=n.axis==="x"?"x":"y",a=Object.keys(i),o=new Array(a.length);let l,c,h;for(l=0,c=a.length;l<c;++l)h=a[l],o[l]={[s]:h,[r]:i[h]};return o}function LD(i,e){const t=i&&i.options.stacked;return t||t===void 0&&e.stack!==void 0}function K2e(i,e,t){return`${i.id}.${e.id}.${t.stack||t.type}`}function W2e(i){const{min:e,max:t,minDefined:n,maxDefined:s}=i.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:s?t:Number.POSITIVE_INFINITY}}function X2e(i,e,t){const n=i[e]||(i[e]={});return n[t]||(n[t]={})}function I8(i,e,t,n){for(const s of e.getMatchingVisibleMetas(n).reverse()){const r=i[s.index];if(t&&r>0||!t&&r<0)return s.index}return null}function B8(i,e){const{chart:t,_cachedMeta:n}=i,s=t._stacks||(t._stacks={}),{iScale:r,vScale:a,index:o}=n,l=r.axis,c=a.axis,h=K2e(r,a,n),d=e.length;let m;for(let y=0;y<d;++y){const x=e[y],{[l]:_,[c]:b}=x,A=x._stacks||(x._stacks={});m=A[c]=X2e(s,h,_),m[o]=b,m._top=I8(m,a,!0,n.type),m._bottom=I8(m,a,!1,n.type);const T=m._visualValues||(m._visualValues={});T[o]=b}}function ID(i,e){const t=i.scales;return Object.keys(t).filter(n=>t[n].axis===e).shift()}function j2e(i,e){return Rg(i,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function q2e(i,e,t){return Rg(i,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function kb(i,e){const t=i.controller.index,n=i.vScale&&i.vScale.axis;if(n){e=e||i._parsed;for(const s of e){const r=s._stacks;if(!r||r[n]===void 0||r[n][t]===void 0)return;delete r[n][t],r[n]._visualValues!==void 0&&r[n]._visualValues[t]!==void 0&&delete r[n]._visualValues[t]}}}const BD=i=>i==="reset"||i==="none",O8=(i,e)=>e?i:Object.assign({},i),Q2e=(i,e,t)=>i&&!e.hidden&&e._stacked&&{keys:M7(t,!0),values:null};class MA{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=LD(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&kb(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),s=(d,m,y,x)=>d==="x"?m:d==="r"?x:y,r=t.xAxisID=pi(n.xAxisID,ID(e,"x")),a=t.yAxisID=pi(n.yAxisID,ID(e,"y")),o=t.rAxisID=pi(n.rAxisID,ID(e,"r")),l=t.indexAxis,c=t.iAxisID=s(l,r,a,o),h=t.vAxisID=s(l,a,r,o);t.xScale=this.getScaleForId(r),t.yScale=this.getScaleForId(a),t.rScale=this.getScaleForId(o),t.iScale=this.getScaleForId(c),t.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&m8(this._data,this),e._stacked&&kb(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(Ri(t)){const s=this._cachedMeta;this._data=Y2e(t,s)}else if(n!==t){if(n){m8(n,this);const s=this._cachedMeta;kb(s),s._parsed=[]}t&&Object.isExtensible(t)&&Mge(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let s=!1;this._dataCheck();const r=t._stacked;t._stacked=LD(t.vScale,t),t.stack!==n.stack&&(s=!0,kb(t),t.stack=n.stack),this._resyncElements(e),(s||r!==t._stacked)&&(B8(this,t._parsed),t._stacked=LD(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:s}=this,{iScale:r,_stacked:a}=n,o=r.axis;let l=e===0&&t===s.length?!0:n._sorted,c=e>0&&n._parsed[e-1],h,d,m;if(this._parsing===!1)n._parsed=s,n._sorted=!0,m=s;else{aa(s[e])?m=this.parseArrayData(n,s,e,t):Ri(s[e])?m=this.parseObjectData(n,s,e,t):m=this.parsePrimitiveData(n,s,e,t);const y=()=>d[o]===null||c&&d[o]<c[o];for(h=0;h<t;++h)n._parsed[h+e]=d=m[h],l&&(y()&&(l=!1),c=d);n._sorted=l}a&&B8(this,m)}parsePrimitiveData(e,t,n,s){const{iScale:r,vScale:a}=e,o=r.axis,l=a.axis,c=r.getLabels(),h=r===a,d=new Array(s);let m,y,x;for(m=0,y=s;m<y;++m)x=m+n,d[m]={[o]:h||r.parse(c[x],x),[l]:a.parse(t[x],x)};return d}parseArrayData(e,t,n,s){const{xScale:r,yScale:a}=e,o=new Array(s);let l,c,h,d;for(l=0,c=s;l<c;++l)h=l+n,d=t[h],o[l]={x:r.parse(d[0],h),y:a.parse(d[1],h)};return o}parseObjectData(e,t,n,s){const{xScale:r,yScale:a}=e,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,c=new Array(s);let h,d,m,y;for(h=0,d=s;h<d;++h)m=h+n,y=t[m],c[h]={x:r.parse(gw(y,o),m),y:a.parse(gw(y,l),m)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const s=this.chart,r=this._cachedMeta,a=t[e.axis],o={keys:M7(s,!0),values:t._stacks[e.axis]._visualValues};return L8(o,a,r.index,{mode:n})}updateRangeFromParsed(e,t,n,s){const r=n[t.axis];let a=r===null?NaN:r;const o=s&&n._stacks[t.axis];s&&o&&(s.values=o,a=L8(s,r,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,t){const n=this._cachedMeta,s=n._parsed,r=n._sorted&&e===n.iScale,a=s.length,o=this._getOtherScale(e),l=Q2e(t,n,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:d}=W2e(o);let m,y;function x(){y=s[m];const _=y[o.axis];return!Hl(y[e.axis])||h>_||d<_}for(m=0;m<a&&!(!x()&&(this.updateRangeFromParsed(c,e,y,l),r));++m);if(r){for(m=a-1;m>=0;--m)if(!x()){this.updateRangeFromParsed(c,e,y,l);break}}return c}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let s,r,a;for(s=0,r=t.length;s<r;++s)a=t[s][e.axis],Hl(a)&&n.push(a);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,s=t.vScale,r=this.getParsed(e);return{label:n?""+n.getLabelForValue(r[n.axis]):"",value:s?""+s.getLabelForValue(r[s.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=V2e(pi(this.options.clip,z2e(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,s=n.data||[],r=t.chartArea,a=[],o=this._drawStart||0,l=this._drawCount||s.length-o,c=this.options.drawActiveElementsOnTop;let h;for(n.dataset&&n.dataset.draw(e,r,o,l),h=o;h<o+l;++h){const d=s[h];d.hidden||(d.active&&c?a.push(d):d.draw(e,r))}for(h=0;h<a.length;++h)a[h].draw(e,r)}getStyle(e,t){const n=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const s=this.getDataset();let r;if(e>=0&&e<this._cachedMeta.data.length){const a=this._cachedMeta.data[e];r=a.$context||(a.$context=q2e(this.getContext(),e,a)),r.parsed=this.getParsed(e),r.raw=s.data[e],r.index=r.dataIndex=e}else r=this.$context||(this.$context=j2e(this.chart.getContext(),this.index)),r.dataset=s,r.index=r.datasetIndex=this.index;return r.active=!!t,r.mode=n,r}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",n){const s=t==="active",r=this._cachedDataOpts,a=e+"-"+t,o=r[a],l=this.enableOptionSharing&&yw(n);if(o)return O8(o,l);const c=this.chart.config,h=c.datasetElementScopeKeys(this._type,e),d=s?[`${e}Hover`,"hover",e,""]:[e,""],m=c.getOptionScopes(this.getDataset(),h),y=Object.keys(ar.elements[e]),x=()=>this.getContext(n,s,t),_=c.resolveNamedOptions(m,y,x,d);return _.$shared&&(_.$shared=l,r[a]=Object.freeze(O8(_,l))),_}_resolveAnimations(e,t,n){const s=this.chart,r=this._cachedDataOpts,a=`animation-${t}`,o=r[a];if(o)return o;let l;if(s.options.animation!==!1){const h=this.chart.config,d=h.datasetAnimationScopeKeys(this._type,t),m=h.getOptionScopes(this.getDataset(),d);l=h.createResolver(m,this.getContext(e,n,t))}const c=new w7(s,l&&l.animations);return l&&l._cacheable&&(r[a]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||BD(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),s=this._sharedOptions,r=this.getSharedOptions(n),a=this.includeOptions(t,r)||r!==s;return this.updateSharedOptions(r,t,n),{sharedOptions:r,includeOptions:a}}updateElement(e,t,n,s){BD(s)?Object.assign(e,n):this._resolveAnimations(t,s).update(e,n)}updateSharedOptions(e,t,n){e&&!BD(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,s){e.active=s;const r=this.getStyle(t,s);this._resolveAnimations(t,n,s).update(e,{options:!s&&this.getSharedOptions(r)||r})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[o,l,c]of this._syncList)this[o](l,c);this._syncList=[];const s=n.length,r=t.length,a=Math.min(r,s);a&&this.parse(0,a),r>s?this._insertElements(s,r-s,e):r<s&&this._removeElements(r,s-r)}_insertElements(e,t,n=!0){const s=this._cachedMeta,r=s.data,a=e+t;let o;const l=c=>{for(c.length+=t,o=c.length-1;o>=a;o--)c[o]=c[o-t]};for(l(r),o=e;o<a;++o)r[o]=new this.dataElementType;this._parsing&&l(s._parsed),this.parse(e,t),n&&this.updateElements(r,e,t,"reset")}updateElements(e,t,n,s){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const s=n._parsed.splice(e,t);n._stacked&&kb(n,s)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,s]=e;this[t](n,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}he(MA,"defaults",{}),he(MA,"datasetElementType",null),he(MA,"dataElementType",null);class WT extends MA{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:n,data:s=[],_dataset:r}=t,a=this.chart._animationsDisabled;let{start:o,count:l}=Lge(t,s,a);this._drawStart=o,this._drawCount=l,Ige(t)&&(o=0,l=s.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!r._decimated,n.points=s;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(n,void 0,{animated:!a,options:c},e),this.updateElements(s,o,l,e)}updateElements(e,t,n,s){const r=s==="reset",{iScale:a,vScale:o,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:h,includeOptions:d}=this._getSharedOptions(t,s),m=a.axis,y=o.axis,{spanGaps:x,segment:_}=this.options,b=uE(x)?x:Number.POSITIVE_INFINITY,A=this.chart._animationsDisabled||r||s==="none",T=t+n,w=e.length;let R=t>0&&this.getParsed(t-1);for(let O=0;O<w;++O){const N=e[O],U=A?N:{};if(O<t||O>=T){U.skip=!0;continue}const P=this.getParsed(O),B=os(P[y]),L=U[m]=a.getPixelForValue(P[m],O),F=U[y]=r||B?o.getBasePixel():o.getPixelForValue(l?this.applyStack(o,P,l):P[y],O);U.skip=isNaN(L)||isNaN(F)||B,U.stop=O>0&&Math.abs(P[m]-R[m])>b,_&&(U.parsed=P,U.raw=c.data[O]),d&&(U.options=h||this.resolveDataElementOptions(O,N.active?"active":s)),A||this.updateElement(N,O,U,s),R=P}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,s=e.data||[];if(!s.length)return n;const r=s[0].size(this.resolveDataElementOptions(0)),a=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(n,r,a)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}he(WT,"id","line"),he(WT,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),he(WT,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});function em(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class $O{constructor(e){he(this,"options");this.options=e||{}}static override(e){Object.assign($O.prototype,e)}init(){}formats(){return em()}parse(){return em()}format(){return em()}add(){return em()}diff(){return em()}startOf(){return em()}endOf(){return em()}}var C7={_date:$O};function $2e(i,e,t,n){const{controller:s,data:r,_sorted:a}=i,o=s._cachedMeta.iScale,l=i.dataset&&i.dataset.options?i.dataset.options.spanGaps:null;if(o&&e===o.axis&&e!=="r"&&a&&r.length){const c=o._reversePixels?Tge:Cm;if(n){if(s._sharedOptions){const h=r[0],d=typeof h.getRange=="function"&&h.getRange(e);if(d){const m=c(r,e,t-d),y=c(r,e,t+d);return{lo:m.lo,hi:y.hi}}}}else{const h=c(r,e,t);if(l){const{vScale:d}=s._cachedMeta,{_parsed:m}=i,y=m.slice(0,h.lo+1).reverse().findIndex(_=>!os(_[d.axis]));h.lo-=Math.max(0,y);const x=m.slice(h.hi).findIndex(_=>!os(_[d.axis]));h.hi+=Math.max(0,x)}return h}}return{lo:0,hi:r.length-1}}function BM(i,e,t,n,s){const r=i.getSortedVisibleDatasetMetas(),a=t[e];for(let o=0,l=r.length;o<l;++o){const{index:c,data:h}=r[o],{lo:d,hi:m}=$2e(r[o],e,a,s);for(let y=d;y<=m;++y){const x=h[y];x.skip||n(x,c,y)}}}function J2e(i){const e=i.indexOf("x")!==-1,t=i.indexOf("y")!==-1;return function(n,s){const r=e?Math.abs(n.x-s.x):0,a=t?Math.abs(n.y-s.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(a,2))}}function OD(i,e,t,n,s){const r=[];return!s&&!i.isPointInArea(e)||BM(i,t,e,function(o,l,c){!s&&!hE(o,i.chartArea,0)||o.inRange(e.x,e.y,n)&&r.push({element:o,datasetIndex:l,index:c})},!0),r}function Z2e(i,e,t,n){let s=[];function r(a,o,l){const{startAngle:c,endAngle:h}=a.getProps(["startAngle","endAngle"],n),{angle:d}=Ege(a,{x:e.x,y:e.y});c7(d,c,h)&&s.push({element:a,datasetIndex:o,index:l})}return BM(i,t,e,r),s}function eye(i,e,t,n,s,r){let a=[];const o=J2e(t);let l=Number.POSITIVE_INFINITY;function c(h,d,m){const y=h.inRange(e.x,e.y,s);if(n&&!y)return;const x=h.getCenterPoint(s);if(!(!!r||i.isPointInArea(x))&&!y)return;const b=o(e,x);b<l?(a=[{element:h,datasetIndex:d,index:m}],l=b):b===l&&a.push({element:h,datasetIndex:d,index:m})}return BM(i,t,e,c),a}function PD(i,e,t,n,s,r){return!r&&!i.isPointInArea(e)?[]:t==="r"&&!n?Z2e(i,e,t,s):eye(i,e,t,n,s,r)}function P8(i,e,t,n,s){const r=[],a=t==="x"?"inXRange":"inYRange";let o=!1;return BM(i,t,e,(l,c,h)=>{l[a]&&l[a](e[t],s)&&(r.push({element:l,datasetIndex:c,index:h}),o=o||l.inRange(e.x,e.y,s))}),n&&!o?[]:r}var tye={modes:{index(i,e,t,n){const s=lm(e,i),r=t.axis||"x",a=t.includeInvisible||!1,o=t.intersect?OD(i,s,r,n,a):PD(i,s,r,!1,n,a),l=[];return o.length?(i.getSortedVisibleDatasetMetas().forEach(c=>{const h=o[0].index,d=c.data[h];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:h})}),l):[]},dataset(i,e,t,n){const s=lm(e,i),r=t.axis||"xy",a=t.includeInvisible||!1;let o=t.intersect?OD(i,s,r,n,a):PD(i,s,r,!1,n,a);if(o.length>0){const l=o[0].datasetIndex,c=i.getDatasetMeta(l).data;o=[];for(let h=0;h<c.length;++h)o.push({element:c[h],datasetIndex:l,index:h})}return o},point(i,e,t,n){const s=lm(e,i),r=t.axis||"xy",a=t.includeInvisible||!1;return OD(i,s,r,n,a)},nearest(i,e,t,n){const s=lm(e,i),r=t.axis||"xy",a=t.includeInvisible||!1;return PD(i,s,r,t.intersect,n,a)},x(i,e,t,n){const s=lm(e,i);return P8(i,s,"x",t.intersect,n)},y(i,e,t,n){const s=lm(e,i);return P8(i,s,"y",t.intersect,n)}}};const R7=["left","top","right","bottom"];function Fb(i,e){return i.filter(t=>t.pos===e)}function N8(i,e){return i.filter(t=>R7.indexOf(t.pos)===-1&&t.box.axis===e)}function Hb(i,e){return i.sort((t,n)=>{const s=e?n:t,r=e?t:n;return s.weight===r.weight?s.index-r.index:s.weight-r.weight})}function nye(i){const e=[];let t,n,s,r,a,o;for(t=0,n=(i||[]).length;t<n;++t)s=i[t],{position:r,options:{stack:a,stackWeight:o=1}}=s,e.push({index:t,box:s,pos:r,horizontal:s.isHorizontal(),weight:s.weight,stack:a&&r+a,stackWeight:o});return e}function iye(i){const e={};for(const t of i){const{stack:n,pos:s,stackWeight:r}=t;if(!n||!R7.includes(s))continue;const a=e[n]||(e[n]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=r}return e}function sye(i,e){const t=iye(i),{vBoxMaxWidth:n,hBoxMaxHeight:s}=e;let r,a,o;for(r=0,a=i.length;r<a;++r){o=i[r];const{fullSize:l}=o.box,c=t[o.stack],h=c&&o.stackWeight/c.weight;o.horizontal?(o.width=h?h*n:l&&e.availableWidth,o.height=s):(o.width=n,o.height=h?h*s:l&&e.availableHeight)}return t}function rye(i){const e=nye(i),t=Hb(e.filter(c=>c.box.fullSize),!0),n=Hb(Fb(e,"left"),!0),s=Hb(Fb(e,"right")),r=Hb(Fb(e,"top"),!0),a=Hb(Fb(e,"bottom")),o=N8(e,"x"),l=N8(e,"y");return{fullSize:t,leftAndTop:n.concat(r),rightAndBottom:s.concat(l).concat(a).concat(o),chartArea:Fb(e,"chartArea"),vertical:n.concat(s).concat(l),horizontal:r.concat(a).concat(o)}}function U8(i,e,t,n){return Math.max(i[t],e[t])+Math.max(i[n],e[n])}function D7(i,e){i.top=Math.max(i.top,e.top),i.left=Math.max(i.left,e.left),i.bottom=Math.max(i.bottom,e.bottom),i.right=Math.max(i.right,e.right)}function aye(i,e,t,n){const{pos:s,box:r}=t,a=i.maxPadding;if(!Ri(s)){t.size&&(i[s]-=t.size);const d=n[t.stack]||{size:0,count:1};d.size=Math.max(d.size,t.horizontal?r.height:r.width),t.size=d.size/d.count,i[s]+=t.size}r.getPadding&&D7(a,r.getPadding());const o=Math.max(0,e.outerWidth-U8(a,i,"left","right")),l=Math.max(0,e.outerHeight-U8(a,i,"top","bottom")),c=o!==i.w,h=l!==i.h;return i.w=o,i.h=l,t.horizontal?{same:c,other:h}:{same:h,other:c}}function oye(i){const e=i.maxPadding;function t(n){const s=Math.max(e[n]-i[n],0);return i[n]+=s,s}i.y+=t("top"),i.x+=t("left"),t("right"),t("bottom")}function lye(i,e){const t=e.maxPadding;function n(s){const r={left:0,top:0,right:0,bottom:0};return s.forEach(a=>{r[a]=Math.max(e[a],t[a])}),r}return n(i?["left","right"]:["top","bottom"])}function iA(i,e,t,n){const s=[];let r,a,o,l,c,h;for(r=0,a=i.length,c=0;r<a;++r){o=i[r],l=o.box,l.update(o.width||e.w,o.height||e.h,lye(o.horizontal,e));const{same:d,other:m}=aye(e,t,o,n);c|=d&&s.length,h=h||m,l.fullSize||s.push(o)}return c&&iA(s,e,t,n)||h}function dT(i,e,t,n,s){i.top=t,i.left=e,i.right=e+n,i.bottom=t+s,i.width=n,i.height=s}function k8(i,e,t,n){const s=t.padding;let{x:r,y:a}=e;for(const o of i){const l=o.box,c=n[o.stack]||{placed:0,weight:1},h=o.stackWeight/c.weight||1;if(o.horizontal){const d=e.w*h,m=c.size||l.height;yw(c.start)&&(a=c.start),l.fullSize?dT(l,s.left,a,t.outerWidth-s.right-s.left,m):dT(l,e.left+c.placed,a,d,m),c.start=a,c.placed+=d,a=l.bottom}else{const d=e.h*h,m=c.size||l.width;yw(c.start)&&(r=c.start),l.fullSize?dT(l,r,s.top,m,t.outerHeight-s.bottom-s.top):dT(l,r,e.top+c.placed,m,d),c.start=r,c.placed+=d,r=l.right}}e.x=r,e.y=a}var w0={addBox(i,e){i.boxes||(i.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},i.boxes.push(e)},removeBox(i,e){const t=i.boxes?i.boxes.indexOf(e):-1;t!==-1&&i.boxes.splice(t,1)},configure(i,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(i,e,t,n){if(!i)return;const s=$c(i.options.layout.padding),r=Math.max(e-s.width,0),a=Math.max(t-s.height,0),o=rye(i.boxes),l=o.vertical,c=o.horizontal;zi(i.boxes,_=>{typeof _.beforeLayout=="function"&&_.beforeLayout()});const h=l.reduce((_,b)=>b.box.options&&b.box.options.display===!1?_:_+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:t,padding:s,availableWidth:r,availableHeight:a,vBoxMaxWidth:r/2/h,hBoxMaxHeight:a/2}),m=Object.assign({},s);D7(m,$c(n));const y=Object.assign({maxPadding:m,w:r,h:a,x:s.left,y:s.top},s),x=sye(l.concat(c),d);iA(o.fullSize,y,d,x),iA(l,y,d,x),iA(c,y,d,x)&&iA(l,y,d,x),oye(y),k8(o.leftAndTop,y,d,x),y.x+=y.w,y.y+=y.h,k8(o.rightAndBottom,y,d,x),i.chartArea={left:y.left,top:y.top,right:y.left+y.w,bottom:y.top+y.h,height:y.h,width:y.w},zi(o.chartArea,_=>{const b=_.box;Object.assign(b,i.chartArea),b.update(y.w,y.h,{left:0,top:0,right:0,bottom:0})})}};class L7{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,s){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,s?Math.floor(t/s):n)}}isAttached(e){return!0}updateConfig(e){}}class cye extends L7{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const XT="$chartjs",uye={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},F8=i=>i===null||i==="";function hye(i,e){const t=i.style,n=i.getAttribute("height"),s=i.getAttribute("width");if(i[XT]={initial:{height:n,width:s,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",F8(s)){const r=T8(i,"width");r!==void 0&&(i.width=r)}if(F8(n))if(i.style.height==="")i.height=i.width/(e||2);else{const r=T8(i,"height");r!==void 0&&(i.height=r)}return i}const I7=E2e?{passive:!0}:!1;function fye(i,e,t){i&&i.addEventListener(e,t,I7)}function dye(i,e,t){i&&i.canvas&&i.canvas.removeEventListener(e,t,I7)}function pye(i,e){const t=uye[i.type]||i.type,{x:n,y:s}=lm(i,e);return{type:t,chart:e,native:i,x:n!==void 0?n:null,y:s!==void 0?s:null}}function Aw(i,e){for(const t of i)if(t===e||t.contains(e))return!0}function mye(i,e,t){const n=i.canvas,s=new MutationObserver(r=>{let a=!1;for(const o of r)a=a||Aw(o.addedNodes,n),a=a&&!Aw(o.removedNodes,n);a&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}function gye(i,e,t){const n=i.canvas,s=new MutationObserver(r=>{let a=!1;for(const o of r)a=a||Aw(o.removedNodes,n),a=a&&!Aw(o.addedNodes,n);a&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}const fE=new Map;let H8=0;function B7(){const i=window.devicePixelRatio;i!==H8&&(H8=i,fE.forEach((e,t)=>{t.currentDevicePixelRatio!==i&&e()}))}function yye(i,e){fE.size||window.addEventListener("resize",B7),fE.set(i,e)}function vye(i){fE.delete(i),fE.size||window.removeEventListener("resize",B7)}function xye(i,e,t){const n=i.canvas,s=n&&QO(n);if(!s)return;const r=f7((o,l)=>{const c=s.clientWidth;t(o,l),c<s.clientWidth&&t()},window),a=new ResizeObserver(o=>{const l=o[0],c=l.contentRect.width,h=l.contentRect.height;c===0&&h===0||r(c,h)});return a.observe(s),yye(i,r),a}function ND(i,e,t){t&&t.disconnect(),e==="resize"&&vye(i)}function bye(i,e,t){const n=i.canvas,s=f7(r=>{i.ctx!==null&&t(pye(r,i))},i);return fye(n,e,s),s}class Aye extends L7{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(hye(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[XT])return!1;const n=t[XT].initial;["height","width"].forEach(r=>{const a=n[r];os(a)?t.removeAttribute(r):t.setAttribute(r,a)});const s=n.style||{};return Object.keys(s).forEach(r=>{t.style[r]=s[r]}),t.width=t.width,delete t[XT],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const s=e.$proxies||(e.$proxies={}),a={attach:mye,detach:gye,resize:xye}[t]||bye;s[t]=a(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),s=n[t];if(!s)return;({attach:ND,detach:ND,resize:ND}[t]||dye)(e,t,s),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,s){return A2e(e,t,n,s)}isAttached(e){const t=e&&QO(e);return!!(t&&t.isConnected)}}function Eye(i){return!qO()||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas?cye:Aye}class H0{constructor(){he(this,"x");he(this,"y");he(this,"active",!1);he(this,"options");he(this,"$animations")}tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return uE(this.x)&&uE(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const s={};return e.forEach(r=>{s[r]=n[r]&&n[r].active()?n[r]._to:this[r]}),s}}he(H0,"defaults",{}),he(H0,"defaultRoutes");function _ye(i,e){const t=i.options.ticks,n=Sye(i),s=Math.min(t.maxTicksLimit||n,n),r=t.major.enabled?wye(e):[],a=r.length,o=r[0],l=r[a-1],c=[];if(a>s)return Mye(e,c,r,a/s),c;const h=Tye(r,e,s);if(a>0){let d,m;const y=a>1?Math.round((l-o)/(a-1)):null;for(pT(e,c,h,os(y)?0:o-y,o),d=0,m=a-1;d<m;d++)pT(e,c,h,r[d],r[d+1]);return pT(e,c,h,l,os(y)?e.length:l+y),c}return pT(e,c,h),c}function Sye(i){const e=i.options.offset,t=i._tickSize(),n=i._length/t+(e?0:1),s=i._maxLength/t;return Math.floor(Math.min(n,s))}function Tye(i,e,t){const n=Cye(i),s=e.length/t;if(!n)return Math.max(s,1);const r=yge(n);for(let a=0,o=r.length-1;a<o;a++){const l=r[a];if(l>s)return l}return Math.max(s,1)}function wye(i){const e=[];let t,n;for(t=0,n=i.length;t<n;t++)i[t].major&&e.push(t);return e}function Mye(i,e,t,n){let s=0,r=t[0],a;for(n=Math.ceil(n),a=0;a<i.length;a++)a===r&&(e.push(i[a]),s++,r=t[s*n])}function pT(i,e,t,n,s){const r=pi(n,0),a=Math.min(pi(s,i.length),i.length);let o=0,l,c,h;for(t=Math.ceil(t),s&&(l=s-n,t=l/Math.floor(l/t)),h=r;h<0;)o++,h=Math.round(r+o*t);for(c=Math.max(r,0);c<a;c++)c===h&&(e.push(i[c]),o++,h=Math.round(r+o*t))}function Cye(i){const e=i.length;let t,n;if(e<2)return!1;for(n=i[0],t=1;t<e;++t)if(i[t]-i[t-1]!==n)return!1;return n}const Rye=i=>i==="left"?"right":i==="right"?"left":i,G8=(i,e,t)=>e==="top"||e==="left"?i[e]+t:i[e]-t,z8=(i,e)=>Math.min(e||i,i);function V8(i,e){const t=[],n=i.length/e,s=i.length;let r=0;for(;r<s;r+=n)t.push(i[Math.floor(r)]);return t}function Dye(i,e,t){const n=i.ticks.length,s=Math.min(e,n-1),r=i._startPixel,a=i._endPixel,o=1e-6;let l=i.getPixelForTick(s),c;if(!(t&&(n===1?c=Math.max(l-r,a-l):e===0?c=(i.getPixelForTick(1)-l)/2:c=(l-i.getPixelForTick(s-1))/2,l+=s<e?c:-c,l<r-o||l>a+o)))return l}function Lye(i,e){zi(i,t=>{const n=t.gc,s=n.length/2;let r;if(s>e){for(r=0;r<s;++r)delete t.data[n[r]];n.splice(0,s)}})}function Gb(i){return i.drawTicks?i.tickLength:0}function Y8(i,e){if(!i.display)return 0;const t=Ro(i.font,e),n=$c(i.padding);return(aa(i.text)?i.text.length:1)*t.lineHeight+n.height}function Iye(i,e){return Rg(i,{scale:e,type:"scale"})}function Bye(i,e,t){return Rg(i,{tick:t,index:e,type:"tick"})}function Oye(i,e,t){let n=d7(i);return(t&&e!=="right"||!t&&e==="right")&&(n=Rye(n)),n}function Pye(i,e,t,n){const{top:s,left:r,bottom:a,right:o,chart:l}=i,{chartArea:c,scales:h}=l;let d=0,m,y,x;const _=a-s,b=o-r;if(i.isHorizontal()){if(y=Xo(n,r,o),Ri(t)){const A=Object.keys(t)[0],T=t[A];x=h[A].getPixelForValue(T)+_-e}else t==="center"?x=(c.bottom+c.top)/2+_-e:x=G8(i,t,e);m=o-r}else{if(Ri(t)){const A=Object.keys(t)[0],T=t[A];y=h[A].getPixelForValue(T)-b+e}else t==="center"?y=(c.left+c.right)/2-b+e:y=G8(i,t,e);x=Xo(n,a,s),d=t==="left"?-zc:zc}return{titleX:y,titleY:x,maxWidth:m,rotation:d}}class ex extends H0{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:s}=this;return e=zu(e,Number.POSITIVE_INFINITY),t=zu(t,Number.NEGATIVE_INFINITY),n=zu(n,Number.POSITIVE_INFINITY),s=zu(s,Number.NEGATIVE_INFINITY),{min:zu(e,n),max:zu(t,s),minDefined:Hl(e),maxDefined:Hl(t)}}getMinMax(e){let{min:t,max:n,minDefined:s,maxDefined:r}=this.getUserBounds(),a;if(s&&r)return{min:t,max:n};const o=this.getMatchingVisibleMetas();for(let l=0,c=o.length;l<c;++l)a=o[l].controller.getMinMax(this,e),s||(t=Math.min(t,a.min)),r||(n=Math.max(n,a.max));return t=r&&t>n?n:t,n=s&&t>n?t:n,{min:zu(t,zu(n,t)),max:zu(n,zu(t,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){hs(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:s,grace:r,ticks:a}=this.options,o=a.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Zge(this,r,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=o<this.ticks.length;this._convertTicksToLabels(l?V8(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=_ye(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,n;this.isHorizontal()?(t=this.left,n=this.right):(t=this.top,n=this.bottom,e=!e),this._startPixel=t,this._endPixel=n,this._reversePixels=e,this._length=n-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){hs(this.options.afterUpdate,[this])}beforeSetDimensions(){hs(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){hs(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),hs(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){hs(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,s,r;for(n=0,s=e.length;n<s;n++)r=e[n],r.label=hs(t.callback,[r.value,n,e],this)}afterTickToLabelConversion(){hs(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){hs(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=z8(this.ticks.length,e.ticks.maxTicksLimit),s=t.minRotation||0,r=t.maxRotation;let a=s,o,l,c;if(!this._isVisible()||!t.display||s>=r||n<=1||!this.isHorizontal()){this.labelRotation=s;return}const h=this._getLabelSizes(),d=h.widest.width,m=h.highest.height,y=kl(this.chart.width-d,0,this.maxWidth);o=e.offset?this.maxWidth/n:y/(n-1),d+6>o&&(o=y/(n-(e.offset?.5:1)),l=this.maxHeight-Gb(e.grid)-t.padding-Y8(e.title,this.chart.options.font),c=Math.sqrt(d*d+m*m),a=Age(Math.min(Math.asin(kl((h.highest.height+6)/o,-1,1)),Math.asin(kl(l/c,-1,1))-Math.asin(kl(m/c,-1,1)))),a=Math.max(s,Math.min(r,a))),this.labelRotation=a}afterCalculateLabelRotation(){hs(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){hs(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:s,grid:r}}=this,a=this._isVisible(),o=this.isHorizontal();if(a){const l=Y8(s,t.options.font);if(o?(e.width=this.maxWidth,e.height=Gb(r)+l):(e.height=this.maxHeight,e.width=Gb(r)+l),n.display&&this.ticks.length){const{first:c,last:h,widest:d,highest:m}=this._getLabelSizes(),y=n.padding*2,x=Mm(this.labelRotation),_=Math.cos(x),b=Math.sin(x);if(o){const A=n.mirror?0:b*d.width+_*m.height;e.height=Math.min(this.maxHeight,e.height+A+y)}else{const A=n.mirror?0:_*d.width+b*m.height;e.width=Math.min(this.maxWidth,e.width+A+y)}this._calculatePadding(c,h,b,_)}}this._handleMargins(),o?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,s){const{ticks:{align:r,padding:a},position:o}=this.options,l=this.labelRotation!==0,c=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let m=0,y=0;l?c?(m=s*e.width,y=n*t.height):(m=n*e.height,y=s*t.width):r==="start"?y=t.width:r==="end"?m=e.width:r!=="inner"&&(m=e.width/2,y=t.width/2),this.paddingLeft=Math.max((m-h+a)*this.width/(this.width-h),0),this.paddingRight=Math.max((y-d+a)*this.width/(this.width-d),0)}else{let h=t.height/2,d=e.height/2;r==="start"?(h=0,d=e.height):r==="end"&&(h=t.height,d=0),this.paddingTop=h+a,this.paddingBottom=d+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){hs(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,n;for(t=0,n=e.length;t<n;t++)os(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=V8(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:s,_longestTextCache:r}=this,a=[],o=[],l=Math.floor(t/z8(t,n));let c=0,h=0,d,m,y,x,_,b,A,T,w,R,O;for(d=0;d<t;d+=l){if(x=e[d].label,_=this._resolveTickFontOptions(d),s.font=b=_.string,A=r[b]=r[b]||{data:{},gc:[]},T=_.lineHeight,w=R=0,!os(x)&&!aa(x))w=b8(s,A.data,A.gc,w,x),R=T;else if(aa(x))for(m=0,y=x.length;m<y;++m)O=x[m],!os(O)&&!aa(O)&&(w=b8(s,A.data,A.gc,w,O),R+=T);a.push(w),o.push(R),c=Math.max(w,c),h=Math.max(R,h)}Lye(r,t);const N=a.indexOf(c),U=o.indexOf(h),P=B=>({width:a[B]||0,height:o[B]||0});return{first:P(0),last:P(t-1),widest:P(N),highest:P(U),widths:a,heights:o}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return Sge(this._alignToPixels?Zp(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=Bye(this.getContext(),e,n))}return this.$context||(this.$context=Iye(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=Mm(this.labelRotation),n=Math.abs(Math.cos(t)),s=Math.abs(Math.sin(t)),r=this._getLabelSizes(),a=e.autoSkipPadding||0,o=r?r.widest.width+a:0,l=r?r.highest.height+a:0;return this.isHorizontal()?l*n>o*s?o/n:l/s:l*s<o*n?l/n:o/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,s=this.options,{grid:r,position:a,border:o}=s,l=r.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),m=Gb(r),y=[],x=o.setContext(this.getContext()),_=x.display?x.width:0,b=_/2,A=function(W){return Zp(n,W,_)};let T,w,R,O,N,U,P,B,L,F,j,J;if(a==="top")T=A(this.bottom),U=this.bottom-m,B=T-b,F=A(e.top)+b,J=e.bottom;else if(a==="bottom")T=A(this.top),F=e.top,J=A(e.bottom)-b,U=T+b,B=this.top+m;else if(a==="left")T=A(this.right),N=this.right-m,P=T-b,L=A(e.left)+b,j=e.right;else if(a==="right")T=A(this.left),L=e.left,j=A(e.right)-b,N=T+b,P=this.left+m;else if(t==="x"){if(a==="center")T=A((e.top+e.bottom)/2+.5);else if(Ri(a)){const W=Object.keys(a)[0],ne=a[W];T=A(this.chart.scales[W].getPixelForValue(ne))}F=e.top,J=e.bottom,U=T+b,B=U+m}else if(t==="y"){if(a==="center")T=A((e.left+e.right)/2);else if(Ri(a)){const W=Object.keys(a)[0],ne=a[W];T=A(this.chart.scales[W].getPixelForValue(ne))}N=T-b,P=N-m,L=e.left,j=e.right}const re=pi(s.ticks.maxTicksLimit,d),q=Math.max(1,Math.ceil(d/re));for(w=0;w<d;w+=q){const W=this.getContext(w),ne=r.setContext(W),ie=o.setContext(W),ue=ne.lineWidth,z=ne.color,ae=ie.dash||[],ge=ie.dashOffset,Ee=ne.tickWidth,le=ne.tickColor,Ce=ne.tickBorderDash||[],Me=ne.tickBorderDashOffset;R=Dye(this,w,l),R!==void 0&&(O=Zp(n,R,ue),c?N=P=L=j=O:U=B=F=J=O,y.push({tx1:N,ty1:U,tx2:P,ty2:B,x1:L,y1:F,x2:j,y2:J,width:ue,color:z,borderDash:ae,borderDashOffset:ge,tickWidth:Ee,tickColor:le,tickBorderDash:Ce,tickBorderDashOffset:Me}))}return this._ticksLength=d,this._borderValue=T,y}_computeLabelItems(e){const t=this.axis,n=this.options,{position:s,ticks:r}=n,a=this.isHorizontal(),o=this.ticks,{align:l,crossAlign:c,padding:h,mirror:d}=r,m=Gb(n.grid),y=m+h,x=d?-h:y,_=-Mm(this.labelRotation),b=[];let A,T,w,R,O,N,U,P,B,L,F,j,J="middle";if(s==="top")N=this.bottom-x,U=this._getXAxisLabelAlignment();else if(s==="bottom")N=this.top+x,U=this._getXAxisLabelAlignment();else if(s==="left"){const q=this._getYAxisLabelAlignment(m);U=q.textAlign,O=q.x}else if(s==="right"){const q=this._getYAxisLabelAlignment(m);U=q.textAlign,O=q.x}else if(t==="x"){if(s==="center")N=(e.top+e.bottom)/2+y;else if(Ri(s)){const q=Object.keys(s)[0],W=s[q];N=this.chart.scales[q].getPixelForValue(W)+y}U=this._getXAxisLabelAlignment()}else if(t==="y"){if(s==="center")O=(e.left+e.right)/2-y;else if(Ri(s)){const q=Object.keys(s)[0],W=s[q];O=this.chart.scales[q].getPixelForValue(W)}U=this._getYAxisLabelAlignment(m).textAlign}t==="y"&&(l==="start"?J="top":l==="end"&&(J="bottom"));const re=this._getLabelSizes();for(A=0,T=o.length;A<T;++A){w=o[A],R=w.label;const q=r.setContext(this.getContext(A));P=this.getPixelForTick(A)+r.labelOffset,B=this._resolveTickFontOptions(A),L=B.lineHeight,F=aa(R)?R.length:1;const W=F/2,ne=q.color,ie=q.textStrokeColor,ue=q.textStrokeWidth;let z=U;a?(O=P,U==="inner"&&(A===T-1?z=this.options.reverse?"left":"right":A===0?z=this.options.reverse?"right":"left":z="center"),s==="top"?c==="near"||_!==0?j=-F*L+L/2:c==="center"?j=-re.highest.height/2-W*L+L:j=-re.highest.height+L/2:c==="near"||_!==0?j=L/2:c==="center"?j=re.highest.height/2-W*L:j=re.highest.height-F*L,d&&(j*=-1),_!==0&&!q.showLabelBackdrop&&(O+=L/2*Math.sin(_))):(N=P,j=(1-F)*L/2);let ae;if(q.showLabelBackdrop){const ge=$c(q.backdropPadding),Ee=re.heights[A],le=re.widths[A];let Ce=j-ge.top,Me=0-ge.left;switch(J){case"middle":Ce-=Ee/2;break;case"bottom":Ce-=Ee;break}switch(U){case"center":Me-=le/2;break;case"right":Me-=le;break;case"inner":A===T-1?Me-=le:A>0&&(Me-=le/2);break}ae={left:Me,top:Ce,width:le+ge.width,height:Ee+ge.height,color:q.backdropColor}}b.push({label:R,font:B,textOffset:j,options:{rotation:_,color:ne,strokeColor:ie,strokeWidth:ue,textAlign:z,textBaseline:J,translation:[O,N],backdrop:ae}})}return b}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Mm(this.labelRotation))return e==="top"?"left":"right";let s="center";return t.align==="start"?s="left":t.align==="end"?s="right":t.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:s,padding:r}}=this.options,a=this._getLabelSizes(),o=e+r,l=a.widest.width;let c,h;return t==="left"?s?(h=this.right+r,n==="near"?c="left":n==="center"?(c="center",h+=l/2):(c="right",h+=l)):(h=this.right-o,n==="near"?c="right":n==="center"?(c="center",h-=l/2):(c="left",h=this.left)):t==="right"?s?(h=this.left+r,n==="near"?c="right":n==="center"?(c="center",h-=l/2):(c="left",h-=l)):(h=this.left+o,n==="near"?c="left":n==="center"?(c="center",h+=l/2):(c="right",h=this.right)):c="right",{textAlign:c,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:s,width:r,height:a}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,s,r,a),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const s=this.ticks.findIndex(r=>r.value===e);return s>=0?t.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const t=this.options.grid,n=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let r,a;const o=(l,c,h)=>{!h.width||!h.color||(n.save(),n.lineWidth=h.width,n.strokeStyle=h.color,n.setLineDash(h.borderDash||[]),n.lineDashOffset=h.borderDashOffset,n.beginPath(),n.moveTo(l.x,l.y),n.lineTo(c.x,c.y),n.stroke(),n.restore())};if(t.display)for(r=0,a=s.length;r<a;++r){const l=s[r];t.drawOnChartArea&&o({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),t.drawTicks&&o({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:s}}=this,r=n.setContext(this.getContext()),a=n.display?r.width:0;if(!a)return;const o=s.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,h,d,m;this.isHorizontal()?(c=Zp(e,this.left,a)-a/2,h=Zp(e,this.right,o)+o/2,d=m=l):(d=Zp(e,this.top,a)-a/2,m=Zp(e,this.bottom,o)+o/2,c=h=l),t.save(),t.lineWidth=r.width,t.strokeStyle=r.color,t.beginPath(),t.moveTo(c,d),t.lineTo(h,m),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const n=this.ctx,s=this._computeLabelArea();s&&YO(n,s);const r=this.getLabelItems(e);for(const a of r){const o=a.options,l=a.font,c=a.label,h=a.textOffset;xw(n,c,0,h,l,o)}s&&KO(n)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:s}}=this;if(!n.display)return;const r=Ro(n.font),a=$c(n.padding),o=n.align;let l=r.lineHeight/2;t==="bottom"||t==="center"||Ri(t)?(l+=a.bottom,aa(n.text)&&(l+=r.lineHeight*(n.text.length-1))):l+=a.top;const{titleX:c,titleY:h,maxWidth:d,rotation:m}=Pye(this,l,t,o);xw(e,n.text,0,0,r,{color:n.color,maxWidth:d,rotation:m,textAlign:Oye(o,t,s),textBaseline:"middle",translation:[c,h]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=pi(e.grid&&e.grid.z,-1),s=pi(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==ex.prototype.draw?[{z:t,draw:r=>{this.draw(r)}}]:[{z:n,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:t,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",s=[];let r,a;for(r=0,a=t.length;r<a;++r){const o=t[r];o[n]===this.id&&(!e||o.type===e)&&s.push(o)}return s}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Ro(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class mT{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;kye(t)&&(n=this.register(t));const s=this.items,r=e.id,a=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+e);return r in s||(s[r]=e,Nye(e,a,n),this.override&&ar.override(e.id,e.overrides)),a}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,s=this.scope;n in t&&delete t[n],s&&n in ar[s]&&(delete ar[s][n],this.override&&delete bg[n])}}function Nye(i,e,t){const n=cE(Object.create(null),[t?ar.get(t):{},ar.get(e),i.defaults]);ar.set(e,n),i.defaultRoutes&&Uye(e,i.defaultRoutes),i.descriptors&&ar.describe(e,i.descriptors)}function Uye(i,e){Object.keys(e).forEach(t=>{const n=t.split("."),s=n.pop(),r=[i].concat(n).join("."),a=e[t].split("."),o=a.pop(),l=a.join(".");ar.route(r,s,l,o)})}function kye(i){return"id"in i&&"defaults"in i}class Fye{constructor(){this.controllers=new mT(MA,"datasets",!0),this.elements=new mT(H0,"elements"),this.plugins=new mT(Object,"plugins"),this.scales=new mT(ex,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,n){[...t].forEach(s=>{const r=n||this._getRegistryForType(s);n||r.isForType(s)||r===this.plugins&&s.id?this._exec(e,r,s):zi(s,a=>{const o=n||this._getRegistryForType(a);this._exec(e,o,a)})})}_exec(e,t,n){const s=GO(e);hs(n["before"+s],[],n),t[e](n),hs(n["after"+s],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const s=t.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+n+".");return s}}var Ku=new Fye;class Hye{constructor(){this._init=[]}notify(e,t,n,s){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const r=s?this._descriptors(e).filter(s):this._descriptors(e),a=this._notify(r,e,t,n);return t==="afterDestroy"&&(this._notify(r,e,"stop"),this._notify(this._init,e,"uninstall")),a}_notify(e,t,n,s){s=s||{};for(const r of e){const a=r.plugin,o=a[n],l=[t,s,r.options];if(hs(o,l,a)===!1&&s.cancelable)return!1}return!0}invalidate(){os(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,s=pi(n.options&&n.options.plugins,{}),r=Gye(n);return s===!1&&!t?[]:Vye(e,r,s,t)}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,s=(r,a)=>r.filter(o=>!a.some(l=>o.plugin.id===l.plugin.id));this._notify(s(t,n),e,"stop"),this._notify(s(n,t),e,"start")}}function Gye(i){const e={},t=[],n=Object.keys(Ku.plugins.items);for(let r=0;r<n.length;r++)t.push(Ku.getPlugin(n[r]));const s=i.plugins||[];for(let r=0;r<s.length;r++){const a=s[r];t.indexOf(a)===-1&&(t.push(a),e[a.id]=!0)}return{plugins:t,localIds:e}}function zye(i,e){return!e&&i===!1?null:i===!0?{}:i}function Vye(i,{plugins:e,localIds:t},n,s){const r=[],a=i.getContext();for(const o of e){const l=o.id,c=zye(n[l],s);c!==null&&r.push({plugin:o,options:Yye(i.config,{plugin:o,local:t[l]},c,a)})}return r}function Yye(i,{plugin:e,local:t},n,s){const r=i.pluginScopeKeys(e),a=i.getOptionScopes(n,r);return t&&e.defaults&&a.push(e.defaults),i.createResolver(a,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function _I(i,e){const t=ar.datasets[i]||{};return((e.datasets||{})[i]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function Kye(i,e){let t=i;return i==="_index_"?t=e:i==="_value_"&&(t=e==="x"?"y":"x"),t}function Wye(i,e){return i===e?"_index_":"_value_"}function K8(i){if(i==="x"||i==="y"||i==="r")return i}function Xye(i){if(i==="top"||i==="bottom")return"x";if(i==="left"||i==="right")return"y"}function SI(i,...e){if(K8(i))return i;for(const t of e){const n=t.axis||Xye(t.position)||i.length>1&&K8(i[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${i}' axis. Please provide 'axis' or 'position' option.`)}function W8(i,e,t){if(t[e+"AxisID"]===i)return{axis:e}}function jye(i,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(n=>n.xAxisID===i||n.yAxisID===i);if(t.length)return W8(i,"x",t[0])||W8(i,"y",t[0])}return{}}function qye(i,e){const t=bg[i.type]||{scales:{}},n=e.scales||{},s=_I(i.type,e),r=Object.create(null);return Object.keys(n).forEach(a=>{const o=n[a];if(!Ri(o))return console.error(`Invalid scale configuration for scale: ${a}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const l=SI(a,o,jye(a,i),ar.scales[o.type]),c=Wye(l,s),h=t.scales||{};r[a]=EA(Object.create(null),[{axis:l},o,h[l],h[c]])}),i.data.datasets.forEach(a=>{const o=a.type||i.type,l=a.indexAxis||_I(o,e),h=(bg[o]||{}).scales||{};Object.keys(h).forEach(d=>{const m=Kye(d,l),y=a[m+"AxisID"]||m;r[y]=r[y]||Object.create(null),EA(r[y],[{axis:m},n[y],h[d]])})}),Object.keys(r).forEach(a=>{const o=r[a];EA(o,[ar.scales[o.type],ar.scale])}),r}function O7(i){const e=i.options||(i.options={});e.plugins=pi(e.plugins,{}),e.scales=qye(i,e)}function P7(i){return i=i||{},i.datasets=i.datasets||[],i.labels=i.labels||[],i}function Qye(i){return i=i||{},i.data=P7(i.data),O7(i),i}const X8=new Map,N7=new Set;function gT(i,e){let t=X8.get(i);return t||(t=e(),X8.set(i,t),N7.add(t)),t}const zb=(i,e,t)=>{const n=gw(e,t);n!==void 0&&i.add(n)};class $ye{constructor(e){this._config=Qye(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=P7(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),O7(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return gT(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return gT(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return gT(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,n=this.type;return gT(`${n}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const n=this._scopeCache;let s=n.get(e);return(!s||t)&&(s=new Map,n.set(e,s)),s}getOptionScopes(e,t,n){const{options:s,type:r}=this,a=this._cachedScopes(e,n),o=a.get(t);if(o)return o;const l=new Set;t.forEach(h=>{e&&(l.add(e),h.forEach(d=>zb(l,e,d))),h.forEach(d=>zb(l,s,d)),h.forEach(d=>zb(l,bg[r]||{},d)),h.forEach(d=>zb(l,ar,d)),h.forEach(d=>zb(l,bI,d))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),N7.has(t)&&a.set(t,c),c}chartOptionScopes(){const{options:e,type:t}=this;return[e,bg[t]||{},ar.datasets[t]||{},{type:t},ar,bI]}resolveNamedOptions(e,t,n,s=[""]){const r={$shared:!0},{resolver:a,subPrefixes:o}=j8(this._resolverCache,e,s);let l=a;if(Zye(a,t)){r.$shared=!1,n=F0(n)?n():n;const c=this.createResolver(e,n,o);l=Hv(a,n,c)}for(const c of t)r[c]=l[c];return r}createResolver(e,t,n=[""],s){const{resolver:r}=j8(this._resolverCache,e,n);return Ri(t)?Hv(r,t,void 0,s):r}}function j8(i,e,t){let n=i.get(e);n||(n=new Map,i.set(e,n));const s=t.join();let r=n.get(s);return r||(r={resolver:WO(e,t),subPrefixes:t.filter(o=>!o.toLowerCase().includes("hover"))},n.set(s,r)),r}const Jye=i=>Ri(i)&&Object.getOwnPropertyNames(i).some(e=>F0(i[e]));function Zye(i,e){const{isScriptable:t,isIndexable:n}=v7(i);for(const s of e){const r=t(s),a=n(s),o=(a||r)&&i[s];if(r&&(F0(o)||Jye(o))||a&&aa(o))return!0}return!1}var eve="4.4.9";const tve=["top","bottom","left","right","chartArea"];function q8(i,e){return i==="top"||i==="bottom"||tve.indexOf(i)===-1&&e==="x"}function Q8(i,e){return function(t,n){return t[i]===n[i]?t[e]-n[e]:t[i]-n[i]}}function $8(i){const e=i.chart,t=e.options.animation;e.notifyPlugins("afterRender"),hs(t&&t.onComplete,[i],e)}function nve(i){const e=i.chart,t=e.options.animation;hs(t&&t.onProgress,[i],e)}function U7(i){return qO()&&typeof i=="string"?i=document.getElementById(i):i&&i.length&&(i=i[0]),i&&i.canvas&&(i=i.canvas),i}const jT={},J8=i=>{const e=U7(i);return Object.values(jT).filter(t=>t.canvas===e).pop()};function ive(i,e,t){const n=Object.keys(i);for(const s of n){const r=+s;if(r>=e){const a=i[s];delete i[s],(t>0||r>e)&&(i[r+t]=a)}}}function sve(i,e,t,n){return!t||i.type==="mouseout"?null:n?e:i}var Zd;let OM=(Zd=class{static register(...e){Ku.add(...e),Z8()}static unregister(...e){Ku.remove(...e),Z8()}constructor(e,t){const n=this.config=new $ye(t),s=U7(e),r=J8(s);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const a=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||Eye(s)),this.platform.updateConfig(n);const o=this.platform.acquireContext(s,a.aspectRatio),l=o&&o.canvas,c=l&&l.height,h=l&&l.width;if(this.id=lge(),this.ctx=o,this.canvas=l,this.width=h,this.height=c,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Hye,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Rge(d=>this.update(d),a.resizeDelay||0),this._dataChanges=[],jT[this.id]=this,!o||!l){console.error("Failed to create chart: can't acquire context from the given item");return}af.listen(this,"complete",$8),af.listen(this,"progress",nve),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:s,_aspectRatio:r}=this;return os(e)?t&&r?r:s?n/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Ku}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():S8(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return A8(this.canvas,this.ctx),this}stop(){return af.stop(this),this}resize(e,t){af.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,s=this.canvas,r=n.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(s,e,t,r),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,S8(this,o,!0)&&(this.notifyPlugins("resize",{size:a}),hs(n.onResize,[this,a],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};zi(t,(n,s)=>{n.id=s})}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,s=Object.keys(n).reduce((a,o)=>(a[o]=!1,a),{});let r=[];t&&(r=r.concat(Object.keys(t).map(a=>{const o=t[a],l=SI(a,o),c=l==="r",h=l==="x";return{options:o,dposition:c?"chartArea":h?"bottom":"left",dtype:c?"radialLinear":h?"category":"linear"}}))),zi(r,a=>{const o=a.options,l=o.id,c=SI(l,o),h=pi(o.type,a.dtype);(o.position===void 0||q8(o.position,c)!==q8(a.dposition))&&(o.position=a.dposition),s[l]=!0;let d=null;if(l in n&&n[l].type===h)d=n[l];else{const m=Ku.getScale(h);d=new m({id:l,type:h,ctx:this.ctx,chart:this}),n[d.id]=d}d.init(o,e)}),zi(s,(a,o)=>{a||delete n[o]}),zi(n,a=>{w0.configure(this,a,a.options),w0.addBox(this,a)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((s,r)=>s.index-r.index),n>t){for(let s=t;s<n;++s)this._destroyDatasetMeta(s);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(Q8("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((n,s)=>{t.filter(r=>r===n._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,s;for(this._removeUnreferencedMetasets(),n=0,s=t.length;n<s;n++){const r=t[n];let a=this.getDatasetMeta(n);const o=r.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(n),a=this.getDatasetMeta(n)),a.type=o,a.indexAxis=r.indexAxis||_I(o,this.options),a.order=r.order||0,a.index=n,a.label=""+r.label,a.visible=this.isDatasetVisible(n),a.controller)a.controller.updateIndex(n),a.controller.linkScales();else{const l=Ku.getController(o),{datasetElementType:c,dataElementType:h}=ar.datasets[o];Object.assign(l,{dataElementType:Ku.getElement(h),datasetElementType:c&&Ku.getElement(c)}),a.controller=new l(this,n),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){zi(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let c=0,h=this.data.datasets.length;c<h;c++){const{controller:d}=this.getDatasetMeta(c),m=!s&&r.indexOf(d)===-1;d.buildOrUpdateElements(m),a=Math.max(+d.getMaxOverflow(),a)}a=this._minPadding=n.layout.autoPadding?a:0,this._updateLayout(a),s||zi(r,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Q8("z","_idx"));const{_active:o,_lastEvent:l}=this;l?this._eventHandler(l,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){zi(this.scales,e=>{w0.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);(!h8(t,n)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:s,count:r}of t){const a=n==="_removeElements"?-r:r;ive(e,s,a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=r=>new Set(e.filter(a=>a[0]===r).map((a,o)=>o+","+a.splice(1).join(","))),s=n(0);for(let r=1;r<t;r++)if(!h8(s,n(r)))return;return Array.from(s).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;w0.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],zi(this.boxes,s=>{n&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,r)=>{s._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,n=this.data.datasets.length;t<n;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,F0(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),s={meta:n,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(n.controller._update(t),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(af.has(this)?this.attached&&!af.running(this)&&af.start(this):(this.draw(),$8({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:n,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let s,r;for(s=0,r=t.length;s<r;++s){const a=t[s];(!e||a.visible)&&n.push(a)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n={meta:e,index:e.index,cancelable:!0},s=N2e(this,e);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(s&&YO(t,s),e.controller.draw(),s&&KO(t),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return hE(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,s){const r=tye.modes[t];return typeof r=="function"?r(this,e,n,s):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let s=n.filter(r=>r&&r._dataset===t).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(s)),s}getContext(){return this.$context||(this.$context=Rg(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return typeof n.hidden=="boolean"?!n.hidden:!t.hidden}setDatasetVisibility(e,t){const n=this.getDatasetMeta(e);n.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const s=n?"show":"hide",r=this.getDatasetMeta(e),a=r.controller._resolveAnimations(void 0,s);yw(t)?(r.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),a.update(r,{visible:n}),this.update(o=>o.datasetIndex===e?s:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),af.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),A8(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete jT[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(r,a)=>{t.addEventListener(this,r,a),e[r]=a},s=(r,a,o)=>{r.offsetX=a,r.offsetY=o,this._eventHandler(r)};zi(this.options.events,r=>n(r,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(l,c)=>{t.addEventListener(this,l,c),e[l]=c},s=(l,c)=>{e[l]&&(t.removeEventListener(this,l,c),delete e[l])},r=(l,c)=>{this.canvas&&this.resize(l,c)};let a;const o=()=>{s("attach",o),this.attached=!0,this.resize(),n("resize",r),n("detach",a)};a=()=>{this.attached=!1,s("resize",r),this._stop(),this._resize(0,0),n("attach",o)},t.isAttached(this.canvas)?o():a()}unbindEvents(){zi(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},zi(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const s=n?"set":"remove";let r,a,o,l;for(t==="dataset"&&(r=this.getDatasetMeta(e[0].datasetIndex),r.controller["_"+s+"DatasetHoverStyle"]()),o=0,l=e.length;o<l;++o){a=e[o];const c=a&&this.getDatasetMeta(a.datasetIndex).controller;c&&c[s+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map(({datasetIndex:r,index:a})=>{const o=this.getDatasetMeta(r);if(!o)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:o.data[a],index:a}});!pw(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,n){const s=this.options.hover,r=(l,c)=>l.filter(h=>!c.some(d=>h.datasetIndex===d.datasetIndex&&h.index===d.index)),a=r(t,e),o=n?e:r(e,t);a.length&&this.updateHoverStyle(a,s.mode,!1),o.length&&s.mode&&this.updateHoverStyle(o,s.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},s=a=>(a.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",n,s)===!1)return;const r=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,s),(r||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:s=[],options:r}=this,a=t,o=this._getActiveElements(e,s,n,a),l=pge(e),c=sve(e,this._lastEvent,n,l);n&&(this._lastEvent=null,hs(r.onHover,[e,o,this],this),l&&hs(r.onClick,[e,o,this],this));const h=!pw(o,s);return(h||t)&&(this._active=o,this._updateHoverStyles(o,s,t)),this._lastEvent=c,h}_getActiveElements(e,t,n,s){if(e.type==="mouseout")return[];if(!n)return t;const r=this.options.hover;return this.getElementsAtEventForMode(e,r.mode,r,s)}},he(Zd,"defaults",ar),he(Zd,"instances",jT),he(Zd,"overrides",bg),he(Zd,"registry",Ku),he(Zd,"version",eve),he(Zd,"getChart",J8),Zd);function Z8(){return zi(OM.instances,i=>i._plugins.invalidate())}function k7(i,e,t=e){i.lineCap=pi(t.borderCapStyle,e.borderCapStyle),i.setLineDash(pi(t.borderDash,e.borderDash)),i.lineDashOffset=pi(t.borderDashOffset,e.borderDashOffset),i.lineJoin=pi(t.borderJoinStyle,e.borderJoinStyle),i.lineWidth=pi(t.borderWidth,e.borderWidth),i.strokeStyle=pi(t.borderColor,e.borderColor)}function rve(i,e,t){i.lineTo(t.x,t.y)}function ave(i){return i.stepped?Vge:i.tension||i.cubicInterpolationMode==="monotone"?Yge:rve}function F7(i,e,t={}){const n=i.length,{start:s=0,end:r=n-1}=t,{start:a,end:o}=e,l=Math.max(s,a),c=Math.min(r,o),h=s<a&&r<a||s>o&&r>o;return{count:n,start:l,loop:e.loop,ilen:c<l&&!h?n+c-l:c-l}}function ove(i,e,t,n){const{points:s,options:r}=e,{count:a,start:o,loop:l,ilen:c}=F7(s,t,n),h=ave(r);let{move:d=!0,reverse:m}=n||{},y,x,_;for(y=0;y<=c;++y)x=s[(o+(m?c-y:y))%a],!x.skip&&(d?(i.moveTo(x.x,x.y),d=!1):h(i,_,x,m,r.stepped),_=x);return l&&(x=s[(o+(m?c:0))%a],h(i,_,x,m,r.stepped)),!!l}function lve(i,e,t,n){const s=e.points,{count:r,start:a,ilen:o}=F7(s,t,n),{move:l=!0,reverse:c}=n||{};let h=0,d=0,m,y,x,_,b,A;const T=R=>(a+(c?o-R:R))%r,w=()=>{_!==b&&(i.lineTo(h,b),i.lineTo(h,_),i.lineTo(h,A))};for(l&&(y=s[T(0)],i.moveTo(y.x,y.y)),m=0;m<=o;++m){if(y=s[T(m)],y.skip)continue;const R=y.x,O=y.y,N=R|0;N===x?(O<_?_=O:O>b&&(b=O),h=(d*h+R)/++d):(w(),i.lineTo(R,O),x=N,d=0,_=b=O),A=O}w()}function TI(i){const e=i.options,t=e.borderDash&&e.borderDash.length;return!i._decimated&&!i._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?lve:ove}function cve(i){return i.stepped?_2e:i.tension||i.cubicInterpolationMode==="monotone"?S2e:cm}function uve(i,e,t,n){let s=e._path;s||(s=e._path=new Path2D,e.path(s,t,n)&&s.closePath()),k7(i,e.options),i.stroke(s)}function hve(i,e,t,n){const{segments:s,options:r}=e,a=TI(e);for(const o of s)k7(i,r,o.style),i.beginPath(),a(i,e,o,{start:t,end:t+n-1})&&i.closePath(),i.stroke()}const fve=typeof Path2D=="function";function dve(i,e,t,n){fve&&!e.options.segment?uve(i,e,t,n):hve(i,e,t,n)}class sA extends H0{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const s=n.spanGaps?this._loop:this._fullLoop;m2e(this._points,n,e,s,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=I2e(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){const n=this.options,s=e[t],r=this.points,a=R2e(this,{property:t,start:s,end:s});if(!a.length)return;const o=[],l=cve(n);let c,h;for(c=0,h=a.length;c<h;++c){const{start:d,end:m}=a[c],y=r[d],x=r[m];if(y===x){o.push(y);continue}const _=Math.abs((s-y[t])/(x[t]-y[t])),b=l(y,x,_,n.stepped);b[t]=e[t],o.push(b)}return o.length===1?o[0]:o}pathSegment(e,t,n){return TI(this)(e,this,t,n)}path(e,t,n){const s=this.segments,r=TI(this);let a=this._loop;t=t||0,n=n||this.points.length-t;for(const o of s)a&=r(e,this,o,{start:t,end:t+n-1});return!!a}draw(e,t,n,s){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(e.save(),dve(e,this,n,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}he(sA,"id","line"),he(sA,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),he(sA,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),he(sA,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function e5(i,e,t,n){const s=i.options,{[t]:r}=i.getProps([t],n);return Math.abs(e-r)<s.radius+s.hitRadius}class qT extends H0{constructor(t){super();he(this,"parsed");he(this,"skip");he(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,n,s){const r=this.options,{x:a,y:o}=this.getProps(["x","y"],s);return Math.pow(t-a,2)+Math.pow(n-o,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(t,n){return e5(this,t,"x",n)}inYRange(t,n){return e5(this,t,"y",n)}getCenterPoint(t){const{x:n,y:s}=this.getProps(["x","y"],t);return{x:n,y:s}}size(t){t=t||this.options||{};let n=t.radius||0;n=Math.max(n,n&&t.hoverRadius||0);const s=n&&t.borderWidth||0;return(n+s)*2}draw(t,n){const s=this.options;this.skip||s.radius<.1||!hE(this,n,this.size(s)/2)||(t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.fillStyle=s.backgroundColor,AI(t,s,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}he(qT,"id","point"),he(qT,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),he(qT,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const t5=(i,e)=>{let{boxHeight:t=e,boxWidth:n=e}=i;return i.usePointStyle&&(t=Math.min(t,e),n=i.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:t,itemHeight:Math.max(e,t)}},pve=(i,e)=>i!==null&&e!==null&&i.datasetIndex===e.datasetIndex&&i.index===e.index;class n5 extends H0{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=hs(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(n=>e.filter(n,this.chart.data))),e.sort&&(t=t.sort((n,s)=>e.sort(n,s,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const n=e.labels,s=Ro(n.font),r=s.size,a=this._computeTitleHeight(),{boxWidth:o,itemHeight:l}=t5(n,r);let c,h;t.font=s.string,this.isHorizontal()?(c=this.maxWidth,h=this._fitRows(a,r,o,l)+10):(h=this.maxHeight,c=this._fitCols(a,s,o,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(h,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,s){const{ctx:r,maxWidth:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],h=s+o;let d=e;r.textAlign="left",r.textBaseline="middle";let m=-1,y=-h;return this.legendItems.forEach((x,_)=>{const b=n+t/2+r.measureText(x.text).width;(_===0||c[c.length-1]+b+2*o>a)&&(d+=h,c[c.length-(_>0?0:1)]=0,y+=h,m++),l[_]={left:0,top:y,row:m,width:b,height:s},c[c.length-1]+=b+o}),d}_fitCols(e,t,n,s){const{ctx:r,maxHeight:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],h=a-e;let d=o,m=0,y=0,x=0,_=0;return this.legendItems.forEach((b,A)=>{const{itemWidth:T,itemHeight:w}=mve(n,t,r,b,s);A>0&&y+w+2*o>h&&(d+=m+o,c.push({width:m,height:y}),x+=m+o,_++,m=y=0),l[A]={left:x,top:y,col:_,width:T,height:w},m=Math.max(m,T),y+=w+o}),d+=m,c.push({width:m,height:y}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:s},rtl:r}}=this,a=Ry(r,this.left,this.width);if(this.isHorizontal()){let o=0,l=Xo(n,this.left+s,this.right-this.lineWidths[o]);for(const c of t)o!==c.row&&(o=c.row,l=Xo(n,this.left+s,this.right-this.lineWidths[o])),c.top+=this.top+e+s,c.left=a.leftForLtr(a.x(l),c.width),l+=c.width+s}else{let o=0,l=Xo(n,this.top+e+s,this.bottom-this.columnSizes[o].height);for(const c of t)c.col!==o&&(o=c.col,l=Xo(n,this.top+e+s,this.bottom-this.columnSizes[o].height)),c.top=l,c.left+=this.left+s,c.left=a.leftForLtr(a.x(c.left),c.width),l+=c.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;YO(e,this),this._draw(),KO(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:s}=this,{align:r,labels:a}=e,o=ar.color,l=Ry(e.rtl,this.left,this.width),c=Ro(a.font),{padding:h}=a,d=c.size,m=d/2;let y;this.drawTitle(),s.textAlign=l.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=c.string;const{boxWidth:x,boxHeight:_,itemHeight:b}=t5(a,d),A=function(N,U,P){if(isNaN(x)||x<=0||isNaN(_)||_<0)return;s.save();const B=pi(P.lineWidth,1);if(s.fillStyle=pi(P.fillStyle,o),s.lineCap=pi(P.lineCap,"butt"),s.lineDashOffset=pi(P.lineDashOffset,0),s.lineJoin=pi(P.lineJoin,"miter"),s.lineWidth=B,s.strokeStyle=pi(P.strokeStyle,o),s.setLineDash(pi(P.lineDash,[])),a.usePointStyle){const L={radius:_*Math.SQRT2/2,pointStyle:P.pointStyle,rotation:P.rotation,borderWidth:B},F=l.xPlus(N,x/2),j=U+m;g7(s,L,F,j,a.pointStyleWidth&&x)}else{const L=U+Math.max((d-_)/2,0),F=l.leftForLtr(N,x),j=wA(P.borderRadius);s.beginPath(),Object.values(j).some(J=>J!==0)?EI(s,{x:F,y:L,w:x,h:_,radius:j}):s.rect(F,L,x,_),s.fill(),B!==0&&s.stroke()}s.restore()},T=function(N,U,P){xw(s,P.text,N,U+b/2,c,{strikethrough:P.hidden,textAlign:l.textAlign(P.textAlign)})},w=this.isHorizontal(),R=this._computeTitleHeight();w?y={x:Xo(r,this.left+h,this.right-n[0]),y:this.top+h+R,line:0}:y={x:this.left+h,y:Xo(r,this.top+R+h,this.bottom-t[0].height),line:0},_7(this.ctx,e.textDirection);const O=b+h;this.legendItems.forEach((N,U)=>{s.strokeStyle=N.fontColor,s.fillStyle=N.fontColor;const P=s.measureText(N.text).width,B=l.textAlign(N.textAlign||(N.textAlign=a.textAlign)),L=x+m+P;let F=y.x,j=y.y;l.setWidth(this.width),w?U>0&&F+L+h>this.right&&(j=y.y+=O,y.line++,F=y.x=Xo(r,this.left+h,this.right-n[y.line])):U>0&&j+O>this.bottom&&(F=y.x=F+t[y.line].width+h,y.line++,j=y.y=Xo(r,this.top+R+h,this.bottom-t[y.line].height));const J=l.x(F);if(A(J,j,N),F=Dge(B,F+x+m,w?F+L:this.right,e.rtl),T(l.x(F),j,N),w)y.x+=L+h;else if(typeof N.text!="string"){const re=c.lineHeight;y.y+=H7(N,re)+h}else y.y+=O}),S7(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=Ro(t.font),s=$c(t.padding);if(!t.display)return;const r=Ry(e.rtl,this.left,this.width),a=this.ctx,o=t.position,l=n.size/2,c=s.top+l;let h,d=this.left,m=this.width;if(this.isHorizontal())m=Math.max(...this.lineWidths),h=this.top+c,d=Xo(e.align,d,this.right-m);else{const x=this.columnSizes.reduce((_,b)=>Math.max(_,b.height),0);h=c+Xo(e.align,this.top,this.bottom-x-e.labels.padding-this._computeTitleHeight())}const y=Xo(o,d,d+m);a.textAlign=r.textAlign(d7(o)),a.textBaseline="middle",a.strokeStyle=t.color,a.fillStyle=t.color,a.font=n.string,xw(a,t.text,y,h,n)}_computeTitleHeight(){const e=this.options.title,t=Ro(e.font),n=$c(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,s,r;if(nA(e,this.left,this.right)&&nA(t,this.top,this.bottom)){for(r=this.legendHitBoxes,n=0;n<r.length;++n)if(s=r[n],nA(e,s.left,s.left+s.width)&&nA(t,s.top,s.top+s.height))return this.legendItems[n]}return null}handleEvent(e){const t=this.options;if(!vve(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,r=pve(s,n);s&&!r&&hs(t.onLeave,[e,s,this],this),this._hoveredItem=n,n&&!r&&hs(t.onHover,[e,n,this],this)}else n&&hs(t.onClick,[e,n,this],this)}}function mve(i,e,t,n,s){const r=gve(n,i,e,t),a=yve(s,n,e.lineHeight);return{itemWidth:r,itemHeight:a}}function gve(i,e,t,n){let s=i.text;return s&&typeof s!="string"&&(s=s.reduce((r,a)=>r.length>a.length?r:a)),e+t.size/2+n.measureText(s).width}function yve(i,e,t){let n=i;return typeof e.text!="string"&&(n=H7(e,t)),n}function H7(i,e){const t=i.text?i.text.length:0;return e*t}function vve(i,e){return!!((i==="mousemove"||i==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(i==="click"||i==="mouseup"))}var xve={id:"legend",_element:n5,start(i,e,t){const n=i.legend=new n5({ctx:i.ctx,options:t,chart:i});w0.configure(i,n,t),w0.addBox(i,n)},stop(i){w0.removeBox(i,i.legend),delete i.legend},beforeUpdate(i,e,t){const n=i.legend;w0.configure(i,n,t),n.options=t},afterUpdate(i){const e=i.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(i,e){e.replay||i.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(i,e,t){const n=e.datasetIndex,s=t.chart;s.isDatasetVisible(n)?(s.hide(n),e.hidden=!0):(s.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:i=>i.chart.options.color,boxWidth:40,padding:10,generateLabels(i){const e=i.data.datasets,{labels:{usePointStyle:t,pointStyle:n,textAlign:s,color:r,useBorderRadius:a,borderRadius:o}}=i.legend.options;return i._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(t?0:void 0),h=$c(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:r,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:c.borderColor,pointStyle:n||c.pointStyle,rotation:c.rotation,textAlign:s||c.textAlign,borderRadius:a&&(o||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:i=>i.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:i=>!i.startsWith("on"),labels:{_scriptable:i=>!["generateLabels","filter","sort"].includes(i)}}};const rA={average(i){if(!i.length)return!1;let e,t,n=new Set,s=0,r=0;for(e=0,t=i.length;e<t;++e){const o=i[e].element;if(o&&o.hasValue()){const l=o.tooltipPosition();n.add(l.x),s+=l.y,++r}}return r===0||n.size===0?!1:{x:[...n].reduce((o,l)=>o+l)/n.size,y:s/r}},nearest(i,e){if(!i.length)return!1;let t=e.x,n=e.y,s=Number.POSITIVE_INFINITY,r,a,o;for(r=0,a=i.length;r<a;++r){const l=i[r].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),h=xI(e,c);h<s&&(s=h,o=l)}}if(o){const l=o.tooltipPosition();t=l.x,n=l.y}return{x:t,y:n}}};function Vu(i,e){return e&&(aa(e)?Array.prototype.push.apply(i,e):i.push(e)),i}function of(i){return(typeof i=="string"||i instanceof String)&&i.indexOf(`
`)>-1?i.split(`
`):i}function bve(i,e){const{element:t,datasetIndex:n,index:s}=e,r=i.getDatasetMeta(n).controller,{label:a,value:o}=r.getLabelAndValue(s);return{chart:i,label:a,parsed:r.getParsed(s),raw:i.data.datasets[n].data[s],formattedValue:o,dataset:r.getDataset(),dataIndex:s,datasetIndex:n,element:t}}function i5(i,e){const t=i.chart.ctx,{body:n,footer:s,title:r}=i,{boxWidth:a,boxHeight:o}=e,l=Ro(e.bodyFont),c=Ro(e.titleFont),h=Ro(e.footerFont),d=r.length,m=s.length,y=n.length,x=$c(e.padding);let _=x.height,b=0,A=n.reduce((R,O)=>R+O.before.length+O.lines.length+O.after.length,0);if(A+=i.beforeBody.length+i.afterBody.length,d&&(_+=d*c.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),A){const R=e.displayColors?Math.max(o,l.lineHeight):l.lineHeight;_+=y*R+(A-y)*l.lineHeight+(A-1)*e.bodySpacing}m&&(_+=e.footerMarginTop+m*h.lineHeight+(m-1)*e.footerSpacing);let T=0;const w=function(R){b=Math.max(b,t.measureText(R).width+T)};return t.save(),t.font=c.string,zi(i.title,w),t.font=l.string,zi(i.beforeBody.concat(i.afterBody),w),T=e.displayColors?a+2+e.boxPadding:0,zi(n,R=>{zi(R.before,w),zi(R.lines,w),zi(R.after,w)}),T=0,t.font=h.string,zi(i.footer,w),t.restore(),b+=x.width,{width:b,height:_}}function Ave(i,e){const{y:t,height:n}=e;return t<n/2?"top":t>i.height-n/2?"bottom":"center"}function Eve(i,e,t,n){const{x:s,width:r}=n,a=t.caretSize+t.caretPadding;if(i==="left"&&s+r+a>e.width||i==="right"&&s-r-a<0)return!0}function _ve(i,e,t,n){const{x:s,width:r}=t,{width:a,chartArea:{left:o,right:l}}=i;let c="center";return n==="center"?c=s<=(o+l)/2?"left":"right":s<=r/2?c="left":s>=a-r/2&&(c="right"),Eve(c,i,e,t)&&(c="center"),c}function s5(i,e,t){const n=t.yAlign||e.yAlign||Ave(i,t);return{xAlign:t.xAlign||e.xAlign||_ve(i,e,t,n),yAlign:n}}function Sve(i,e){let{x:t,width:n}=i;return e==="right"?t-=n:e==="center"&&(t-=n/2),t}function Tve(i,e,t){let{y:n,height:s}=i;return e==="top"?n+=t:e==="bottom"?n-=s+t:n-=s/2,n}function r5(i,e,t,n){const{caretSize:s,caretPadding:r,cornerRadius:a}=i,{xAlign:o,yAlign:l}=t,c=s+r,{topLeft:h,topRight:d,bottomLeft:m,bottomRight:y}=wA(a);let x=Sve(e,o);const _=Tve(e,l,c);return l==="center"?o==="left"?x+=c:o==="right"&&(x-=c):o==="left"?x-=Math.max(h,m)+s:o==="right"&&(x+=Math.max(d,y)+s),{x:kl(x,0,n.width-e.width),y:kl(_,0,n.height-e.height)}}function yT(i,e,t){const n=$c(t.padding);return e==="center"?i.x+i.width/2:e==="right"?i.x+i.width-n.right:i.x+n.left}function a5(i){return Vu([],of(i))}function wve(i,e,t){return Rg(i,{tooltip:e,tooltipItems:t,type:"tooltip"})}function o5(i,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?i.override(t):i}const G7={beforeTitle:sf,title(i){if(i.length>0){const e=i[0],t=e.chart.data.labels,n=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return t[e.dataIndex]}return""},afterTitle:sf,beforeBody:sf,beforeLabel:sf,label(i){if(this&&this.options&&this.options.mode==="dataset")return i.label+": "+i.formattedValue||i.formattedValue;let e=i.dataset.label||"";e&&(e+=": ");const t=i.formattedValue;return os(t)||(e+=t),e},labelColor(i){const t=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(i){const t=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:sf,afterBody:sf,beforeFooter:sf,footer:sf,afterFooter:sf};function xo(i,e,t,n){const s=i[e].call(t,n);return typeof s>"u"?G7[e].call(t,n):s}class wI extends H0{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),s=n.enabled&&t.options.animation&&n.animations,r=new w7(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=wve(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:n}=t,s=xo(n,"beforeTitle",this,e),r=xo(n,"title",this,e),a=xo(n,"afterTitle",this,e);let o=[];return o=Vu(o,of(s)),o=Vu(o,of(r)),o=Vu(o,of(a)),o}getBeforeBody(e,t){return a5(xo(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,s=[];return zi(e,r=>{const a={before:[],lines:[],after:[]},o=o5(n,r);Vu(a.before,of(xo(o,"beforeLabel",this,r))),Vu(a.lines,xo(o,"label",this,r)),Vu(a.after,of(xo(o,"afterLabel",this,r))),s.push(a)}),s}getAfterBody(e,t){return a5(xo(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,s=xo(n,"beforeFooter",this,e),r=xo(n,"footer",this,e),a=xo(n,"afterFooter",this,e);let o=[];return o=Vu(o,of(s)),o=Vu(o,of(r)),o=Vu(o,of(a)),o}_createItems(e){const t=this._active,n=this.chart.data,s=[],r=[],a=[];let o=[],l,c;for(l=0,c=t.length;l<c;++l)o.push(bve(this.chart,t[l]));return e.filter&&(o=o.filter((h,d,m)=>e.filter(h,d,m,n))),e.itemSort&&(o=o.sort((h,d)=>e.itemSort(h,d,n))),zi(o,h=>{const d=o5(e.callbacks,h);s.push(xo(d,"labelColor",this,h)),r.push(xo(d,"labelPointStyle",this,h)),a.push(xo(d,"labelTextColor",this,h))}),this.labelColors=s,this.labelPointStyles=r,this.labelTextColors=a,this.dataPoints=o,o}update(e,t){const n=this.options.setContext(this.getContext()),s=this._active;let r,a=[];if(!s.length)this.opacity!==0&&(r={opacity:0});else{const o=rA[n.position].call(this,s,this._eventPosition);a=this._createItems(n),this.title=this.getTitle(a,n),this.beforeBody=this.getBeforeBody(a,n),this.body=this.getBody(a,n),this.afterBody=this.getAfterBody(a,n),this.footer=this.getFooter(a,n);const l=this._size=i5(this,n),c=Object.assign({},o,l),h=s5(this.chart,n,c),d=r5(n,c,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,r={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:o.x,caretY:o.y}}this._tooltipItems=a,this.$context=void 0,r&&this._resolveAnimations().update(this,r),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,s){const r=this.getCaretPosition(e,n,s);t.lineTo(r.x1,r.y1),t.lineTo(r.x2,r.y2),t.lineTo(r.x3,r.y3)}getCaretPosition(e,t,n){const{xAlign:s,yAlign:r}=this,{caretSize:a,cornerRadius:o}=n,{topLeft:l,topRight:c,bottomLeft:h,bottomRight:d}=wA(o),{x:m,y}=e,{width:x,height:_}=t;let b,A,T,w,R,O;return r==="center"?(R=y+_/2,s==="left"?(b=m,A=b-a,w=R+a,O=R-a):(b=m+x,A=b+a,w=R-a,O=R+a),T=b):(s==="left"?A=m+Math.max(l,h)+a:s==="right"?A=m+x-Math.max(c,d)-a:A=this.caretX,r==="top"?(w=y,R=w-a,b=A-a,T=A+a):(w=y+_,R=w+a,b=A+a,T=A-a),O=w),{x1:b,x2:A,x3:T,y1:w,y2:R,y3:O}}drawTitle(e,t,n){const s=this.title,r=s.length;let a,o,l;if(r){const c=Ry(n.rtl,this.x,this.width);for(e.x=yT(this,n.titleAlign,n),t.textAlign=c.textAlign(n.titleAlign),t.textBaseline="middle",a=Ro(n.titleFont),o=n.titleSpacing,t.fillStyle=n.titleColor,t.font=a.string,l=0;l<r;++l)t.fillText(s[l],c.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+o,l+1===r&&(e.y+=n.titleMarginBottom-o)}}_drawColorBox(e,t,n,s,r){const a=this.labelColors[n],o=this.labelPointStyles[n],{boxHeight:l,boxWidth:c}=r,h=Ro(r.bodyFont),d=yT(this,"left",r),m=s.x(d),y=l<h.lineHeight?(h.lineHeight-l)/2:0,x=t.y+y;if(r.usePointStyle){const _={radius:Math.min(c,l)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},b=s.leftForLtr(m,c)+c/2,A=x+l/2;e.strokeStyle=r.multiKeyBackground,e.fillStyle=r.multiKeyBackground,AI(e,_,b,A),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,AI(e,_,b,A)}else{e.lineWidth=Ri(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;const _=s.leftForLtr(m,c),b=s.leftForLtr(s.xPlus(m,1),c-2),A=wA(a.borderRadius);Object.values(A).some(T=>T!==0)?(e.beginPath(),e.fillStyle=r.multiKeyBackground,EI(e,{x:_,y:x,w:c,h:l,radius:A}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),EI(e,{x:b,y:x+1,w:c-2,h:l-2,radius:A}),e.fill()):(e.fillStyle=r.multiKeyBackground,e.fillRect(_,x,c,l),e.strokeRect(_,x,c,l),e.fillStyle=a.backgroundColor,e.fillRect(b,x+1,c-2,l-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:s}=this,{bodySpacing:r,bodyAlign:a,displayColors:o,boxHeight:l,boxWidth:c,boxPadding:h}=n,d=Ro(n.bodyFont);let m=d.lineHeight,y=0;const x=Ry(n.rtl,this.x,this.width),_=function(P){t.fillText(P,x.x(e.x+y),e.y+m/2),e.y+=m+r},b=x.textAlign(a);let A,T,w,R,O,N,U;for(t.textAlign=a,t.textBaseline="middle",t.font=d.string,e.x=yT(this,b,n),t.fillStyle=n.bodyColor,zi(this.beforeBody,_),y=o&&b!=="right"?a==="center"?c/2+h:c+2+h:0,R=0,N=s.length;R<N;++R){for(A=s[R],T=this.labelTextColors[R],t.fillStyle=T,zi(A.before,_),w=A.lines,o&&w.length&&(this._drawColorBox(t,e,R,x,n),m=Math.max(d.lineHeight,l)),O=0,U=w.length;O<U;++O)_(w[O]),m=d.lineHeight;zi(A.after,_)}y=0,m=d.lineHeight,zi(this.afterBody,_),e.y-=r}drawFooter(e,t,n){const s=this.footer,r=s.length;let a,o;if(r){const l=Ry(n.rtl,this.x,this.width);for(e.x=yT(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=l.textAlign(n.footerAlign),t.textBaseline="middle",a=Ro(n.footerFont),t.fillStyle=n.footerColor,t.font=a.string,o=0;o<r;++o)t.fillText(s[o],l.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+n.footerSpacing}}drawBackground(e,t,n,s){const{xAlign:r,yAlign:a}=this,{x:o,y:l}=e,{width:c,height:h}=n,{topLeft:d,topRight:m,bottomLeft:y,bottomRight:x}=wA(s.cornerRadius);t.fillStyle=s.backgroundColor,t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.beginPath(),t.moveTo(o+d,l),a==="top"&&this.drawCaret(e,t,n,s),t.lineTo(o+c-m,l),t.quadraticCurveTo(o+c,l,o+c,l+m),a==="center"&&r==="right"&&this.drawCaret(e,t,n,s),t.lineTo(o+c,l+h-x),t.quadraticCurveTo(o+c,l+h,o+c-x,l+h),a==="bottom"&&this.drawCaret(e,t,n,s),t.lineTo(o+y,l+h),t.quadraticCurveTo(o,l+h,o,l+h-y),a==="center"&&r==="left"&&this.drawCaret(e,t,n,s),t.lineTo(o,l+d),t.quadraticCurveTo(o,l,o+d,l),t.closePath(),t.fill(),s.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,s=n&&n.x,r=n&&n.y;if(s||r){const a=rA[e.position].call(this,this._active,this._eventPosition);if(!a)return;const o=this._size=i5(this,e),l=Object.assign({},a,this._size),c=s5(t,e,l),h=r5(e,l,c,t);(s._to!==h.x||r._to!==h.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=o.width,this.height=o.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const s={width:this.width,height:this.height},r={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const a=$c(t.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&o&&(e.save(),e.globalAlpha=n,this.drawBackground(r,e,s,t),_7(e,t.textDirection),r.y+=a.top,this.drawTitle(r,e,t),this.drawBody(r,e,t),this.drawFooter(r,e,t),S7(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,s=e.map(({datasetIndex:o,index:l})=>{const c=this.chart.getDatasetMeta(o);if(!c)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:c.data[l],index:l}}),r=!pw(n,s),a=this._positionChanged(s,t);(r||a)&&(this._active=s,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,n=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,r=this._active||[],a=this._getActiveElements(e,r,t,n),o=this._positionChanged(a,e),l=t||!pw(a,r)||o;return l&&(this._active=a,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),l}_getActiveElements(e,t,n,s){const r=this.options;if(e.type==="mouseout")return[];if(!s)return t.filter(o=>this.chart.data.datasets[o.datasetIndex]&&this.chart.getDatasetMeta(o.datasetIndex).controller.getParsed(o.index)!==void 0);const a=this.chart.getElementsAtEventForMode(e,r.mode,r,n);return r.reverse&&a.reverse(),a}_positionChanged(e,t){const{caretX:n,caretY:s,options:r}=this,a=rA[r.position].call(this,e,t);return a!==!1&&(n!==a.x||s!==a.y)}}he(wI,"positioners",rA);var Mve={id:"tooltip",_element:wI,positioners:rA,afterInit(i,e,t){t&&(i.tooltip=new wI({chart:i,options:t}))},beforeUpdate(i,e,t){i.tooltip&&i.tooltip.initialize(t)},reset(i,e,t){i.tooltip&&i.tooltip.initialize(t)},afterDraw(i){const e=i.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(i.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(i.ctx),i.notifyPlugins("afterTooltipDraw",t)}},afterEvent(i,e){if(i.tooltip){const t=e.replay;i.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(i,e)=>e.bodyFont.size,boxWidth:(i,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:G7},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:i=>i!=="filter"&&i!=="itemSort"&&i!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Cve=(i,e,t,n)=>(typeof e=="string"?(t=i.push(e)-1,n.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function Rve(i,e,t,n){const s=i.indexOf(e);if(s===-1)return Cve(i,e,t,n);const r=i.lastIndexOf(e);return s!==r?t:s}const Dve=(i,e)=>i===null?null:kl(Math.round(i),0,e);function l5(i){const e=this.getLabels();return i>=0&&i<e.length?e[i]:i}class MI extends ex{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const n=this.getLabels();for(const{index:s,label:r}of t)n[s]===r&&n.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(os(e))return null;const n=this.getLabels();return t=isFinite(t)&&n[t]===e?t:Rve(n,e,pi(t,e),this._addedLabels),Dve(t,n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:n,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(n=0),t||(s=this.getLabels().length-1)),this.min=n,this.max=s}buildTicks(){const e=this.min,t=this.max,n=this.options.offset,s=[];let r=this.getLabels();r=e===0&&t===r.length-1?r:r.slice(e,t+1),this._valueRange=Math.max(r.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let a=e;a<=t;a++)s.push({value:a});return s}getLabelForValue(e){return l5.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}he(MI,"id","category"),he(MI,"defaults",{ticks:{callback:l5}});function Lve(i,e){const t=[],{bounds:s,step:r,min:a,max:o,precision:l,count:c,maxTicks:h,maxDigits:d,includeBounds:m}=i,y=r||1,x=h-1,{min:_,max:b}=e,A=!os(a),T=!os(o),w=!os(c),R=(b-_)/(d+1);let O=d8((b-_)/x/y)*y,N,U,P,B;if(O<1e-14&&!A&&!T)return[{value:_},{value:b}];B=Math.ceil(b/O)-Math.floor(_/O),B>x&&(O=d8(B*O/x/y)*y),os(l)||(N=Math.pow(10,l),O=Math.ceil(O*N)/N),s==="ticks"?(U=Math.floor(_/O)*O,P=Math.ceil(b/O)*O):(U=_,P=b),A&&T&&r&&xge((o-a)/r,O/1e3)?(B=Math.round(Math.min((o-a)/O,h)),O=(o-a)/B,U=a,P=o):w?(U=A?a:U,P=T?o:P,B=c-1,O=(P-U)/B):(B=(P-U)/O,_A(B,Math.round(B),O/1e3)?B=Math.round(B):B=Math.ceil(B));const L=Math.max(p8(O),p8(U));N=Math.pow(10,os(l)?L:l),U=Math.round(U*N)/N,P=Math.round(P*N)/N;let F=0;for(A&&(m&&U!==a?(t.push({value:a}),U<a&&F++,_A(Math.round((U+F*O)*N)/N,a,c5(a,R,i))&&F++):U<a&&F++);F<B;++F){const j=Math.round((U+F*O)*N)/N;if(T&&j>o)break;t.push({value:j})}return T&&m&&P!==o?t.length&&_A(t[t.length-1].value,o,c5(o,R,i))?t[t.length-1].value=o:t.push({value:o}):(!T||P===o)&&t.push({value:P}),t}function c5(i,e,{horizontal:t,minRotation:n}){const s=Mm(n),r=(t?Math.sin(s):Math.cos(s))||.001,a=.75*e*(""+i).length;return Math.min(e/r,a)}class Ive extends ex{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return os(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this;const a=l=>s=t?s:l,o=l=>r=n?r:l;if(e){const l=Fv(s),c=Fv(r);l<0&&c<0?o(0):l>0&&c>0&&a(0)}if(s===r){let l=r===0?1:Math.abs(r*.05);o(r+l),e||a(s-l)}this.min=s,this.max=r}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:n}=e,s;return n?(s=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),t=t||11),t&&(s=Math.min(t,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const s={maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},r=this._range||this,a=Lve(s,r);return e.bounds==="ticks"&&bge(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const e=this.ticks;let t=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const s=(n-t)/Math.max(e.length-1,1)/2;t-=s,n+=s}this._startValue=t,this._endValue=n,this._valueRange=n-t}getLabelForValue(e){return p7(e,this.chart.options.locale,this.options.ticks.format)}}class CI extends Ive{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Hl(e)?e:0,this.max=Hl(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,n=Mm(this.options.ticks.minRotation),s=(e?Math.sin(n):Math.cos(n))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,r.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}he(CI,"id","linear"),he(CI,"defaults",{ticks:{callback:m7.formatters.numeric}});const PM={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Mo=Object.keys(PM);function u5(i,e){return i-e}function h5(i,e){if(os(e))return null;const t=i._adapter,{parser:n,round:s,isoWeekday:r}=i._parseOpts;let a=e;return typeof n=="function"&&(a=n(a)),Hl(a)||(a=typeof n=="string"?t.parse(a,n):t.parse(a)),a===null?null:(s&&(a=s==="week"&&(uE(r)||r===!0)?t.startOf(a,"isoWeek",r):t.startOf(a,s)),+a)}function f5(i,e,t,n){const s=Mo.length;for(let r=Mo.indexOf(i);r<s-1;++r){const a=PM[Mo[r]],o=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((t-e)/(o*a.size))<=n)return Mo[r]}return Mo[s-1]}function Bve(i,e,t,n,s){for(let r=Mo.length-1;r>=Mo.indexOf(t);r--){const a=Mo[r];if(PM[a].common&&i._adapter.diff(s,n,a)>=e-1)return a}return Mo[t?Mo.indexOf(t):0]}function Ove(i){for(let e=Mo.indexOf(i)+1,t=Mo.length;e<t;++e)if(PM[Mo[e]].common)return Mo[e]}function d5(i,e,t){if(!t)i[e]=!0;else if(t.length){const{lo:n,hi:s}=zO(t,e),r=t[n]>=e?t[n]:t[s];i[r]=!0}}function Pve(i,e,t,n){const s=i._adapter,r=+s.startOf(e[0].value,n),a=e[e.length-1].value;let o,l;for(o=r;o<=a;o=+s.add(o,1,n))l=t[o],l>=0&&(e[l].major=!0);return e}function p5(i,e,t){const n=[],s={},r=e.length;let a,o;for(a=0;a<r;++a)o=e[a],s[o]=a,n.push({value:o,major:!1});return r===0||!t?n:Pve(i,n,s,t)}class dE extends ex{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const n=e.time||(e.time={}),s=this._adapter=new C7._date(e.adapters.date);s.init(t),EA(n.displayFormats,s.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:h5(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:s,max:r,minDefined:a,maxDefined:o}=this.getUserBounds();function l(c){!a&&!isNaN(c.min)&&(s=Math.min(s,c.min)),!o&&!isNaN(c.max)&&(r=Math.max(r,c.max))}(!a||!o)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),s=Hl(s)&&!isNaN(s)?s:+t.startOf(Date.now(),n),r=Hl(r)&&!isNaN(r)?r:+t.endOf(Date.now(),n)+1,this.min=Math.min(s,r-1),this.max=Math.max(s+1,r)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,s=n.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const r=this.min,a=this.max,o=wge(s,r,a);return this._unit=t.unit||(n.autoSkip?f5(t.minUnit,this.min,this.max,this._getLabelCapacity(r)):Bve(this,o.length,t.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:Ove(this._unit),this.initOffsets(s),e.reverse&&o.reverse(),p5(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,n=0,s,r;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?t=1-s:t=(this.getDecimalForValue(e[1])-s)/2,r=this.getDecimalForValue(e[e.length-1]),e.length===1?n=r:n=(r-this.getDecimalForValue(e[e.length-2]))/2);const a=e.length<3?.5:.25;t=kl(t,0,a),n=kl(n,0,a),this._offsets={start:t,end:n,factor:1/(t+1+n)}}_generate(){const e=this._adapter,t=this.min,n=this.max,s=this.options,r=s.time,a=r.unit||f5(r.minUnit,t,n,this._getLabelCapacity(t)),o=pi(s.ticks.stepSize,1),l=a==="week"?r.isoWeekday:!1,c=uE(l)||l===!0,h={};let d=t,m,y;if(c&&(d=+e.startOf(d,"isoWeek",l)),d=+e.startOf(d,c?"day":a),e.diff(n,t,a)>1e5*o)throw new Error(t+" and "+n+" are too far apart with stepSize of "+o+" "+a);const x=s.ticks.source==="data"&&this.getDataTimestamps();for(m=d,y=0;m<n;m=+e.add(m,o,a),y++)d5(h,m,x);return(m===n||s.bounds==="ticks"||y===1)&&d5(h,m,x),Object.keys(h).sort(u5).map(_=>+_)}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const s=this.options.time.displayFormats,r=this._unit,a=t||s[r];return this._adapter.format(e,a)}_tickFormatFunction(e,t,n,s){const r=this.options,a=r.ticks.callback;if(a)return hs(a,[e,t,n],this);const o=r.time.displayFormats,l=this._unit,c=this._majorUnit,h=l&&o[l],d=c&&o[c],m=n[t],y=c&&d&&m&&m.major;return this._adapter.format(e,s||(y?d:h))}generateTickLabels(e){let t,n,s;for(t=0,n=e.length;t<n;++t)s=e[t],s.label=this._tickFormatFunction(s.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,s=Mm(this.isHorizontal()?t.maxRotation:t.minRotation),r=Math.cos(s),a=Math.sin(s),o=this._resolveTickFontOptions(0).size;return{w:n*r+o*a,h:n*a+o*r}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,s=n[t.unit]||n.millisecond,r=this._tickFormatFunction(e,0,p5(this,[e],this._majorUnit),s),a=this._getLabelSize(r),o=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return o>0?o:1}getDataTimestamps(){let e=this._cache.data||[],t,n;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(t=0,n=s.length;t<n;++t)e=e.concat(s[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const s=this.getLabels();for(t=0,n=s.length;t<n;++t)e.push(h5(this,s[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Cge(e.sort(u5))}}he(dE,"id","time"),he(dE,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function vT(i,e,t){let n=0,s=i.length-1,r,a,o,l;t?(e>=i[n].pos&&e<=i[s].pos&&({lo:n,hi:s}=Cm(i,"pos",e)),{pos:r,time:o}=i[n],{pos:a,time:l}=i[s]):(e>=i[n].time&&e<=i[s].time&&({lo:n,hi:s}=Cm(i,"time",e)),{time:r,pos:o}=i[n],{time:a,pos:l}=i[s]);const c=a-r;return c?o+(l-o)*(e-r)/c:o}class m5 extends dE{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=vT(t,this.min),this._tableRange=vT(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:n}=this,s=[],r=[];let a,o,l,c,h;for(a=0,o=e.length;a<o;++a)c=e[a],c>=t&&c<=n&&s.push(c);if(s.length<2)return[{time:t,pos:0},{time:n,pos:1}];for(a=0,o=s.length;a<o;++a)h=s[a+1],l=s[a-1],c=s[a],Math.round((h+l)/2)!==c&&r.push({time:c,pos:a/(o-1)});return r}_generate(){const e=this.min,t=this.max;let n=super.getDataTimestamps();return(!n.includes(e)||!n.length)&&n.splice(0,0,e),(!n.includes(t)||n.length===1)&&n.push(t),n.sort((s,r)=>s-r)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),n=this.getLabelTimestamps();return t.length&&n.length?e=this.normalize(t.concat(n)):e=t.length?t:n,e=this._cache.all=e,e}getDecimalForValue(e){return(vT(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return vT(this._table,n*this._tableRange+this._minPos,!0)}}he(m5,"id","timeseries"),he(m5,"defaults",dE.defaults);const z7="label";function g5(i,e){typeof i=="function"?i(e):i&&(i.current=e)}function Nve(i,e){const t=i.options;t&&e&&Object.assign(t,e)}function V7(i,e){i.labels=e}function Y7(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:z7;const n=[];i.datasets=e.map(s=>{const r=i.datasets.find(a=>a[t]===s[t]);return!r||!s.data||n.includes(r)?{...s}:(n.push(r),Object.assign(r,s),r)})}function Uve(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z7;const t={labels:[],datasets:[]};return V7(t,i.labels),Y7(t,i.datasets,e),t}function kve(i,e){const{height:t=150,width:n=300,redraw:s=!1,datasetIdKey:r,type:a,data:o,options:l,plugins:c=[],fallbackContent:h,updateMode:d,...m}=i,y=ce.useRef(null),x=ce.useRef(null),_=()=>{y.current&&(x.current=new OM(y.current,{type:a,data:Uve(o,r),options:l&&{...l},plugins:c}),g5(e,x.current))},b=()=>{g5(e,null),x.current&&(x.current.destroy(),x.current=null)};return ce.useEffect(()=>{!s&&x.current&&l&&Nve(x.current,l)},[s,l]),ce.useEffect(()=>{!s&&x.current&&V7(x.current.config.data,o.labels)},[s,o.labels]),ce.useEffect(()=>{!s&&x.current&&o.datasets&&Y7(x.current.config.data,o.datasets,r)},[s,o.datasets]),ce.useEffect(()=>{x.current&&(s?(b(),setTimeout(_)):x.current.update(d))},[s,l,o.labels,o.datasets,d]),ce.useEffect(()=>{x.current&&(b(),setTimeout(_))},[a]),ce.useEffect(()=>(_(),()=>b()),[]),mv.createElement("canvas",{ref:y,role:"img",height:t,width:n,...m},h)}const Fve=ce.forwardRef(kve);function Hve(i,e){return OM.register(e),ce.forwardRef((t,n)=>mv.createElement(Fve,{...t,ref:n,type:i}))}const Gve=Hve("line",WT),K7=6048e5,zve=864e5,t1=6e4,n1=36e5,Vve=1e3,y5=Symbol.for("constructDateFrom");function qs(i,e){return typeof i=="function"?i(e):i&&typeof i=="object"&&y5 in i?i[y5](e):i instanceof Date?new i.constructor(e):new Date(e)}function Dn(i,e){return qs(e||i,i)}function NM(i,e,t){const n=Dn(i,t==null?void 0:t.in);return isNaN(e)?qs((t==null?void 0:t.in)||i,NaN):(e&&n.setDate(n.getDate()+e),n)}function JO(i,e,t){const n=Dn(i,t==null?void 0:t.in);if(isNaN(e))return qs(i,NaN);if(!e)return n;const s=n.getDate(),r=qs(i,n.getTime());r.setMonth(n.getMonth()+e+1,0);const a=r.getDate();return s>=a?r:(n.setFullYear(r.getFullYear(),r.getMonth(),s),n)}function ZO(i,e,t){return qs(i,+Dn(i)+e)}function Yve(i,e,t){return ZO(i,e*n1)}let Kve={};function Dg(){return Kve}function yh(i,e){var o,l,c,h;const t=Dg(),n=(e==null?void 0:e.weekStartsOn)??((l=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((h=(c=t.locale)==null?void 0:c.options)==null?void 0:h.weekStartsOn)??0,s=Dn(i,e==null?void 0:e.in),r=s.getDay(),a=(r<n?7:0)+r-n;return s.setDate(s.getDate()-a),s.setHours(0,0,0,0),s}function zv(i,e){return yh(i,{...e,weekStartsOn:1})}function W7(i,e){const t=Dn(i,e==null?void 0:e.in),n=t.getFullYear(),s=qs(t,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const r=zv(s),a=qs(t,0);a.setFullYear(n,0,4),a.setHours(0,0,0,0);const o=zv(a);return t.getTime()>=r.getTime()?n+1:t.getTime()>=o.getTime()?n:n-1}function Ew(i){const e=Dn(i),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+i-+t}function Lg(i,...e){const t=qs.bind(null,e.find(n=>typeof n=="object"));return e.map(t)}function RI(i,e){const t=Dn(i,e==null?void 0:e.in);return t.setHours(0,0,0,0),t}function X7(i,e,t){const[n,s]=Lg(t==null?void 0:t.in,i,e),r=RI(n),a=RI(s),o=+r-Ew(r),l=+a-Ew(a);return Math.round((o-l)/zve)}function Wve(i,e){const t=W7(i,e),n=qs(i,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),zv(n)}function Xve(i,e,t){const n=Dn(i,t==null?void 0:t.in);return n.setTime(n.getTime()+e*t1),n}function jve(i,e,t){return JO(i,e*3,t)}function qve(i,e,t){return ZO(i,e*1e3)}function Qve(i,e,t){return NM(i,e*7,t)}function $ve(i,e,t){return JO(i,e*12,t)}function CA(i,e){const t=+Dn(i)-+Dn(e);return t<0?-1:t>0?1:t}function Jve(i){return i instanceof Date||typeof i=="object"&&Object.prototype.toString.call(i)==="[object Date]"}function j7(i){return!(!Jve(i)&&typeof i!="number"||isNaN(+Dn(i)))}function Zve(i,e,t){const[n,s]=Lg(t==null?void 0:t.in,i,e),r=n.getFullYear()-s.getFullYear(),a=n.getMonth()-s.getMonth();return r*12+a}function exe(i,e,t){const[n,s]=Lg(t==null?void 0:t.in,i,e);return n.getFullYear()-s.getFullYear()}function q7(i,e,t){const[n,s]=Lg(t==null?void 0:t.in,i,e),r=v5(n,s),a=Math.abs(X7(n,s));n.setDate(n.getDate()-r*a);const o=+(v5(n,s)===-r),l=r*(a-o);return l===0?0:l}function v5(i,e){const t=i.getFullYear()-e.getFullYear()||i.getMonth()-e.getMonth()||i.getDate()-e.getDate()||i.getHours()-e.getHours()||i.getMinutes()-e.getMinutes()||i.getSeconds()-e.getSeconds()||i.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function i1(i){return e=>{const n=(i?Math[i]:Math.trunc)(e);return n===0?0:n}}function txe(i,e,t){const[n,s]=Lg(t==null?void 0:t.in,i,e),r=(+n-+s)/n1;return i1(t==null?void 0:t.roundingMethod)(r)}function eP(i,e){return+Dn(i)-+Dn(e)}function nxe(i,e,t){const n=eP(i,e)/t1;return i1(t==null?void 0:t.roundingMethod)(n)}function Q7(i,e){const t=Dn(i,e==null?void 0:e.in);return t.setHours(23,59,59,999),t}function $7(i,e){const t=Dn(i,e==null?void 0:e.in),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function ixe(i,e){const t=Dn(i,e==null?void 0:e.in);return+Q7(t,e)==+$7(t,e)}function J7(i,e,t){const[n,s,r]=Lg(t==null?void 0:t.in,i,i,e),a=CA(s,r),o=Math.abs(Zve(s,r));if(o<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-a*o);let l=CA(s,r)===-a;ixe(n)&&o===1&&CA(n,r)===1&&(l=!1);const c=a*(o-+l);return c===0?0:c}function sxe(i,e,t){const n=J7(i,e,t)/3;return i1(t==null?void 0:t.roundingMethod)(n)}function rxe(i,e,t){const n=eP(i,e)/1e3;return i1(t==null?void 0:t.roundingMethod)(n)}function axe(i,e,t){const n=q7(i,e,t)/7;return i1(t==null?void 0:t.roundingMethod)(n)}function oxe(i,e,t){const[n,s]=Lg(t==null?void 0:t.in,i,e),r=CA(n,s),a=Math.abs(exe(n,s));n.setFullYear(1584),s.setFullYear(1584);const o=CA(n,s)===-r,l=r*(a-+o);return l===0?0:l}function lxe(i,e){const t=Dn(i,e==null?void 0:e.in),n=t.getMonth(),s=n-n%3;return t.setMonth(s,1),t.setHours(0,0,0,0),t}function cxe(i,e){const t=Dn(i,e==null?void 0:e.in);return t.setDate(1),t.setHours(0,0,0,0),t}function uxe(i,e){const t=Dn(i,e==null?void 0:e.in),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}function Z7(i,e){const t=Dn(i,e==null?void 0:e.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function hxe(i,e){const t=Dn(i,e==null?void 0:e.in);return t.setMinutes(59,59,999),t}function fxe(i,e){var o,l;const t=Dg(),n=t.weekStartsOn??((l=(o=t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??0,s=Dn(i,e==null?void 0:e.in),r=s.getDay(),a=(r<n?-7:0)+6-(r-n);return s.setDate(s.getDate()+a),s.setHours(23,59,59,999),s}function dxe(i,e){const t=Dn(i,e==null?void 0:e.in);return t.setSeconds(59,999),t}function pxe(i,e){const t=Dn(i,e==null?void 0:e.in),n=t.getMonth(),s=n-n%3+3;return t.setMonth(s,0),t.setHours(23,59,59,999),t}function mxe(i,e){const t=Dn(i,e==null?void 0:e.in);return t.setMilliseconds(999),t}const gxe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},yxe=(i,e,t)=>{let n;const s=gxe[i];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+n:n+" ago":n};function UD(i){return(e={})=>{const t=e.width?String(e.width):i.defaultWidth;return i.formats[t]||i.formats[i.defaultWidth]}}const vxe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},xxe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},bxe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Axe={date:UD({formats:vxe,defaultWidth:"full"}),time:UD({formats:xxe,defaultWidth:"full"}),dateTime:UD({formats:bxe,defaultWidth:"full"})},Exe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},_xe=(i,e,t,n)=>Exe[i];function Vb(i){return(e,t)=>{const n=t!=null&&t.context?String(t.context):"standalone";let s;if(n==="formatting"&&i.formattingValues){const a=i.defaultFormattingWidth||i.defaultWidth,o=t!=null&&t.width?String(t.width):a;s=i.formattingValues[o]||i.formattingValues[a]}else{const a=i.defaultWidth,o=t!=null&&t.width?String(t.width):i.defaultWidth;s=i.values[o]||i.values[a]}const r=i.argumentCallback?i.argumentCallback(e):e;return s[r]}}const Sxe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Txe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},wxe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Mxe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Cxe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Rxe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Dxe=(i,e)=>{const t=Number(i),n=t%100;if(n>20||n<10)switch(n%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},Lxe={ordinalNumber:Dxe,era:Vb({values:Sxe,defaultWidth:"wide"}),quarter:Vb({values:Txe,defaultWidth:"wide",argumentCallback:i=>i-1}),month:Vb({values:wxe,defaultWidth:"wide"}),day:Vb({values:Mxe,defaultWidth:"wide"}),dayPeriod:Vb({values:Cxe,defaultWidth:"wide",formattingValues:Rxe,defaultFormattingWidth:"wide"})};function Yb(i){return(e,t={})=>{const n=t.width,s=n&&i.matchPatterns[n]||i.matchPatterns[i.defaultMatchWidth],r=e.match(s);if(!r)return null;const a=r[0],o=n&&i.parsePatterns[n]||i.parsePatterns[i.defaultParseWidth],l=Array.isArray(o)?Bxe(o,d=>d.test(a)):Ixe(o,d=>d.test(a));let c;c=i.valueCallback?i.valueCallback(l):l,c=t.valueCallback?t.valueCallback(c):c;const h=e.slice(a.length);return{value:c,rest:h}}}function Ixe(i,e){for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)&&e(i[t]))return t}function Bxe(i,e){for(let t=0;t<i.length;t++)if(e(i[t]))return t}function Oxe(i){return(e,t={})=>{const n=e.match(i.matchPattern);if(!n)return null;const s=n[0],r=e.match(i.parsePattern);if(!r)return null;let a=i.valueCallback?i.valueCallback(r[0]):r[0];a=t.valueCallback?t.valueCallback(a):a;const o=e.slice(s.length);return{value:a,rest:o}}}const Pxe=/^(\d+)(th|st|nd|rd)?/i,Nxe=/\d+/i,Uxe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},kxe={any:[/^b/i,/^(a|c)/i]},Fxe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Hxe={any:[/1/i,/2/i,/3/i,/4/i]},Gxe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},zxe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Vxe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Yxe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Kxe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Wxe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Xxe={ordinalNumber:Oxe({matchPattern:Pxe,parsePattern:Nxe,valueCallback:i=>parseInt(i,10)}),era:Yb({matchPatterns:Uxe,defaultMatchWidth:"wide",parsePatterns:kxe,defaultParseWidth:"any"}),quarter:Yb({matchPatterns:Fxe,defaultMatchWidth:"wide",parsePatterns:Hxe,defaultParseWidth:"any",valueCallback:i=>i+1}),month:Yb({matchPatterns:Gxe,defaultMatchWidth:"wide",parsePatterns:zxe,defaultParseWidth:"any"}),day:Yb({matchPatterns:Vxe,defaultMatchWidth:"wide",parsePatterns:Yxe,defaultParseWidth:"any"}),dayPeriod:Yb({matchPatterns:Kxe,defaultMatchWidth:"any",parsePatterns:Wxe,defaultParseWidth:"any"})},eY={code:"en-US",formatDistance:yxe,formatLong:Axe,formatRelative:_xe,localize:Lxe,match:Xxe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function jxe(i,e){const t=Dn(i,e==null?void 0:e.in);return X7(t,Z7(t))+1}function tY(i,e){const t=Dn(i,e==null?void 0:e.in),n=+zv(t)-+Wve(t);return Math.round(n/K7)+1}function tP(i,e){var h,d,m,y;const t=Dn(i,e==null?void 0:e.in),n=t.getFullYear(),s=Dg(),r=(e==null?void 0:e.firstWeekContainsDate)??((d=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((y=(m=s.locale)==null?void 0:m.options)==null?void 0:y.firstWeekContainsDate)??1,a=qs((e==null?void 0:e.in)||i,0);a.setFullYear(n+1,0,r),a.setHours(0,0,0,0);const o=yh(a,e),l=qs((e==null?void 0:e.in)||i,0);l.setFullYear(n,0,r),l.setHours(0,0,0,0);const c=yh(l,e);return+t>=+o?n+1:+t>=+c?n:n-1}function qxe(i,e){var o,l,c,h;const t=Dg(),n=(e==null?void 0:e.firstWeekContainsDate)??((l=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??t.firstWeekContainsDate??((h=(c=t.locale)==null?void 0:c.options)==null?void 0:h.firstWeekContainsDate)??1,s=tP(i,e),r=qs((e==null?void 0:e.in)||i,0);return r.setFullYear(s,0,n),r.setHours(0,0,0,0),yh(r,e)}function nY(i,e){const t=Dn(i,e==null?void 0:e.in),n=+yh(t,e)-+qxe(t,e);return Math.round(n/K7)+1}function Gi(i,e){const t=i<0?"-":"",n=Math.abs(i).toString().padStart(e,"0");return t+n}const Jd={y(i,e){const t=i.getFullYear(),n=t>0?t:1-t;return Gi(e==="yy"?n%100:n,e.length)},M(i,e){const t=i.getMonth();return e==="M"?String(t+1):Gi(t+1,2)},d(i,e){return Gi(i.getDate(),e.length)},a(i,e){const t=i.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(i,e){return Gi(i.getHours()%12||12,e.length)},H(i,e){return Gi(i.getHours(),e.length)},m(i,e){return Gi(i.getMinutes(),e.length)},s(i,e){return Gi(i.getSeconds(),e.length)},S(i,e){const t=e.length,n=i.getMilliseconds(),s=Math.trunc(n*Math.pow(10,t-3));return Gi(s,e.length)}},iy={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},x5={G:function(i,e,t){const n=i.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(n,{width:"abbreviated"});case"GGGGG":return t.era(n,{width:"narrow"});case"GGGG":default:return t.era(n,{width:"wide"})}},y:function(i,e,t){if(e==="yo"){const n=i.getFullYear(),s=n>0?n:1-n;return t.ordinalNumber(s,{unit:"year"})}return Jd.y(i,e)},Y:function(i,e,t,n){const s=tP(i,n),r=s>0?s:1-s;if(e==="YY"){const a=r%100;return Gi(a,2)}return e==="Yo"?t.ordinalNumber(r,{unit:"year"}):Gi(r,e.length)},R:function(i,e){const t=W7(i);return Gi(t,e.length)},u:function(i,e){const t=i.getFullYear();return Gi(t,e.length)},Q:function(i,e,t){const n=Math.ceil((i.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return Gi(n,2);case"Qo":return t.ordinalNumber(n,{unit:"quarter"});case"QQQ":return t.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(n,{width:"wide",context:"formatting"})}},q:function(i,e,t){const n=Math.ceil((i.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return Gi(n,2);case"qo":return t.ordinalNumber(n,{unit:"quarter"});case"qqq":return t.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(n,{width:"wide",context:"standalone"})}},M:function(i,e,t){const n=i.getMonth();switch(e){case"M":case"MM":return Jd.M(i,e);case"Mo":return t.ordinalNumber(n+1,{unit:"month"});case"MMM":return t.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(n,{width:"wide",context:"formatting"})}},L:function(i,e,t){const n=i.getMonth();switch(e){case"L":return String(n+1);case"LL":return Gi(n+1,2);case"Lo":return t.ordinalNumber(n+1,{unit:"month"});case"LLL":return t.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(n,{width:"wide",context:"standalone"})}},w:function(i,e,t,n){const s=nY(i,n);return e==="wo"?t.ordinalNumber(s,{unit:"week"}):Gi(s,e.length)},I:function(i,e,t){const n=tY(i);return e==="Io"?t.ordinalNumber(n,{unit:"week"}):Gi(n,e.length)},d:function(i,e,t){return e==="do"?t.ordinalNumber(i.getDate(),{unit:"date"}):Jd.d(i,e)},D:function(i,e,t){const n=jxe(i);return e==="Do"?t.ordinalNumber(n,{unit:"dayOfYear"}):Gi(n,e.length)},E:function(i,e,t){const n=i.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(n,{width:"short",context:"formatting"});case"EEEE":default:return t.day(n,{width:"wide",context:"formatting"})}},e:function(i,e,t,n){const s=i.getDay(),r=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(r);case"ee":return Gi(r,2);case"eo":return t.ordinalNumber(r,{unit:"day"});case"eee":return t.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(s,{width:"short",context:"formatting"});case"eeee":default:return t.day(s,{width:"wide",context:"formatting"})}},c:function(i,e,t,n){const s=i.getDay(),r=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(r);case"cc":return Gi(r,e.length);case"co":return t.ordinalNumber(r,{unit:"day"});case"ccc":return t.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(s,{width:"narrow",context:"standalone"});case"cccccc":return t.day(s,{width:"short",context:"standalone"});case"cccc":default:return t.day(s,{width:"wide",context:"standalone"})}},i:function(i,e,t){const n=i.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return Gi(s,e.length);case"io":return t.ordinalNumber(s,{unit:"day"});case"iii":return t.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(n,{width:"short",context:"formatting"});case"iiii":default:return t.day(n,{width:"wide",context:"formatting"})}},a:function(i,e,t){const s=i.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(i,e,t){const n=i.getHours();let s;switch(n===12?s=iy.noon:n===0?s=iy.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(i,e,t){const n=i.getHours();let s;switch(n>=17?s=iy.evening:n>=12?s=iy.afternoon:n>=4?s=iy.morning:s=iy.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(i,e,t){if(e==="ho"){let n=i.getHours()%12;return n===0&&(n=12),t.ordinalNumber(n,{unit:"hour"})}return Jd.h(i,e)},H:function(i,e,t){return e==="Ho"?t.ordinalNumber(i.getHours(),{unit:"hour"}):Jd.H(i,e)},K:function(i,e,t){const n=i.getHours()%12;return e==="Ko"?t.ordinalNumber(n,{unit:"hour"}):Gi(n,e.length)},k:function(i,e,t){let n=i.getHours();return n===0&&(n=24),e==="ko"?t.ordinalNumber(n,{unit:"hour"}):Gi(n,e.length)},m:function(i,e,t){return e==="mo"?t.ordinalNumber(i.getMinutes(),{unit:"minute"}):Jd.m(i,e)},s:function(i,e,t){return e==="so"?t.ordinalNumber(i.getSeconds(),{unit:"second"}):Jd.s(i,e)},S:function(i,e){return Jd.S(i,e)},X:function(i,e,t){const n=i.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return A5(n);case"XXXX":case"XX":return um(n);case"XXXXX":case"XXX":default:return um(n,":")}},x:function(i,e,t){const n=i.getTimezoneOffset();switch(e){case"x":return A5(n);case"xxxx":case"xx":return um(n);case"xxxxx":case"xxx":default:return um(n,":")}},O:function(i,e,t){const n=i.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+b5(n,":");case"OOOO":default:return"GMT"+um(n,":")}},z:function(i,e,t){const n=i.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+b5(n,":");case"zzzz":default:return"GMT"+um(n,":")}},t:function(i,e,t){const n=Math.trunc(+i/1e3);return Gi(n,e.length)},T:function(i,e,t){return Gi(+i,e.length)}};function b5(i,e=""){const t=i>0?"-":"+",n=Math.abs(i),s=Math.trunc(n/60),r=n%60;return r===0?t+String(s):t+String(s)+e+Gi(r,2)}function A5(i,e){return i%60===0?(i>0?"-":"+")+Gi(Math.abs(i)/60,2):um(i,e)}function um(i,e=""){const t=i>0?"-":"+",n=Math.abs(i),s=Gi(Math.trunc(n/60),2),r=Gi(n%60,2);return t+s+e+r}const E5=(i,e)=>{switch(i){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},iY=(i,e)=>{switch(i){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Qxe=(i,e)=>{const t=i.match(/(P+)(p+)?/)||[],n=t[1],s=t[2];if(!s)return E5(i,e);let r;switch(n){case"P":r=e.dateTime({width:"short"});break;case"PP":r=e.dateTime({width:"medium"});break;case"PPP":r=e.dateTime({width:"long"});break;case"PPPP":default:r=e.dateTime({width:"full"});break}return r.replace("{{date}}",E5(n,e)).replace("{{time}}",iY(s,e))},DI={p:iY,P:Qxe},$xe=/^D+$/,Jxe=/^Y+$/,Zxe=["D","DD","YY","YYYY"];function sY(i){return $xe.test(i)}function rY(i){return Jxe.test(i)}function LI(i,e,t){const n=ebe(i,e,t);if(console.warn(n),Zxe.includes(i))throw new RangeError(n)}function ebe(i,e,t){const n=i[0]==="Y"?"years":"days of the month";return`Use \`${i.toLowerCase()}\` instead of \`${i}\` (in \`${e}\`) for formatting ${n} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const tbe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,nbe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ibe=/^'([^]*?)'?$/,sbe=/''/g,rbe=/[a-zA-Z]/;function abe(i,e,t){var h,d,m,y,x,_,b,A;const n=Dg(),s=(t==null?void 0:t.locale)??n.locale??eY,r=(t==null?void 0:t.firstWeekContainsDate)??((d=(h=t==null?void 0:t.locale)==null?void 0:h.options)==null?void 0:d.firstWeekContainsDate)??n.firstWeekContainsDate??((y=(m=n.locale)==null?void 0:m.options)==null?void 0:y.firstWeekContainsDate)??1,a=(t==null?void 0:t.weekStartsOn)??((_=(x=t==null?void 0:t.locale)==null?void 0:x.options)==null?void 0:_.weekStartsOn)??n.weekStartsOn??((A=(b=n.locale)==null?void 0:b.options)==null?void 0:A.weekStartsOn)??0,o=Dn(i,t==null?void 0:t.in);if(!j7(o))throw new RangeError("Invalid time value");let l=e.match(nbe).map(T=>{const w=T[0];if(w==="p"||w==="P"){const R=DI[w];return R(T,s.formatLong)}return T}).join("").match(tbe).map(T=>{if(T==="''")return{isToken:!1,value:"'"};const w=T[0];if(w==="'")return{isToken:!1,value:obe(T)};if(x5[w])return{isToken:!0,value:T};if(w.match(rbe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:T}});s.localize.preprocessor&&(l=s.localize.preprocessor(o,l));const c={firstWeekContainsDate:r,weekStartsOn:a,locale:s};return l.map(T=>{if(!T.isToken)return T.value;const w=T.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&rY(w)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&sY(w))&&LI(w,e,String(i));const R=x5[w[0]];return R(o,w,s.localize,c)}).join("")}function obe(i){const e=i.match(ibe);return e?e[1].replace(sbe,"'"):i}function lbe(){return Object.assign({},Dg())}function cbe(i,e){const t=Dn(i,e==null?void 0:e.in).getDay();return t===0?7:t}function ube(i,e){const t=hbe(e)?new e(0):qs(e,0);return t.setFullYear(i.getFullYear(),i.getMonth(),i.getDate()),t.setHours(i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()),t}function hbe(i){var e;return typeof i=="function"&&((e=i.prototype)==null?void 0:e.constructor)===i}const fbe=10;class aY{constructor(){he(this,"subPriority",0)}validate(e,t){return!0}}class dbe extends aY{constructor(e,t,n,s,r){super(),this.value=e,this.validateValue=t,this.setValue=n,this.priority=s,r&&(this.subPriority=r)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,n){return this.setValue(e,t,this.value,n)}}class pbe extends aY{constructor(t,n){super();he(this,"priority",fbe);he(this,"subPriority",-1);this.context=t||(s=>qs(n,s))}set(t,n){return n.timestampIsSet?t:qs(t,ube(t,this.context))}}class Di{run(e,t,n,s){const r=this.parse(e,t,n,s);return r?{setter:new dbe(r.value,this.validate,this.set,this.priority,this.subPriority),rest:r.rest}:null}validate(e,t,n){return!0}}class mbe extends Di{constructor(){super(...arguments);he(this,"priority",140);he(this,"incompatibleTokens",["R","u","t","T"])}parse(t,n,s){switch(n){case"G":case"GG":case"GGG":return s.era(t,{width:"abbreviated"})||s.era(t,{width:"narrow"});case"GGGGG":return s.era(t,{width:"narrow"});case"GGGG":default:return s.era(t,{width:"wide"})||s.era(t,{width:"abbreviated"})||s.era(t,{width:"narrow"})}}set(t,n,s){return n.era=s,t.setFullYear(s,0,1),t.setHours(0,0,0,0),t}}const or={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},ah={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function lr(i,e){return i&&{value:e(i.value),rest:i.rest}}function Is(i,e){const t=e.match(i);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function oh(i,e){const t=e.match(i);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};const n=t[1]==="+"?1:-1,s=t[2]?parseInt(t[2],10):0,r=t[3]?parseInt(t[3],10):0,a=t[5]?parseInt(t[5],10):0;return{value:n*(s*n1+r*t1+a*Vve),rest:e.slice(t[0].length)}}function oY(i){return Is(or.anyDigitsSigned,i)}function Qs(i,e){switch(i){case 1:return Is(or.singleDigit,e);case 2:return Is(or.twoDigits,e);case 3:return Is(or.threeDigits,e);case 4:return Is(or.fourDigits,e);default:return Is(new RegExp("^\\d{1,"+i+"}"),e)}}function _w(i,e){switch(i){case 1:return Is(or.singleDigitSigned,e);case 2:return Is(or.twoDigitsSigned,e);case 3:return Is(or.threeDigitsSigned,e);case 4:return Is(or.fourDigitsSigned,e);default:return Is(new RegExp("^-?\\d{1,"+i+"}"),e)}}function nP(i){switch(i){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function lY(i,e){const t=e>0,n=t?e:1-e;let s;if(n<=50)s=i||100;else{const r=n+50,a=Math.trunc(r/100)*100,o=i>=r%100;s=i+a-(o?100:0)}return t?s:1-s}function cY(i){return i%400===0||i%4===0&&i%100!==0}class gbe extends Di{constructor(){super(...arguments);he(this,"priority",130);he(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(t,n,s){const r=a=>({year:a,isTwoDigitYear:n==="yy"});switch(n){case"y":return lr(Qs(4,t),r);case"yo":return lr(s.ordinalNumber(t,{unit:"year"}),r);default:return lr(Qs(n.length,t),r)}}validate(t,n){return n.isTwoDigitYear||n.year>0}set(t,n,s){const r=t.getFullYear();if(s.isTwoDigitYear){const o=lY(s.year,r);return t.setFullYear(o,0,1),t.setHours(0,0,0,0),t}const a=!("era"in n)||n.era===1?s.year:1-s.year;return t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}}class ybe extends Di{constructor(){super(...arguments);he(this,"priority",130);he(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(t,n,s){const r=a=>({year:a,isTwoDigitYear:n==="YY"});switch(n){case"Y":return lr(Qs(4,t),r);case"Yo":return lr(s.ordinalNumber(t,{unit:"year"}),r);default:return lr(Qs(n.length,t),r)}}validate(t,n){return n.isTwoDigitYear||n.year>0}set(t,n,s,r){const a=tP(t,r);if(s.isTwoDigitYear){const l=lY(s.year,a);return t.setFullYear(l,0,r.firstWeekContainsDate),t.setHours(0,0,0,0),yh(t,r)}const o=!("era"in n)||n.era===1?s.year:1-s.year;return t.setFullYear(o,0,r.firstWeekContainsDate),t.setHours(0,0,0,0),yh(t,r)}}class vbe extends Di{constructor(){super(...arguments);he(this,"priority",130);he(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(t,n){return _w(n==="R"?4:n.length,t)}set(t,n,s){const r=qs(t,0);return r.setFullYear(s,0,4),r.setHours(0,0,0,0),zv(r)}}class xbe extends Di{constructor(){super(...arguments);he(this,"priority",130);he(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(t,n){return _w(n==="u"?4:n.length,t)}set(t,n,s){return t.setFullYear(s,0,1),t.setHours(0,0,0,0),t}}class bbe extends Di{constructor(){super(...arguments);he(this,"priority",120);he(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,n,s){switch(n){case"Q":case"QQ":return Qs(n.length,t);case"Qo":return s.ordinalNumber(t,{unit:"quarter"});case"QQQ":return s.quarter(t,{width:"abbreviated",context:"formatting"})||s.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return s.quarter(t,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(t,{width:"wide",context:"formatting"})||s.quarter(t,{width:"abbreviated",context:"formatting"})||s.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=1&&n<=4}set(t,n,s){return t.setMonth((s-1)*3,1),t.setHours(0,0,0,0),t}}class Abe extends Di{constructor(){super(...arguments);he(this,"priority",120);he(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,n,s){switch(n){case"q":case"qq":return Qs(n.length,t);case"qo":return s.ordinalNumber(t,{unit:"quarter"});case"qqq":return s.quarter(t,{width:"abbreviated",context:"standalone"})||s.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return s.quarter(t,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(t,{width:"wide",context:"standalone"})||s.quarter(t,{width:"abbreviated",context:"standalone"})||s.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=1&&n<=4}set(t,n,s){return t.setMonth((s-1)*3,1),t.setHours(0,0,0,0),t}}class Ebe extends Di{constructor(){super(...arguments);he(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);he(this,"priority",110)}parse(t,n,s){const r=a=>a-1;switch(n){case"M":return lr(Is(or.month,t),r);case"MM":return lr(Qs(2,t),r);case"Mo":return lr(s.ordinalNumber(t,{unit:"month"}),r);case"MMM":return s.month(t,{width:"abbreviated",context:"formatting"})||s.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return s.month(t,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(t,{width:"wide",context:"formatting"})||s.month(t,{width:"abbreviated",context:"formatting"})||s.month(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=11}set(t,n,s){return t.setMonth(s,1),t.setHours(0,0,0,0),t}}class _be extends Di{constructor(){super(...arguments);he(this,"priority",110);he(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(t,n,s){const r=a=>a-1;switch(n){case"L":return lr(Is(or.month,t),r);case"LL":return lr(Qs(2,t),r);case"Lo":return lr(s.ordinalNumber(t,{unit:"month"}),r);case"LLL":return s.month(t,{width:"abbreviated",context:"standalone"})||s.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return s.month(t,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(t,{width:"wide",context:"standalone"})||s.month(t,{width:"abbreviated",context:"standalone"})||s.month(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=0&&n<=11}set(t,n,s){return t.setMonth(s,1),t.setHours(0,0,0,0),t}}function Sbe(i,e,t){const n=Dn(i,t==null?void 0:t.in),s=nY(n,t)-e;return n.setDate(n.getDate()-s*7),Dn(n,t==null?void 0:t.in)}class Tbe extends Di{constructor(){super(...arguments);he(this,"priority",100);he(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(t,n,s){switch(n){case"w":return Is(or.week,t);case"wo":return s.ordinalNumber(t,{unit:"week"});default:return Qs(n.length,t)}}validate(t,n){return n>=1&&n<=53}set(t,n,s,r){return yh(Sbe(t,s,r),r)}}function wbe(i,e,t){const n=Dn(i,t==null?void 0:t.in),s=tY(n,t)-e;return n.setDate(n.getDate()-s*7),n}class Mbe extends Di{constructor(){super(...arguments);he(this,"priority",100);he(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(t,n,s){switch(n){case"I":return Is(or.week,t);case"Io":return s.ordinalNumber(t,{unit:"week"});default:return Qs(n.length,t)}}validate(t,n){return n>=1&&n<=53}set(t,n,s){return zv(wbe(t,s))}}const Cbe=[31,28,31,30,31,30,31,31,30,31,30,31],Rbe=[31,29,31,30,31,30,31,31,30,31,30,31];class Dbe extends Di{constructor(){super(...arguments);he(this,"priority",90);he(this,"subPriority",1);he(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(t,n,s){switch(n){case"d":return Is(or.date,t);case"do":return s.ordinalNumber(t,{unit:"date"});default:return Qs(n.length,t)}}validate(t,n){const s=t.getFullYear(),r=cY(s),a=t.getMonth();return r?n>=1&&n<=Rbe[a]:n>=1&&n<=Cbe[a]}set(t,n,s){return t.setDate(s),t.setHours(0,0,0,0),t}}class Lbe extends Di{constructor(){super(...arguments);he(this,"priority",90);he(this,"subpriority",1);he(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(t,n,s){switch(n){case"D":case"DD":return Is(or.dayOfYear,t);case"Do":return s.ordinalNumber(t,{unit:"date"});default:return Qs(n.length,t)}}validate(t,n){const s=t.getFullYear();return cY(s)?n>=1&&n<=366:n>=1&&n<=365}set(t,n,s){return t.setMonth(0,s),t.setHours(0,0,0,0),t}}function iP(i,e,t){var d,m,y,x;const n=Dg(),s=(t==null?void 0:t.weekStartsOn)??((m=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((x=(y=n.locale)==null?void 0:y.options)==null?void 0:x.weekStartsOn)??0,r=Dn(i,t==null?void 0:t.in),a=r.getDay(),l=(e%7+7)%7,c=7-s,h=e<0||e>6?e-(a+c)%7:(l+c)%7-(a+c)%7;return NM(r,h,t)}class Ibe extends Di{constructor(){super(...arguments);he(this,"priority",90);he(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(t,n,s){switch(n){case"E":case"EE":case"EEE":return s.day(t,{width:"abbreviated",context:"formatting"})||s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return s.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"});case"EEEE":default:return s.day(t,{width:"wide",context:"formatting"})||s.day(t,{width:"abbreviated",context:"formatting"})||s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=6}set(t,n,s,r){return t=iP(t,s,r),t.setHours(0,0,0,0),t}}class Bbe extends Di{constructor(){super(...arguments);he(this,"priority",90);he(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(t,n,s,r){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+r.weekStartsOn+6)%7+l};switch(n){case"e":case"ee":return lr(Qs(n.length,t),a);case"eo":return lr(s.ordinalNumber(t,{unit:"day"}),a);case"eee":return s.day(t,{width:"abbreviated",context:"formatting"})||s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"});case"eeeee":return s.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"});case"eeee":default:return s.day(t,{width:"wide",context:"formatting"})||s.day(t,{width:"abbreviated",context:"formatting"})||s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=6}set(t,n,s,r){return t=iP(t,s,r),t.setHours(0,0,0,0),t}}class Obe extends Di{constructor(){super(...arguments);he(this,"priority",90);he(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(t,n,s,r){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+r.weekStartsOn+6)%7+l};switch(n){case"c":case"cc":return lr(Qs(n.length,t),a);case"co":return lr(s.ordinalNumber(t,{unit:"day"}),a);case"ccc":return s.day(t,{width:"abbreviated",context:"standalone"})||s.day(t,{width:"short",context:"standalone"})||s.day(t,{width:"narrow",context:"standalone"});case"ccccc":return s.day(t,{width:"narrow",context:"standalone"});case"cccccc":return s.day(t,{width:"short",context:"standalone"})||s.day(t,{width:"narrow",context:"standalone"});case"cccc":default:return s.day(t,{width:"wide",context:"standalone"})||s.day(t,{width:"abbreviated",context:"standalone"})||s.day(t,{width:"short",context:"standalone"})||s.day(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=0&&n<=6}set(t,n,s,r){return t=iP(t,s,r),t.setHours(0,0,0,0),t}}function Pbe(i,e,t){const n=Dn(i,t==null?void 0:t.in),s=cbe(n,t),r=e-s;return NM(n,r,t)}class Nbe extends Di{constructor(){super(...arguments);he(this,"priority",90);he(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(t,n,s){const r=a=>a===0?7:a;switch(n){case"i":case"ii":return Qs(n.length,t);case"io":return s.ordinalNumber(t,{unit:"day"});case"iii":return lr(s.day(t,{width:"abbreviated",context:"formatting"})||s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"}),r);case"iiiii":return lr(s.day(t,{width:"narrow",context:"formatting"}),r);case"iiiiii":return lr(s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"}),r);case"iiii":default:return lr(s.day(t,{width:"wide",context:"formatting"})||s.day(t,{width:"abbreviated",context:"formatting"})||s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"}),r)}}validate(t,n){return n>=1&&n<=7}set(t,n,s){return t=Pbe(t,s),t.setHours(0,0,0,0),t}}class Ube extends Di{constructor(){super(...arguments);he(this,"priority",80);he(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(t,n,s){switch(n){case"a":case"aa":case"aaa":return s.dayPeriod(t,{width:"abbreviated",context:"formatting"})||s.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return s.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(t,{width:"wide",context:"formatting"})||s.dayPeriod(t,{width:"abbreviated",context:"formatting"})||s.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,s){return t.setHours(nP(s),0,0,0),t}}class kbe extends Di{constructor(){super(...arguments);he(this,"priority",80);he(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(t,n,s){switch(n){case"b":case"bb":case"bbb":return s.dayPeriod(t,{width:"abbreviated",context:"formatting"})||s.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return s.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(t,{width:"wide",context:"formatting"})||s.dayPeriod(t,{width:"abbreviated",context:"formatting"})||s.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,s){return t.setHours(nP(s),0,0,0),t}}class Fbe extends Di{constructor(){super(...arguments);he(this,"priority",80);he(this,"incompatibleTokens",["a","b","t","T"])}parse(t,n,s){switch(n){case"B":case"BB":case"BBB":return s.dayPeriod(t,{width:"abbreviated",context:"formatting"})||s.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return s.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(t,{width:"wide",context:"formatting"})||s.dayPeriod(t,{width:"abbreviated",context:"formatting"})||s.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,s){return t.setHours(nP(s),0,0,0),t}}class Hbe extends Di{constructor(){super(...arguments);he(this,"priority",70);he(this,"incompatibleTokens",["H","K","k","t","T"])}parse(t,n,s){switch(n){case"h":return Is(or.hour12h,t);case"ho":return s.ordinalNumber(t,{unit:"hour"});default:return Qs(n.length,t)}}validate(t,n){return n>=1&&n<=12}set(t,n,s){const r=t.getHours()>=12;return r&&s<12?t.setHours(s+12,0,0,0):!r&&s===12?t.setHours(0,0,0,0):t.setHours(s,0,0,0),t}}class Gbe extends Di{constructor(){super(...arguments);he(this,"priority",70);he(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(t,n,s){switch(n){case"H":return Is(or.hour23h,t);case"Ho":return s.ordinalNumber(t,{unit:"hour"});default:return Qs(n.length,t)}}validate(t,n){return n>=0&&n<=23}set(t,n,s){return t.setHours(s,0,0,0),t}}class zbe extends Di{constructor(){super(...arguments);he(this,"priority",70);he(this,"incompatibleTokens",["h","H","k","t","T"])}parse(t,n,s){switch(n){case"K":return Is(or.hour11h,t);case"Ko":return s.ordinalNumber(t,{unit:"hour"});default:return Qs(n.length,t)}}validate(t,n){return n>=0&&n<=11}set(t,n,s){return t.getHours()>=12&&s<12?t.setHours(s+12,0,0,0):t.setHours(s,0,0,0),t}}class Vbe extends Di{constructor(){super(...arguments);he(this,"priority",70);he(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(t,n,s){switch(n){case"k":return Is(or.hour24h,t);case"ko":return s.ordinalNumber(t,{unit:"hour"});default:return Qs(n.length,t)}}validate(t,n){return n>=1&&n<=24}set(t,n,s){const r=s<=24?s%24:s;return t.setHours(r,0,0,0),t}}class Ybe extends Di{constructor(){super(...arguments);he(this,"priority",60);he(this,"incompatibleTokens",["t","T"])}parse(t,n,s){switch(n){case"m":return Is(or.minute,t);case"mo":return s.ordinalNumber(t,{unit:"minute"});default:return Qs(n.length,t)}}validate(t,n){return n>=0&&n<=59}set(t,n,s){return t.setMinutes(s,0,0),t}}class Kbe extends Di{constructor(){super(...arguments);he(this,"priority",50);he(this,"incompatibleTokens",["t","T"])}parse(t,n,s){switch(n){case"s":return Is(or.second,t);case"so":return s.ordinalNumber(t,{unit:"second"});default:return Qs(n.length,t)}}validate(t,n){return n>=0&&n<=59}set(t,n,s){return t.setSeconds(s,0),t}}class Wbe extends Di{constructor(){super(...arguments);he(this,"priority",30);he(this,"incompatibleTokens",["t","T"])}parse(t,n){const s=r=>Math.trunc(r*Math.pow(10,-n.length+3));return lr(Qs(n.length,t),s)}set(t,n,s){return t.setMilliseconds(s),t}}class Xbe extends Di{constructor(){super(...arguments);he(this,"priority",10);he(this,"incompatibleTokens",["t","T","x"])}parse(t,n){switch(n){case"X":return oh(ah.basicOptionalMinutes,t);case"XX":return oh(ah.basic,t);case"XXXX":return oh(ah.basicOptionalSeconds,t);case"XXXXX":return oh(ah.extendedOptionalSeconds,t);case"XXX":default:return oh(ah.extended,t)}}set(t,n,s){return n.timestampIsSet?t:qs(t,t.getTime()-Ew(t)-s)}}class jbe extends Di{constructor(){super(...arguments);he(this,"priority",10);he(this,"incompatibleTokens",["t","T","X"])}parse(t,n){switch(n){case"x":return oh(ah.basicOptionalMinutes,t);case"xx":return oh(ah.basic,t);case"xxxx":return oh(ah.basicOptionalSeconds,t);case"xxxxx":return oh(ah.extendedOptionalSeconds,t);case"xxx":default:return oh(ah.extended,t)}}set(t,n,s){return n.timestampIsSet?t:qs(t,t.getTime()-Ew(t)-s)}}class qbe extends Di{constructor(){super(...arguments);he(this,"priority",40);he(this,"incompatibleTokens","*")}parse(t){return oY(t)}set(t,n,s){return[qs(t,s*1e3),{timestampIsSet:!0}]}}class Qbe extends Di{constructor(){super(...arguments);he(this,"priority",20);he(this,"incompatibleTokens","*")}parse(t){return oY(t)}set(t,n,s){return[qs(t,s),{timestampIsSet:!0}]}}const $be={G:new mbe,y:new gbe,Y:new ybe,R:new vbe,u:new xbe,Q:new bbe,q:new Abe,M:new Ebe,L:new _be,w:new Tbe,I:new Mbe,d:new Dbe,D:new Lbe,E:new Ibe,e:new Bbe,c:new Obe,i:new Nbe,a:new Ube,b:new kbe,B:new Fbe,h:new Hbe,H:new Gbe,K:new zbe,k:new Vbe,m:new Ybe,s:new Kbe,S:new Wbe,X:new Xbe,x:new jbe,t:new qbe,T:new Qbe},Jbe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Zbe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,eAe=/^'([^]*?)'?$/,tAe=/''/g,nAe=/\S/,iAe=/[a-zA-Z]/;function sAe(i,e,t,n){var b,A,T,w,R,O,N,U;const s=()=>qs((n==null?void 0:n.in)||t,NaN),r=lbe(),a=(n==null?void 0:n.locale)??r.locale??eY,o=(n==null?void 0:n.firstWeekContainsDate)??((A=(b=n==null?void 0:n.locale)==null?void 0:b.options)==null?void 0:A.firstWeekContainsDate)??r.firstWeekContainsDate??((w=(T=r.locale)==null?void 0:T.options)==null?void 0:w.firstWeekContainsDate)??1,l=(n==null?void 0:n.weekStartsOn)??((O=(R=n==null?void 0:n.locale)==null?void 0:R.options)==null?void 0:O.weekStartsOn)??r.weekStartsOn??((U=(N=r.locale)==null?void 0:N.options)==null?void 0:U.weekStartsOn)??0;if(!e)return i?s():Dn(t,n==null?void 0:n.in);const c={firstWeekContainsDate:o,weekStartsOn:l,locale:a},h=[new pbe(n==null?void 0:n.in,t)],d=e.match(Zbe).map(P=>{const B=P[0];if(B in DI){const L=DI[B];return L(P,a.formatLong)}return P}).join("").match(Jbe),m=[];for(let P of d){!(n!=null&&n.useAdditionalWeekYearTokens)&&rY(P)&&LI(P,e,i),!(n!=null&&n.useAdditionalDayOfYearTokens)&&sY(P)&&LI(P,e,i);const B=P[0],L=$be[B];if(L){const{incompatibleTokens:F}=L;if(Array.isArray(F)){const J=m.find(re=>F.includes(re.token)||re.token===B);if(J)throw new RangeError(`The format string mustn't contain \`${J.fullToken}\` and \`${P}\` at the same time`)}else if(L.incompatibleTokens==="*"&&m.length>0)throw new RangeError(`The format string mustn't contain \`${P}\` and any other token at the same time`);m.push({token:B,fullToken:P});const j=L.run(i,P,a.match,c);if(!j)return s();h.push(j.setter),i=j.rest}else{if(B.match(iAe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+B+"`");if(P==="''"?P="'":B==="'"&&(P=rAe(P)),i.indexOf(P)===0)i=i.slice(P.length);else return s()}}if(i.length>0&&nAe.test(i))return s();const y=h.map(P=>P.priority).sort((P,B)=>B-P).filter((P,B,L)=>L.indexOf(P)===B).map(P=>h.filter(B=>B.priority===P).sort((B,L)=>L.subPriority-B.subPriority)).map(P=>P[0]);let x=Dn(t,n==null?void 0:n.in);if(isNaN(+x))return s();const _={};for(const P of y){if(!P.validate(x,c))return s();const B=P.set(x,_,c);Array.isArray(B)?(x=B[0],Object.assign(_,B[1])):x=B}return x}function rAe(i){return i.match(eAe)[1].replace(tAe,"'")}function aAe(i,e){const t=Dn(i,e==null?void 0:e.in);return t.setMinutes(0,0,0),t}function oAe(i,e){const t=Dn(i,e==null?void 0:e.in);return t.setSeconds(0,0),t}function lAe(i,e){const t=Dn(i,e==null?void 0:e.in);return t.setMilliseconds(0),t}function cAe(i,e){const t=()=>qs(e==null?void 0:e.in,NaN),n=(e==null?void 0:e.additionalDigits)??2,s=dAe(i);let r;if(s.date){const c=pAe(s.date,n);r=mAe(c.restDateString,c.year)}if(!r||isNaN(+r))return t();const a=+r;let o=0,l;if(s.time&&(o=gAe(s.time),isNaN(o)))return t();if(s.timezone){if(l=yAe(s.timezone),isNaN(l))return t()}else{const c=new Date(a+o),h=Dn(0,e==null?void 0:e.in);return h.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),h.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),h}return Dn(a+o+l,e==null?void 0:e.in)}const xT={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},uAe=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,hAe=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,fAe=/^([+-])(\d{2})(?::?(\d{2}))?$/;function dAe(i){const e={},t=i.split(xT.dateTimeDelimiter);let n;if(t.length>2)return e;if(/:/.test(t[0])?n=t[0]:(e.date=t[0],n=t[1],xT.timeZoneDelimiter.test(e.date)&&(e.date=i.split(xT.timeZoneDelimiter)[0],n=i.substr(e.date.length,i.length))),n){const s=xT.timezone.exec(n);s?(e.time=n.replace(s[1],""),e.timezone=s[1]):e.time=n}return e}function pAe(i,e){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),n=i.match(t);if(!n)return{year:NaN,restDateString:""};const s=n[1]?parseInt(n[1]):null,r=n[2]?parseInt(n[2]):null;return{year:r===null?s:r*100,restDateString:i.slice((n[1]||n[2]).length)}}function mAe(i,e){if(e===null)return new Date(NaN);const t=i.match(uAe);if(!t)return new Date(NaN);const n=!!t[4],s=Kb(t[1]),r=Kb(t[2])-1,a=Kb(t[3]),o=Kb(t[4]),l=Kb(t[5])-1;if(n)return EAe(e,o,l)?vAe(e,o,l):new Date(NaN);{const c=new Date(0);return!bAe(e,r,a)||!AAe(e,s)?new Date(NaN):(c.setUTCFullYear(e,r,Math.max(s,a)),c)}}function Kb(i){return i?parseInt(i):1}function gAe(i){const e=i.match(hAe);if(!e)return NaN;const t=kD(e[1]),n=kD(e[2]),s=kD(e[3]);return _Ae(t,n,s)?t*n1+n*t1+s*1e3:NaN}function kD(i){return i&&parseFloat(i.replace(",","."))||0}function yAe(i){if(i==="Z")return 0;const e=i.match(fAe);if(!e)return 0;const t=e[1]==="+"?-1:1,n=parseInt(e[2]),s=e[3]&&parseInt(e[3])||0;return SAe(n,s)?t*(n*n1+s*t1):NaN}function vAe(i,e,t){const n=new Date(0);n.setUTCFullYear(i,0,4);const s=n.getUTCDay()||7,r=(e-1)*7+t+1-s;return n.setUTCDate(n.getUTCDate()+r),n}const xAe=[31,null,31,30,31,30,31,31,30,31,30,31];function uY(i){return i%400===0||i%4===0&&i%100!==0}function bAe(i,e,t){return e>=0&&e<=11&&t>=1&&t<=(xAe[e]||(uY(i)?29:28))}function AAe(i,e){return e>=1&&e<=(uY(i)?366:365)}function EAe(i,e,t){return e>=1&&e<=53&&t>=0&&t<=6}function _Ae(i,e,t){return i===24?e===0&&t===0:t>=0&&t<60&&e>=0&&e<60&&i>=0&&i<25}function SAe(i,e){return e>=0&&e<=59}/*!
 * chartjs-adapter-date-fns v3.0.0
 * https://www.chartjs.org
 * (c) 2022 chartjs-adapter-date-fns Contributors
 * Released under the MIT license
 */const TAe={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};C7._date.override({_id:"date-fns",formats:function(){return TAe},parse:function(i,e){if(i===null||typeof i>"u")return null;const t=typeof i;return t==="number"||i instanceof Date?i=Dn(i):t==="string"&&(typeof e=="string"?i=sAe(i,e,new Date,this.options):i=cAe(i,this.options)),j7(i)?i.getTime():null},format:function(i,e){return abe(i,e,this.options)},add:function(i,e,t){switch(t){case"millisecond":return ZO(i,e);case"second":return qve(i,e);case"minute":return Xve(i,e);case"hour":return Yve(i,e);case"day":return NM(i,e);case"week":return Qve(i,e);case"month":return JO(i,e);case"quarter":return jve(i,e);case"year":return $ve(i,e);default:return i}},diff:function(i,e,t){switch(t){case"millisecond":return eP(i,e);case"second":return rxe(i,e);case"minute":return nxe(i,e);case"hour":return txe(i,e);case"day":return q7(i,e);case"week":return axe(i,e);case"month":return J7(i,e);case"quarter":return sxe(i,e);case"year":return oxe(i,e);default:return 0}},startOf:function(i,e,t){switch(e){case"second":return lAe(i);case"minute":return oAe(i);case"hour":return aAe(i);case"day":return RI(i);case"week":return yh(i);case"isoWeek":return yh(i,{weekStartsOn:+t});case"month":return cxe(i);case"quarter":return lxe(i);case"year":return Z7(i);default:return i}},endOf:function(i,e){switch(e){case"second":return mxe(i);case"minute":return dxe(i);case"hour":return hxe(i);case"day":return Q7(i);case"week":return fxe(i);case"month":return $7(i);case"quarter":return pxe(i);case"year":return uxe(i);default:return i}}});OM.register(MI,CI,qT,sA,Mve,xve,dE);const bT=({coinId:i})=>{const{ref:e,inView:t}=kme({triggerOnce:!0}),[n,s]=ce.useState(null),[r,a]=ce.useState(!1);return ce.useEffect(()=>{let o;return t&&!n&&!r&&(o=setTimeout(()=>{a(!0),fetch(`https://api.coingecko.com/api/v3/coins/${i}/market_chart?vs_currency=usd&days=7`).then(l=>l.json()).then(l=>{const c=l.prices.map(([h,d])=>({x:h,y:d}));s({datasets:[{label:`${i.toUpperCase()} / USDT`,data:c,borderColor:"#0ff",borderWidth:2,pointBackgroundColor:"#0ff",tension:.8,pointRadius:0}]})}).finally(()=>a(!1))},500)),()=>clearTimeout(o)},[t,n,r,i]),Re.jsx("div",{ref:e,className:"my-12 px-4",children:Re.jsxs(Fme,{children:[r&&Re.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-30 bg-black/60",children:Re.jsx("h1",{className:"neon-red flicker text-[30px] text-center",children:"LOADING..."})}),!r&&n&&Re.jsx(Gve,{data:n,options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{type:"time",time:{unit:"day"},ticks:{color:"#0ff"},grid:{color:"rgba(0, 255, 255, 0.1)"}},y:{ticks:{color:"#0ff"},grid:{color:"rgba(0, 255, 255, 0.1)"}}},plugins:{legend:{labels:{color:"#0ff",font:{weight:"bold"}}}}}})]})})};function wAe(){return Re.jsxs("div",{className:"min-h-screen bg-black mt-[80px] text-white px-4 py-10",children:[Re.jsx("h1",{className:"text-4xl text-center font-bold mb-12 text-neon",children:"The Blockchain Ticker"}),Re.jsx(bT,{coinId:"bitcoin"}),Re.jsx(bT,{coinId:"ethereum"}),Re.jsx(bT,{coinId:"solana"}),Re.jsx(bT,{coinId:"dogecoin"})]})}const _5=["function initializeSystem(config) {","  console.log('[SYSTEM] Booting in neon mode...');","  for (let i = 0; i < config.modules.length; i++) {","    const status = loadModule(config.modules[i]);","    if (!status.success) throw new Error('Module failed: ' + config.modules[i]);","  }","  console.log('[SYSTEM] All modules loaded.');","}","","while (network.isConnected() && retries < MAX_RETRIES) {","  try {","    sendHeartbeatPacket();","    await delay(1000);","  } catch (err) {","    console.warn('Heartbeat failed, retrying...');","    retries++;","  }","}","","if (auth.isValid(token)) {","  session = createSession(user);","  grantAccess(session);","} else {","  logSecurityEvent('Invalid token: ' + token);","  denyAccess();","}","","const neonUI = await import('@neon/ui-core');","neonUI.mount('#main-display', { theme: 'cyberpunk', animate: true });","","fetch('/api/system/data', { headers: { 'Authorization': token } })","  .then(response => response.json())","  .then(systemData => {","    renderDashboard(systemData);","    console.log('[DATA] Dashboard rendered');","  })","  .catch(error => console.error('[ERROR] Data fetch failed:', error));","",">>> SYSTEM READY <<<"],S5=i=>Array.from({length:i},()=>_5[Math.floor(Math.random()*_5.length)]),MAe=()=>{const[i,e]=ce.useState(!0),t=[...S5(40),...S5(40)];return ce.useEffect(()=>{const n=setTimeout(()=>{e(!1)},2e3);return()=>clearTimeout(n)},[]),i?Re.jsxs("div",{className:"fixed inset-0 bg-black z-50 font-mono flex flex-col justify-center px-6 sm:px-12 md:px-20",children:[Re.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none pl-6 sm:pl-12 md:pl-16",children:Re.jsx("div",{className:"code-stream animate-marquee h-[200%]",children:Re.jsx("div",{className:"text-red-500 neon-red text-left text-base sm:text-lg md:text-2xl font-bold leading-relaxed whitespace-pre",children:t.map((n,s)=>Re.jsx("p",{children:n},s))})})}),Re.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 text-center",children:Re.jsx("h1",{className:"neon-red flicker text-lg sm:text-2xl md:text-[30px]",children:"LOADING..."})})]}):null};function CAe(){return Re.jsxs(Re.Fragment,{children:[Re.jsx(MAe,{}),Re.jsxs(yW,{children:[Re.jsx(MW,{}),Re.jsxs(jK,{children:[Re.jsx(sy,{path:"/",element:Re.jsx(ose,{})}),Re.jsx(sy,{path:"/LiveStream",element:Re.jsx(v$,{})}),Re.jsx(sy,{path:"/CryptoMarket",element:Re.jsx(wAe,{})}),Re.jsx(sy,{path:"/BlackjackTable",element:Re.jsx(ese,{})}),Re.jsx(sy,{path:"/CyberCity",element:Re.jsx(Ime,{})})]})]})]})}sK.createRoot(document.getElementById("root")).render(Re.jsx(ce.StrictMode,{children:Re.jsx(CAe,{})}));
